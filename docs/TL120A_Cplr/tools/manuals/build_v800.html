---
layout: default
title: build_v800
nav_order: 14
parent: Cplr (TL120A)
---
{% raw %}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
     "http://www.w3.org/TR/html4/transitional.dtd">
<html>
<head>

  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title></title>
  <meta name="generator" content="LibreOffice 24.2.7.2 (Linux)"/>
  <meta name="created" content="00:00:00"/>
  <meta name="changed" content="00:00:00"/>
</head>
<body>
<h1></h1>
<p><b>MULTI: Building Applications for</b></p>
<p><b>Embedded V850 and RH850</b></p>
<p><b>Green Hills Software</b></p>
<p><b>30 West Sola Street</b></p>
<p><b>Santa Barbara, California 93101</b></p>
<p><b>USA</b></p>
<p><b>Tel: 805-965-6044</b></p>
<p><b>Fax: 805-965-6343</b></p>
<p><b>www.ghs.com</b></p>
<h1 style="page-break-before:always; "></h1>
<p><b>LEGAL NOTICES AND DISCLAIMERS</b></p>
<p>GREEN HILLS SOFTWARE MAKES NO REPRESENTATIONS OR WARRANTIES WITH RESPECT TO THE</p>
<p>CONTENTS HEREOF AND SPECIFICALLY DISCLAIMS ANY IMPLIED WARRANTIES OF MERCHANTABILITY</p>
<p>OR FITNESS FOR ANY PARTICULAR PURPOSE. Further, Green Hills Software reserves the right to revise this</p>
<p>publication and to make changes from time to time in the content hereof without obligation of Green Hills Software to</p>
<p>notify any person of such revision or changes.</p>
<p>Copyright Â© 1983-2015 by Green Hills Software. All rights reserved. No part of this publication may be reproduced, stored</p>
<p>in a retrieval system, or transmitted, in any form or by any means, electronic, mechanical, photocopying, recording, or</p>
<p>otherwise, without prior written permission from Green Hills Software.</p>
<p>Green Hills, the Green Hills logo, CodeBalance, GMART, GSTART, INTEGRITY, MULTI, and Slingshot are registered</p>
<p>trademarks of Green Hills Software. AdaMULTI, Built with INTEGRITY, EventAnalyzer, G-Cover, GHnet, GHnetLite,</p>
<p>Green Hills Probe, Integrate, ISIM, u-velOSity, PathAnalyzer, Quick Start, ResourceAnalyzer, Safety Critical Products,</p>
<p>SuperTrace Probe, TimeMachine, TotalDeveloper, DoubleCheck, and velOSity are trademarks of Green Hills Software.</p>
<p>All other company, product, or service names mentioned in this book may be trademarks or service marks of their respective</p>
<p>owners.</p>
<p>For a partial listing of Green Hills Software and periodically updated patent marking information, please visit</p>
<p>http://www.ghs.com/copyright_patent.html.</p>
<p>PubID: build_v800-544152</p>
<p>Branch: http://toolsvc/branches/release-branch-70-bto</p>
<p>Date: October 21, 2015</p>
<h1 style="page-break-before:always; "></h1>
<p><b>Contents</b></p>
<p><b>Preface</b></p>
<p><b>xxv</b></p>
<p>About This Book . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxvi</p>
<p>The MULTI Document Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxvi</p>
<p>Conventions Used in the MULTI Document Set . . . . . . . . . . . . . . . . . . .</p>
<p>xxvii</p>
<p>The MULTI Toolchain . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxx</p>
<p>The C and C++ Compiler Driver . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxx</p>
<p>The Optimizing Compilers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxx</p>
<p>The ease850 Assembler . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxxi</p>
<p>The ax Librarian . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxxi</p>
<p>The elxr Linker . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxxii</p>
<p>Optimized Libraries and Header Files . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxxii</p>
<p>Utility Programs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxxii</p>
<p>V850 and RH850 Recommended Reading . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxxii</p>
<p><b>Part I. Using the MULTI Compiler</b></p>
<p><b>1</b></p>
<p><b>1. The Compiler Driver</b></p>
<p><b>3</b></p>
<p>Compiler Driver Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>5</p>
<p>Building an Executable from C or C++ Source Files . . . . . . . . . . . . . .</p>
<p>6</p>
<p>Working with Input Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>7</p>
<p>Recognized Input File Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>7</p>
<p>Passing Multiple Input File Types to the Driver . . . . . . . . . . . . . .</p>
<p>8</p>
<p>Passing Linker Directives Files to the Driver . . . . . . . . . . . . . . . . .</p>
<p>9</p>
<p>Generating Other Output File Types . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>10</p>
<p>Creating Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>11</p>
<p>Adding and Updating Files in Libraries . . . . . . . . . . . . . . . . . . . .</p>
<p>11</p>
<p>Driver Options for Intermediate Forms of Output . . . . . . . . . . . .</p>
<p>12</p>
<p>Output File Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>13</p>
<p>Controlling Driver Information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>15</p>
<p><i>iii</i></p>
<p><i>Green Hills Software</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Using a Driver Options File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>15</p>
<p>Using Makefiles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>17</p>
<p>Driver Options for Individual Compiler Passes . . . . . . . . . . . . . .</p>
<p>21</p>
<p>Green Hills Equivalents to GNU Tools . . . . . . . . . . . . . . . . . . . . .</p>
<p>22</p>
<p>Generating Dependency and Header File Information . . . . . . . .</p>
<p>22</p>
<p><b>2. Developing for V850 and RH850</b></p>
<p><b>25</b></p>
<p>V850 and RH850 Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>26</p>
<p>C and C++ Data Type Sizes and Alignment Requirements . . . .</p>
<p>27</p>
<p>Structure Packing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>28</p>
<p>Understanding Structure Packing . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>28</p>
<p>Using #pragma pack to Pack All Instances of a Structure</p>
<p>Type . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>30</p>
<p>Using the Packing Builder Option to Pack All Structures . . . . .</p>
<p>31</p>
<p>Pointing to Packed Structures with the __packed Type</p>
<p>Qualifier</p>
<p>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>32</p>
<p>Register Usage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>33</p>
<p>Calling Conventions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>35</p>
<p>The Stack . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>37</p>
<p>Target-Specific Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>39</p>
<p>SIMD Vector Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>40</p>
<p>FPSIMD Vector Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>42</p>
<p>Software Trace Logging Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>45</p>
<p>Logging User Data and Messages . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>46</p>
<p>Logging Function Entry and Exit (FEE) Events . . . . . . . . . . . . .</p>
<p>50</p>
<p>Logging Load Addresses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>50</p>
<p>Specifying a V850 and RH850 Target . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>52</p>
<p>V850 and RH850 Processor Variants . . . . . . . . . . . . . . . . . . . . . .</p>
<p>53</p>
<p>Enabling Debugging Features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>55</p>
<p>Generating Debugging Information . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>55</p>
<p>Generating Debugging Information for Applications Compiled</p>
<p>with Third-Party Compilers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>57</p>
<p>Enabling Command Line Function Calls . . . . . . . . . . . . . . . . . . .</p>
<p>62</p>
<p>Function Entry/Exit History . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>62</p>
<p>Obtaining Profiling Information . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>63</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>iv</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Enabling Run-Time Error Checking . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>70</p>
<p>Enabling Run-Time Memory Checking . . . . . . . . . . . . . . . . . . . .</p>
<p>71</p>
<p>Using Your Own Header Files and Libraries . . . . . . . . . . . . . . . . . . . .</p>
<p>76</p>
<p>Instructing the Compiler to Search for Your Headers . . . . . . . . .</p>
<p>76</p>
<p>Instructing the Compiler to Link Against Your Libraries . . . . . .</p>
<p>79</p>
<p>Controlling the Assembler . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>79</p>
<p>Controlling the Linker . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>80</p>
<p>Working with Linker Directives Files . . . . . . . . . . . . . . . . . . . . . .</p>
<p>80</p>
<p>Text and Data Placement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>82</p>
<p>Default Program Sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>82</p>
<p>Custom Program Sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>83</p>
<p>Aligned Data Sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>86</p>
<p>Individual Function and Variable Sections . . . . . . . . . . . . . . . . . .</p>
<p>87</p>
<p>Assigning Program Sections to ROM and RAM . . . . . . . . . . . . .</p>
<p>90</p>
<p>Storing Global Variables in Registers . . . . . . . . . . . . . . . . . . . . . .</p>
<p>92</p>
<p>Near and Far Function Calls . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>93</p>
<p>Special Data Area Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>96</p>
<p>V850 Tiny Data Area (TDA) Optimization . . . . . . . . . . . . . . . .</p>
<p>107</p>
<p>Position Independent Code (PIC) . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>117</p>
<p>Position Independent Data (PID) . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>119</p>
<p>Customizing the Green Hills Run-Time Environment . . . . . . . . . . .</p>
<p>121</p>
<p>Other Topics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>122</p>
<p>Renaming the Output Executable . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>122</p>
<p>Specifying an Alternate Program Start Address . . . . . . . . . . . .</p>
<p>122</p>
<p>Interrupt</p>
<p>Routines . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>122</p>
<p>Symbolic Memory-Mapped I/O . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>124</p>
<p>Verifying Program Integrity . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>126</p>
<p><b>3. Builder and Driver Options</b></p>
<p><b>127</b></p>
<p>Target</p>
<p>Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>129</p>
<p>Register Description File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>129</p>
<p>Register r2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>129</p>
<p>Register r5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>129</p>
<p>ROM SDA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>130</p>
<p>Register Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>130</p>
<p>Set Register r20 to the Value 255 . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>130</p>
<p><i>v</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Set Register r21 to the Value 65535 . . . . . . . . . . . . . . . . . . . . . .</p>
<p>131</p>
<p>Data Bus Width . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>131</p>
<p>Floating-Point . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>132</p>
<p>Text and Data Placement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>136</p>
<p>Instruction Set</p>
<p>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>151</p>
<p>Floating-Point SIMD . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>157</p>
<p>Application Binary Interface . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>158</p>
<p>Operating System . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>158</p>
<p>Project Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>160</p>
<p>Object File Output Directory . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>160</p>
<p>Emulate Behaviors of a Specific Compiler Version . . . . . . . . .</p>
<p>160</p>
<p>Source Root</p>
<p>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>161</p>
<p>Include Directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>161</p>
<p>Library Directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>162</p>
<p>Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>162</p>
<p>Output Filename . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>163</p>
<p>Source Directories Relative to This File . . . . . . . . . . . . . . . . . . .</p>
<p>163</p>
<p>Intermediate Output Directory Relative to Top-Level</p>
<p>Project</p>
<p>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>164</p>
<p>Optimization Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>165</p>
<p>Optimization Strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>165</p>
<p>Intermodule Inlining . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>167</p>
<p>Linker Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>167</p>
<p>Interprocedural Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>168</p>
<p>Optimization Scope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>168</p>
<p>Individual Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>174</p>
<p>Debugging Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>176</p>
<p>Debugging Level . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>176</p>
<p>Function Entry/Exit Logging . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>176</p>
<p>EAGLE Logging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>177</p>
<p>Profiling - Block Coverage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>177</p>
<p>Profiling - Target-Based Timing . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>178</p>
<p>Run-Time Error Checks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>178</p>
<p>Run-Time Memory Checks . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>180</p>
<p>Preprocessor Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>182</p>
<p>Define Preprocessor Symbol . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>182</p>
<p>Undefine Preprocessor Symbol . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>182</p>
<p>Display includes Preprocessor Directives Listing . . . . . . . . . . .</p>
<p>182</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>vi</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>C/C++ Compiler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>184</p>
<p>C Language Dialect . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>184</p>
<p>C Japanese Automotive Extensions . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>185</p>
<p>C++ Language Dialect . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>185</p>
<p>C++ Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>186</p>
<p>C++ Exception Handling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>186</p>
<p>Allow C++ Style Slash Comments in C . . . . . . . . . . . . . . . . . . .</p>
<p>186</p>
<p>ANSI Aliasing Rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>187</p>
<p>MISRA C 2004 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>187</p>
<p>MISRA C 1998 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>204</p>
<p>Data Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>213</p>
<p>Alignment and Packing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>215</p>
<p>C/C++ Data Allocation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>216</p>
<p>Special Tokens . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>218</p>
<p>C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>220</p>
<p>Assembler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>232</p>
<p>Source Listing Generation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>232</p>
<p>Source Listing Generation Output Directory . . . . . . . . . . . . . . .</p>
<p>232</p>
<p>Preprocess Assembly Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>232</p>
<p>Preprocess Special Assembly Files . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>233</p>
<p>Interleaved Source and Assembly . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>233</p>
<p>Additional Assembler Options . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>233</p>
<p>Assembler Command File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>234</p>
<p>Support for C Type Information in Assembly . . . . . . . . . . . . . .</p>
<p>234</p>
<p>Linker Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>235</p>
<p>Output File Type . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>235</p>
<p>Generate Additional Output . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>236</p>
<p>Executable Stripping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>236</p>
<p>Start Address Symbol . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>236</p>
<p>Append Comment Section with Link-Time Information . . . . .</p>
<p>237</p>
<p>Preprocess Linker Directives Files . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>237</p>
<p>Linker Warnings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>237</p>
<p>Raw Import Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>238</p>
<p>Linker Directive Files with Non-standard Extensions . . . . . . .</p>
<p>238</p>
<p>Additional Linker Options (beginning of link line) . . . . . . . . . .</p>
<p>239</p>
<p>Additional Linker Options (before start file) . . . . . . . . . . . . . . .</p>
<p>240</p>
<p>Additional Linker Options (among object files) . . . . . . . . . . . .</p>
<p>241</p>
<p>Linker Command File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>241</p>
<p><i>vii</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Extract Whole Archive . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>241</p>
<p>Report an Error When Multiple Libraries on a Link Line Contain</p>
<p>a Definition of the Same Symbol . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>242</p>
<p>When Rejecting Duplicate Symbols, Allow Certain Symbols</p>
<p>Added by the compiler . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>242</p>
<p>When Rejecting Duplicate Symbols, Allow Symbols in</p>
<p>.ghs.linkonce sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>242</p>
<p>Duplicate Whitelist</p>
<p>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>243</p>
<p>Linker Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>243</p>
<p>Start and End Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>244</p>
<p>Symbols . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>245</p>
<p>Linker Output Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>248</p>
<p>Link-Time Checking . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>250</p>
<p>Compiler Diagnostics Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>253</p>
<p>Warnings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>253</p>
<p>Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>253</p>
<p>Maximum Number of Errors to Display . . . . . . . . . . . . . . . . . . .</p>
<p>253</p>
<p>Redirect Error Output to File . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>254</p>
<p>Quit Building if Warnings are Generated . . . . . . . . . . . . . . . . . .</p>
<p>254</p>
<p>Display Version Information . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>254</p>
<p>Write Version Info To .comment section . . . . . . . . . . . . . . . . . .</p>
<p>254</p>
<p>Green Hills Standard Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>255</p>
<p>Coding Standard Profile . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>255</p>
<p>Varying Message Format . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>255</p>
<p>C/C++ Messages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>256</p>
<p>Toolchain Messages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>261</p>
<p>DoubleCheck (C/C++) Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>263</p>
<p>DoubleCheck Level . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>263</p>
<p>DoubleCheck Report File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>263</p>
<p>DoubleCheck Config File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>264</p>
<p>DoubleCheck Errors to Ignore . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>264</p>
<p>DoubleCheck Output that Stops Builds . . . . . . . . . . . . . . . . . . .</p>
<p>264</p>
<p>GCores Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>265</p>
<p>Gcores Output Filename . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>265</p>
<p>Gcores Shared Modules Import Symbols From Cores . . . . . . .</p>
<p>265</p>
<p>GCores Disable Error Messages Concerning Overlapping</p>
<p>Sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>266</p>
<p>GCores Cores Import Symbols From Other Cores . . . . . . . . . .</p>
<p>266</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>viii</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Gcores Common Link Options . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>266</p>
<p>GCores Driver . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>266</p>
<p>GCores Cpu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>267</p>
<p>Keep GCores Temporary Files . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>267</p>
<p>Import libraries into shared module . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>267</p>
<p>Automatically allocate shared memory for the cores and shared</p>
<p>object . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>267</p>
<p>Gcores Exported Absolutes Only . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>267</p>
<p>GCores Generate Additional Output . . . . . . . . . . . . . . . . . . . . . .</p>
<p>268</p>
<p>Advanced Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>270</p>
<p>Target</p>
<p>Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>270</p>
<p>Project Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>274</p>
<p>Optimization Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>289</p>
<p>Debugging Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>295</p>
<p>Preprocessor Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>305</p>
<p>C/C++ Compiler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>308</p>
<p>Assembler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>312</p>
<p>Linker Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>313</p>
<p>Archiver Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>316</p>
<p>Compiler Diagnostics Options . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>317</p>
<p>Support Diagnostics Options . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>318</p>
<p>HTML Compiler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>320</p>
<p><b>4. Optimizing Your Programs</b></p>
<p><b>323</b></p>
<p>Optimization Strategies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>324</p>
<p>Inlining Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>324</p>
<p>What Can Be Inlined . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>325</p>
<p>Automatic Inlining . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>325</p>
<p>Manual Inlining . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>325</p>
<p>Single-pass Inlining . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>328</p>
<p>Two-Pass Inlining (Intermodule Inlining) . . . . . . . . . . . . . . . . .</p>
<p>328</p>
<p>Varying Inlining Thresholds . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>331</p>
<p>Advantages of Inlining . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>332</p>
<p>Inlining of C Memory Functions . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>333</p>
<p>Inlining of C String Functions . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>333</p>
<p>Additional C++ Inlining Information . . . . . . . . . . . . . . . . . . . . .</p>
<p>335</p>
<p>Inlining Constant Math Functions . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>336</p>
<p><i>ix</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Interprocedural Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>338</p>
<p>Wholeprogram Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>341</p>
<p>Using gbuild with Interprocedural Optimizations . . . . . . . . . . .</p>
<p>345</p>
<p>Loop Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>347</p>
<p>Automatic Loop Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>347</p>
<p>Loop Optimizing Specific Functions . . . . . . . . . . . . . . . . . . . . .</p>
<p>347</p>
<p>Strength Reduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>348</p>
<p>Loop Invariant Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>348</p>
<p>Loop Unrolling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>350</p>
<p>General Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>352</p>
<p>Peephole Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>352</p>
<p>Pipeline Instruction Scheduling . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>353</p>
<p>Common Subexpression Elimination . . . . . . . . . . . . . . . . . . . . .</p>
<p>356</p>
<p>Tail Calls . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>357</p>
<p>Constant</p>
<p>Propagation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>358</p>
<p>C/C++ Minimum/Maximum Optimization . . . . . . . . . . . . . . . .</p>
<p>359</p>
<p>Memory Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>359</p>
<p>Dead Code Elimination . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>360</p>
<p>Static Address Elimination . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>361</p>
<p>Default Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>362</p>
<p>Register Allocation by Coloring . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>362</p>
<p>Automatic Register Allocation . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>363</p>
<p>Register Coalescing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>363</p>
<p>Constant Folding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>364</p>
<p>Loop Rotation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>364</p>
<p><b>5. The DoubleCheck Source Analysis Tool</b></p>
<p><b>365</b></p>
<p>Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>366</p>
<p>Enabling DoubleCheck . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>367</p>
<p>Specifying a DoubleCheck Report File . . . . . . . . . . . . . . . . . . . .</p>
<p>368</p>
<p>Using Custom Functions with DoubleCheck . . . . . . . . . . . . . . . . . . .</p>
<p>368</p>
<p>Specifying Function Properties in a DoubleCheck Configuration</p>
<p>File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>369</p>
<p>Specifying Function Properties with Pragma Directives . . . . .</p>
<p>370</p>
<p>Property Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>370</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>x</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Viewing DoubleCheck Reports . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>373</p>
<p>Launching the Report Viewer from the MULTI Project</p>
<p>Manager</p>
<p>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>373</p>
<p>Launching the Report Viewer From the Command Prompt . . .</p>
<p>374</p>
<p>Controlling DoubleCheck Output . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>374</p>
<p>Promoting Source Analysis Errors and Warnings . . . . . . . . . . .</p>
<p>375</p>
<p>Ignoring Source Analysis Errors and Warnings . . . . . . . . . . . . .</p>
<p>375</p>
<p>Using DoubleCheck With Run-Time Error Checking . . . . . . . . . . .</p>
<p>376</p>
<p>Source Analysis Error and Warning Messages . . . . . . . . . . . . . . . . .</p>
<p>377</p>
<p>Error Messages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>377</p>
<p>Warnings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>388</p>
<p><b>Part II. Using Advanced Tools</b></p>
<p><b>391</b></p>
<p><b>6. The ease850 Assembler</b></p>
<p><b>393</b></p>
<p>Running the Assembler from the Builder or Driver . . . . . . . . . . . . .</p>
<p>394</p>
<p>Generating Assembly Language Files . . . . . . . . . . . . . . . . . . . . .</p>
<p>394</p>
<p>Running the Assembler Directly . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>395</p>
<p>Assembler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>396</p>
<p>V850 and RH850-Specific Assembler Options . . . . . . . . . . . . .</p>
<p>396</p>
<p>General Assembler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>397</p>
<p>Assembler Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>398</p>
<p>Identifiers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>398</p>
<p>Reserved Symbols . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>398</p>
<p>Source Statements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>400</p>
<p>Expressions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>402</p>
<p>Assignment Statements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>402</p>
<p>Integral Expression Operators . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>402</p>
<p>Relocation Expression Operators . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>404</p>
<p>C Type Information Operators . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>405</p>
<p>Expression Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>407</p>
<p>Type Combinations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>407</p>
<p>Labels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>408</p>
<p>Current</p>
<p>Location . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>408</p>
<p><i>xi</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Reading the Compiler's Assembly Output . . . . . . . . . . . . . . . . . . . . .</p>
<p>408</p>
<p>Header Comment File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>409</p>
<p>Function Comment Section . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>409</p>
<p>File Comment Section . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>410</p>
<p>Source Line Comments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>410</p>
<p><b>7. Assembler Directives</b></p>
<p><b>411</b></p>
<p>Alignment</p>
<p>Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>412</p>
<p>Conditional Assembly Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>413</p>
<p>Data Initialization Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>414</p>
<p>File Inclusion Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>416</p>
<p>Macro Definition Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>417</p>
<p>Repeat Block Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>420</p>
<p>Section Control Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>421</p>
<p>Source Listing Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>423</p>
<p>Symbol Definition Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>424</p>
<p>Symbolic Debugging Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>426</p>
<p>Miscellaneous Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>428</p>
<p>RH850 Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>429</p>
<p><b>8. V850 Assembler Reference</b></p>
<p><b>433</b></p>
<p>Reserved Symbols . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>434</p>
<p>Register Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>434</p>
<p>General Registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>434</p>
<p>SIMD Vector Registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>435</p>
<p>FPSIMD Vector Registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>436</p>
<p>System Registers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>436</p>
<p>Addressing Modes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>443</p>
<p>Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>443</p>
<p>Macro Expansion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>449</p>
<p>ld, st, tst1, set1, clr1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>449</p>
<p>add . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>450</p>
<p>mov . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>450</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xii</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>cmp . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>451</p>
<p>sub,</p>
<p>not</p>
<p>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>452</p>
<p>or,</p>
<p>and,</p>
<p>xor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>452</p>
<p>addi, ori, andi, xori . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>453</p>
<p>movea . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>454</p>
<p>bcond . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>455</p>
<p>jbr . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>456</p>
<p>setf, cmov, adf, sbf . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>456</p>
<p>Programming in Assembly Language . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>457</p>
<p>Assembly Code Samples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>458</p>
<p>Bitfields . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>468</p>
<p><b>9. The elxr Linker</b></p>
<p><b>469</b></p>
<p>Linker-Specific Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>471</p>
<p>Specifying the Program Entry Point . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>475</p>
<p>Configuring the Linker with Linker Directives Files . . . . . . . . . . . .</p>
<p>475</p>
<p>Linker Directives File Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>476</p>
<p>Setting Linker Options with the OPTION Directive . . . . . . . . .</p>
<p>476</p>
<p>Setting Defaults with the DEFAULTS Directive . . . . . . . . . . . .</p>
<p>477</p>
<p>Defining a Memory Map with the MEMORY Directive . . . . .</p>
<p>479</p>
<p>Defining a Section Map with the SECTIONS Directive . . . . .</p>
<p>481</p>
<p>Modifying your Section Map for Speed or Size . . . . . . . . . . . .</p>
<p>498</p>
<p>Customizing the Run-Time Environment Program</p>
<p>Sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>499</p>
<p>Symbol Definitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>503</p>
<p>Beginning, End, and Size of Section Symbols . . . . . . . . . . . . . .</p>
<p>503</p>
<p>End of Function Symbols . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>504</p>
<p>Linker Generated Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>505</p>
<p>Forcing the Linker to Pull in a Module From a Library . . . . . .</p>
<p>506</p>
<p>Deleting Unused Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>507</p>
<p>Advanced Linker Features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>509</p>
<p>Code Factoring . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>509</p>
<p>Run-Time Clear and Copy Tables . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>511</p>
<p>Run-Time RAM Initialization and RAM Initialization</p>
<p>Table . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>512</p>
<p><i>xiii</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>10. The ax Librarian</b></p>
<p><b>515</b></p>
<p>Creating a Library from the Compiler Driver . . . . . . . . . . . . . . . . . .</p>
<p>516</p>
<p>Modifying Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>517</p>
<p>Librarian Commands . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>517</p>
<p>Librarian Command Modifiers . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>519</p>
<p>Librarian Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>521</p>
<p>Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>521</p>
<p>Creating and Updating a Table of Contents . . . . . . . . . . . . . . . . . . . .</p>
<p>522</p>
<p>The Green Hills 64-Bit Archive Format . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>522</p>
<p><b>11. Utility Programs</b></p>
<p><b>525</b></p>
<p>The gaddr2line Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>529</p>
<p>The gasmlist Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>530</p>
<p>The gcores Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>532</p>
<p>The gbin2c Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>536</p>
<p>Global Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>536</p>
<p>Module Inclusion Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>539</p>
<p>Local Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>539</p>
<p>The gbincmp Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>545</p>
<p>The gbuild Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>547</p>
<p>Using gbuild . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>552</p>
<p>Implicit Dependency Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>555</p>
<p>The gcolor Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>556</p>
<p>Color Configuration Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>557</p>
<p>Rules Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>558</p>
<p>The gcompare Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>561</p>
<p>The gdump Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>564</p>
<p>Debugging File Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>564</p>
<p>ELF File Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>566</p>
<p>COFF File Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>568</p>
<p>BSD a.out File Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>569</p>
<p>The gfile Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>571</p>
<p>The gfunsize Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>572</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xiv</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The ghide Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>573</p>
<p>Using ghide . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>573</p>
<p>The gmemfile Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>574</p>
<p>Data Splitting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>576</p>
<p>The gnm Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>581</p>
<p>General Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>581</p>
<p>ELF File Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>581</p>
<p>BSD a.out File Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>583</p>
<p>COFF File Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>584</p>
<p>Output Formats . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>584</p>
<p>The gpatch Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>586</p>
<p>The gpjmodify Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>588</p>
<p>Editing Existing .gpj Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>588</p>
<p>Creating a New .gpj File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>590</p>
<p>Generating a Makefile . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>591</p>
<p>The gsize Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>592</p>
<p>The gsrec Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>594</p>
<p>S-Record Output Format . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>597</p>
<p>Data and Termination Records . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>598</p>
<p>Data Splitting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>598</p>
<p>gsrec Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>599</p>
<p>The gstack Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>600</p>
<p>Preparing Your Program for gstack Analysis . . . . . . . . . . . . . . .</p>
<p>601</p>
<p>Annotating Assembly Functions for gstack . . . . . . . . . . . . . . . .</p>
<p>602</p>
<p>Annotating C Functions for gstack . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>603</p>
<p>Working With Recursive Clusters . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>605</p>
<p>Specifying Interrupts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>612</p>
<p>gstack Report Format . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>613</p>
<p>gstack Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>615</p>
<p>Specifying Functions with Non-Unique Names . . . . . . . . . . . .</p>
<p>617</p>
<p>The Problems During Execution Report Section . . . . . . . . . . . .</p>
<p>617</p>
<p>Caveats . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>619</p>
<p>The gstrip Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>620</p>
<p>The gversion Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>621</p>
<p>The gwhat Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>623</p>
<p>Version Extract Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>623</p>
<p><i>xv</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Version Update Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>624</p>
<p>The mevundump Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>626</p>
<p>Input Configuration File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>627</p>
<p>mevundump_lib RPC Library . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>638</p>
<p>Python RPC Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>642</p>
<p>AUTOSAR and OSEK Operating System Awareness . . . . . . . . . . .</p>
<p>644</p>
<p>Compiling the ORTI File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>645</p>
<p>Launching the ORTI OSA Explorer . . . . . . . . . . . . . . . . . . . . . .</p>
<p>646</p>
<p>ccorti Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>649</p>
<p>ORTI OSA Explorer Reference . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>649</p>
<p>ORTI Troubleshooting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>651</p>
<p>The protrans Utility . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>655</p>
<p><b>Part III. Language Reference</b></p>
<p><b>659</b></p>
<p><b>12. Green Hills C</b></p>
<p><b>661</b></p>
<p>Specifying a C Language Dialect . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>662</p>
<p>ANSI C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>663</p>
<p>ANSI C Extensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>663</p>
<p>Strict ANSI C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>669</p>
<p>GNU C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>670</p>
<p>GNU C Only Extensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>670</p>
<p>GNU C/C++ Extensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>673</p>
<p>Strict ISO C99 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>677</p>
<p>ISO C99 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>677</p>
<p>Preprocessor Support in C99 Mode . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>678</p>
<p>Enforced Requirements in C99 Mode . . . . . . . . . . . . . . . . . . . . .</p>
<p>678</p>
<p>Differences Between C99 Mode and ANSI C Mode . . . . . . . .</p>
<p>678</p>
<p>K&amp;R C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>679</p>
<p>K&amp;R Mode Extensions to K&amp;R C . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>680</p>
<p>Motor Industry Software Reliability Association (MISRA)</p>
<p>Rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>684</p>
<p>Japanese Automotive C Extensions . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>684</p>
<p>Sequence Related Undefined Behavior Checking . . . . . . . . . . . . . . .</p>
<p>685</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xvi</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Type Qualifiers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>686</p>
<p>__bytereversed . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>686</p>
<p>__bigendian and __littleendian . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>687</p>
<p>__packed . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>687</p>
<p>volatile . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>687</p>
<p>const . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>688</p>
<p>Assignment and Comparisons on struct and union Types . . . . . . . .</p>
<p>688</p>
<p>Bitfields . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>688</p>
<p>ANSI C Limitations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>689</p>
<p>Signedness of Bitfields . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>689</p>
<p>Size and Alignment of Bitfields . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>690</p>
<p>Enumerated Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>692</p>
<p>Functions with Variable Arguments . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>692</p>
<p>The &lt;varargs.h&gt; Facility . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>693</p>
<p>The &lt;stdarg.h&gt; Facility . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>694</p>
<p>The asm Statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>695</p>
<p>The Preprocessor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>697</p>
<p>Preprocessor Output File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>697</p>
<p>Extended Characters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>697</p>
<p>Compiler Support for Multi-Byte Characters . . . . . . . . . . . . . . .</p>
<p>698</p>
<p>Kanji Character Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>700</p>
<p>Compiler Limitations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>701</p>
<p>C Implementation-Defined Features . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>702</p>
<p>J.2 Undefined Behavior . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>703</p>
<p>J.3.1 Translation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>703</p>
<p>J.3.2 Environment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>704</p>
<p>J.3.3 Identifiers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>705</p>
<p>J.3.4 Characters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>705</p>
<p>J.3.5 Integers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>706</p>
<p>J.3.6 Floating-Point . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>707</p>
<p>J.3.7 Arrays and Pointers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>708</p>
<p>J.3.8 Hints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>709</p>
<p>J.3.9 Structures, Unions, Enumerations and Bit-fields . . . . . . .</p>
<p>709</p>
<p>J.3.10 Qualifiers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>711</p>
<p>J.3.11 Preprocessing Directives . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>711</p>
<p>J.3.12 Library Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>712</p>
<p><i>xvii</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>J.4 Locale-Specific Behavior . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>716</p>
<p>Additional Implementation Information . . . . . . . . . . . . . . . . . . .</p>
<p>718</p>
<p>Attributes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>718</p>
<p><b>13. Green Hills C++</b></p>
<p><b>733</b></p>
<p>Specifying a C++ Language Dialect . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>734</p>
<p>Specifying C++ Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>735</p>
<p>Standard C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>736</p>
<p>Extensions Accepted in Normal C++ Mode . . . . . . . . . . . . . . . .</p>
<p>737</p>
<p>Embedded C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>739</p>
<p>Differences Between Standard C++ and Embedded C++ . . . .</p>
<p>739</p>
<p>Extended Embedded C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>741</p>
<p>Features Supported by Each C++ Dialect . . . . . . . . . . . . . . . . . . . . . .</p>
<p>741</p>
<p>Standard C++ with ARM Extensions . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>742</p>
<p>GNU C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>743</p>
<p>GNU C++ Extensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>743</p>
<p>Template Instantiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>746</p>
<p>Prelinker Template Instantiation . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>746</p>
<p>Link-Once Template Instantiation . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>749</p>
<p>Instantiation Pragma Directives . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>750</p>
<p>Implicit Inclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>751</p>
<p>Exported Templates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>753</p>
<p>Multiple and Virtual Inheritance . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>754</p>
<p>Namespace Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>756</p>
<p>Dependent Name Lookup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>756</p>
<p>Lookup Using the Referencing Context . . . . . . . . . . . . . . . . . . .</p>
<p>757</p>
<p>Argument Dependent Lookup . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>758</p>
<p>Linkage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>758</p>
<p>Post Processing in C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>759</p>
<p>The C++ decode Utility . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>760</p>
<p>C++ Implementation-Defined Features . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>761</p>
<p>Deprecated C++ Headers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>766</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xviii</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>14. Coding Standards</b></p>
<p><b>767</b></p>
<p>GHS Standard Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>768</p>
<p>MISRA C 1998 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>768</p>
<p>Enforcing MISRA C 1998 Rules . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>770</p>
<p>MISRA C 1998 Rules Enforced by the Linker . . . . . . . . . . . . .</p>
<p>770</p>
<p>MISRA C 2004 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>771</p>
<p>Enforcing MISRA C 2004 Rules . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>771</p>
<p>MISRA C 2004 Rules Enforced by the Linker . . . . . . . . . . . . .</p>
<p>772</p>
<p>MISRA C 2004 Implementation . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>773</p>
<p>Creating Your Own Coding Standards with Coding Standard</p>
<p>Profiles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>774</p>
<p>Specifying a Coding Standard Profile . . . . . . . . . . . . . . . . . . . . .</p>
<p>775</p>
<p>Coding Standard Profile Syntax . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>776</p>
<p><b>15. Macros, Pragma Directives, and Intrinsics</b></p>
<p><b>779</b></p>
<p>Predefined Macro Names . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>780</p>
<p>Macro Formats . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>780</p>
<p>Macro Names Required by ANSI C and C++ . . . . . . . . . . . . . .</p>
<p>780</p>
<p>Language Identifier Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>783</p>
<p>Green Hills Toolchain Identification Macros . . . . . . . . . . . . . . .</p>
<p>784</p>
<p>V850 and RH850-Specific Predefined Macro Names . . . . . . .</p>
<p>785</p>
<p>Endianness Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>786</p>
<p>Data Type Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>786</p>
<p>Floating-Point Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>787</p>
<p>MISRA Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>788</p>
<p>Memory Model Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>788</p>
<p>Alignment and Packing Macros . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>790</p>
<p>Current File and Function Macros . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>791</p>
<p>Object Format Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>791</p>
<p>Optimization Predefined Macro Names . . . . . . . . . . . . . . . . . . .</p>
<p>792</p>
<p>C++ Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>792</p>
<p>Operating System-Specific Macros . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>793</p>
<p>Miscellaneous Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>793</p>
<p>Deprecated Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>793</p>
<p><i>xix</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Pragma Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>795</p>
<p>General Pragma Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>796</p>
<p>Green Hills Extension Pragma Directives . . . . . . . . . . . . . . . . .</p>
<p>799</p>
<p>_Pragma Operator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>808</p>
<p>Intrinsic Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>810</p>
<p>Exception Intrinsics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>811</p>
<p>Arithmetic Operation Instructions . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>812</p>
<p>Memory Barrier Optimization Intrinsics . . . . . . . . . . . . . . . . . .</p>
<p>813</p>
<p>Built-In Intrinsics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>813</p>
<p>Floating Point Bit Manipulation Intrinsics . . . . . . . . . . . . . . . . .</p>
<p>814</p>
<p>Static Assertions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>814</p>
<p><b>16. Libraries and Header Files</b></p>
<p><b>817</b></p>
<p>The Green Hills Header Files and Standard Libraries . . . . . . . . . . .</p>
<p>819</p>
<p>C and C++ Header File Directories . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>819</p>
<p>C and C++ Header Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>819</p>
<p>Library Directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>820</p>
<p>Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>820</p>
<p>Advanced Library Topics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>823</p>
<p>Less Buffered I/O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>823</p>
<p>64-bit Integer Arguments and printf . . . . . . . . . . . . . . . . . . . . . .</p>
<p>825</p>
<p>Memory Allocation and malloc() . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>825</p>
<p>Using Thread-Safe Library Functions . . . . . . . . . . . . . . . . . . . . .</p>
<p>826</p>
<p>Customizing Thread-Safe Library Functions . . . . . . . . . . . . . . .</p>
<p>831</p>
<p>Green Hills Standard C Library Functions . . . . . . . . . . . . . . . . . . . . .</p>
<p>832</p>
<p>Standard C Functions in libansi.a . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>833</p>
<p>Wide Character Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>847</p>
<p>libmath.a Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>848</p>
<p>libind.a Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>861</p>
<p>libstartup.a Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>861</p>
<p>Standard Function Names Converted by the Linker . . . . . . . . .</p>
<p>861</p>
<p>Customizing the Run-Time Environment Libraries and Object</p>
<p>Modules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>863</p>
<p>Creating a Project with a Customizable Run-Time</p>
<p>Environment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>863</p>
<p>Startup Module crt0.o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>865</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xx</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Low-Level Startup Library libstartup.a . . . . . . . . . . . . . . . . . . . .</p>
<p>867</p>
<p>Low-Level System Library libsys.a . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>868</p>
<p>Board Initialization Library libboardinit.a . . . . . . . . . . . . . . . . .</p>
<p>873</p>
<p>Features that Depend on the Default Green Hills Startup</p>
<p>Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>874</p>
<p><b>17. Mixing Languages and Writing Portable</b></p>
<p><b>Code</b></p>
<p><b>877</b></p>
<p>Mixing Languages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>878</p>
<p>Initialization of Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>879</p>
<p>Examples of main() Programs . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>879</p>
<p>Performing I/O on a Single File in Multiple Languages . . . . . .</p>
<p>880</p>
<p>C Routines and Header Files In C++ . . . . . . . . . . . . . . . . . . . . . .</p>
<p>880</p>
<p>Using C++ in C Programs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>881</p>
<p>Function Prototyping in C vs. C++ . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>882</p>
<p>Writing Portable Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>883</p>
<p>Compatibility Between Green Hills Compilers . . . . . . . . . . . . .</p>
<p>884</p>
<p>Word Size Differences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>884</p>
<p>Endianness Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>885</p>
<p>Alignment</p>
<p>Requirements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>886</p>
<p>Structures, Unions, Classes, and Bitfields . . . . . . . . . . . . . . . . .</p>
<p>887</p>
<p>Assumptions About Function Calling Conventions . . . . . . . . .</p>
<p>888</p>
<p>Pointer Issues . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>889</p>
<p>NULL Pointer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>889</p>
<p>Character Set Dependencies . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>889</p>
<p>Floating Point Range and Accuracy . . . . . . . . . . . . . . . . . . . . . .</p>
<p>890</p>
<p>Operating System Dependencies . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>890</p>
<p>Assembly Language Interfaces . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>891</p>
<p>Evaluation Order . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>891</p>
<p>Machine-Specific Arithmetic . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>891</p>
<p>Illegal Assumptions About Compiler Optimizations . . . . . . . .</p>
<p>892</p>
<p>Memory Optimization Restrictions . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>893</p>
<p>Problems with Source-Level Debuggers . . . . . . . . . . . . . . . . . .</p>
<p>894</p>
<p>Problems with Compiler Memory Size . . . . . . . . . . . . . . . . . . . .</p>
<p>895</p>
<p><i>xxi</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>18. Enhanced asm Macro Facility for C and</b></p>
<p><b>C++</b></p>
<p><b>897</b></p>
<p>Definition of Terms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>899</p>
<p>Using and Defining the asm Macro Facility . . . . . . . . . . . . . . . . . . . .</p>
<p>899</p>
<p>Pseudo-Code Definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>900</p>
<p>Use . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>900</p>
<p>Using asm Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>901</p>
<p>Definition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>903</p>
<p>Storage Modes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>903</p>
<p>asm Body . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>904</p>
<p>V850 and RH850 asm Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>905</p>
<p>Guidelines for Writing asm Macros . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>907</p>
<p><b>19. GNU Extended Assembly</b></p>
<p><b>909</b></p>
<p>Extended GNU Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>910</p>
<p>V850 and RH850 Extended GNU Support . . . . . . . . . . . . . . . . .</p>
<p>911</p>
<p><b>20. The ELF File Format</b></p>
<p><b>913</b></p>
<p>Formats of Relocatable and Executable Files . . . . . . . . . . . . . . . . . .</p>
<p>914</p>
<p>32-Bit ELF Data Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>915</p>
<p>ELF Headers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>916</p>
<p>ELF Identification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>919</p>
<p>ELF Sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>921</p>
<p>Section Headers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>921</p>
<p>Symbol</p>
<p>Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>930</p>
<p>Symbol Binding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>931</p>
<p>Symbol Type . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>931</p>
<p>Symbol Values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>932</p>
<p>String Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>933</p>
<p>Program Headers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>934</p>
<p>Program Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>935</p>
<p>Program Attribute Flags . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>936</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xxii</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Part IV. Appendices</b></p>
<p><b>939</b></p>
<p><b>A. Coding Standard Profile Reference</b></p>
<p><b>941</b></p>
<p>GHS Standard Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>942</p>
<p>Declarations, Definitions, and Initialization . . . . . . . . . . . . . . . .</p>
<p>942</p>
<p>Expressions and Control Flow . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>943</p>
<p>Preprocessing Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>944</p>
<p>Character Set Portability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>944</p>
<p>Standard Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>945</p>
<p>MISRA C 1998 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>945</p>
<p><b>B. GNU Options</b></p>
<p><b>951</b></p>
<p><b>C. Green Hills Project File Format</b></p>
<p><b>955</b></p>
<p>Green Hills Project File Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>956</p>
<p>The Header Section . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>957</p>
<p>The Project Options Section . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>959</p>
<p>The Children Section . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>959</p>
<p>Top Project Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>961</p>
<p>Group 1 Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>961</p>
<p>Group 2 Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>965</p>
<p>Conditional Control Statements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>965</p>
<p>Valid Conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>966</p>
<p>Special Conditions for Select One Projects . . . . . . . . . . . . . . . .</p>
<p>968</p>
<p>Macro Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>969</p>
<p>File Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>970</p>
<p><b>D. Porting an Existing Project to Use Build</b></p>
<p><b>Configurations</b></p>
<p><b>973</b></p>
<p>Build Configuration Quick Start . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>974</p>
<p>Setting Configuration-Specific Files and Options Outside of Build</p>
<p>Configuration Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>975</p>
<p><i>xxiii</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Defining Unique Output Directories for Build Configurations . . . .</p>
<p>976</p>
<p>Updating Output Directories . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>976</p>
<p>Updating Input Directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>977</p>
<p>Handling Custom File Types . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>978</p>
<p>Verifying Correctness . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>978</p>
<p>Helpful Tricks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>979</p>
<p>Additional Options to Check . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>980</p>
<p><b>E. Customization Files</b></p>
<p><b>983</b></p>
<p>Components of Customization Files . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>984</p>
<p>Customization File Definitions . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>985</p>
<p>Extended Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>989</p>
<p>Customization File Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>995</p>
<p>FileType Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>995</p>
<p>Context Sensitive Variables . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>997</p>
<p><b>F. The MULTI Eclipse Plug-in</b></p>
<p><b>1005</b></p>
<p>Prerequisites to Installing MULTI for Eclipse . . . . . . . . . . . . . . . . .</p>
<p>1007</p>
<p>Installing MULTI for Eclipse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>1008</p>
<p>Creating a Green Hills Project from Within Eclipse . . . . . . . . . . . .</p>
<p>1009</p>
<p>Creating an INTEGRITY Project . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>1010</p>
<p>Adding a Source File to Your Project . . . . . . . . . . . . . . . . . . . .</p>
<p>1013</p>
<p>Changing Compiler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>1013</p>
<p>Building and Running Your Project . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>1014</p>
<p>Debugging Your Project with the MULTI Debugger . . . . . . . . . . .</p>
<p>1016</p>
<p><b>G. Third-Party DES Copyright Information</b></p>
<p><b>1019</b></p>
<p><b>Index</b></p>
<p><b>1023</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xxiv</i></p>
<p><i>Contents</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Preface</b></p>
<p><b>Contents</b></p>
<p>About This Book . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxvi</p>
<p>The MULTI Document Set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxvi</p>
<p>Conventions Used in the MULTI Document Set . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxvii</p>
<p>The MULTI Toolchain . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxx</p>
<p>V850 and RH850 Recommended Reading . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>xxxii</p>
<h1 style="page-break-before:always; "></h1>
<p>This preface discusses the purpose of the manual, the MULTI documentation set,</p>
<p>and typographical conventions used.</p>
<p><b>About This Book</b></p>
<p>This book provides comprehensive documentation of the components that make up</p>
<p>the MULTI toolchain. It is divided into the following parts:</p>
<p>â¢</p>
<p><i>Part I: Using the MULTI Compiler</i> â Documents how to use the compiler</p>
<p>driver to control the toolchain. Includes an introduction to the compiler driver,</p>
<p>discussions of commonly-used features of the compiler for your target</p>
<p>environment, and descriptions of all the Builder and driver options.</p>
<p>â¢</p>
<p><i>Part II: Using Advanced Tools</i> â Documents the other elements of the</p>
<p>toolchain: the assembler, linker, librarian, and utility programs.</p>
<p>â¢</p>
<p><i>Part III: Language Reference</i> â Documents the Green Hills implementation</p>
<p>of high level languages, including macros,</p>
<p>#pragma</p>
<p>directives, libraries,</p>
<p>headers, and optimizations.</p>
<p>â¢</p>
<p><i>Part IV: Appendices</i> â Documents the use of GNU compiler options and</p>
<p>advanced options for customizing various file types.</p>
<p><b>Note</b></p>
<p>New or updated information may have become available while this book</p>
<p>was in production. For additional material that was not available at press</p>
<p>time, or for revisions that may have become necessary since this book</p>
<p>was printed, please check your installation directory for release notes,</p>
<p><b>README</b> files, and other supplementary documentation.</p>
<p><b>The MULTI Document Set</b></p>
<p>The primary documentation for using MULTI is provided in the following books:</p>
<p>â¢</p>
<p><i>MULTI: Getting Started</i> â Provides an introduction to the MULTI Integrated</p>
<p>Development Environment and leads you through a simple tutorial.</p>
<p>â¢</p>
<p><i>MULTI: Licensing</i> â Describes how to obtain, install, and administer MULTI</p>
<p>licenses.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xxvi</i></p>
<p><i>Preface</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><i>MULTI: Managing Projects and Configuring the IDE</i> â Describes how to</p>
<p>create and manage projects and how to configure the MULTI IDE.</p>
<p>â¢</p>
<p><i>MULTI: Building Applications</i> â Describes how to use the compiler driver</p>
<p>and the tools that compile, assemble, and link your code. Also describes the</p>
<p>Green Hills implementation of supported high-level languages.</p>
<p>â¢</p>
<p><i>MULTI: Configuring Connections</i> â Describes how to configure connections</p>
<p>to your target.</p>
<p>â¢</p>
<p><i>MULTI: Debugging</i> â Describes how to set up your target debugging interface</p>
<p>for use with MULTI and how to use the MULTI Debugger and associated tools.</p>
<p>â¢</p>
<p><i>MULTI: Debugging Command Reference</i> â Describes how to use Debugger</p>
<p>commands and provides a comprehensive reference of Debugger commands.</p>
<p>â¢</p>
<p><i>MULTI: Scripting</i> â Describes how to create MULTI scripts. Also contains</p>
<p>information about the MULTI-Python integration.</p>
<p>For a comprehensive list of the books provided with your MULTI installation, see</p>
<p>the<b> Help</b> â<b> Manuals</b> menu accessible from most MULTI windows.</p>
<p>All books are available in one or more of the following formats:</p>
<p>â¢</p>
<p>Print.</p>
<p>â¢</p>
<p>Online help, accessible from most MULTI windows via the<b> Help</b> â<b> Manuals</b></p>
<p>menu.</p>
<p>â¢</p>
<p>PDF, available in the<b> manuals</b> subdirectory of your MULTI or compiler</p>
<p>installation.</p>
<p><b>Conventions Used in the MULTI Document Set</b></p>
<p>All Green Hills documentation assumes that you have a working knowledge of your</p>
<p>host operating system and its conventions, including its command line and graphical</p>
<p>user interface (GUI) modes.</p>
<p>Green Hills documentation uses a variety of notational conventions to present</p>
<p>information and describe procedures. These conventions are described below.</p>
<p><i>xxvii</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Conventions Used in the MULTI Document Set</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example</b></p>
<p><b>Indication</b></p>
<p><b>Convention</b></p>
<p><b>C:\MyProjects</b></p>
<p>Filename or pathname</p>
<p><b>bold</b> type</p>
<p><b>setup</b> command</p>
<p>Command</p>
<p><b>-G</b> option</p>
<p>Option</p>
<p>The<b> Breakpoints</b> window</p>
<p>Window title</p>
<p>The<b> File</b> menu</p>
<p>Menu name or menu choice</p>
<p><b>Working Directory:</b></p>
<p>Field name</p>
<p>The<b> Browse</b> button</p>
<p>Button name</p>
<p><b>-o<i> filename</b></i></p>
<p>Replaceable text</p>
<p><i>italic</i> type</p>
<p>A task may be called a<i> process</i></p>
<p>or a<i> thread</i></p>
<p>A new term</p>
<p><i>MULTI: Debugging</i></p>
<p>A book title</p>
<p>Type</p>
<p>help<i> command_name</i></p>
<p>Text you should enter as presented</p>
<p>monospace</p>
<p>type</p>
<p>The<b> wait</b> [-global] command</p>
<p>blocks command processing,</p>
<p>where</p>
<p>-global</p>
<p>blocks</p>
<p>command processing for all</p>
<p>MULTI processes.</p>
<p>A word or words used in a</p>
<p>command or example</p>
<p>int a = 3;</p>
<p>Source code</p>
<p>&gt; print Test</p>
<p>Test</p>
<p>Input/output</p>
<p>GHS_System()</p>
<p>A function</p>
<p><b>debugbutton</b> [<i>name</i>]...</p>
<p>The preceding argument or option</p>
<p>can be repeated zero or more times.</p>
<p>ellipsis (...)</p>
<p>(in command line</p>
<p>instructions)</p>
<p>&gt; print Test</p>
<p>Test</p>
<p>Represents a prompt. Your actual</p>
<p>prompt may be a different symbol</p>
<p>or string. The &gt; prompt helps to</p>
<p>distinguish input from output in</p>
<p>examples of screen displays.</p>
<p>greater than sign ( &gt; )</p>
<p><b>call<i></b> func</i> |<i> expr</i></p>
<p>One (and only one) of the</p>
<p>parameters or options separated by</p>
<p>the pipe or pipes should be</p>
<p>specified.</p>
<p>pipe ( | )</p>
<p>(in command line</p>
<p>instructions)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xxviii</i></p>
<p><i>Preface</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example</b></p>
<p><b>Indication</b></p>
<p><b>Convention</b></p>
<p>.macro<i> name</i> [<i>list</i>]</p>
<p>Optional argument, command,</p>
<p>option, and so on. You can either</p>
<p>include or omit the enclosed</p>
<p>elements. The square brackets</p>
<p>should not appear in your actual</p>
<p>command.</p>
<p>square brackets ( [ ] )</p>
<p>(in command line</p>
<p>instructions)</p>
<p>The following command description demonstrates the use of some of these</p>
<p>typographical conventions.</p>
<p><b>gxyz</b> [<i>-option</i>]...<i> filename</i></p>
<p>The formatting of this command indicates that:</p>
<p>â¢</p>
<p>The command<b> gxyz</b> should be entered as shown.</p>
<p>â¢</p>
<p>The option</p>
<p><i>-option</i></p>
<p>should either be replaced with one or more appropriate</p>
<p>options or be omitted.</p>
<p>â¢</p>
<p>The word</p>
<p><i>filename</i></p>
<p>should be replaced with the actual filename of an</p>
<p>appropriate file.</p>
<p>The square brackets and the ellipsis should not appear in the actual command you</p>
<p>enter.</p>
<p><i>xxix</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Conventions Used in the MULTI Document Set</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The MULTI Toolchain</b></p>
<p><b>The C and C++ Compiler Driver</b></p>
<p>The compiler driver is the command line interface for invoking the components of</p>
<p>the toolchain. It takes high-level source and other files as input, and invokes a</p>
<p>compiler, the assembler, and the linker, to generate an executable.</p>
<p>Source Files</p>
<p>Compiler</p>
<p>Assembler</p>
<p>Libraries (.a)</p>
<p>Linker</p>
<p>Executable</p>
<p>The Compiler Driver</p>
<p>To get started using the driver, see Chapter 1, âThe Compiler Driverâ on page 3.</p>
<p><b>The Optimizing Compilers</b></p>
<p>The Green Hills compilers are an integrated family of optimizing compilers that</p>
<p>translate high-level language files into assembly language or object files.</p>
<p>Compiler</p>
<p>Source Files</p>
<p>Assembly</p>
<p>Files (.s)</p>
<p>There is a compiler for each of C and C++, which is composed of a language-specific</p>
<p>front end, a global optimizer, and a target-specific code generator. Compatible</p>
<p>subroutine calling conventions allow modules written in different languages to be</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xxx</i></p>
<p><i>Preface</i></p>
<h1 style="page-break-before:always; "></h1>
<p>combined. The compilers are invoked by the Builder or the appropriate compiler</p>
<p>driver.</p>
<p><b>The ease850 Assembler</b></p>
<p>The Green Hills assembler,<b> ease850</b>, translates V850 and RH850 assembly language</p>
<p>statements and directives into V850 and RH850 machine code and data formats.</p>
<p>The resulting file produced is an object file.</p>
<p>Assembler</p>
<p>Assembly</p>
<p>Files(.s)</p>
<p>Object</p>
<p>Files (.o)</p>
<p>The assembler is ordinarily invoked by the Builder or compiler driver, when required,</p>
<p>as part of the compilation process (see âControlling the Assemblerâ on page 79).</p>
<p>For information about invoking the assembler directly, and for a detailed description</p>
<p>of its operations, see Chapter 6, âThe ease850 Assemblerâ on page 393.</p>
<p>Use the<b> as850</b> assembler for the V850 target.</p>
<p><b>Note</b></p>
<p>The V850 and RH850 compiler defaults to<i> binary code generation</i>, which</p>
<p>allows the compiler to produce object files directly, without invoking the</p>
<p>assembler, and results in reduced compilation times.</p>
<p><b>The ax Librarian</b></p>
<p>The Green Hills librarian,<b> ax</b>, combines object files into a library file.</p>
<p>Librarian</p>
<p>Object</p>
<p>Files (.o)</p>
<p>Library (.a)</p>
<p>The linker can search libraries for object files to resolve external references. The</p>
<p>linker pulls in an object file from a library only if it is referenced in the program.</p>
<p>The librarian is ordinarily invoked from the Builder or compiler driver (see âCreating</p>
<p>Librariesâ on page 11).For information about invoking the librarian directly, and</p>
<p><i>xxxi</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The ease850 Assembler</i></p>
<h1 style="page-break-before:always; "></h1>
<p>for a detailed description of its operations, see Chapter 10, âThe ax Librarianâ</p>
<p>on page 515.</p>
<p><b>The elxr Linker</b></p>
<p>The Green Hills linker,<b> elxr</b>, combines object files into an executable.</p>
<p>Linker</p>
<p>Objects (.o)</p>
<p>Libraries (.a)</p>
<p>Executable</p>
<p>The linker resolves symbol references among all input files, and assigns symbols</p>
<p>to memory locations.</p>
<p>The linker is ordinarily invoked by the Builder or compiler driver as part of the</p>
<p>compilation process (see âControlling the Linkerâ on page 80). For information</p>
<p>about invoking the linker directly, and for a detailed description of its operations,</p>
<p>see Chapter 9, âThe elxr Linkerâ on page 469.</p>
<p><b>Optimized Libraries and Header Files</b></p>
<p>Green Hills provides optimized libraries and header files that support the standard</p>
<p>libraries specified by each language. The compiler driver selects the appropriate</p>
<p>libraries when linking, and header files when compiling. For more information, see</p>
<p>Chapter 16, âLibraries and Header Filesâ on page 817.</p>
<p><b>Utility Programs</b></p>
<p>The Green Hills Utility Programs allow you to analyze and perform various</p>
<p>operations on object files, libraries, and executables produced with the Green Hills</p>
<p>toolchain. For more information, see Chapter 11, âUtility Programsâ on page 525.</p>
<p><b>V850 and RH850 Recommended Reading</b></p>
<p>Hardware architecture guides can be downloaded from the Renesas Electronics</p>
<p>Web site. It is strongly recommended that users download and familiarize themselves</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>xxxii</i></p>
<p><i>Preface</i></p>
<h1 style="page-break-before:always; "></h1>
<p>with the Architecture Specifications and Application Binary Interface documentation</p>
<p>there.</p>
<p><i>xxxiii</i></p>
<p><i>Green Hills Software</i></p>
<p><i>V850 and RH850 Recommended Reading</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Part I</b></p>
<p><b>Using the MULTI Compiler</b></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 1</b></p>
<p><b>The Compiler Driver</b></p>
<p><b>Contents</b></p>
<p>Compiler Driver Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>5</p>
<p>Building an Executable from C or C++ Source Files . . . . . . . . . . . . . . . . . . . . . .</p>
<p>6</p>
<p>Working with Input Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>7</p>
<p>Generating Other Output File Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>10</p>
<p>Controlling Driver Information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>15</p>
<p>Using a Driver Options File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>15</p>
<p>Using Makefiles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>17</p>
<h1 style="page-break-before:always; "></h1>
<p>The compiler driver is the command line interface for various toolchain components.</p>
<p>The driver enables you to specify through various options how the toolchain should</p>
<p>process one or more input files into one or more output files. This chapter explains</p>
<p>how to use the driver and introduces some of the most important tasks it can perform.</p>
<p>For example, it can control all the components of the Green Hills toolchain necessary</p>
<p>to produce an executable from high-level source files:</p>
<p>â¢</p>
<p>The optimizing compilers for C and C++, which compile high-level source</p>
<p>files into V850 and RH850 assembly language files.</p>
<p>â¢</p>
<p>The<b> ease850</b> assembler, which translates V850 and RH850 assembly files into</p>
<p>object files.</p>
<p>â¢</p>
<p>The<b> elxr</b> linker, which links object files (including object files in libraries)</p>
<p>together to generate an executable.</p>
<p>Source Files</p>
<p>(.c, .cxx)</p>
<p>Compiler</p>
<p>Assembler</p>
<p>Linker</p>
<p>Executable</p>
<p>The Compiler Driver</p>
<p>Assembly</p>
<p>Files (.s)</p>
<p>Object Files</p>
<p>(.o)</p>
<p>In addition, the driver accepts many other forms of input files (see âWorking with</p>
<p>Input Filesâ on page 7) and can produce many different forms of output, (see</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>4</i></p>
<p><i>Chapter 1. The Compiler Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p>âGenerating Other Output File Typesâ on page 10). The driver is often invoked</p>
<p>through a higher level interface, such as the MULTI</p>
<p>Builder, makefiles, shell scripts, or batch files. For more information about the</p>
<p>MULTI Builder, see<i> MULTI: Managing Projects and Configuring the IDE</i>.</p>
<p><b>Compiler Driver Syntax</b></p>
<p>The syntax for using the compiler driver is:</p>
<p><i><b>driver</b></i> [<i> file</i> | -<i>option</i> ]...</p>
<p>where:</p>
<p>â¢</p>
<p><i>driver</i> is one of the following:</p>
<p>â</p>
<p><b>ccv850 or ccrh850</b>â for programs that only contain C files</p>
<p>â</p>
<p><b>cxv850 or cxrh850</b>â for programs that contain C and C++ files</p>
<p>Throughout this manual<b> ccv850</b> and<b> cxv850</b> are used in examples. However,</p>
<p>they can be interchanged with the corresponding equivalent<b> ccrh850</b> or<b> cxrh850</b></p>
<p>driver as appropriate. The<b> ccrh850</b> and<b> cxrh850</b> commands differ from<b> ccv850</b></p>
<p>and<b> cxv850</b> in that they default to<b> -cpu=rh850g3k</b>.</p>
<p>â¢</p>
<p><i>file</i> is one or more of the following:</p>
<p>â</p>
<p>C or C++ source file.</p>
<p>â</p>
<p>Assembly source file.</p>
<p>â</p>
<p>Object file or library of object files.</p>
<p>â</p>
<p>Linker directives file (see âPassing Linker Directives Files to the Driverâ</p>
<p>on page 9).</p>
<p>â¢</p>
<p><i>-option</i> is one or more compiler driver options. All of the options are</p>
<p>case-sensitive (for example<b> -l</b> specifies a library, while<b> -L</b> specifies a library</p>
<p>directory), and most are host-independent. Some commonly used options are</p>
<p>discussed in this chapter. All of the driver options are listed and explained in</p>
<p>Chapter 3, âBuilder and Driver Optionsâ on page 127.</p>
<p>Files and options are listed on the command line, separated by spaces.</p>
<p><i>5</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Compiler Driver Syntax</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The driver reads all options before processing any files. When two options represent</p>
<p>different choices for the same feature, the later choice overrides the earlier one. If</p>
<p>it encounters an unrecognized or invalid option, the driver will ignore it and issue</p>
<p>a warning.</p>
<p>After reading the options, the driver processes files in the order they appear on the</p>
<p>command line. If an error occurs in one file, processing will continue with the next</p>
<p>file. If no errors occur, all object files and libraries will be linked together according</p>
<p>to the order specified on the command line.</p>
<p><b>Building an Executable from C or C++ Source Files</b></p>
<p>When the driver receives source language files as input, it invokes the appropriate</p>
<p>compiler, assembler, and linker to produce an executable.</p>
<p>To build an executable from a C source file called<b> hello.c</b>, use the C driver,<b> ccv850</b>,</p>
<p>and enter the following:</p>
<p>ccv850 hello.c</p>
<p>To build an executable from a C++ source file called<b> hello.cxx</b>, use the C++ driver,</p>
<p><b>cxv850</b>, and enter the following:</p>
<p>cxv850 hello.cxx</p>
<p>In each case, an executable file called<b> a.out</b> is generated, together with the following</p>
<p>additional files:<b> hello.o</b>,<b> a.map</b>,<b> a.dnm</b> and<b> a.dla</b></p>
<p>The<b> hello.o</b> file is the object file which results from passing<b> hello.c</b> through the</p>
<p>compiler and assembler (the driver always retains the intermediate object files for</p>
<p>future re-use). The<b> a.map</b> file is a map file produced by the linker. The<b> a.dnm</b> and</p>
<p><b>a.dla</b> files contain basic debugging information for use with the MULTI Debugger.</p>
<p>For instructions on generating full debugging information for MULTI, see</p>
<p>âGenerating Debugging Informationâ on page 55.</p>
<p>To build an executable from multiple source files, list the files on the command</p>
<p>line, separated by spaces, as follows:</p>
<p>ccv850 hello.c foo.c bar.c</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>6</i></p>
<p><i>Chapter 1. The Compiler Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p>This command generates an executable called<b> a.out</b>, the debugging files<b> a.dnm</b> and</p>
<p><b>a.dla</b>, a map file<b> a.map</b>, and three object files,<b> hello.o</b>,<b> foo.o</b>, and<b> bar.o</b>.</p>
<p><b>Working with Input Files</b></p>
<p><b>Note</b></p>
<p>The example command lines in this section, and in the remainder of this</p>
<p>chapter, are shown using the C driver,<b> ccv850</b>. They will also work with</p>
<p>the C++ driver,<b> cxv850</b>.</p>
<p>In addition to high-level language source files, the driver can also process assembly</p>
<p>language files, object files, and libraries. The diagram below shows how these files</p>
<p>are passed to the various tools in the toolchain.</p>
<p>Source Files</p>
<p>Compiler</p>
<p>Assembler</p>
<p>Libraries (.a)</p>
<p>Linker</p>
<p>Executable</p>
<p>The Compiler Driver</p>
<p>Assembly</p>
<p>Files (.s)</p>
<p>Object</p>
<p>Files (.o)</p>
<p><b>Recognized Input File Types</b></p>
<p>The compiler driver determines the type of a file (and hence the compilation steps</p>
<p>to perform on it) from its extension. For example, a file with a<b> .c</b> extension is a C</p>
<p>source file and needs to be compiled with the C compiler, assembled, and then</p>
<p>linked.</p>
<p>The following is a partial list of file extensions which the driver recognizes:</p>
<p><i>7</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Working with Input Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>C source files:<b> .c</b>,<b> .i</b></p>
<p>â¢</p>
<p>C++ source files:<b> .C</b>,<b> .cc</b>,<b> .cpp</b>,<b> .cxx</b></p>
<p>â¢</p>
<p>Assembly language files:<b> .s</b>,<b> .asm</b>,<b> .800</b></p>
<p>â¢</p>
<p>V850 and RH850 assembly language files with C preprocessor directives:<b> .850</b></p>
<p>â¢</p>
<p>Object files:<b> .o</b></p>
<p>â¢</p>
<p>Library files:<b> .a</b></p>
<p>â¢</p>
<p>Linker directives files:<b> .ld</b></p>
<p><b>Note</b></p>
<p>To configure the compiler driver to treat files with a<b> .C</b> extension as C</p>
<p>source files (rather than C++ source files) define the following macro in</p>
<p>your Top Project file:</p>
<p>GHS_IGNORE_CAPS_FOR_C_FILE_EXT=1</p>
<p>.</p>
<p><b>Manually Setting Input File Types</b></p>
<p>On the command line, use<b> -filetype.<i>suffix</b></i> to indicate that the next file on the</p>
<p>command line has the type appropriate for<i> suffix</i>. For example:</p>
<p>ccv850 -filetype.cc hello.i</p>
<p>compiles<b> hello.i</b> as if it were a C++ file.</p>
<p>To process all C files as C++ files, use the following syntax:</p>
<p>cxv850 -dotciscxx<i> files</i></p>
<p><b>Passing Multiple Input File Types to the Driver</b></p>
<p>To pass assembly files, object files, and libraries to the driver, add them to the</p>
<p>command line, separated by spaces. For example:</p>
<p>ccv850 hello.c foo.cxx bar.s baz.o libfoo.a</p>
<p>C and C++ source files can be included in the same executable as long as one of</p>
<p>the following is done so that the program is linked properly:</p>
<p>â¢</p>
<p>Use the C++ driver,<b> cxv850</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>8</i></p>
<p><i>Chapter 1. The Compiler Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Pass</p>
<p>-language=cxx</p>
<p>â¢</p>
<p>Put at least one C++ source file on the driver command line that is used to link</p>
<p>the program.</p>
<p>For more information about mixing C and C++ in the same executable, see âInput</p>
<p>Languagesâ on page 276.</p>
<p><b>Passing Linker Directives Files to the Driver</b></p>
<p>Linker Directives (<b>.ld</b>) files define the program sections of the executable and assign</p>
<p>them to specific regions of memory.</p>
<p>To pass a linker directives file to the driver, add it to the command line as follows</p>
<p>(no option is required; the file is recognized by its extension):</p>
<p>ccv850 hello.c mylinkfile.ld</p>
<p>This command overrides the default linker directive files normally selected by the</p>
<p>driver based on the current options. Several default<b> .ld</b> files are provided (see</p>
<p>âWorking with Linker Directives Filesâ on page 80), and the most appropriate one</p>
<p>is used automatically. You can edit the default files to specify your own layout. For</p>
<p>full documentation of the syntax, see âConfiguring the Linker with Linker Directives</p>
<p>Filesâ on page 475.</p>
<p><i>9</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Passing Linker Directives Files to the Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Generating Other Output File Types</b></p>
<p>The driver can be instructed to halt the compilation process at various stages in</p>
<p>order to produce assembly files, object files, libraries, or other forms of output.</p>
<p>Assembler</p>
<p>Assembly</p>
<p>Files (.s)</p>
<p>Object</p>
<p>Files (.o)</p>
<p>Linker</p>
<p>Executable</p>
<p>Librarian</p>
<p>Libraries (.a)</p>
<p>Objects (.o)</p>
<p>Library (.a)</p>
<p>Compiler</p>
<p>Source Files</p>
<p>Assembly</p>
<p>Files (.s)</p>
<p>Compiler Driver</p>
<p>To instruct the compiler to halt the build process after the compiler has generated</p>
<p>assembly files, use the<b> -S</b> option as follows:</p>
<p>ccv850 hello.c -S</p>
<p>This command produces an assembly language file called<b> hello.s</b>.</p>
<p>To instruct the compiler to halt the build process after the compiler has generated</p>
<p>assembly files and the assembler has translated them to object files, use the<b> -c</b> option</p>
<p>as follows:</p>
<p>ccv850 hello.c -c</p>
<p>This produces an object file called<b> hello.o</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>10</i></p>
<p><i>Chapter 1. The Compiler Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Creating Libraries</b></p>
<p>You can pass high-level source files, assembly language files, and object files to</p>
<p>the driver, and instruct it to collect them into a library. The driver invokes the</p>
<p>compiler and/or the assembler (if required) to produce object files, and then invokes</p>
<p>the librarian to combine these object files into a library.</p>
<p>Librarian</p>
<p>Object</p>
<p>Files (.o)</p>
<p>Library (.a)</p>
<p>To instruct the driver to create a library from the C source file<b> hello.c</b> and the object</p>
<p>file<b> foo.o</b>, use the<b> -archive</b> option as follows:</p>
<p>ccv850 hello.c foo.o -archive -o libfoo.a</p>
<p>This command produces a library of object files called<b> libfoo.a</b>, which contains two</p>
<p>object files,<b> hello.o</b> and<b> foo.o</b>.</p>
<p><b>Note</b></p>
<p>When using the<b> -archive</b> option to create a library, you must use the<b> -o</b></p>
<p>option to specify a name for it.</p>
<p>For more information, see âCreating a Library from the Compiler Driverâ</p>
<p>on page 516.</p>
<p><b>Adding and Updating Files in Libraries</b></p>
<p>To add an object file to an existing library or to update an object file already included</p>
<p>in a library, use the<b> -archive</b> and<b> -o</b> options in the same way you would to create</p>
<p>that library. For example, to generate an object file from the C source file<b> hello.c</b></p>
<p>and add this object file to library<b> libfoo.a</b>, enter the following:</p>
<p>ccv850 hello.c -archive -o libfoo.a</p>
<p>To perform other operations on libraries, you must invoke<b> ax</b> directly. For more</p>
<p>information, see Chapter 10, âThe ax Librarianâ on page 515.</p>
<p><i>11</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Creating Libraries</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Driver Options for Intermediate Forms of Output</b></p>
<p>The following table lists all of the driver options that instruct the driver to stop at</p>
<p>particular stages of the compilation process.</p>
<p><b>Note</b></p>
<p>These options only apply to the compiler driver and cannot be set from</p>
<p>the Project Manager. To set them manually, see Appendix C, âGreen</p>
<p>Hills Project File Formatâ on page 955.</p>
<p><b>-archive</b></p>
<p>Runs the<b> ax</b> librarian to generate a library instead of running the linker to generate an executable</p>
<p>program. For more information, see âCreating a Library from the Compiler Driverâ on page 516.</p>
<p><b>-c</b></p>
<p>Produces an object file (called<i><b> input-file</i>.o</b>) for each source file.</p>
<p><b>-E</b></p>
<p>Runs the preprocessor and writes the preprocessed file output to</p>
<p>stdout</p>
<p>unless the<b> -o</b> option</p>
<p>is specified. This option can be useful when debugging preprocessor macros and</p>
<p>#include</p>
<p>files.</p>
<p>Each preprocessing directive is replaced with a blank line, unless there are several in a row, in</p>
<p>which case they are replaced with a single</p>
<p>#line</p>
<p>marker that specifies the line number of the</p>
<p>next line of code in the original file.</p>
<p><b>-merge_archive</b></p>
<p>Runs the<b> ax</b> librarian with the<b> C</b> and<b> M</b> options to generate a merged library instead of running</p>
<p>the linker to generate an executable program. For more information, see âCreating a Library</p>
<p>from the Compiler Driverâ on page 516.</p>
<p><b>-P</b></p>
<p>Runs the preprocessor and writes the preprocessed file output to<i><b> input-file</i>.i</b> by default. Each</p>
<p>preprocessing directive is replaced with a blank line.</p>
<p><b>-Q</b></p>
<p>Produces only an inline file (called<i><b> input-file</i>.inf</b>) for each source file. These files contain</p>
<p>partially compiled code for functions generated during the first pass of the inliner, together with</p>
<p>the list of the include files that the source file depends on (which are used by automatic</p>
<p>dependency checking).</p>
<p><b>-S</b></p>
<p>Produces an assembly file (called<i><b> input-file</i>.s</b>) for each source file.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>12</i></p>
<p><i>Chapter 1. The Compiler Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-syntax</b></p>
<p>Checks the syntax without generating code.</p>
<p><b>Note</b></p>
<p>See also the driver options associated with the<b> LinkerâGenerate</b></p>
<p><b>Additional Output</b> option in âLinker Optionsâ on page 235.</p>
<p><b>Output File Types</b></p>
<p>The following table lists the types of files generated by the toolchain, MULTI Project</p>
<p>Manager and Debugger:</p>
<p><b>.ael</b></p>
<p>A file generated by<b> intex</b> for an INTEGRITY application. It contains information that the</p>
<p>Debugger uses to debug your application. If this file is deleted, you must relink the corresponding</p>
<p>INTEGRITY application to regenerate it.</p>
<p><b>bmon.out</b></p>
<p><b>gmon.out</b></p>
<p><b>mon.out</b></p>
<p>Profiling data files that are generated when the program runs and are read only by the toolchain.</p>
<p><b>.d</b></p>
<p>Source code dependency files generated by the compiler.</p>
<p><b>.dep</b></p>
<p>Program dependency files generated by the compiler.</p>
<p><b>.dba</b></p>
<p><b>.dbo</b></p>
<p><b>.dla</b></p>
<p><b>.dlo</b></p>
<p><b>.dnm</b></p>
<p>Debugging information files that are written only by the toolchain, and read by the toolchain</p>
<p>and debugger. See âDebugging Optionsâ on page 176.</p>
<p><b>.env</b></p>
<p>A file that is used to determine whether environment variables or macros affecting a project</p>
<p>have changed.<b> .env</b> files are read and written only by the toolchain.</p>
<p><i>13</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Output File Types</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>.graph</b></p>
<p>Call graph information that is written only by the toolchain, and read by the user.</p>
<p><b>.idep</b></p>
<p>Dependency files generated by<b> intex</b>.</p>
<p><b>.ii</b></p>
<p><b>.ti</b></p>
<p>C++ template information files that are read and written only by the toolchain.</p>
<p><b>.inf</b></p>
<p>Database files used for intermodule inlining that are read and written only by the toolchain.</p>
<p><b>.ipf</b></p>
<p>Database files used for interprocedural analysis that are read and written only by the toolchain.</p>
<p><b>.lcp</b></p>
<p>INTEGRITY-only files that are generated by the driver for<b> intex</b>. It contains the command line</p>
<p>used when building with<b> -kernel</b> so that<b> intex</b> is able to relink the executable itself.</p>
<p><b>.lst</b></p>
<p>An assembler source listing that is written by the toolchain, and read only by the user. See</p>
<p>âAssembler Optionsâ on page 232.</p>
<p><b>.map</b></p>
<p>A map file generated by the linker that contains information about how the program is laid out</p>
<p>in memory.<b> .map</b> files are written by the toolchain, and read only by the user. See âLinker</p>
<p>Output Analysisâ on page 248.</p>
<p><b>.mem</b></p>
<p>An additional copy of the executable image that has been translated by the<b> gmemfile</b> utility.</p>
<p><b>.mem</b> files are written by the toolchain, and read by non-GHS utility programs. See âLinker</p>
<p>Optionsâ on page 235.</p>
<p><b>.run</b></p>
<p>An additional copy of the executable image that has been translated by the<b> gsrec</b> utility.<b> .run</b></p>
<p>files are written by the toolchain, and read by non-GHS utility programs.</p>
<p><b>.time</b></p>
<p>Files that are generated by the Project Manager when the file being processed does not generate</p>
<p>an output file. This allows the Project Manager to track if and when the item was last processed</p>
<p>for dependency tracking.<b> .time</b> files are read and written only by the toolchain.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>14</i></p>
<p><i>Chapter 1. The Compiler Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Controlling Driver Information</b></p>
<p>The following options control the transfer of information to and from the driver</p>
<p>itself.</p>
<p><b>Note</b></p>
<p>These options only apply to the compiler driver and cannot be set from</p>
<p>the Project Manager.</p>
<p><b>@<i>filename</b></i></p>
<p>Instructs the driver to read command line arguments from<i> filename</i>.</p>
<p><b>-#</b></p>
<p>Displays the command lines generated by the driver (which are used to call the compiler,</p>
<p>assembler, and/or linker for processing the input files) without executing them. For compatibility</p>
<p>purposes, this option can also be entered as<b> -dryrun</b> or<b> --driver_debug</b>.</p>
<p><b>-help</b></p>
<p>Displays a list of some of the more commonly used options with brief descriptions.</p>
<p><b>-v</b></p>
<p>Displays the command lines generated by the driver as it calls the compiler, assembler, and/or</p>
<p>linker for processing of input files.</p>
<p><b>Using a Driver Options File</b></p>
<p>When using multiple driver options, you may find that your command lines become</p>
<p>overly long and hard to read. You can, instead, enter your options into a plain text</p>
<p>file, which you pass to the driver using the<b> @<i>filename</b></i> option.</p>
<p>All characters in the file other than spaces, tabs, newline characters, and double</p>
<p>quotes are literal.</p>
<p>Options and arguments must be separated by spaces, tabs, or newline characters.</p>
<p>The double quote (</p>
<p>&quot;</p>
<p>) may be used to include spaces or tabs in a single argument as</p>
<p>follows:</p>
<p>â¢</p>
<p>If the argument begins with a</p>
<p>&quot;</p>
<p>, then everything on the line up to the next</p>
<p>&quot;</p>
<p>will be part of the argument, and those quotes will be discarded.</p>
<p><i>15</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Controlling Driver Information</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Otherwise, if a</p>
<p>&quot;</p>
<p>is in the middle of an argument, the</p>
<p>&quot;</p>
<p>will not be discarded,</p>
<p>but will cause any whitespace on the line up to the next</p>
<p>&quot;</p>
<p>to be included in the</p>
<p>argument.</p>
<p><b>Note</b></p>
<p>Due to limitations in the command line parser, the<b> -bsp</b> and<b> -layout</b></p>
<p>options cannot be entered in a driver options file and must be placed</p>
<p>directly on the driver command line, either before or after any<b> @<i>file</b></i></p>
<p>option.</p>
<p><b>Example 1.1. How to Use a Driver Options File</b></p>
<p>The plain text file<b> myoptfile</b> contains the following information:</p>
<p>hello.c foo.c bar.c</p>
<p>-G</p>
<p>-Ospeed -OI</p>
<p>-o foo</p>
<p>To invoke the driver with the options file contained in<b> myoptfile</b>, enter:</p>
<p>ccv850 @myoptfile -bsp=sa1 -layout=romrun</p>
<p>This command instructs the driver to read<b> myoptfile</b> and to:</p>
<p>â¢</p>
<p>Pass files<b> hello.c</b>,<b> foo.c</b>, and<b> bar.c</b> to the compiler, assembler, and linker.</p>
<p>â¢</p>
<p>Generate MULTI debugging information (<b>-G</b>).</p>
<p>â¢</p>
<p>Compile the files in such a way as to maximize the speed of the final executable,</p>
<p>including using two-pass inlining (<b>-Ospeed -OI</b>).</p>
<p>â¢</p>
<p>Name the output executable<b> foo</b> (<b>-o foo</b>).</p>
<p>â¢</p>
<p>Generate code tailored to the instruction set associated with the</p>
<p>CEB-V850-SA1</p>
<p>board, and assign the program to memory regions of that board using a</p>
<p>board-specific linker directives file (<b>-bsp=sa1 -layout=romrun</b>).</p>
<p><b>Note</b></p>
<p>You cannot include comments in a command file that you pass to the</p>
<p>compiler driver with this option. Do not use this option to read a file</p>
<p>containing assembler or linker options. Instead, use<b> -asmcmd=<i>filename</b></i></p>
<p>(see âAssembler Optionsâ on page 232) or<b> -lnkcmd=<i>filename</b></i> (âLinker</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>16</i></p>
<p><i>Chapter 1. The Compiler Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Optionsâ on page 235) to pass the file option directly to the assembler or</p>
<p>the linker, respectively. Note that linker directives files should be passed</p>
<p>to the linker by using a known suffix, such as<b> .ld</b> or<b> .lnk</b>, rather than using</p>
<p>this option.</p>
<p><b>Using Makefiles</b></p>
<p>This section discusses the basic issues involved in porting existing makefiles for</p>
<p>use with Green Hills compilers.</p>
<p>In each of the following examples, we port a makefile from the fictional compiler</p>
<p><b>qcc</b> to the Green Hills compiler<b> ccv850</b>. We assume that<b> qcc</b> uses fairly standard</p>
<p>command line syntax.</p>
<p><b>Example 1.2. A Very Simple Build</b></p>
<p>The following is an example of a very simple<b> qcc</b> makefile:</p>
<p>scanprog: scanprog.c</p>
<p>qcc -O2 scanprog.c -o scanprog</p>
<p>To convert this makefile for use with<b> ccv850</b>, you would need to make the following</p>
<p>changes:</p>
<p>â¢</p>
<p>Change the invocation of<b> qcc</b> to<b> ccv850</b>.</p>
<p>â¢</p>
<p>Change the optimization option<b> -O2</b> to a Green Hills option, such as<b> -Ogeneral</b></p>
<p>(which enables general optimizations).</p>
<p>The resulting<b> ccv850</b> makefile will look like the following:</p>
<p>scanprog: scanprog.c</p>
<p>ccv850 -Ogeneral scanprog.c -o scanprog</p>
<p><b>Example 1.3. Makefile Macros, Incremental Build</b></p>
<p>The following is a common format for a makefile. It uses an incremental build</p>
<p>process (building<b> .c</b> files to<b> .o</b> files, and then linking them). It also uses makefile</p>
<p>macros (such as<b> CC</b> and<b> CFLAGS</b>) to gather commonly-modified parts of the</p>
<p>makefile in one place:</p>
<p><i>17</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Using Makefiles</i></p>
<h1 style="page-break-before:always; "></h1>
<p>CC=qcc</p>
<p>CFLAGS=-g -I../include -DITERATIONS=3 -O3</p>
<p>LFLAGS=-L../lib -lxyzlib</p>
<p>OFILES=bigprog.o main.o utils.o</p>
<p>bigprog: $(OFILES)</p>
<p>$(CC) $(LFLAGS) $(OFILES) -o $@</p>
<p>bigprog.o: bigprog.c bigprog.h utils.h</p>
<p>main.o: main.c bigprog.h</p>
<p>utils.o: utils.c utils.h</p>
<p>To convert this makefile for use with<b> ccv850</b>, you would need to change the macros</p>
<p>as follows:</p>
<p>â¢</p>
<p>Change:</p>
<p>CC=qcc</p>
<p>to:</p>
<p>CC=ccv850</p>
<p>â¢</p>
<p>Change:</p>
<p>CFLAGS=-g -I../include -DITERATIONS=3 -O3</p>
<p>to:</p>
<p>CFLAGS=-G -I../include -DITERATIONS=3 -Ospeed -OI</p>
<p><b>Example 1.4. Mixing Languages</b></p>
<p>In this example, two C files, one V850 and RH850 assembly file, and one C++ file</p>
<p>are linked together into a single executable:</p>
<p>OFILES=myprog.o utils1.o utils2.o interface.o</p>
<p>myprog: $(OFILES)</p>
<p>qcc $(OFILES) -o myprog</p>
<p>myprog.o: myprog.c utils.h</p>
<p>qcc -c myprog.c</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>18</i></p>
<p><i>Chapter 1. The Compiler Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p>utils1.o: utils1.c utils.h</p>
<p>qcc -c utils1.c</p>
<p>utils2.o: utils1.s</p>
<p>qasm -c utils1.s</p>
<p>interface.o: interface.cpp</p>
<p>qc++ -c interface.cpp</p>
<p>Porting this example to use<b> cxv850</b> is easy because the Green Hills drivers recognize</p>
<p>filename extensions and invoke the correct compiler or assembler automatically.</p>
<p>Consequently, you would simply need to change all references to<b> qcc</b>,<b> qasm</b>, and</p>
<p><b>qc++</b> to<b> cxv850</b>, so that the makefile would read as follows:</p>
<p>OFILES=myprog.o utils1.o utils2.o interface.o</p>
<p>myprog: $(OFILES)</p>
<p>cxv850 $(OFILES) -o myprog</p>
<p>myprog.o: myprog.c utils.h</p>
<p>cxv850 -c myprog.c</p>
<p>utils1.o: utils1.c utils.h</p>
<p>cxv850 -c utils1.c</p>
<p>utils2.o: utils1.s</p>
<p>cxv850 -c utils1.s</p>
<p>interface.o: interface.cpp</p>
<p>cxv850 -c interface.cpp</p>
<p><b>Example 1.5. Using Interprocedural Optimizations With Makefiles</b></p>
<p>Building a program typically involves using a compiler and an assembler to translate</p>
<p>high-level source files to object files and a linker to link those objects together (see</p>
<p>âThe MULTI Toolchainâ on page xxx). When building with interprocedural</p>
<p>optimizations enabled (see âInterprocedural Optimizationsâ on page 168), the</p>
<p>compiler is invoked in at least three separate passes to perform its part of the</p>
<p>translation. The first pass produces an inline file (called<i><b> input-file</i>.inf</b>) for each C</p>
<p>or C++ source file. The middle pass reads each of these<b> .inf</b> files, analyzes them</p>
<p>for interprocedural optimization opportunities, and writes them back out with</p>
<p><i>19</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Using Makefiles</i></p>
<h1 style="page-break-before:always; "></h1>
<p>additional information. The third and final pass reads the<b> .inf</b> files, along with the</p>
<p>original source files, and uses the information that was added to the<b> .inf</b> files during</p>
<p>the middle pass to perform additional optimizations as it compiles the source to</p>
<p>object code or assembly.</p>
<p>When building a program using makefiles, each of these compiler passes may be</p>
<p>specified individually to provide greater control over how each pass is performed.</p>
<p>In this example, three C files are compiled together using wholeprogram</p>
<p>optimizations (see âWholeprogram Optimizationsâ on page 341):</p>
<p>CC=ccv850</p>
<p>SRCS=src/file1.c src/file2.c src/file3.c</p>
<p>INFS=objs/file1.inf objs/file2.inf objs/file3.inf</p>
<p>OBJS=objs/file1.o objs/file2.o objs/file3.o</p>
<p>CFLAGS=-object_dir=objs -Owholeprogram -Ogeneral -I.</p>
<p>myprog: ${OBJS}</p>
<p>${CC} -o myprog ${OBJS}</p>
<p># This is the first pass, where an .inf file is generated for</p>
<p># each C file. The compiler driver is invoked with the -Q option</p>
<p># to tell it to generate the .inf file instead of compiling the</p>
<p># source file to object code.</p>
<p>objs/%.inf: src/%.c ${SRCS}</p>
<p>${CC} ${CFLAGS} $&lt; -Q</p>
<p># This is the middle pass, where the .inf files are processed.</p>
<p># The driver is invoked with the -Qnormalize option and a list</p>
<p># of all of the .inf files for the program. Note that no source</p>
<p># files are specified. A dummy file &quot;qnormalize&quot; is used to</p>
<p># guarantee that this step is completed before moving on to the</p>
<p># final pass.</p>
<p>qnormalize: ${INFS}</p>
<p>${CC} ${CFLAGS} ${INFS} -Qnormalize</p>
<p>touch qnormalize</p>
<p># This is the final pass, where individual source files are</p>
<p># compiled to object code. The driver is invoked with the</p>
<p># -Qfinal and -c options and a list of all of the .inf files</p>
<p># for the program.</p>
<p>objs/%.o: src/%.c objs/%.inf qnormalize</p>
<p>${CC} ${CFLAGS} ${INFS} $&lt; -c -Qfinal</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>20</i></p>
<p><i>Chapter 1. The Compiler Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Note that when using wholeprogram optimizations with makefiles, as with<b> gbuild</b>,</p>
<p>you must make all parts of your program available to the compiler for analysis (see</p>
<p>âUsing gbuild with Interprocedural Optimizationsâ on page 345).</p>
<p>An important requirement of wholeprogram optimizations is that a list of all functions</p>
<p>and variables that are used externallyâthat is, in object files or libraries that are</p>
<p>linked into the program but do not have corresponding<b> .inf</b> filesâmust be provided</p>
<p>to the compiler (see âSymbols Referenced Externallyâ on page 170). When building</p>
<p>with makefiles, these pre-compiled objects and libraries can be passed to the driver</p>
<p>on the command line for the middle pass, along with<b> -Qnormalize</b> and the list of</p>
<p><b>.inf</b> files to process, to instruct it to automatically analyze the objects for external</p>
<p>references. This means that assembly files, for which<b> .inf</b> files are never generated,</p>
<p>may be assembled prior to the middle pass and their resulting object files passed in</p>
<p>the<b> -Qnormalize</b> command in lieu of specifying the names of functions and variables</p>
<p>referenced in those files to the compiler via the<b> -external</b> option. While this approach</p>
<p>is not required, it is<i> strongly</i> encouraged as it reduces the chances of error due to</p>
<p>the source code changing without the list of externally referenced symbols being</p>
<p>updated. For more information about<b> -Qnormalize</b>, see the next section.</p>
<p><b>Driver Options for Individual Compiler Passes</b></p>
<p>The following options should be used when invoking the driver to perform the</p>
<p>compiler passes related to interprocedural optimizations individually, as shown in</p>
<p>the previous example. (See also the<b> -Q</b> option in âDriver Options for Intermediate</p>
<p>Forms of Outputâ on page 12.)</p>
<p><b>-Qnormalize</b></p>
<p>Instructs the compiler driver to process a set of inline (<b>.inf</b>) files. This option is used when</p>
<p>performing individual compiler passes related to interprocedural optimizations (see</p>
<p>Example 1.5. Using Interprocedural Optimizations With Makefiles on page 19).</p>
<p>The set of<b> .inf</b> files provided as input when this option is used should be exactly the same as</p>
<p>the set provided with the<b> -Qfinal</b> option when invoking the driver to perform the final pass.</p>
<p>Build options such as optimization settings should be the same in this pass as in the others. This</p>
<p>option is not compatible with<b> gbuild</b>.</p>
<p><i>21</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Driver Options for Individual Compiler Passes</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-Qfinal</b></p>
<p>Instructs the compiler driver to compile a list of one or more source files to object code (with</p>
<p><b>-c</b>) or assembly (with<b> -S</b>). This option is used when performing individual compiler passes</p>
<p>related to interprocedural optimizations (see Example 1.5. Using Interprocedural Optimizations</p>
<p>With Makefiles on page 19).</p>
<p>Along with the source files to compile, the driver should be given the same list of<b> .inf</b> files that</p>
<p>was provided with the<b> -Qnormalize</b> option when it was invoked to process those files in the</p>
<p>preceding pass.</p>
<p>Build options such as optimization settings should be the same in this pass as in the others. This</p>
<p>option is not compatible with<b> gbuild</b>.</p>
<p><b>Green Hills Equivalents to GNU Tools</b></p>
<p>The following table provides the Green Hills equivalents to common GNU tools:</p>
<p><b>Green Hills</b></p>
<p><b>GNU</b></p>
<p>CC=ccv850</p>
<p>CC=gcc</p>
<p>CXX=cxv850</p>
<p>CXX=g++</p>
<p>LD=cxv850</p>
<p>LD=ld</p>
<p>AR=ax</p>
<p>AR=cxv850 -archive</p>
<p>AR=ar</p>
<p>Use</p>
<p>AR=ax</p>
<p>for libraries written entirely in C, and for which you do not need debug</p>
<p>information. For C++ libraries involving instantiable entities such as templates,</p>
<p>either compile using the<b> --link_once_templates</b> option, or use</p>
<p>AR=cxv850</p>
<p>-archive</p>
<p>, which requires additional modifications to the rules in your makefile</p>
<p>that create libraries.</p>
<p><b>Generating Dependency and Header File Information</b></p>
<p>These options provide information about your makefile structure:</p>
<p><b>-H</b></p>
<p>Prints to</p>
<p>stderr</p>
<p>a list of files opened by</p>
<p>#include</p>
<p>directives during normal compilation. Files</p>
<p>are compiled and linked normally. This option can be used together with<b> -syntax</b> to print the</p>
<p>names of header files without producing any other output.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>22</i></p>
<p><i>Chapter 1. The Compiler Driver</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-MD</b></p>
<p><b>-MMD</b></p>
<p><b>--no_make_depends</b></p>
<p><b>-MF</b>=<i>filename</i></p>
<p>By default, no makefile dependency files are generated. To specify this behavior explicitly, use</p>
<p><b>--no_make_depends</b>.</p>
<p><b>-MD</b> produces the following makefile dependency files:</p>
<p>â¢</p>
<p>One<i><b> input-file</i>.d</b> for each object file.</p>
<p>â¢</p>
<p>One<i><b> input-file</i>.dep</b> for each program.</p>
<p>Duplicate dependencies are eliminated and only one rule is output for a single object file. The</p>
<p>source and program dependency files have different extensions to prevent one file from</p>
<p>overwriting another in the case that an object file has the same name as a program file.</p>
<p>The backslash (</p>
<p>\</p>
<p>) character is used to form continuation lines.</p>
<p>This option has no effect if<b> -syntax</b> is passed.</p>
<p><b>-MMD</b> behaves the same as<b> -MD</b>, but does not include system header directories (see</p>
<p><b>-sys_include_directory</b>) or C++ headers.</p>
<p><b>-MF</b>=<i>filename</i> option changes the generated dependency filename to that specified. This option</p>
<p>is only effective when specified with<b> -MD</b> or<b> -MMD</b>. If specified for multiple source files, this</p>
<p>option is ignored with a warning.</p>
<p>These options only apply to the compiler driver and cannot be set from the Project Manager.</p>
<p><i>23</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Generating Dependency and Header File Information</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 2</b></p>
<p><b>Developing for V850 and</b></p>
<p><b>RH850</b></p>
<p><b>Contents</b></p>
<p>V850 and RH850 Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>26</p>
<p>Structure Packing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>28</p>
<p>Register Usage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>33</p>
<p>Calling Conventions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>35</p>
<p>The Stack . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>37</p>
<p>Target-Specific Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>39</p>
<p>SIMD Vector Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>40</p>
<p>FPSIMD Vector Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>42</p>
<p>Software Trace Logging Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>45</p>
<p>Specifying a V850 and RH850 Target . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>52</p>
<p>Enabling Debugging Features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>55</p>
<p>Using Your Own Header Files and Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>76</p>
<p>Controlling the Assembler . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>79</p>
<p>Controlling the Linker . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>80</p>
<p>Text and Data Placement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>82</p>
<p>Customizing the Green Hills Run-Time Environment . . . . . . . . . . . . . . . . . . .</p>
<p>121</p>
<p>Other Topics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>122</p>
<h1 style="page-break-before:always; "></h1>
<p>This chapter describes the V850 and RH850 target environment and provides</p>
<p>information about some of the Builder and driver options that access and control</p>
<p>features of that environment.</p>
<p>The Green Hills V850 and RH850 compiler, assembler, and linker comply with the</p>
<p><i>V850 and RH850 Embedded Application Binary Interface</i> specification (<i>V850 and</i></p>
<p><i>RH850 EABI</i>).</p>
<p><b>V850 and RH850 Characteristics</b></p>
<p>The V850 and RH850 memory is byte-addressed with 32-bit addresses. However,</p>
<p>some processors will fix the high bits of the program counter (PC) to zero, depending</p>
<p>on the specific implementation's instruction address space capabilities. The V850</p>
<p>supports a 16 MB instruction address space (the high 8 bits of the PC are fixed to</p>
<p>zero). Similarly, the V850E supports a 64 MB instruction address space (the high</p>
<p>6 bits of the PC are fixed to zero), while the V850E2 supports a 512 MB instruction</p>
<p>address space (the high 3 bits of the PC are fixed to zero). Newer processors such</p>
<p>as the RH850 can optionally support up to a full 4 GB of instruction address space</p>
<p>(no bits of the PC are fixed to zero). Bits are numbered with bit zero as the least</p>
<p>significant bit.</p>
<p>By default, bytes are ordered with the least significant byte of a multiple-byte value</p>
<p>stored at the lowest address (little endian format).</p>
<p>However, the bytes of 32-bit instructions are ordered in a special manner: A 32-bit</p>
<p>instruction is first divided into two 16-bit units, and then each of the two units is</p>
<p>ordered independently in little endian format.</p>
<p><b>A+3</b></p>
<p><b>A+2</b></p>
<p><b>A+1</b></p>
<p><b>A</b></p>
<p>12</p>
<p>34</p>
<p>BC</p>
<p>20</p>
<p>Floating-point values use IEEE-754 format (32 and 64 bits) and are in the same</p>
<p>byte order as other values.</p>
<p><b>Note</b></p>
<p>Although we follow the IEEE-754 floating-point format, floating-point</p>
<p>operations might not generate the exact values required by the</p>
<p>specification.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>26</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>On systems where the compiler generates code for a floating-point unit,</p>
<p>the floating-point computation is as accurate as the underlying hardware</p>
<p>(Green Hills does not supply software libraries to handle cases that the</p>
<p>hardware may ignore or signal an exception on). On systems where the</p>
<p>Green Hills floating-point emulation routines are used instead of hardware,</p>
<p>the floating-point emulation routines are designed for speed, and the</p>
<p>results may differ from the IEEE specification, particularly in exceptional</p>
<p>cases such as NANs and denormals.</p>
<p>Character encoding is ASCII.</p>
<p>The stack is always 4-byte aligned.</p>
<p>In C and C++ , bitfields are allocated starting at the lowest memory address. Bitfields</p>
<p>begin at the least significant bit in little endian mode and at the most significant bit</p>
<p>in big endian mode. Each structure, union, and array is aligned to the maximum</p>
<p>alignment requirement of any of its components.</p>
<p><b>C and C++ Data Type Sizes and Alignment Requirements</b></p>
<p>The following table lists the data type alignments for C and C++:</p>
<p><b>Alignment</b></p>
<p><b>Size</b></p>
<p><b>C/C++ Data Type</b></p>
<p>8</p>
<p>8</p>
<p>char</p>
<p>16</p>
<p>16</p>
<p>short</p>
<p>32</p>
<p>32</p>
<p>int</p>
<p>32</p>
<p>32</p>
<p>long</p>
<p>64</p>
<p>64</p>
<p>long long</p>
<p>32</p>
<p>32</p>
<p>float</p>
<p>64</p>
<p>64</p>
<p>double</p>
<p>64</p>
<p>64</p>
<p>long double</p>
<p>32</p>
<p>32</p>
<p>*</p>
<p>32</p>
<p>32</p>
<p>enum</p>
<p>(default)</p>
<p><b>Note</b></p>
<p>64-bit types may be stored with only 32-bit alignment when placed on</p>
<p>the stack; the hardware only requires 32-bit alignment.</p>
<p><i>27</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C and C++ Data Type Sizes and Alignment Requirements</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>To reduce the size and alignment requirement of the</p>
<p>enum</p>
<p>type to 8 or</p>
<p>16 bits where possible:</p>
<p>Set the<b> C/C++ CompilerâData TypesâUse Smallest Type Possible</b></p>
<p><b>for Enum</b> option to<b> On</b> (<b>--short_enum</b>). For more information, see</p>
<p>âUse Smallest Type Possible for Enumâ on page 214.</p>
<p><b>Structure Packing</b></p>
<p><b>Note</b></p>
<p>Support for structure packing in C++ is limited. See the release notes for</p>
<p>more information.</p>
<p>This section discusses structure packing and shows you how to specify structure</p>
<p>packing options to the compiler. In general, you use the</p>
<p>#pragma pack(<i>n</i>)</p>
<p>directive</p>
<p>to instruct the compiler to pack all instances of a particular structure type. You then</p>
<p>use the</p>
<p>__packed</p>
<p>type qualifier when declaring any pointer that might point to a</p>
<p>field in a packed structure. This section is organized into several parts that contain</p>
<p>more detailed information about how structure packing works:</p>
<p>â¢</p>
<p>âUnderstanding Structure Packingâ on page 28</p>
<p>â¢</p>
<p>âUsing #pragma pack to Pack All Instances of a Structure Typeâ on page 30</p>
<p>â¢</p>
<p>âUsing the Packing Builder Option to Pack All Structuresâ on page 31</p>
<p>â¢</p>
<p>âPointing to Packed Structures with the __packed Type Qualifierâ on page 32</p>
<p><b>Understanding Structure Packing</b></p>
<p><i>Structure packing</i> is a feature you can use to reduce the amount of memory that</p>
<p>instances of your structures require. Understanding how structure packing works</p>
<p>is important, because this feature affects the alignment of your structures and the</p>
<p>fields they contain.</p>
<p>A structure is<i> aligned to n bytes</i> if the compiler places it at an address offset by a</p>
<p>multiple of<i> n</i> bytes from the beginning of the section. By default, a structure's</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>28</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>alignment requirement is equal to the largest of any of its fields'</p>
<p>alignment</p>
<p>requirements. A structure is<i> naturally aligned</i> if it is aligned to its alignment</p>
<p>requirement. Otherwise, the structure is<i> misaligned</i>. Like all data types, a structure's</p>
<p>size is a multiple of its alignment requirement, so that multiple instances of the</p>
<p>structure remain aligned when the compiler places them in an array.</p>
<p>The Green Hills compilers always allocate fields of a structure in the order specified</p>
<p>in the declaration. A field is aligned to<i> n</i> bytes if the compiler places it at an address</p>
<p>offset by a multiple of<i> n</i> bytes from the beginning of the containing (unpacked)</p>
<p>structure. A field is naturally aligned if it is aligned to its alignment requirement.</p>
<p>Otherwise, the field is misaligned. For a list of the alignment requirements for each</p>
<p>data type, see âC and C++ Data Type Sizes and Alignment Requirementsâ</p>
<p>on page 27.</p>
<p>If the compiler is placing a field or structure, and placing it at the next available</p>
<p>address would make it misaligned, the compiler will insert bytes of<i> padding</i> until</p>
<p>it can place the field or structure so that it is naturally aligned.</p>
<p>Structure packing reduces the amount of padding the compiler inserts between fields</p>
<p>in a structure. When using structure packing, you give the compiler a<i> packing</i></p>
<p><i>alignment</i>. When the compiler places a field in a packed structure, it aligns that</p>
<p>field to its alignment requirement, or the packing alignment, whichever is smaller.</p>
<p>This means that the compiler will insert at most<i> n</i>-1 bytes of padding between fields,</p>
<p>where<i> n</i> is the packing alignment. The compiler aligns a packed structure itself to</p>
<p>the largest of any of its fields'</p>
<p>alignment requirements, or the packing alignment,</p>
<p>whichever is smaller.</p>
<p>As an example, say you define struct</p>
<p>s</p>
<p>like so:</p>
<p>struct s {</p>
<p>short a;</p>
<p>int b;</p>
<p>char c;</p>
<p>} d[2];</p>
<p>The following diagram shows how the compiler will allocate</p>
<p>d[2]</p>
<p>using its natural</p>
<p>alignment, with a 2-byte packing alignment, and with a 1-byte packing alignment:</p>
<p><i>29</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Understanding Structure Packing</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Notice that when the compiler uses structure packing,</p>
<p>d[2]</p>
<p>takes up fewer bytes,</p>
<p>but some of the fields and structures are misaligned.</p>
<p><b>Using #pragma pack to Pack All Instances of a Structure Type</b></p>
<p><b>Note</b></p>
<p>Support for structure packing in C++ is limited. See the release notes for</p>
<p>more information.</p>
<p>You can instruct the compiler to pack all instances of a particular structure type by</p>
<p>using the</p>
<p>#pragma pack(<i>n</i>)</p>
<p>directive, where<i> n</i> is the packing alignment in bytes,</p>
<p>is a power of two, and is less than or equal to</p>
<p>__ghs_max_pack_value</p>
<p>. The</p>
<p>directive must appear before the beginning of the structure definition,<i> not</i> inside it.</p>
<p>The directive affects all subsequent structure definitions until the next</p>
<p>#pragma</p>
<p>pack(<i>n</i>)</p>
<p>directive, or the end of the translation unit. If you do not specify<i> n</i>, then</p>
<p>the compiler does not pack subsequent structures, unless you have set the<b> C/C++</b></p>
<p><b>CompilerâAlignment and PackingâPacking (Maximum Structure Alignment)</b></p>
<p>Builder option (see âUsing the Packing Builder Option to Pack All Structuresâ</p>
<p>on page 31 for more information).</p>
<p><b>Example 2.1. #pragma pack Scope</b></p>
<p>When you use the</p>
<p>#pragma pack(<i>n</i>)</p>
<p>directive around a structure declaration, the</p>
<p>compiler packs all instances of that structure. The directive does not affect instance</p>
<p>declarations.</p>
<p>struct s {</p>
<p>short a;</p>
<p>int b;</p>
<p>char c;</p>
<p>} j;</p>
<p>#pragma pack(2)</p>
<p>struct s k;</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>30</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>struct s2 {</p>
<p>short a;</p>
<p>int b;</p>
<p>char c;</p>
<p>} x;</p>
<p>#pragma pack()</p>
<p>struct s2 y;</p>
<p>The size of both</p>
<p>j</p>
<p>and</p>
<p>k</p>
<p>is 12. The compiler will place two bytes of padding between</p>
<p>field</p>
<p>a</p>
<p>and field</p>
<p>b</p>
<p>. Because you already defined</p>
<p>struct s</p>
<p>, the</p>
<p>#pragma pack(2)</p>
<p>directive does not affect the declaration of</p>
<p>k</p>
<p>.</p>
<p>The size of both</p>
<p>x</p>
<p>and</p>
<p>y</p>
<p>is 8. The compiler will not place padding between field</p>
<p>a</p>
<p>and field</p>
<p>b</p>
<p>. Because you already defined</p>
<p>struct s2</p>
<p>, the</p>
<p>#pragma pack()</p>
<p>directive does not affect the declaration of</p>
<p>y</p>
<p>.</p>
<p><b>Warning</b></p>
<p>When building applications for INTEGRITY, you must ensure that there</p>
<p>is no structure packing in effect when including an INTEGRITY or system</p>
<p>header.</p>
<p><b>Using the Packing Builder Option to Pack All Structures</b></p>
<p>You can set the packing alignment for all structures in your program by using the</p>
<p><b>C/C++ CompilerâAlignment and PackingâPacking (Maximum Structure</b></p>
<p><b>Alignment)</b> Builder option.</p>
<p>Set the<b> C/C++ CompilerâAlignment and PackingâPacking (Maximum</b></p>
<p><b>Structure Alignment)</b> Builder option (<b>-pack=<i>n</b></i>), where<i> n</i> is the packing alignment</p>
<p>in bytes, and has a value of 1, 2, 4, or 8.</p>
<p><b>Note</b></p>
<p>When using this Builder option on a project, you use the</p>
<p>__packed</p>
<p>qualifier on any pointer that points to a field in any structure declared in</p>
<p>that project. See âPointing to Packed Structures with the __packed Type</p>
<p>Qualifierâ on page 32 for more information.</p>
<p><i>31</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Using the Packing Builder Option to Pack All Structures</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Warning</b></p>
<p>This option is not supported with INTEGRITY; it may cause your</p>
<p>program to use structure layouts that are incompatible with the rest of</p>
<p>INTEGRITY. If you need to use structure packing in an INTEGRITY</p>
<p>application, you should use either the</p>
<p>__packed</p>
<p>qualifier or the</p>
<p>#pragma</p>
<p>pack</p>
<p>variants to mark only those structures that require packing. For</p>
<p>more information, see âPointing to Packed Structures with the __packed</p>
<p>Type Qualifierâ on page 32 and âUsing #pragma pack to Pack All</p>
<p>Instances of a Structure Typeâ on page 30.</p>
<p><b>Pointing to Packed Structures with the __packed Type Qualifier</b></p>
<p><b>Note</b></p>
<p>Support for structure packing in C++ is limited. See the release notes for</p>
<p>more information.</p>
<p>The</p>
<p>__packed</p>
<p>type qualifier tells the compiler that a particular pointer might point</p>
<p>to a misaligned structure or field. compiler uses this information to generate</p>
<p>additional code that handles accesses to misaligned fields in software, if necessary.</p>
<p>Because any field in a packed structure might be misaligned, you must use the</p>
<p>__packed</p>
<p>type qualifier when declaring any pointer that points to a field in a packed</p>
<p>structure. For instance, if you pack the following structure:</p>
<p>#pragma pack(2)</p>
<p>struct s {</p>
<p>short a;</p>
<p>int b;</p>
<p>char c;</p>
<p>} x;</p>
<p>#pragma pack()</p>
<p>and then create a pointer to a field in that packed structure:</p>
<p>int *p = &amp;(x.b);</p>
<p>Because</p>
<p>&amp;(x.b)</p>
<p>points to a misaligned field in a packed structure, the compiler</p>
<p>issues warning 1973, and the program might exhibit unexpected behavior. Instead,</p>
<p>use:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>32</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__packed int *p = &amp;(x.b);</p>
<p>The program now runs as expected, because the compiler generates code to handle</p>
<p>misaligned accesses through</p>
<p>*p</p>
<p>.</p>
<p>If you take the address of the entire packed structure into a pointer of that structure's</p>
<p>type, it is not necessary to use the</p>
<p>__packed</p>
<p>type qualifier, because the structure</p>
<p>type is already declared as packed. For example:</p>
<p>/* Correct */</p>
<p>struct s *p1 = &amp;x;</p>
<p>/* Correct, but __packed is unnecessary here*/</p>
<p>__packed struct s *p2 = &amp;x;</p>
<p>char buf[sizeof(struct s)];</p>
<p>memcpy(buf, &amp;x, sizeof(struct s));</p>
<p>/* Correct - p2 can point to a struct object with 1-byte alignment */</p>
<p>p2 = (__packed struct s *)buf;</p>
<p>/* Incorrect - buf might not have the 2-byte alignment required by struct s */</p>
<p>p1 = (struct s *)buf;</p>
<p><b>Note</b></p>
<p>Do not declare objects as both</p>
<p>__packed</p>
<p>and</p>
<p>volatile</p>
<p>simultaneously,</p>
<p>or put</p>
<p>volatile</p>
<p>fields inside a packed structure. Loads and stores of</p>
<p>such objects might exhibit unexpected behavior.</p>
<p><b>Register Usage</b></p>
<p>Thirty-two 32-bit general purpose registers are used for both integer values and</p>
<p>single-precision floating-point values. A set of system registers is also available.</p>
<p>Double precision 64-bit floating-point values are contained in two adjacent 32-bit</p>
<p>registers. The low word is stored in the lower register.</p>
<p>The V850 and RH850 toolchain supports three software modes of register usage,</p>
<p>controlled with the<b> TargetâRegister Mode</b> option (<b>-registermode=22|26|32</b>),</p>
<p>which allows you to specify 22, 26, or 32 registers. For more information, see</p>
<p>âRegister Modeâ on page 130.</p>
<p>The register modes are shown below:</p>
<p><i>33</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Register Usage</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Notes</b></p>
<p><b>Common Usage</b></p>
<p><b>Alternate</b></p>
<p><b>Name</b></p>
<p><b>Register</b></p>
<p>Zero (read-only)</p>
<p>r0</p>
<p>Address generation in compiler</p>
<p>and assembler</p>
<p>r1</p>
<p>Unused if the<b> TargetâRegister</b></p>
<p><b>r2</b> option is enabled</p>
<p>(<b>-reserve_r2</b>).</p>
<p>Temporary</p>
<p>r2</p>
<p>Stack pointer</p>
<p>sp</p>
<p>r3</p>
<p>Global pointer (SDA and PID</p>
<p>base register)</p>
<p>gp</p>
<p>r4</p>
<p>ROSDA base register</p>
<p>tp</p>
<p>r5</p>
<p>Parameters</p>
<p>r6</p>
<p>â</p>
<p>r9</p>
<p>Function return value/temporary</p>
<p>r10</p>
<p>High part of 64-bit return</p>
<p>value/temporary</p>
<p>r11</p>
<p>Temporary</p>
<p>r12</p>
<p>Temporary</p>
<p>r13</p>
<p>Temporary</p>
<p>r14</p>
<p>Unused in 22-register mode</p>
<p>Temporary</p>
<p>r15</p>
<p>Unused in 22-register mode</p>
<p>Temporary</p>
<p>r16</p>
<p>Unused in 22- and 26-register</p>
<p>modes</p>
<p>Temporary</p>
<p>r17</p>
<p>Unused in 22- and 26-register</p>
<p>modes</p>
<p>Temporary</p>
<p>r18</p>
<p>Unused in 22- and 26-register</p>
<p>modes</p>
<p>Temporary</p>
<p>r19</p>
<p>Unused in 22- and 26-register</p>
<p>modes</p>
<p>Permanent</p>
<p>r20</p>
<p>Unused in 22- and 26-register</p>
<p>modes</p>
<p>Permanent</p>
<p>r21</p>
<p>Unused in 22- and 26-register</p>
<p>modes</p>
<p>Permanent</p>
<p>r22</p>
<p>Unused in 22-register mode</p>
<p>Permanent</p>
<p>r23</p>
<p>Unused in 22-register mode</p>
<p>Permanent</p>
<p>r24</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>34</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Notes</b></p>
<p><b>Common Usage</b></p>
<p><b>Alternate</b></p>
<p><b>Name</b></p>
<p><b>Register</b></p>
<p>Permanent</p>
<p>r25</p>
<p>Permanent</p>
<p>r26</p>
<p>Permanent</p>
<p>r27</p>
<p>Frame pointer/permanent</p>
<p>fp</p>
<p>r28</p>
<p>Local PIC base</p>
<p>register/permanent</p>
<p>r29</p>
<p>Not allocated to if the</p>
<p><b>-no_allocate_ep</b> option is used.</p>
<p>Temporary by default. TDA base</p>
<p>register /permanent when TDA</p>
<p>is enabled.</p>
<p>ep</p>
<p>r30</p>
<p>Link pointer</p>
<p>lp</p>
<p>r31</p>
<p><b>Calling Conventions</b></p>
<p>For a module to access arguments and local variables on the stack, the stack must</p>
<p>always be located at a 4-byte boundary at the entry to a procedure, subroutine, or</p>
<p>function. If the first procedure, subroutine, or function (called by the operating</p>
<p>system or system library) is called correctly, then every subsequent one will be</p>
<p>called correctly.</p>
<p>All call arguments following the first argument are evaluated first, from left to right,</p>
<p>and then the remaining non-call arguments are evaluated from left to right. For</p>
<p>example:</p>
<p>foo(a+b, bar(), c, zog(), d);</p>
<p>The arguments are evaluated in this order:</p>
<p>bar()</p>
<p>,</p>
<p>zog()</p>
<p>,</p>
<p>a+b</p>
<p>,</p>
<p>c</p>
<p>,</p>
<p>d</p>
<p>.</p>
<p>Another example:</p>
<p>foo(bar(), a+b, c, zog(), baz());</p>
<p>The arguments are evaluated in this order:</p>
<p>zog()</p>
<p>,</p>
<p>baz()</p>
<p>,</p>
<p>bar()</p>
<p>,</p>
<p>a+b</p>
<p>,</p>
<p>c</p>
<p>.</p>
<p>In C and C++, each scalar argument is extended to a 32-bit value after it is evaluated,</p>
<p>unless the corresponding formal parameter has floating-point type and an ANSI</p>
<p>prototype is visible. In this case, the argument is converted into either a 32-bit or</p>
<p>64-bit floating-point value according to the formal parameter.</p>
<p><i>35</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Calling Conventions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>In C and C++, each floating-point argument is extended to a 64-bit value after it is</p>
<p>evaluated, unless the corresponding formal parameter is either a single-precision</p>
<p>floating point or an integer type and an ANSI prototype is visible. If the formal</p>
<p>parameter is single-precision, the argument is converted to a 32-bit floating-point</p>
<p>value. If the formal parameter is scalar, the argument is converted to a 32-bit scalar</p>
<p>value.</p>
<p>Any further type conversion is performed upon entry to the called procedure.</p>
<p>Arguments are assigned stack offsets from left to right. The first argument is always</p>
<p>at offset zero. The size of the first argument is rounded up to a multiple of four</p>
<p>bytes to determine the offset of the second argument. If the second argument requires</p>
<p>8-byte alignment and its offset would not otherwise be a multiple of eight bytes,</p>
<p>the second argument's offset is increased by four bytes. This is repeated until offsets</p>
<p>have been assigned to all arguments. The size of the entire argument area is then</p>
<p>increased if necessary so that it will also be a multiple of four bytes. If this argument</p>
<p>area is larger than 16 bytes, then a space large enough to hold this argument area</p>
<p>less 16 bytes is present on the stack immediately before the call.</p>
<p>In general, the arguments are allocated to the stack according to their stack offsets,</p>
<p>unless it is possible to place them in registers.</p>
<p>Arguments with offsets 0, 4, 8, and 12 are placed in parameter registers</p>
<p>r6</p>
<p>through</p>
<p>r9</p>
<p>, respectively, including single-precision and double-precision floating-point</p>
<p>numbers. Thus in C and C++, scalar, pointer, and floating-point arguments are</p>
<p>eligible to pass in registers, as well as some structures and unions. All remaining</p>
<p>arguments are passed on the stack.</p>
<p>A varargs function in<i> K&amp;R</i> only has</p>
<p>va_alist</p>
<p>as its arguments, and they are all</p>
<p>considered to be passed in memory. Therefore on entry to a varargs function, all</p>
<p>the parameter registers (</p>
<p>r6</p>
<p>through</p>
<p>r9</p>
<p>) are first saved on the stack so that all</p>
<p>arguments can be accessed from the stack.</p>
<p>For a stdargs function in ANSI, all arguments are passed as they would be for a</p>
<p>normal function call. However, on entry to a stdargs function, if</p>
<p>&quot;...&quot;</p>
<p>is in one</p>
<p>of the parameter registers (</p>
<p>r6</p>
<p>through</p>
<p>r9</p>
<p>), that register plus all parameter registers</p>
<p>following it are first saved on the stack, so that all arguments starting from</p>
<p>&quot;...&quot;</p>
<p>can be accessed from the stack.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>36</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>On the V850, V850E, and V850E2: A call to a procedure, subroutine, or function</p>
<p>uses a</p>
<p>jarl<i> routine</i>, lp</p>
<p>instruction that saves the return address in</p>
<p>r31</p>
<p>(</p>
<p>lp</p>
<p>).</p>
<p>The return uses a</p>
<p>jmp [r31]</p>
<p>instruction.</p>
<p>Return values that are scalar or pointer are returned in</p>
<p>r10</p>
<p>, sign- or zero-extended</p>
<p>to 32 bits for types smaller than 32 bits. 32-bit floating-point values are returned in</p>
<p>register</p>
<p>r10</p>
<p>. 64-bit floating-point values are returned in the register pair</p>
<p>r10</p>
<p>,</p>
<p>r11</p>
<p>.</p>
<p>To call a function that returns a structure or union in C and C++, the address of a</p>
<p>temporary of the return type is passed by the caller in</p>
<p>r6</p>
<p>. The function returns the</p>
<p>structure value by copying the return value to the address pointed to by</p>
<p>r6</p>
<p>and</p>
<p>copies</p>
<p>r6</p>
<p>into</p>
<p>r10</p>
<p>before returning to the caller.</p>
<p>A procedure, subroutine, or function call is assumed to destroy the contents of all</p>
<p>registers except the permanent registers (32-register mode:</p>
<p>r20</p>
<p>through</p>
<p>r29</p>
<p>;</p>
<p>26-register mode:</p>
<p>r23</p>
<p>through</p>
<p>r29</p>
<p>; 22-register mode:</p>
<p>r25</p>
<p>through</p>
<p>r29</p>
<p>).</p>
<p>Access to parameters or local stack storage are always relative to the stack pointer,</p>
<p>r3</p>
<p>, even if a frame pointer is set up.</p>
<p>If the<b> AdvancedâDebugging OptionsâGenerate Target-Walkable Stack</b> option</p>
<p>is enabled (<b>-gtws</b>), a frame pointer will be set up in</p>
<p>r28</p>
<p>.</p>
<p><b>The Stack</b></p>
<p>In general, the stack for the current subroutine resembles the following:</p>
<p><i>nth</i> parameter word</p>
<p>High Address</p>
<p>(<i>n</i>-1)<i>th</i> parameter word</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>(<i>previous frame</i>)</p>
<p>6<i>th</i> parameter word</p>
<p>sp0</p>
<p>(= previous stack pointer)</p>
<p>5<i>th</i> parameter word</p>
<p>sp +<i> framesize</i> - 4</p>
<p>(</p>
<p>= sp0</p>
<p>- 4</p>
<p>)</p>
<p>16-byte parameter area</p>
<p>(only if necessary)</p>
<p>sp +<i> framesize</i> - 16</p>
<p><i>37</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The Stack</i></p>
<h1 style="page-break-before:always; "></h1>
<p>sp +<i> framesize</i> -<i> parmarea</i></p>
<p>- 4</p>
<p>return address (</p>
<p>lp</p>
<p>)</p>
<p>sp +<i> framesize</i> -<i> parmarea</i></p>
<p>- 8</p>
<p>frame pointer (</p>
<p>fp</p>
<p>)</p>
<p>permanent registers</p>
<p>local variables</p>
<p>(<i>current frame</i>)</p>
<p><i>nth</i> argument word</p>
<p>(<i>n</i>-1)<i>th</i> argument word</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>6<i>th</i> argument word</p>
<p>sp</p>
<p>(</p>
<p>= sp0 -<i> framesize</i></p>
<p>)</p>
<p>5<i>th</i> argument word</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>(<i>next frame</i>)</p>
<p>Low Address</p>
<p>In this diagram,<i> parameters</i> are passed to the subroutine. If the subroutine has more</p>
<p>than 16 bytes of parameters, the parameter words in excess of 16 bytes are presented</p>
<p>on the stack as shown.</p>
<p>Similarly, if the subroutine passes more than 16 bytes of<i> arguments</i> to its children</p>
<p>subroutines, the arguments in excess of 16 bytes are stored on the stack immediately</p>
<p>before the call.</p>
<p>The<i> 16-byte parameter area</i> is present if any of the first four parameter words of</p>
<p>the subroutine belongs to a structure passed by value (<i>parmarea</i> = 16), otherwise</p>
<p>it is not (<i>parmarea</i> = 0).</p>
<p>If the subroutine makes any calls, the link pointer</p>
<p>lp</p>
<p>(</p>
<p>r31</p>
<p>) is stored on the stack.</p>
<p>If the<b> AdvancedâDebugging OptionsâGenerate Target-Walkable Stack</b> option</p>
<p>is enabled (<b>-gtws</b>), the link pointer</p>
<p>lp</p>
<p>is always stored on the stack (regardless of</p>
<p>whether the subroutine makes any calls) and a frame pointer is set up in</p>
<p>r28</p>
<p>. The</p>
<p>frame pointer is , then stored on the stack immediately below the link pointer.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>38</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If the subroutine runs out of temporary registers to hold local variables, the local</p>
<p>variables not allocated to temporary registers are stored on the stack.</p>
<p>Because permanent registers must be preserved across calls, any permanent registers</p>
<p>used by the subroutine are stored on the stack. Permanent registers are stored in</p>
<p>increasing order, contiguously, but not necessarily consecutively, at increasing</p>
<p>offsets from the stack pointer. For example, if</p>
<p>r22</p>
<p>,</p>
<p>r24</p>
<p>,</p>
<p>r25</p>
<p>, and</p>
<p>r27</p>
<p>are used by</p>
<p>the subroutine and the subroutine has only one call and is passing 20 bytes of</p>
<p>arguments to that call, the following is part of the stack:</p>
<p>r22</p>
<p>High Address</p>
<p>r24</p>
<p>sp+16</p>
<p>r25</p>
<p>sp+12</p>
<p>r27</p>
<p>(<i>current frame</i>)</p>
<p>sp+8</p>
<p>local variables</p>
<p>sp+4</p>
<p>sp</p>
<p>5<i>th</i> argument word</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>(<i>next frame</i>)</p>
<p>Low Address</p>
<p><b>Note</b></p>
<p>When<b> -prepare_dispose</b> is used, the return address register (</p>
<p>lp</p>
<p>) and</p>
<p>frame pointer register (</p>
<p>fp</p>
<p>) are saved in the permanent register area.</p>
<p>lp</p>
<p>and</p>
<p>fp</p>
<p>are saved in the same order as other registers in that area. For</p>
<p>more information about<b> -prepare_dispose</b>, see âTarget-Specific Supportâ</p>
<p>on page 39.</p>
<p><b>Target-Specific Support</b></p>
<p>Since</p>
<p>asm</p>
<p>statements are not portable, the Green Hills V850 and RH850 compiler</p>
<p>provides special inline intrinsic functions. For a complete listing of supported</p>
<p>intrinsic functions and associated documentation, please refer directly to the file</p>
<p><b>include/v800/v800_ghs.h</b> contained within the compiler installation directory.</p>
<p><i>39</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Target-Specific Support</i></p>
<h1 style="page-break-before:always; "></h1>
<p>When compiling for V850E and later processors you can prevent the compiler from</p>
<p>using the</p>
<p>callt</p>
<p>instruction by setting the<b> TargetâInstruction SetâEpilogues</b></p>
<p><b>and Prologues via callt</b> option to<b> Off</b> (<b>-no_callt</b>).</p>
<p>Even when you specify</p>
<p>no_callt</p>
<p>, the compiler continues to generate interrupt</p>
<p>routines that save the</p>
<p>CTPSW</p>
<p>and</p>
<p>CTPC</p>
<p>registers that</p>
<p>callt</p>
<p>uses. To disable this</p>
<p>behavior, you must also set the<b> TargetâInstruction SetâSave CTPSW and</b></p>
<p><b>CTPC registers in Interrupt Routines</b> option to<b> Off</b></p>
<p>(<b>-ignore_callt_state_in_interrupts</b>). If library functions are used for function</p>
<p>prologues and epilogues, these registers might still be saved.</p>
<p>To instruct the compiler to use the</p>
<p>prepare</p>
<p>and</p>
<p>dispose</p>
<p>instructions for function</p>
<p>prologues and epilogues, set the<b> TargetâInstruction SetâEpilogues and</b></p>
<p><b>Prologues via prepare and dispose</b> option to<b> On</b> (<b>-prepare_dispose</b>). For most</p>
<p>functions, this is as small as the</p>
<p>callt</p>
<p>prologue, and is always faster.</p>
<p><b>SIMD Vector Support</b></p>
<p>Intrinsic functions to support the SIMD vector instructions are available on the</p>
<p>RH850 and later processors when SIMD support (<b>-rh850_simd</b>)</p>
<p>is enabled. The</p>
<p>SIMD intrinsic functions are documented in<b> include/v800/v800_simd.h</b>, which is</p>
<p>contained within the compiler installation directory.</p>
<p>To facilitate use of the intrinsic functions, the following vector data types are</p>
<p>available:</p>
<p>__ev64_u16__</p>
<p>__ev64_s16__</p>
<p>__ev64_u32__</p>
<p>__ev64_s32__</p>
<p>__ev64_u64__</p>
<p>__ev64_s64__</p>
<p>__ev64_opaque__</p>
<p>__ev128_opaque__</p>
<p>All</p>
<p>ev64</p>
<p>types are 8 bytes in size, and the</p>
<p>ev128</p>
<p>type is 16 bytes in size. In the</p>
<p>list of types above, the first six types are for vectors of 16-bit, 32-bit, and 64-bit</p>
<p>elements (both unsigned and signed). The</p>
<p>__ev64_opaque__</p>
<p>type is a special</p>
<p>vector type that can match any of the other</p>
<p>ev64</p>
<p>types. A function prototyped to</p>
<p>take an</p>
<p>__ev64_opaque__</p>
<p>type may be directly passed any of the other</p>
<p>ev64</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>40</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>types without warnings or errors. The</p>
<p>__ev128_opaque__</p>
<p>type is provided solely</p>
<p>for the few vector intrinsic functions which must return 128 bits worth of data. No</p>
<p>other 128-bit vector types are available. The</p>
<p>__ev_create_vec128</p>
<p>and</p>
<p>__ev_get_vec64</p>
<p>intrinsic functions are provided to create the 128-bit vector type</p>
<p>from two 64-bit vectors and to extract the component 64-bit vectors, respectively.</p>
<p><b>Example 2.2. Simple initialization of a vector</b></p>
<p>#include &lt;v800_ghs.h&gt;</p>
<p>__ev64_s32__ func(__ev64_s16__ v1)</p>
<p>{</p>
<p>__ev128_opaque__ v128;</p>
<p>v128 = __ev_pki16i32(v1);</p>
<p>return __ev_vadd_w(__ev_get_vec64(v128, 0),</p>
<p>__ev_get_vec64(v128, 1));</p>
<p>}</p>
<p><b>Example 2.3. Basic vector manipulation</b></p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;v800_ghs.h&gt;</p>
<p>void print_vec_s16(const char *name, __ev64_s16__ vec)</p>
<p>{</p>
<p>printf(&quot;%s: { %d, %d, %d, %d }\n&quot;, name,</p>
<p>__ev_get_s16(vec, 0),</p>
<p>__ev_get_s16(vec, 1),</p>
<p>__ev_get_s16(vec, 2),</p>
<p>__ev_get_s16(vec, 3));</p>
<p>}</p>
<p>__ev64_opaque__ test(__ev64_opaque__ vec)</p>
<p>{</p>
<p>print_vec_s16(&quot;before&quot;, vec);</p>
<p>vec = __ev_vadd_h(vec, __ev_create_s16(1,2,3,4));</p>
<p>print_vec_s16(&quot; after&quot;, vec);</p>
<p>return vec;</p>
<p>}</p>
<p>int main()</p>
<p>{</p>
<p>__ev64_s16__ v1 = {100,200,300,400}, v2;</p>
<p><i>41</i></p>
<p><i>Green Hills Software</i></p>
<p><i>SIMD Vector Support</i></p>
<h1 style="page-break-before:always; "></h1>
<p>v2 = test(v1);</p>
<p>print_vec_s16(&quot;</p>
<p>v1&quot;, v1);</p>
<p>print_vec_s16(&quot;</p>
<p>v2&quot;, v2);</p>
<p>return 0;</p>
<p>}</p>
<p><b>FPSIMD Vector Support</b></p>
<p>Intrinsic functions to support the FPSIMD vector instructions are available on the</p>
<p>RH850 and later processors when FPSIMD support is enabled (see âFloating-Point</p>
<p>SIMDâ on page 157). The FPSIMD intrinsic functions are documented in</p>
<p><b>include/v800/v800_fpsimd.h</b>, which is contained within the compiler installation</p>
<p>directory.</p>
<p>To facilitate use of the intrinsic functions, the following vector data types are</p>
<p>available:</p>
<p>__ev128_f32__</p>
<p>__ev256_f32__</p>
<p>The</p>
<p>__ev128_f32__</p>
<p>type is 128 bits in size and is for vectors of four 32-bit</p>
<p>single-precision floating-point elements. It is 16-byte aligned in data sections and</p>
<p>can be allocated to vector registers in</p>
<p>wr0</p>
<p>-</p>
<p>wr31</p>
<p>.</p>
<p>The</p>
<p>__ev256_f32__</p>
<p>type is 256 bits in size and is provided for representing a pair</p>
<p>of</p>
<p>__ev128_f32__</p>
<p>type vectors. It is used by a few vector intrinsic functions that</p>
<p>load or store a pair of vectors. It is 16-byte aligned in data sections and can be</p>
<p>allocated to a pair of vector registers in</p>
<p>wr0</p>
<p>-</p>
<p>wr31</p>
<p>.</p>
<p>Even though the two vector data types are naturally 16-byte aligned, they are only</p>
<p>guaranteed to be 4-byte aligned when allocated on stack, as the RH850 compiler</p>
<p>currently only supports 4-byte aligned stack frame.</p>
<p>The two vector types are passed to functions in up to four vector registers in</p>
<p>wr6</p>
<p>-</p>
<p>wr9</p>
<p>. A</p>
<p>__ev128_f32__</p>
<p>type parameter is passed in one vector register, while</p>
<p>a</p>
<p>__ev256_f32__</p>
<p>type parameter is passed in a pair of vector registers.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>42</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The two vector types are returned from a function in up to two vector registers in</p>
<p>wr10</p>
<p>-</p>
<p>wr11</p>
<p>. Specifically, a</p>
<p>__ev128_f32__</p>
<p>type is returned in</p>
<p>wr10</p>
<p>, while a</p>
<p>__ev256_f32__</p>
<p>type is returned in</p>
<p>wr10</p>
<p>-</p>
<p>wr11</p>
<p>.</p>
<p>The vector registers are all scratch registers and do not preserve their values across</p>
<p>function calls.</p>
<p><b>Example 2.4. Simple initialization of a vector</b></p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;v800_ghs.h&gt;</p>
<p>int check_fpvec_f32(const char *file, int line, __ev128_f32__ vec,</p>
<p>float c0, float c1, float c2, float c3)</p>
<p>{</p>
<p>float e0, e1, e2, e3;</p>
<p>e0 = __ev128_get_f32(vec, 0);</p>
<p>e1 = __ev128_get_f32(vec, 1);</p>
<p>e2 = __ev128_get_f32(vec, 2);</p>
<p>e3 = __ev128_get_f32(vec, 3);</p>
<p>if (e0 != c0 || e1 != c1 || e2 != c2 || e3 != c3) {</p>
<p>printf(&quot;%s, %d: fp vector = {%f, %f, %f, %f},&quot;,</p>
<p>file, line, e0, e1, e2, e3);</p>
<p>printf(&quot; not {%f, %f, %f, %f}\n&quot;, c0, c1, c2, c3);</p>
<p>return 1;</p>
<p>}</p>
<p>return 0;</p>
<p>}</p>
<p>int test_f32()</p>
<p>{</p>
<p>int fail = 0;</p>
<p>__ev128_f32__ vx, vy;</p>
<p>vx = __ev128_create_f32(-1.0, 2.2, -3.3, 4.5);</p>
<p>vy = __ev128_set_f32(vx, 1.0, 1);</p>
<p>/* vx = {-1.0, 2.2, -3.3, 4.5} */</p>
<p>/* vy = {-1.0, 1.0, -3.3, 4.5} */</p>
<p>fail += check_fpvec_f32(__FILE__, __LINE__, vx,</p>
<p>-1.0, 2.2, -3.3, 4.5);</p>
<p>fail += check_fpvec_f32(__FILE__, __LINE__, vy,</p>
<p><i>43</i></p>
<p><i>Green Hills Software</i></p>
<p><i>FPSIMD Vector Support</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-1.0, 1.0, -3.3, 4.5);</p>
<p>return fail;</p>
<p>}</p>
<p><b>Example 2.5. Basic vector manipulation on 2-way vectors</b></p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;v800_ghs.h&gt;</p>
<p>#define vectyp</p>
<p>__ev128_f32__</p>
<p>#define vec_add_2(x,y)</p>
<p>__ev128_addfs_2(x, y)</p>
<p>#define vec_sub_2(x,y)</p>
<p>__ev128_subfs_2(x, y)</p>
<p>vectyp vx, vz, vw;</p>
<p>vectyp vy = {4.0F, -2.5F};</p>
<p>int check_fpvec_f32_2(const char *file, int line, __ev128_f32__ vec,</p>
<p>float c0, float c1)</p>
<p>{</p>
<p>float e0, e1;</p>
<p>e0 = __ev128_get_f32(vec, 0);</p>
<p>e1 = __ev128_get_f32(vec, 1);</p>
<p>if (e0 != c0 || e1 != c1) {</p>
<p>printf(&quot;%s, %d: fp vector = {%f, %f, xxx, xxx}, &quot;,</p>
<p>file, line, e0, e1);</p>
<p>printf(&quot;not {%f, %f, xxx, xxx}\n&quot;, c0, c1);</p>
<p>return 1;</p>
<p>}</p>
<p>return 0;</p>
<p>}</p>
<p>/* return v3 - (v1 + v2) */</p>
<p>vectyp do_add_sub_2(vectyp v1, vectyp v2, vectyp v3)</p>
<p>{</p>
<p>vectyp tmp;</p>
<p>tmp = vec_add_2(v2, v1);</p>
<p>tmp = vec_sub_2(tmp, v3);</p>
<p>return tmp;</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>44</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>int test_f32()</p>
<p>{</p>
<p>int fail = 0;</p>
<p>/* vx = {-1.0, 2.2} */</p>
<p>__ev128_stvdw(0, __ev128_create_f32_2(-1.0, 2.2), &amp;vx);</p>
<p>/* vz = {vx[0], 1.0} */</p>
<p>__ev128_stvdw(0, __ev128_set_f32(vx, 1.0, 1), &amp;vz);</p>
<p>/* vw = vz - (vx + vy) */</p>
<p>__ev128_stvdw(0, do_add_sub_2(vx, vy, vz), &amp;vw);</p>
<p>/* vx = {-1.0, 2.2} */</p>
<p>/* vy = { 4.0,-2.5} */</p>
<p>/* vz = {-1.0, 1.0} */</p>
<p>/* vw = {-4.0, 1.3} */</p>
<p>fail += check_fpvec_f32_2(__FILE__, __LINE__, vx, -1.0, 2.2);</p>
<p>fail += check_fpvec_f32_2(__FILE__, __LINE__, vy, 4.0, -2.5);</p>
<p>fail += check_fpvec_f32_2(__FILE__, __LINE__, vz, -1.0, 1.0);</p>
<p>fail += check_fpvec_f32_2(__FILE__, __LINE__, vw, -4.0, 1.3);</p>
<p>return fail;</p>
<p>}</p>
<p>int main()</p>
<p>{</p>
<p>int fail = 0;</p>
<p>fail += test_f32();</p>
<p>if (fail != 0)</p>
<p>printf(&quot;Failures: %d\n&quot;, fail);</p>
<p>return 0;</p>
<p>}</p>
<p><b>Software Trace Logging Support</b></p>
<p>The software trace instructions on the RH850 (</p>
<p>DBCP</p>
<p>and</p>
<p>DBPUSH</p>
<p>) can be used to</p>
<p>send log messages directly to the trace buffer.</p>
<p><i>45</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Software Trace Logging Support</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>The software trace decoding relies on information in the user's ELF</p>
<p>executable. Any software trace events that happen in code that is outside</p>
<p>this executable (such as shared memory) will not be decoded as user</p>
<p>messages or function entry/exit events, but will instead show up as a raw</p>
<p>DBCP</p>
<p>or</p>
<p>DBPUSH</p>
<p>instructions.</p>
<p><b>Logging User Data and Messages</b></p>
<p>The RH850 toolchain provides specialized intrinsic functions that provide the ability</p>
<p>to log user variables to the processor's trace buffer. Each of the functions takes a</p>
<p>tag name as the first argument, which must follow the same naming rules as C</p>
<p>identifiers. The tag names are used in the logging message and can, but need not,</p>
<p>correspond to actual identifiers in the program.</p>
<p>The following table lists the logging functions, which are defined in the file</p>
<p><b>include/v800/rh850_eagle.h</b>, contained within the compiler installation directory.</p>
<p><b>Description</b></p>
<p><b>Logging Function</b></p>
<p>Logs a user-provided 32-bit integer.</p>
<p>EAGLE_LogU32(tag, value)</p>
<p>Logs a user-provided 64-bit integer.</p>
<p>EAGLE_LogU64(tag, value)</p>
<p>Logs a user-provided Boolean value.</p>
<p>EAGLE_LogBool(tag, value)</p>
<p>Logs a user-provided pointer.</p>
<p>EAGLE_LogPtr(tag, value)</p>
<p>Logs a user-provided string.</p>
<p>EAGLE_LogStr(tag, value)</p>
<p>Logs a user-provided 32-bit integer with index.</p>
<p>EAGLE_LogNdxU32(tag, index, value)</p>
<p>Logs a user-provided 64-bit integer with index.</p>
<p>EAGLE_LogNdxU64(tag, index, value)</p>
<p>Logs a user-provided Boolean value with</p>
<p>index.</p>
<p>EAGLE_LogNdxBool(tag, index, value)</p>
<p>Logs a user-provided pointer with index.</p>
<p>EAGLE_LogNdxPtr(tag, index, value)</p>
<p>Logs a user-provided string with index.</p>
<p>EAGLE_LogNdxStr(tag, index, value)</p>
<p>Logs a user-provided message.</p>
<p>EAGLE_LogPrint(tag, string)</p>
<p>Logs a user-provided message with printf-style</p>
<p>formatting.</p>
<p>EAGLE_LogPrintf(tag, format, ...)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>46</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>There are three categories of logging functions listed above: those that log a value,</p>
<p>those that log a value and an index, and those that log user messages. The following</p>
<p>examples, show how they are used.</p>
<p><b>Example 2.6. Logging scalar values</b></p>
<p>#include &lt;rh850_eagle.h&gt;</p>
<p>long long g64 = 0x0102030405060708;</p>
<p>void log_values(int v32, char *str)</p>
<p>{</p>
<p>EAGLE_LogU32(v32, v32);</p>
<p>EAGLE_LogU64(g64, g64);</p>
<p>EAGLE_LogBool(v32_is_even, (v32&amp;1)==0);</p>
<p>EAGLE_LogStr(str, str);</p>
<p>}</p>
<p>int main()</p>
<p>{</p>
<p>log_values(0x1a2b3c4d, &quot;test string&quot;);</p>
<p>return 0;</p>
<p>}</p>
<p>This example logs four values, resulting in the following log messages in the trace</p>
<p>list window:</p>
<p>USER U64: v32 = 0x000000001a2b3c4d</p>
<p>USER U64: g64 = 0x1020304050607080</p>
<p>USER BOOL: v32_is_even = FALSE</p>
<p>USER STRING: str = &quot;test string&quot;</p>
<p><b>Example 2.7. Logging array values</b></p>
<p>#include &lt;rh850_eagle.h&gt;</p>
<p>long long llarray[] = {</p>
<p>0x0000000000000000, 0x1111111111111111,</p>
<p>0x2222222222222222, 0x3333333333333333</p>
<p>};</p>
<p>void log_values(int ndx1, int ndx2, int ndx3)</p>
<p>{</p>
<p>const char *strarray[] = {</p>
<p><i>47</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Logging User Data and Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p>&quot;element 0&quot;, &quot;element 1&quot;,</p>
<p>&quot;element 2&quot;, &quot;element 3&quot;</p>
<p>};</p>
<p>EAGLE_LogNdxU64(llarray, ndx1, llarray[ndx1]);</p>
<p>EAGLE_LogNdxU64(llarray, ndx2, llarray[ndx2]);</p>
<p>EAGLE_LogNdxStr(strarray, ndx3, strarray[ndx3]);</p>
<p>EAGLE_LogNdxBool(booltest, 2, 1);</p>
<p>EAGLE_LogNdxBool(booltest, 7, 0);</p>
<p>}</p>
<p>int main()</p>
<p>{</p>
<p>log_values(2, 1, 3);</p>
<p>return 0;</p>
<p>}</p>
<p>The index logging functions provide a convenient way to generate a log message</p>
<p>with a tag of<i> tagname[index]</i>. The trace messages for the above example are as</p>
<p>shown below:</p>
<p>USER U64: llarray[2] = 0x2222222222222222</p>
<p>USER U64: llarray[1] = 0x1111111111111111</p>
<p>USER STRING: strarray[3] = &quot;element 3&quot;</p>
<p>USER BOOL: booltest[2] = TRUE</p>
<p>USER BOOL: booltest[7] = FALSE</p>
<p><b>Example 2.8. Logging user messages</b></p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;rh850_eagle.h&gt;</p>
<p>void func1(int val1, int val2)</p>
<p>{</p>
<p>EAGLE_LogPrintf(msg_func1, &quot;In func1(): val1=%d, val2=%d&quot;,</p>
<p>val1, val2);</p>
<p>}</p>
<p>void func2(char *msg)</p>
<p>{</p>
<p>EAGLE_LogPrint(msg_func2, msg);</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>48</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>int main()</p>
<p>{</p>
<p>EAGLE_LogPrint(msg_main, &quot;Start of main()&quot;);</p>
<p>func1(100, 200);</p>
<p>func2(&quot;Message from func2()&quot;);</p>
<p>EAGLE_LogPrint(msg_main, &quot;End of main()&quot;);</p>
<p>return 0;</p>
<p>}</p>
<p>The logging function without formatting,</p>
<p>EAGLE_LogPrint</p>
<p>is not fundamentally</p>
<p>different from logging a string. Note that the version with formatting requires that</p>
<p><b>stdio.h</b> is included before<b> rh850_eagle.h</b>. The trace message for this example are</p>
<p>shown below:</p>
<p>USER STRING: msg_main = &quot;Start of main()&quot;</p>
<p>USER STRING: msg_func1 = &quot;In func1(): val1=100, val2=200&quot;</p>
<p>USER STRING: msg_func2 = &quot;Message from func2()&quot;</p>
<p>USER STRING: msg_main = &quot;End of main()&quot;</p>
<p><b>Run-time Overhead</b></p>
<p>When logging data that is constant and known at compile time, only the PC is logged</p>
<p>to the trace buffer, requiring a single</p>
<p>DBCP</p>
<p>instruction. The tag and value are stored</p>
<p>in a section of the ELF file that is not downloaded to the target. When the trace is</p>
<p>retrieved, MULTI reconstructs the log message. When variable data is logged, the</p>
<p>compiler inserts code to log the value. In the case of integer and Boolean values,</p>
<p>this can be done with a single</p>
<p>DBPUSH</p>
<p>instruction. For strings, a library routine is</p>
<p>called to log the string with one or more</p>
<p>DBPUSH</p>
<p>instructions. The indexed form of</p>
<p>the logging functions are similar to the non-indexed ones, except that have one more</p>
<p>instruction of overhead, to log the index.</p>
<p>Logging user messages without formatting has the same overhead as logging a</p>
<p>string. When formatting is used, there is also the additional overhead to format the</p>
<p>message. This overhead is equivalent to performing a call to</p>
<p>sprintf</p>
<p>.</p>
<p><b>Configuration</b></p>
<p>The EAGLE header file,<b> rh850_eagle.h</b>, must be included in order to use any of</p>
<p>the EAGLE logging functions. If the</p>
<p>EAGLE_LogPrintf</p>
<p>function is used, then</p>
<p><b>stdio.h</b> must be include before<b> rh850_eagle.h</b>. By default all logging tags are</p>
<p><i>49</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Logging User Data and Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p>enabled, but the behavior can be configured by defining</p>
<p>EAGLE_CONFIG_LOGGING</p>
<p>before including<b> rh850_eagle.h</b> to one of the values shown below.</p>
<p><b>Instrumentation</b></p>
<p><b>Code</b></p>
<p><b>Value</b></p>
<p>No code generated</p>
<p>No</p>
<p>0</p>
<p>Generated, but disabled</p>
<p>Yes</p>
<p>1</p>
<p>Generated and enabled (<i>Default</i>)</p>
<p>Yes</p>
<p>2</p>
<p>Generate, state determined on a per-tag basis</p>
<p>Yes</p>
<p>3</p>
<p><b>Logging Function Entry and Exit (FEE) Events</b></p>
<p>The RH850 toolchain can be configured to log function entry and exit events for</p>
<p>all or selected functions. A software trace instruction is inserted at the entry of a</p>
<p>function and at all exit points. Compiler instrumentation can be enabled with</p>
<p><b>-gen_entry_exit_history</b> for basic function entry and exit logging, or with</p>
<p><b>-gen_entry_exit_arg_history</b> for entry and exit logging with function arguments.</p>
<p>For more information, see âGenerate Function Entry/Exit Instrumentationâ</p>
<p>on page 296 or âGenerate Function Entry/Exit Instrumentation with Argumentsâ</p>
<p>on page 296.</p>
<p>At link-time, if a module has been compiled with FEE logging, the log points can</p>
<p>be enabled, disabled, or stripped. For more information, see âFunction Entry/Exit</p>
<p>Loggingâ on page 176.</p>
<p>This implementation allows you to compile your program with instrumentation,</p>
<p>and easily disable or strip it away in the linker without having to recompile when</p>
<p>you no longer need logging. To enable FEE logging on a function-by-function basis,</p>
<p>use</p>
<p>#pragma ghs function_entry_exit</p>
<p>(see âGreen Hills Extension Pragma</p>
<p>Directivesâ on page 799) or</p>
<p>attribute((entry_exit_history))</p>
<p>(see</p>
<p>entry_exit_history</p>
<p>on page 720).</p>
<p><b>Logging Load Addresses</b></p>
<p>The RH850 toolchain can be configured to log the addresses of load instructions,</p>
<p>excluding loads that are known to be from the stack. When configured to log load</p>
<p>addresses, a single software trace instruction is inserted before each load instruction,</p>
<p>and the full address is computed during trace processing. The recomputed address</p>
<p>is displayed in the trace list window, similarly to user-logged values.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>50</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Compiler instrumentation can be enabled with<b> -rh850_trace_loads</b> and disabled</p>
<p>with<b> -no_rh850_trace_loads</b> (see âInstrument loads with software trace instructionsâ</p>
<p>on page 153). To enable load address logging on a function-by-function basic, use</p>
<p>#pragma ghs rh850 trace_loads</p>
<p>(see âGreen Hills Extension Pragma</p>
<p>Directivesâ on page 799).</p>
<p><i>51</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Logging Load Addresses</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Specifying a V850 and RH850 Target</b></p>
<p>The Builder and compiler drivers support</p>
<p>many of the most popular V850 and</p>
<p>RH850 boards and the entire V850 and RH850 family of microprocessors. The</p>
<p>compilers can produce more efficient code if you specify the target on which you</p>
<p>intend to run the finished executable. Target options may affect the predefined</p>
<p>preprocessor symbols, the compiler, the assembler, and the selection of header files,</p>
<p>libraries, and linker directive files used by the linker.</p>
<p>Many of the most popular V850 and RH850 boards are supported through tailored</p>
<p>linker directives files that greatly simplify the process of linking and loading an</p>
<p>executable. To specify a particular target board:</p>
<p>When creating a new project with the<b> Project Wizard</b> (see the documentation</p>
<p>about creating a project in the<i> MULTI: Managing Projects and Configuring the</i></p>
<p><i>IDE</i> book), choose the appropriate target board.</p>
<p>To specify a target board with the driver, pass the<b> -bsp<i> board</b></i> option. To obtain a</p>
<p>list of supported boards, enter<b> -bsp=?</b> (or<b> -bsp=\?</b> in many shells).</p>
<p>The<b> -bsp=</b> option may imply other settings according to the requirements of your</p>
<p>board. It also allows you to use the<b> -layout=</b> option.<b> -bsp=</b> and<b> -layout=</b> select the</p>
<p>linker directive file used by the toolchain when building your project. For more</p>
<p>information about the<b> -layout=</b> option, see âAssigning Program Sections to ROM</p>
<p>and RAMâ on page 90.</p>
<p>If your board is not supported, you should specify your target processor instead.</p>
<p>Specifying a target processor enables the driver to determine the most efficient</p>
<p>instruction set to use in code generation.</p>
<p>To specify a target processor:</p>
<p>When creating a project with the<b> Project Wizard</b> (see the documentation about</p>
<p>creating a project in the<i> MULTI: Managing Projects and Configuring the IDE</i></p>
<p>book), expand the<b> Generic</b> option in the<b> Board Name</b> box, and choose the</p>
<p>appropriate processor.</p>
<p>This corresponds to the<b> -bsp=generic</b> driver option.</p>
<p>To specify a target processor with the driver, pass the<b> -cpu=<i>cpu</b></i> option. To obtain</p>
<p>a list of supported processors, enter<b> -cpu=help</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>52</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>V850 and RH850 Processor Variants</b></p>
<p>The following table lists the supported V850 and RH850 processor variants. The</p>
<p>default processor type is V850 if the<b> ccv850</b> driver is used and RH850G3K if the</p>
<p><b>ccrh850</b> driver is used.</p>
<p>All V850 and RH850 CPU macros are also defined without the two trailing</p>
<p>underscores.</p>
<p><b>Defaults</b></p>
<p><b>Predefined Macro</b></p>
<p><b>Name</b></p>
<p><b>Driver Option</b></p>
<p><b>-cpu=</b></p>
<p><b>Processor</b></p>
<p><b>Floating</b></p>
<p><b>Point</b></p>
<p><b>Library</b></p>
<p><b>Directory</b></p>
<p>Software</p>
<p><b>v850</b></p>
<p>__V850__</p>
<p><b>v850</b></p>
<p>V850</p>
<p>Software</p>
<p><b>v850e</b></p>
<p>__V850E__</p>
<p><b>v850e</b></p>
<p>V850E</p>
<p>Mixed</p>
<p>*</p>
<p><b>v850f</b></p>
<p>__V850F__</p>
<p><b>v850e1f</b></p>
<p>V850E1F</p>
<p>Software</p>
<p><b>v850e2</b></p>
<p>__V850E2__</p>
<p><b>v850e2</b></p>
<p>V850E2</p>
<p>Hardware</p>
<p><b>v850e2r</b></p>
<p>__V850E2R__</p>
<p><b>v850e2r</b></p>
<p>V850E2R</p>
<p>Hardware</p>
<p><b>v850e2rv3</b></p>
<p>__V850E2V3__</p>
<p><b>v850e2v3</b></p>
<p>V850E2V3</p>
<p>Hardware</p>
<p><b>rh850</b></p>
<p>__V850E3__</p>
<p><b>v850e3</b></p>
<p>V850E3</p>
<p>__V850E3V5__</p>
<p>Software</p>
<p><b>rh850</b></p>
<p>__RH850__</p>
<p><b>rh850</b></p>
<p>RH850G3K</p>
<p>__RH850G3K__</p>
<p><b>rh850g3k</b></p>
<p>**</p>
<p>__V850E3__</p>
<p>__V850E3V5__</p>
<p>Hardware</p>
<p><b>rh850</b></p>
<p>__RH850__</p>
<p><b>rh850g3m</b></p>
<p>RH850G3M</p>
<p>__RH850G3M__</p>
<p>__V850E3__</p>
<p>__V850E3V5__</p>
<p>Hardware</p>
<p><b>rh850</b></p>
<p>__RH850__</p>
<p><b>rh850g3mh</b></p>
<p>RH850G3MH</p>
<p>__RH850G3MH__</p>
<p>__V850E3__</p>
<p>__V850E3V5__</p>
<p><i>53</i></p>
<p><i>Green Hills Software</i></p>
<p><i>V850 and RH850 Processor Variants</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Defaults</b></p>
<p><b>Predefined Macro</b></p>
<p><b>Name</b></p>
<p><b>Driver Option</b></p>
<p><b>-cpu=</b></p>
<p><b>Processor</b></p>
<p><b>Floating</b></p>
<p><b>Point</b></p>
<p><b>Library</b></p>
<p><b>Directory</b></p>
<p>Hardware</p>
<p><b>rh850</b></p>
<p>__RH850__</p>
<p><b>rh850g3kh</b></p>
<p>RH850G3KH</p>
<p>__RH850G3KH__</p>
<p>__V850E3__</p>
<p>__V850E3V5__</p>
<p>*</p>
<p>Hardware support for 32-bit, and software support for 64-bit floating point.</p>
<p>**</p>
<p><b>-cpu=rh850</b> and<b> -cpu=rh850g3k</b> are synonymous.</p>
<p>The V850E3 and RH850 are synonymous within the compiler and Builder, as they</p>
<p>both use the V850E3V5 instruction set architecture.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>54</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Enabling Debugging Features</b></p>
<p><b>Generating Debugging Information</b></p>
<p>To generate debugging information for use with the MULTI Debugger:</p>
<p>Set the<b> DebuggingâDebugging Level</b> option to<b> MULTI</b> (<b>-G</b>).</p>
<p>For more information about debugging options, see âDebugging Levelâ on page 176</p>
<p>and âDebugging Optionsâ on page 176.</p>
<p>Debugging information is only created or updated when you create an executable</p>
<p>or a library with the Builder or driver. It is not created when the linker or librarian</p>
<p>are invoked separately. If you move an executable, library, or object file, you must</p>
<p>also move the associated debugging information files. When moving these files,</p>
<p>either preserve the original time stamps of all the files or ensure that the<b> .dnm</b> file</p>
<p>has a more recent time stamp than the executable's time stamp. Otherwise, it may</p>
<p>be necessary to rebuild or relink your program before you can use the MULTI</p>
<p>Debugger. For more information, see the documentation about starting the MULTI</p>
<p>Debugger in the<i> MULTI: Debugging</i> book.</p>
<p>For information about using the MULTI Debugger, see<i> MULTI: Debugging</i>.</p>
<p><b>How the Compiler Generates Debug Information</b></p>
<p>The diagram below illustrates the creation of debugging information:</p>
<p><i>55</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Enabling Debugging Features</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Compiler &amp;</p>
<p>Assembler</p>
<p>bar.o</p>
<p>dblink</p>
<p>foo.dbo</p>
<p>gnm</p>
<p>bar.c</p>
<p>foo.o</p>
<p>linker</p>
<p>foo.c</p>
<p>baz</p>
<p>(executable)</p>
<p>baz.dnm</p>
<p>bar.dbo</p>
<p>baz.dla</p>
<p>As the compiler and assembler translate each C or other high-level language file</p>
<p>into an object file, they also generate associated debugging information. For each</p>
<p>object file created, a separate file with the same name but a<b> .dbo</b> extension is</p>
<p>produced to hold this information. After the executable is linked together, these</p>
<p>individual debugging information files are combined into a structure that can be</p>
<p>quickly searched and incrementally loaded.</p>
<p>In the diagram, the files<b> foo.c</b> and<b> bar.c</b> are passed to the toolchain, which generates</p>
<p>files<b> foo.o</b> and<b> bar.o</b> and links them together to generate an executable,<b> baz</b>. In</p>
<p>addition, the debugging information files<b> foo.dbo</b> and<b> bar.dbo</b> are generated and</p>
<p>passed to the<b> dblink</b> utility, which also extracts the executable's namelist information</p>
<p>(via the<b> gnm</b> utility), and generates the following two files:</p>
<p>â¢</p>
<p><b>baz.dnm</b> â the debug symbol table for<b> baz</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>56</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>baz.dla</b> â an archive of the<b> .dbo</b> files associated with<b> baz</b></p>
<p>When the executable is opened in the MULTI Debugger,<b> baz.dnm</b> controls the</p>
<p>loading of debugging information from<b> baz.dla</b> as necessary.</p>
<p>The creation of debugging information for libraries is performed in the same way</p>
<p>as for object files, except that an additional file with a<b> .dba</b> extension is generated</p>
<p>to combine the debugging information for all of the members of the library.</p>
<p>The files<b> foo.dnm</b> and<b> foo.dla</b> are generated even if the<b> DebuggingâDebugging</b></p>
<p><b>Level</b> option is not set to<b> MULTI</b> (<b>-G</b>), so that MULTI can obtain skeletal debugging</p>
<p>information for the executable. However, you must enable this option in order to</p>
<p>perform source-level debugging and to view assembly language interlaced with</p>
<p>your source.</p>
<p><b>Generating Debugging Information for Applications Compiled with</b></p>
<p><b>Third-Party Compilers</b></p>
<p>Green Hills provides two Debug Translators that allow you to use the MULTI</p>
<p>Debugger to debug applications compiled with third-party compilers. The MULTI</p>
<p>Debugger provides superior debugging capabilities by using special debugging</p>
<p>information files (<b>*.dbo</b>) generated by Green Hills Software's compilers. If you do</p>
<p>not compile with Green Hills tools, the Green Hills Debug Translators allow you</p>
<p>to convert DWARF or Stabs debugging information generated by third-party</p>
<p>compilers into the format required by the MULTI Debugger. If you need to use one</p>
<p>of these translators, we recommend that you integrate them with your build process.</p>
<p><b>Note</b></p>
<p>The Debug Translator executables,<b> dwarf2dbo</b> and<b> stabs2dbo</b>, are</p>
<p>separately licensed products of Green Hills Software. Contact your sales</p>
<p>representative for information about obtaining and licensing these</p>
<p>executables.</p>
<p><b>Translating DWARF and Stabs Debugging Information</b></p>
<p><b>Automatically</b></p>
<p>The<b> dwarf2dbo</b> Debug Translator converts DWARF 1.0 and DWARF 2.0 debugging</p>
<p>information into the special debugging information required by the MULTI</p>
<p><i>57</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Generating Debugging Information for Applications Compiled with Third-Party Compilers</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Debugger, and the<b> stabs2dbo</b> Debug Translator converts Stabs debugging</p>
<p>information in the MULTI format.</p>
<p>If you have licensed either<b> dwarf2dbo</b> or<b> stabs2dbo</b>, you can configure MULTI</p>
<p>to automatically convert DWARF or Stabs debugging information, respectively,</p>
<p>when an executable compiled with a third-party compiler that generates the</p>
<p>respective type of information is loaded into the Debugger. For information about</p>
<p>enabling automatic conversion, see the documentation about using third-party tools</p>
<p>with the MULTI Debugger in the<i> MULTI: Debugging</i> book.</p>
<p><b>Translating DWARF and Stabs Debugging Information Manually</b></p>
<p>You can also invoke the<b> dwarf2dbo</b> or<b> stabs2dbo</b> Debug Translator by passing</p>
<p>the<b> -auto_translate</b> option to the<b> dblink</b> utility. For example, to translate an</p>
<p>executable<b> a.out</b> that was compiled with either DWARF or Stabs information, issue</p>
<p>the following command from a Linux/Solaris shell or a Windows command prompt:</p>
<p>dblink -auto_translate a.out</p>
<p>If you compile some of the object files of your executable with a third-party compiler</p>
<p>and others with a Green Hills Software compiler, you must pass a special driver</p>
<p>option (<b>-dwarf_to_dbo</b> or<b> -stabs_to_dbo</b>) to the compiler driver during the final</p>
<p>link phase. The general syntax for doing this is:</p>
<p><i>driver</i> -<i>debug_info_type</i>_to_dbo<i> link_options</i> \</p>
<p><i>object_files</i> -o<i> executable_name</i></p>
<p>where</p>
<p><i>debug_info_type</i></p>
<p>is</p>
<p>dwarf</p>
<p>or</p>
<p>stabs</p>
<p>. For example, suppose you compile</p>
<p><b>legacy.c</b> and<b> old.c</b> with a third-party compiler that generates DWARF information.</p>
<p>Suppose you then compile<b> ghs.c</b> and<b> new.c</b> with the Green Hills Software compiler,</p>
<p>with the appropriate options set to generate MULTI debugging information for the</p>
<p>object files. Suppose that you want to generate a link map as well as the final</p>
<p>executable,<b> a.out</b>. From the command line, run the Green Hills compiler driver:</p>
<p><i>driver</i> -dwarf_to_dbo -map legacy.o old.o ghs.o new.o -o a.out</p>
<p><b>Building and Debugging on Different Hosts</b></p>
<p>If you build programs on one host and debug them on another, and the sources exist</p>
<p>in different locations on these different hosts, you can specify to the Debug Translator</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>58</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>how the build host's paths correlate to the debug host's paths. Once<b> dwarf2dbo</b></p>
<p>knows about this remapping, MULTI is correctly able to locate your files.</p>
<p>To map the build host's paths to the debug host's paths, you can pass the<b> --remap</b></p>
<p>option to the Debug Translator. Note that you can also use the<b> sourceroot</b> command</p>
<p>in MULTI if you want MULTI to dynamically change the file paths (see the</p>
<p>documentation about<b> sourceroot</b> in the<i> MULTI: Debugging Command Reference</i></p>
<p>book). The advantages of using the<b> --remap</b> option are that the additional MULTI</p>
<p>command need not be issued, and source scanning (see âSource Scanningâ</p>
<p>on page 59), when source file paths differ on the build host and debug host, can</p>
<p>only be accomplished by using this option.</p>
<p>To enable remapping of source paths in the Debug Translator, create a</p>
<p><b>dwarf2dbo.xsw</b> or<b> stabs2dbo.xsw</b> file in the MULTI installation directory with</p>
<p>the following contents.</p>
<p>--remap=<i>build_host_path</i>,<i>debug_host_path</i></p>
<p>If you are translating debugging information manually (as described in âTranslating</p>
<p>DWARF and Stabs Debugging Information Manuallyâ on page 58) you can also</p>
<p>enable source scanning by passing:</p>
<p>-translator.args=--remap=<i>build_host_path</i>,<i>debug_host_path</i></p>
<p>Only those file paths falling within</p>
<p><i>build_host_path</i></p>
<p>are modified. Multiple</p>
<p>--remap</p>
<p>options may be specified.</p>
<p><b>Source Scanning</b></p>
<p>The source scanning feature of the Green Hills Debug Translators can be used to</p>
<p>improve the code browsing features of MULTI when using code compiled by</p>
<p>third-party compilers. This feature causes the<b> dwarf2dbo</b> or<b> stabs2dbo</b> Debug</p>
<p>Translator to gather information directly from source files. Because source scanning</p>
<p>requires access to the entire source base of the program, it may be very slow if the</p>
<p>source base resides on a remote file system and should thus only be utilized if the</p>
<p>source files all reside on a local hard drive.</p>
<p>The cross-referencing and static call graph browsing functionality that results from</p>
<p>source scanning is generally much more complete and accurate for C sources than</p>
<p><i>59</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Generating Debugging Information for Applications Compiled with Third-Party Compilers</i></p>
<h1 style="page-break-before:always; "></h1>
<p>for C++ sources, but is generally not as accurate as information generated by Green</p>
<p>Hills compilers.</p>
<p>To enable source scanning, create a<b> dwarf2dbo.xsw</b> or<b> stabs2dbo.xsw</b> file in the</p>
<p>MULTI installation directory with the following contents:</p>
<p>--scan_source</p>
<p>This causes source scanning to occur whenever debugging information is translated</p>
<p>(either automatically or manually).</p>
<p>If you are translating debugging information manually (as described in âTranslating</p>
<p>DWARF and Stabs Debugging Information Manuallyâ on page 58), you can also</p>
<p>enable source scanning by passing:</p>
<p>--scan_source</p>
<p>to<b> dblink</b>.</p>
<p><b>Limitations</b></p>
<p>When you use MULTI to debug a program compiled by a third-party compiler, you</p>
<p>cannot perform certain operations that are available for programs compiled by Green</p>
<p>Hills compilers. The following limitations apply when you debug an application</p>
<p>compiled by a non-Green-Hills compiler:</p>
<p>â¢</p>
<p>Coverage analysis and call count profiling data is not available unless you use</p>
<p>a trace-enabled target with a Green Hills SuperTrace Probe to collect trace data</p>
<p>and then generate profiling data from the collected trace data. For more</p>
<p>information, see the documentation about recording and viewing profiling data</p>
<p>in the<i> MULTI: Debugging</i> book.</p>
<p>â¢</p>
<p>Run-time error checking, including memory allocation checking, is not</p>
<p>available.</p>
<p>â¢</p>
<p>Host I/O features are generally not available. These features can be enabled</p>
<p>for stand-alone programs by linking against certain objects in<b> libsys.a</b>, but this</p>
<p>workaround is not fully supported by Green Hills Software.</p>
<p>â¢</p>
<p>MULTI may not indicate when a variable has not yet been initialized or has a</p>
<p>dead value.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>60</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Command line function calls cannot be made unless the executable has been</p>
<p>linked against<b> libmulti.a</b>. For more information, see âEnabling Command Line</p>
<p>Function Callsâ on page 62.</p>
<p>â¢</p>
<p>Static call graph browsing is not available unless the program is translated</p>
<p>using the source scanning feature (see âSource Scanningâ on page 59).</p>
<p>â¢</p>
<p>Depending upon the third-party compiler being used, advanced features may</p>
<p>not be available in C++. Advanced features that may not be supported include</p>
<p>using virtual command line function calls, viewing the most derived type of a</p>
<p>pointer to a subclass, and viewing classes with virtual inheritance.</p>
<p>â¢</p>
<p>Unless the source scanning feature is used (see âSource Scanningâ on page 59),</p>
<p>cross-referencing is not available for sources compiled by third-party compilers.</p>
<p>â¢</p>
<p>Inspecting the value of preprocessor macros may not be possible. Source</p>
<p>scanning (see âSource Scanningâ on page 59) can be used to approximate the</p>
<p>actual compile-time preprocessor macro values, but the exact values can only</p>
<p>be known if the third-party compiler generates DWARF information with</p>
<p>macro information. The Stabs debug information format encodes no macro</p>
<p>information, so source scanning must be used if you are using a compiler that</p>
<p>generates Stabs information and you want preprocessor macros debugging</p>
<p>features.</p>
<p><b>Special Considerations for GNU Compilers</b></p>
<p>GNU compilers can generate DWARF 1.0, DWARF 2.0, or Stabs debugging</p>
<p>information. Green Hills Software recommends generating DWARF 2.0 information</p>
<p>rather than DWARF 1.0 or Stabs information. The standard<b> -g</b> GNU option may</p>
<p>have been configured to generate any of these three formats, so the full option names</p>
<p>are used here for clarification. To generate DWARF 2.0 information from the GNU</p>
<p>compiler, enter:</p>
<p>gcc -gdwarf-2</p>
<p>If your GNU compiler cannot generate DWARF 2.0 information using the<b> -gdwarf-2</b></p>
<p>option, then generate Stabs information by entering:</p>
<p>gcc -gstabs+</p>
<p>If your GNU compiler cannot generate Stabs information using the<b> -gstabs+</b> option,</p>
<p>then generate DWARF 1.0 information by entering:</p>
<p><i>61</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Generating Debugging Information for Applications Compiled with Third-Party Compilers</i></p>
<h1 style="page-break-before:always; "></h1>
<p>gcc -gdwarf -g2</p>
<p><b>Enabling Command Line Function Calls</b></p>
<p>You can call functions in your program from the Debugger command pane if you</p>
<p>link your program with the library<b> libmulti.a</b>.<b> libmulti.a</b> must reside in RAM, not</p>
<p>ROM, because MULTI must be able to set breakpoints in it.</p>
<p>When you set the Debugging Level to<b> MULTI</b> and then do a build, the Builder</p>
<p>automatically links in<b> libmulti.a</b>. If you are not using the Project Manager, you</p>
<p>must do one of the following to link with<b> libmulti.a</b>:</p>
<p>â¢</p>
<p>Use the<b> -G</b> driver option.</p>
<p>â¢</p>
<p>Use the<b> -lmulti</b> driver option.</p>
<p><b>Function Entry/Exit History</b></p>
<p>Function entry/exit history keeps track of each entry and exit from a function.</p>
<p>Control of function entry/exit history is available at compile time, link time, and</p>
<p>run-time. At compile time, the compiler can generate instrumentation in the prologue</p>
<p>and epilogue of each function (see âGenerate Function Entry/Exit Instrumentationâ</p>
<p>on page 296). At link time, this instrumentation can be enabled, disabled, or stripped</p>
<p>(see âFunction Entry/Exit Loggingâ on page 176). At run-time, entry/exit history</p>
<p>can be used by debuggers that support this feature, and toggled on or off by the</p>
<p><b>eagleconfig</b> MULTI command. For information about this command, see the</p>
<p>MULTI: Debugging Command Reference. Please note that the<b> eagleconfig</b> command</p>
<p>is only available for MULTI 7 or newer.</p>
<p>This implementation allows you to compile a program with function entry/exit</p>
<p>history enabled, then disable or strip the instrumentation in the linker without having</p>
<p>to recompile. To use function entry/exit history on a function-by-function basis,</p>
<p>use the</p>
<p>#pragma</p>
<p>directive</p>
<p>ghs entry_exit_history</p>
<p>(see âGreen Hills Extension</p>
<p>Pragma Directivesâ on page 799) or attribute</p>
<p>entry_exit_history</p>
<p>(see</p>
<p>entry_exit_history</p>
<p>on page 720).</p>
<p><b>Note</b></p>
<p>Only library functions that can be explicitly called by the user can be</p>
<p>instrumented using function entry/exit history.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>62</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Obtaining Profiling Information</b></p>
<p>The MULTI Debugger can analyze various forms of profiling information to help</p>
<p>you make your program run more efficiently. This section describes how to compile</p>
<p>your program so that profiling information is available to the Debugger and the</p>
<p>memory requirements for each supported profiling method. For additional</p>
<p>information, see the documentation about recording and viewing profiling data in</p>
<p>the<i> MULTI: Debugging</i> book and âThe protrans Utilityâ on page 655.</p>
<p>The following table outlines different types of profiling information, when you</p>
<p>should collect them, and how they may impact the performance of your program.</p>
<p>The impact of profiling varies depending on your program and the way you have</p>
<p>configured your target:</p>
<p><b>Impact</b></p>
<p><b>Use</b></p>
<p><b>Name</b></p>
<p>Minimal</p>
<p>You want to find performance issues with the lowest possible</p>
<p>overhead, and do not care about getting deterministic results.</p>
<p>Sampled profiling requires that you run long enough to collect</p>
<p>statistically significant results. It is not effective for code with</p>
<p>a periodic execution pattern similar to or faster than the</p>
<p>sampling rate. For more information, see âEnabling Sampled</p>
<p>Profilingâ on page 69.</p>
<p>Sampled</p>
<p>Small</p>
<p>You want to find what code is executed when you run your</p>
<p>program. See the next section.</p>
<p>Instrumented</p>
<p>Coverage</p>
<p>Medium</p>
<p>You want to find performance issues with deterministic results.</p>
<p>See the next section.</p>
<p>Instrumented</p>
<p>Performance</p>
<p>Large</p>
<p>You want to find performance issues with deterministic results,</p>
<p>and some basic blocks execute a very large number of times.</p>
<p>See the next section.</p>
<p>Instrumented</p>
<p>Performance</p>
<p>(64-bit)</p>
<p>Deprecated. Use instrumented performance.</p>
<p>Call Count</p>
<p>Deprecated. Use instrumented performance.</p>
<p>Call Graph</p>
<p>Profiling does not effectively measure programs that spend a lot of time doing things</p>
<p>other than executing instructions, such as programs that spend a lot of time blocking</p>
<p>on system calls, I/O, or other programs.</p>
<p><i>63</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Obtaining Profiling Information</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Enabling Instrumented Coverage or Performance Profiling</b></p>
<p>With<i> instrumented</i> profiling, the compiler adds instrumentation to the beginning of</p>
<p>each basic block in a procedure to collect profiling information. There are three</p>
<p>modes of instrumented coverage profiling:</p>
<p>â¢</p>
<p><i>Flag</i> profiling (<b>-coverage=flag</b>) records whether or not each block is executed.</p>
<p>This mode is useful for determining code coverage.</p>
<p>â¢</p>
<p><i>Count</i> profiling (<b>-coverage=count</b>) records how many times each block is</p>
<p>executed. This mode is useful for determining performance bottlenecks, but</p>
<p>more expensive because it requires more RAM per block and executes more</p>
<p>slowly.</p>
<p>â¢</p>
<p><i>64-bit Count</i> profiling (<b>-coverage=count64</b>) is similar to count profiling, but</p>
<p>uses 64-bit counters.</p>
<p>These are compile-time options and can be selectively enabled on a subset of source</p>
<p>files or on an entire program. For information about how to set the options, see</p>
<p>âProfiling - Block Coverageâ on page 177. You can also disable coverage profiling</p>
<p>for specific functions by enclosing them in</p>
<p>#pragma ghs startnocoverage</p>
<p>and</p>
<p>#pragma ghs endnocoverage</p>
<p>directives.</p>
<p>Instrumented profiling does not use locking or an atomic increment to achieve thread</p>
<p>safety. If you use count profiling with multi-threaded code or in interrupt handlers</p>
<p>a block's counter may be inaccurate if two increments occur simultaneously. Flag</p>
<p>profiling is thread-safe.</p>
<p>Coverage information is allocated in six sections:</p>
<p>.ghcovfa</p>
<p><b>-coverage=flag</b> block addresses</p>
<p>.ghcovfz</p>
<p><b>-coverage=flag</b> block flags</p>
<p>.ghcovca</p>
<p><b>-coverage=count</b> block addresses</p>
<p>.ghcovcz</p>
<p><b>-coverage=count</b> block counts</p>
<p>.ghcovda</p>
<p><b>-coverage=count64</b> block addresses</p>
<p>.ghcovdz</p>
<p><b>-coverage=count64</b> block counts</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>64</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The block address sections are non-loading and should not appear in the section</p>
<p>map of your linker directives (<b>.ld</b>) file. The flag and count sections must be</p>
<p>zero-initialized at startup, like the</p>
<p>.bss</p>
<p>section. These sections can be listed in the</p>
<p>section map, or the linker can define them. The linker defines the sections if they</p>
<p>are not defined in the linker directives file and if coverage is enabled on the linker</p>
<p>command line.</p>
<p>Instrumented Profiling Overhead</p>
<p>The following table describes the approximate performance overhead of instrumented</p>
<p>profiling. The actual amount of overhead varies depending on your code and target:</p>
<p><b>RAM Overhead</b></p>
<p><b>ROM Overhead</b></p>
<p><b>Option</b></p>
<p>4%</p>
<p>15%</p>
<p><b>flag</b></p>
<p>20%</p>
<p>30%</p>
<p><b>count</b></p>
<p>40%</p>
<p>50%</p>
<p><b>count64</b></p>
<p>If you have functions that do not need to be profiled and cause execution to take</p>
<p>too long, you can disable profiling for those functions by surrounding their</p>
<p>declarations with</p>
<p>#pragma ghs startnocoverage</p>
<p>and</p>
<p>#pragma ghs</p>
<p>endnocoverage</p>
<p>. For more information, see âGreen Hills Extension Pragma</p>
<p>Directivesâ on page 799.</p>
<p>Instrumented Profiling Caveats</p>
<p>â¢</p>
<p>Using any of the following features or code constructs may cause the compiler</p>
<p>to generate code that is difficult or impossible to cover during execution of</p>
<p>your program:</p>
<p>â</p>
<p><b>-Ospeed</b>, when used with</p>
<p>strncpy()</p>
<p>â</p>
<p>Run-Time error checking (<b>-check=</b>)</p>
<p>â</p>
<p>Loop unrolling (<b>-Ounroll</b>)</p>
<p>â</p>
<p>Switch statements that do not contain a default case</p>
<p>â¢</p>
<p>Green Hills libraries are not instrumented for profiling information.</p>
<p><i>65</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Obtaining Profiling Information</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Enabling Call Count Profiling</b></p>
<p><b>Note</b></p>
<p>Call count profiling is deprecated and will be removed in a future release.</p>
<p>Use instrumented performance instead. See âEnabling Instrumented</p>
<p>Coverage or Performance Profilingâ on page 64.</p>
<p><i>Call count</i> profiling (<b>-p</b>) causes the compiler to add instrumentation code to the</p>
<p>beginning of every procedure in your program. The program will usually have a</p>
<p>larger</p>
<p>.text</p>
<p>section with this type of profiling enabled, but will have a smaller</p>
<p>.text</p>
<p>section than with legacy coverage profiling.</p>
<p>Call count profiling also dynamically allocates tables in heap memory proportional</p>
<p>in size to the number of procedures actually executed while running your program.</p>
<p>Call count profiling uses an amount of heap memory equal to one pointer and one</p>
<p>32-bit integer counter (8 bytes on most systems) for each procedure in your program,</p>
<p>plus some overhead for the linked lists it uses to hold the counters.</p>
<p>To obtain call count profiling information:</p>
<p>Set the<b> AdvancedâDebugging OptionsâProfiling - Call Count</b> option to:</p>
<p>â¢</p>
<p><b>On</b> (<b>-p</b>), or</p>
<p>â¢</p>
<p><b>On with Call graph</b> (<b>-pg</b>).</p>
<p>If you try to use call count profiling and you get the error message &quot;</p>
<p>mcount:</p>
<p>could not allocate memory</p>
<p>&quot; from the target, there is not enough heap memory</p>
<p>available to use call count profiling. You can increase the size of the heap by</p>
<p>changing the size of the</p>
<p>.heap</p>
<p>section in the linker directives file.</p>
<p>Call count profiling uses</p>
<p>__ghsLock()</p>
<p>and</p>
<p>__ghsUnlock()</p>
<p>in<b> libsys.a</b> to operate</p>
<p>in a multithreaded environment. For more information about the profiling support</p>
<p>routines, see âCustomizing the Run-Time Environment Libraries and Object</p>
<p>Modulesâ on page 863. The implementation of</p>
<p>__ghsLock()</p>
<p>and</p>
<p>__ghsUnlock()</p>
<p>in multithreaded environments such as INTEGRITY may preclude the use of this</p>
<p>option for code that runs in certain contexts. Some call counts may be omitted in a</p>
<p>multithreaded environment, and some counts may be omitted from interrupt service</p>
<p>routines regardless of the environment.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>66</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Call count profiling is written to a file called<b> mon.out</b> when your program exits or</p>
<p>when you issue the<b> profdump</b> command to the MULTI Debugger (see the</p>
<p>documentation about manually dumping profiling data in the<i> MULTI: Debugging</i></p>
<p>book). You can usually find this file in the MULTI working directory, the directory</p>
<p>of the simulator or debug server that you last used to run your program, or the same</p>
<p>directory as your program, depending on your configuration.</p>
<p><b>Enabling Call Graph Profiling</b></p>
<p><b>Note</b></p>
<p>Call graph profiling is deprecated and will be removed in a future release.</p>
<p>Use instrumented performance instead. See âEnabling Instrumented</p>
<p>Coverage or Performance Profilingâ on page 64.</p>
<p><i>Call graph</i> profiling (<b>-pg</b>), also known as<b> gcount</b>, causes the compiler to add</p>
<p>instrumentation code to the beginning of every procedure in your program. This</p>
<p>type of profiling creates a larger</p>
<p>.text</p>
<p>section when enabled, but will have a</p>
<p>smaller</p>
<p>.text</p>
<p>section than with legacy coverage profiling.</p>
<p>Call graph profiling requires an amount of heap memory that is, by default, between</p>
<p>1.5 and 2 times the size of the</p>
<p>.text</p>
<p>section. The memory is used to hold a hash</p>
<p>table and a pool of (</p>
<p>from_pc</p>
<p>,</p>
<p>to_pc</p>
<p>,</p>
<p>count</p>
<p>) arcs, which forms a call graph with</p>
<p>weighted edges. This pool is large enough to store the call graphs of most programs.</p>
<p>If you see the following message from the target, your program has run out of</p>
<p>available heap memory:</p>
<p>gcount: could not allocate<i> n</i> bytes from .heap</p>
<p>If you see the following message from the target, your program has a complicated</p>
<p>call graph that cannot be represented with the arc pool:</p>
<p>gcount: not enough arcs to record call graph</p>
<p>You can fix this issue by customizing the low-level system library<b> libsys.a</b> (see</p>
<p>âCustomizing the Run-Time Environment Libraries and Object Modulesâ</p>
<p>on page 863) and following the instructions contained in the comments of<b> ind_gprf.c</b>.</p>
<p>Call graph profiling is thread-tolerant, but some call counts may be omitted in a</p>
<p>multithreaded environment, and some counts may be omitted from interrupt service</p>
<p><i>67</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Obtaining Profiling Information</i></p>
<h1 style="page-break-before:always; "></h1>
<p>routines regardless of the environment. For more information, see âLow-Level</p>
<p>System Library libsys.aâ on page 868.</p>
<p>Call graph profiling information is written to a file called<b> gmon.out</b> when your</p>
<p>program exits or when you issue the<b> profdump</b> command to the MULTI Debugger</p>
<p>(see the documentation about manually dumping profiling data in the<i> MULTI:</i></p>
<p><i>Debugging</i> book). You can usually find this file in the MULTI working directory,</p>
<p>the directory of the simulator or debug server that you last used to run your program,</p>
<p>or the same directory as your program, depending on your configuration.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>68</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Enabling Sampled Profiling</b></p>
<p>This section describes how to obtain<i> sampled profiling</i> information for stand-alone</p>
<p>and u-velOSity targets.</p>
<p><i>Sampled Profiling</i> (<b>-timer_profile</b>) also known as<b> manprf</b>, is supported by</p>
<p><b>ind_manprf.c</b> in the source of<b> libsys.a</b>, and parts of the implementation might also</p>
<p>be in the Board Initialization library<b> libboardinit.a</b> if your board contains that</p>
<p>optional library. See âBoard Initialization Library libboardinit.aâ on page 873 for a</p>
<p>description of this interface and the<b> board_info.txt</b> file in your project, if one exists.</p>
<p>This form of profiling, which is generated by the target periodically sampling its</p>
<p>own program counter, is faster and more accurate than host-driven profiling.</p>
<p>Target-based timing profiling requires a statically-allocated memory buffer, whose</p>
<p>size is adjustable in<b> ind_manprf.c</b>, which is included in<b> libsys</b>. For information</p>
<p>about how to include a customizable version of this file in your project, see âCreating</p>
<p>a Project with a Customizable Run-Time Environmentâ on page 863. This buffer is</p>
<p>used to hold the program counter samples before they are sent to MULTI; by default,</p>
<p>it is large enough to hold 120 addresses. The buffer is statically allocated, so it will</p>
<p>typically be allocated to</p>
<p>.bss</p>
<p>, not</p>
<p>.heap</p>
<p>. Rather than being written to a file by</p>
<p>the target, target-based timing profiling information is intercepted by the debug</p>
<p>server when the memory buffer fills.</p>
<p>The Target-Driven Timer Profiling library module,<b> ind_manprf.o</b>, is not linked</p>
<p>into your program by default. To link with it and enable this form of profiling,</p>
<p>follow these steps:</p>
<p>1.</p>
<p>Right-click the program's project file and select<b> Configure</b>. In the dialog box</p>
<p>that opens, select the<b> Board Initialization</b> check box (if present) and click</p>
<p><b>Finish</b>.</p>
<p>2.</p>
<p>Review<b> ind_manprf.c</b> and (if present) your board's<b> board_info.txt</b> file for</p>
<p>instructions. If your board is not explicitly supported, you must provide an</p>
<p>implementation using the existing code as an example.</p>
<p>3.</p>
<p>Rebuild the system library<b> libsys.a</b> and (if available for your board) the board</p>
<p>initialization library<b> libboardinit.a</b> (see âBoard Initialization Library</p>
<p>libboardinit.aâ on page 873 for a description of this interface).</p>
<p>4.</p>
<p>To link with the<b> ind_manprf.o</b> module:</p>
<p><i>69</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Obtaining Profiling Information</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Set the<b> DebuggingâProfiling - Target-Based Timing</b> option to<b> On</b></p>
<p>(<b>-timer_profile</b>).</p>
<p>Rebuild your application. If linker errors result, you may need to review the</p>
<p>settings for your board in the Target-Driven Timing Profiling source files</p>
<p>mentioned in the preceding.</p>
<p>5.</p>
<p>Open your application in the debugger, enable profiling and run your program</p>
<p>in the usual way. For more information about profiling, see the documentation</p>
<p>about recording and viewing profiling data in the<i> MULTI: Debugging</i> book.</p>
<p>Limitations and Suggestions</p>
<p>Target-based timing profiling gathers stochastic samples of the target program's</p>
<p>location at the time of periodic timer interrupts. For best results, let your program</p>
<p>run for a long time to gather a large number of profiling data samples.</p>
<p>This method of gathering samples can generate misleading results if the sampling</p>
<p>timer also causes other program actions, or if the program is dealing with external</p>
<p>events at or near a multiple of the sampling timer's frequency.</p>
<p><b>Enabling Run-Time Error Checking</b></p>
<p>Run-time error checking instruments your code to help you find problems during</p>
<p>execution. To enable run-time error checking:</p>
<p>Set the<b> DebuggingâRun-Time Error Checks</b> option (<b>-check=</b>). For information</p>
<p>about available run-time error checks, see âRun-Time Error Checksâ on page 178.</p>
<p>In order to use run-time error checking, you must be able to single step your target</p>
<p>without triggering an interrupt. If you are using a Green Hills Probe, see the</p>
<p>documentation for the<b> step_ints</b> setting in the Green Hills Debug Probes User's</p>
<p>Guide.</p>
<p>To perform run-time error checking without the MULTI Debugger, rebuild your</p>
<p>application with run-time error checking enabled and run it normally. The program</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>70</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>reports errors and warnings to</p>
<p>stderr</p>
<p>. After each error, the program calls</p>
<p>exit</p>
<p>with a value greater than</p>
<p>0</p>
<p>, terminating itself. After 101 warnings are produced, it</p>
<p>prints a message indicating too many errors and calls</p>
<p>exit</p>
<p>with a value greater</p>
<p>than 0 , terminating itself.</p>
<p>To redirect error and warning output to your own handler:</p>
<p>1.</p>
<p>Add the custom run-time error checking demo project to your Top Project (see</p>
<p>the documentation about adding new items to your project in<i> MULTI:</i></p>
<p><i>Managing Projects and Configuring the IDE</i>).</p>
<p>2.</p>
<p>Scroll down the project tree and open<b> user_defined_handler.c</b> to see example</p>
<p>code that sets up custom run-time error checking.</p>
<p><b>Enabling Run-Time Memory Checking</b></p>
<p>It can be very difficult to trace bugs involving the misuse of the standard library</p>
<p>functions</p>
<p>malloc()</p>
<p>and</p>
<p>free()</p>
<p>, because the effects of these bugs may not be</p>
<p>noticed immediately.</p>
<p>For example, if you mistakenly free memory that was not allocated with</p>
<p>malloc()</p>
<p>,</p>
<p>or try to use memory that has already been freed, your process may behave in</p>
<p>unpredictable ways.</p>
<p>MULTI supports two types of run-time memory checking to catch these kinds of</p>
<p>bugs:<i> general memory allocation checking</i> and<i> intensive memory allocation checking</i>.</p>
<p><b>Enabling General Memory Allocation Checking</b></p>
<p>This form of run-time memory checking will increase your heap size considerably</p>
<p>and reduce your process speed slightly. It requires less overhead than intensive</p>
<p>memory allocation checking (see âEnabling Intensive Memory Allocation Checkingâ</p>
<p>on page 72). It generates run-time errors when:</p>
<p>â¢</p>
<p>Memory that has not been allocated with</p>
<p>malloc()</p>
<p>is subsequently freed</p>
<p>â¢</p>
<p>The same area of memory is freed twice</p>
<p>â¢</p>
<p>Recently freed memory is written to</p>
<p><i>71</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Enabling Run-Time Memory Checking</i></p>
<h1 style="page-break-before:always; "></h1>
<p>In addition, general memory allocation checking allows you to trace<i> memory leaks</i>,</p>
<p>which can occur when memory that is allocated with</p>
<p>malloc()</p>
<p>is not subsequently</p>
<p>freed. In this situation, your process may unexpectedly run out of memory at some</p>
<p>indeterminate future time. For more information about tracing memory leaks, see</p>
<p>the documentation about viewing memory allocation information in the<i> MULTI:</i></p>
<p><i>Debugging</i> book.</p>
<p>To enable general memory allocation checking, set the<b> DebuggingâRun-Time</b></p>
<p><b>Memory Checks</b> option to<b> General (Allocations Only)</b> (<b>-check=alloc</b>) before</p>
<p>compiling your program.</p>
<p><b>Enabling Intensive Memory Allocation Checking</b></p>
<p>This form of run-time memory checking provides the most comprehensive</p>
<p>malloc()</p>
<p>checking. However, it will appreciably increase the size of your program code, and</p>
<p>slow your execution speed more than general memory allocation checking (see</p>
<p>âEnabling General Memory Allocation Checkingâ on page 71). It generates run-time</p>
<p>errors when:</p>
<p>â¢</p>
<p>Memory that has not been allocated with</p>
<p>malloc()</p>
<p>is subsequently freed</p>
<p>â¢</p>
<p>The same area of memory is freed twice</p>
<p>â¢</p>
<p>Recently freed memory is written to</p>
<p>â¢</p>
<p>Attempts are made to dereference</p>
<p>NULL</p>
<p>â¢</p>
<p>Accesses are attempted past the end of a heap-allocated data structure, causing</p>
<p>array overflow errors.</p>
<p>To enable intensive memory allocation checking, set the<b> DebuggingâRun-Time</b></p>
<p><b>Memory Checks</b> option to<b> Intensive</b> (<b>-check=memory</b>) before compiling your</p>
<p>program.</p>
<p><b>Note</b></p>
<p>Intensive memory allocation checking may be impractical for users with</p>
<p>memory constraints. You may want to enable general memory allocation</p>
<p>checking for your entire project, and use intensive checking only for</p>
<p>particular modules where</p>
<p>malloc()</p>
<p>-related errors are most likely to</p>
<p>occur. Alternatively, you can manually change the intensity level of your</p>
<p>memory checking with library functions, as described in the next section.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>72</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Using Memory Allocation Library Functions</b></p>
<p>The MULTI Compiler provides library functions that can control the amount and</p>
<p>frequency of consistency checking performed by the</p>
<p>malloc()</p>
<p>library.</p>
<p>These functions are only available if you build your code with general memory</p>
<p>allocation checking or intensive memory allocation checking enabled (see âEnabling</p>
<p>General Memory Allocation Checkingâ on page 71 or âEnabling Intensive Memory</p>
<p>Allocation Checkingâ on page 72). To call them, you must also include the</p>
<p><b>ghs_malloc.h</b> header file, located in<i><b> install_dir</i>/ansi</b>, which declares the following</p>
<p>two functions:</p>
<p>â¢</p>
<p>int malloc_set_debug_options(int newOptions)</p>
<p>â Sets the current</p>
<p>intensity level and returns the old intensity level.</p>
<p>â¢</p>
<p>void malloc_check_lib(int useTheseOptions)</p>
<p>â Performs an</p>
<p>immediate check of the</p>
<p>malloc()</p>
<p>library using the indicated intensity level.</p>
<p><b>Note</b></p>
<p>If you call</p>
<p>void malloc_check_lib()</p>
<p>with</p>
<p>0</p>
<p>or</p>
<p>M_CHECK_LEVEL_NONE</p>
<p>, the function uses the intensity level set</p>
<p>when you last called</p>
<p>malloc_set_debug_options()</p>
<p>.</p>
<p>Both of the preceding functions take a constant that corresponds to an intensity</p>
<p>level. The constants are defined in<b> ghs_malloc.h</b>. For a list of the available intensity</p>
<p>levels, see âPerforming Selective Run-Time Memory Checkingâ on page 73.</p>
<p>For a demonstration of the use of these memory checking functions, see</p>
<p>Example 2.9. Enabling and Disabling All Checks on page 74.</p>
<p>Performing Selective Run-Time Memory Checking</p>
<p>As an alternative to enabling constant memory allocation checking, which may be</p>
<p>impractical for users with memory constraints, you can enable certain memory</p>
<p>checks by using the library functions described in âUsing Memory Allocation</p>
<p>Library Functionsâ on page 73.</p>
<p><i>73</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Enabling Run-Time Memory Checking</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>This requires that you build your code with general memory allocation</p>
<p>checking or intensive memory allocation checking enabled. See âUsing</p>
<p>Memory Allocation Library Functionsâ on page 73.</p>
<p>The library functions take in an intensity level, which controls the amount of</p>
<p>self-checking, and the frequency of that checking, that the memory library performs</p>
<p>on calls to</p>
<p>malloc()</p>
<p>,</p>
<p>calloc()</p>
<p>,</p>
<p>realloc()</p>
<p>, and</p>
<p>free()</p>
<p>. The following list</p>
<p>describes the intensity levels. For information about corresponding menu items,</p>
<p>see the documentation about viewing memory allocation information in the<i> MULTI:</i></p>
<p><i>Debugging</i> book.</p>
<p>â¢</p>
<p>M_CHECK_LEVEL_NONE</p>
<p>â Does not perform additional checking.</p>
<p>â¢</p>
<p>M_CHECK_LEVEL_MINIMAL</p>
<p>â Performs minimal checking on each API call.</p>
<p>â¢</p>
<p>M_CHECK_LEVEL_OCCASIONALLY_MAXIMAL</p>
<p>â Performs minimal checking</p>
<p>on each API call, and occasionally performs full checking. This is the default</p>
<p>setting.</p>
<p>â¢</p>
<p>M_CHECK_LEVEL_FREQUENTLY_MAXIMAL</p>
<p>â Performs minimal checking on</p>
<p>each API call, and frequently performs full checking. Checks more frequently</p>
<p>(and with more associated overhead) than</p>
<p>M_CHECK_LEVEL_OCCASIONALLY_MAXIMAL</p>
<p>.</p>
<p>â¢</p>
<p>M_CHECK_LEVEL_MAXIMAL</p>
<p>â Performs full checking on each API call. This</p>
<p>may severely degrade the performance of your application.</p>
<p>Increasing the intensity level increases the amount and frequency of checking while</p>
<p>also increasing the associated overhead and decreasing the speed of the application.</p>
<p>The default intensity level (</p>
<p>M_CHECK_LEVEL_OCCASIONALLY_MAXIMAL</p>
<p>) should</p>
<p>be suitable for most applications. However, after you have narrowed down the area</p>
<p>in which a memory error (corruption, for example) is occurring, it may be useful</p>
<p>to increase the setting to</p>
<p>M_CHECK_LEVEL_MAXIMAL</p>
<p>shortly before the error is</p>
<p>expected to occur.</p>
<p><b>Example 2.9. Enabling and Disabling All Checks</b></p>
<p>This example requires that you set the<b> DebuggingâRun-Time Memory Checks</b></p>
<p>option to<b> General (Allocations Only)</b> (<b>-check=alloc</b>) before compiling your</p>
<p>program.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>74</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Note that the following code is only meant as an example. Because of the errors</p>
<p>included for demonstration purposes, it may not function exactly as documented if</p>
<p>you copy it into your executable. Line numbers are added for clarity.</p>
<p>#include &lt;ghs_malloc.h&gt;</p>
<p>int main()</p>
<p>{</p>
<p>5</p>
<p>int *arr;</p>
<p>malloc_set_debug_options(M_CHECK_LEVEL_MAXIMAL); /* turn on all checks */</p>
<p>arr = (int *)malloc(100*sizeof(int));</p>
<p>free(arr);</p>
<p>10</p>
<p>arr[5] = 0; /* error - writing to a freed memory location. */</p>
<p>/* it will check and find the last error now */</p>
<p>arr = (int *)malloc(100*sizeof(int));</p>
<p>free(arr);</p>
<p>15</p>
<p>malloc_set_debug_options(M_CHECK_LEVEL_NONE); /* turn off all checks */</p>
<p>arr = (int *)malloc(100*sizeof(int));</p>
<p>20</p>
<p>free(arr);</p>
<p>arr[5] = 0; /* error - writing to a freed memory location. */</p>
<p>malloc_check_lib(M_CHECK_LEVEL_MAXIMAL); /* check malloc data structure now;</p>
<p>detect error from line 21 */</p>
<p>25</p>
<p>return 0;</p>
<p>}</p>
<p>This example does the following:</p>
<p>â¢</p>
<p>malloc_set_debug_options(M_CHECK_LEVEL_MAXIMAL)</p>
<p>on line 7 enables</p>
<p>all the</p>
<p>malloc()</p>
<p>checks, so that the error on line 10 is detected when</p>
<p>malloc()</p>
<p>is called on line 13.</p>
<p>â¢</p>
<p>malloc_check_lib(M_CHECK_LEVEL_MAXIMAL)</p>
<p>on line 23 performs an</p>
<p>immediate check on the</p>
<p>malloc()</p>
<p>data structure, and detects the error on line</p>
<p>21.</p>
<p><i>75</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Enabling Run-Time Memory Checking</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Using Your Own Header Files and Libraries</b></p>
<p><b>Note</b></p>
<p>For information about the headers and libraries provided with your</p>
<p>distribution, see Chapter 16, âLibraries and Header Filesâ on page 817.</p>
<p>You might want to create your own libraries of frequently used functions and instruct</p>
<p>the compiler to link against them. While the compiler knows where to find the</p>
<p>standard libraries and header files provided with your distribution and links against</p>
<p>them, you must tell it where it should search for your own headers and libraries. At</p>
<p>link-time, the linker will attempt to resolve external references in the source files</p>
<p>you pass to it by linking against your libraries before searching the standard libraries.</p>
<p><b>Instructing the Compiler to Search for Your Headers</b></p>
<p>To instruct the compiler to look for header files in a new directory:</p>
<p>Enter the directory in the<b> ProjectâInclude Directories</b> option (<b>-I<i>directory</b></i>).</p>
<p>You can specify multiple directories. The compiler searches the directories in the</p>
<p>order in which they are specified.</p>
<p><b>Using Two Forms of the Include Directive</b></p>
<p>The compiler recognizes both standard forms of the</p>
<p>#include</p>
<p>directive (that is,</p>
<p>#include &lt;<i>header</i>&gt;</p>
<p>or</p>
<p>#include &quot;<i>header</i>&quot;</p>
<p>). These forms can specify either</p>
<p>a full path or only a filename. The full range of possible types of</p>
<p>#include</p>
<p>directives are identified in the following:</p>
<p><b>Windows host</b></p>
<p><b>Linux/Solaris host</b></p>
<p>#include &quot;f:\src\h\<i>header</i>.h&quot;</p>
<p>#include &quot;/src/h/<i>header</i>.h&quot;</p>
<p>A</p>
<p>#include &lt;f:\src\h\<i>header</i>.h&gt;</p>
<p>#include &lt;/src/h/<i>header</i>.h&gt;</p>
<p>B</p>
<p>#include &quot;<i>header</i>.h&quot;</p>
<p>#include &quot;<i>header</i>.h&quot;</p>
<p>C</p>
<p>#include &lt;<i>header</i>.h&gt;</p>
<p>#include &lt;<i>header</i>.h&gt;</p>
<p>D</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>76</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The compiler searches for header files included with the various types of</p>
<p>#include</p>
<p>directive in the following ways:</p>
<p>â¢</p>
<p>If the</p>
<p>#include</p>
<p>directive specifies a full path to the header file (cases A and</p>
<p>B above), the compiler searches in that location only. It does not search for</p>
<p>another version of the file in any other directory.</p>
<p>â¢</p>
<p>If the</p>
<p>#include</p>
<p>directive specifies only a filename or a partial path for the</p>
<p>header file, and uses quotes (case C above), the compiler searches in the</p>
<p>following directories, in order:</p>
<p>1.</p>
<p>The directory of the source file that contains the</p>
<p>#include</p>
<p>directive.</p>
<p>2.</p>
<p>Directories specified with the<b> ProjectâInclude Directories</b> option</p>
<p>(<b>-I<i>directory</b></i>), in the order in which they appear on the command line.</p>
<p>3.</p>
<p>The default directories (see âC and C++ Header File Directoriesâ</p>
<p>on page 819).</p>
<p>â¢</p>
<p>If the</p>
<p>#include</p>
<p>directive specifies only a filename or a partial path for the</p>
<p>header file, and uses angle brackets (case D above), the compiler searches in</p>
<p>the following directories, in order:</p>
<p>1.</p>
<p>Directories specified with the<b> ProjectâInclude Directories</b> option</p>
<p>(<b>-I<i>directory</b></i>), in the order in which they appear on the command line, and</p>
<p>then</p>
<p>2.</p>
<p>The default directories (see âC and C++ Header File Directoriesâ</p>
<p>on page 819).</p>
<p><b>Modifying Header File Searches with the -I- Option</b></p>
<p>Specifying a dash (</p>
<p>-</p>
<p>) in the<b> ProjectâInclude Directories</b> list (<b>-I-</b>) changes the</p>
<p>rules for searching for header files where only a filename or partial path is given</p>
<p>(cases C and D):</p>
<p>â¢</p>
<p>For the directive</p>
<p>#include &quot;<i>header</i>.h&quot;</p>
<p>(case C in the previous section),</p>
<p>the compiler searches in the following directories, in order:</p>
<p>1.</p>
<p>Directories specified with</p>
<p>-I<i>directory</i></p>
<p>, in the order in which they appear</p>
<p>on the command line.</p>
<p>2.</p>
<p>The default directories.</p>
<p>The compiler does not search in the directory of the source file.</p>
<p><i>77</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Instructing the Compiler to Search for Your Headers</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>For the directive</p>
<p>#include &lt;<i>header</i>.h&gt;</p>
<p>(case D in the previous section),</p>
<p>the compiler searches in the following directories, in order:</p>
<p>1.</p>
<p>Directories specified with</p>
<p>-I<i>directory</i></p>
<p>that appear on the command</p>
<p>line after the<b> -I-</b> option.</p>
<p>2.</p>
<p>The default directories.</p>
<p>For example, if the command line includes:</p>
<p>-Iquote -I- -Iangle</p>
<p>Then</p>
<p>#include &quot;foo.h&quot;</p>
<p>would refer to the first matching file of<b> quote/foo.h</b> or</p>
<p><b>angle/foo.h</b>, but</p>
<p>#include &lt;foo.h&gt;</p>
<p>could refer only to<b> angle/foo.h</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>78</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Instructing the Compiler to Link Against Your Libraries</b></p>
<p>To instruct the compiler to link against your libraries:</p>
<p>â¢</p>
<p>Specify the directories to search in the<b> ProjectâLibrary Directories</b> option</p>
<p>(<b>-L<i>library_directory</b></i>).</p>
<p>â¢</p>
<p>Specify the library names to link against in the<b> ProjectâLibraries</b> option</p>
<p>(<b>-l<i>library</b></i>). Note that the names of libraries must be specified in their</p>
<p>abbreviated form. For example, a library called<b> libfoo.a</b> would be specified</p>
<p>as<b> foo</b>.</p>
<p><b>Controlling the Assembler</b></p>
<p>Unless you instruct otherwise, the Builder or driver invokes the assembler,<b> ease850</b>,</p>
<p>to process assembly output of the compiler when necessary. In most cases, however,</p>
<p>the compiler generates binary directly. For more information, see âBinary Code</p>
<p>Generationâ on page 274.</p>
<p>Assembler</p>
<p>Assembly</p>
<p>Files(.s)</p>
<p>Object</p>
<p>Files (.o)</p>
<p>You can control the most commonly used features of the assembler with Builder</p>
<p>and driver options. For example, to instruct the assembler to produce a source listing</p>
<p>file:</p>
<p>Specify a filename in the<b> AssemblerâSource Listing Generation</b> option</p>
<p>(<b>-list=<i>[filename]</b></i>).</p>
<p>For a list of all the assembler-specific Builder and driver options, see âAssembler</p>
<p>Optionsâ on page 232. For detailed documentation of the assembler, see Chapter 6,</p>
<p>âThe ease850 Assemblerâ on page 393.</p>
<p><i>79</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Instructing the Compiler to Link Against Your Libraries</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Controlling the Linker</b></p>
<p>Unless you instruct otherwise, the Builder or driver automatically invokes the linker,</p>
<p><b>elxr</b>, to combine the object files.</p>
<p>Linker</p>
<p>Objects (.o)</p>
<p>Libraries (.a)</p>
<p>Executable</p>
<p>You can control the most commonly used features of the linker with Builder and</p>
<p>driver options. For example, to delete unused functions:</p>
<p>Set the<b> LinkerâLinker OptimizationsâDeletion of Unused Functions</b> option</p>
<p>to<b> On</b> (<b>-delete</b>).</p>
<p>For a list of all the linker-specific Builder and driver options, see âLinker Optionsâ</p>
<p>on page 235. For detailed documentation of the linker, see Chapter 9, âThe elxr</p>
<p>Linkerâ on page 469.</p>
<p><b>Working with Linker Directives Files</b></p>
<p>A linker directives file has a<b> .ld</b> extension and controls how the linker links your</p>
<p>program and prepares program sections for allocation into specific regions of</p>
<p>memory on your target. A typical linker directives file contains:</p>
<p>â¢</p>
<p>A<i> memory map</i> â Lists the starting address and size of each region of memory</p>
<p>that is used to contain program code.</p>
<p>â¢</p>
<p>A<i> section map</i> â Lists the program sections and specifies the memory regions</p>
<p>that they will be loaded into.</p>
<p>Linker directives files can also define constants and special symbols that the linker</p>
<p>uses when linking and loading your executable. For more information about the</p>
<p>file format, see âConfiguring the Linker with Linker Directives Filesâ on page 475.</p>
<p>One or more default linker directives files are generated automatically when you</p>
<p>create a new project for the<b> Stand-alone</b> operating system and are placed within</p>
<p>the Target Resources project. Depending on the<b> Program Layout</b> setting you choose</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>80</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>in the<b> Project Wizard</b> (see âAssigning Program Sections to ROM and RAMâ</p>
<p>on page 90), one of these files is added to your program project file for use at</p>
<p>link-time.</p>
<p><b>Note</b></p>
<p>These default files are automatically generated by the<b> Project Wizard</b></p>
<p>by combining the generic section maps in the<i><b> install_dir</i>/target/v800</b></p>
<p>directory with a board-specific memory map taken from</p>
<p><i><b>install_dir</i>/target/v800/<i>target_dir</b></i>.</p>
<p>You may need to edit these default files to add new memory regions or sections,</p>
<p>or to change their attributes. To edit a file, double-click it (or right-click it and select</p>
<p><b>Edit</b>) to open it in a text editor.</p>
<p><i>81</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Working with Linker Directives Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Text and Data Placement</b></p>
<p>The compiler assigns all text and data to<i> program sections</i>, which are named</p>
<p>collections of objects. During the link step, the linker collects all data for each</p>
<p>program section and allocates it in memory, guided by a section map defined in</p>
<p>your linker directives (<b>.ld</b>) file. The section map specifies the location of each</p>
<p>program section in the final output file. Normally, the compiler and linker use a</p>
<p>default set of program sections, but you can also define custom program sections,</p>
<p>assign specific data to them, and assign them to specific memory blocks on your</p>
<p>target.</p>
<p>The following documentation explains how the compiler assigns data to default</p>
<p>program sections and how to create and use custom sections. It goes on to cover</p>
<p>additional topics that explain how to manipulate the placement of text and data</p>
<p>(such as in registers or special data areas), and how to access it.</p>
<p><b>Default Program Sections</b></p>
<p>The default program sections for text and data (except local automatic variables)</p>
<p>are:</p>
<p>â¢</p>
<p>.text</p>
<p>â which holds program code.</p>
<p>â¢</p>
<p>.data</p>
<p>â which holds variables with explicitly initialized values (e.g.</p>
<p>int</p>
<p>i=1;</p>
<p>).</p>
<p>â¢</p>
<p>.bss</p>
<p>â which holds variables that are not explicitly initialized and that are</p>
<p>not COMMON variables (for example,</p>
<p>static int j;</p>
<p>). The Green Hills</p>
<p>startup code initializes this section to all zeros, as required by the C and C++</p>
<p>languages.</p>
<p>â¢</p>
<p>.rodata</p>
<p>â which holds some read-only data, such as</p>
<p>const</p>
<p>variables. This</p>
<p>data varies depending on your target.</p>
<p>â¢</p>
<p>COMMON</p>
<p>â which holds global variables in C that are not explicitly initialized</p>
<p>and whose modules were not compiled with the<b> --no_commons</b> option (see</p>
<p>âAllocation of Uninitialized Global Variablesâ on page 217). When linking an</p>
<p>executable, the linker reassigns each variable in this section based on whether</p>
<p>or not it is explicitly initialized in any of the object files. By default, the linker</p>
<p>reassigns uninitialized global variables in this section to the</p>
<p>.bss</p>
<p>section.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>82</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>If the<i> Small Data Area</i> (SDA) optimization is enabled (see âSpecial Data Area</p>
<p>Optimizationsâ on page 96), the compiler re-allocates some data from the</p>
<p>primary sections to the equivalent SDA sections:</p>
<p>â</p>
<p>.sdata</p>
<p>â</p>
<p>.sbss</p>
<p>â</p>
<p>.rosdata</p>
<p>â</p>
<p>SMALLCOMMON</p>
<p>â¢</p>
<p>If the<i> Zero Data Area</i> (ZDA) optimization is enabled (see âSpecial Data Area</p>
<p>Optimizationsâ on page 96), the compiler re-allocates some data items to the</p>
<p>equivalent ZDA sections:</p>
<p>â</p>
<p>.zdata</p>
<p>â</p>
<p>.zbss</p>
<p>â</p>
<p>.rozdata</p>
<p>â</p>
<p>ZEROCOMMON</p>
<p><b>Note</b></p>
<p>The placement of data depends on compile-time options.</p>
<p><b>Custom Program Sections</b></p>
<p>In addition to the default program sections, you can define your own custom program</p>
<p>sections. Custom program sections allow you to group certain variables or functions</p>
<p>in specific memory blocks on your target, using the following technique:</p>
<p>1.</p>
<p>In your source code, assign text or data into a custom program section.</p>
<p>2.</p>
<p>In your linker directives file, assign the custom section to a memory block on</p>
<p>your target. If you want to initialize the data in a section to zero (as with a</p>
<p>.bss</p>
<p>section), use the</p>
<p>CLEAR</p>
<p>section attribute. For more information, see</p>
<p>âDefining a Section Map with the SECTIONS Directiveâ on page 481.</p>
<p>For example, you might assign some variables that are accessed very often to a</p>
<p>custom program section, and in your linker directives file, assign that section to a</p>
<p>small block of very fast RAM. The following section explains how to assign text</p>
<p>and data into a custom program section.</p>
<p><i>83</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Custom Program Sections</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Assigning Data to Custom Program Sections in C</b></p>
<p>To assign data to a custom program section in C code, use the</p>
<p>#pragma ghs</p>
<p>section</p>
<p>directive. This directive takes variables and functions that the linker would</p>
<p>otherwise assign to the specified default section (such as</p>
<p>.data</p>
<p>or</p>
<p>.bss</p>
<p>) and assigns</p>
<p>them to a custom section instead. In other words, it maps a type of data to a custom</p>
<p>section. Each time you use the directive, it leaves mappings from earlier occurrences</p>
<p>in place, except for those that it explicitly overrides. This directive must be placed</p>
<p>before the definitions of the objects you want to assign to the custom section; placing</p>
<p>it before a declaration has no effect. It should not be used inside of any function.</p>
<p>The syntax for the</p>
<p>#pragma ghs section</p>
<p>directive is:</p>
<p>#pragma ghs section [<i>secttype</i>=&quot;<i>sectname</i>&quot;]</p>
<p>â¢</p>
<p><i>secttype</i> â A text string that represents the default section. Valid values for</p>
<p><i>secttype</i> are listed in the following table.</p>
<p>â¢</p>
<p><i>sectname</i> â The name of the custom section to which you want to re-map text</p>
<p>or data, including the initial period character (</p>
<p>.</p>
<p>). If you specify the word</p>
<p>default</p>
<p>without quotes, it removes the mapping and restores the assignment</p>
<p>rule to its initial state.</p>
<p>â¢</p>
<p>If you do not specify</p>
<p><i>secttype</i>=&quot;<i>sectname</i>&quot;</p>
<p>, all mappings are removed and</p>
<p>section assignment rules are restored to their initial state.</p>
<p><b>Default Program Section</b></p>
<p><i><b>secttype</i> Value</b></p>
<p>.bss</p>
<p>bss</p>
<p>.data</p>
<p>data</p>
<p>.text</p>
<p>text</p>
<p>.rodata</p>
<p>rodata</p>
<p>.sbss</p>
<p>sbss</p>
<p>.sdata</p>
<p>sdata</p>
<p>.rosdata</p>
<p>rosdata</p>
<p>.zbss</p>
<p>zbss</p>
<p>.zdata</p>
<p>zdata</p>
<p>.rozdata</p>
<p>rozdata</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>84</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>For information about assigning objects to special data areas such as</p>
<p>SDA, see âSpecial Data Area Optimizationsâ on page 96.</p>
<p>To change the compiler's default section mappings, see âRename Sectionâ</p>
<p>on page 145.</p>
<p><b>Example 2.10. Assigning Variables to Different Sections</b></p>
<p>This example assigns three different variables to three different sections:</p>
<p>/* Assign x1 to section .data1 */</p>
<p>#pragma ghs section data=&quot;.data1&quot;</p>
<p>int x1 = 1;</p>
<p>/* Assign x2 to section .data2 */</p>
<p>#pragma ghs section data=&quot;.data2&quot;</p>
<p>int x2 = 2;</p>
<p>/* Assign x3 to section .data3 */</p>
<p>#pragma ghs section data=&quot;.data3&quot;</p>
<p>int x3 = 3;</p>
<p>/* Now go back to default rules */</p>
<p>#pragma ghs section data=default</p>
<p><b>Assigning Data to Custom Program Sections in Assembly</b></p>
<p>To assign data to a custom program section in assembly, use the</p>
<p>.section</p>
<p>directive.</p>
<p>When defining a custom section, you must also specify the appropriate attributes:</p>
<p>â¢</p>
<p>a</p>
<p>â allocated to memory</p>
<p>â¢</p>
<p>w</p>
<p>â writable</p>
<p>For example, to define a section</p>
<p>.mydata</p>
<p>that will be laid out in RAM and assign</p>
<p>the variable</p>
<p>foo</p>
<p>to that section, use the following assembly code:</p>
<p>.section &quot;.mydata&quot;,&quot;aw&quot;</p>
<p>foo:</p>
<p><i>85</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Custom Program Sections</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For a complete list of attributes for the</p>
<p>.section</p>
<p>directive, see âSection Control</p>
<p>Directivesâ on page 421.</p>
<p><b>Reserved Section Names</b></p>
<p>The Green Hills run-time environment uses reserved program sections that are</p>
<p>defined in default linker directives files. The run-time object files<b> libsys.a</b>,</p>
<p><b>libstartup.a</b>, and<b> crt0.o</b> use them to set up the run-time environment. If you are</p>
<p>creating custom sections, do not duplicate the names of these reserved sections. For</p>
<p>more information about them, see âCustomizing the Run-Time Environment Program</p>
<p>Sectionsâ on page 499.</p>
<p><b>Aligned Data Sections</b></p>
<p>By default the compiler assigns all data to one of the default data sections according</p>
<p>to its access type, see âDefault Program Sectionsâ on page 82. When data with</p>
<p>different alignment requirements are assigned to the same section, gaps between</p>
<p>data may be present in the section. To avoid such gaps, default data sections can</p>
<p>be split by alignment. Each aligned data section is named</p>
<p><i>sectname</i>.a<i>N</i></p>
<p>, where</p>
<p><i>sectname</i></p>
<p>is the name of the original data section, and</p>
<p><i>N</i></p>
<p>is the alignment in bytes.</p>
<p>To enable aligned data sections:</p>
<p>Set the<b> TargetâText and Data PlacementâAligned Data Sections</b> option to</p>
<p><b>On</b> (<b>-split_data_sections_by_alignment</b>).</p>
<p>For example, the variable</p>
<p>char x = 5;</p>
<p>, normally be assigned to</p>
<p>.data</p>
<p>, would</p>
<p>now be assigned to</p>
<p>.data.a1</p>
<p>, assuming the char type is 1 byte aligned. All other</p>
<p>data which is 1 byte aligned and would normally be assigned to</p>
<p>.data</p>
<p>would also</p>
<p>be assigned to the</p>
<p>.data.a1</p>
<p>section.</p>
<p>By default, the aligned sections feature only takes effect for variables that belong</p>
<p>to the default non-COMMON data sections, such as</p>
<p>.data</p>
<p>,</p>
<p>.bss</p>
<p>and</p>
<p>.rodata</p>
<p>.</p>
<p>For a complete list of default sections, see âDefault Program Sectionsâ on page 82.</p>
<p>Variables that are in a user-named section by pragma</p>
<p>#pragma ghs section</p>
<p>,</p>
<p>attribute</p>
<p>__attribute__((section(&quot;<i>name</i>&quot;)))</p>
<p>, or by driver option<b> -section</b></p>
<p>are not assigned to an aligned data section, and are kept it in the user-named section.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>86</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>The aligned data section feature does not take effect for uninitialized</p>
<p>global variables in C that are COMMON. To assign uninitialized global</p>
<p>variables in C to aligned sections, use<b> --no_commons</b> (see âAllocation</p>
<p>of Uninitialized Global Variablesâ on page 217) to disable commons if</p>
<p>possible.</p>
<p>At link time, the linker coalesces sections</p>
<p><i>sectname</i>.a<i>N</i></p>
<p>into section</p>
<p><i>sectname</i></p>
<p>in the executable output file automatically, unless you explicitly list the aligned</p>
<p>section in the linker directives file, in which case the aligned section will be placed</p>
<p>in the output file according to the section map specified.</p>
<p>If an object file containing an aligned section is linked to a relocatable object file</p>
<p>instead of to an executable program (with the<b> -relobj</b> option), the linker keeps the</p>
<p>aligned section in the relocatable object file and does not merge it into the section</p>
<p>which the aligned section derived from. When more than one object file contains</p>
<p>the same aligned section, they are merged into the same aligned section in the</p>
<p>relocatable object file.</p>
<p><b>Note</b></p>
<p>The</p>
<p>SORT</p>
<p>linker directive can be used to sort</p>
<p><i>sectname</i>.a<i>N</i></p>
<p>sections</p>
<p>across different modules. For more information, see âUsing Wildcards</p>
<p>in Section Inclusion Commandsâ on page 485.</p>
<p>Aligned sections are not supported for variables in</p>
<p>.ghs.linkonce</p>
<p>sections. These</p>
<p>variables stay in the</p>
<p>.ghs.linkonce</p>
<p>.</p>
<p><b>Individual Function and Variable Sections</b></p>
<p>Normally the compiler assigns all functions or subroutines to a single text section</p>
<p>.text</p>
<p>, and all variables to one of the default data sections according to their access</p>
<p>types, that is, whether they are initialized, uninitialized or read-only. For more</p>
<p>flexibility on locating functions or variables in the program, you can instruct the</p>
<p>compiler to assign functions (including static functions) or non-COMMON global</p>
<p>and static variables (including function scope local static variables) to their own</p>
<p>individual sections by the individual section feature. The name of each individual</p>
<p>section is formed by appending the symbol name of the function or variable to the</p>
<p>name of the original section. For example, the individual section for a function</p>
<p>foo</p>
<p><i>87</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Individual Function and Variable Sections</i></p>
<h1 style="page-break-before:always; "></h1>
<p>in</p>
<p>.text</p>
<p>is named</p>
<p>.text.foo</p>
<p>. Likewise, the individual section for an initialized</p>
<p>global variable</p>
<p>x</p>
<p>in section</p>
<p>.data</p>
<p>is named</p>
<p>.data.x</p>
<p>.</p>
<p>At link time, the linker coalesces an individual section</p>
<p><i>sectname</i>.<i>symname</i></p>
<p>into</p>
<p>section</p>
<p><i>sectname</i></p>
<p>in the executable output file automatically, unless you explicitly</p>
<p>list the individual section in the linker directives file, in which case the individual</p>
<p>section will be placed in the output file according to the section map specified. This</p>
<p>is one of the benefits of individual sections: you can place a function or variable to</p>
<p>an arbitrary address by assigning it to an individual section by the individual section</p>
<p>feature, then specifying the address explicitly for the individual section in the linker</p>
<p>directives file.</p>
<p>If the individual section is not specified in the linker directives file, it will be merged</p>
<p>into the original section in the output executable file. The placement of the function</p>
<p>or variable in the final executable program depends on the order of the object file</p>
<p>that contains the individual section is processed, and the order of the individual</p>
<p>section itself in the object file's symbol table. It is not guaranteed that a function or</p>
<p>variable will have the same address in the program if it is placed in an individual</p>
<p>section as the address it would have if it was not placed in an individual section.</p>
<p>If an object file containing an individual section is linked to a relocatable object</p>
<p>file instead of to an executable program (with the<b> -relobj</b> option), the linker keeps</p>
<p>the individual section in the relocatable object file and does not merge it into the</p>
<p>section which the individual section derived from. When more than one object file</p>
<p>contains the same individual section, they are merged into the same individual</p>
<p>section in the relocatable object file.</p>
<p>Normally the symbol name in an individual section's name matches the one existing</p>
<p>in the symbol table of the compiled object file, that is, the symbol name of a function</p>
<p>or variable is the name of the function or variable with an underscore (&quot;_&quot;) added</p>
<p>at the beginning. But this is not always the case. For example, for a function in C++,</p>
<p>the symbol name is a compiler-generated mangled name; for a function scope local</p>
<p>static variable, the symbol name is a compiler-generated label. If you need to</p>
<p>explicitly reference an individual section's name, for instance, in a linker directives</p>
<p>file, it is recommended that you look up the symbol table of the compiled object</p>
<p>file to find the correct symbol name to use. You can look up the symbol table by</p>
<p>running<b> gdump</b> or<b> gnm</b> on the compiled object file.</p>
<p>By default, the individual section feature only takes effect for functions or variables</p>
<p>that belong to the default text or non-COMMON data sections, such as</p>
<p>.text</p>
<p>,</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>88</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.data</p>
<p>and</p>
<p>.bss</p>
<p>. For a complete list of default sections, see âDefault Program</p>
<p>Sectionsâ on page 82.</p>
<p><b>Note</b></p>
<p>The individual section feature does not take effect for uninitialized global</p>
<p>variables in C that are COMMON. To assign uninitialized global variables</p>
<p>in C to individual sections, use<b> --no_commons</b> (see âAllocation of</p>
<p>Uninitialized Global Variablesâ on page 217) to disable commons if</p>
<p>possible.</p>
<p>Options are provided to enable the individual section feature for functions or</p>
<p>variables that are assigned to user defined custom sections. For a complete list of</p>
<p>the driver options related to the individual section feature, see:</p>
<p>â¢</p>
<p>âIndividual Variable Sections for Default Data Sectionsâ on page 146</p>
<p>â¢</p>
<p>âIndividual Variable Sections for Renamed Data Sectionsâ on page 146</p>
<p>â¢</p>
<p>âIndividual Variable Sections for User-Defined Data Sectionsâ on page 147</p>
<p>â¢</p>
<p>âIndividual Function Sections for Default Text Sectionâ on page 148</p>
<p>â¢</p>
<p>âIndividual Function Sections for Renamed Text Sectionsâ on page 148</p>
<p>â¢</p>
<p>âIndividual Function Sections for User-Defined Text Sectionsâ on page 149</p>
<p>Individual sections are not supported for functions and variables in</p>
<p>.ghs.linkonce</p>
<p>sections. These functions or variables stay in the</p>
<p>.ghs.linkonce</p>
<p>sections, no</p>
<p>matter what individual section options are used.</p>
<p><i>89</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Individual Function and Variable Sections</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Assigning Program Sections to ROM and RAM</b></p>
<p>In embedded programming, it is generally the case that all program sections must</p>
<p>be initially located in ROM to prevent their loss upon reset, and that any program</p>
<p>sections containing data that may change at run-time must be copied into RAM at</p>
<p>startup. You must decide how much of your program code will be copied into RAM</p>
<p>at startup. Two factors that influence this decision are the amount of available RAM</p>
<p>and the emphasis on speed of execution. In general:</p>
<p>â¢</p>
<p>Programs that copy all of their sections from ROM to RAM at startup execute</p>
<p>more quickly, but require more RAM.</p>
<p>â¢</p>
<p>Programs that copy as few sections as possible from ROM to RAM at startup</p>
<p>require less RAM, but execute more slowly.</p>
<p>Green Hills provides default linker directives files to manage the location of program</p>
<p>sections. To specify one of them when creating a project with the<b> Project Wizard</b></p>
<p>(see the documentation about creating a project in the<i> MULTI: Managing Projects</i></p>
<p><i>and Configuring the IDE</i> book), set the<b> Program Layout</b> option to one of the</p>
<p>following settings:</p>
<p>â¢</p>
<p><b>Link to and execute out of RAM</b> (<b>-layout=ram</b>) â [default] The program</p>
<p>is linked so that it is loaded into, and executes out of RAM. Such programs are</p>
<p>usually downloaded and started by running the Debugger and a debug server.</p>
<p>This layout is generally used in the early stages of development. It appears in</p>
<p>the Target Resources project as<b> standalone_ram.ld</b>.</p>
<p>â¢</p>
<p><b>Link to and execute out of ROM</b> (<b>-layout=romrun</b>) â The program is linked</p>
<p>so that it can be loaded into, and executes out of ROM/FLASH. Such programs</p>
<p>must be burned into flash (for example, by using MULTI Fast Flash</p>
<p>Programmer). This layout may be used for producing a final executable. It</p>
<p>requires the least amount of RAM, but is typically slower, and cannot be</p>
<p>debugged using software breakpoints. Some features that rely on software</p>
<p>breakpoints may not be available in this mode, including system calls, command</p>
<p>line function calls, memory leak detection, and run-time error checking. It</p>
<p>appears in the Target Resources project as<b> standalone_romrun.ld</b>. For more</p>
<p>information about the MULTI Fast Flash Programmer, see the documentation</p>
<p>about programming flash memory in the<i> MULTI: Debugging</i> book.</p>
<p>â¢</p>
<p><b>Link to ROM and execute out of RAM</b> (<b>-layout=romcopy</b>) â The program</p>
<p>is linked so that it can be loaded into ROM/FLASH, but copies itself to RAM</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>90</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>and executes out of RAM. Such programs must be burned into flash. This</p>
<p>layout can be used for producing a final executable. It is faster than the</p>
<p>romrun</p>
<p>layout and offers software breakpoint debugging, but takes longer to initialize</p>
<p>and requires more RAM. It appears in the Target Resources project as</p>
<p><b>standalone_romcopy.ld</b>.</p>
<p>â¢</p>
<p><b>Link for Position Independent Code</b> â A special linker directives file for</p>
<p>projects built with<i> Position Independent Code</i> (see âPosition Independent Code</p>
<p>(PIC)â on page 117). It appears in the Target Resources project as</p>
<p><b>standalone_pic.ld</b>.</p>
<p>â¢</p>
<p><b>Link for Position Independent Data</b> â A special linker directives file for</p>
<p>projects built with<i> Position Independent Data</i> (see âPosition Independent Data</p>
<p>(PID)â on page 119). It appears in the Target Resources project as</p>
<p><b>standalone_pid.ld</b>.</p>
<p>â¢</p>
<p><b>Link for Position Independent Code and Data</b> â A special linker directives</p>
<p>file for projects with<i> Position Independent Code</i> and<i> Data</i>. It appears in the</p>
<p>Target Resources project as<b> standalone_picpid.ld</b>.</p>
<p>Whichever layout you choose when creating your project, the<b> Project Wizard</b> puts</p>
<p>all linker directives files in the Target Resources project. To change your program</p>
<p>layout, right-click your program's project and select<b> Configure</b>.</p>
<p>These linker directives files provide a basic section map. If you want to use custom</p>
<p>sections and control precisely where text and data are located, edit your linker</p>
<p>directives file using the information in âConfiguring the Linker with Linker</p>
<p>Directives Filesâ on page 475. For further discussion about optimizing your program</p>
<p>by editing your linker directives file, see âModifying your Section Map for Speed</p>
<p>or Sizeâ on page 498.</p>
<p>If you are using the driver with the<b> -layout=</b> option, you must also specify the<b> -bsp=</b></p>
<p>option (see âSpecifying a V850 and RH850 Targetâ on page 52). If no appropriate</p>
<p>BSP is available, specify<b> -bsp=generic</b>. The<b> -layout=</b> option is ignored if you</p>
<p>specify your own linker directives files.</p>
<p><i>91</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Assigning Program Sections to ROM and RAM</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Storing Global Variables in Registers</b></p>
<p>Machine registers are primarily used by the compiler to store local variables or</p>
<p>working values. This generally produces smaller and faster code than if most</p>
<p>variables were on the stack. In certain circumstances, however, you can also allocate</p>
<p>critical global data to registers (though this may decrease performance). Unless you</p>
<p>are building INTEGRITY code, you can reserve up to 5 global registers (</p>
<p>r20</p>
<p>to</p>
<p>r24</p>
<p>in that order). To do so:</p>
<p>Specify the number of registers you want to reserve with the<b> TargetâText and</b></p>
<p><b>Data PlacementâGlobal Registers</b> (<b>-globalreg=<i>n</b></i>) option.</p>
<p><b>Note</b></p>
<p>This option may not work correctly if you customize your startup code.</p>
<p>If you are building INTEGRITY code, you cannot modify the default</p>
<p>value of this option.</p>
<p><b>Note</b></p>
<p>The registers reserved will change if certain Builder or driver options are</p>
<p>passed:</p>
<p>The following Builder or driver options restrict which registers may be</p>
<p>reserved:</p>
<p>â¢</p>
<p><b>-r20has255</b>: Only</p>
<p>r21-r24</p>
<p>are available.</p>
<p>â¢</p>
<p><b>-r21has65535</b>: Only</p>
<p>r22-r24</p>
<p>are available.</p>
<p>â¢</p>
<p><b>-registermode=22</b>: No registers are available. The<b> register</b> keyword</p>
<p>is accepted but ignored.</p>
<p>â¢</p>
<p><b>-registermode=26</b>: Only</p>
<p>r23</p>
<p>and</p>
<p>r24</p>
<p>are available.</p>
<p>The Green Hills library startup code (âStartup Module crt0.oâ on page 865)</p>
<p>initializes all permanent registers as if the register mode were set to 32.</p>
<p>Additionally, the Green Hills library</p>
<p>setjmp</p>
<p>and</p>
<p>longjmp</p>
<p>implementations save and restores all permanent registers as if the register</p>
<p>mode were set to 32.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>92</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Setting this option allows the C/C++</p>
<p>register</p>
<p>keyword to place global variables</p>
<p>in registers using the following syntax:</p>
<p>register int i; /* file scope implies global */</p>
<p>The usage of the</p>
<p>register</p>
<p>keyword is otherwise illegal.</p>
<p><b>Note</b></p>
<p>The syntax</p>
<p>register static int i</p>
<p>is still illegal, because it can</p>
<p>cause a possible register numbering problem when compiling multiple</p>
<p>files.</p>
<p>The data type of the global variable can be any integral or pointer type where a local</p>
<p>variable of that type would be eligible for allocation to a single register. It must not</p>
<p>be explicitly initialized, and its address should never be taken. The program must</p>
<p>be compiled with the Green Hills startup code.</p>
<p>Global registers are permanent registers, so functions compiled with this option can</p>
<p>call (but not be called by) functions compiled without it, including third-party object</p>
<p>files and libraries. A function cannot access variables allocated to global registers</p>
<p>unless all functions in the call chain before it were compiled with the global registers</p>
<p>reserved. The easiest way to guarantee this is to compile all files with this option.</p>
<p>The Green Hills libraries are compiled with appropriate options to allow linking</p>
<p>with programs that use global registers. It is also generally not safe to use variables</p>
<p>allocated to global registers in interrupt functions because such interrupts might be</p>
<p>triggered asynchronously.</p>
<p>If you want to share the same global registers across compilations, consider placing</p>
<p>them into a single</p>
<p>#include</p>
<p>file, which is always included first in all compilations</p>
<p>to ensure consistency.</p>
<p><b>Near and Far Function Calls</b></p>
<p>A function call is normally performed with an instruction that contains a 22-bit</p>
<p>value that is added to the address of the current instruction to yield the address of</p>
<p>the called function. If the offset to the called function is greater than 22 bits, a direct</p>
<p>call instruction will be out of range.</p>
<p>To avoid this problem, the compiler provides support for<i> far function calls</i>. The</p>
<p>compiler generates a series of instructions to place the address of the called function</p>
<p><i>93</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Near and Far Function Calls</i></p>
<h1 style="page-break-before:always; "></h1>
<p>into a register before the function call. This method allows you to reach a function</p>
<p>anywhere in the address space of the processor, but it requires additional code size</p>
<p>and processor time.</p>
<p><b>Call Patching</b></p>
<p>By default, the linker handles far function calls using<i> call patching</i>. Call patching</p>
<p>causes the linker to automatically detect function calls that are out-of-range and</p>
<p>insert code between modules to resolve the far function call. The linker does this</p>
<p>by creating a small patch of code, called a call patch, to perform a jump to the</p>
<p>out-of-range function. It then changes the destination of the original function call</p>
<p>to point to the call patch. This method impacts code size and run time less than</p>
<p>using far function calls because it affects only those calls that are out-of-range. The</p>
<p>one limitation of call patching is that the module containing the offending function</p>
<p>call must be 2 MB or smaller; otherwise, the linker will not be able to place the call</p>
<p>patch close enough to the function call.</p>
<p>Sometimes, you may want to rearrange code manually instead of using call patching.</p>
<p>To disable call patching:</p>
<p>Set the<b> TargetâText and Data PlacementâLinker-Based Far Call Patching</b></p>
<p>option to<b> Off</b> (<b>-nofarcallpatch</b>).</p>
<p><b>Far Function Call Build Option</b></p>
<p>To enable far function calls for every function:</p>
<p>Set the<b> TargetâText and Data PlacementâFar Calls</b> option to<b> Make All Calls</b></p>
<p><b>Far Calls</b> (<b>-farcalls</b>).</p>
<p>This option instructs the compiler to generate a far function call for every call (with</p>
<p>no need for modifications to the source code), unless the option is overridden by</p>
<p>one of the other methods specified below. This method should only be used when</p>
<p>far call patching is not an effective solution.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>94</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Function Call Pragma Directives</b></p>
<p>The following</p>
<p>#pragma</p>
<p>directives govern the declaration of functions. When you</p>
<p>use one of these directives, all function declarations after it will be modified until</p>
<p>another of these</p>
<p>#pragma</p>
<p>directives occurs.</p>
<p>#pragma ghs near</p>
<p>#pragma ghs callmode=near</p>
<p>Any function declared after this directive will be called using a near function call.</p>
<p>#pragma ghs callmode=callt</p>
<p>Any function declared after this directive will be called using the</p>
<p>callt</p>
<p>instruction and will</p>
<p>return using the</p>
<p>ctret</p>
<p>instruction. Users should take caution to ensure that both the declaration</p>
<p>(prototype) and definition (where the routine is written) of the routine are declared with this</p>
<p>pragma, to ensure calls to the routine are done correctly, and to ensure the function return from</p>
<p>the routine is done correctly.</p>
<p>#pragma ghs far</p>
<p>#pragma ghs callmode=far</p>
<p>Any function declared after this directive will be called using a far function call.</p>
<p>#pragma ghs callmode=default</p>
<p>Any function declared after this directive will be called as directed by the<b> TargetâText and</b></p>
<p><b>Data PlacementâFar Calls</b> builder option (see âText and Data Placementâ on page 136).</p>
<p>Note that in certain cases, such as when both the caller and callee are located in the</p>
<p>same file, the compiler may be able to determine that a far function call is</p>
<p>unnecessary, and so perform a near call regardless of the</p>
<p>#pragma</p>
<p>directive.</p>
<p><b>Function Declaration</b></p>
<p>The keywords</p>
<p>__nearcall</p>
<p>and</p>
<p>__farcall</p>
<p>and</p>
<p>__callt</p>
<p>may be placed in the</p>
<p>declaration of a function to specify the type of function call to be used for that</p>
<p>function. These keywords override the setting implied by either the</p>
<p>#pragma</p>
<p>directive or the command line option. For example:</p>
<p>__nearcall int nearfunc();</p>
<p>__farcall int farfunc();</p>
<p>__callt int tablefunc();</p>
<p>The syntax requires that</p>
<p>__nearcall</p>
<p>and</p>
<p>__farcall</p>
<p>and</p>
<p>__callt</p>
<p>be placed</p>
<p>before the function return type.</p>
<p><i>95</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Near and Far Function Calls</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The</p>
<p>__nearcall</p>
<p>and</p>
<p>__farcall</p>
<p>and</p>
<p>__callt</p>
<p>keywords cannot be used for</p>
<p>function pointers, but only for functions themselves. They cannot be used in</p>
<p>typedef</p>
<p>statements, casts, or in the type of a function parameter. Furthermore,</p>
<p>functions declared with the</p>
<p>__callt</p>
<p>keyword cannot have their addresses taken.</p>
<p><b>Note</b></p>
<p>Users should take caution to ensure that both the declaration (prototype)</p>
<p>and definition (where the routine is written) of the routine are declared</p>
<p>with this</p>
<p>__callt</p>
<p>keyword, to ensure calls to the routine are done</p>
<p>correctly, and to ensure the function return from the routine is done</p>
<p>correctly.</p>
<p><b>Special Data Area Optimizations</b></p>
<p>Special data area optimizations place certain data in a special memory block that</p>
<p>can be accessed by using an offset from a base address. In most cases, data in this</p>
<p>block can be accessed more efficiently than other data. This optimization does not</p>
<p>change the basic function of your program.</p>
<p>V850 and RH850 supports<i> Small Data Area</i> (SDA) optimization and a specialized</p>
<p>version of SDA called<i> Zero Data Area</i> (ZDA) optimization. This section describes</p>
<p>these optimizations and explains how to allocate data to special data areas.</p>
<p><b>Small Data Area (SDA) Optimization</b></p>
<p>Small Data Area (SDA) optimization uses two special data areas, RAM SDA and</p>
<p>ROM SDA, each containing 64 KB of data.</p>
<p>In general, the combined size of data segments that are assigned to SDA cannot</p>
<p>exceed 128 KB. By convention, the Green Hills compiler uses register</p>
<p>r4</p>
<p>as the</p>
<p>base register for the RAM SDA, and register</p>
<p>r5</p>
<p>as the base register for the ROM</p>
<p>SDA. Because offset-based addressing on the V850 and RH850 processor is signed,</p>
<p>an SDA base register points 32 KB past the start of the SDA to provide a full 64</p>
<p>KB of addressing.</p>
<p>The V850E2V3 and later processors can have the size of the RAM SDA and ROM</p>
<p>SDA extended to 8 MB using the<b> -large_sda</b> option; see â8 MB Special Data Areas</p>
<p>on the V850E2V3â on page 105 for more details.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>96</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>In order to implement SDA optimization, the compiler, assembler, and linker define</p>
<p>the following special program sections:</p>
<p>â¢</p>
<p>.sdata</p>
<p>â initialized read/write data</p>
<p>â¢</p>
<p>.sbss</p>
<p>â uninitialized read/write data</p>
<p>â¢</p>
<p>.rosdata</p>
<p>â constant data</p>
<p><b>Zero Data Area (ZDA) Optimization</b></p>
<p>Zero Data Area (ZDA) optimization is a special case of SDA that uses register</p>
<p>r0</p>
<p>,</p>
<p>which is hardwired to the value zero, to access memory around address zero. Certain</p>
<p>variables and data structures can then be accessed using offsets from</p>
<p>r0</p>
<p>rather than</p>
<p>full 32-bit addresses. ZDA is not supported with Position Independent Data (PID).</p>
<p>Due to the limitations on the offset-based addressing used to access ZDA variables,</p>
<p>the size of the ZDA is limited to a total of 64 KB.</p>
<p>The V850E2V3 and later processors can have the size of the ZDA extended to 8</p>
<p>MB using the<b> -large_zda</b> option; see â8 MB Special Data Areas on the V850E2V3â</p>
<p>on page 105 for more details.</p>
<p>To implement ZDA optimization, the compiler, assembler, and linker define the</p>
<p>following special program sections:</p>
<p>â¢</p>
<p>.zdata</p>
<p>â initialized data</p>
<p>â¢</p>
<p>.zbss</p>
<p>â uninitialized data</p>
<p>â¢</p>
<p>.rozdata</p>
<p>â constant data</p>
<p><b>Assigning Data to Special Data Areas Using a Threshold</b></p>
<p>You can assign a threshold value (as an integer in bytes) so that the compiler assigns</p>
<p>variables of that size or smaller to a special data area.</p>
<p>To specify an SDA threshold value:</p>
<p><i>97</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Special Data Area Optimizations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Set the<b> TargetâText and Data PlacementâSpecial Data Area</b> option to<b> Small</b></p>
<p><b>Data Area</b> (<b>-sda=<i>threshold_value</b></i>)</p>
<p>To specify a ZDA threshold value:</p>
<p>Set the<b> TargetâText and Data PlacementâSpecial Data Area</b> option to<b> Zero</b></p>
<p><b>Data Area</b> (<b>-zda=<i>threshold_value</b></i>)</p>
<p>Where<i> threshold_value</i> must be one of the following:</p>
<p>â¢</p>
<p>none</p>
<p>â does not assign any data to the special data area using a threshold. If</p>
<p>specified as<b> -zda=none</b>, this setting disables the</p>
<p>#pragma ghs startzda</p>
<p>and</p>
<p>#pragma ghs endzda</p>
<p>directives. If specified as<b> -sda=none</b>, this setting</p>
<p>does not disable any</p>
<p>#pragma</p>
<p>directives.</p>
<p>â¢</p>
<p>0</p>
<p>â does not assign any data to special data areas using thresholds, but does</p>
<p>not disable any</p>
<p>#pragma</p>
<p>directives. Use this option when you want to assign</p>
<p>variables to special data areas with</p>
<p>#pragma</p>
<p>directives only.</p>
<p>â¢</p>
<p><i>n</i></p>
<p>â assigns all variables up to<i> n</i> bytes in size to the special data area.<i> n</i> must</p>
<p>be a positive integer.</p>
<p>â¢</p>
<p>all</p>
<p>â assigns all variables to the special data area. While there is no size</p>
<p>limitation, this option may cause the special data area to overflow.</p>
<p>â¢</p>
<p>never</p>
<p>â similar to</p>
<p>none</p>
<p>, with two additional features: 1) Unless it is reserved</p>
<p>to be the PID base by</p>
<p>-pid</p>
<p>, the SDA base register</p>
<p>r4</p>
<p>is available to the</p>
<p>compiler for other uses. 2) The directive</p>
<p>#pragma ghs startsda</p>
<p>and</p>
<p>#pragma ghs endsda</p>
<p>are disabled in the compiler.</p>
<p><b>-sda=</b> and<b> -zda=</b> are mutually exclusive options; if you enable both of them on the</p>
<p>command line, the last option takes effect</p>
<p><b>Note</b></p>
<p><b>-sda=never</b> should only be used if all source files in the program are</p>
<p>compiled with<b> -sda=never</b> or they contain no SDA</p>
<p>#pragma</p>
<p>directives</p>
<p>and are compiled with<b> -sda=none</b> or<b> -sda=0</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>98</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p><b>-sda=never</b> is only supported on the RH850 and newer processors.</p>
<p><b>Assigning Data to Special Data Areas Using a File</b></p>
<p>You can assign symbols to the special data areas using a file consisting of symbol</p>
<p>names, one per line.</p>
<p>To specify a file to use for SDA:</p>
<p>Set the<b> TargetâText and Data PlacementâSmall Data Area File</b> option to</p>
<p>the desired filename (<b>-sda_file=<i>filename</b></i>)</p>
<p>To specify a file to use for ZDA:</p>
<p>Set the<b> TargetâText and Data PlacementâZero Data Area File</b> option to the</p>
<p>desired filename (<b>-zda_file=<i>filename</b></i>)</p>
<p>Where<i> filename</i> must both exist and be readable.</p>
<p><b>Assigning Specific Data To Special Data Areas in C</b></p>
<p>When programming in a high-level language, you can assign individual variables</p>
<p>to a special data area by enclosing them in a set of</p>
<p>#pragma</p>
<p>directives. These</p>
<p>directives are:</p>
<p>â¢</p>
<p>For SDA â</p>
<p>#pragma ghs startsda</p>
<p>/</p>
<p>#pragma ghs endsda</p>
<p>â¢</p>
<p>For ZDA â</p>
<p>#pragma ghs startzda</p>
<p>/</p>
<p>#pragma ghs endzda</p>
<p>The</p>
<p>startsda</p>
<p>and</p>
<p>startzda</p>
<p>directives cause the compiler to allocate all</p>
<p>subsequent variables to the special data area, even if they exceed a specified threshold</p>
<p>value (see âAssigning Data to Special Data Areas Using a Thresholdâ on page 97).</p>
<p>An</p>
<p>endsda</p>
<p>or</p>
<p>endzda</p>
<p>directive ends this mode.</p>
<p><i>99</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Special Data Area Optimizations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If a variable is declared between these</p>
<p>#pragma</p>
<p>directives and then declared again</p>
<p>outside them, the compiler assigns the variable to the special data area.</p>
<p>If a variable is declared</p>
<p>extern</p>
<p>between special data area</p>
<p>#pragma</p>
<p>directives and</p>
<p>later in the same module is defined as a global variable without them, it still goes</p>
<p>into the special data area.</p>
<p><b>Note</b></p>
<p>If you use these directives for ZDA and set the option<b> -zda=none</b>, the</p>
<p>compiler issues a warning.</p>
<p>If you want only those variables explicitly specified by these</p>
<p>#pragma</p>
<p>directives</p>
<p>to be allocated to the special data area, set the threshold value to</p>
<p>0</p>
<p>(see âAssigning</p>
<p>Data to Special Data Areas Using a Thresholdâ on page 97).</p>
<p><b>Excluding Specific Data From Special Data Areas in C</b></p>
<p>To exclude data from a special data area even if it is smaller than or equal to the</p>
<p>specified threshold value, enclose the variable declarations in a</p>
<p>#pragma ghs</p>
<p>startdata</p>
<p>/</p>
<p>#pragma ghs enddata</p>
<p>block. Variables defined within this block</p>
<p>are never assigned to a special data area.</p>
<p>For example, if you set the SDA threshold value to</p>
<p>8</p>
<p>:</p>
<p>int foo_a = 4;</p>
<p>/* goes into SDA */</p>
<p>#pragma ghs startdata</p>
<p>int foo_b = 4;</p>
<p>/* does not go into SDA */</p>
<p>#pragma ghs enddata</p>
<p><b>Assigning Specific Data To Special Data Areas in Assembly</b></p>
<p>When programming in assembly language, assign data to a special data area using</p>
<p>the</p>
<p>.section</p>
<p>assembler directive. You must assign the appropriate attributes to</p>
<p>that section.</p>
<p>For example, to include the variable</p>
<p>sda_var</p>
<p>in the</p>
<p>.sdata</p>
<p>section, enter the</p>
<p>following in your assembly file:</p>
<p>.section &quot;.sdata&quot;,&quot;aw&quot;</p>
<p>sda_var:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>100</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>To include the variable</p>
<p>zda_var</p>
<p>in the</p>
<p>.zdata</p>
<p>section of ZDA, enter the following</p>
<p>in your assembly file:</p>
<p>.section &quot;.zdata&quot;,&quot;aw&quot;</p>
<p>zda_var:</p>
<p>ROM SDA sections only require the</p>
<p>a</p>
<p>attribute, because they are not writable.</p>
<p>For a complete list of attributes for the</p>
<p>.section</p>
<p>directive, see âSection Control</p>
<p>Directivesâ on page 421.</p>
<p><b>Editing Linker Directives Files for Use with SDA</b></p>
<p>The linker directives (<b>.ld</b>) file for a program that uses the SDA optimization must</p>
<p>list SDA-related sections in a specific order. In particular, custom sections must be</p>
<p>listed after the appropriate RAM SDA or ROM SDA start directive. The Green</p>
<p>Hills tools define the base register(s) to point to the middle of the memory region</p>
<p>enclosed by the appropriate start and end symbols for the SDA region. For example,</p>
<p>the RAM SDA base register will be initialized to the middle of the memory region</p>
<p>enclosed by the</p>
<p>.sda_start</p>
<p>and</p>
<p>.sda_end</p>
<p>sections, while the ROM SDA base</p>
<p>register will be initialized to the middle of the memory region enclosed by the</p>
<p>.rosda_start</p>
<p>and</p>
<p>.rosda_end</p>
<p>sections.</p>
<p>RAM SDA sections must be listed in the following order:</p>
<p>â¢</p>
<p>Empty section used by Green Hills debug servers and startup code</p>
<p>(</p>
<p>.sda_start</p>
<p>)</p>
<p>â¢</p>
<p>Default SDA section for initialized data (</p>
<p>.sdata</p>
<p>)</p>
<p>â¢</p>
<p>Custom SDA sections for initialized data, if any</p>
<p>â¢</p>
<p>Default SDA section for zero-initialized data (</p>
<p>.sbss</p>
<p>)</p>
<p>â¢</p>
<p>Custom SDA sections for zero-initialized data, if any</p>
<p>â¢</p>
<p>Empty section used by Green Hills debug servers and startup code (</p>
<p>.sda_end</p>
<p>)</p>
<p>ROM SDA sections must be listed in the following order:</p>
<p>â¢</p>
<p>Empty section used by Green Hills debug servers and startup code</p>
<p>(</p>
<p>.rosda_start</p>
<p>)</p>
<p>â¢</p>
<p>Default ROM SDA section (</p>
<p>.rosdata</p>
<p>)</p>
<p><i>101</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Special Data Area Optimizations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Custom ROM SDA sections, if they exist</p>
<p>â¢</p>
<p>Empty section used by Green Hills debug servers and startup code</p>
<p>(</p>
<p>.rosda_end</p>
<p>)</p>
<p><b>Example 2.11. Linker Directives File for an SDA-Optimized Program</b></p>
<p>The following is an example of a linker directives file for an SDA-optimized program</p>
<p>that has a user-defined SDA section,</p>
<p>.mysdata</p>
<p>.</p>
<p>SECTIONS</p>
<p>{</p>
<p>.text 0x10000 :</p>
<p>.syscall :</p>
<p>.secinfo :</p>
<p>.rodata :</p>
<p>.ROM.data</p>
<p>ROM(.data) :</p>
<p>.ROM.sdata</p>
<p>ROM(.sdata) :</p>
<p>.ROM.mysdata ROM(.mysdata) :</p>
<p>.sda_start align(8) :</p>
<p>.sdata :</p>
<p>.mysdata :</p>
<p>.sbss :</p>
<p>.sda_end :</p>
<p>.data :</p>
<p>.bss :</p>
<p>.heap align(16) pad(0x100000) :</p>
<p>.stack align(16) pad(0x80000) :</p>
<p>}</p>
<p><b>Editing Linker Directives Files for Use with ZDA</b></p>
<p>You must specify the placement of the ZDA in a linker directives (<b>.ld</b>) file. The</p>
<p>linker directives file will vary depending on the availability of ROM and RAM near</p>
<p>location zero. For example, if RAM is available from address</p>
<p>0x0</p>
<p>through address</p>
<p>0x1000</p>
<p>, the following entries might be included in the linker directives file:</p>
<p>.zdata 0x0 :</p>
<p>.zbss max_endaddress(0x1000)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>102</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Assigning Data to Custom Special Data Area Sections</b></p>
<p>To assign variables to a custom special data area section, use</p>
<p>#pragma ghs</p>
<p>section</p>
<p>within a block of C code. The following example assigns SDA variables</p>
<p>to both the default SDA section</p>
<p>.sdata</p>
<p>and a custom SDA section</p>
<p>.mysdata</p>
<p>:</p>
<p>#pragma ghs startsda</p>
<p>/* puts variables into default SDA section */</p>
<p>int e = 3;</p>
<p>double f = 15.2;</p>
<p>#pragma ghs section sdata=&quot;.mysdata&quot;</p>
<p>/* puts variables into .mysdata user-defined SDA section */</p>
<p>int g = 10;</p>
<p>short h = 3;</p>
<p>#pragma ghs endsda</p>
<p>For more information about</p>
<p>#pragma ghs section</p>
<p>, see âAssigning Data to</p>
<p>Custom Program Sections in Câ on page 84.</p>
<p><b>Linking Special Data Area Modules</b></p>
<p>Program source modules must agree about which variables are assigned to special</p>
<p>data areas. While using just a threshold value avoids this problem, you must pay</p>
<p>special attention to it when using</p>
<p>#pragma</p>
<p>directives to assign specific data. You</p>
<p>may want to put all special data area</p>
<p>#pragma</p>
<p>directives and variable declarations</p>
<p>into header files that are included by modules that use those variables.</p>
<p>In most cases, you can safely combine modules built with the SDA optimization</p>
<p>with non-SDA modules. Since the ZDA base register</p>
<p>r0</p>
<p>is always available for</p>
<p>ZDA, modules built with the ZDA optimization can also combine safely with</p>
<p>non-ZDA modules. However, problems may arise when one of these special data</p>
<p>area modules uses a global variable that is defined in a module that does not use</p>
<p>the same special data area. If the module attempts to use base offset addressing to</p>
<p>reference the variable, a link-time error can occur because the variable is not actually</p>
<p>in a special data area. To correct this problem, recompile the modules with consistent</p>
<p>use of special data areas.</p>
<p>Green Hills libraries are built with the SDA base register reserved. This allows both</p>
<p>SDA and non-SDA modules to use the same libraries.</p>
<p><i>103</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Special Data Area Optimizations</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>If a variable is assigned to SDA but is out of range of the SDA base</p>
<p>register, but is within range of the ROM SDA base register (if ROM SDA</p>
<p>is enabled) or is within the ZDA region, references to this variable may</p>
<p>be adjusted by the linker to use the ROM SDA or ZDA base register as</p>
<p>appropriate. Likewise if a variable is assigned to ROM SDA but is out</p>
<p>of range of the ROM SDA base register, its references may be adjusted</p>
<p>by the linker to be relative to the SDA or ZDA base registers. This</p>
<p>behavior can be disabled with the<b> -no_xda_modifications</b> linker option.</p>
<p>However, this behavior is necessary to link some C++ programs without</p>
<p>generating a linker error error.</p>
<p>Predefined Linker Symbols for Initializing the SDA Base Registers</p>
<p>User startup code (<b>crt0.o</b>, see âStartup Module crt0.oâ on page 865) can reference</p>
<p>the special C symbols</p>
<p>_tp</p>
<p>and</p>
<p>_gp</p>
<p>for setting the appropriate initial values of the</p>
<p>tp</p>
<p>and</p>
<p>gp</p>
<p>registers respectively. These symbols are defined in<b> v800_ghs.h</b>, and</p>
<p>are set at link time.</p>
<p>Linker Errors Related to Special Data Areas</p>
<p>The amount of data assigned to a special data area cannot exceed the size of that</p>
<p>data area. If data overflows, the linker issues an error. For SDA, the message begins</p>
<p>with:</p>
<p>[elxr] (error) out of range:<i> offset</i> (signed) didn't fit in<i> n</i> bits</p>
<p>ZDA provides a similar error message.</p>
<p>If you want to eliminate these errors by increasing the size of the special data areas,</p>
<p>see â8 MB Special Data Areas on the V850E2V3â on page 105. Another possible</p>
<p>cause of these link errors is inconsistent use of the</p>
<p>#pragma</p>
<p>directives between</p>
<p>modules. See âAssigning Specific Data To Special Data Areas in Câ on page 99</p>
<p>for information about these directives.</p>
<p>In certain cases, the assembler is able to determine that the offset does not fit into</p>
<p>16 bits, and it prints a</p>
<p>value too large for word sized cast</p>
<p>error. This</p>
<p>error is likely an indicator that too much data has been allocated to the ZDA section.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>104</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Use the methods described in the previous sections to ensure that the end of the</p>
<p>ZDA section is no more than 32 KB from address zero.</p>
<p>In the event that a module compiled with TDA disabled is linked with a module</p>
<p>that uses TDA, the linker will give one of the following errors as appropriate:</p>
<p>Module<i> FILENAME</i> was compiled with TDA disabled but we are</p>
<p>linking in MTDA mode</p>
<p>Attempt to link module (<i>FILENAME</i>) compiled with -notda</p>
<p>against a module (<i>FILENAME</i>) that uses the TDA</p>
<p><b>8 MB Special Data Areas on the V850E2V3</b></p>
<p>On the V850E2V3 and later CPU variants, the Green Hills tools support larger</p>
<p>special data areas containing 8 MB of data. To use this larger data area for SDA:</p>
<p>Set the<b> TargetâText and Data Placementâ23-bit SDA (V850E2V3 and later)</b></p>
<p>to<b> On</b> (<b>-large_sda</b>). When you enable this option, the SDA can be accessed using</p>
<p>6-byte load and store instructions with a 23-bit offset from the SDA base register.</p>
<p>To use this larger data area for ZDA:</p>
<p>Set the<b> TargetâText and Data Placementâ23-bit ZDA (V850E2V3 and later)</b></p>
<p>to<b> On</b> (<b>-large_sda</b>). When you enable this option, the ZDA can be accessed using</p>
<p>6-byte load and store instructions with a 23-bit offset from the ZDA base register.</p>
<p>If you enable either of these options, we recommend that you also:</p>
<p>Set the<b> TargetâText and Data PlacementâLinker-Based SDA23/ZDA23</b></p>
<p><b>Shortening (V850E2V3 and later)</b> option to<b> On</b> (<b>-shorten_loads</b>). This option</p>
<p>converts 6-byte load and store instructions to 4-byte instructions when possible.</p>
<p>When you enable this option in conjunction with either of the previous options,</p>
<p>you can benefit from a larger SDA without dramatically increasing code size.</p>
<p><i>105</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Special Data Area Optimizations</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Specifying Additional Registers for Special Data Areas</b></p>
<p>Normally, in accordance with the V850 and RH850 EABI, the compiler reserves</p>
<p>registers</p>
<p>r4</p>
<p>and</p>
<p>r5</p>
<p>as SDA base pointers. To specify additional registers (</p>
<p>r20</p>
<p>through</p>
<p>r24</p>
<p>) to be used as SDA and ROM SDA base pointers:</p>
<p>Enter the number of additional base registers in the<b> AdvancedâTarget</b></p>
<p><b>OptionsâAdditional SDA Base Registers</b> (<b>-additional_sda_reg=<i>n</b></i>) option,</p>
<p>where<i> n</i> is an integer between</p>
<p>1</p>
<p>and</p>
<p>5</p>
<p>.</p>
<p>Registers are reserved sequentially starting with</p>
<p>r20</p>
<p>. Each additional register</p>
<p>permits addressing 65,536 more bytes of data in a particular SDA section. The</p>
<p>registers are used as base pointers to data that does not fit in the first 65,536 bytes</p>
<p>of the SDA and ROM SDA regions. This option affects the compiler and linker,</p>
<p>and must be passed to both.</p>
<p>This option has the following limitations:</p>
<p>â¢</p>
<p>Using this option to reserve additional SDA base pointers makes them</p>
<p>unavailable for normal use by the compiler, and may increase code size and/or</p>
<p>degrade code speed.</p>
<p>â¢</p>
<p>This option cannot be used in combination with:</p>
<p>â</p>
<p>the<b> TargetâText and Data PlacementâGlobal Registers</b></p>
<p>(<b>-globalreg=<i>n</b></i>) option (see âStoring Global Variables in Registersâ</p>
<p>on page 92)</p>
<p>â</p>
<p>the<b> TargetâText and Data PlacementâPosition Independent Data</b></p>
<p>(<b>-pid</b>) option (see âPosition Independent Data (PID)â on page 119)</p>
<p>â</p>
<p>the<b> TargetâRegister Mode</b> (<b>-registermode=22</b> or<b> -registermode=26</b>)</p>
<p>option (see âRegister Usageâ on page 33)</p>
<p>â¢</p>
<p>All modules must be compiled with the same number of additional SDA base</p>
<p>registers or with<b> -additional_sda_common</b> (see âAdditional SDA Base</p>
<p>Registers (common)â on page 271.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>106</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>V850 Tiny Data Area (TDA) Optimization</b></p>
<p>The V850 processor provides on-chip SRAM for quick data access. The processor</p>
<p>also has special short load and short store instructions to access data in the SRAM.</p>
<p>The Tiny Data Area (TDA) optimization, similar to the Small Data Area (SDA)</p>
<p>and Zero Data Area (ZDA) optimizations, reserves a register to point into the SRAM</p>
<p>area. Certain variables and data structures can then be accessed as offsets from this</p>
<p>TDA base register using the short load and short store instructions.</p>
<p>Like SDA and ZDA, TDA is strictly an optimization technique and does not change</p>
<p>the basic function of the program. It produces code that is both smaller and faster</p>
<p>than code that accesses variables and data structures using 32-bit addresses.</p>
<p><b>TDA Implementation and Limitations</b></p>
<p>To implement TDA, the compiler, assembler, and linker define a special program</p>
<p>data section,</p>
<p>.tdata</p>
<p>. Both initialized data and uninitialized (zero) data, accessible</p>
<p>via TDA, are put into</p>
<p>.tdata</p>
<p>.</p>
<p>Due to the limitations on the offset-based addressing for accessing TDA variables,</p>
<p>the size of the TDA is limited to a total of 128 bytes (for byte access) or 256 bytes</p>
<p>(for half word and word access), even though the entire on-chip SRAM area may</p>
<p>be much larger. Because most programs have data segments that are much larger</p>
<p>than this, only a few variables can go into the TDA. The programmer decides which</p>
<p>variables are placed into the TDA. The Green Hills V850 compiler provides</p>
<p>variable-by-variable control over the use of the TDA through a mechanism based</p>
<p>on the</p>
<p>#pragma</p>
<p>statement.</p>
<p><b>Pragma Directives</b></p>
<p>Two</p>
<p>#pragma</p>
<p>directives control the selection of variables for the TDA. The directive</p>
<p>#pragma ghs starttda</p>
<p>causes the compiler to place all following variables in</p>
<p>the Tiny Data Area. The directive</p>
<p>#pragma ghs endtda</p>
<p>disables this mode. The</p>
<p>result is that variables defined or declared between these two</p>
<p>#pragma</p>
<p>directives</p>
<p>are placed into the TDA.</p>
<p><i>107</i></p>
<p><i>Green Hills Software</i></p>
<p><i>V850 Tiny Data Area (TDA) Optimization</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The compiler generates shortened addressing for variables that will be placed into</p>
<p>the Tiny Data Area. At the same time, those variables are placed into a special TDA</p>
<p>section,</p>
<p>.tdata</p>
<p>, rather than the regular</p>
<p>.data</p>
<p>and</p>
<p>.bss</p>
<p>sections.</p>
<p>The program source modules must agree about which variables are going into the</p>
<p>TDA. If module</p>
<p>A</p>
<p>accesses a variable defined in module</p>
<p>B</p>
<p>as though it is in the</p>
<p>TDA, but module</p>
<p>B</p>
<p>is not actually placing it into the TDA, this causes a link-time</p>
<p>error. (For more information, see âLinker Errorsâ on page 109.)</p>
<p>The user must make sure this agreement exists. One useful approach is to put all</p>
<p>#pragma</p>
<p>directives for TDA control into header files that are included by all</p>
<p>modules referring to those variables.</p>
<p>If a variable is declared</p>
<p>extern</p>
<p>between the TDA</p>
<p>#pragma</p>
<p>directives and later in</p>
<p>the same module as a global variable without</p>
<p>#pragma</p>
<p>directives, it still goes into</p>
<p>the TDA. Any declaration of the variable between the TDA</p>
<p>#pragma</p>
<p>directives is</p>
<p>sufficient to cause it to be put into the TDA.</p>
<p>The linker includes the</p>
<p>.tdata</p>
<p>section as needed for proper use of TDA. Also, a</p>
<p>special global symbol,</p>
<p>__ep</p>
<p>(note that there are two leading underscore characters</p>
<p>â</p>
<p>_</p>
<p>â), is added to the user program by the linker. The user program's startup code</p>
<p>uses this symbol to initialize the TDA base register.</p>
<p><b>Base Register</b></p>
<p>The Green Hills V850 compiler uses the</p>
<p>ep</p>
<p>register (</p>
<p>r30</p>
<p>) as the TDA base register.</p>
<p>The offset-based addressing on the V850 processor is unsigned. Thus, the TDA</p>
<p>base register is pointed to the start of the Tiny Data Area, providing an addressable</p>
<p>range for the following:</p>
<p>â¢</p>
<p>128 bytes for signed byte (8-bit) access</p>
<p>â¢</p>
<p>256 bytes for signed half-word (16-bit)access</p>
<p>â¢</p>
<p>256 bytes for all word (32-bit) access</p>
<p>â¢</p>
<p>32 bytes for unsigned half-word (16-bit) access</p>
<p>â¢</p>
<p>16 bytes for unsigned byte (8-bit) access</p>
<p>There are only two unsigned accesses available for the V850E architecture and</p>
<p>newer.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>108</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>User startup code (<b>crt0.o</b>, see âStartup Module crt0.oâ on page 865) can reference</p>
<p>the special C symbol</p>
<p>_ep</p>
<p>for setting the appropriate initial value of the</p>
<p>ep</p>
<p>register.</p>
<p>This symbol is defined in<b> v800_ghs.h</b>, and is set at link time.</p>
<p><b>Linker Errors</b></p>
<p>Since the TDA size limitation applies to the program as a whole, the linker checks</p>
<p>that the size does not exceed 256 bytes. For each reference to a TDA variable, the</p>
<p>linker calculates the offset from the TDA base register in the addressing instruction.</p>
<p>If this offset exceeds the limit allowed for this instruction, the linker prints the</p>
<p>following error message:</p>
<p>tiny data area overflow:<i> offset</i> didn't fit in<i> width</i> bits</p>
<p>while performing relocation in file<i> filename</i></p>
<p>at location<i> location</i>, to reference symbol<i> symbol_name</i></p>
<p>The<i> symbol_name</i> is the name of the variable causing the offset to be too large;</p>
<p><i>offset</i> is its location in the</p>
<p>.tdata</p>
<p>section. The<i> filename</i> and<i> location</i> show where</p>
<p>the illegal reference occurred.</p>
<p>This error occurs when too much data is requested to be placed into the TDA. To</p>
<p>correct the error, decrease the number of variables that go into the TDA.</p>
<p>Another reason for this link error is inconsistent use of the</p>
<p>#pragma</p>
<p>directives</p>
<p>between modules.</p>
<p><b>Combining TDA Modules with Other Modules</b></p>
<p>Because the TDA base register</p>
<p>ep (r30)</p>
<p>is always reserved for TDA, modules</p>
<p>built with the Tiny Data Area optimization can be combined safely with modules</p>
<p>that do not use TDA. However, modules compiled with<b> -notda</b>, cannot be safely</p>
<p>combined with modules that make use of TDA. Because the V850 and RH850</p>
<p>libraries do not use TDA, they can be safely combined with any module, regardless</p>
<p>if<b> -notda</b> is used. For more information, see âText and Data Placementâ on page 136.</p>
<p><b>Note</b></p>
<p>The TDA base register is only reserved when TDA is enabled in the</p>
<p>compiler, which is not the default behavior. Modules compiled with the</p>
<p>TDA disabled (<b>-notda</b>, the default) cannot be combined with modules</p>
<p><i>109</i></p>
<p><i>Green Hills Software</i></p>
<p><i>V850 Tiny Data Area (TDA) Optimization</i></p>
<h1 style="page-break-before:always; "></h1>
<p>that use the TDA. Attempting to do so will result in an error from the</p>
<p>linker. To use the TDA, all modules must be compiled with TDA enabled.</p>
<p>See<b> V850 Tiny Data Area</b> in âText and Data Placementâ on page 136</p>
<p>for more information about<b> -mtda</b> and<b> -single_tda</b>. The Green Hills</p>
<p>Libraries are compiled with the TDA enabled. Consequently, the libraries</p>
<p>can be safely used with both applications using the TDA and with</p>
<p>applications that disable use of the TDA.</p>
<p>A problem can occur if one module defining a variable is not compiled with TDA,</p>
<p>while another module using that variable is compiled with TDA. The second module</p>
<p>may attempt to use TDA addressing to reference the variable, but the variable will</p>
<p>not actually be in the Tiny Data Area, which may produce a link-time error (see</p>
<p>âLinker Errorsâ on page 109). To correct this problem, recompile the modules with</p>
<p>consistent usage of the TDA optimization.</p>
<p><b>Multiple TDA</b></p>
<p>The Multiple TDA optimization makes it possible to have multiple TDA sections,</p>
<p>thereby increasing the usage of short load and short store instructions. This results</p>
<p>in smaller code.</p>
<p>To use the Multiple TDA optimization:</p>
<p>Set the<b> TargetâText and Data PlacementâV850 Tiny Data Area</b> to<b> Multiple</b></p>
<p><b>TDAs</b> (<b>-mtda</b>).</p>
<p>Function Categories</p>
<p>The</p>
<p>#pragma</p>
<p>directives provide multiple TDA optimization by supporting separate</p>
<p>Tiny Data Area sections on a function-by-function basis. Every function falls into</p>
<p>one of three categories:</p>
<p>â¢</p>
<p><i>no-TDA</i> â Functions that do not use the TDA and do not call any function</p>
<p>that use the TDA. A<i> no-TDA</i> function can call an<i> export-TDA</i> function, but not</p>
<p>a<i> named-TDA</i> function.</p>
<p>â¢</p>
<p><i>named-TDA</i> â Functions that use a particular Tiny Data Area section.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>110</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><i>export-TDA</i> â Functions that use a particular Tiny Data Area section and have</p>
<p>prologue code that saves the TDA base register</p>
<p>ep</p>
<p>(</p>
<p>r30</p>
<p>). These functions load</p>
<p>the base register with the virtual starting address of the particular Tiny Data</p>
<p>Area section. Epilogue code restores the base register before the<i> export-TDA</i></p>
<p>functions return.</p>
<p>Multiple TDA Pragma Directives</p>
<p>The Multiple TDA</p>
<p>#pragma</p>
<p>directives support separate Tiny Data Area sections</p>
<p>on a function-by-function basis.</p>
<p>For<i> no-TDA</i> functions,pragma directives are not necessary:</p>
<p>int foo(int i)</p>
<p>{</p>
<p>return i+1;</p>
<p>}</p>
<p>For<i> named-TDA</i> functions, use</p>
<p>#pragma ghs function tdata=&quot;<i>sectname</i>&quot;</p>
<p>where<i> sectname</i> is the name of the particular named Tiny Data Area section, which</p>
<p>by convention begins with a period (â.â).</p>
<p><b>Example 2.12. Using Named-TDA Functions</b></p>
<p>#pragma ghs function tdata=&quot;.tdataA&quot;</p>
<p>int named_tda_fooA(int i)</p>
<p>{</p>
<p>return i+2;</p>
<p>}</p>
<p>int named_tda_fooB(int i)</p>
<p>{</p>
<p>return i+3;</p>
<p>}</p>
<p>#pragma ghs function</p>
<p>After the</p>
<p>#pragma ghs function</p>
<p>directive, all functions become<i> no-TDA</i> again,</p>
<p>until the next</p>
<p>#pragma ghs function tdata=</p>
<p>directive.</p>
<p><i>111</i></p>
<p><i>Green Hills Software</i></p>
<p><i>V850 Tiny Data Area (TDA) Optimization</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For<i> export-TDA</i> functions, use</p>
<p>#pragma ghs function exporttda tdata=&quot;<i>sectname</i>&quot;</p>
<p>where<i> sectname</i> is the name of the particular named Tiny Data Area section, which</p>
<p>by convention begins with a period (â.â).</p>
<p><b>Example 2.13. Using Export-TDA Functions</b></p>
<p>#pragma ghs function exporttda tdata=&quot;.tdataB&quot;</p>
<p>int export_tda_fooA(int i)</p>
<p>{</p>
<p>return i+4;</p>
<p>}</p>
<p>int export_tda_fooB(int i)</p>
<p>{</p>
<p>return i+5;</p>
<p>}</p>
<p>#pragma ghs function</p>
<p>Multiple TDA Variables Pragma Directives</p>
<p>#pragma ghs section tdata=&quot;.tdataA&quot;</p>
<p>#pragma ghs starttda</p>
<p>int myvar=1;</p>
<p>#pragma ghs endtda</p>
<p>#pragma ghs function exporttda tdata=&quot;.tdataA&quot;</p>
<p>int foo(int i)</p>
<p>{</p>
<p>return i+myvar;</p>
<p>}</p>
<p>Multiple TDA Calling Convention</p>
<p>Because all tiny data variable accesses occur through the same base register,</p>
<p>ep</p>
<p>(</p>
<p>r30</p>
<p>), a calling convention ensures that all function calls are legal.</p>
<p>Legal function calls include:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>112</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>A<i> named-TDA</i> function calling another<i> named-TDA</i> function with the same</p>
<p>named section</p>
<p>â¢</p>
<p>A<i> named-TDA</i> function calling any<i> export-TDA</i> function</p>
<p>â¢</p>
<p>A<i> named-TDA</i> function calling any<i> no-TDA</i> function</p>
<p>â¢</p>
<p>An<i> export-TDA</i> function calling a<i> named-TDA</i> function with the same named</p>
<p>section</p>
<p>â¢</p>
<p>An<i> export-TDA</i> function calling any<i> export-TDA</i> function</p>
<p>â¢</p>
<p>An<i> export-TDA</i> function calling any<i> no-TDA</i> function</p>
<p>â¢</p>
<p>A<i> no-TDA</i> function calling any<i> export-TDA</i> function</p>
<p>â¢</p>
<p>A<i> no-TDA</i> function calling any<i> no-TDA</i> function</p>
<p>Illegal function calls include:</p>
<p>â¢</p>
<p>A<i> named-TDA</i> function calling a<i> named-TDA</i> function with a different named</p>
<p>section</p>
<p>â¢</p>
<p>An<i> export-TDA</i> function calling a<i> named-TDA</i> function with a different named</p>
<p>section</p>
<p>â¢</p>
<p>A<i> no-TDA</i> function calling any<i> named-TDA</i> function</p>
<p>Multiple TDA Special Symbols</p>
<p>To enforce the Multiple TDA calling convention, the Green Hills V850 compiler</p>
<p>defines a special symbol for each function and a special symbol reference for each</p>
<p>function call. This information is passed to the linker, which checks the legality of</p>
<p>the calls.</p>
<p>For every<i> named-TDA</i> function, the compiler defines the following symbol</p>
<p>..lxtda.<i>functionname</i>.<i>tdaname</i></p>
<p>where<i> functionname</i> is the function and<i> tdaname</i> is the particular Tiny Data Area</p>
<p>section the function uses. The special symbol indicates the function can only be</p>
<p>called by a<i> named-TDA</i> function of the same Tiny Data Area section, or an</p>
<p><i>export-TDA</i> function of the same Tiny Data Area section.</p>
<p><i>113</i></p>
<p><i>Green Hills Software</i></p>
<p><i>V850 Tiny Data Area (TDA) Optimization</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 2.14. Using Multiple TDA Special Symbols</b></p>
<p>Given the following function:</p>
<p>#pragma ghs function tdata=&quot;.tdataA&quot;</p>
<p>int named_tda_fooA(int i)</p>
<p>{</p>
<p>return i+2;</p>
<p>}</p>
<p>the compiler will place the following special symbol definition in the assembly file:</p>
<p>..lxtda._named_tda_fooA..tdata1=:0</p>
<p>For every<i> export-TDA</i> and<i> no-TDA</i> function, the compiler defines the symbol</p>
<p>..lxtdaG.<i>functionname</i></p>
<p>where<i> functionname</i> is the callee.</p>
<p><b>Example 2.15. Using Export-TDA and No-TDA Functions</b></p>
<p>Given the following functions:</p>
<p>#pragma ghs function exporttda tdata=&quot;.tdataB&quot;</p>
<p>int export_tda_fooA(int i)</p>
<p>{</p>
<p>return i+4;</p>
<p>}</p>
<p>#pragma ghs function</p>
<p>int blot(void)</p>
<p>{</p>
<p>return 1;</p>
<p>}</p>
<p>the compiler will define the following special symbols:</p>
<p><b>Corresponding Function</b></p>
<p><b>Symbol</b></p>
<p>export_tda_fooA()</p>
<p>..lxtdaG._export_tda_fooA</p>
<p>blot()</p>
<p>..lxtdaG._blot</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>114</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For each function call within every<i> named-TDA</i> and<i> export-TDA</i> function, the</p>
<p>compiler generates a reference to the special symbol</p>
<p>..lxtda.<i>functionname</i>.<i>tdaname</i></p>
<p>where<i> functionname</i> is the callee and<i> tdaname</i> is the TDA name of the caller.</p>
<p><b>Example 2.16. Using Named-TDA and Export-TDA Functions</b></p>
<p>Given the following function:</p>
<p>#pragma ghs function tdata=&quot;.tdataA&quot;</p>
<p>int named_tda_fooA(int i)</p>
<p>{</p>
<p>return bar(i+1);</p>
<p>}</p>
<p>the compiler will place the following special symbol definition in the assembly file:</p>
<p>..tmp==..lxtda._bar..tdataA</p>
<p>For each function call within every<i> no-TDA</i> function, the compiler generates a</p>
<p>reference to the special symbol</p>
<p>..lxtdaG.<i>functionname</i></p>
<p>where<i> functionname</i> is the callee.</p>
<p><b>Example 2.17. Using No-TDA Functions</b></p>
<p>Given the following function:</p>
<p>#pragma ghs function</p>
<p>int bel(int i)</p>
<p>{</p>
<p>return canto(i+1);</p>
<p>}</p>
<p>the compiler will place the following special symbol definition in the assembly file:</p>
<p>..tmp==..lxtdaG._canto</p>
<p><i>115</i></p>
<p><i>Green Hills Software</i></p>
<p><i>V850 Tiny Data Area (TDA) Optimization</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Multiple TDA Linker Errors</p>
<p>If a<i> no-TDA</i> function calls a<i> named-TDA</i> function, the linker prints the following</p>
<p>error message:</p>
<p>Function '<i>functionname</i>' called from a no-TDA function in '<i>filename</i>.o'</p>
<p>where<i> functionname</i> is the name of the<i> named-TDA</i> function called, and<i> filename</i></p>
<p>is the file in which this illegal call was made.</p>
<p>If a<i> named-TDA</i> or an<i> export-TDA</i> function calls a function that is in a different</p>
<p>name Tiny section, the linker prints the following error message:</p>
<p>Cross-TDA call to function '<i>functionname</i>' from TDA '<i>tdaname</i>' in '<i>filename</i>.o'</p>
<p>where<i> functionname</i> is the<i> named-TDA</i> function called,<i> tdaname</i> is the Tiny Data</p>
<p>Area section of the caller, and<i> filename</i> is the file in which the illegal call was made.</p>
<p>Multiple TDA Assembly Language Programming</p>
<p>The Multiple TDA calling convention must be followed for hand-coded assembly</p>
<p>functions and function calls.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>116</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Position Independent Code (PIC)</b></p>
<p>Position independent code (PIC) is code that can be run at an address that was not</p>
<p>known at the time the code was linked. You can use PIC to create executable files</p>
<p>that can be placed anywhere in memory.</p>
<p>PIC involves the calculation of the address of any object in a</p>
<p>.text</p>
<p>section, typically</p>
<p>a function label. Addresses in C can appear as:</p>
<p>â¢</p>
<p>Local branches</p>
<p>â¢</p>
<p>Normal function calls</p>
<p>â¢</p>
<p>Far function calls</p>
<p>â¢</p>
<p>Switch statements</p>
<p>â¢</p>
<p>Function pointers</p>
<p>Instructions that implement local branches and normal function calls are relative</p>
<p>to the program counter and therefore are inherently position-independent. No</p>
<p>additional code is needed to achieve position independent code for these instructions.</p>
<p>To achieve position independent code for far function calls, switch statements, and</p>
<p>function pointers, the compiler must generate additional code.</p>
<p>To compile a program with position independent code:</p>
<p>Set the<b> TargetâText and Data PlacementâPosition Independent Code</b> option</p>
<p>to<b> On</b> (<b>-pic</b>).</p>
<p>When you enable PIC:</p>
<p>â¢</p>
<p>The linker suppresses errors that identify overlapping sections.</p>
<p>â¢</p>
<p>The</p>
<p>.rodata</p>
<p>section is used less often.</p>
<p><b>Note</b></p>
<p>The linker directive files provided by Green Hills to be used with PIC</p>
<p>will need to be modified to place the non-position-independent parts of</p>
<p>the program at suitable memory locations for your target hardware.</p>
<p><i>117</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Position Independent Code (PIC)</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Running a PIC Program with the Simulator</b></p>
<p>When running a PIC program on the simulator without the MULTI Debugger, you</p>
<p>should pass the<b> -text<i> offset</b></i> option in order to specify the PIC offset. For example,</p>
<p>to run the PIC program<b> myprog</b> on the simulator and to load the program code at</p>
<p>address</p>
<p>0x100000</p>
<p>, enter:</p>
<p>sim850 -text 0x100000 myprog</p>
<p><b>Debugging a PIC Program</b></p>
<p>When debugging a PIC program in the MULTI Debugger, you must specify the</p>
<p>PIC base address so that the Debugger can properly offset the addresses of code.</p>
<p>You can specify the PIC base address in two ways:</p>
<p>â¢</p>
<p>Use the<b> -text</b> option when starting the MULTI Debugger from the command</p>
<p>line. For example, to start debugging a PIC program<b> myprog</b> with the PIC base</p>
<p>address set to</p>
<p>0x100000</p>
<p>, enter:</p>
<p>multi -text 0x100000 myprog</p>
<p>â¢</p>
<p>Set the</p>
<p>_TEXT</p>
<p>variable while the Debugger is running. For example, suppose</p>
<p>you open a PIC program<b> myprog</b> in the Debugger and want to set the PIC base</p>
<p>address to</p>
<p>0x100000</p>
<p>. In the Debugger command pane, enter:</p>
<p>_TEXT=0x100000</p>
<p><b>Combining PIC with Other Modules</b></p>
<p>You can link modules that were compiled with PIC with modules that were not, as</p>
<p>long as the resulting program does not run as a PIC program. Any program that is</p>
<p>running as PIC must have all its source modules compiled with PIC.</p>
<p>To reduce the number of library variants, Green Hills libraries are built with PIC</p>
<p>enabled. Therefore, the same libraries can build both PIC and non-PIC executables.</p>
<p>PIC addressing calculations are made relative to the</p>
<p>PC</p>
<p>register.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>118</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Position Independent Data (PID)</b></p>
<p>If you enable<i> Position Independent Data</i> (PID), the executable file is built so that</p>
<p>the program's data can be located at any position in memory.</p>
<p>Because data accesses are not inherently position-independent, PID requires a base</p>
<p>register that is initialized by the operating system, monitor, or program loader to</p>
<p>pinpoint the location of the data segment in the memory. The environment must</p>
<p>also provide a properly PID-adjusted stack pointer. If not run on a simulator or</p>
<p>debug server with system call support enabled, this may require modifying the</p>
<p>default<b> crt0</b> startup code to adjust the stack pointer for PID offsets.</p>
<p>To compile a program with position independent data:</p>
<p>Set the<b> TargetâText and Data PlacementâPosition Independent Data</b> option</p>
<p>to<b> On</b> (<b>-pid</b>).</p>
<p>When you enable PID:</p>
<p>â¢</p>
<p>The linker suppresses errors that identify overlapping sections.</p>
<p>â¢</p>
<p>The</p>
<p>.rodata</p>
<p>section is not used.</p>
<p><b>Note</b></p>
<p>The linker directive files provided by Green Hills to be used with PID</p>
<p>will need to be modified to place the non-position-independent parts of</p>
<p>the program at suitable memory locations for your target hardware.</p>
<p><b>Running a PID Program with the Simulator</b></p>
<p>When running a PID program on the simulator without the MULTI Debugger, you</p>
<p>should pass the<b> -data<i> offset</b></i> option in order to specify the PID offset. For example,</p>
<p>to run the PID program<b> myprog</b> on the simulator and to load the program data at</p>
<p>address</p>
<p>0x200000</p>
<p>, enter:</p>
<p>sim850 -data 0x200000 myprog</p>
<p><i>119</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Position Independent Data (PID)</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Debugging a PID Program</b></p>
<p>When debugging a PID program in the MULTI Debugger, you must specify the</p>
<p>PID base address so that the Debugger can properly offset the addresses of data.</p>
<p>You can specify the PID base address in two ways:</p>
<p>â¢</p>
<p>Use the<b> -data</b> option when starting the Debugger from the command line. For</p>
<p>example, to start debugging a PID program<b> myprog</b> with the PID base address</p>
<p>set to</p>
<p>0x200000</p>
<p>, enter:</p>
<p>multi -data 0x200000 myprog</p>
<p>â¢</p>
<p>Set the</p>
<p>_DATA</p>
<p>variable while the Debugger is running. For example, to set the</p>
<p>PID base address to</p>
<p>0x200000</p>
<p>, enter the following in the Debugger command</p>
<p>pane:</p>
<p>_DATA=0x200000</p>
<p><b>Initializing the PID Base Register</b></p>
<p>The PID base register, by convention</p>
<p>r4</p>
<p>, must be initialized to a fixed offset from</p>
<p>the starting address of the data segment (in the case of SDA projects, the small data</p>
<p>area is used instead; see âSpecial Data Area Optimizationsâ on page 96). One way</p>
<p>of doing this is to have the loader, monitor, or operating system initialize the base</p>
<p>register when loading the program on the target. Alternatively, the program's startup</p>
<p>code can initialize the base register each time it runs. If the data segment of the</p>
<p>program is loaded into ROM and then copied from ROM to RAM at startup, be</p>
<p>sure that the base register is initialized properly by the operating system or startup</p>
<p>code.</p>
<p><b>Combining PID with Other Modules</b></p>
<p>You can link modules compiled with PID with modules that were not, as long as</p>
<p>the resulting program does not run as a PID program. You cannot run a mixed PID</p>
<p>and non-PID program in PID mode; to run a program in PID mode, you must compile</p>
<p>all its modules with PID.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>120</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>To reduce the number of library variants, Green Hills embedded system libraries</p>
<p>are built with PID enabled, so the same libraries can be used in both PID and</p>
<p>non-PID executables. For PID code to work correctly in a non-PID executable, the</p>
<p>PID base register must be initialized to the start of the data area. The Green Hills</p>
<p>run-time environment does this automatically.</p>
<p><b>Customizing the Green Hills Run-Time Environment</b></p>
<p>You can customize the Green Hills run-time environment to implement or enhance</p>
<p>the environment for a particular hardware system by:</p>
<p>â¢</p>
<p>Modifying the source code of the run-time object modules<b> libsys.a</b>,<b> libstartup.a</b>,</p>
<p>and<b> crt0.o</b>, and then rebuilding these object modules (see âCustomizing the</p>
<p>Run-Time Environment Libraries and Object Modulesâ on page 863). Each</p>
<p>source file, including files with only assembly language, is fully commented.</p>
<p>These source files are located in the<b> src/libsys</b> and<b> src/libstartup</b> directories</p>
<p>of your installation.</p>
<p>â¢</p>
<p>Modifying the linker directives file for special program sections that<b> libsys.a</b>,</p>
<p><b>libstartup.a</b>, and<b> crt0.o</b> use to set up the run-time environment (see</p>
<p>âCustomizing the Run-Time Environment Program Sectionsâ on page 499).</p>
<p><i>121</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Customizing the Green Hills Run-Time Environment</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Other Topics</b></p>
<p><b>Renaming the Output Executable</b></p>
<p>To change the name of the output file:</p>
<p>Enter the desired name in the<b> ProjectâOutput Filename</b> (<b>-o<i> name</b></i>) option.</p>
<p><b>Specifying an Alternate Program Start Address</b></p>
<p>The linker normally uses the address of the global symbol</p>
<p>_start</p>
<p>as the start</p>
<p>address for the user program. To specify an alternate start address:</p>
<p>Specify a new symbol in the<b> LinkerâStart Address Symbol</b> (<b>-e=<i>symbol_name</b></i>).</p>
<p>For example, to use the symbol</p>
<p>newstart</p>
<p>as the program start address, enter the</p>
<p>following from the command line:</p>
<p>ccv850 -e=newstart file.s</p>
<p>If the entry symbol is copied from ROM to RAM during program startup, the entry</p>
<p>point is in the ROM version of the entry symbol.</p>
<p><b>Interrupt Routines</b></p>
<p><b>Writing Interrupt Routines</b></p>
<p>In C and C++, if you want a function to handle hardware interrupts or exception</p>
<p>conditions, declare that function as an interrupt routine. When you declare a function</p>
<p>as an interrupt routine, the compiler generates code in the function prologue that</p>
<p>saves all the caller-save and callee-save registers it requires. If the interrupt routine</p>
<p>makes no function calls, this should be a minimal set of registers. Calling one or</p>
<p>more functions will cause the interrupt routine to save all general purpose registers.</p>
<p>The interrupt routine also generates code in the function epilogue that restores those</p>
<p>registers to the state they were in before the function was called.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>122</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>These functions should be of</p>
<p>void</p>
<p>type and should take no arguments.</p>
<p><b>Note</b></p>
<p>Interrupt functions on the V850 and RH850 use different calling</p>
<p>conventions than normal functions. Specifically:</p>
<p>â¢</p>
<p>Interrupt functions must return using the</p>
<p>reti</p>
<p>(for the V850E2 and</p>
<p>older architectures) or</p>
<p>eiret</p>
<p>(for the V850E2R and newer</p>
<p>architectures) instruction rather than the</p>
<p>jmp</p>
<p>instruction.</p>
<p>â¢</p>
<p>Normal functions are permitted to destroy the contents of all</p>
<p>temporary registers. Interrupt functions are not permitted to destroy</p>
<p>the contents of temporary registers.</p>
<p>You can use either of the following methods to declare a function as an interrupt</p>
<p>routine:</p>
<p>â¢</p>
<p>Place</p>
<p>#pragma ghs interrupt</p>
<p>immediately before the function.</p>
<p>â¢</p>
<p>Prepend the</p>
<p>__interrupt</p>
<p>keyword to the function definition.</p>
<p>Interrupts are already disabled when an interrupt routine is called, and are enabled</p>
<p>immediately when it returns. The compiler does not normally insert code to enable</p>
<p>interrupts; this is left to the implementation of the interrupt routine. To instruct the</p>
<p>compiler to insert code that enables interrupts early on in the interrupt function's</p>
<p>prologue, pass the</p>
<p>enabled</p>
<p>parameter to</p>
<p>#pragma ghs interrupt</p>
<p>using the</p>
<p>following syntax:</p>
<p>#pragma ghs interrupt(enabled)</p>
<p>The compiler assumes in most cases that user code in the interrupt routine enables</p>
<p>interrupts, even if you have not passed the</p>
<p>enabled</p>
<p>parameter. This means that</p>
<p>the compiler assumes interrupts can be interrupted (they are reentrant). If you know</p>
<p>that an interrupt routine cannot be interrupted, pass the</p>
<p>nonreentrant</p>
<p>parameter</p>
<p>to</p>
<p>#pragma ghs interrupt</p>
<p>using the following syntax:</p>
<p>#pragma ghs interrupt(nonreentrant)</p>
<p>This directive generally causes the compiler to create a smaller function prologue</p>
<p>and epilogue, resulting in a faster and smaller interrupt routine. Use this option only</p>
<p>when you use inline prologues and epilogues (see âFunction Prologuesâ on page 271).</p>
<p><i>123</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Interrupt Routines</i></p>
<h1 style="page-break-before:always; "></h1>
<p>On V850E2R and newer processors, the compiler will by default generate code for</p>
<p>an EI-level interrupt handled. To instead generate code for a FE-level interrupt</p>
<p>handler, pass the</p>
<p>FE</p>
<p>parameter to</p>
<p>#pragma ghs interrupt</p>
<p>using the following</p>
<p>syntax:</p>
<p>#pragma ghs interrupt(FE)</p>
<p><b>Establishing Interrupt Vectors with the intvect Pragma Directive</b></p>
<p>To establish an interrupt vector which is needed to call an interrupt routine in C and</p>
<p>C++, use:</p>
<p>#pragma intvect<i> function integer_constant</i></p>
<p>The compiler arranges for a jump to<i> function</i> to be placed in memory at the address</p>
<p>specified by<i> integer_constant</i> using a</p>
<p>.org</p>
<p>directive to the assembler. The named</p>
<p><i>function</i> must be a valid interrupt routine that returns</p>
<p>void</p>
<p>.</p>
<p>Thus, the following code fragment declares an interrupt routine,</p>
<p>foo</p>
<p>, with an</p>
<p>interrupt vector at address</p>
<p>0x60</p>
<p>, established by</p>
<p>#pragma intvect</p>
<p>:</p>
<p>__interrupt void foo(void);</p>
<p>#pragma intvect foo 0x60</p>
<p>__interrupt void foo()</p>
<p>{</p>
<p>...</p>
<p>}</p>
<p><b>Note</b></p>
<p>This feature is supported only when using a Green Hills assembler and</p>
<p>is not available in binary code generation mode. You must ensure that</p>
<p>the call destination is within range of the vector or unpredictable behavior</p>
<p>may result.</p>
<p><b>Symbolic Memory-Mapped I/O</b></p>
<p>Embedded systems may have memory locations reserved for I/O, with the registers</p>
<p>of a hardware device mapped in these locations. Several techniques access such</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>124</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p>memory-mapped I/O devices, but using specially named sections has some</p>
<p>advantages.</p>
<p>For memory-mapped I/O, the variables that correspond to the memory locations</p>
<p>should be kept in one or more sections that contain only memory-mapped locations.</p>
<p>These sections should not be initialized during program startup.</p>
<p>This approach creates a C language structure definition that matches the allocation</p>
<p>of the I/O registers in the memory space. Named structure fields are assigned to</p>
<p>correspond to the I/O registers. Next, the</p>
<p>#pragma</p>
<p>directive is used to define a</p>
<p>variable of the</p>
<p>struct</p>
<p>type within a named</p>
<p>.bss</p>
<p>section that holds only this</p>
<p>variable. A linker section map places this named section at the position in memory</p>
<p>of the I/O device. The I/O registers are now structure fields of the variable in the</p>
<p>named section.</p>
<p>Structures should be defined with the</p>
<p>volatile</p>
<p>qualifier, because the registers'</p>
<p>values can change without being modified explicitly by the program.</p>
<p>With this approach, the variable definition can be placed in a source file of its own.</p>
<p>This file is compiled to an object file that is shared among different projects that</p>
<p>need to refer to this I/O device. Each project needs the object file, an entry in the</p>
<p>section map to position the section, and a header file to define the</p>
<p>struct</p>
<p>type.</p>
<p>In addition, you can then display the named variable in a MULTI Debugger data</p>
<p>explorer to provide ongoing displays of the state of the I/O registers, and edit the</p>
<p>fields of the data explorer to cause writes to the I/O registers. This displays and</p>
<p>manipulates memory-mapped I/O registers by MULTI view windows, similar to</p>
<p>built-in registers.</p>
<p>For example, consider a simplified universal asynchronous receiver-transmitter</p>
<p>(â</p>
<p>UART</p>
<p>â) that has three 16-bit registers: an output register, an input register, and a</p>
<p>control/status register, mapped at locations</p>
<p>0x1000</p>
<p>,</p>
<p>0x1002</p>
<p>, and</p>
<p>0x1004</p>
<p>respectively. With code containing the following lines:</p>
<p>#pragma ghs section bss=&quot;.uartsec&quot;</p>
<p>struct {</p>
<p>short Tx;</p>
<p>/* Transmit Register</p>
<p>*/</p>
<p>short Rx;</p>
<p>/* Receive Register</p>
<p>*/</p>
<p>short CSR;</p>
<p>/* Control/ Status Register */</p>
<p>} volatile uart;</p>
<p>#pragma ghs section bss=default</p>
<p><i>125</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Symbolic Memory-Mapped I/O</i></p>
<h1 style="page-break-before:always; "></h1>
<p>and a section map entry in the linker directives file such as:</p>
<p>SECTIONS {</p>
<p>...</p>
<p>.uartsec 0x1000 :</p>
<p>...</p>
<p>}</p>
<p>Code can then refer to the registers as</p>
<p>uart.Tx</p>
<p>,</p>
<p>uart.Rx</p>
<p>, and</p>
<p>uart.CSR</p>
<p>.</p>
<p>Within MULTI, the command</p>
<p>view uart</p>
<p>views a window showing the contents</p>
<p>of the UART registers. Because MULTI must perform read operations to display</p>
<p>this data, this approach is not suitable for registers that are sensitive to read and</p>
<p>write operations (that is, registers for which accessing a register triggers an activity</p>
<p>or referencing a data location near the register causes problems).</p>
<p><b>Verifying Program Integrity</b></p>
<p>If you want to verify that sections in memory are identical to those created by the</p>
<p>linker, set the<b> LinkerâLink-Time CheckingâChecksum</b> option to<b> On</b></p>
<p>(<b>-checksum</b>). This option instructs the linker to calculate a Cyclic Redundancy</p>
<p>Check (CRC) checksum for each section that contains text or data and store it in</p>
<p>the section. To exclude a section from checksum creation, use the</p>
<p>NOCHECKSUM</p>
<p>attribute when defining that section in the section map.</p>
<p>When the<b> Checksum</b> option is enabled, the symbol</p>
<p>__ghs_checksum</p>
<p>is defined</p>
<p>by the linker to be the number of bytes at the end of each section reserved for the</p>
<p>checksum. It is currently 4 bytes.</p>
<p>To verify a section upon initialization, scan the</p>
<p>__secinfo</p>
<p>table, calculate the</p>
<p>same CRC on all but the last</p>
<p><i>__ghs_checksum</i></p>
<p>bytes of the section, and compare</p>
<p>the result to the stored CRC. A match indicates that the program has the same byte</p>
<p>values in memory that it had when the linker created the executable file. For more</p>
<p>information about performing checksums, see<i><b> install_dir</i>/src/libstartup/cksum.c</b>.</p>
<p>For more information about the</p>
<p>__secinfo</p>
<p>structure, see</p>
<p><i><b>install_dir</i>/src/libsys/indsecinfo.h</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>126</i></p>
<p><i>Chapter 2. Developing for V850 and RH850</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 3</b></p>
<p><b>Builder and Driver Options</b></p>
<p><b>Contents</b></p>
<p>Target</p>
<p>Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>129</p>
<p>Project Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>160</p>
<p>Optimization Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>165</p>
<p>Debugging Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>176</p>
<p>Preprocessor Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>182</p>
<p>C/C++ Compiler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>184</p>
<p>Assembler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>232</p>
<p>Linker Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>235</p>
<p>Compiler Diagnostics Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>253</p>
<p>DoubleCheck (C/C++) Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>263</p>
<p>GCores Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>265</p>
<p>Advanced Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>270</p>
<h1 style="page-break-before:always; "></h1>
<p>This chapter lists all of the Builder and driver options.</p>
<p>These options control various aspects of the compilation, assembly, and linking of</p>
<p>your project. The following information is listed for each option:</p>
<p>â¢</p>
<p>The name of the option as it appears in the<b> Build Options</b> window.</p>
<p>â¢</p>
<p>A description of the option.</p>
<p>â¢</p>
<p>Permitted option settings (if applicable).</p>
<p>â¢</p>
<p>The equivalent driver option and description (if any).</p>
<p>For information about setting build options in the Project Manager, see the</p>
<p>documentation about setting Builder options in the<i> MULTI: Managing Projects</i></p>
<p><i>and Configuring the IDE</i> book.</p>
<p>To pass options to the compiler driver, add them to your command line or makefile.</p>
<p>For more information about using the driver, see Chapter 1, âThe Compiler Driverâ</p>
<p>on page 3.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>128</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Target Options</b></p>
<p>This is a top-level option category.</p>
<p>These options allow you to control aspects of compilation relating to your target,</p>
<p>such as available memory models and forms of floating-point support, and to control</p>
<p>the instruction set to be used.</p>
<p>For additional, more specialized options, see âTarget Optionsâ on page 270.</p>
<p><b>Register Description File</b></p>
<p>Specifies a<b> .grd</b> file, which contains a description of the target board's registers,</p>
<p>and instructions on how MULTI may access them. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>--register_definition_file=<i>filename</i>.grd</b></p>
<p><b>Register r2</b></p>
<p>Controls the treatment of register</p>
<p>r2</p>
<p>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Reserve for User</b> (<b>-reserve_r2</b>) â Reserves this register for use by the user.</p>
<p>â¢</p>
<p><b>Permit Compiler Use</b> (<b>-noreserve_r2</b>) â [default] Permits the compiler to</p>
<p>use this register as a temporary register.</p>
<p><b>Register r5</b></p>
<p>Controls the treatment of register</p>
<p>r5</p>
<p>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Reserve for User</b> (<b>-reserve_r5</b>) â Reserves this register for use by the user.</p>
<p>This disables the use of ROM SDA; consequently, read-only data will not be</p>
<p>placed in an SDA section.</p>
<p>â¢</p>
<p><b>Permit Compiler Use</b> (<b>-noreserve_r5</b>) â [default] Permits the compiler to</p>
<p>use this register.</p>
<p><i>129</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Target Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>ROM SDA</b></p>
<p>Controls whether the ROM SDA (</p>
<p>ROSDA</p>
<p>) base register (</p>
<p>TP</p>
<p>, which is</p>
<p>R5</p>
<p>) is reserved</p>
<p>for use with ROM SDA or if it can be allocated to as a general purpose register, in</p>
<p>which case it will be treated as a temporary whose value does not need to be</p>
<p>preserved. Users wishing to disable ROM SDA but keep the</p>
<p>TP</p>
<p>register reserved</p>
<p>should look to the<b> -reserve_r5</b> option (See âRegister r5â on page 129). Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>Use ROM SDA base register (TP) as a temporary</b> (<b>-no_rosda</b>) â</p>
<p>â¢</p>
<p><b>Use the ROM SDA base register for ROM SDA</b> (<b>-rosda</b>) â</p>
<p><b>Register Mode</b></p>
<p>Controls the number of registers that will be used by the compiler. You may want</p>
<p>to restrict this number in order to guarantee the availability of particular registers</p>
<p>for hand-written assembly. For more information, see âRegister Usageâ on page 33.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Restrict to 22 Registers</b> (<b>-registermode=22</b>)</p>
<p>â¢</p>
<p><b>Restrict to 26 Registers</b> (<b>-registermode=26</b>)</p>
<p>â¢</p>
<p><b>Standard 32 Registers</b> (<b>-registermode=32</b>) â [default]</p>
<p><b>Set Register r20 to the Value 255</b></p>
<p>Controls an optimization in which register</p>
<p>r20</p>
<p>is set to the value 255 at startup,</p>
<p>and is subsequently treated as read-only. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-r20has255</b>) â Register</p>
<p>r20</p>
<p>is set to the value 255.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nor20has255</b>) â [default] Register</p>
<p>r20</p>
<p>is available for general use.</p>
<p>When this optimization is enabled, the compiler may generate smaller code by</p>
<p>accessing</p>
<p>r20</p>
<p>. For example, the 4-byte instruction:</p>
<p>andi 255, r3, r3</p>
<p>is replaced with the 2-byte instruction:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>130</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>and r20, r3</p>
<p><b>Set Register r21 to the Value 65535</b></p>
<p>Controls an optimization in which register</p>
<p>r21</p>
<p>is set to the value 65535 at startup,</p>
<p>and is subsequently treated as read-only. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-r21has65535</b>) â Register</p>
<p>r21</p>
<p>is set to the value 65535.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nor21has65535</b>) â [default] Register</p>
<p>r21</p>
<p>is available for general use</p>
<p>When this optimization is enabled, the compiler may generate smaller code by</p>
<p>accessing</p>
<p>r21</p>
<p>. For example, the 4-byte instruction:</p>
<p>andi 65535, r3, r3</p>
<p>is replaced with the 2-byte instruction:</p>
<p>and r21, r3</p>
<p>This option implies<b> Set Register r20 to the value 255</b> (see above).</p>
<p><b>Data Bus Width</b></p>
<p>Specifies the data-bus width of the target hardware. Any bits in a target address</p>
<p>above the bus width are assumed to be masked off during a data access. This option</p>
<p>is passed to</p>
<p>elxr</p>
<p>to resolve section mappings. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>24-bit data bus</b> (<b>-data_bus_width=24</b>)</p>
<p>â¢</p>
<p><b>26-bit data bus</b> (<b>-data_bus_width=26</b>)</p>
<p>â¢</p>
<p><b>29-bit data bus</b> (<b>-data_bus_width=29</b>)</p>
<p>â¢</p>
<p><b>32-bit data bus</b> (<b>-data_bus_width=32</b>) â [default]</p>
<p>For example:</p>
<p>If your target hardware has a 29-bit data bus width, a section placed at address</p>
<p>0xFFFF0000</p>
<p>in the link map is viewed by</p>
<p>elxr</p>
<p>to actually be at</p>
<p>0x1fff0000</p>
<p>.</p>
<p>This is useful when using the ZDA capability of the V850 and RH850 compiler on</p>
<p>targets with a small data bus because it still allows data sections to be placed within</p>
<p><i>131</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Set Register r21 to the Value 65535</i></p>
<h1 style="page-break-before:always; "></h1>
<p>a small negative offset from zero, which is suitable for use with ZDA. Otherwise,</p>
<p>elxr</p>
<p>might complain that this section does not fit within the specified address</p>
<p>memory region for the target.</p>
<p><b>Note:</b> If<b> -data_bus_width=29</b> is specified,</p>
<p>elxr</p>
<p>first tries the address</p>
<p>0xffff0000</p>
<p>as usual, and then tries the 29-bit wide value (</p>
<p>0x1fff0000</p>
<p>).</p>
<p><b>Floating-Point</b></p>
<p>This option category is contained within<b> Target</b>.</p>
<p><b>Floating-Point Mode</b></p>
<p>Specifies how to perform floating-point calculations. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>No Floating-Point</b> (<b>-fnone</b>) â Disallows all floating-point operations (and</p>
<p>directs the C and C++ compilers to give an error for any use of floating-point</p>
<p>variables or constants), thus greatly reducing the size of such library functions</p>
<p>as</p>
<p>printf</p>
<p>and</p>
<p>scanf</p>
<p>. Passes</p>
<p>-D__NoFloat__</p>
<p>to allow source code and</p>
<p>header files to hide references to floating-point objects. If your code uses</p>
<p>floating-point operations, then an error will be generated. For more information,</p>
<p>see âPredefined Macro Namesâ on page 780.</p>
<p>Because code related to floating-point operations may be linked in to your</p>
<p>program even if it does not use floating-point variables, using this option may</p>
<p>reduce the size of your program.</p>
<p>Because this setting requires support from the system libraries and header files,</p>
<p>it is not supported for environments using embedded operating systems with</p>
<p>their own C or C++ headers and libraries. In addition, certain target-specific</p>
<p>header files may require the use of floating-point types.</p>
<p>This option implies<b> -no_float_scanf</b>.</p>
<p>â¢</p>
<p><b>Hardware Coprocessor</b> (<b>-fhard</b>) â Specifies<i> hardware floating-point</i> (HFP)</p>
<p>mode, in which the compiler uses floating-point registers (where available) to</p>
<p>hold floating point data, and floating point instructions to do floating point</p>
<p>operations.</p>
<p>This is the default for targets that have a built-in FPU, and is not</p>
<p>available for other targets.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>132</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Hardware Single, Software Double</b> (<b>-fsingle</b>) â Instructs the compiler to</p>
<p>generate floating-point instructions to perform single-precision floating-point</p>
<p>operations, and to generate library subroutine calls to emulate double-precision</p>
<p>floating-point operations.</p>
<p>â¢</p>
<p><b>Software Emulation</b> (<b>-fsoft</b>) â Specifies<i> software floating-point</i> (SFP) mode,</p>
<p>in which the compiler uses integer registers to hold floating-point data and</p>
<p>generates library subroutine calls to emulate floating-point operations, regardless</p>
<p>of the capabilities of the selected processor.</p>
<p><b>Treat Doubles as Singles</b></p>
<p>Controls the treatment of</p>
<p>double</p>
<p>and</p>
<p>long double</p>
<p>types. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-floatsingle</b>) â Defines the types</p>
<p>double</p>
<p>and</p>
<p>long double</p>
<p>to have the</p>
<p>same size and precision as</p>
<p>float</p>
<p>. Programs may be faster and smaller, but</p>
<p>with significantly less precision. This option is only supported on the RH850</p>
<p>processors and requires<b> -fsingle</b> or<b> -fhard</b>.</p>
<p>See also<b> -Wdouble</b> and<b> -fnodouble</b> which give warnings or errors for any use</p>
<p>of the</p>
<p>double</p>
<p>or</p>
<p>long double</p>
<p>data types, and<b> -fsingle</b> which uses hardware</p>
<p>floating point instructions for type</p>
<p>float</p>
<p>, but software floating point for types</p>
<p>double</p>
<p>and</p>
<p>long double</p>
<p>without reducing the precision of</p>
<p>double</p>
<p>and</p>
<p>long double</p>
<p>.</p>
<p><b>Note</b></p>
<p>The ANSI/ISO standard for C allows the range of the types</p>
<p>double</p>
<p>and</p>
<p>long double</p>
<p>to be reduced to that of</p>
<p>float</p>
<p>, but it does not</p>
<p>allow the precision of</p>
<p>double</p>
<p>and</p>
<p>long double</p>
<p>to be as low as</p>
<p>the precision provided in this mode. Therefore this mode does not</p>
<p>strictly conform. The following symbols from the</p>
<p>float.h</p>
<p>header</p>
<p>do not have conforming values due to reduced precision:</p>
<p>DECIMAL_DIG DBL_DIG LDBL_DIG DBL_EPSILON LDBL_EPSILON</p>
<p>.</p>
<p>In all other ways this mode conforms to the standard.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nofloatsingle</b>) â [default] Treats</p>
<p>double</p>
<p>types normally</p>
<p><i>133</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Floating-Point</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>NaN Compares as Unordered</b></p>
<p>Ensures floating-point comparisons using the C relational operators properly handle</p>
<p>NaN</p>
<p>operands as unordered, which sometimes will require the generation of</p>
<p>additional or alternative instructions. These extra or alternative instructions may</p>
<p>degrade floating-point comparison performance. This option only applies when the</p>
<p>hardware floating-point unit (FPU) is enabled. However, this option is not supported</p>
<p>on the V850E1F-based devices. Permitted settings for this option are</p>
<p>â¢</p>
<p><b>On</b> (<b>-fNaN_cmp_unordered</b>) â Ensure floating-point comparisons using the</p>
<p>C relational operators properly handle</p>
<p>NaN</p>
<p>operands as unordered.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-fno_NaN_cmp_unordered</b>) â [default] Allow the compiler to assume</p>
<p>built-in relational operations do not need to consider unordered operands.</p>
<p><b>Floating Point Associativity</b></p>
<p>Controls the application of the mathematical associativity property to floating point</p>
<p>expressions.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-float_associativity</b>) â [default] The compiler may apply the associativity</p>
<p>property to floating point expressions. This may change how floating point</p>
<p>values are rounded.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_float_associativity</b>) â The compiler may not apply the associativity</p>
<p>property to floating point expressions.</p>
<p><b>Floating-Point Functions</b></p>
<p>Controls the replacement of calls to math library functions (such as</p>
<p>sqrt()</p>
<p>) with</p>
<p>inline instructions. These instructions may not be exactly equivalent to the function</p>
<p>calls they are replacing. For example, they may not exhibit identical floating-point</p>
<p>rounding or set</p>
<p>errno</p>
<p>. Even if this option is disabled, other optimizations that</p>
<p>replace calls to math library functions may be performed under</p>
<p><b>-Oinline_constant_math</b>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-ffunctions</b>) â The compiler may use inline instructions instead of calling</p>
<p>math library functions.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>134</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Off</b> (<b>-fnofunctions</b>) â [default] The compiler will call math library functions</p>
<p>and not substitute inline instructions.</p>
<p><b>Floating-Point Precise Signed Zero</b></p>
<p>The Green Hills tools generally conform to IEEE floating-point standards as much</p>
<p>as possible. However, better code performance in both size and speed can be obtained</p>
<p>by allowing small deviations from the standard with respect to the treatment of</p>
<p>signed zero quantities (</p>
<p>-0.0</p>
<p>versus</p>
<p>+0.0</p>
<p>). When<b> -no_precise_signed_zero</b> is</p>
<p>used, the compiler is permitted to replace sequences of operations that might have</p>
<p>resulted in a negative zero (-0.0) outcome with one that may instead produce a</p>
<p>positive zero result. Similarly, sequences that resulted in a positive zero result may</p>
<p>be replaced with one resulting in a negative zero result. Consequently, because</p>
<p>negative zero and positive zero are treated as equal quantities in every respect by</p>
<p>the compiler, this should have no impact on the accuracy of user code when the</p>
<p>distinction between signed zero quantities is of no importance. Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-precise_signed_zero</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_precise_signed_zero</b>) â [default]</p>
<p><b>Floating-Point Precise Signed Zero Compare</b></p>
<p>By default, Green Hills tools conform to the IEEE requirement that negative zero</p>
<p>(</p>
<p>-0.0</p>
<p>) quantities must compare equal to positive zero (</p>
<p>0.0</p>
<p>) quantities.</p>
<p>Consequently, expressions involving an equality such as</p>
<p>-0.0 == 0.0</p>
<p>or</p>
<p>0.0</p>
<p>&lt;= -0.0</p>
<p>always returns true, and expressions involving an inequality such as</p>
<p>-0.0</p>
<p>!= 0.0</p>
<p>and</p>
<p>-0.0 &lt; 0.0</p>
<p>always returns false. On some architectures, better</p>
<p>optimization strategies can be employed if the compiler is permitted to ignore this</p>
<p>requirement by using<b> -no_precise_signed_zero_compare</b>. However, caution must</p>
<p>be employed when using this option because it can affect both the accuracy and</p>
<p>correctness of user floating point code if that code relies on equalities between the</p>
<p>zeros. You may want to consider enabling<b> -precise_signed_zero</b> when attempting</p>
<p>to use<b> -no_precise_signed_zero_compare</b>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Allow -0 to differ from +0 when it helps optimizations</b></p>
<p>(<b>-no_precise_signed_zero_compare</b>)</p>
<p><i>135</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Floating-Point</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Force -0 to compare equal to +0 always</b> (<b>-precise_signed_zero_compare</b>)</p>
<p>â [default]</p>
<p><b>Use Floating-Point in stdio Routines</b></p>
<p>Controls the use of floating-point in</p>
<p>stdio</p>
<p>operations. This option is deprecated</p>
<p>and may be removed in a future release. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-floatio</b>) â [default] Use standard libraries.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nofloatio</b>) â Use<b> libnoflt.a</b>, a library containing special versions of</p>
<p>printf</p>
<p>,</p>
<p>scanf</p>
<p>, and related functions which, since they contain no</p>
<p>floating-point operations, are therefore smaller. Floating-point formats (</p>
<p>%f</p>
<p>,</p>
<p>%g</p>
<p>,</p>
<p>%e</p>
<p>) are not supported. In environments where floating-point uses large</p>
<p>library support routines, this option can save space for programs that use</p>
<p>printf</p>
<p>, but which do not require floating-point. This option only works with</p>
<p>whichever<b> WChar Size</b> option is the default for your processor (<b>-wchar_u16</b></p>
<p>or<b> -wchar_s32</b>).</p>
<p><b>Text and Data Placement</b></p>
<p>This option category is contained within<b> Target</b>.</p>
<p>These options control the placement of text and data in memory.</p>
<p><b>Special Data Area</b></p>
<p>Specifies that data up to a certain size should be placed in the<i> Small Data Area</i> or</p>
<p><i>Zero Data Area</i>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Small Data Area</b> (<b>-sda</b>) â Enables the<i> Small Data Area</i> optimization with a</p>
<p>threshold of 8. For more information, see âSpecial Data Area Optimizationsâ</p>
<p>on page 96.</p>
<p>â¢</p>
<p><b>Small Data Area with Threshold</b> (<b>-sda=<i>size</b></i>) â Enables the<i> Small Data Area</i></p>
<p>optimization, where<i> size</i> specifies the threshold size for objects placed in the</p>
<p>SDA.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>136</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Zero Data Area with Threshold</b> (<b>-zda=<i>size</b></i>) â Enables the<i> Zero Data Area</i></p>
<p>optimization, where<i> size</i> specifies the threshold size for objects placed in the</p>
<p>ZDA. For more information, see âSpecial Data Area Optimizationsâ on page 96.</p>
<p>â¢</p>
<p><b>No Special Data Area</b> (<b>-nothreshold</b>) â [default] Disables the special data</p>
<p>area optimization.</p>
<p>Valid formats for the<i> size</i> parameter threshold include:</p>
<p>1024</p>
<p>,</p>
<p>0x400</p>
<p>, and</p>
<p>all</p>
<p>. If</p>
<p><i>size</i> is set to</p>
<p>all</p>
<p>, then no size restriction is set on objects placed into the special</p>
<p>data area.</p>
<p><b>Note</b></p>
<p>Thresholds imposed by these options will not be respected for symbol</p>
<p>names appearing in a file specified with<b> -sda_file</b> (see âSmall Data Area</p>
<p>Fileâ on page 137).</p>
<p><b>Small Data Area File</b></p>
<p>Specifies a file that contains a list of symbol names, one per line, that should be</p>
<p>placed in the<i> Small Data Area</i>. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-sda_file=<i>filename</b></i></p>
<p>C++ symbol names specified in the file should include relevant namespaces, such</p>
<p>as for example</p>
<p>mynamespace::mysymbolname</p>
<p>. The hash (#) character may be</p>
<p>used at the beginning of a line in the file to denote a comment. Extra white spacing</p>
<p>at the beginning and end of a line, or between lines, is ignored. The specified file</p>
<p>must exist and must be readable.</p>
<p><b>Note</b></p>
<p>Symbol names listed in the file will be placed in the Small Data Area</p>
<p>regardless of size threshold constraints imposed by other options (see</p>
<p>âSpecial Data Area Optimizationsâ on page 96).</p>
<p><b>Zero Data Area File</b></p>
<p>Specifies a file that contains a list of symbol names, one per line, that should be</p>
<p>placed in the<i> Zero Data Area</i>. The equivalent driver option is:</p>
<p><i>137</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Text and Data Placement</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>-zda_file=<i>filename</b></i></p>
<p>C++ symbol names specified in the file should include relevant namespaces, such</p>
<p>as for example</p>
<p>mynamespace::mysymbolname</p>
<p>. The hash (#) character may be</p>
<p>used at the beginning of a line in the file to denote a comment. Extra white spacing</p>
<p>at the beginning and end of a line, or between lines, is ignored. The specified file</p>
<p>must exist and must be readable.</p>
<p><b>V850 Tiny Data Area</b></p>
<p>Controls use of the<i> Tiny Data Area</i> Optimization. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>Multiple TDAs</b> (<b>-mtda</b>) â Enables multiple tiny data areas.</p>
<p>â¢</p>
<p><b>Single TDA</b> (<b>-single_tda</b>) â Enables a single tiny data area.</p>
<p>â¢</p>
<p><b>No TDA</b> (<b>-notda</b>) â [default] Disables tiny data areas. This option instructs</p>
<p>the compiler to produce code that assumes that the TDA optimization will not</p>
<p>be used by any module linked into the program thereby permitting the compiler</p>
<p>to overwrite the contents of the TDA base register</p>
<p>(ep)</p>
<p>without any attempt</p>
<p>at preservation. Consequently, programs compiled with<b> âmtda</b> or<b> âsingle_tda</b></p>
<p>cannot be combined safely with programs compiled with<b> ânotda</b>. It is</p>
<p>recommended to use the setting<b> -single_tda</b> for modules that do not require</p>
<p>the use of the TDA optimization, but must remain operable with those that do.</p>
<p>For more information, see âV850 Tiny Data Area (TDA) Optimizationâ on page 107.</p>
<p><b>23-bit SDA (V850E2V3 and later)</b></p>
<p>Controls whether or not the tools increase the size of the small data area (SDA) to</p>
<p>8 MB. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Generate 23-bit SDA relocations for load/store instructions</b> (<b>-large_sda</b>)</p>
<p>â Increases the size of the SDA to 8 MB. When accessing the SDA, the</p>
<p>compiler generates 6-byte load and store instructions with a 23-bit offset from</p>
<p>the SDA base register. This option is applicable only to V850E2V3 and later</p>
<p>processor variants on which 6-byte load and store instructions are supported.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>138</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Generate 16-bit SDA relocations for load/store instructions</b> (<b>-no_large_sda</b>)</p>
<p>â [default] Does not increase the size of the SDA. When accessing the SDA,</p>
<p>the compiler generates 4-byte load and store instructions with a 16-bit offset</p>
<p>from the SDA base register.</p>
<p><b>23-bit ZDA (V850E2V3 and later)</b></p>
<p>Controls whether or not the tools increase the size of the zero data area (ZDA) to</p>
<p>8 MB. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Generate 23-bit ZDA relocations for load/store instructions</b> (<b>-large_zda</b>)</p>
<p>â Increases the size of the ZDA to 8 MB. When accessing the ZDA, the</p>
<p>compiler generates 6-byte load and store instructions with a 23-bit offset from</p>
<p>the ZDA base register. This option is applicable only to V850E2V3 and later</p>
<p>processor variants on which 6-byte load and store instructions are supported.</p>
<p>â¢</p>
<p><b>Generate 16-bit ZDA relocations for load/store instructions</b> (<b>-no_large_zda</b>)</p>
<p>â [default] Does not increase the size of the ZDA. When accessing the ZDA,</p>
<p>the compiler generates 4-byte load and store instructions with a 16-bit offset</p>
<p>from the ZDA base register.</p>
<p><b>Linker-Based SDA23/ZDA23 Shortening (V850E2V3 and later)</b></p>
<p>Controls a linker-based optimization that shortens 6-byte load and store instructions</p>
<p>to 4-byte instructions when possible. This option usually produces smaller code for</p>
<p>programs compiled with<b> -large_sda</b> or<b> -large_zda</b>. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>Convert 23-bit SDA relocations to 16-bit in load/store instructions when</b></p>
<p><b>possible</b> (<b>-shorten_loads</b>) â Converts 6-byte load and store instructions with</p>
<p>a 23-bit offset from the SDA base register to an equivalent 4-byte instruction</p>
<p>with a 16-bit offset, if the offset can fit in 16 bits. If you enable<b> -Olink</b>, this</p>
<p>optimization is enabled implicitly.</p>
<p>â¢</p>
<p><b>Do not convert 23-bit SDA relocations to 16-bit in load/store instructions</b></p>
<p>(<b>-no_shorten_loads</b>) â [default]</p>
<p><i>139</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Text and Data Placement</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Linker-Based Move Shortening</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Convert 32 and 48-bit move relocations to 16-bit in move instructions when</b></p>
<p><b>possible</b> (<b>-shorten_moves</b>) â If you enable<b> -Olink</b>, this optimization is enabled</p>
<p>implicitly.</p>
<p>â¢</p>
<p><b>Do not attempt to shrink move relocations in move instructions</b></p>
<p>(<b>-no_shorten_moves</b>) â [default]</p>
<p><b>Place all read-only SDA items in ZDA instead</b></p>
<p>Controls whether read-only data that would normally be placed in the</p>
<p>.rosdata</p>
<p>section (due to an SDA threshold or pragma) is placed in</p>
<p>.rozdata</p>
<p>instead.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-rosda_is_zda</b>) â Place read-only data intended for SDA into ZDA,</p>
<p>instead.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_rosda_is_zda</b>) â [default] Leave read-only SDA variables in SDA.</p>
<p><b>Allow Common Variables in ZDA</b></p>
<p>Controls whether uninitialized global variables in the Zero Data Area will be</p>
<p>allocated as</p>
<p>COMMON</p>
<p>or as defined variables.This option is only relevant when the</p>
<p>following is true:</p>
<p>â¢</p>
<p>Generation of common variables is enabled (<b>--commons</b>).</p>
<p>â¢</p>
<p>Use of the Zero Data Area has not been disabled (<b>-zda=<i>none</b></i>).</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-zero_commons</b>) â [default] Uninitialized global variables in the Zero</p>
<p>Data Area will be allocated as</p>
<p>COMMON</p>
<p>.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_zero_commons</b>) â Uninitialized global variables in the Zero Data</p>
<p>Area will be allocated as defined variables.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>140</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Position Independent Code</b></p>
<p>Controls the generation of<i> Position Independent Code</i> (PIC). Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-pic</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nopic</b>) â [default]</p>
<p>For more information, see âPosition Independent Code (PIC)â on page 117. This</p>
<p>option cannot be used in conjunction with<b> -layout</b>.</p>
<p><b>Position Independent Data</b></p>
<p>Controls generation of<i> Position Independent Data</i> (PID). Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-pid</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nopid</b>) â [default]</p>
<p>For more information, see âPosition Independent Data (PID)â on page 119. This</p>
<p>option cannot be used in conjunction with<b> -layout</b>.</p>
<p><b>Far Calls</b></p>
<p>Controls whether the compiler will generate a far call for every call. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>Make All Calls Far Calls</b> (<b>-farcalls</b>) â Enables generation of a far function</p>
<p>call for every call. This allows for functions to be located at any distance from</p>
<p>the caller.</p>
<p>â¢</p>
<p><b>Make No Far Calls</b> (<b>-nofarcalls</b>) â [default] Disables generation of far</p>
<p>function calls. Large programs or programs with discontinuous text sections</p>
<p>may not link if the range of the call instruction is exceeded.</p>
<p>For more information, see âNear and Far Function Callsâ on page 93.</p>
<p><i>141</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Text and Data Placement</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Linker-Based Far Call Patching</b></p>
<p>Controls a linker-based optimization that generates far calls only for calls which</p>
<p>are out of range and would otherwise fail. This option will generally produce smaller</p>
<p>code than generating far calls for every call (see âFar Callsâ on page 141). Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>Patch Far Calls When Necessary</b> (<b>-farcallpatch</b>) â [default]</p>
<p>â¢</p>
<p><b>Do Not Patch Far Calls</b> (<b>-nofarcallpatch</b>)</p>
<p><b>Placement of Zero-Initialized Data</b></p>
<p>Controls the allocation of statically-initialized variables and arrays that are explicitly</p>
<p>initialized to zero. Allocating such objects to an uninitialized section will generally</p>
<p>reduce the size of the executable ROM image. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>Place Zero-Initialized Data in BSS Sections</b> (<b>-discard_zero_initializers</b>) â</p>
<p>Places statically-initialized variables that are explicitly initialized to zero as if</p>
<p>they were defined but not initialized. For example, if</p>
<p>int x = 0;</p>
<p>would</p>
<p>normally place</p>
<p>x</p>
<p>in the</p>
<p>.data</p>
<p>section, the compiler may place it in the</p>
<p>.bss</p>
<p>section instead, as if you had declared</p>
<p>x</p>
<p>with</p>
<p>int x;</p>
<p>. Regardless,</p>
<p>x</p>
<p>would</p>
<p>still be initialized to zero.</p>
<p>â¢</p>
<p><b>Place Zero-Initialized Data in Data Sections</b> (<b>-no_discard_zero_initializers</b>)</p>
<p>â [default] Places statically-initialized variables that are explicitly initialized</p>
<p>to zero in the same way as those initialized to other values. If a global variable</p>
<p>is not explicitly initialized in the source code, it may still be allocated to the</p>
<p>appropriate</p>
<p>.bss</p>
<p>section.</p>
<p><b>Global Registers</b></p>
<p>Reserves up to 5 registers (</p>
<p>r20</p>
<p>to</p>
<p>r24</p>
<p>in that order) to hold global variables.</p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-globalreg=<i>n</b></i></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>142</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>If you are building INTEGRITY code, you cannot modify the default</p>
<p>value of this option. If you attempt to do so, the compiler issues the</p>
<p>following message:</p>
<p>Warning: The number of global registers on INTEGRITY</p>
<p>is not configurable. option -globalreg=<i>n</i> ignored</p>
<p>For more information, see âStoring Global Variables in Registersâ on page 92.</p>
<p><b>Stack Limit Checking</b></p>
<p>Controls stack limit checking, which is performed by making a call to a function</p>
<p>__stkchk()</p>
<p>in the prologue of each routine. Because these calls are added by the</p>
<p>compiler, this option does not detect stack overflows that are caused by pre-compiled</p>
<p>code, such as the Green Hills libraries or linker generated code. In stand-alone</p>
<p>environments,</p>
<p>__stkchk</p>
<p>is in<b> libsys.a</b>. The code for it can be obtained in</p>
<p><b>src/libsys/ind_stackcheck.c</b> (see âCustomizing the Run-Time Environment Libraries</p>
<p>and Object Modulesâ on page 863). Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-stack_check</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_stack_check</b>) [default]</p>
<p>To enable stack checking on a per-function basis, use the</p>
<p>stackcheck</p>
<p>attribute</p>
<p>(see</p>
<p>stackcheck</p>
<p>on page 725).</p>
<p><b>Check for Stack Smashing Attacks</b></p>
<p>Controls code instrumentation that provides protection against stack smashing</p>
<p>attacks. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-stack_protector</b>) â Enable protection against stack smashing attacks.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_stack_protector</b>) â [default] Do not enable protection against stack</p>
<p>smashing attacks.</p>
<p>When enabled, functions with variables greater than 8 bytes in length are</p>
<p>instrumented. The compiler places a<i> canary</i> â a special location on the stack â</p>
<p><i>143</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Text and Data Placement</i></p>
<h1 style="page-break-before:always; "></h1>
<p>in the prologue, adjacent to the saved registers. This canary is marked with a specific</p>
<p>value. In the epilogue, this canary value on the stack is compared against the original</p>
<p>value. If the values do not match, an error function is called, terminating the program.</p>
<p>This technique offers protection against stack smashing attacks, which attempt to</p>
<p>overwrite the return value, although a motivated attacker can overcome the protection</p>
<p>using a multi-phased attack. It is important to understand that a program that contains</p>
<p>no possibility of an array overrun is immune to all such attacks, even without the</p>
<p>protection afforded by a stack canary.<b> -stack_protector</b> is not a substitute for well</p>
<p>designed software.</p>
<p>The canary value should be set randomly based on system entropy. (See the example</p>
<p>in<b> src/libsys/ind_stack_canary2</b>.) To customize the error handling routine,</p>
<p>implement</p>
<p>__stack_chk_fail()</p>
<p>. (See the example in</p>
<p><b>src/libsys/ind_stackcanary.c</b>.) This function must never return.</p>
<p>The following pseudo code illustrates how to randomize the canary value, and</p>
<p>customize the error handling:</p>
<p>#pragma ghs startnoinline</p>
<p>// Don't allow main2() to be inlined or main() may require</p>
<p>// a canary.</p>
<p>static int main2(void){</p>
<p>// The normal stuff that main()would otherwise do.</p>
<p>}</p>
<p>#pragma ghs endnoinline</p>
<p>void __stack_chk_fail(void){</p>
<p>// Log the failure</p>
<p>Exit(1);</p>
<p>}</p>
<p>extern uintptr_t *__ghs_get_stack_chk_guard_address(void);</p>
<p>int main() {</p>
<p>// Initialize the stack canary before any code</p>
<p>// that may require a stack canary</p>
<p>*__ghs_get_stack_chk_guard_address() = &lt;random_value&gt;;</p>
<p>// The real program starts in main2</p>
<p>return main2();</p>
<p>}</p>
<p>Check your operating system's documentation for other support information.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>144</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Rename Section</b></p>
<p>Assigns variables and functions to specific user-named sections. This option works</p>
<p>in the same way as the</p>
<p>#pragma ghs section</p>
<p>directive but does not modify the</p>
<p>source file (see âCustom Program Sectionsâ on page 83). The equivalent driver</p>
<p>option is:</p>
<p>â¢</p>
<p><b>-section<i> secttype</i>=<i>sectname</b></i></p>
<p><i>secttype</i> specifies which kind of code or data item is affected by the option and</p>
<p>may be any of those listed in âDefault Program Sectionsâ on page 82 (with or</p>
<p>without the leading period).</p>
<p><i>sectname</i> is the user-defined section name, which starts with a period (</p>
<p>.</p>
<p>) by</p>
<p>convention.</p>
<p>This option changes the default name of the specified section type throughout</p>
<p>the file. Its effect is overridden by any</p>
<p>#pragma ghs section</p>
<p>in the source</p>
<p>file with the same<i> secttype</i>, and its effect is restored by</p>
<p>#pragma ghs section</p>
<p>secttype=default</p>
<p>.</p>
<p><b>Aligned Data Sections</b></p>
<p>Controls whether the compiler will assign a variable in a default data section to an</p>
<p>aligned data section whose name is</p>
<p><i>sectname</i>.a<i>N</i></p>
<p>, where<i> sectname</i> is the name of</p>
<p>the default data section, and<i> N</i> is the alignment in bytes of the variable. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>Split Data Sections by Alignment</b> (<b>-split_data_sections_by_alignment</b>) â</p>
<p>Allocates a variable in a default data section to an aligned data section according</p>
<p>to its alignment. However, if the variable is in a user-named section either by</p>
<p>#pragma</p>
<p>or by</p>
<p>__attribute__</p>
<p>, do not allocate it to an aligned data section</p>
<p>and keep it in the user-named section.</p>
<p>â¢</p>
<p><b>Do Not Split Data Sections by Alignment</b></p>
<p>(<b>-no_split_data_sections_by_alignment</b>) â [default] Do not allocate variables</p>
<p>to aligned data sections.</p>
<p>This option should be passed both when compiling and when linking. For more</p>
<p>information, see âAligned Data Sectionsâ on page 86.</p>
<p><i>145</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Text and Data Placement</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Individual Variable Sections for Default Data Sections</b></p>
<p>Controls whether to enable the Individual Variable Sections support and whether</p>
<p>the compiler will assign a non-COMMON global or static variable in a default data</p>
<p>section to its own individual section, whose name is<i> sectname</i>.<i>symname</i>, where</p>
<p><i>sectname</i> is the default data section's name, and<i> symname</i> is the variable's symbol</p>
<p>name. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Allocate Variables in Default Data Sections to Individual Variable Sections</b></p>
<p>(<b>-individual_data_sections</b>) â Allocates a non-COMMON global or static</p>
<p>variable in a default data section to its own individual section.</p>
<p>â¢</p>
<p><b>Do Not Allocate Variables in Default Data Sections to Individual Variable</b></p>
<p><b>Sections</b> (<b>-no_individual_data_sections</b>) â [default] Do not allocate variables</p>
<p>in default data sections to individual sections. Leave them in the default data</p>
<p>sections instead.</p>
<p>This option should be passed both when compiling and when linking. For more</p>
<p>information, see âIndividual Function and Variable Sectionsâ on page 87.</p>
<p><b>Note</b></p>
<p>This option does not assign variables in custom data sections to individual</p>
<p>sections. To assign variables in custom data sections to individual sections</p>
<p>in addition to variables in default data sections, see âIndividual Variable</p>
<p>Sections for Renamed Data Sectionsâ on page 146 and âIndividual</p>
<p>Variable Sections for User-Defined Data Sectionsâ on page 147</p>
<p><b>Individual Variable Sections for Renamed Data Sections</b></p>
<p>When the Individual Variable Sections support is enabled, controls whether the</p>
<p>compiler will assign a global or static variable in a renamed data section declared</p>
<p>by</p>
<p>#pragma ghs section<i> settype</i>=&quot;<i>sectname</i>&quot;</p>
<p>directive to its own individual</p>
<p>section, whose name is<i> sectname</i>.<i>symname</i>, where<i> sectname</i> is the renamed data</p>
<p>section's name, and<i> symname</i> is the variable's symbol name. By default, the</p>
<p>Individual Variable Sections support only assigns variables in default data sections</p>
<p>to individual sections. Permitted settings for this option are:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>146</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Allocate Variables in Data Sections Renamed by #pragma to Individual</b></p>
<p><b>Variable Sections</b> (<b>-individual_pragma_data_sections</b>) â Allocates a global</p>
<p>or static variable in a renamed data section to its own individual section.</p>
<p>â¢</p>
<p><b>Do Not Allocate Variables in Data Sections Renamed by #pragma to</b></p>
<p><b>Individual Variable Sections</b> (<b>-no_individual_pragma_data_sections</b>) â</p>
<p>[default] Do not allocate variables in renamed data sections to individual</p>
<p>sections. Keep them in the renamed data sections instead.</p>
<p>For more information, see âIndividual Function and Variable Sectionsâ on page 87.</p>
<p><b>Note</b></p>
<p>This option is only effective if<b> -individual_data_sections</b> (see âIndividual</p>
<p>Variable Sections for Default Data Sectionsâ on page 146) is also used.</p>
<p><b>Individual Variable Sections for User-Defined Data Sections</b></p>
<p>When the Individual Variable Sections support is enabled, controls whether the</p>
<p>compiler will assign a global or static variable in a user-defined data section declared</p>
<p>by</p>
<p>__attribute__((section(&quot;<i>sectname</i>&quot;)))</p>
<p>to its own individual section,</p>
<p>whose name is<i> sectname</i>.<i>symname</i>, where<i> sectname</i> is the renamed data section's</p>
<p>name, and<i> symname</i> is the variable's symbol name. By default, the Individual</p>
<p>Variable Sections support only assigns variables in default data sections to individual</p>
<p>sections. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Allocate Variables in User-Defined Data Sections by __attribute__ to</b></p>
<p><b>Individual Variable Sections</b> (<b>-individual_attribute_data_sections</b>) â</p>
<p>Allocates a global or static variable in an user-defined data section to its own</p>
<p>individual section.</p>
<p>â¢</p>
<p><b>Do Not Allocate Variables in User-Defined Data Sections by __attribute__</b></p>
<p><b>to Individual Variable Sections</b> (<b>-no_individual_attribute_data_sections</b>)</p>
<p>â [default] Do not allocate variables in user-defined data sections to individual</p>
<p>variable sections. Keep them in the user-defined sections instead.</p>
<p>For more information, see âIndividual Function and Variable Sectionsâ on page 87.</p>
<p><b>Note</b></p>
<p>This option is only effective if<b> -individual_data_sections</b> (see âIndividual</p>
<p>Variable Sections for Default Data Sectionsâ on page 146) is also used.</p>
<p><i>147</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Text and Data Placement</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Individual Function Sections for Default Text Section</b></p>
<p>Controls whether to enable the Individual Function Sections support and whether</p>
<p>the compiler will assign a function (including static function) in a default text section</p>
<p>to its own individual section, whose name is<i> sectname</i>.<i>symname</i>, where<i> sectname</i></p>
<p>is the default text section's name, and<i> symname</i> is the function's symbol name.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Allocate Functions in Default Text Section to Individual Function Sections</b></p>
<p>(<b>-individual_function_sections</b>) â Allocates a function in a default text section</p>
<p>to its own individual section.</p>
<p>â¢</p>
<p><b>Do Not Allocate Functions in Default Text Sesction to Individual Function</b></p>
<p><b>Sections</b> (<b>-no_individual_function_sections</b>) â [default] Do not allocate</p>
<p>functions in text section to individual sections. Keep them in the text section</p>
<p>instead.</p>
<p>This option should be passed both when compiling and when linking. For more</p>
<p>information, see âIndividual Function and Variable Sectionsâ on page 87.</p>
<p><b>Note</b></p>
<p>This option does not assign functions in custom text sections to individual</p>
<p>sections. To assign functions in custom text sections to individual sections</p>
<p>in addition to functions in default text sections, see âIndividual Function</p>
<p>Sections for Renamed Text Sectionsâ on page 148 and âIndividual</p>
<p>Function Sections for User-Defined Text Sectionsâ on page 149.</p>
<p><b>Individual Function Sections for Renamed Text Sections</b></p>
<p>When the Individual Function Sections support is enabled, controls whether the</p>
<p>compiler will assign a function (including static function) in a text section renamed</p>
<p>by</p>
<p>#pragma ghs section<i> secttype</i>=&quot;<i>sectname</i>&quot;</p>
<p>directive to its own</p>
<p>individual section, whose name is<i> sectname</i>.<i>symname</i>, where<i> sectname</i> is the</p>
<p>renamed text section's name, and<i> symname</i> is the function's symbol name. By default,</p>
<p>the Individual Function Sections support only assigns functions in the default</p>
<p>.text</p>
<p>section to individual sections. Permitted settings for this option are:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>148</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Allocate Functions in Text Sections Renamed by #pragma to Individual</b></p>
<p><b>Function Sections</b> (<b>-individual_pragma_function_sections</b>) â Allocates a</p>
<p>function in a renamed text section to its own individual section.</p>
<p>â¢</p>
<p><b>Do Not Allocate Functions in Text Sections Renamed by #pragma to</b></p>
<p><b>Individual Function Sections</b> (<b>-no_individual_pragma_function_sections</b>)</p>
<p>â [default] Do not allocate functions in renamed text sections to individual</p>
<p>sections. Keep them in the renamed text sections instead.</p>
<p>For more information, see âIndividual Function and Variable Sectionsâ on page 87.</p>
<p><b>Note</b></p>
<p>This option is only effective if<b> -individual_function_sections</b> (see</p>
<p>âIndividual Function Sections for Default Text Sectionâ on page 148) is</p>
<p>also used.</p>
<p><b>Individual Function Sections for User-Defined Text Sections</b></p>
<p>When the Individual Function Sections support is enabled, controls whether the</p>
<p>compiler will assign a function (including static function) in a user-defined text</p>
<p>section by</p>
<p>__attribute__((section(&quot;<i>sectname</i>&quot;)))</p>
<p>directive to its own</p>
<p>individual section, whose name is<i> sectname</i>.<i>symname</i>, where<i> sectname</i> is the</p>
<p>user-defined text section's name, and<i> symname</i> is the function's symbol name. By</p>
<p>default, the Individual Function Sections support only assigns functions in the</p>
<p>default</p>
<p>.text</p>
<p>section to individual sections. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Allocate Functions in User-Defined Text Sections by __attribute__ to</b></p>
<p><b>Individual Function Sections</b> (<b>-individual_attribute_function_sections</b>) â</p>
<p>Allocates a function in a user-defined text section to its own individual section.</p>
<p>â¢</p>
<p><b>Do Not Allocate Functions in User-Defined Text Sections by __attribute__</b></p>
<p><b>to Individual Function Sections</b></p>
<p>(<b>-no_individual_attribute_function_sections</b>) â [default] Do not allocate</p>
<p>functions in user-defined text sections to individual sections. Keep them in the</p>
<p>user-defined text sections instead.</p>
<p>For more information, see âIndividual Function and Variable Sectionsâ on page 87.</p>
<p><i>149</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Text and Data Placement</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>This option is only effective if<b> -individual_function_sections</b> (see</p>
<p>âIndividual Function Sections for Default Text Sectionâ on page 148) is</p>
<p>also used.</p>
<p><b>Use Small Block Malloc</b></p>
<p>Specifies whether to use a faster or less-fragmenting</p>
<p>malloc()</p>
<p>implementation.</p>
<p>This option only affects stand-alone applications, and has no effect when Run Time</p>
<p>Memory Checking (<b>-check=alloc</b> or<b> -check=memory</b>) is enabled.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-fast_malloc</b>) â [default] A separate allocation pool is maintained for</p>
<p>small blocks, resulting in faster allocation times at the expense of increased</p>
<p>heap fragmentation. This version of</p>
<p>malloc()</p>
<p>has a slightly larger library</p>
<p>footprint. INTEGRITY always uses this implementation, regardless of this</p>
<p>option.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_fast_malloc</b>) â Use the</p>
<p>malloc()</p>
<p>implementation that shipped</p>
<p>with older versions of the compiler.</p>
<p><b>Generate a backwards-compatible (MULTI 5.1.x and earlier) call</b></p>
<p><b>table in the linker</b></p>
<p>Older releases of MULTI (versions 5.1.x and earlier) made use of the</p>
<p>callt</p>
<p>instruction and its associated call table differently than current versions. Previous</p>
<p>releases used a statically allocated call table where the first 44 entries were reserved</p>
<p>for specific library functions. The tools now dynamically assign entries at link time,</p>
<p>and entries are called by function name and resolved to a table index at link time.</p>
<p>However, this new behavior is incompatible with objects built with previous releases,</p>
<p>since they will reference the table by hard-coded indices that will no longer map to</p>
<p>the expected entry. While the linker will attempt to automatically detect such code</p>
<p>and adopt a compatible strategy, this option is provided to force that behavior. The</p>
<p>linker will give a warning when it detects a need to be backwards compatible. If all</p>
<p>objects are rebuilt with newer tools, that warning can be avoided by adding a</p>
<p>.callt</p>
<p>section to the program's linker directives file (it should be placed before .text).</p>
<p>Permitted settings for this option are:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>150</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>On</b> (<b>-v800_old_callt</b>) â Forces the linker to reserve the first 44 entries of the</p>
<p>call table for the same library routines that occupied these entries in legacy</p>
<p>releases.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_v800_old_callt</b>) â [default] Suggests that the linker can dynamically</p>
<p>create a call table. This option does not force this behavior, as the linker will</p>
<p>still revert to the<b> -v800_old_callt</b> behavior when it detects incompatible object</p>
<p>files built with previous releases of the tools.</p>
<p><b>Instruction Set</b></p>
<p>This option category is contained within<b> Target</b>.</p>
<p>These options control aspects of the instruction set.</p>
<p><b>Epilogues and Prologues via callt</b></p>
<p>Controls the use of the V850E</p>
<p>callt</p>
<p>instruction function prologues and epilogues.</p>
<p>This option requires that you use the default Green Hills startup code. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-callt</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_callt</b>)</p>
<p><b>Save CTPSW and CTPC registers in Interrupt Routines</b></p>
<p>Controls whether the</p>
<p>CTPSW</p>
<p>and</p>
<p>CTPC</p>
<p>registers are saved in interrupt routines</p>
<p>generated by the compiler. To use this option, you must also enable<b> -no_callt</b>. This</p>
<p>option disables the use of library prologue routines. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-no_ignore_callt_state_in_interrupts</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-ignore_callt_state_in_interrupts</b>)</p>
<p><i>151</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Instruction Set</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Epilogues and Prologues via prepare and dispose</b></p>
<p>Controls the use of the V850E</p>
<p>prepare</p>
<p>and</p>
<p>dispose</p>
<p>instructions for function</p>
<p>prologues and epilogues. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-prepare_dispose</b>) â [default when<b> -callt</b> is disabled]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_prepare_dispose</b>) â [default when<b> -callt</b> is enabled]</p>
<p>Enabling this option will override any use of the</p>
<p>callt</p>
<p>instruction for prologues</p>
<p>or epilogues (see âEpilogues and Prologues via calltâ on page 151).</p>
<p><b>Use pushsp and popsp instructions</b></p>
<p>Controls the use of the RH850</p>
<p>pushsp</p>
<p>and</p>
<p>popsp</p>
<p>instructions for interrupt function</p>
<p>prologues and epilogues and for general function stack spills in some cases. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-push_pop</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_push_pop</b>)</p>
<p><b>Allocate Pointers to the EP Register</b></p>
<p>Controls an optimization that attempts to allocate pointer variables to the</p>
<p>EP</p>
<p>register</p>
<p>in order to use short load and store instructions. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-allocate_ep</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_allocate_ep</b>)</p>
<p>The Tiny Data Area can interfere with this optimization, and you may obtain better</p>
<p>results by disabling the<b> TargetâText and Data PlacementâV850 Tiny Data</b></p>
<p><b>Area</b> option (<b>-notda</b>).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>152</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Instrument loads with software trace instructions</b></p>
<p>Specifies whether or not to instrument load instructions whose addresses are not</p>
<p>known to be from the stack with software trace instructions. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-rh850_trace_loads</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_rh850_trace_loads</b>) â [default]</p>
<p><b>Optimize Accesses to Adjacent Bitfields</b></p>
<p>Controls a set of optimizations for reading and writing adjacent bitfields. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-smaller_bitops</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_smaller_bitops</b>)</p>
<p>Note that these optimizations do not affect volatile bitfields.</p>
<p><b>Allow 1-bit accesses to single-bit volatile fields with any base</b></p>
<p><b>type</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-allow_1bit_volatile_any_basetype</b>) â Allow the instructions</p>
<p>set1</p>
<p>,</p>
<p>clr1</p>
<p>,</p>
<p>tst1</p>
<p>, and</p>
<p>not1</p>
<p>to be used to access single-bit volatile bitfields with a</p>
<p>base type larger than</p>
<p>char</p>
<p>. This results in more efficient code, but will result</p>
<p>in single-byte accesses even though the volatile object has a type larger than</p>
<p>char</p>
<p>. This was the default behavior in MULTI 4.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_allow_1bit_volatile_any_basetype</b>) â [default] Choose instructions</p>
<p>that access volatile bitfields strictly according to the size of their base type.</p>
<p><b>Allow any use of 1-bit instructions CLR1 SET1 TST1</b></p>
<p>Permitted settings for this option are:</p>
<p><i>153</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Instruction Set</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>On</b> (<b>-rh850_1bit</b>) â [default] Allow the compiler to use the instructions</p>
<p>CLR1</p>
<p>,</p>
<p>SET1</p>
<p>, and</p>
<p>TST1</p>
<p>as appropriate to access individual bits.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_rh850_1bit</b>) â Prevent the compiler from using the instructions</p>
<p>CLR1</p>
<p>,</p>
<p>SET1</p>
<p>, and</p>
<p>TST1</p>
<p>. The GHS libraries may still use these instructions for</p>
<p>certain accesses even with this option.</p>
<p>Although the option has</p>
<p>rh850</p>
<p>in the name, the option applies equally to V850 and</p>
<p>RH850 processors.</p>
<p>The<b> -no_rh850_1bit</b> option is provided for applications which use an external</p>
<p>memory bus that does not support read-modify-write operations. It is recommended</p>
<p>that functions which operate on objects accessed over this bus be grouped into</p>
<p>certain files so those files can be compiled with the<b> -no_rh850_1bit</b> option, while</p>
<p>the rest of the application is compiled without it.</p>
<p><b>Use divq Instruction for Divide (V850E2R and later)</b></p>
<p>When compiling for the V850E2R or later processors, this option specifies whether</p>
<p>or not to use the</p>
<p>divq</p>
<p>and</p>
<p>divqu</p>
<p>instructions (divide quick) for integer division</p>
<p>where possible. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-divq</b>) â [default] Use</p>
<p>divq</p>
<p>and</p>
<p>divqu</p>
<p>for integer division where</p>
<p>possible.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_divq</b>) â Do not use</p>
<p>divq</p>
<p>or</p>
<p>divqu</p>
<p>. Because these instructions have</p>
<p>a variable execution time depending on the values of their arguments, setting</p>
<p>this option results in more deterministic behavior.</p>
<p><b>Use recipf.s/recipf.d for 1/x</b></p>
<p>Controls whether the compiler performs a divide or uses the</p>
<p>recipf.s</p>
<p>and</p>
<p>recipf.d</p>
<p>instructions when generating code for floating-point reciprocal operations</p>
<p>(</p>
<p>1/x</p>
<p>). This option is only valid on hardware that implements these instructions.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-recipf</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_recipf</b>) â [default]</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>154</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Use FPU 3.0 instructions (RH850 and later)</b></p>
<p>Controls the use of the RH850 FPU 3.0 instructions in the compiler and the</p>
<p>assembler. When enabled, the compiler will use the fused floating-point multiply-add</p>
<p>and multiply-subtract instructions FMAF.S,FMSF.S,FNMAF.S,FNMSF.S in place</p>
<p>of MADDF.S,MSUBF.S,NMADDF.S,NMSUBF.S. This will also enable the</p>
<p>intrinsics __CVTF.HS and __CVTF.SH in the compiler. When disabled, the compiler</p>
<p>will not use the FPU 3.0 instructions and disallow the intrinsics, and the assembler</p>
<p>will report error if these instructions are used in the assembly.</p>
<p>This option applies only to RH850 and will be ignored when used on other CPU</p>
<p>options. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-fpu=fpu30</b>) â [default for RH850]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-fpu=fpu20</b>) â [default for non-RH850]</p>
<p><b>Enable SIMD instructions (RH850 and later)</b></p>
<p>Specifies whether or not to enable support for the SIMD coprocessor in the toolchain.</p>
<p>This will enable the SIMD intrinsics in the compiler and SIMD instruction support</p>
<p>in the assembler. This option applies only to targets that support a SIMD coprocessor.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-rh850_simd</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_rh850_simd</b>) â [default]</p>
<p><b>Force the save/restore of R4/R5 in ISR prologue/epilogue</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-v850_isr_save_r4r5</b>) â Forces the</p>
<p>r4</p>
<p>and</p>
<p>r5</p>
<p>registers to be saved and</p>
<p>restored in interrupt routine prologue and epilogue functions.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_v850_isr_save_r4r5</b>) â [default]</p>
<p><i>155</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Instruction Set</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Force the save/restore of the EIIC register in ISR prologue/epilogue</b></p>
<p>Controls whether the compiler will save the</p>
<p>EIIC</p>
<p>register in interrupt prolog.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-v850_isr_save_eiic</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_v850_isr_save_eiic</b>) â [default]</p>
<p><b>Note</b></p>
<p>For FE-level interrupt routines, this option affects the saving and restoring</p>
<p>of the</p>
<p>FEIC</p>
<p>register instead.</p>
<p><b>Perform a syncp before branching in interrupt vectors created</b></p>
<p><b>with #pragma intvect</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-rh850_eint_erratum</b>) â</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_rh850_eint_erratum</b>) â</p>
<p><b>Require 4-byte alignment on offsets of word-sized load/store</b></p>
<p><b>instructions</b></p>
<p>Forces the compiler and linker to ensure that offsets of 32-bit load and store</p>
<p>instructions are 4-byte aligned. Generally the RH850 architecture requires the final</p>
<p>computed address to be 4-byte aligned, but not the offset. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-rh850_4bytewordoffset</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_rh850_4bytewordoffset</b>) â [default]</p>
<p><b>Use 64-bit Load/Store instructions (RH850 and later)</b></p>
<p>When compiling for the RH850 or later processors, specifies whether or not to use</p>
<p>the 64-bit load (</p>
<p>ld.dw</p>
<p>) and 64-bit store (</p>
<p>st.dw</p>
<p>) instructions in the compiler where</p>
<p>possible. This option does not change instructions used in the library. Permitted</p>
<p>settings for this option are:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>156</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>On</b> (<b>-64bit_load_store</b>) â [default] Use the 64-bit load (</p>
<p>ld.dw</p>
<p>) and 64-bit</p>
<p>store (</p>
<p>st.dw</p>
<p>) instructions in the compiler where possible.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_64bit_load_store</b>) â Do not use the 64-bit load (</p>
<p>ld.dw</p>
<p>) or 64-bit</p>
<p>store (</p>
<p>st.dw</p>
<p>) instructions in the compiler.</p>
<p><b>Floating-Point SIMD</b></p>
<p>This option category is contained within<b> Target</b>.</p>
<p><b>Floating-Point SIMD mode (RH850 and later)</b></p>
<p>Specifies whether or not to enable support for the Floating-Point SIMD coprocessor</p>
<p>in the toolchain and which of the two modes to enable. Enabling FPSIMD will</p>
<p>enable the FPSIMD intrinsics in the compiler and FPSIMD instruction support in</p>
<p>the assembler. This option applies only to targets that support a FPSIMD coprocessor</p>
<p>(RH850 and later). Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>No Floating-Point SIMD</b> (<b>-rh850_fpsimd=none</b>) â [default] Disable</p>
<p>Floating-Point SIMD support in the toolchain.</p>
<p>â¢</p>
<p><b>Floating-Point SIMD in Full Register Configuration Mode</b></p>
<p>(<b>-rh850_fpsimd=full</b>) â Enable Floating-Point SIMD in Full Register</p>
<p>Configuration mode. In this mode, all vector registers (</p>
<p>wr0</p>
<p>-</p>
<p>wr31</p>
<p>) are 128</p>
<p>bits in hardware and available for use in all S1/S2/S4 type instructions, which</p>
<p>operate on the lower 1, 2 and all 4 elements of vectors respectively.</p>
<p>â¢</p>
<p><b>Floating-Point SIMD in Half Register Configuration Mode</b></p>
<p>(<b>-rh850_fpsimd=half</b>) â Enable Floating-Point SIMD in Half Register</p>
<p>Configuration mode. In this mode, the 32 vector registers are physically 64</p>
<p>bits in hardware, so even though they are treated as 128 bits from the</p>
<p>programmer's point of view, there are some constraints on how the registers</p>
<p>can be used in the vector instructions. All 32 vector registers (</p>
<p>wr0</p>
<p>-</p>
<p>wr31</p>
<p>) can</p>
<p>be used in a S1 or S2 instruction (which operates on the lower 1 or 2 elements</p>
<p>of vectors respectively), but only</p>
<p>wr0</p>
<p>-</p>
<p>wr15</p>
<p>can be used in a S4 instruction</p>
<p>(which operates on all 4 elements of a vector). The assembler will report error</p>
<p>if a register in</p>
<p>wr16</p>
<p>-</p>
<p>wr31</p>
<p>is used in a S4 instruction. Further more, if a register</p>
<p>wrN</p>
<p>(where 0 &lt;=</p>
<p>N</p>
<p>&lt;= 15) is used in a S4 instruction,</p>
<p>wrN+16</p>
<p>cannot be used</p>
<p>in a S1/S2 instruction. The assembler and the linker will report error if such</p>
<p>conflicts are detected among S4 and S1/S2 instructions.</p>
<p><i>157</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Floating-Point SIMD</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Application Binary Interface</b></p>
<p>This option category is contained within<b> Target</b>.</p>
<p>These options control aspects of RH850 ABI.</p>
<p><b>Check incompatible RH850 ABI flags (RH850 only)</b></p>
<p>When building for the RH850 processors, specifies whether or not to enable the</p>
<p>detection of incompatible RH850 ABI flags among object files in the linker when</p>
<p>linking. If enabled, the linker will check for incompatible ABI flags and will emit</p>
<p>error when such flags are found. See</p>
<p>.rh850_flags</p>
<p>in âRH850 Directivesâ</p>
<p>on page 429 for details on RH850 ABI flags. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-check_rh850_abi_flags</b>) â [default] Check for incompatible ABI flags</p>
<p>among object files in the linker.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_check_rh850_abi_flags</b>) â Do not check for incompatible ABI flags</p>
<p>among object files in the linker.</p>
<p><b>Operating System</b></p>
<p>This option category is contained within<b> Target</b>.</p>
<p>These options are only available when your project specifies an embedded operating</p>
<p>system. Additionally, some of these options are only relevant when you are creating</p>
<p>ThreadX or INTEGRITY projects.</p>
<p><b>Additional System Library</b></p>
<p>Specifies an alternate system library, which is able to override parts of the default</p>
<p>system library (<b>libsys</b>).<b> -syslib</b> can be used to allow an operating system to integrate</p>
<p>with the C library without modifying the system library. The equivalent driver</p>
<p>option is:</p>
<p>â¢</p>
<p><b>-syslib=<i>library</b></i></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>158</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>OS Directory</b></p>
<p>Specifies the root of the operating system distribution. If you plan to work on your</p>
<p>project with both Windows and Linux/Solaris hosts, we recommend that you use</p>
<p>forward slashes (</p>
<p>/</p>
<p>) in the path. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-os_dir<i> directory</b></i></p>
<p><b>Event Logging</b></p>
<p>This option is available for ThreadX projects only.</p>
<p>Controls<i> event logging</i>, which collects event data for viewing and analysis in the</p>
<p>MULTI EventAnalyzer (see the documentation about viewing trace events in the</p>
<p>EventAnalyzer in the<i> MULTI: Debugging</i> book). Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-event_logging</b>) â Enables event logging by defining the</p>
<p>TX_ENABLE_EVENT_LOGGING</p>
<p>preprocessor symbol and linking with the<b> txe.a</b></p>
<p>ThreadX library.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_event_logging</b>) â [default] Links with the standard<b> tx.a</b> ThreadX</p>
<p>library.</p>
<p><b>Create S-Record File Image</b></p>
<p>Creates an S-Record file image. For more information, see âThe gsrec Utility</p>
<p>Programâ on page 594. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-srec</b></p>
<p><i>159</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Operating System</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Project Options</b></p>
<p>This is a top-level option category.</p>
<p>These options allow you to control basic configuration settings for your project,</p>
<p>such as source, output and include directories.</p>
<p>For additional, more specialized options, see âProject Optionsâ on page 274.</p>
<p><b>Object File Output Directory</b></p>
<p>Puts object files into the specified<i> directory</i>, which is often a subdirectory of the</p>
<p>current working directory. Along with the object files, the assembly listings,</p>
<p>debugging information files, inliner files, and other intermediate files that have the</p>
<p>same base name as the object file but a different suffix are also put into this directory.</p>
<p>Note that the output of the linker and the output of the archiver are never put into</p>
<p>the object file output directory. If this option is not specified, the object files will</p>
<p>be put into the current working directory.</p>
<p>Multiple projects may not share an object directory.</p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-object_dir=<i>directory</b></i></p>
<p><b>Emulate Behaviors of a Specific Compiler Version</b></p>
<p>Specifies a previous version of the compiler in order to emulate specific behaviors</p>
<p>for backwards compatibility. Not all behaviors are emulated; additional warnings</p>
<p>may need to be suppressed or enabled for compatibility. Note that unless Green</p>
<p>Hills Technical Support instructs you to do otherwise, you should not change the</p>
<p>default<b> -act_like</b> setting for products (such as INTEGRITY) in which it is already</p>
<p>set.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>5.0</b> (<b>-act_like=5.0</b>) â Act similarly to MULTI 5.0.</p>
<p>â¢</p>
<p><b>5.2</b> (<b>-act_like=5.2</b>) â Act similarly to MULTI 5.2.</p>
<p>â¢</p>
<p><b>2012.1</b> (<b>-act_like=2012.1</b>) â Act similarly to Green Hills Compiler 2012.1.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>160</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>2012.5</b> (<b>-act_like=2012.5</b>) â Act similarly to Green Hills Compiler 2012.5.</p>
<p>â¢</p>
<p><b>2013.1</b> (<b>-act_like=2013.1</b>) â Act similarly to Green Hills Compiler 2013.1.</p>
<p>â¢</p>
<p><b>2013.5</b> (<b>-act_like=2013.5</b>) â Act similarly to Green Hills Compiler 2013.5.</p>
<p>â¢</p>
<p><b>2014.1</b> (<b>-act_like=2014.1</b>) â Act similarly to Green Hills Compiler 2014.1.</p>
<p>â¢</p>
<p><b>2015.1</b> (<b>-act_like=2015.1</b>) â Act similarly to Green Hills Compiler 2015.1.</p>
<p>â¢</p>
<p><b>Latest</b> (<b>-act_like=latest</b>) â [default] Do not emulate previous behavior.</p>
<p><b>Source Root</b></p>
<p>Specifies a source root for use by the MULTI Debugger<b> sourceroot</b> command (see</p>
<p>MULTI: Debugging Command Reference). The Debugger resolves paths relative</p>
<p>to this root. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-dbg_source_root<i> path</b></i></p>
<p><b>Include Directories</b></p>
<p>Specifies a<i> directory</i> in which the compiler should search for header files. The</p>
<p>equivalent driver option is:</p>
<p>â¢</p>
<p><b>-I<i>directory</b></i></p>
<p>When the compiler processes source files that have</p>
<p>#include &quot;<i>header_file</i>&quot;</p>
<p>or</p>
<p>#include &lt;<i>header_file</i>&gt;</p>
<p>directives, it looks for<i> header_file</i> in any directories</p>
<p>specified with this option. You can specify multiple directories, and the compiler</p>
<p>will search them in the order in which they are specified. If the source file's</p>
<p>#include</p>
<p>directive declares a full path to the header file, then the compiler ignores</p>
<p>any directories specified with this option.</p>
<p>For a detailed discussion of how the compiler searches for included files, see</p>
<p>âInstructing the Compiler to Search for Your Headersâ on page 76.</p>
<p>Do not use this option to specify the location of Green Hills header files. The driver</p>
<p>selects these files automatically, based on other options.</p>
<p><i>161</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Source Root</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Library Directories</b></p>
<p>Specifies a<i> directory</i> in which the linker searches for libraries specified by the<b> -l</b></p>
<p>option. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-L<i>directory</b></i></p>
<p>All<b> -L</b> options on the command line are processed before the linker searches for</p>
<p>the libraries specified by<b> -l</b>. If you use this option multiple times, the builder searches</p>
<p>directories in the order in which they appear on the command line.</p>
<p>If you are not using the default startup code, note that this option changes only the</p>
<p>search path for libraries. This means that the linker takes<b> crt0.o</b> from the default</p>
<p>location, even if it finds<b> libstartup.a</b> and<b> libsys.a</b> in another specified location. For</p>
<p>more information about how to configure your project to use custom startup code,</p>
<p>see the documentation about settings for Stand-Alone programs in the<i> MULTI:</i></p>
<p><i>Managing Projects and Configuring the IDE</i> book.</p>
<p>Do not use this option to specify the location of Green Hills libraries. The driver</p>
<p>selects these libraries automatically, based on other options.</p>
<p><b>Libraries</b></p>
<p>Specifies a<i> library</i> for the builder to link against. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-l<i>name</b></i></p>
<p>If<i> name</i> does not have an extension or directory path, it is assumed to be an</p>
<p>abbreviation for<b> lib<i>name</i>.a</b>. If<i> name</i> does not have a directory path, the driver and</p>
<p>linker search for<b> lib<i>name</i>.a</b> in the directories specified by the<b> -L<i>dir</b></i> option in the</p>
<p>order that the<b> -L</b> options were specified, followed by a list of default directories.</p>
<p>For example, to specify a library</p>
<p>libfoo.a</p>
<p>that exists in a default directory, use:</p>
<p>-lfoo</p>
<p>If<i> name</i> has a directory path,<i> name</i> is assumed to be the complete filename of a</p>
<p>library or object file that is passed directly to the linker without the<b> -l</b> option.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>162</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>You can specify multiple libraries, and they will be linked against in the order</p>
<p>specified. When using the driver, each library must be specified with its own<b> -l</b></p>
<p>option, for example:</p>
<p>-lfoo -lbar -lbaz</p>
<p>To prevent multiply defined symbols, it is recommended that you list your source</p>
<p>files on the command line first, and then any<b> -l<i>library</b></i> libraries.</p>
<p>Do not use this option to specify the location of Green Hills libraries. The driver</p>
<p>selects these libraries automatically, based on other options.</p>
<p><b>Output Filename</b></p>
<p>Names the generated output file. The output file type (for example, a library or an</p>
<p>assembly file) depends on the other options that have been specified. The builder</p>
<p>enforces specific suffixes for some types of output files. This option has no effect</p>
<p>when set on a Top Project. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-o<i> filename</b></i></p>
<p>Unless there is a single input file on the command line, you cannot use<b> -o</b> with<b> -c</b>,</p>
<p><b>-E</b>,<b> -P</b>,<b> -Q</b>, or<b> -S</b>.</p>
<p><b>Source Directories Relative to This File</b></p>
<p>Specifies a<i> directory</i> in which the Builder should search for source files. The syntax</p>
<p>for this option is:</p>
<p>â¢</p>
<p><b>:sourceDir=<i>directory</b></i></p>
<p>The Builder searches for source files in the same directory as the project file that</p>
<p>specifies them before searching directories specified by<b> :sourceDir</b>.</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><i>163</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Output Filename</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Intermediate Output Directory Relative to Top-Level Project</b></p>
<p>Specifies the path where object files (and, in addition, any custom output file types)</p>
<p>are written to, relative to the location of your Top Project (usually<b> default.gpj</b>).</p>
<p>The syntax for this option is:</p>
<p>â¢</p>
<p><b>:outputDir=<i>directory</b></i></p>
<p>This option is most useful for custom tools that do not allow you to specify a</p>
<p>directory for intermediate output. For stand-alone projects that use only the Green</p>
<p>Hills Compiler Driver, use<b> -object_dir</b> instead.<b> -object_dir</b> overrides this option.</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>164</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Optimization Options</b></p>
<p>This is a top-level option category.</p>
<p>This section covers the wide range of optimizations Green Hills provides to help</p>
<p>you produce smaller and/or faster executables.</p>
<p><b>Optimization Strategy</b></p>
<p>Specifies the high-level optimization strategy that MULTI uses when compiling</p>
<p>your project. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Maximum Debugging And No Inlining</b> (<b>-Omaxdebug</b>) â Disables inlining</p>
<p>and all optimizations.</p>
<p>â</p>
<p><i>Debugging ability</i> â excellent</p>
<p>â</p>
<p><i>Code size and speed</i> â not optimized</p>
<p>â</p>
<p><i>Compilation speed</i> â moderately fast</p>
<p>â</p>
<p><i>Intended use</i> â development for code that has a lot of inline functions</p>
<p>â¢</p>
<p><b>Maximum Debugging And Limited Optimizations</b> (<b>-Omoredebug</b>) â</p>
<p>[default] Enables optimizations that do not affect debugging. This optimization</p>
<p>strategy does not allow the selection of individual optimizations.</p>
<p>â</p>
<p><i>Debugging ability</i> â excellent (except for inline functions)</p>
<p>â</p>
<p><i>Code size and speed</i> â slightly optimized</p>
<p>â</p>
<p><i>Compilation speed</i> â moderately fast</p>
<p>â</p>
<p><i>Intended use</i> â development; production for projects that are not size</p>
<p>restricted and that use the same builds as development</p>
<p>â¢</p>
<p><b>Optimize for Debuggability</b> (<b>-Odebug</b>) â Enables optimizations that do not</p>
<p>affect debugging. This optimization strategy does not allow the selection of</p>
<p>individual optimizations.</p>
<p>â</p>
<p><i>Debugging ability</i> â good (debug information is unavailable in rare cases)</p>
<p>â</p>
<p><i>Code size and speed</i> â moderately optimized</p>
<p>â</p>
<p><i>Compilation speed</i> â fast</p>
<p>â</p>
<p><i>Intended use</i> â development; production for projects that are not size</p>
<p>restricted and that use the same builds as development</p>
<p><i>165</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Optimization Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Optimize for General Use</b> (<b>-Ogeneral</b> or<b> -O</b>) â Enables optimizations that</p>
<p>improve both size and performance.</p>
<p>â</p>
<p><i>Debugging ability</i> â moderate (debug information is occasionally</p>
<p>inaccurate)</p>
<p>â</p>
<p><i>Code size and speed</i> â optimal for general performance</p>
<p>â</p>
<p><i>Compilation speed</i> â moderate</p>
<p>â</p>
<p><i>Intended use</i> â production, when speed and size are equally important</p>
<p>â¢</p>
<p><b>Optimize for Size</b> (<b>-Osize</b>) â Enables optimizations that improve both size</p>
<p>and performance, and additional optimizations that improve code size at the</p>
<p>expense of performance. When using this strategy, apply it as globally as</p>
<p>possible. The<b> -Ospace</b> option is equivalent to<b> -Osize</b>.</p>
<p>â</p>
<p><i>Debugging ability</i> â moderate (debug information is occasionally</p>
<p>inaccurate)</p>
<p>â</p>
<p><i>Code size and speed</i> â optimal size, moderately fast</p>
<p>â</p>
<p><i>Compilation speed</i> â moderate</p>
<p>â</p>
<p><i>Intended use</i> â production, for size-restricted projects</p>
<p>â¢</p>
<p><b>Optimize for Speed</b> (<b>-Ospeed</b>) â Enables optimizations that improve both</p>
<p>size and performance, and additional optimizations that improve performance</p>
<p>at the expense of size. We recommend that you apply this strategy only for</p>
<p>files and functions that use the most program execution time. You can then set</p>
<p>a different optimization strategy globally (on your project file) to get multiple</p>
<p>benefits.</p>
<p>â</p>
<p><i>Debugging ability</i> â poor</p>
<p>â</p>
<p><i>Code size and speed</i> â moderately small, optimal speed</p>
<p>â</p>
<p><i>Compilation speed</i> â moderate</p>
<p>â</p>
<p><i>Intended use</i> â production, when speed is more important than size</p>
<p>â¢</p>
<p><b>No Optimizations</b> (<b>-Onone</b>) â Disables all optimizations and provides the</p>
<p>most straightforward code generation. Inlining of explicitly marked functions</p>
<p>is performed at this level.</p>
<p>â</p>
<p><i>Debugging ability</i> â good</p>
<p>â</p>
<p><i>Code size and speed</i> â not optimized</p>
<p>â</p>
<p><i>Compilation speed</i> â fastest</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>166</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â</p>
<p><i>Intended use</i> â when compilation speed is your highest priority, or when</p>
<p>instructed by Green Hills support</p>
<p>When deciding how to optimize your program, always begin by selecting the</p>
<p>optimization strategy that is the best fit for your project. If you must fine-tune a</p>
<p>strategy to your specifications, see Chapter 4, âOptimizing Your Programsâ</p>
<p>on page 323 and âOptimization Optionsâ on page 289.</p>
<p><b>Intermodule Inlining</b></p>
<p>Enables<i> two-pass inlining</i>. If no optimization strategy is selected, this option enables</p>
<p><b>-Ospeed</b>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-OI</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoinline</b>) â [default]</p>
<p>For more information, see âInlining Optimizationsâ on page 324.</p>
<p><b>Linker Optimizations</b></p>
<p>Controls the linker optimizations listed in âLinker Optimizationsâ on page 243.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Olink</b>) â The linker optimizations that are enabled depend upon whether</p>
<p>you are optimizing for speed or size. Many of these optimizations make complex</p>
<p>changes to your code, and might slow down the link stage, be harder to debug,</p>
<p>or have other drawbacks. To disable individual linker optimizations, set them</p>
<p>to<b> Off</b> in combination with this option.</p>
<p><b>-Olink</b> implicitly enables<b> -delete</b>. When building shared objects, this could</p>
<p>result in unresolved symbols. For more information about linker-specific</p>
<p>options, see âLinker-Specific Optionsâ on page 471.</p>
<p>For more information about<b> -delete</b>, see âDeleting Unused Functionsâ</p>
<p>on page 507.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onolink</b>) â [default]</p>
<p><i>167</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Intermodule Inlining</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Interprocedural Optimizations</b></p>
<p>Performs optimizations based on all available functions, unlike most other</p>
<p>optimizations that only consider one function at a time. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Wholeprogram</b> (<b>-Owholeprogram</b>) â Enabling wholeprogram optimizations</p>
<p>allows program control and data flow to be analyzed at a high level. Speed and</p>
<p>size optimizations such as one call-site inlining, interprocedural constant</p>
<p>propagation and dead code elimination, and interprocedural alias analysis are</p>
<p>performed. This option can improve program speed and size, often</p>
<p>simultaneously. If no optimization strategy is selected, this option enables</p>
<p><b>-Ospeed</b>.</p>
<p>â¢</p>
<p><b>Interprocedural</b> (<b>-Ointerproc</b>) â Enabling interprocedural optimizations</p>
<p>allows optimizations based on knowledge of functions being called, such as</p>
<p>interprocedural alias analysis. Unlike<b> -Owholeprogram</b>,<b> -Ointerproc</b> does</p>
<p>not require that the entire program is available during compilation. However,</p>
<p>a strict subset of the optimizations from<b> -Owholeprogram</b> are applied with</p>
<p><b>-Ointerproc</b>. If no optimization strategy is selected, this option enables</p>
<p><b>-Ospeed</b>.</p>
<p>â¢</p>
<p><b>Analysis without optimizations</b> (<b>-Oip_analysis_only</b>) â Performs</p>
<p>interprocedural analysis but does not apply any optimizations.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipa</b>) â [default] Disables all interprocedural optimizations.</p>
<p>For more information about using interprocedural optimizations, see âInterprocedural</p>
<p>Optimizationsâ on page 338.</p>
<p><b>Optimization Scope</b></p>
<p>This option category is contained within<b> Optimization</b>.</p>
<p>These options provide general control over the major optimizations.</p>
<p><b>Pipeline and Peephole Scope</b></p>
<p>Restricts the scope of optimizations to ensure the retention of debugging information.</p>
<p>Permitted settings for this option are:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>168</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Restrict peephole optimization scope to increase debuggability</b></p>
<p>(<b>-Olimit=peephole</b>)</p>
<p>â¢</p>
<p><b>Restrict pipeline optimization scope to increase debuggability</b></p>
<p>(<b>-Olimit=pipeline</b>)</p>
<p><b>Inline Larger Functions</b></p>
<p>Controls whether the compiler will consider larger functions when<b> -OI</b> is enabled.</p>
<p>If no optimization strategy is selected, this option enables<b> -Ospeed</b>. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-OB</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onobig</b>) â [default] You can use</p>
<p>-Onobig</p>
<p>in a MULTI Project (<b>.gpj</b>)</p>
<p>file, but there is no equivalent driver option.</p>
<p>For more information, see âVarying Inlining Thresholdsâ on page 331.</p>
<p><b>Unroll Larger Loops</b></p>
<p>Controls the size of the loops that the compiler will consider for unrolling. Has no</p>
<p>effect unless loop unrolling is enabled. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Ounrollbig</b>) â Consider larger loops for unrolling.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onounrollbig</b>)</p>
<p>For more information, see âLoop Unrollingâ on page 350.</p>
<p><b>Maximize Optimizations</b></p>
<p>Controls the aggressiveness with which the compiler will pursue optimizations,</p>
<p>without regard for compile time. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Omax</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onomax</b>) â [default]</p>
<p><i>169</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Optimization Scope</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For example, to optimize most aggressively for size, without regard for compilation</p>
<p>time, set<b> OptimizationâOptimization Strategy</b> to<b> Optimize for Size</b> (<b>-Osize</b>)</p>
<p>and set this option to<b> On</b>.</p>
<p><b>Symbols Referenced Externally</b></p>
<p>This option should only be used if you are optimizing with wholeprogram</p>
<p>optimizations, and the entire program is not available during each compilation. This</p>
<p>often occurs if you have assembly files or other code that is linked in. Because</p>
<p>wholeprogram optimizations rely on the knowledge of all function and variable</p>
<p>uses, if a function or variable is referenced externally (for example, from an assembly</p>
<p>file) you must list that symbol with<b> -external</b>.</p>
<p>If you are using linker optimizations and want to prevent a function from being</p>
<p>deleted, you may also need to pass the<b> -keep</b> linker option. For more information</p>
<p>about linker-specific options, see âLinker-Specific Optionsâ on page 471.</p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-external=<i>function1</i> -external=<i>function2</i> -external=<i>variable1</b></i></p>
<p><i>function1</i>,<i> function2</i>, and<i> variable1</i> are functions and variables in the source code</p>
<p>that can be referenced externally.</p>
<p><b>Files Listing External Symbols</b></p>
<p>Takes a file listing externally visible symbols rather than taking the symbol names</p>
<p>explicitly. If you have many symbols that can be referenced externally, you might</p>
<p>want to list them in a file and pass this file to the compiler rather than specifying</p>
<p>each symbol as shown above.</p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-external_file=<i>file1</i> -external_file=<i>file2</b></i></p>
<p><i>file1</i> and<i> file2</i> are the complete paths of the files listing symbols that can be</p>
<p>referenced externally.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>170</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>These files can contain comma- or white-space separated symbol names listing</p>
<p>those symbols that are externally visible. Additionally, these files can be composed</p>
<p>of global symbols defined or used in object files and libraries that are not specified</p>
<p>during compilation, but are linked into the final executable. A list of these symbols</p>
<p>can be generated by using the<b> gnm</b> utility (see âThe gnm Utility Programâ</p>
<p>on page 581 for more information).</p>
<p><b>IP One-Site Inlining</b></p>
<p>Inlines functions that only have one call-site. This option is only meaningful if you</p>
<p>pass the<b> -Ointerproc</b> or<b> -Owholeprogram</b> option. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oiponesiteinlining</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoiponesiteinlining</b>)</p>
<p><b>IP Delete Functions</b></p>
<p>Deletes unreachable functions. With or without this option enabled, functions may</p>
<p>be removed if all of their uses are inlined. This option is only meaningful if you</p>
<p>pass the<b> -Ointerproc</b> or<b> -Owholeprogram</b> option. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipdeletefunctions</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipdeletefunctions</b>)</p>
<p><b>IP Delete Globals</b></p>
<p>Deletes constant-value global variables that are not indirectly referenced. This option</p>
<p>is only meaningful if you pass the<b> -Owholeprogram</b> option. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipdeleteglobals</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipdeleteglobals</b>)</p>
<p><i>171</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Optimization Scope</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>IP Localize Globals</b></p>
<p>Replaces some global variables using local register variables. This option is only</p>
<p>meaningful if you pass the<b> -Ointerproc</b> or<b> -Owholeprogram</b> option, and is most</p>
<p>effective with<b> -Owholeprogram</b>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oiplocalizeglobals</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoiplocalizeglobals</b>)</p>
<p><b>IP Constant Globals</b></p>
<p>When a global variable is initialized to a constant value and never changed, and the</p>
<p>variable is not indirectly referenced, the initial value is propagated into the uses of</p>
<p>the variable. This option is only meaningful if you pass the<b> -Ointerproc</b> or</p>
<p><b>-Owholeprogram</b> option. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipconstglobals</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipconstglobals</b>)</p>
<p><b>IP Small Inlining</b></p>
<p>Functions are inlined when the inlined size might be less than the size of the call</p>
<p>to the function. This option is only meaningful if you pass the<b> -Ointerproc</b> or</p>
<p><b>-Owholeprogram</b> option. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipsmallinlining</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipsmallinlining</b>)</p>
<p><b>IP Constant Propagation</b></p>
<p>If a parameter of a function is always set to the same constant value by callers, this</p>
<p>optimization treats uses of that parameter in that function as a constant instead of</p>
<p>setting the parameter in callers. This option is only meaningful if you pass the</p>
<p><b>-Owholeprogram</b> option. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipconstprop</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipconstprop</b>)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>172</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>IP Remove Parameters</b></p>
<p>When certain parameters are not required, the parameters are removed, and function</p>
<p>calls do not pass arguments for them. This option is only meaningful if you pass</p>
<p>the<b> -Owholeprogram</b> option. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipremoveparams</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipremoveparams</b>)</p>
<p><b>IP Limit Inlining</b></p>
<p>Limits the amount of inlining performed by interprocedural optimizations. This</p>
<p>option is only meaningful if you pass the<b> -Ointerproc</b> or<b> -Owholeprogram</b> option.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oiplimitinlining</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoiplimitinlining</b>)</p>
<p><b>IP Constant Returns</b></p>
<p>When functions return constant values, those values can be propagated to the caller.</p>
<p>This option is only meaningful if you pass the<b> -Ointerproc</b> or<b> -Owholeprogram</b></p>
<p>option. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipconstantreturns</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipconstantreturns</b>)</p>
<p><b>IP Remove Returns</b></p>
<p>When the result of a function call is not required, the return statement is removed.</p>
<p>This option is only meaningful if you pass the<b> -Owholeprogram</b> option. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipremovereturns</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipremovereturns</b>)</p>
<p><i>173</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Optimization Scope</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>IP Alias Reads</b></p>
<p>Determines what memory can be read by function calls. This option is only</p>
<p>meaningful if you pass the<b> -Ointerproc</b> or<b> -Owholeprogram</b> option. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipaliasreads</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipaliasreads</b>)</p>
<p><b>IP Alias Writes</b></p>
<p>Determines what memory can be written by function calls. This option is only</p>
<p>meaningful if you pass the<b> -Ointerproc</b> or<b> -Owholeprogram</b> option. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipaliaswrites</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipaliaswrites</b>)</p>
<p><b>IP Alias Lib Functions</b></p>
<p>Performs interprocedural alias analysis on some common library functions such as</p>
<p>printf</p>
<p>,</p>
<p>strlen</p>
<p>, and</p>
<p>fopen</p>
<p>. This option is only meaningful if you pass the</p>
<p><b>-Ointerproc</b> or<b> -Owholeprogram</b> option. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oipaliaslibfuncs</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoipaliaslibfuncs</b>)</p>
<p><b>Individual Functions</b></p>
<p>This option category is contained within<b> Optimization</b>.</p>
<p>These options allow you to specify individual functions for optimization.</p>
<p><b>Optimize Specific Functions for Speed</b></p>
<p>Prefer speed over size when optimizing specific functions. The equivalent driver</p>
<p>option is:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>174</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>--fast=<i>function1</i>[,<i>function2</i>â¦]</b></p>
<p>This option has no effect unless it is used with an<b> OptimizationâOptimization</b></p>
<p><b>Strategy</b> other than<b> -Onone</b>,<b> -Omoredebug</b>,<b> -Odebug</b>, or<b> -Omaxdebug</b>. The speed</p>
<p>optimizations enabled by</p>
<p>--fast</p>
<p>will not always be identical to those enabled by</p>
<p>-Ospeed</p>
<p>.</p>
<p><b>Optimize Specific Functions for Size</b></p>
<p>Prefer size over speed when optimizing specific functions. The equivalent driver</p>
<p>option is:</p>
<p>â¢</p>
<p><b>--small=<i>function1</i>[,<i>function2</i>â¦]</b></p>
<p>This option has no effect unless it is used with an<b> OptimizationâOptimization</b></p>
<p><b>Strategy</b> other than<b> -Onone</b>,<b> -Omoredebug</b>,<b> -Odebug</b>, or<b> -Omaxdebug</b>. The size</p>
<p>optimizations enabled by</p>
<p>--small</p>
<p>will not always be identical to those enabled</p>
<p>by</p>
<p>-Osize</p>
<p>.</p>
<p><b>Inline Specific Functions</b></p>
<p>Enables two-pass inlining for specific functions. If not optimization strategy is</p>
<p>selected, this option enables<b> -Ospeed</b>. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-OI=<i>function1</i>[,<i>function2</i>...]</b></p>
<p>For more information, see âInlining Optimizationsâ on page 324.</p>
<p><b>Loop Optimize Specific Functions</b></p>
<p>Enables loop optimizations for individual functions. If no optimization strategy is</p>
<p>selected, this option enables<b> -Ospeed</b>. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-OL=<i>function1</i>[,<i>function2</i>...]</b></p>
<p>For more information, see âLoop Optimizationsâ on page 347.</p>
<p><i>175</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Individual Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Debugging Options</b></p>
<p>This is a top-level option category.</p>
<p>These options control the generation of debugging and profiling information. For</p>
<p>more information, see âGenerating Debugging Informationâ on page 55 and</p>
<p>âObtaining Profiling Informationâ on page 63.</p>
<p>For additional, more specialized options, see âDebugging Optionsâ on page 295.</p>
<p><b>Debugging Level</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>MULTI</b> (<b>-G</b>) â Generates source-level debugging information, and allows</p>
<p>procedure calls from the MULTI Debugger's command line.</p>
<p>â¢</p>
<p><b>Plain</b> (<b>-g</b>) â Generates source-level debugging information, but does not allow</p>
<p>procedure calls.</p>
<p>â¢</p>
<p><b>Stack Trace</b> (<b>-gs</b>) â Generates minimal debugging information sufficient for</p>
<p>MULTI to perform stack traces, but not sufficient for source-level debugging.</p>
<p>The Green Hills libraries are compiled with this option.</p>
<p>â¢</p>
<p><b>None</b> (<b>--no_debug</b>) â [default] Generates no debugging information.</p>
<p><b>Function Entry/Exit Logging</b></p>
<p>Controls how the linker treats function entry/exit instrumentation. Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>Enable</b> (<b>-record_entry_exit_history</b>) â Function entry/exit instrumentation</p>
<p>is not replaced or removed by the linker.</p>
<p>â¢</p>
<p><b>Disable</b> (<b>-mute_entry_exit_history</b>) â Function entry/exit instrumentation</p>
<p>is disabled by the linker and replaced with</p>
<p>NOP</p>
<p>instructions.</p>
<p>â¢</p>
<p><b>Strip</b> (<b>-strip_entry_exit_history</b>) â [default] Function entry/exit</p>
<p>instrumentation is disabled by the linker and stripped from the executable.</p>
<p>(Stripped code is similar though not identical to code without function entry/exit</p>
<p>instrumentation.)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>176</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For more information about function entry/exit history, see âFunction Entry/Exit</p>
<p>Historyâ on page 62.</p>
<p><b>EAGLE Logging</b></p>
<p>Controls the global inclusion of EAGLE features at link time. Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-strip_eagle_log</b>) â [default] EAGLE logging is stripped from the code</p>
<p>by the linker. (Stripped code is similar though not identical to code without</p>
<p>EAGLE logging.).</p>
<p>â¢</p>
<p><b>On</b> (<b>-enable_eagle_log</b>) â Enables EAGLE logging.</p>
<p><b>Profiling - Block Coverage</b></p>
<p>Controls<i> block coverage</i> profiling, which records a flag or a count for each basic</p>
<p>block in your program. A basic block is a set of instructions for which if the first</p>
<p>instruction is executed, the remaining instructions in the block must also be executed.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Flag</b> (<b>-coverage=flag</b>) â Records whether or not each block is executed.</p>
<p>â¢</p>
<p><b>Count (32-bit counters)</b> (<b>-coverage=count</b>) â Records how many times each</p>
<p>block is executed using a 32-bit counter.</p>
<p>â¢</p>
<p><b>Count (64-bit counters)</b> (<b>-coverage=count64</b>) â Records how many times</p>
<p>each block is executed using a 64-bit counter. This option is not available with</p>
<p>MULTI 6 or older.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-coverage=none</b>) â [default]</p>
<p>Block coverage profiling does not use locking or an atomic increment to achieve</p>
<p>thread safety. If you use count profiling with multi-threaded code or in interrupt</p>
<p>handlers a block's counter may be inaccurate if two increments occur simultaneously.</p>
<p>Flag profiling is thread-safe.</p>
<p>For more information, see âEnabling Instrumented Coverage or Performance</p>
<p>Profilingâ on page 64.</p>
<p><i>177</i></p>
<p><i>Green Hills Software</i></p>
<p><i>EAGLE Logging</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Profiling - Target-Based Timing</b></p>
<p>Controls<i> timing</i> profiling, which records the time spent in each function. You should</p>
<p>only use this option in stand-alone and u-velOSity projects. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-timer_profile</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_timer_profile</b>) â [default]</p>
<p>Enabling target-based timing profiling requires that timer code be present and</p>
<p>running on the target. For more information, see âEnabling Sampled Profilingâ</p>
<p>on page 69.</p>
<p><b>Note</b></p>
<p>To obtain PC samples for a Linux native application, you must link with</p>
<p>the<b> libmulti.a</b> library.</p>
<p><b>Run-Time Error Checks</b></p>
<p>Controls run-time error checking, which can be helpful during a debugging session,</p>
<p>but which increases the size and reduces the speed of your application. Run-time</p>
<p>error checks catch many occurrences of the common errors described below. The</p>
<p>syntax for this option is:</p>
<p><b>-check=</b></p>
<p><i>type</i>[,<i>type</i>]</p>
<p>â¦</p>
<p><b>-check=</b></p>
<p><i>type</i></p>
<p>[<b>-check=</b></p>
<p><i>type</i></p>
<p>]â¦</p>
<p>Enables run-time error checks for each specified<i> type</i>.</p>
<p><b>-check=</b></p>
<p>all[,no<i>type</i>]</p>
<p>â¦</p>
<p><b>-check=</b></p>
<p>all</p>
<p>[<b>-check=</b></p>
<p>no<i>type</i></p>
<p>]â¦</p>
<p>Enables all run-time error checks. To enable all checks except those of a certain</p>
<p>type, follow this option with</p>
<p>,no<i>type</i></p>
<p>or</p>
<p>-check=no<i>type</i></p>
<p>.</p>
<p>Run-time error checks are also enabled by MISRA 2004 rule 12.8 and 21.1, and</p>
<p>MISRA 1998 rules 4, 38, and 107. The various checks generate warnings or errors</p>
<p>as specified below. Permitted values for<i> type</i> are:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>178</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>All</b> (<b>-check=all</b>) â Enables all run-time error checks. This option does not</p>
<p>affect run-time memory checks.</p>
<p>â¢</p>
<p><b>None</b> (<b>-check=none</b>) â [default] Disables all run-time error checks. This</p>
<p>option does not affect run-time memory checks.</p>
<p>â¢</p>
<p><b>Assignment Bounds</b> (<b>-check=assignbound</b>) â Generates a warning if a value</p>
<p>assigned to an integral or enumerated object is out-of-bounds for the object</p>
<p>being assigned to. No warning is issued when an assignment is made to a</p>
<p>sparsely populated</p>
<p>enum</p>
<p>if the assignment is within the range of the</p>
<p>enum</p>
<p>, but</p>
<p>is not one of the defined values. For example:</p>
<p>enum E { one=1, three=3 } e;</p>
<p>void func(void)</p>
<p>{</p>
<p>e = (enum E)0; /* warning */</p>
<p>e = (enum E)1; /* no warning */</p>
<p>e = (enum E)2; /* no warning */</p>
<p>e = (enum E)3; /* no warning */</p>
<p>e = (enum E)4; /* warning */</p>
<p>}</p>
<p>â¢</p>
<p><b>Array Bounds</b> (<b>-check=bounds</b>) â Generates an error if an array is accessed</p>
<p>with an invalid index. Only arrays whose bounds are known at compile time</p>
<p>are checked; incomplete and variable-length arrays (VLAs) are not checked.</p>
<p>The compiler checks each individual array index separately. For example:</p>
<p>int a[2][3];</p>
<p>a[0][3] = 0; // produces a run-time error</p>
<p>a[1][0] = 0; // equivalent behavior, no run-time error</p>
<p>This option does not output a run-time check for the following example, because</p>
<p>the</p>
<p>arr</p>
<p>parameter's type decays into</p>
<p>int*</p>
<p>and could legitimately point to an</p>
<p>array of any size:</p>
<p>int func(int arr[20], int i)</p>
<p>{</p>
<p>return arr[i];</p>
<p>}</p>
<p><i>179</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Run-Time Error Checks</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Case Label Bounds</b> (<b>-check=switch</b>) â Generates a warning if the</p>
<p>switch</p>
<p>expression does not match any of the</p>
<p>case</p>
<p>labels. This does not apply when</p>
<p>a default</p>
<p>case</p>
<p>label is used.</p>
<p>â¢</p>
<p><b>Divide by Zero</b> (<b>-check=zerodivide</b>) â Generates an error indicating that a</p>
<p>divide by zero occurred and then terminates the program. This option</p>
<p>instruments both integer and floating-point divides.</p>
<p>â¢</p>
<p><b>Nil Pointer Dereference</b> (<b>-check=nilderef</b>) â Generates an error for</p>
<p>dereferences of null pointers.</p>
<p>â¢</p>
<p><b>Write to Watchpoint</b> (<b>-check=watch</b>) â Instruments your code to watch</p>
<p>writes to one arbitrary address in memory. Use this check when your target</p>
<p>does not support hardware breakpoints. Specify the watchpoint address at run</p>
<p>time with the<b> watchpoint</b> command. For more information about watchpoints,</p>
<p>see the documentation about breakpoint commands in the<i> MULTI: Debugging</i></p>
<p><i>Command Reference</i> book.</p>
<p>To enable or disable all the checks when using the Builder, use the<b> All</b> toggle switch</p>
<p>at the bottom of the dialog box. When using the driver, pass the option<b> -check=all</b></p>
<p>or<b> -check=none</b>.</p>
<p><b>Note</b></p>
<p><b>-check=assignbound</b> and<b> -check=switch</b> produce run-time errors on</p>
<p>code that is legal in C and C++, but may be considered to have bad style.</p>
<p><b>Run-Time Memory Checks</b></p>
<p>Controls run-time memory checking. Note that this option is not available for</p>
<p>projects built with PIC or PID. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>General (Allocations Only)</b> (<b>-check=alloc</b>) â Selects a special version of</p>
<p>memory allocation library routines, including</p>
<p>malloc</p>
<p>and</p>
<p>free</p>
<p>. These library</p>
<p>routines detect a limited number of memory allocation problems, such as freeing</p>
<p>an object that has not been allocated. This setting only changes the way the</p>
<p>program is linked and does not change the code produced by the compiler.</p>
<p>â¢</p>
<p><b>Intensive</b> (<b>-check=memory</b>) â Introduces additional code in the user</p>
<p>application at each dereference of a pointer to detect a wide range of memory</p>
<p>allocation problems, including those detected by<b> -check=nilderef</b>. This setting</p>
<p>implies<b> -check=alloc</b> because the special library routines selected by that option</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>180</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>are required. To perform full memory checking on a small part of an application,</p>
<p>specify<b> -check=memory</b> when compiling the files or files of interest, and</p>
<p>specify<b> -check=alloc</b> when linking the entire program.</p>
<p>â¢</p>
<p><b>None</b> (<b>-check=nomemory</b>) â [default] Disables memory checking.</p>
<p>If<b> ProjectâEmulate Behaviors of a Specific Compiler Version</b> (<b>-act_like=</b>) is</p>
<p>set to Green Hills Compiler version 2013.5 or earlier, both forms of memory</p>
<p>checking require a frame pointer to walk the stack at run time, and imply setting</p>
<p><b>AdvancedâDebugging OptionsâForce Frame Pointer</b> to<b> On</b> (<b>-ga</b>).</p>
<p>For detailed information, see âEnabling General Memory Allocation Checkingâ</p>
<p>on page 71, âEnabling Intensive Memory Allocation Checkingâ on page 72, and</p>
<p>the documentation about viewing memory allocation information in the<i> MULTI:</i></p>
<p><i>Debugging</i> book.</p>
<p><i>181</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Run-Time Memory Checks</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Preprocessor Options</b></p>
<p>This is a top-level option category.</p>
<p>These options control the preprocessor. For information about the Green Hills</p>
<p>predefined macros, see âPredefined Macro Namesâ on page 780.</p>
<p>For additional, more specialized options, see âPreprocessor Optionsâ on page 305.</p>
<p><b>Define Preprocessor Symbol</b></p>
<p>Defines a preprocessor<i> symbol</i>, and optionally sets it to a<i> value</i>. When setting this</p>
<p>option in the<b> Edit List Option</b> window in the Project Manager, type</p>
<p><i>symbol</i>=<i>value</i></p>
<p>in the text field. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-D<i>symbol</i>[=<i>value</i>]</b></p>
<p>This is equivalent to placing the following at the top of each source file:</p>
<p>#define<i> symbol</i> [<i>value</i>]</p>
<p>-D<i>symbol</i></p>
<p>is equivalent to</p>
<p>-D<i>symbol</i>=1</p>
<p><b>Undefine Preprocessor Symbol</b></p>
<p>Undefines a preprocessor<i> symbol</i>. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-U<i>symbol</b></i></p>
<p>This is equivalent to placing the following at the top of each source file:</p>
<p>#undef<i> symbol</i></p>
<p><b>Display includes Preprocessor Directives Listing</b></p>
<p>Controls the display to standard error of a list of files opened by a</p>
<p>#include</p>
<p>directive during normal compilation. Files are compiled and linked normally.</p>
<p>Permitted settings for this option are:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>182</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>On</b> (<b>-H</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_trace_includes</b>) â [default]</p>
<p><i>183</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Display includes Preprocessor Directives Listing</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>C/C++ Compiler Options</b></p>
<p>This is a top-level option category.</p>
<p>These options control various aspects of compilation that relate directly to the C</p>
<p>and C++ languages.</p>
<p>For additional, more specialized options, see âC/C++ Compiler Optionsâ on page 308.</p>
<p><b>C Language Dialect</b></p>
<p>Controls the version of C to be accepted by the compiler. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Strict ISO C99</b> (<b>-C99</b>) â Specifies strict ISO C99. This mode is compliant</p>
<p>with ISO/IEC 9899:1999 and does not allow any non-standard constructs.</p>
<p>â¢</p>
<p><b>ISO C99</b> (<b>-c99</b>) â Specifies ISO C99. This mode provides all features of the</p>
<p>C99 language in addition to some extensions. Some non-standard constructs</p>
<p>produce warnings rather than errors.</p>
<p>â¢</p>
<p><b>Strict ANSI C</b> (<b>-ANSI</b>) â Specifies strict ANSI. This mode is compliant with</p>
<p>the ANSI X3.159-1989 standard and does not allow any non-standard constructs.</p>
<p>â¢</p>
<p><b>ANSI C</b> (<b>-ansi</b>) â [default] Specifies ANSI C with extensions. This mode</p>
<p>extends the ANSI X3.159-1989 standard with certain useful and compatible</p>
<p>constructs. For details, see âANSI Câ on page 663.</p>
<p>For details about Green Hills C and the differences between the various modes,</p>
<p>see Chapter 12, âGreen Hills Câ on page 661.</p>
<p>â¢</p>
<p><b>GNU C</b> (<b>-gcc</b>) â Specifies full GNU mode, supporting GNU features (including</p>
<p>zero size arrays, multi-line string constants, and</p>
<p>inline</p>
<p>functions) which are</p>
<p>less compatible with ANSI C. For details, see âGNU Câ on page 670.</p>
<p>â¢</p>
<p><b>GNU C99</b> (<b>-gnu99</b>) â Specifies a GNU-compatible version of C99 mode,</p>
<p>supporting many GNU features not explicitly included in ISO C99.</p>
<p>â¢</p>
<p><b>K+R C</b> (<b>-k+r</b>) â Support for K&amp;R C is deprecated and may be removed in</p>
<p>future versions of MULTI. Specifies the C version documented in<i> Kernighan</i></p>
<p><i>&amp; Ritchie, First Edition</i>, which is somewhat compatible with the portable C</p>
<p>compiler (PCC). In this mode, the compiler will accept ANSI-style prototypes.</p>
<p>For details, see âK&amp;R Câ on page 679.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>184</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>C Japanese Automotive Extensions</b></p>
<p>Controls support for the Japanese Automotive C extensions. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-japanese_automotive_c</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_japanese_automotive_c</b>) â [default]</p>
<p>For more information, see âJapanese Automotive C Extensionsâ on page 684.</p>
<p><b>C++ Language Dialect</b></p>
<p>Specifies the version of C++ to be accepted by the compiler. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>Standard C++ (Violations Give Errors)</b> (<b>--STD</b>) â Specifies C++ Strict</p>
<p>Standard Mode, which gives errors when non-Standard features are used and</p>
<p>disables features that conflict with Standard C++. For more information, see</p>
<p>âStandard C++â on page 736.</p>
<p>â¢</p>
<p><b>Standard C++ (Violations Give Warnings)</b> (<b>--std</b>) â [default] Specifies C++</p>
<p>Standard Mode, which gives warnings when non-Standard features are used</p>
<p>and disables features that conflict with Standard C++. For more information,</p>
<p>see âStandard C++â on page 736.</p>
<p>â¢</p>
<p><b>Standard C++ with ARM Extensions</b> (<b>--arm</b>) â Specifies Standard C++</p>
<p>with extensions, which extends the standard with many useful and compatible</p>
<p>constructs. For more information, see âStandard C++ with ARM Extensionsâ</p>
<p>on page 742.</p>
<p>â¢</p>
<p><b>GNU C++</b> (<b>--g++</b>) â Specifies GNU C++ mode. For more information, see</p>
<p>âGNU C++â on page 743.</p>
<p>â¢</p>
<p><b>Embedded C++</b> (<b>--e</b>) â Specifies Embedded C++. For more information, see</p>
<p>âEmbedded C++â on page 739.</p>
<p>â¢</p>
<p><b>Extended Embedded C++</b> (<b>--ee</b>) â Specifies Extended Embedded C++,</p>
<p>which adds templates, namespaces, mutable new-style casts, and the Standard</p>
<p>Template Library (STL) to Embedded C++. For more information, see</p>
<p>âExtended Embedded C++â on page 741.</p>
<p><i>185</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C Japanese Automotive Extensions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>C++ Libraries</b></p>
<p>Specifies the type of C++ libraries to use. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Standard C++ Library without Exceptions</b> (<b>--stdl</b>)</p>
<p>â¢</p>
<p><b>Standard C++ Library with Exceptions</b> (<b>--stdle</b>)</p>
<p>â¢</p>
<p><b>Extended Embedded C++ Library without Exceptions</b> (<b>--eel</b>)</p>
<p>â¢</p>
<p><b>Extended Embedded C++ Library with Exceptions</b> (<b>--eele</b>)</p>
<p>â¢</p>
<p><b>Embedded C++ Library without Exceptions</b> (<b>--el</b>)</p>
<p>â¢</p>
<p><b>Embedded C++ Library with Exceptions</b> (<b>--ele</b>)</p>
<p>The default is to use libraries equivalent to your<b> C/C++ CompilerâC++ Language</b></p>
<p><b>Dialect</b> without exceptions, and you may not specify a library that is more</p>
<p>full-featured than your<b> C/C++ CompilerâC++ Language Dialect</b>. For more</p>
<p>information, see âSpecifying C++ Librariesâ on page 735.</p>
<p><b>C++ Exception Handling</b></p>
<p>Controls support for exception handling. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--exceptions</b>) â Enables support for exception handling. Code size and</p>
<p>speed may be impacted even when exception handling is not directly used.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_exceptions</b>) â [default] Disables support for exception handling.</p>
<p><b>Allow C++ Style Slash Comments in C</b></p>
<p>Controls treatment of C++ style</p>
<p>//</p>
<p>comments. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--slash_comment</b>) â [default] C++ style</p>
<p>//</p>
<p>comments are accepted.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_slash_comment</b>) â C++ style</p>
<p>//</p>
<p>comments are not accepted and</p>
<p>generate errors.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>186</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>ANSI Aliasing Rules</b></p>
<p>Controls assumptions based on ANSI aliasing rules in the compiler. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-ansi_alias</b>) â [default] Enables ANSI aliasing rules.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_ansi_alias</b>) â Disables ANSI aliasing.</p>
<p>When this option is enabled, the compiler assumes that memory may only be</p>
<p>accessed through pointers of compatible types. This allows the compilers to generate</p>
<p>better code. Illegal casts may cause the compiler to generate code that does not</p>
<p>behave as expected. Consider the following example:</p>
<p>int inc_and_get(int *a, short *b)</p>
<p>{</p>
<p>(*a)++;</p>
<p>return *b;</p>
<p>}</p>
<p>int loc()</p>
<p>{</p>
<p>int var = 12345;</p>
<p>/* the dereference of *b inside of inc_and_get illegally aliases var */</p>
<p>return inc_and_get(&amp;var, (short *)&amp;var);</p>
<p>}</p>
<p>This may behave unexpectedly because an</p>
<p>int</p>
<p>type may not be used to access an</p>
<p>object of the</p>
<p>short</p>
<p>type.</p>
<p>Disabling this option suppresses diagnostics 1518, 1519, and 1798.</p>
<p><b>MISRA C 2004</b></p>
<p>This option category is contained within<b> C/C++ Compiler</b>.</p>
<p><b>MISRA C 2004 Rules - 1 Environment</b></p>
<p>â¢</p>
<p><b>1.1 [R] ISO 9899:1990 C conformance w/o extensions</b> (<b>--misra_2004=1.1</b>)</p>
<p>â Enables Strict ANSI C. This option enables<b> -ANSI</b>, which disables</p>
<p>recognition of many non-standard keywords and extensions. Errors issued</p>
<p>because of this check are not identified as MISRA errors, and their severities</p>
<p>are unaffected by MISRA classification or the<b> --misra_req</b> option.</p>
<p><i>187</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ANSI Aliasing Rules</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>1.2 [R] No dependencies can be placed on undefined or unspecified behavior</b></p>
<p>(<b>--misra_2004=1.2</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>1.3 [R] Code other than C must conform to the standard interface</b></p>
<p>(<b>--misra_2004=1.3</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>1.4 [R] Compiler and linker verified to support 31 significant case-sensitive</b></p>
<p><b>characters for identifiers</b> (<b>--misra_2004=1.4</b>) â Green Hills tools have no</p>
<p>set limit by default.</p>
<p>â¢</p>
<p><b>1.5 [A] Floating-point implementation is standard-compliant</b></p>
<p>(<b>--misra_2004=1.5</b>) â The Green Hills compilers use the IEEE floating-point</p>
<p>representation. This rule cannot be disabled.</p>
<p><b>MISRA C 2004 Rules - 2 Language Extensions</b></p>
<p>â¢</p>
<p><b>2.1 [R] Inline assembly only in functions or macros with no other code</b></p>
<p>(<b>--misra_2004=2.1</b>) â Enforced.</p>
<p>Associated diagnostics include 1749 and 1839.</p>
<p>â¢</p>
<p><b>2.2 [R] Use of /*...*/ comments only</b> (<b>--misra_2004=2.2</b>) â Enforced.</p>
<p>Associated diagnostics include 1876.</p>
<p>â¢</p>
<p><b>2.3 [R] No nested comments</b> (<b>--misra_2004=2.3</b>) â Enforced.</p>
<p>Associated diagnostics include 9.</p>
<p>â¢</p>
<p><b>2.4 [A] No `commented out' sections of code</b> (<b>--misra_2004=2.4</b>) â Does</p>
<p>not allow the following characters inside of a comment:</p>
<p>â</p>
<p>A semicolon followed by by a new-line character.</p>
<p>â</p>
<p>Open or closed curly braces.</p>
<p>Associated diagnostics include 1771.</p>
<p><b>MISRA C 2004 Rules - 3 Documentation</b></p>
<p>â¢</p>
<p><b>3.1 [R] Documentation of implementation-defined behavior required</b></p>
<p>(<b>--misra_2004=3.1</b>) â Not enforced.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>188</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>3.2 [R] Values of char types restricted to subset of ISO 10646-1</b></p>
<p>(<b>--misra_2004=3.2</b>) â All Green Hills compilers use the ASCII standard for</p>
<p>mapping character sets to numeric values. This property cannot be disabled.</p>
<p>â¢</p>
<p><b>3.3 [A] Implementation of integer division determined and documented</b></p>
<p>(<b>--misra_2004=3.3</b>) â This behavior depends on the hardware configuration</p>
<p>of the target. Most Green Hills compilers, however, round the division result</p>
<p>toward 0 (including Power Architecture, MIPS, TriCore, and x86).</p>
<p>â¢</p>
<p><b>3.4 [R] Uses of #pragma documented and explained</b> (<b>--misra_2004=3.4</b>)</p>
<p>â This book lists all</p>
<p>#pragma</p>
<p>constructs, their usages, and effects (see</p>
<p>âGeneral Pragma Directivesâ on page 796).</p>
<p>â¢</p>
<p><b>3.5 [R] Documentation of implementation-defined behavior and packing</b></p>
<p><b>of bitfields required</b> (<b>--misra_2004=3.5</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>3.6 [R] All library production code conforms to MISRA</b> (<b>--misra_2004=3.6</b>)</p>
<p>â Not enforced.</p>
<p><b>MISRA C 2004 Rules - 4 Character Sets</b></p>
<p>â¢</p>
<p><b>4.1 [R] Only ISO C escape sequences used</b> (<b>--misra_2004=4.1</b>) â Enforced.</p>
<p>Associated diagnostics include 192 and 1823.</p>
<p>â¢</p>
<p><b>4.2 [R] No trigraphs</b> (<b>--misra_2004=4.2</b>) â Enforced.</p>
<p>Associated diagnostics include 1695.</p>
<p><b>MISRA C 2004 Rules - 5 Identifiers</b></p>
<p>â¢</p>
<p><b>5.1 [R] No more than 31 chars to determine an identifier</b> (<b>--misra_2004=5.1</b>)</p>
<p>â Enforced by truncating all identifiers at 31 characters.</p>
<p>Associated diagnostics include 1772.</p>
<p>â¢</p>
<p><b>5.2 [R] No use of same id name in inner and outer scope</b> (<b>--misra_2004=5.2</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 460 and 1721.</p>
<p>â¢</p>
<p><b>5.3 [R] Each `typedef' must be a unique identifier</b> (<b>--misra_2004=5.3</b>) â</p>
<p>Enforced within a translation unit.</p>
<p><i>189</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 2004</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Associated diagnostics include 1722 and 1841.</p>
<p>â¢</p>
<p><b>5.4 [R] Tag names must be unique</b> (<b>--misra_2004=5.4</b>) â Enforced within</p>
<p>a translation unit.</p>
<p>Associated diagnostics include 469 and 1842.</p>
<p>â¢</p>
<p><b>5.5 [A] No reuse of function or static object identifiers</b> (<b>--misra_2004=5.5</b>)</p>
<p>â Enforced within a translation unit.</p>
<p>Associated diagnostics include 1843.</p>
<p>â¢</p>
<p><b>5.6 [A] No identifiers with the same name in different name spaces except</b></p>
<p><b>for struct and union members</b> (<b>--misra_2004=5.6</b>) â Enforced within a</p>
<p>translation unit.</p>
<p>Associated diagnostics include 1723.</p>
<p>â¢</p>
<p><b>5.7 [A] No reuse of identifiers</b> (<b>--misra_2004=5.7</b>) â Enforced within a</p>
<p>translation unit.</p>
<p>Associated diagnostics include 1840.</p>
<p><b>MISRA C 2004 Rules - 6 Types</b></p>
<p>â¢</p>
<p><b>6.1 [R] `char' only used for storage and use of character values</b></p>
<p>(<b>--misra_2004=6.1</b>) â Enforced.</p>
<p>Associated diagnostics include 1850 and 1852.</p>
<p>â¢</p>
<p><b>6.2 [R] `signed char' and `unsigned char' only used for storage and use of</b></p>
<p><b>numeric values</b> (<b>--misra_2004=6.2</b>) â Enforced.</p>
<p>Associated diagnostics include 1851.</p>
<p>â¢</p>
<p><b>6.3 [A] Basic types used only in `typedef's and bitfields</b> (<b>--misra_2004=6.3</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 1698.</p>
<p>â¢</p>
<p><b>6.4 [R] Bitfields can only have `unsigned int' or `signed int' types</b></p>
<p>(<b>--misra_2004=6.4</b>) â Enforced.</p>
<p>Associated diagnostics include 230 and 1717.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>190</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>6.5 [R] Signed bitfields must be least 2 bits long</b> (<b>--misra_2004=6.5</b>) â</p>
<p>Enforced.</p>
<p>Associated diagnostics include 108.</p>
<p><b>MISRA C 2004 Rules - 7 Constants</b></p>
<p>â¢</p>
<p><b>7.1 [R] No non-zero octal constants or octal escape sequences</b></p>
<p>(<b>--misra_2004=7.1</b>) â Enforced.</p>
<p>Associated diagnostics include 1718.</p>
<p><b>MISRA C 2004 Rules - 8 Declarations and Definitions</b></p>
<p>â¢</p>
<p><b>8.1 [R] Functions must always have prototype declarations</b></p>
<p>(<b>--misra_2004=8.1</b>) â Enforced.</p>
<p>Associated diagnostics include 223, 1547, 1791, 1800, and 1828.</p>
<p>â¢</p>
<p><b>8.2 [R] Every function must have an explcit return type</b> (<b>--misra_2004=8.2</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 77, 260, and 938.</p>
<p>â¢</p>
<p><b>8.3 [A] Function declaration and definition prototypes match</b></p>
<p>(<b>--misra_2004=8.3</b>) â Enforced.</p>
<p>Associated diagnostics include 1844.</p>
<p>â¢</p>
<p><b>8.4 [R] Multiple declarations of an object or function must be compatible</b></p>
<p>(<b>--misra_2004=8.4</b>) â Enforced within a translation unit.</p>
<p>Associated diagnostics include 147.</p>
<p>â¢</p>
<p><b>8.5 [R] No object or function definitions in a header file</b> (<b>--misra_2004=8.5</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 1846.</p>
<p>â¢</p>
<p><b>8.6 [R] Functions always declared at file scope</b> (<b>--misra_2004=8.6</b>) â</p>
<p>Enforced.</p>
<p>Associated diagnostics include 1731.</p>
<p><i>191</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 2004</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>8.7 [R] Use function or block scope definitions for objects whenever possible</b></p>
<p>(<b>--misra_2004=8.7</b>) â Enforced for non-static variables in<b> elxr</b>. If you enable</p>
<p><b>-auto_sda</b>, this rule might not be enforced.</p>
<p>â¢</p>
<p><b>8.8 [R] External objects and functions declared in no more than one file</b></p>
<p>(<b>--misra_2004=8.8</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>8.9 [R] Only one external definition for an external identifier</b></p>
<p>(<b>--misra_2004=8.9</b>) â Enforced in the compiler and<b> elxr</b>.</p>
<p>Associated diagnostics include 1797.</p>
<p>â¢</p>
<p><b>8.10 [R] Static linkage of file scope declarations when possible</b></p>
<p>(<b>--misra_2004=8.10</b>) â Enforced in</p>
<p>elxr</p>
<p>.</p>
<p>â¢</p>
<p><b>8.11 [R] All objects and functions with internal linkage declared `static'</b></p>
<p>(<b>--misra_2004=8.11</b>) â Enforced.</p>
<p>Associated diagnostics include 172.</p>
<p>â¢</p>
<p><b>8.12 [R] Arrays with external linkage must have known size at compile</b></p>
<p><b>time</b> (<b>--misra_2004=8.12</b>) â Enforced.</p>
<p>Associated diagnostics include 1824.</p>
<p><b>MISRA C 2004 Rules - 9 Initialization</b></p>
<p>â¢</p>
<p><b>9.1 [R] Automatic variables initialized before used</b> (<b>--misra_2004=9.1</b>) â</p>
<p>Enforced for simple cases.</p>
<p>Associated diagnostics include 549.</p>
<p>â¢</p>
<p><b>9.2 [R] Braces used to match structure in initialization of arrays or structs</b></p>
<p>(<b>--misra_2004=9.2</b>) â Enforced.</p>
<p>Associated diagnostics include 146, 991, and 1736.</p>
<p>â¢</p>
<p><b>9.3 [R] All or only first member of an enumeration may be explicitly</b></p>
<p><b>initialized</b> (<b>--misra_2004=9.3</b>) â Enforced.</p>
<p>Associated diagnostics include 1726.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>192</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>MISRA C 2004 Rules - 10 Arithmetic Type Conversions</b></p>
<p>â¢</p>
<p><b>10.1 [R] Restrict implicit conversions for integer type expressions</b></p>
<p>(<b>--misra_2004=10.1</b>) â Enforced.</p>
<p>Associated diagnostics include 1863, 1864, 1865, 1866, 1867, 1868, 1869, and</p>
<p>1870.</p>
<p>â¢</p>
<p><b>10.2 [R] Restrict implicit conversions for floating type expressions</b></p>
<p>(<b>--misra_2004=10.2</b>) â Enforced.</p>
<p>Associated diagnostics include 1871, 1872, 1873, 1874, and 1875.</p>
<p>â¢</p>
<p><b>10.3 [R] Restrict explicit casts for integer type expressions</b></p>
<p>(<b>--misra_2004=10.3</b>) â Enforced.</p>
<p>Associated diagnostics include 1847, 1878, 1879, and 1880.</p>
<p>â¢</p>
<p><b>10.4 [R] Restrict explicit casts for floating type expressions</b></p>
<p>(<b>--misra_2004=10.4</b>) â Enforced.</p>
<p>Associated diagnostics include 1848.</p>
<p>â¢</p>
<p><b>10.5 [R] Bitwise `~' and `&lt;&lt;' expressions on unsigned char or unsigned</b></p>
<p><b>short types must be cast to underlying type</b> (<b>--misra_2004=10.5</b>) â</p>
<p>Enforced.</p>
<p>Associated diagnostics include 1849.</p>
<p>â¢</p>
<p><b>10.6 [R] Apply `U' suffix to all constants of `unsigned' type</b></p>
<p>(<b>--misra_2004=10.6</b>) â Enforced.</p>
<p>Associated diagnostics include 1775.</p>
<p><b>MISRA C 2004 Rules - 11 Pointer Type Conversions</b></p>
<p>â¢</p>
<p><b>11.1 [R] No conversions between pointer to function and non-integral types</b></p>
<p>(<b>--misra_2004=11.1</b>) â Enforced.</p>
<p>Associated diagnostics include 1832.</p>
<p>â¢</p>
<p><b>11.2 [R] No conversions between pointer to object and any type other than</b></p>
<p><b>integral, pointer to object, or pointer to void</b> (<b>--misra_2004=11.2</b>) â</p>
<p>Enforced.</p>
<p><i>193</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 2004</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Associated diagnostics include 1833.</p>
<p>â¢</p>
<p><b>11.3 [A] No casting between pointer and integral types</b> (<b>--misra_2004=11.3</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 1834 and 1877.</p>
<p>â¢</p>
<p><b>11.4 [A] No casting between different pointer to object types</b></p>
<p>(<b>--misra_2004=11.4</b>) â Enforced.</p>
<p>Associated diagnostics include 1835.</p>
<p>â¢</p>
<p><b>11.5 [R] No casting that removes any `const' or `volatile' qualification from</b></p>
<p><b>the type addressed by a pointer</b> (<b>--misra_2004=11.5</b>) â Enforced.</p>
<p>Associated diagnostics include 1836.</p>
<p><b>MISRA C 2004 Rules - 12 Expressions</b></p>
<p>â¢</p>
<p><b>12.1 [A] Limited dependence on C precedence rules</b> (<b>--misra_2004=12.1</b>)</p>
<p>â Enforced per the guidelines in the supporting text of the rule.</p>
<p>Associated diagnostics include 1737.</p>
<p>â¢</p>
<p><b>12.2 [R] No expressions with values dependent on evaluation order</b></p>
<p>(<b>--misra_2004=12.2</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>12.3 [R] No side effects in the operand of `sizeof'</b> (<b>--misra_2004=12.3</b>) â</p>
<p>Enforced.</p>
<p>Associated diagnostics include 1725.</p>
<p>â¢</p>
<p><b>12.4 [R] No side effects in the right hand operand of `&amp;&amp;' or `||'</b></p>
<p>(<b>--misra_2004=12.4</b>) â Enforced.</p>
<p>Associated diagnostics include 1724.</p>
<p>â¢</p>
<p><b>12.5 [R] Operands of `&amp;&amp;' and `||' must be primary expressions</b></p>
<p>(<b>--misra_2004=12.5</b>) â Enforced.</p>
<p>Associated diagnostics include 1729.</p>
<p>â¢</p>
<p><b>12.6 [A] Operands of logical operators must be Boolean, and Boolean</b></p>
<p><b>expressions may not be used as operands of other operators</b></p>
<p>(<b>--misra_2004=12.6</b>) â Enforced.</p>
<p>Associated diagnostics include 1853 and 1854.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>194</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>12.7 [R] No bitwise operations on signed integer types</b> (<b>--misra_2004=12.7</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 1730.</p>
<p>â¢</p>
<p><b>12.8 [R] Value of right hand operand of a shift operator must be equal to</b></p>
<p><b>or greater than zero and less than the size of the underlying type of the</b></p>
<p><b>left hand operand</b> (<b>--misra_2004=12.8</b>) â Enforced. Both compile-time and</p>
<p>run-time checks are performed. The run-time check is disabled when the</p>
<p><b>--no_misra_runtime</b> option is passed. The underlying type of the constant</p>
<p>1</p>
<p>is</p>
<p>signed char</p>
<p>, therefore the expression</p>
<p>(1&lt;&lt;x)</p>
<p>is valid only for</p>
<p>x&lt;8</p>
<p>.</p>
<p>Associated diagnostics include 62 and 63.</p>
<p>â¢</p>
<p><b>12.9 [R] No unary minus on unsigned expressions</b> (<b>--misra_2004=12.9</b>) â</p>
<p>Enforced.</p>
<p>Associated diagnostics include 1702.</p>
<p>â¢</p>
<p><b>12.10 [R] No comma operators</b> (<b>--misra_2004=12.10</b>) â Enforced.</p>
<p>Associated diagnostics include 1825.</p>
<p>â¢</p>
<p><b>12.11 [A] No wrap-around in constant unsigned expression evaluation</b></p>
<p>(<b>--misra_2004=12.11</b>) â Enforced.</p>
<p>Associated diagnostics include 1735.</p>
<p>â¢</p>
<p><b>12.12 [R] No use of underlying bit representation in floating point</b></p>
<p><b>expressions</b> (<b>--misra_2004=12.12</b>) â The Green Hills compilers do not allow</p>
<p>any use of bit-wise operators (such as</p>
<p>&amp;</p>
<p>,</p>
<p>|</p>
<p>,</p>
<p>^</p>
<p>,</p>
<p>~</p>
<p>, etc.) by default. When this</p>
<p>rule is enabled, a diagnostic is issued for union members of floating-point type.</p>
<p>Associated diagnostics include 1820.</p>
<p>â¢</p>
<p><b>12.13 [A] No mixing of increment (++) and decrement (--) operators with</b></p>
<p><b>other operators</b> (<b>--misra_2004=12.13</b>) â Enforced.</p>
<p>Associated diagnostics include 1856.</p>
<p><b>MISRA C 2004 Rules - 13 Control Statement Expressions</b></p>
<p>â¢</p>
<p><b>13.1 [R] Assignment operators not used in Boolean expressions</b></p>
<p>(<b>--misra_2004=13.1</b>) â Enforced.</p>
<p>Associated diagnostics include 1738.</p>
<p><i>195</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 2004</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>13.2 [A] Explicit test of a value against zero unless the expression is Boolean</b></p>
<p>(<b>--misra_2004=13.2</b>) â Enforced.</p>
<p>Associated diagnostics include 1855 and 1881.</p>
<p>â¢</p>
<p><b>13.3 [R] Floating-point values not tested for (in)equality</b></p>
<p>(<b>--misra_2004=13.3</b>) â Enforced.</p>
<p>Associated diagnostics include 1704.</p>
<p>â¢</p>
<p><b>13.4 [R] No floating-point variables in `for' loop control expressions</b></p>
<p>(<b>--misra_2004=13.4</b>) â Enforced.</p>
<p>Associated diagnostics include 1750.</p>
<p>â¢</p>
<p><b>13.5 [R] Only loop control expression in `for' statement header</b></p>
<p>(<b>--misra_2004=13.5</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>13.6 [R] No modification of numeric control variables in `for' loop body</b></p>
<p>(<b>--misra_2004=13.6</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>13.7 [R] No Boolean operations with invariant results</b> (<b>--misra_2004=13.7</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 1857.</p>
<p><b>MISRA C 2004 Rules - 14 Control Flow</b></p>
<p>â¢</p>
<p><b>14.1 [R] No unreachable code</b> (<b>--misra_2004=14.1</b>) â Enforced.</p>
<p>Associated diagnostics include 111 and 177.</p>
<p>â¢</p>
<p><b>14.2 [R] All non-null statements must have a side-effect</b> (<b>--misra_2004=14.2</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 174.</p>
<p>â¢</p>
<p><b>14.3 [R] Null statement must occur on a line by itself</b> (<b>--misra_2004=14.3</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 1746.</p>
<p>â¢</p>
<p><b>14.4 [R] No `goto' statements</b> (<b>--misra_2004=14.4</b>) â Enforced.</p>
<p>Associated diagnostics include 1705.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>196</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>14.5 [R] No `continue' statements</b> (<b>--misra_2004=14.5</b>) â Enforced.</p>
<p>Associated diagnostics include 1706.</p>
<p>â¢</p>
<p><b>14.6 [R] At most one break statement per iteration statement</b></p>
<p>(<b>--misra_2004=14.6</b>) â Enforced.</p>
<p>Associated diagnostics include 1845.</p>
<p>â¢</p>
<p><b>14.7 [R] Functions must have a single point of exit</b> (<b>--misra_2004=14.7</b>) â</p>
<p>Enforced.</p>
<p>Associated diagnostics include 1734.</p>
<p>â¢</p>
<p><b>14.8 [R] Dependent statements of loop and switch statements must have</b></p>
<p><b>braces</b> (<b>--misra_2004=14.8</b>) â Enforced.</p>
<p>Associated diagnostics include 1709.</p>
<p>â¢</p>
<p><b>14.9 [R] Dependent statements of if statements must have braces</b></p>
<p>(<b>--misra_2004=14.9</b>) â Enforced.</p>
<p>Associated diagnostics include 1826.</p>
<p>â¢</p>
<p><b>14.10 [R] All `if'...`else if' constructs must have an `else'</b></p>
<p>(<b>--misra_2004=14.10</b>) â Enforced.</p>
<p>Associated diagnostics include 1710.</p>
<p><b>MISRA C 2004 Rules - 15 Switch Statements</b></p>
<p>â¢</p>
<p><b>15.1 [R] Switch labels must be at top level compound statement of `switch'</b></p>
<p><b>statement</b> (<b>--misra_2004=15.1</b>) â Enforced.</p>
<p>Associated diagnostics include 1838.</p>
<p>â¢</p>
<p><b>15.2 [R] Every non-empty switch clause terminates with an unconditional</b></p>
<p><b>`break' statement</b> (<b>--misra_2004=15.2</b>) â Enforced.</p>
<p>Associated diagnostics include 1711 and 1884.</p>
<p>â¢</p>
<p><b>15.3 [R] Every `switch' statement must contain a final `default' clause</b></p>
<p>(<b>--misra_2004=15.3</b>) â Enforced.</p>
<p>Associated diagnostics include 1712 and 1837.</p>
<p><i>197</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 2004</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>15.4 [R] No Boolean values in `switch' expressions</b> (<b>--misra_2004=15.4</b>) â</p>
<p>Enforced.</p>
<p>Associated diagnostics include 1733.</p>
<p>â¢</p>
<p><b>15.5 [R] `switch' statements must have at least one `case'</b></p>
<p>(<b>--misra_2004=15.5</b>) â Enforced.</p>
<p>Associated diagnostics include 1713.</p>
<p><b>MISRA C 2004 Rules - 16 Functions</b></p>
<p>â¢</p>
<p><b>16.1 [R] No variable argument function definitions</b> (<b>--misra_2004=16.1</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 1697.</p>
<p>â¢</p>
<p><b>16.2 [R] No direct or indirect recursion</b> (<b>--misra_2004=16.2</b>) â Enforced</p>
<p>in the compiler and</p>
<p>elxr</p>
<p>linker. Using function pointers might cause the linker</p>
<p>to miss certain recursive functions, or report errors for nonrecursive functions.</p>
<p>Legacy Coverage Profiling may also cause nonrecursive functions to be reported</p>
<p>incorrectly as recursive (see âProfiling - Legacy Coverageâ on page 302).</p>
<p>â¢</p>
<p><b>16.3 [R] Identifiers must be given for all function parameters</b></p>
<p>(<b>--misra_2004=16.3</b>) â Enforced.</p>
<p>Associated diagnostics include 1727.</p>
<p>â¢</p>
<p><b>16.4 [R] Parameter names in function declaration and definition must</b></p>
<p><b>match</b> (<b>--misra_2004=16.4</b>) â Enforced.</p>
<p>Associated diagnostics include 1745.</p>
<p>â¢</p>
<p><b>16.5 [R] Declarations of functions with no parameters must have a `void'</b></p>
<p><b>parameter</b> (<b>--misra_2004=16.5</b>) âEnforced.</p>
<p>Associated diagnostics include 1728.</p>
<p>â¢</p>
<p><b>16.6 [R] Number of arguments must match the function prototype</b></p>
<p>(<b>--misra_2004=16.6</b>) â Always enforced.</p>
<p>â¢</p>
<p><b>16.7 [A] Pointer parameters to functions declared as pointer to `const' if</b></p>
<p><b>possible</b> (<b>--misra_2004=16.7</b>) â Not enforced.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>198</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>16.8 [R] Return expression must match function type</b> (<b>--misra_2004=16.8</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 117 and 940.</p>
<p>â¢</p>
<p><b>16.9 [R] Function identifiers may only be used for calls or with preceding</b></p>
<p><b>`&amp;' operator</b> (<b>--misra_2004=16.9</b>) â Enforced.</p>
<p>Associated diagnostics include 1774.</p>
<p>â¢</p>
<p><b>16.10 [R] If error information returned by a function, it must be tested</b></p>
<p>(<b>--misra_2004=16.10</b>) â Not enforced.</p>
<p><b>MISRA C 2004 Rules - 17 Pointers and Arrays</b></p>
<p>â¢</p>
<p><b>17.1 [R] No pointer arithmetic on pointers that don't address an array</b></p>
<p><b>element</b> (<b>--misra_2004=17.1</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>17.2 [R] No pointer subtraction on pointers that don't address elements</b></p>
<p><b>of the same array</b> (<b>--misra_2004=17.2</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>17.3 [R] Relational operators not used on pointers that don't point to the</b></p>
<p><b>same array</b> (<b>--misra_2004=17.3</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>17.4 [R] No pointer arithmetic other than array indexing</b></p>
<p>(<b>--misra_2004=17.4</b>) â Enforced.</p>
<p>Associated diagnostics include 1752 and 1858.</p>
<p>â¢</p>
<p><b>17.5 [A] No more than 2 levels of pointer indirection in an object</b></p>
<p><b>declaration</b> (<b>--misra_2004=17.5</b>) â Enforced.</p>
<p>Associated diagnostics include 1741.</p>
<p>â¢</p>
<p><b>17.6 [R] Address of automatic variable not used out of scope</b></p>
<p>(<b>--misra_2004=17.6</b>) â Enforced.</p>
<p>Associated diagnostics include 1056 and 1780.</p>
<p><b>MISRA C 2004 Rules - 18 Structs and Unions</b></p>
<p>â¢</p>
<p><b>18.1 [R] No incomplete struct or union types at end of translation unit</b></p>
<p>(<b>--misra_2004=18.1</b>) â Cannot be disabled.</p>
<p><i>199</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 2004</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>18.2 [R] No assignments between overlapping objects</b> (<b>--misra_2004=18.2</b>)</p>
<p>â Not enforced.</p>
<p>â¢</p>
<p><b>18.3 [R] No reuse of memory for unrelated purposes</b> (<b>--misra_2004=18.3</b>)</p>
<p>â Not enforced.</p>
<p>â¢</p>
<p><b>18.4 [R] Unions may not be used</b> (<b>--misra_2004=18.4</b>) â Enforced.</p>
<p>Associated diagnostics include 1827.</p>
<p><b>MISRA C 2004 Rules - 19 Preprocessing Directives</b></p>
<p>â¢</p>
<p><b>19.1 [A] Only preprocessing directives and comments before `#include'</b></p>
<p>(<b>--misra_2004=19.1</b>) â Enforced.</p>
<p>Associated diagnostics include 1748.</p>
<p>â¢</p>
<p><b>19.2 [A] Only standard characters in file names for `#include'</b></p>
<p>(<b>--misra_2004=19.2</b>) â Enforced.</p>
<p>Associated diagnostics include 1747.</p>
<p>â¢</p>
<p><b>19.3 [R] `#include' directive only followed by &lt;filename&gt; or &quot;filename&quot;</b></p>
<p>(<b>--misra_2004=19.3</b>) â Always enforced.</p>
<p>â¢</p>
<p><b>19.4 [R] Restrict macro syntax</b> (<b>--misra_2004=19.4</b>) â Enforced.</p>
<p>Associated diagnostics include 1859, 1860, and 1886.</p>
<p>â¢</p>
<p><b>19.5 [R] No `#define' or `#undef' within a block</b> (<b>--misra_2004=19.5</b>) â</p>
<p>Enforced.</p>
<p>Associated diagnostics include 1732.</p>
<p>â¢</p>
<p><b>19.6 [R] `#undef' cannot be used</b> (<b>--misra_2004=19.6</b>) â Enforced.</p>
<p>Associated diagnostics include 1715.</p>
<p>â¢</p>
<p><b>19.7 [A] Function used instead of function-like macro when possible</b></p>
<p>(<b>--misra_2004=19.7</b>) â Enforced.</p>
<p>Associated diagnostics include 1862.</p>
<p>â¢</p>
<p><b>19.8 [R] Function-like macro must be called with all of its arguments</b></p>
<p>(<b>--misra_2004=19.8</b>) â Enforced.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>200</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Associated diagnostics include 54 and 76.</p>
<p>â¢</p>
<p><b>19.9 [R] No preprocessing directives in function-like macros</b></p>
<p>(<b>--misra_2004=19.9</b>) â Enforced.</p>
<p>Associated diagnostics include 10.</p>
<p>â¢</p>
<p><b>19.10 [R] In function-like macro definition, wrap each parameter reference</b></p>
<p><b>in parentheses</b> (<b>--misra_2004=19.10</b>) â Enforced.</p>
<p>Associated diagnostics include 1829.</p>
<p>â¢</p>
<p><b>19.11 [R] Identifiers in preprocessing directives defined before used</b></p>
<p>(<b>--misra_2004=19.11</b>) â Enforced.</p>
<p>Associated diagnostics include 193.</p>
<p>â¢</p>
<p><b>19.12 [R] At most one `#' or `##' operator in a macro</b> (<b>--misra_2004=19.12</b>)</p>
<p>â Enforced.</p>
<p>Associated diagnostics include 1716.</p>
<p>â¢</p>
<p><b>19.13 [A] No `#' or `##' preprocessor operators</b> (<b>--misra_2004=19.13</b>) â</p>
<p>Enforced.</p>
<p>Associated diagnostics include 1830.</p>
<p>â¢</p>
<p><b>19.14 [R] Correct use of `defined' preprocessor operator</b></p>
<p>(<b>--misra_2004=19.14</b>) â Enforced.</p>
<p>Associated diagnostics include 1831.</p>
<p>â¢</p>
<p><b>19.15 [R] Prevent contents of header files from being included more than</b></p>
<p><b>once</b> (<b>--misra_2004=19.15</b>) â A diagnostic is issued if the front end does not</p>
<p>recognize an</p>
<p>#ifndef...#define...#endif</p>
<p>include guard. Because<b> assert.h</b></p>
<p>does not conform to this rule, a diagnostic is issued if you include this header</p>
<p>file and enable this rule.</p>
<p>Associated diagnostics include 1882.</p>
<p>â¢</p>
<p><b>19.16 [R] Conditionally excluded preprocessor directives must be</b></p>
<p><b>syntactically valid</b> (<b>--misra_2004=19.16</b>) â Enforced.</p>
<p>Associated diagnostics include 11.</p>
<p>â¢</p>
<p><b>19.17 [R] All related conditional preprocessor directives must reside in</b></p>
<p><b>the same file</b> (<b>--misra_2004=19.17</b>) â Enforced.</p>
<p><i>201</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 2004</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Associated diagnostics include 36 and 37.</p>
<p><b>MISRA C 2004 Rules - 20 Standard Libraries</b></p>
<p>The following MISRA rules are enforced both by</p>
<p>#error</p>
<p>directives in the standard</p>
<p>library headers, and by diagnostics emitted by the</p>
<p>elxr</p>
<p>linker. The linker diagnostics</p>
<p>prevent programs from circumventing these rules by calling forbidden functions</p>
<p>without including the standard headers (after suppressing MISRA 2004 Rule 8.1).</p>
<p>The linker prevents any use of the forbidden functions in any library modules that</p>
<p>are pulled into the link.</p>
<p>â¢</p>
<p><b>20.1 [R] No definition, redefinition, or undefinition of reserved words and</b></p>
<p><b>standard library names</b> (<b>--misra_2004=20.1</b>) â Enforced.</p>
<p>Associated diagnostics include 45, 46, 1861, and 1885.</p>
<p>â¢</p>
<p><b>20.2 [R] Standard library macro, object, and function names cannot be</b></p>
<p><b>reused</b> (<b>--misra_2004=20.2</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>20.3 [R] Check validity of values passed to library functions</b></p>
<p>(<b>--misra_2004=20.3</b>) â Not enforced.</p>
<p>â¢</p>
<p><b>20.4 [R] Dynamic heap memory allocation cannot be used</b></p>
<p>(<b>--misra_2004=20.4</b>) â Enforced.</p>
<p>â¢</p>
<p><b>20.5 [R] The error indicator `errno' cannot be used</b> (<b>--misra_2004=20.5</b>)</p>
<p>â Enforced.</p>
<p>â¢</p>
<p><b>20.6 [R] Macro `offsetof' in &lt;stddef.h&gt; cannot be used</b> (<b>--misra_2004=20.6</b>)</p>
<p>â Enforced.</p>
<p>â¢</p>
<p><b>20.7 [R] The `setjmp' and `longjmp' facilities cannot be used</b></p>
<p>(<b>--misra_2004=20.7</b>) â Enforced. Because the debugging memory library</p>
<p><b>libdbmem.a</b> uses</p>
<p>setjmp()</p>
<p>, building an otherwise conforming program with</p>
<p><b>-check=alloc</b> might trigger the associated<b> elxr</b> diagnostic.</p>
<p>â¢</p>
<p><b>20.8 [R] The facilities of &lt;signal.h&gt; cannot be used</b> (<b>--misra_2004=20.8</b>)</p>
<p>â Enforced.</p>
<p>â¢</p>
<p><b>20.9 [R] No use of &lt;stdio.h&gt; in production code</b> (<b>--misra_2004=20.9</b>) â</p>
<p>Enforced.</p>
<p>â¢</p>
<p><b>20.10 [R] Functions `atof', `atoi', and `atol' are not used</b></p>
<p>(<b>--misra_2004=20.10</b>) â Enforced.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>202</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>20.11 [R] Functions `abort', `exit', `getenv', and `system' are not used</b></p>
<p>(<b>--misra_2004=20.11</b>) â Enforced. Because the default startup code uses</p>
<p>exit()</p>
<p>, an otherwise conforming program might trigger the associated<b> elxr</b></p>
<p>diagnostic.</p>
<p>â¢</p>
<p><b>20.12 [R] The facilities of &lt;time.h&gt; cannot be used</b> (<b>--misra_2004=20.12</b>)</p>
<p>â Enforced.</p>
<p><b>MISRA C 2004 Rules - 21 Run-time Failures</b></p>
<p>â¢</p>
<p><b>21.1 [R] Run-time checking</b> (<b>--misra_2004=21.1</b>) â Enforced by performing</p>
<p>run-time error checks for array bounds, assignment bounds, NULL pointer</p>
<p>dereference, divide-by-zero, and unresolved switch statement condition. For</p>
<p>more information about run-time error checking, see âRun-Time Error Checksâ</p>
<p>on page 178. The<b> --no_misra_runtime</b> option disables this rule.</p>
<p><b>MISRA C - Required Rules Level</b></p>
<p>Controls the diagnostic messages generated upon a violation of the MISRA<i> required</i></p>
<p>rules. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Errors</b> (<b>--misra_req=error</b>) â [default]</p>
<p>â¢</p>
<p><b>Warnings</b> (<b>--misra_req=warn</b>)</p>
<p>â¢</p>
<p><b>Silent</b> (<b>--misra_req=silent</b>)</p>
<p><b>MISRA C - Advisory Rules Level</b></p>
<p>Controls the diagnostic messages generated upon a violation of the MISRA<i> advisory</i></p>
<p>rules. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Errors</b> (<b>--misra_adv=error</b>)</p>
<p>â¢</p>
<p><b>Warnings</b> (<b>--misra_adv=warn</b>) â [default]</p>
<p>â¢</p>
<p><b>Silent</b> (<b>--misra_adv=silent</b>)</p>
<p><i>203</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 2004</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>MISRA C - Run-Time Checks</b></p>
<p>Controls the performance of run-time checks for the MISRA rules that require them.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--misra_runtime</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_misra_runtime</b>)</p>
<p>Rules with associated run-time checks include:</p>
<p>â¢</p>
<p>MISRA 1998 rules 4, 38, and 107</p>
<p>â¢</p>
<p>MISRA 2004 rules 12.8 and 21.1</p>
<p><b>MISRA C 1998</b></p>
<p>This option category is contained within<b> C/C++ Compiler</b>.</p>
<p>This section contains options that allow you to check your code for compliance</p>
<p>with the Motor Industry Software Reliability Association (MISRA) rules, a set of</p>
<p>guidelines for the C programming language that is designed to enforce good practices</p>
<p>in the development of embedded automotive systems. For more information, see</p>
<p>âMISRA C 1998â on page 945.</p>
<p><b>Note</b></p>
<p>Support for MISRA 1998 Rules is deprecated and may be removed in</p>
<p>future versions of<b> MULTI</b>. It is recommended that you use the MISRA</p>
<p>2004 Rules (see âMISRA C 2004â on page 187).</p>
<p><b>MISRA C 1998 Rules - Environment</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>1. [R] ISO 9899 C conformance w/o extensions</b> â Enables Strict ANSI C.</p>
<p>This option enables<b> -ANSI</b>, which disables recognition of many non-standard</p>
<p>keywords and extensions. Errors issued because of this check are not identified</p>
<p>as MISRA errors, and their severities are unaffected by MISRA classification</p>
<p>or the<b> --misra_req</b> option.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>204</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>2. [A] Code other than C must conform to standard interface</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>3. [A] Inline assembly only in functions with no other code</b></p>
<p>â¢</p>
<p><b>4. [A] Run-time checking</b> â Implemented through run-time checking. This</p>
<p>option sets<b> -check=assignbound</b>,<b> -check=bound</b>,<b> -check=nilderef</b>,</p>
<p><b>-check=zerodivide</b>, and<b> -check=switch</b>. For more information about run-time</p>
<p>error checking, see âRun-Time Error Checksâ on page 178. The option</p>
<p><b>--no_misra_runtime</b> turns off this rule completely. The option</p>
<p><b>--no_misra_runtime</b> disables both this rule and rule 107, as well as the run-time</p>
<p>component of rule 38.</p>
<p><b>MISRA C 1998 Rules - Character Set</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>5. [R] Only ISO C characters and escape sequences used</b> â Disables</p>
<p>recognition of the</p>
<p>\e</p>
<p>escape in GNU mode. Issues a MISRA diagnostic on</p>
<p>each use of a multibyte character literal (such as a Kanji character).</p>
<p>â¢</p>
<p><b>6. [R] Values of char types restricted to subset of ISO 10646-1</b> â All Green</p>
<p>Hills compilers use the ASCII standard for mapping character sets to numeric</p>
<p>values. This property cannot be turned off.</p>
<p>â¢</p>
<p><b>7. [R] No trigraphs</b></p>
<p>â¢</p>
<p><b>8. [R] No multibyte chars and wide strings</b> â Issues a MISRA diagnostic</p>
<p>on each use of a multibyte character literal (such as a Kanji character).</p>
<p><b>MISRA C 1998 Rules - Comments</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>9. [R] No nested comments</b></p>
<p>â¢</p>
<p><b>10. [A] No 'commented out' sections of code</b> â Disallows the following</p>
<p>characters inside of a comment:</p>
<p>â</p>
<p>semicolon followed by a new-line character</p>
<p>â</p>
<p>open or close curly braces</p>
<p><i>205</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 1998</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>MISRA C 1998 Rules - Identifiers</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>11. [R] No more than 31 chars to determine an identifier</b> â Enforced by</p>
<p>truncating all identifiers at 31 characters.</p>
<p>Errors issued because of this check are not identified as MISRA errors, and</p>
<p>their severities are unaffected by MISRA classification or the<b> --misra_req</b></p>
<p>option.</p>
<p>Associated diagnostics include 1772.</p>
<p>â¢</p>
<p><b>12. [A] No identifiers with the same names in different namespaces</b></p>
<p><b>MISRA C 1998 Rules - Types</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>13. [A] Basic types used only in `typedef's</b></p>
<p>â¢</p>
<p><b>14. [R] `char' always used as `signed char' or `unsigned char'</b></p>
<p>â¢</p>
<p><b>15. [A] Floating point implementation complies to a standard</b> â The Green</p>
<p>Hills compilers use the IEEE floating-point representation. This rule cannot</p>
<p>be turned off.</p>
<p>â¢</p>
<p><b>16. [R] No underlying use of bits in floating point expressions</b> â The Green</p>
<p>Hills compilers disallow any use of bit-wise operators (such as</p>
<p>&amp;</p>
<p>,</p>
<p>|</p>
<p>,</p>
<p>^</p>
<p>,</p>
<p>~</p>
<p>, etc.)</p>
<p>by default. When this rule is enabled, a diagnostic is issued for union members</p>
<p>of floating-point type.</p>
<p>â¢</p>
<p><b>17. [R] `typedef' names shall not be reused</b></p>
<p><b>MISRA C 1998 Rules - Constants</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>18. [A] Numeric constants need suffixes when appropriate</b></p>
<p>â¢</p>
<p><b>19. [R] No octal constants (other than zero)</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>206</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>MISRA C 1998 Rules - Declarations and Definitions</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>20. [R] All objects and functions declared before used</b></p>
<p>â¢</p>
<p><b>21. [R] No use of same id name in inner and outer scope</b></p>
<p>â¢</p>
<p><b>22. [A] Function scope declarations whenever possible</b> â Not enforced.</p>
<p>â¢</p>
<p><b>23. [A] Static linkage of file scope declarations when possible</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>24. [R] No internal and external linkages of same identifiers</b></p>
<p>â¢</p>
<p><b>25. [R] Only one external definition of external identifier</b> â Enforced in</p>
<p>the compiler and<b> elxr</b>.</p>
<p>Associated diagnostics include 1797.</p>
<p>â¢</p>
<p><b>26. [R] Compatible multiple declarations of the same object/function</b> â</p>
<p>The Green Hills compilers allow only compatible declarations of</p>
<p>multiply-declared objects and functions within the same translation unit (by</p>
<p>default). No such checks are performed across different translation units.</p>
<p>â¢</p>
<p><b>27. [A] External objects declared in no more than one file</b> â Not enforced.</p>
<p>â¢</p>
<p><b>28. [A] The `register' storage class specifier should not be used</b></p>
<p>â¢</p>
<p><b>29. [R] The use of tag shall agree with its declaration</b></p>
<p><b>MISRA C 1998 Rules - Initialization</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>30. [R] Automatic variables initialized before used</b> â Enforced for simple</p>
<p>cases.</p>
<p>â¢</p>
<p><b>31. [R] Braces used in non-zero initialization of arrays/structs</b></p>
<p>â¢</p>
<p><b>32. [R] All or only first enumerator may be explicitly initialized</b></p>
<p><b>MISRA C 1998 Rules - Operators</b></p>
<p>Permitted settings for this option are:</p>
<p><i>207</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 1998</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>33. [R] No side effects in right hand operand of `&amp;&amp;' or `||'</b></p>
<p>â¢</p>
<p><b>34. [R] Operands of `&amp;&amp;' and `||' shall be primary expressions</b></p>
<p>â¢</p>
<p><b>35. [R] Assignment operators not used in Boolean expressions</b></p>
<p>â¢</p>
<p><b>36. [A] Logical and bitwise operators should not be confused</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>37. [R] No bitwise operations on signed integer types</b></p>
<p>â¢</p>
<p><b>38. [R] Right hand value of shift operand must be in range</b> â Both</p>
<p>compile-time and run-time checks are performed. The run-time check is turned</p>
<p>off when the option<b> --no_misra_runtime</b> is passed.</p>
<p>â¢</p>
<p><b>39. [R] No unary minus operand on unsigned expressions</b></p>
<p>â¢</p>
<p><b>40. [A] No side effects in the `sizeof' operand</b></p>
<p>â¢</p>
<p><b>41. [A] Implementation of division determined and documented</b> â This</p>
<p>behavior is dependent on the hardware configuration of the target. Most Green</p>
<p>Hills compilers, however, round the division result toward 0 (including Power</p>
<p>Architecture, MIPS, TriCore, and x86).</p>
<p>â¢</p>
<p><b>42. [R] No comma operators except in control expr of `for' loops</b></p>
<p><b>MISRA C 1998 Rules - Conversions</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>43. [R] No implicit conversions which might lose information</b></p>
<p>â¢</p>
<p><b>44. [A] Redundant explicit cast should not be used</b></p>
<p>â¢</p>
<p><b>45. [R] Type casting to or from pointers should not be used</b></p>
<p><b>MISRA C 1998 Rules - Expressions</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>46. [R] No expression with values dependent on evaluation order</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>47. [A] No dependence placed on C precedence rules</b></p>
<p>â¢</p>
<p><b>48. [A] Mixed precision arithmetic must use explicit casting</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>208</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>49. [A] Test value against zero unless expression Boolean</b> â Not enforced.</p>
<p>The Green Hills C compilers do not have built-in types which would represent</p>
<p>the Boolean type.</p>
<p>â¢</p>
<p><b>50. [R] Floating point values not tested for (in)equality</b></p>
<p>â¢</p>
<p><b>51. [A] No wraparound in constant unsigned expressions</b></p>
<p><b>MISRA C 1998 Rules - Control Flow</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>52. [R] There shall be no unreachable code</b></p>
<p>â¢</p>
<p><b>53. [R] All non-null statements shall have a side-effect</b></p>
<p>â¢</p>
<p><b>54. [R] Null statement must occur on line by itself</b></p>
<p>â¢</p>
<p><b>55. [A] No labels except in `switch' statements</b></p>
<p>â¢</p>
<p><b>56. [R] The `goto' statement shall not be used</b></p>
<p>â¢</p>
<p><b>57. [R] The `continue' statement shall not be used</b></p>
<p>â¢</p>
<p><b>58. [R] No `break' statement except in `switch'</b></p>
<p>â¢</p>
<p><b>59. [R] Dependent statements always enclosed in braces</b></p>
<p>â¢</p>
<p><b>60. [A] All `if' and `else if' constructs must have an `else'</b></p>
<p>â¢</p>
<p><b>61. [R] Every non-empty `case' clause terminated with `break'</b></p>
<p>â¢</p>
<p><b>62. [R] All `switch' statements should contain a `default' clause</b></p>
<p>â¢</p>
<p><b>63. [A] No Boolean values in `switch' expressions</b></p>
<p>â¢</p>
<p><b>64. [R] `switch' statements need at least one `case'</b></p>
<p>â¢</p>
<p><b>65. [R] No floating-point variables in loop counters</b></p>
<p>â¢</p>
<p><b>66. [A] Only loop control expression in `for' statement header</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>67. [A] No modification of control variables in `for' loop body</b> â Not</p>
<p>enforced.</p>
<p><b>MISRA C 1998 Rules - Functions</b></p>
<p>Permitted settings for this option are:</p>
<p><i>209</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 1998</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>68. [R] Functions always declared at file scope</b></p>
<p>â¢</p>
<p><b>69. [R] No variable argument functions</b></p>
<p>â¢</p>
<p><b>70. [R] No direct or indirect recursion</b></p>
<p>â¢</p>
<p><b>71. [R] Functions always have prototype declarations</b> This option sets</p>
<p><b>--prototype_errors</b> or<b> --prototype_warnings</b>, depending on the MISRA C</p>
<p>Required Rules Level (see<b> Functions Without Prototypes</b> in âC/C++</p>
<p>Messagesâ on page 256).</p>
<p>â¢</p>
<p><b>72. [R] Function declaration and definition match prototypes</b> â Always</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>73. [R] Identifiers given for all or none of function parameters</b></p>
<p>â¢</p>
<p><b>74. [R] Declaration and definition match parameter names</b></p>
<p>â¢</p>
<p><b>75. [R] Every function shall have an explicit return type</b></p>
<p>â¢</p>
<p><b>76. [R] Functions with no parameters should have `void' parameter</b></p>
<p>â¢</p>
<p><b>77. [R] Unqualified arguments of callee and caller compatible</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>78. [R] Number of arguments matches the function prototype</b> â Always</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>79. [R] Values returned by `void' functions not used</b> â Always enforced.</p>
<p>â¢</p>
<p><b>80. [R] No void expressions passed as parameters</b> â Always enforced.</p>
<p>â¢</p>
<p><b>81. [A] `const' present when needed on reference parameters</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>82. [A] A function should have a single point of exit</b></p>
<p>â¢</p>
<p><b>83. [R] Return expression matches function type</b></p>
<p>â¢</p>
<p><b>84. [R] No expressions returned from `void' functions</b> â Always enforced.</p>
<p>â¢</p>
<p><b>85. [A] Functions called with empty () if no parameters</b></p>
<p>â¢</p>
<p><b>86. [A] If error information returned, it should be tested</b> â Not enforced.</p>
<p><b>MISRA C 1998 Rules - Preprocessor</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>87. [R] Only preprocessing directives before #include</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>210</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>88. [R] Only standard characters in file names for #include</b></p>
<p>â¢</p>
<p><b>89. [R] #include directive followed by &lt;filename&gt; or 'filename'</b> â Always</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>90. [R] C macros only as constant, function-like, or specifier/qualifier</b></p>
<p>â¢</p>
<p><b>91. [R] Macros not `#define'd or `#undef'd within a block</b></p>
<p>â¢</p>
<p><b>92. [A] #undef should not be used</b></p>
<p>â¢</p>
<p><b>93. [A] Function used instead of function-like macro when possible</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>94. [R] Function-like macro called with all of its arguments</b> â Always</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>95. [R] No preprocessing directives in function-like macros</b></p>
<p>â¢</p>
<p><b>96. [R] Use of parentheses in function-like macros</b></p>
<p>â¢</p>
<p><b>97. [A] Identifiers in pre-processing directives defined before used</b></p>
<p>â¢</p>
<p><b>98. [R] Only one use of `#' or `##' operator in any one macro</b></p>
<p>â¢</p>
<p><b>99. [R] Uses of #pragmas documented and explained</b> â This book lists all</p>
<p>#pragma</p>
<p>constructs, their usage and effects (see âPragma Directivesâ</p>
<p>on page 795).</p>
<p>â¢</p>
<p><b>100. [R] Correct use of `defined' preprocessor operator</b> â Always enforced.</p>
<p><b>MISRA C 1998 Rules - Pointers and Arrays</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>101. [A] Pointer arithmetic should not be used</b></p>
<p>â¢</p>
<p><b>102. [A] No more than 2 levels of pointer indirection</b></p>
<p>â¢</p>
<p><b>103. [R] Relational operators not used except on same object</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>104. [R] No non-constant pointers to functions</b></p>
<p>â¢</p>
<p><b>105. [R] Function and a pointer to it match in prototypes</b></p>
<p>â¢</p>
<p><b>106. [R] Address of automatic variable not used out of scope</b> â The compiler</p>
<p>checks if an address of a local variable is assigned to a global value.</p>
<p><i>211</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 1998</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>107. [R] The NULL pointer should not be dereferenced</b> â Performed via</p>
<p>a run-time check (<b>-check=nilderef</b>). For more information about run-time error</p>
<p>checking, see âRun-Time Error Checksâ on page 178. The option</p>
<p><b>--no_misra_runtime</b> disables both this rule and rule 4, as well as the run-time</p>
<p>component of rule 38.</p>
<p><b>MISRA C 1998 Rules - Structs and Unions</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>108. [R] All members of structures/union fully specified</b> â Not enforced.</p>
<p>â¢</p>
<p><b>109. [R] Overlapping variable storage should not be used</b> â Not enforced.</p>
<p>â¢</p>
<p><b>110. [R] Unions not used to access sub-parts of larger data types</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>111. [R] Bit fields can only have `unsigned int' or `signed int' types</b></p>
<p>â¢</p>
<p><b>112. [R] Bit fields of `signed int' type must be at least 2 bits long</b></p>
<p>â¢</p>
<p><b>113. [R] All members can be accessed only through their name</b></p>
<p><b>MISRA C 1998 Rules - Standard Library</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>114. [R] No redefinition of reserved words and standard library names</b> â</p>
<p>Always enforced. The Green Hills compilers do not allow redefinitions of C</p>
<p>reserved words. Furthermore, the predefined macro names defined,</p>
<p>__LINE__</p>
<p>,</p>
<p>__FILE__</p>
<p>,</p>
<p>__DATE__</p>
<p>,</p>
<p>__TIME__</p>
<p>, and</p>
<p>__STDC__</p>
<p>cannot be redefined.</p>
<p>â¢</p>
<p><b>115. [R] Standard library function names shall not be reused</b> â Not</p>
<p>enforced.</p>
<p>â¢</p>
<p><b>116. [R] All library production code conforms to MISRA</b> â Not enforced.</p>
<p>â¢</p>
<p><b>117. [R] Check validity of value passed to library functions</b> â Not enforced.</p>
<p>â¢</p>
<p><b>118. [R] Dynamic heap memory allocation shall not be used</b></p>
<p>â¢</p>
<p><b>119. [R] The error indicator `errno' shall not be used</b></p>
<p>â¢</p>
<p><b>120. [R] Macro `offsetof' in &lt;stddef.h&gt; shall not be used</b></p>
<p>â¢</p>
<p><b>121. [R] &lt;locale.h&gt; and `setlocale' function shall not be used</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>212</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>122. [R] The `setjmp' and `longjmp' facilities shall not be used</b></p>
<p>â¢</p>
<p><b>123. [R] The facilities of &lt;signal.h&gt; shall not be used</b></p>
<p>â¢</p>
<p><b>124. [R] No use of &lt;stdio.h&gt; in production code</b></p>
<p>â¢</p>
<p><b>125. [R] Functions `atof', `atoi', and `atol' not used</b></p>
<p>â¢</p>
<p><b>126. [R] Functions `abort', `exit', `getenv', and `system' not used</b></p>
<p>â¢</p>
<p><b>127. [R] The facilities of &lt;time.h&gt; shall not be used</b></p>
<p><b>Data Types</b></p>
<p>This option category is contained within<b> C/C++ Compiler</b>.</p>
<p>These options control the treatment of particular data types.</p>
<p><b>Signedness of Char Type</b></p>
<p>Specifies the signedness of the</p>
<p>char</p>
<p>type. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Signed</b> (<b>--signed_chars</b>) â [default]</p>
<p>â¢</p>
<p><b>Unsigned</b> (<b>--unsigned_chars</b>)</p>
<p>Note that the standard libraries are built with the default signedness. While most</p>
<p>library routines work the same way regardless of the signedness of the</p>
<p>char</p>
<p>type,</p>
<p>localeconv()</p>
<p>uses the default value of</p>
<p>CHAR_MAX</p>
<p>, which will not match</p>
<p>CHAR_MAX</p>
<p>in the application if the signedness is changed.</p>
<p><b>Signedness of Bitfields</b></p>
<p>Specifies the treatment of bitfields that are not explicitly declared</p>
<p>signed</p>
<p>or</p>
<p>unsigned</p>
<p>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Signed</b> (<b>--signed_fields</b>) â [default] â Multiple-bit bitfields declared with</p>
<p>an integer type have the signedness of their declared type. Bitfields declared</p>
<p>with an enumeration type may be either signed or unsigned to accommodate</p>
<p>the sign and the magnitude of their enumerators.</p>
<p><i>213</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Data Types</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Unsigned</b> (<b>--unsigned_fields</b>) Bitfields declared with an integer type are</p>
<p>unsigned. Bitfields declared with an enumeration type are unsigned unless the</p>
<p>enumeration type has a negative enumerator.</p>
<p>For more information, see âSignedness of Bitfieldsâ on page 689.</p>
<p><b>Signedness of Pointers</b></p>
<p>Specifies the signedness of pointers and addresses. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>Signed</b> (<b>--signed_pointer</b>) â Pointers are signed. Because the libraries are</p>
<p>built with<b> --unsigned_pointer</b>, operations that rely on memory spanning</p>
<p>0</p>
<p>may not work consistently between user code and libraries when using this</p>
<p>option.</p>
<p>â¢</p>
<p><b>Unsigned</b> (<b>--unsigned_pointer</b>) â [default] Pointers are unsigned.</p>
<p><b>Use Smallest Type Possible for Enum</b></p>
<p>Controls the allocation of enumerations. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--short_enum</b>) â Store enumerations in the smallest possible type.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_short_enum</b>) â [default] Store enumerations as integers.</p>
<p><b>Long Long Support</b></p>
<p>Controls support for the</p>
<p>long long</p>
<p>data type. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--long_long</b>) â [default] Support the</p>
<p>long long</p>
<p>data type.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_long_long</b>) â Do not support the</p>
<p>long long</p>
<p>data type.</p>
<p><b>--no_long_long</b> is supported only in ANSI and GNU C modes. It is not supported</p>
<p>on any CPU with 64-bit registers, nor is it supported in INTEGRITY, u-velOSity,</p>
<p>or embedded Linux platforms. In addition, certain target-specific header files may</p>
<p>require the</p>
<p>long long</p>
<p>type to exist.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>214</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Size of time_t</b></p>
<p>By default,</p>
<p>time_t</p>
<p>has the type</p>
<p>long</p>
<p>. For targets where</p>
<p>long</p>
<p>is 32 bits, this option</p>
<p>allows you to change the size of</p>
<p>time_t</p>
<p>to</p>
<p>long long</p>
<p>. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>32 bits</b> (<b>-time32</b>) â [default]</p>
<p>time_t</p>
<p>has the type</p>
<p>long</p>
<p>.</p>
<p>â¢</p>
<p><b>64 bits</b> (<b>-time64</b>) â On targets where</p>
<p>long</p>
<p>is 32 bits,</p>
<p>time_t</p>
<p>has the type</p>
<p>long long</p>
<p>(otherwise, this option is ignored). This option is not supported</p>
<p>with Embedded Linux.</p>
<p>The linker associates calls to C library functions that use</p>
<p>time_t</p>
<p>to definitions of</p>
<p>the function with an alternate name. For more information, see âStandard Function</p>
<p>Names Converted by the Linkerâ on page 861.</p>
<p><b>Alignment and Packing</b></p>
<p>This option category is contained within<b> C/C++ Compiler</b>.</p>
<p><b>Packing (Maximum Structure Alignment)</b></p>
<p><b>Note</b></p>
<p>Support for structure packing in C++ is limited. See the release notes for</p>
<p>more information.</p>
<p>Controls the default maximum alignment of all objects of types</p>
<p>struct</p>
<p>and</p>
<p>class</p>
<p>.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>None</b> (<b>-pack=none</b>) â [default]</p>
<p>â¢</p>
<p><b>1-byte</b> (<b>-pack=1</b>)</p>
<p>â¢</p>
<p><b>2-byte</b> (<b>-pack=2</b>)</p>
<p>â¢</p>
<p><b>4-byte</b> (<b>-pack=4</b>)</p>
<p>â¢</p>
<p><b>8-byte</b> (<b>-pack=8</b>)</p>
<p>No</p>
<p>struct</p>
<p>or</p>
<p>class</p>
<p>or member of a</p>
<p>struct</p>
<p>or</p>
<p>class</p>
<p>will have an alignment</p>
<p>greater than the specified value, unless the setting is overridden by the</p>
<p>#pragma</p>
<p>pack</p>
<p>directive (see âGeneral Pragma Directivesâ on page 796).</p>
<p><i>215</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Alignment and Packing</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If you specify<b> None</b>, no packing alignment is specified to the compiler; structures,</p>
<p>classes, and their members are aligned to their alignment requirements.</p>
<p><b>Misaligned Memory Access</b></p>
<p>Specifies whether your target handles misaligned data access. If enabled, the</p>
<p>compiler will use misaligned accesses to manage packed code.On RH850 devices,</p>
<p>this requires that the MA bit of the MCTL register be set. The default startup library</p>
<p>code will take care of this if the program was linked with this option enabled.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-misalign_pack</b>) â Misaligned data access is handled by your target.</p>
<p>When specifying this option, continue to use the</p>
<p>__packed</p>
<p>keyword when</p>
<p>pointing to a packed structure, because the compiler must avoid generating</p>
<p>certain assembly instructions in this case. For more information, see âPointing</p>
<p>to Packed Structures with the __packed Type Qualifierâ on page 32.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_misalign_pack</b>) â Misaligned data access is not handled by your</p>
<p>target. The compiler generates extra code to handle packed references.</p>
<p><b>-misalign_pack</b> is useful on processors that support unaligned memory accesses,</p>
<p>such as the V850ES. Accessing unaligned data still requires more instructions on</p>
<p>average than accessing data that is aligned.</p>
<p><b>Warning</b></p>
<p>Attempting to use this option on processors that do not support unaligned</p>
<p>memory accesses will result in code that does not execute correctly.</p>
<p>When using the Green Hills V850 and RH850 simulator (<b>simrh850</b>) to run code</p>
<p>compiled with this option, the simulator must be configured to support unaligned</p>
<p>memory accesses. See<b> -rh850_misalign</b> in âUsing Custom Multi-core Simulator</p>
<p>for V850 and RH850 (simrh850) Connectionsâ in Chapter 6 of the<i> MULTI:</i></p>
<p><i>Configuring Connections for V850 and RH850 Targets</i> book.</p>
<p><b>C/C++ Data Allocation</b></p>
<p>This option category is contained within<b> C/C++ Compiler</b>.</p>
<p>These options control the treatment of data in C and C++.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>216</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Allocation of Uninitialized Global Variables</b></p>
<p>Controls the allocation of uninitialized global variables. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Treat as Common Data</b> (<b>--commons</b>) â [default] Treats a declaration at the</p>
<p>outermost level of a C file such as</p>
<p>int foo;</p>
<p>as<i> common</i> data. Common data</p>
<p>can be defined multiple times, and all declarations will be merged by the linker.</p>
<p>For example, multiple files may have the declaration</p>
<p>int foo;</p>
<p>and the linker</p>
<p>will merge them all into the same data entity.</p>
<p>â¢</p>
<p><b>Treat as Unique Definitions</b> (<b>--no_commons</b>) â Allocates uninitialized</p>
<p>global variables to a section and initializes them to zero at program startup.</p>
<p>This may improve optimizations by giving the compiler optimizer more</p>
<p>information about the location of the variable.</p>
<p>However, if your code contains multiple declarations such as</p>
<p>int foo;</p>
<p>(which</p>
<p>would cause the linker to find multiple definition spots for</p>
<p>foo</p>
<p>), this setting</p>
<p>may also cause</p>
<p>multiply defined symbol</p>
<p>linker errors. In particular, you</p>
<p>may not use a definition such as</p>
<p>int foo;</p>
<p>in a header file if it will be included</p>
<p>in more than one source file. You can avoid these linker errors by using the</p>
<p>extern</p>
<p>keyword for declarations and having a single definition point. For</p>
<p>example:</p>
<p>int foo;</p>
<p>/* used in just one place, or */</p>
<p>int foo=0;</p>
<p>/* used in just one place */</p>
<p>extern int foo; /* used in all other places */</p>
<p><b>Uniquely Allocate All Strings</b></p>
<p>This option is deprecated and may be removed in future versions of MULTI.</p>
<p>Controls the creation of a separate space for all strings, even those which are</p>
<p>equivalent. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--unique_strings</b>) â Create a separate space for all strings.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_unique_strings</b>) â [default] Do not create separate spaces for each</p>
<p>instance of an equivalent string.</p>
<p><i>217</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C/C++ Data Allocation</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Retain Symbols for Unused Statics</b></p>
<p>Controls the retention of symbols for variable and routines that are declared</p>
<p>static</p>
<p>,</p>
<p>but are not used. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--keep_static_symbols</b>) â Retain unused static variables and routines.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_keep_static_symbols</b>) â [default] Discard unused static variables</p>
<p>and routines.</p>
<p><b>Support Variable Length Arrays</b></p>
<p>Enables or disables support for variable length arrays (VLAs) in<b> -c99</b>,<b> -C99</b>, and</p>
<p><b>-gcc</b> modes. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--vla</b>) â [default] Enables support for VLAs.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_vla</b>) â Disables support for VLAs.</p>
<p><b>Special Tokens</b></p>
<p>This option category is contained within<b> C/C++ Compiler</b>.</p>
<p>These options control the treatment of special tokens.</p>
<p><b>Alternative Tokens</b></p>
<p>Controls support for digraphs in C and C++. In C++, this option also controls</p>
<p>whether operator keywords</p>
<p>and</p>
<p>,</p>
<p>or</p>
<p>,</p>
<p>bitand</p>
<p>,</p>
<p>bitor</p>
<p>,</p>
<p>and_eq</p>
<p>,</p>
<p>or_eq</p>
<p>, etc, are</p>
<p>recognized. In C, the same tokens are provided as</p>
<p>#define</p>
<p>directives in<b> iso646.h</b>.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--alternative_tokens</b>) â [default] Enables you to write C and C++ without</p>
<p>using punctuation that might not be available on some international keyboards.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_alternative_tokens</b>)</p>
<p>The following table covers alternatives enabled by this option:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>218</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Alternative</b></p>
<p><b>Punctuation</b></p>
<p>&lt;:</p>
<p>[</p>
<p>:&gt;</p>
<p>]</p>
<p>&lt;%</p>
<p>{</p>
<p>%&gt;</p>
<p>}</p>
<p>%:</p>
<p>#</p>
<p>and</p>
<p>&amp;&amp;</p>
<p>and_eq</p>
<p>&amp;=</p>
<p>bitand</p>
<p>&amp;</p>
<p>bitor</p>
<p>|</p>
<p>compl</p>
<p>~</p>
<p>not</p>
<p>!</p>
<p>not_eq</p>
<p>!=</p>
<p>or</p>
<p>||</p>
<p>or_eq</p>
<p>|=</p>
<p>xor</p>
<p>^</p>
<p>xor_eq</p>
<p>^=</p>
<p><b>Host and Target Character Encoding</b></p>
<p>Controls the character encoding for multibyte extended characters. This option also</p>
<p>affects the</p>
<p>mbtowc()</p>
<p>and</p>
<p>wctomb()</p>
<p>library functions defined in<b> libind.a</b>,<b> libutf8.c</b>,</p>
<p>and<b> lib8bit.a</b>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>EUC on Host and Target</b> (<b>-kanji=euc</b>) â [default for Solaris hosts] Specifies</p>
<p>Kanji character interpretation using the EUC format on the host and target.</p>
<p>â¢</p>
<p><b>Shift-JIS on Host and Target</b> (<b>-kanji=shiftjis</b>) â [default for non-Solaris</p>
<p>hosts] Specifies Kanji character interpretation using the Shift-JIS format on</p>
<p>the host and target.</p>
<p>â¢</p>
<p><b>EUC on Host and Shift-JIS on Target</b> (<b>-kanji=euc/shiftjis</b>) â Specifies</p>
<p>Kanji character interpretation using the EUC format on the host and the Shift-JIS</p>
<p>format on the target.</p>
<p><i>219</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Special Tokens</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Shift-JIS on Host and UTF-8 on Target</b> (<b>-kanji=shiftjis/utf8</b>) â Specifies</p>
<p>Kanji character interpretation using the Shift-JIS format on the host, UTF-8 as</p>
<p>the target multi-byte character encoding, and UTF-32 as the target wide</p>
<p>character encoding.</p>
<p>â¢</p>
<p><b>UTF-8 on Host and Target</b> (<b>-kanji=utf8</b>) â Specifies UTF-8 as the multi-byte</p>
<p>character encoding and UTF-32 as the wide-character encoding.</p>
<p>â¢</p>
<p><b>8-bit Codepage on Host and Target</b> (<b>-kanji=none</b>) â Use 8-bit code pages</p>
<p>(for example, ISO 8859-1). In this mode there are no multibyte characters; the</p>
<p>mapping from bytes to characters is one-to-one.</p>
<p><b>C++</b></p>
<p>This option category is contained within<b> C/C++ Compiler</b>.</p>
<p>These options control aspects of compilation that relate to C++.</p>
<p><b>Namespaces</b></p>
<p>This option category is contained within<b> C/C++ CompilerâC++</b>.</p>
<p>These options control the treatment of namespaces.</p>
<p>Namespace Support</p>
<p>Controls support for namespaces. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--namespaces</b>) â [default for C++ and EEC++]</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_namespaces</b>) â [default for EC++]</p>
<p>Implicit Use of 'std'</p>
<p>Namespace</p>
<p>Controls the implicit use of the</p>
<p>std</p>
<p>namespace when standard header files are</p>
<p>included. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--using_std</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_using_std</b>) â [default]</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>220</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Range-Based For Loops</b></p>
<p>This option category is contained within<b> C/C++ CompilerâC++</b>.</p>
<p>Range-Based For Loop Support</p>
<p>Controls support for C++11-style range-based for loops. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--range_based_for</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_range_based_for</b>) â [default]</p>
<p>Range-based for loops are not supported when namespaces are disabled.</p>
<p>Range-based for loops whose range expressions involve other C++11 features such</p>
<p>as initializer lists and</p>
<p>rvalue</p>
<p>references are not supported.</p>
<p><b>Keyword Support</b></p>
<p>This option category is contained within<b> C/C++ CompilerâC++</b>.</p>
<p>These options control the treatment of various C++ keywords.</p>
<p>Bool Type Support</p>
<p>Controls support for the</p>
<p>bool</p>
<p>type. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--bool</b>) â [default] Also defines the preprocessor symbol</p>
<p>_BOOL</p>
<p>, allowing</p>
<p>code to determine when a</p>
<p>typedef</p>
<p>statement should be used to define the</p>
<p>bool</p>
<p>type.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_bool</b>)</p>
<p>restrict Keyword Support</p>
<p>Controls support for the</p>
<p>restrict</p>
<p>keyword. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--restrict</b>)</p>
<p><i>221</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Off</b> (<b>--no_restrict</b>) â [default]</p>
<p>This keyword is a C99 feature that can be used to indicate that a pointer is not</p>
<p>aliased.</p>
<p>Support __noinline Keyword for Templates</p>
<p>Controls whether the</p>
<p>__noinline</p>
<p>keyword has an effect on member function</p>
<p>templates and member functions of class templates. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--enable_noinline</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--disable_noinline</b>) â [default] The compiler ignores the</p>
<p>__noinline</p>
<p>keyword for member function templates and member functions of class</p>
<p>templates.</p>
<p>For more information, see âAdditional C++ Inlining Informationâ on page 335.</p>
<p>Instantiate Extern Inline</p>
<p>Controls instantiation of</p>
<p>extern inline</p>
<p>functions and inline member functions</p>
<p>of classes that have external linkage.<b> âinstantiate_extern_inline</b> is the default if</p>
<p><b>--large_vtbl_offsets</b> is on. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--instantiate_extern_inline</b>) â Produces exactly one out-of-line copy in</p>
<p>the program for each</p>
<p>inline</p>
<p>function that requires one. The prelinker ensures</p>
<p>that there is one copy, unless you use the<b> --link_once_templates</b> option, in</p>
<p>which case this is enforced with link-once sections (see âLink-Once Template</p>
<p>Instantiationâ on page 227). This option might increase compile time.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_instantiate_extern_inline</b>) â Produces an out-of-line copy of each</p>
<p>extern inline</p>
<p>function and each inline member function of a class with</p>
<p>external linkage in each module that requires a copy. These out-of-line copies</p>
<p>share static data. As a result:</p>
<p>â</p>
<p>If your code compares pointers to such functions from different modules,</p>
<p>they will not be equal.</p>
<p>â</p>
<p>Your code size may be larger.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>222</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For more information about inlining functions in C++, see âManual Inliningâ</p>
<p>on page 325.</p>
<p>New-Style Cast Support</p>
<p>Controls the use of new-style casts (like</p>
<p>static_cast&lt; &gt;</p>
<p>and</p>
<p>reinterpret_cast</p>
<p>&lt; &gt;</p>
<p>) with Embedded C++. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--new_style_casts</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_new_style_casts</b>) â [default]</p>
<p>auto Type Keyword Support</p>
<p>Controls the use of the</p>
<p>auto</p>
<p>keyword as a type specifier for C++11-style type</p>
<p>deduction. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--auto_type</b>) â A variable's type may be omitted and the</p>
<p>auto</p>
<p>keyword</p>
<p>used instead to have the type automatically deduced from the variable's</p>
<p>initializer.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_auto_type</b>) â [default] The</p>
<p>auto</p>
<p>keyword is treated as a storage</p>
<p>class specifier.</p>
<p><b>Constructors/Destructors</b></p>
<p>This option category is contained within<b> C/C++ CompilerâC++</b>.</p>
<p>These options control the treatment of C++ constructors and destructors.</p>
<p>Support for Constructors/Destructors</p>
<p>Controls the insertion of code at the beginning of</p>
<p>main()</p>
<p>to call</p>
<p>_main()</p>
<p>which</p>
<p>is responsible for invoking constructors on global objects that require them, and for</p>
<p>invoking</p>
<p>atexit()</p>
<p>to cause the appropriate destructors to be invoked when the</p>
<p>program finishes. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--enable_ctors_dtors</b>) â [default]</p>
<p><i>223</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Off</b> (<b>--disable_ctors_dtors</b>)</p>
<p>This option only controls the insertion of the call to</p>
<p>_main()</p>
<p>(and hence the</p>
<p>inclusion of</p>
<p>_main()</p>
<p>from the C++ library) and does not affect the generation of</p>
<p>code and data related to invoking constructors for global objects.</p>
<p>Placement of Class Constructor Call to New</p>
<p>Controls the generation of a call to</p>
<p>operator new</p>
<p>in the prologue of each</p>
<p>constructor that optionally allocates memory for the object being constructed. The</p>
<p>default setting is conditional: if<b> --no_large_vtbl_offsets</b> is used, the default is</p>
<p><b>--new_inside_of_constructor</b>. If<b> --large_vtbl_offsets</b> is used, the default is</p>
<p><b>--new_outside_of_constructor</b>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Outside</b> (<b>--new_outside_of_constructor</b>) â Does not call</p>
<p>new</p>
<p>from within</p>
<p>any constructor, which decreases the size of the constructor but increases the</p>
<p>number of instructions required to dynamically allocate a class object. This</p>
<p>setting generates faster code when dynamic allocation of single objects is</p>
<p>infrequent (for instance, when most class objects are allocated on the stack).</p>
<p>â¢</p>
<p><b>Inside</b> (<b>--new_inside_of_constructor</b>) â Places a call to</p>
<p>new</p>
<p>inside each</p>
<p>constructor, which increases the size of the constructor but decreases the number</p>
<p>of instructions required to dynamically allocate a class object. Using this setting</p>
<p>generates faster code when dynamic allocation of single objects is common</p>
<p>(for instance, when most objects are allocated via</p>
<p>operator new</p>
<p>).</p>
<p>The compiler also places a call to</p>
<p>operator delete</p>
<p>in the epilogue of each</p>
<p>destructor. This code is required for the correct handling of virtual destructors in</p>
<p>the presence of a user-defined</p>
<p>operator delete</p>
<p>, and is not affected by</p>
<p><b>--new_outside_of_constructor</b>.</p>
<p>Mixing<b> --new_inside_of_constructor</b> and<b> --new_outside_of_constructor</b> within</p>
<p>the same project may lead to undefined behavior. If an expression of the form</p>
<p>p =</p>
<p>new C</p>
<p>is compiled with<b> --new_inside_of_constructor</b> and the definition of</p>
<p>C::C()</p>
<p>was compiled with<b> --new_outside_of_constructor</b>, neither the caller nor the callee</p>
<p>will allocate memory for</p>
<p>*p</p>
<p>, leading to unexpected behavior. However, if all</p>
<p>constructors are compiled with the default<b> --new_inside_of_constructor</b>, the rest</p>
<p>of the program may safely (but inefficiently) be compiled with</p>
<p><b>--new_outside_of_constructor</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>224</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>RTTI Support</b></p>
<p>This option category is contained within<b> C/C++ CompilerâC++</b>.</p>
<p>These options control the treatment of<i> Run-Time Type Information</i> (RTTI).</p>
<p>Run-Time Type Information Support</p>
<p>Controls support for Run-Time Type Information (RTTI) features</p>
<p>dynamic_cast</p>
<p>and</p>
<p>typeid</p>
<p>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--rtti</b>) â [default for C++. Not supported with EC++ or EEC++]</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_rtti</b>) â [default for EC++ and EEC++]</p>
<p>Treatment of RTTI as const</p>
<p>Controls the treatment of RTTI variables. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--readonly_typeinfo</b>) â [default] Forces RTTI variables to be treated as</p>
<p>const</p>
<p>in the compiler. In most cases,</p>
<p>const</p>
<p>variables end up in the read-only</p>
<p>data.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_readonly_typeinfo</b>)</p>
<p><b>Virtual Tables</b></p>
<p>This option category is contained within<b> C/C++ CompilerâC++</b>.</p>
<p>These options control the treatment of virtual tables.</p>
<p>Virtual Function Definition</p>
<p>Controls the definition of virtual function tables in instances when the compiler</p>
<p>heuristic provides no guidance. The virtual function table for a class is defined in</p>
<p>a compilation if the compilation contains a definition of the first non-inline, non-pure</p>
<p>virtual function of the class. For classes that contain no such function, the default</p>
<p>is to define the virtual function table (but to define it as a local static entity).</p>
<p>Permitted settings for this option are:</p>
<p><i>225</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Force</b> (<b>--force_vtbl</b>) â Forces the definition of virtual function tables for such</p>
<p>classes, but does not force the definitions to be local.</p>
<p>â¢</p>
<p><b>Standard</b> (<b>--standard_vtbl</b>) â [default] Defines the virtual function table as</p>
<p>a local static entity.</p>
<p>â¢</p>
<p><b>Suppress</b> (<b>--suppress_vtbl</b>) â Suppresses the definition of virtual function</p>
<p>tables for such classes.</p>
<p>Treatment of Virtual Tables as 'const'</p>
<p>Controls whether virtual tables are treated as</p>
<p>const</p>
<p>. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--readonly_virtual_tables</b>) â [default] Forces virtual function tables to</p>
<p>be treated as</p>
<p>const</p>
<p>in the compiler. In most cases,</p>
<p>const</p>
<p>tables end up in the</p>
<p>read-only data.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_readonly_virtual_tables</b>)</p>
<p>Virtual Function Table Offset Size</p>
<p>Controls the limit on the size of classes with virtual inheritance. Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>Size of Pointer</b> (<b>--large_vtbl_offsets</b>) â [default] There is a 4 gigabyte limit</p>
<p>on the size of classes with virtual inheritance. Code built with this option is</p>
<p>not compatible with INTEGRITY 11 or earlier, with code built using Green</p>
<p>Hills Compiler 2012.5 or earlier, or with code built using the</p>
<p><b>--no_large_vtbl_offsets</b> option. It is also not compatible with versions of</p>
<p>MULTI that shipped with prior releases, such as MULTI 6.1.4. This setting is</p>
<p>incompatible with the<b> --no_link_once_templates</b> option.</p>
<p>â¢</p>
<p><b>Size of Unsigned Short</b> (<b>--no_large_vtbl_offsets</b>) â There is a 32 kilobyte</p>
<p>limit on the size of classes with virtual inheritance. The virtual inheritance</p>
<p>model in code built with this option is compatible with that in code built with</p>
<p>Green Hills Compiler 2012.5 and earlier. This setting is deprecated.</p>
<p>If you try to link two modules that are not compatible because of this option, the</p>
<p>linker will issue the following diagnostic:</p>
<p>[elxr] (error) Possible C++ virtual function table format incompatibility between modules.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>226</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Templates</b></p>
<p>This option category is contained within<b> C/C++ CompilerâC++</b>.</p>
<p>These options control C++ template instantiation. For a full description of this</p>
<p>feature, see âTemplate Instantiationâ on page 746.</p>
<p>Link-Once Template Instantiation</p>
<p>Controls the link-once method of non-export template instantiation. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--link_once_templates</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_link_once_templates</b>)</p>
<p>Guiding Declarations of Template Functions</p>
<p>Controls recognition of<i> guiding declarations</i> of template functions. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--guiding_decls</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_guiding_decls</b>) â [default]</p>
<p>A guiding declaration is a function declaration that matches an instance of a function</p>
<p>template but has no explicit definition (since its definition derives from the function</p>
<p>template). For example:</p>
<p>template &lt;class T&gt; void f(T t) {</p>
<p>// ...</p>
<p>}</p>
<p>void f(int);</p>
<p>When regarded as a guiding declaration,</p>
<p>f(int)</p>
<p>is an instance of the template;</p>
<p>otherwise it is an independent function for which a definition must be supplied. If</p>
<p>this option is disabled and<b> C/C++ CompilerâC++âTemplatesâSupport for</b></p>
<p><b>Old-Style Specializations</b> remains enabled, a specialization of a non-member</p>
<p>template function is not recognized. It is treated as a definition of an independent</p>
<p>function.</p>
<p><i>227</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Implicit Source File Inclusion</p>
<p>Controls implicit inclusion of source files as a method of finding definitions of</p>
<p>template entities to be instantiated. For more information, see âImplicit Inclusionâ</p>
<p>on page 751. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--implicit_include</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_implicit_include</b>) â [default]</p>
<p>Support for Implicit Typenames</p>
<p>Controls the implicit determination, from context, of whether a template</p>
<p>parameter-dependent name is a type or a nontype. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--implicit_typename</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_implicit_typename</b>) â [default]</p>
<p>Support for Old-Style Specializations</p>
<p>Controls the treatment of old-style template specializations (that is, specializations</p>
<p>that do not use the</p>
<p>template&lt;&gt;</p>
<p>syntax). Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--old_specializations</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_old_specializations</b>) â [default]</p>
<p>One Instantiation Per Object</p>
<p>Controls whether template instantiations are put in separate object files. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--one_instantiation_per_object</b>) â Puts each instantiation of a template</p>
<p>or</p>
<p>extern inline</p>
<p>function (see âInstantiate Extern Inlineâ on page 222) in</p>
<p>a separate template instantiation object file, with a unique filename that</p>
<p>corresponds to the name of the instantiated entity. The primary object file (the</p>
<p>object file corresponding to the original source file) contains everything else</p>
<p>in the compilation; that is, everything that is not an instantiation.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>228</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The<b> gbuild</b> options<b> -clean</b> and<b> -cleanfirst</b> and the<b> clean</b> menu items in the</p>
<p>Project Manager do not delete template instantiation object files (though they</p>
<p>do delete primary object files).</p>
<p>â¢</p>
<p><b>Hybrid</b> (<b>--hybrid_one_instantiation_per_object</b>) â Puts each instantiation</p>
<p>in the compilation in a separate object file, except where they are created by</p>
<p>#pragma instantiate</p>
<p>. Instances created by</p>
<p>#pragma instantiate</p>
<p>are</p>
<p>added to the primary object file generated from the source file in which they</p>
<p>appear.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_one_instantiation_per_object</b>) â [default]</p>
<p>If you are creating a library, we recommend that you set this option to<b> On</b> or<b> Hybrid</b>.</p>
<p>By putting each instantiation in a separate object file within the library, only those</p>
<p>instantiations that are needed will be pulled in, thus reducing code size. One of these</p>
<p>options must be enabled if two different libraries include some of the same</p>
<p>instantiations, in order to avoid multiply defined symbols.</p>
<p>Template Instantiation Output Directory</p>
<p>When<b> C/C++ CompilerâC++âTemplatesâOne Instantiation Per Object</b> is</p>
<p>enabled (<b>--one_instantiation_per_object</b>), this option can be used to specify or</p>
<p>create a<i> directory</i> into which the generated object files should be put. Multiple</p>
<p>projects may not share an instantiation directory. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>--instantiation_dir=<i>directory</b></i></p>
<p>The default instantiation directory is<b> ./template_dir</b>.</p>
<p>If the directory setting used for<b> -instantiation_dir</b> is a relative path, that path is</p>
<p>resolved relative to the Object File Output Directory (<b>-object_dir</b>). If<b> -object_dir</b></p>
<p>is not set, then the Instantiation Directory path is relative to the current working</p>
<p>directory.</p>
<p>Dependent Name Processing</p>
<p>Controls the separate lookup of names in templates at the time the template is parsed</p>
<p>and at the time it is instantiated. Permitted settings for this option are:</p>
<p><i>229</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>On</b> (<b>--dep_name</b>) â [default for<b> --g++</b> and<b> --STD</b> modes] Also implies<b> C/C++</b></p>
<p><b>CompilerâC++âTemplatesâParse Templates in Generic Form</b></p>
<p>(<b>--parse_templates</b>).</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_dep_name</b>) â [default for all other modes]</p>
<p>Parse Templates in Generic Form</p>
<p>Controls the parsing of nonclass templates in their generic form (i.e., even if they</p>
<p>are not really instantiated). Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--parse_templates</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_parse_templates</b>) â [default]</p>
<p>This option is implied by<b> Dependent Name Processing</b> (see âDependent Name</p>
<p>Processingâ on page 229).</p>
<p>Recognition of Exported Templates</p>
<p>This option is deprecated and will be removed in a future release.</p>
<p>Controls recognition of exported templates. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--export</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_export</b>) â [default]</p>
<p>This option enables<b> C/C++ CompilerâC++âTemplatesâDependent Name</b></p>
<p><b>Processing</b> (<b>--dep_name</b>) (see above). It cannot be used with<b> C/C++</b></p>
<p><b>CompilerâC++âTemplatesâImplicit Source File Inclusion</b></p>
<p>(<b>--implicit_include</b>).</p>
<p>No levels of interprocedural optimizations are supported with export templates. If</p>
<p>any level is selected it will be disabled.</p>
<p>Prelink File to Create Template Instances</p>
<p>Specifies an external object file or executable to notify the prelinker of existing</p>
<p>template instances. The equivalent driver option is:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>230</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>-prelink_against<i> file</b></i></p>
<p>Deferral of Function Template Parsing</p>
<p>If function templates are being parsed in their generic form (i.e.<b> --parse_templates</b></p>
<p>is on), this option controls whether the parsing of the generic form of a template</p>
<p>happens immediately upon the template's definition or is deferred until the end of</p>
<p>the file. Furthermore, unused function templates will not be parsed at all (not even</p>
<p>in their generic form). If<b> --no_parse_templates</b> is selected or defaulted to, this</p>
<p>option has no effect. Note that this option is primarily for GNU compatibility.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--defer_parse_function_templates</b>) â Referenced function templates</p>
<p>are parsed in their generic form at the end of the file. Unreferenced function</p>
<p>templates will not be parsed at all. This option is enabled by default in the</p>
<p><b>--g++</b> dialect.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_defer_parse_function_templates</b>) â All function templates will</p>
<p>be parsed in their generic form when their definition is seen. This option is</p>
<p>enabled by default in all other dialects.</p>
<p><i>231</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Assembler Options</b></p>
<p>This is a top-level option category.</p>
<p>These options control the general operation of the assembler.</p>
<p>For additional, more specialized options, see âAssembler Optionsâ on page 312.</p>
<p><b>Source Listing Generation</b></p>
<p>Controls the generation of a source listing. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Generate Default Listing</b> (<b>-list</b>) â Creates a listing by using the name of the</p>
<p>object file with the<b> .lst</b> extension.</p>
<p>â¢</p>
<p><b>Generate User-Specified Listing</b> (<b>-list=<i>filename</b></i>) â Creates a listing with</p>
<p>the specified<i> filename</i>.</p>
<p>â¢</p>
<p><b>Suppress Listing</b> (<b>-no_list</b>) â [default]</p>
<p><b>Source Listing Generation Output Directory</b></p>
<p>Outputs assembly listing files in the specified directory. By default, listing files are</p>
<p>output in the same directory as the object file. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-list_dir=<i>directory</b></i></p>
<p><b>Preprocess Assembly Files</b></p>
<p>Controls whether assembly files with standard extensions such as<b> .s</b> and<b> .asm</b> are</p>
<p>preprocessed. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-preprocess_assembly_files</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_preprocess_assembly_files</b>) â [default] Only assembly files with</p>
<p>special extensions are preprocessed.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>232</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Preprocess Special Assembly Files</b></p>
<p>Controls whether assembly files with a<b> .800</b> extension are preprocessed. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-preprocess_special_assembly_files</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_preprocess_special_assembly_files</b>) â Files with a<b> .800</b> extension</p>
<p>are not preprocessed.</p>
<p><b>Interleaved Source and Assembly</b></p>
<p>Controls the interleaving of your original source code with the generated assembly</p>
<p>code. Normally used with the<b> AssemblerâSource Listing Generation</b> option.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-passsource</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nopasssource</b>) â [default]</p>
<p>Not every line of the original source code will appear in the output.</p>
<p><b>Additional Assembler Options</b></p>
<p>Passes the specified assembler options to the<b> ease850</b> assembler command line.</p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-asm=<i>options</b></i> â To pass multiple options, separate the options by spaces and</p>
<p>enclose the whole string in quotes, or specify<b> -asm=<i>options</b></i> multiple times.</p>
<p>For example:</p>
<p>-asm=&quot;-nogen -ref -w&quot;</p>
<p>or:</p>
<p>-asm=-nogen -asm=-ref -asm=-w</p>
<p>For a full list of assembler options which may be passed in this manner, see</p>
<p>Chapter 6, âThe ease850 Assemblerâ on page 393.</p>
<p><i>233</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Preprocess Special Assembly Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Assembler Command File</b></p>
<p>Passes the options specified in<i> filename</i> directly to the assembler. The equivalent</p>
<p>driver option is:</p>
<p>â¢</p>
<p><b>-asmcmd=<i>filename</b></i></p>
<p>The file must contain only one assembler option per line. For example:</p>
<p>-nogen</p>
<p>-ref</p>
<p>-w</p>
<p>For a full list of assembler options which may be passed in this manner, see</p>
<p>Chapter 6, âThe ease850 Assemblerâ on page 393.</p>
<p><b>Support for C Type Information in Assembly</b></p>
<p>Controls assembler support for the</p>
<p>.inspect</p>
<p>and</p>
<p>.struct</p>
<p>directives, and the</p>
<p>offsetof()</p>
<p>and</p>
<p>sizeof()</p>
<p>operators. These allow you to parse C header files to</p>
<p>get type information, and use it to define objects in assembly. For more information,</p>
<p>see Chapter 7, âAssembler Directivesâ on page 411, and âC Type Information</p>
<p>Operatorsâ on page 405. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-asm3g</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-noasm3g</b>) â [default]</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>234</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Linker Options</b></p>
<p>This is a top-level option category.</p>
<p>These options control the general operation of the linker. If you use the driver to</p>
<p>compile and link your program in multiple steps, pass the same set of options for</p>
<p>each step.</p>
<p>For additional, more specialized options, see the advanced linker options section</p>
<p>(âLinker Optionsâ on page 313).</p>
<p><b>Output File Type</b></p>
<p>Controls the form of linker output. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Executable / Located Program</b> (<b>-locatedprogram</b>) â [default] Generates</p>
<p>an executable program.</p>
<p>â¢</p>
<p><b>Relocatable Object File</b> (<b>-relobj</b>) â Generates a relocatable object file, suitable</p>
<p>for passing as input to another run of the linker. Implies<b> -nostdlib</b>, meaning</p>
<p>the linker does not link in any startup files or libraries, and<b> -undefined</b>, meaning</p>
<p>the linker does not allocate common variables or give errors for undefined</p>
<p>symbols, as<b> Relocatable Program</b> does.</p>
<p>If you are generating debug information for a relocatable object file with<b> -G</b></p>
<p>and the machine that will be performing the subsequent link does not have</p>
<p>access to the original<b> .o</b> or<b> .dbo</b> files, pass the<b> -search_for_dba</b> option. This</p>
<p>option creates a<b> .dba</b> file that you can distribute with the relocatable object file</p>
<p>to provide debug information to MULTI. When performing subsequent links</p>
<p>with the relocatable object file, continue to pass the<b> -search_for_dba</b> option.</p>
<p>This option passes<b> -r</b> to the linker.</p>
<p>â¢</p>
<p><b>Relocatable Program</b> (<b>-relprog</b>) â Retains relocation information in the</p>
<p>output file. The resulting file is suitable for execution. Some of the final link</p>
<p>steps, including but not limited to C++ constructors and special symbols, are</p>
<p>not guaranteed to have relocations, and thus might not be valid if the output</p>
<p>file is loaded at a different address. This option passes<b> -a</b> to the linker.</p>
<p><i>235</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Linker Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Generate Additional Output</b></p>
<p>Creates the specified output type in addition to the project executable. The syntax</p>
<p><b>-<i>format</i>=<i>name</b></i> allows you to specify the name of the file. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>Memory Image File</b> (<b>-memory</b>,<b> -memory=<i>name</b></i>) â Generates output file</p>
<p>with</p>
<p>.mem</p>
<p>extension containing the output of the image as translated by the</p>
<p><b>gmemfile</b> utility program. For more information about<b> gmemfile</b>, see âThe</p>
<p>gmemfile Utility Programâ on page 574.</p>
<p>â¢</p>
<p><b>S-Record File</b> (<b>-srec</b>,<b> -srec=<i>name</b></i>) â Generates output file with</p>
<p>.run</p>
<p>extension containing the output of the image as translated by the<b> gsrec</b> utility</p>
<p>program. For more information about<b> gsrec</b>, see âThe gsrec Utility Programâ</p>
<p>on page 594.</p>
<p>â¢</p>
<p><b>HEX386 File</b> (<b>-hex</b>,<b> -hex=<i>name</b></i>) â Generates output file in HEX386 format</p>
<p>with</p>
<p>.run</p>
<p>extension containing the output of the image as translated by the</p>
<p><b>gsrec</b> utility program with<b> -hex386</b> passed to it. For more information about</p>
<p><b>gsrec</b>, see âThe gsrec Utility Programâ on page 594.</p>
<p>â¢</p>
<p><b>None</b> (<b>--no_additional_output</b>) â [default] You can use this option in a</p>
<p>MULTI Project (<b>.gpj</b>) file, but there is no equivalent driver option.</p>
<p><b>Executable Stripping</b></p>
<p>Controls<i> stripping</i> the executable at the conclusion of linking. Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-strip</b>) â Stripping involves removing line number, symbol table, and</p>
<p>debugging information to reduce the file size of the executable.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nostrip</b>) â [default]</p>
<p>For information about stripping executables after link-time, see âThe gstrip Utility</p>
<p>Programâ on page 620.</p>
<p><b>Start Address Symbol</b></p>
<p>Specifies the program entry point or start address. The argument must be the name</p>
<p>of a symbol in an executable section or an address in an executable section. (See</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>236</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>âSpecifying the Program Entry Pointâ on page 475.) Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>Start Address</b> (<b>-entry<i> symbol</b></i>|<b>-e<i> symbol</b></i>) â The default symbol is</p>
<p>_start</p>
<p>.</p>
<p>â¢</p>
<p><b>No Entry Symbol</b> (<b>-noentry</b>)</p>
<p><b>Append Comment Section with Link-Time Information</b></p>
<p>Controls whether the assembler and linker output tools version information into</p>
<p>object files. Similar to using</p>
<p>#pragma ident</p>
<p>(see âGeneral Pragma Directivesâ</p>
<p>on page 796). Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Qy</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Qn</b>) â [default]</p>
<p><b>Preprocess Linker Directives Files</b></p>
<p>Controls the level of preprocessing performed on linker directives files. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>Full</b> (<b>--preprocess_linker_directive_full</b>) â The C preprocessor preprocesses</p>
<p>linker directives files.</p>
<p>â¢</p>
<p><b>Partial</b> (<b>--preprocess_linker_directive</b>) â The C preprocessor resolves</p>
<p>preprocessing directives such as</p>
<p>#include</p>
<p>,</p>
<p>#if</p>
<p>, and</p>
<p>#ifdef</p>
<p>. The preprocessor</p>
<p>expands macros in preprocessing directives, but not in the rest of the file.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_preprocess_linker_directive</b>) â [default]</p>
<p><b>Linker Warnings</b></p>
<p>Controls the display of linker warnings. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Display</b> (<b>-linker_warnings</b>) â [default]</p>
<p>â¢</p>
<p><b>Suppress</b> (<b>-no_linker_warnings</b>)</p>
<p><i>237</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Append Comment Section with Link-Time Information</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Raw Import Files</b></p>
<p>Imports data from arbitrary files (such as binary files) into a section named</p>
<p>.raw</p>
<p>.</p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-rawimport</b></p>
<p>If your section map does not specify a section named</p>
<p>.raw</p>
<p>, the linker issues a</p>
<p>warning. To silence the warning, add a section named</p>
<p>.raw</p>
<p>to your section map.</p>
<p>Alternatively, you can select a section for each imported file using section inclusion</p>
<p>commands in your linker directives (<b>.ld</b>) file. For example, to import the file</p>
<p><b>rawdata.bin</b> and place the data in the section</p>
<p>.myrawdata</p>
<p>, use<b> -rawimport</b></p>
<p><b>rawdata.bin</b> and add the following line to your section map:</p>
<p>.myrawdata :{rawdata.bin(.raw)}</p>
<p>By default, imported sections become read-only data sections. To make a section</p>
<p>writable or executable, use the</p>
<p>SHFLAGS</p>
<p>section attribute. To access the data, adapt</p>
<p>the following example:</p>
<p>extern char __ghsbegin_myrawdata[], __ghsend_myrawdata[];</p>
<p>int main() {</p>
<p>const char *p=__ghsbegin_myrawdata;</p>
<p>/* print contents of raw section, one byte at a time */</p>
<p>while( p &lt; __ghsend_myrawdata ){</p>
<p>printf(&quot;0x%02x &quot;, (unsigned char)*p);</p>
<p>p++;</p>
<p>}</p>
<p>return 0;</p>
<p>}</p>
<p>For more information, see âUsing Section Attributesâ on page 490 and âDefining a</p>
<p>Section Map with the SECTIONS Directiveâ on page 481.</p>
<p><b>Linker Directive Files with Non-standard Extensions</b></p>
<p>Passes<i> file</i> with a non-standard extension to the linker as a linker directives file,</p>
<p>instead of any default file. You can use this option multiple times.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>238</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-T<i> directives_file</b></i></p>
<p>The following list describes how the compiler interprets<b> -T</b> depending on the name</p>
<p>of<i> file</i>:</p>
<p>â¢</p>
<p><i>file</i> has a known linker directives extension (<b>.ld</b>) â While the compiler passes</p>
<p>the file to the linker,<b> -T</b> is not necessary. In this case, pass just the filename to</p>
<p>the driver.</p>
<p>â¢</p>
<p><i>file</i> has an extension commonly used for source files or object files (<b>.c</b>,<b> .obj</b>,</p>
<p><b>.a</b>, etc.) â The compiler issues the following warning and ignores<b> -T</b>:</p>
<p>Warning: Option &quot;-T&quot; ignored due to invalid suffix of argument<i> file</i>.</p>
<p>Use .ld as suffix</p>
<p>â¢</p>
<p><i>file</i> begins with a hyphen (</p>
<p>-</p>
<p>) â The compiler issues the following warning</p>
<p>and ignores<b> -T</b>:</p>
<p>Warning: Option &quot;-T&quot; ignored due to invalid argument -<i>file</i>.</p>
<p>expected directory or filename, without leading -</p>
<p><b>Additional Linker Options (beginning of link line)</b></p>
<p>Passes the specified linker<i> options</i> to the<b> elxr</b> linker command line at the very</p>
<p>beginning of the line, before any<b> .ld</b> files, and before any other options. The</p>
<p>equivalent driver option is:</p>
<p>â¢</p>
<p><b>-lnk0=<i>options</b></i> â To pass multiple options, separate the options by spaces and</p>
<p>enclose the entire string in quotes, or specify<b> -lnk0=<i>options</b></i> multiple times.</p>
<p>For example:</p>
<p>-lnk0=&quot;-multiple -undefined&quot;</p>
<p>or:</p>
<p>-lnk0=-multiple -lnk0=-undefined</p>
<p>For more information about linker-specific options, see âLinker-Specific Optionsâ</p>
<p>on page 471.</p>
<p><i>239</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Additional Linker Options (beginning of link line)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For additional information about passing linker options directly, see âAdditional</p>
<p>Linker Options (before start file)â on page 240.</p>
<p><b>Additional Linker Options (before start file)</b></p>
<p>Passes the specified linker<i> options</i> to the linker command line after any<b> .ld</b> files and</p>
<p>after most default options, but before the start files. The equivalent driver option</p>
<p>is:</p>
<p>â¢</p>
<p><b>-lnk=<i>options</b></i> â To pass multiple options, separate the options by spaces and</p>
<p>enclose the whole string in quotes, or specify<b> -lnk=<i>options</b></i> multiple times.</p>
<p>For example:</p>
<p>-lnk=&quot;-multiple -undefined&quot;</p>
<p>or:</p>
<p>-lnk=-multiple -lnk=-undefined</p>
<p>There are three options for passing options through to the linker command line.</p>
<p>Each of the three options places its argument on the linker command line in a</p>
<p>different location as described in the following list:</p>
<p>â¢</p>
<p><b>-lnk0=</b> should be used for options that must appear at the very beginning of</p>
<p>the linker command line, before the linker directives files, and before any</p>
<p>options that are passed by the driver.</p>
<p>â¢</p>
<p><b>-lnk=</b> causes the options to appear after many of the drivers options, but before</p>
<p>any object files. Options that enable or disable a feature have a higher</p>
<p>precedence if passed with<b> -lnk=</b> than with<b> -lnk0=</b>.</p>
<p>â¢</p>
<p><b>-Wl</b> should be used in the rare case that an option must appear in between</p>
<p>object files on the linker command line, or if an option must appear at the end</p>
<p>of the linker command line. The position of the<b> -Wl</b> option on the driver</p>
<p>command line determines its position on the linker command line, relative to</p>
<p>all source and object files.</p>
<p>For more information about linker-specific options, see âLinker-Specific Optionsâ</p>
<p>on page 471.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>240</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Additional Linker Options (among object files)</b></p>
<p>Passes the specified linker options to the linker in approximately the position that</p>
<p>it appears on the driver command line. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-Wl,<i>option</i>[,<i>option</i>]â¦</b></p>
<p>For more information about linker-specific options, see âLinker-Specific Optionsâ</p>
<p>on page 471.</p>
<p>For additional information about passing linker options directly, see âAdditional</p>
<p>Linker Options (before start file)â on page 240.</p>
<p><b>Linker Command File</b></p>
<p>Passes the options specified in<i> filename</i> directly to the linker. The equivalent driver</p>
<p>option is:</p>
<p>â¢</p>
<p><b>-lnkcmd=<i>filename</b></i></p>
<p>The file must contain only one linker option per line. For example:</p>
<p>-nogen</p>
<p>-ref</p>
<p>-w</p>
<p>For more information about linker-specific options, see âLinker-Specific Optionsâ</p>
<p>on page 471.</p>
<p><b>Extract Whole Archive</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--whole-archive</b>) â Cause all files to be extracted from any library that</p>
<p>appears after the option<b> --whole-archive</b> on the command line until</p>
<p><b>--no-whole-archive</b>.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no-whole-archive</b>) â [default] Undo the effect of any<b> --whole-archive</b></p>
<p>option for any libraries after the option<b> --no-whole-archive</b> until</p>
<p><b>--whole-archive</b>.</p>
<p><i>241</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Additional Linker Options (among object files)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>These options only apply to libraries specified on the<b> ccv850</b> command line and</p>
<p>not to any libraries selected implicitly by the<b> ccv850</b> command. These options can</p>
<p>be used when creating a merged archive if the option<b> -merge_archive</b> is also used.</p>
<p>If the same library is specified on the command line twice, all of its contents will</p>
<p>be extracted twice even if only one instance of that library on the command line is</p>
<p>after<b> --whole-archive</b>.</p>
<p><b>Report an Error When Multiple Libraries on a Link Line Contain a Definition</b></p>
<p><b>of the Same Symbol</b></p>
<p>Controls whether an error is reported when a symbol is defined in multiple libraries</p>
<p>on the link line. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-link_reject_duplicate_lib_syms</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_link_reject_duplicate_lib_syms</b>) â [default]</p>
<p><b>When Rejecting Duplicate Symbols, Allow Certain Symbols Added by the</b></p>
<p><b>compiler</b></p>
<p>When rejecting duplicate symbols, controls whether those known to be generated</p>
<p>by the compiler (as opposed to those present in source) are allowed. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-link_allow_duplicate_ghs_syms</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_link_allow_duplicate_ghs_syms</b>) â [default]</p>
<p><b>When Rejecting Duplicate Symbols, Allow Symbols in .ghs.linkonce</b></p>
<p><b>sections</b></p>
<p>When rejecting duplicate symbols, controls whether those in</p>
<p>.ghs.linkonce</p>
<p>sections are allowed. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-link_allow_duplicate_linkonce_syms</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_link_allow_duplicate_linkonce_syms</b>) â [default]</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>242</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Duplicate Whitelist</b></p>
<p>When rejecting duplicate symbols, allows those present in the specified whitelist.</p>
<p>A whitelist is a text file with one symbol per newline. To allow all symbols from</p>
<p>a library, use</p>
<p>@libfoo.a</p>
<p>where</p>
<p>libfoo.a</p>
<p>is the base name of the library. Path</p>
<p>information should be omitted, and symbols will be allowed from any library with</p>
<p>that name. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-duplicate_whitelist=<i>whitelist</b></i></p>
<p><b>Linker Optimizations</b></p>
<p>This option category is contained within<b> Linker</b>.</p>
<p>These options control individual optimizations that can be implemented at link-time.</p>
<p>You can enable or disable all of them with the<b> OptimizationâLinker</b></p>
<p><b>Optimizations</b> option (see âOptimization Optionsâ on page 165).</p>
<p><b>Deletion of Unused Functions</b></p>
<p>Controls the removal from the executable of functions that are unused and</p>
<p>unreferenced. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-delete</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_delete</b>) â [default]</p>
<p>For a list of functions that have been deleted, pass the<b> -lnk=-v</b> option. Certain</p>
<p>options that create references to functions may inhibit<b> -delete</b>. For more information,</p>
<p>see âDeleting Unused Functionsâ on page 507.</p>
<p><b>Code Factoring</b></p>
<p>Controls the code factoring optimization, which reduces code size by merging</p>
<p>redundant sequences of object code at link-time. We recommend that you use this</p>
<p>optimization only if your primary goal is reducing program size; for most programs,</p>
<p>code factoring increases branching and decreases execution speed. Permitted settings</p>
<p>for this option are:</p>
<p><i>243</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Duplicate Whitelist</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>On</b> (<b>-codefactor</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_codefactor</b>) â [default]</p>
<p>For more information see âCode Factoringâ on page 509.</p>
<p><b>Link-Time Ignore Debug References</b></p>
<p>Controls whether or not the linker ignores relocations from DWARF debug sections</p>
<p>when you are using the<b> -delete</b> option. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-ignore_debug_references</b>) â [default] Ignores relocations from DWARF</p>
<p>debug sections when using<b> -delete</b>. DWARF debug information will contain</p>
<p>references to deleted functions that may break some third-party debuggers.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_ignore_debug_references</b>) â Does not ignore relocations from</p>
<p>DWARF debug sections when using<b> -delete</b>. DWARF debugging information</p>
<p>generated by<b> -dual_debug</b> greatly reduces the effectiveness of<b> -delete</b>.</p>
<p><b>Start and End Files</b></p>
<p>This option category is contained within<b> Linker</b>.</p>
<p>These options control the use of start and end files.</p>
<p><b>Start Files</b></p>
<p>Controls the start files to be linked into the executable. The default is to use the</p>
<p>Green Hills start files. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Use Specified Start Files</b> (<b>-startfiles=<i>filename</i>[,<i>filename</i>â¦]</b>)</p>
<p>â¢</p>
<p><b>Do Not Use Start Files</b> (<b>-nostartfiles</b>)</p>
<p><b>End Files</b></p>
<p>Specifies end files to be linked into the executable. End files are the last object files</p>
<p>passed on the command line to the linker. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-endfile=<i>filename</i>[,<i>filename</i>â¦]</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>244</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Start File Directory</b></p>
<p>Specifies the directory that contains start files, end files, and the default linker</p>
<p>directives file. The effect of this option on each type of file is overridden by</p>
<p><b>-startfiles</b>,<b> -endfile</b>, and<b> -directive_dir</b>. If you are building an INTEGRITY project</p>
<p>that is not a kernel, this option has no effect on the location of the default linker</p>
<p>directives file. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-startfile_dir=<i>directory</b></i></p>
<p><b>Symbols</b></p>
<p>This option category is contained within<b> Linker</b>.</p>
<p>These options control the linker's treatment of symbols.</p>
<p><b>Multiply-Defined Symbols</b></p>
<p>Controls the treatment of multiply-defined symbols. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Errors</b> (<b>-no_multiple</b>) â [default]</p>
<p>â¢</p>
<p><b>Silent</b> (<b>-multiple</b>)</p>
<p>We recommend that you do not use<b> -multiple</b>, because some optimizations may</p>
<p>assume that all objects and functions have one definition (except</p>
<p>weak</p>
<p>functions</p>
<p>and</p>
<p>COMMON</p>
<p>variables).</p>
<p><b>Undefined Symbols</b></p>
<p>Controls the treatment of undefined symbol references. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Errors</b> (<b>-no_undefined</b>) â [default]</p>
<p>â¢</p>
<p><b>Silent</b> (<b>-undefined</b>) â The linker gives each undefined symbol an address of</p>
<p>zero, or a zero offset if you are using PID. If the symbol would normally be</p>
<p>assigned to a special data area, it is given an address in the appropriate special</p>
<p>data area section.</p>
<p><i>245</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Symbols</i></p>
<h1 style="page-break-before:always; "></h1>
<p>We recommend that you do not use<b> -undefined</b>, because some optimizations may</p>
<p>assume that all objects and functions have one definition (except</p>
<p>weak</p>
<p>functions</p>
<p>and</p>
<p>COMMON</p>
<p>variables).</p>
<p><b>Define Linker Constant</b></p>
<p>Sets a default value that can be used in section and memory maps. This option</p>
<p>overrides any default value specified in a linker directives file. The equivalent driver</p>
<p>option is:</p>
<p>â¢</p>
<p><b>-C<i>name</i>=<i>value</b></i></p>
<p><b>Force Undefined Symbol</b></p>
<p>Forces an undefined symbol reference for<i> symbol</i>, as if there had been some use of</p>
<p>the symbol in one of the modules to be linked. This may cause modules to be linked</p>
<p>in from libraries that would not otherwise be included. The equivalent driver option</p>
<p>is:</p>
<p>â¢</p>
<p><b>-u<i> symbol</b></i></p>
<p><b>Force All Symbols From Library</b></p>
<p>Pulls in every exported symbol from the specified library, instead of pulling in only</p>
<p>those symbols that are required. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-extractall=<i>library</b></i></p>
<p>Where the<i> library</i> parameter must exactly match the way that the library is specified</p>
<p>on the command line. For example, use</p>
<p>-ltest</p>
<p>for the<i> library</i> parameter instead</p>
<p>of</p>
<p>libtest.a</p>
<p>.</p>
<p>To pull in all the symbols from two or more libraries, pass multiple<b> -extractall</b></p>
<p>options, or pass one<b> -extractall</b> option with a comma-separated list of library names.</p>
<p>For example, the following are equivalent:</p>
<p>-extractall=-lfoo,-lbar</p>
<p>-extractall=-lfoo -extractall=-lbar</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>246</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>The builder may expand relative paths for any libraries specified as files,</p>
<p>requiring you to use the full path as the argument to<b> -extractall</b>.To specify</p>
<p>the full path in a portable manner, see the</p>
<p>%expand_path</p>
<p>macro function</p>
<p>in âMacro Functionsâ on page 969.</p>
<p><b>Export All Symbols From Library</b></p>
<p>Exports all symbols from the specified library. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-exportall=<i>library</b></i></p>
<p>Where the<i> library</i> parameter must exactly match the way that the library is specified</p>
<p>on the command line. For example, use</p>
<p>-ltest</p>
<p>for the<i> library</i> parameter instead</p>
<p>of</p>
<p>libtest.a</p>
<p>.</p>
<p>To export all the symbols from two or more libraries, pass multiple<b> -exportall</b></p>
<p>options, or pass one<b> -exportall</b> option with a comma-separated list of library names.</p>
<p>For example, the following are equivalent:</p>
<p>-exportall=-lfoo,-lbar</p>
<p>-exportall=-lfoo -exportall=-lbar</p>
<p><b>Import Symbols</b></p>
<p>Makes available symbol names and addresses from a separately linked, fully located</p>
<p>file during linking. The linker does not include the contents of the file in the output;</p>
<p>it only imports those symbol addresses necessary for the current link. This option</p>
<p>is useful when one linker image must refer to symbols that are located in another</p>
<p>separately linked image. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-A<i> file</b></i></p>
<p>Where<i> file</i> must be a file linked with the<b> -locatedprogram</b> option.</p>
<p>When linking one INTEGRITY POSIX DLL, you may use<b> -A</b> to link against another.</p>
<p>For example:</p>
<p>--posix_dll -o lib1.dll -A lib2.dll</p>
<p><i>247</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Symbols</i></p>
<h1 style="page-break-before:always; "></h1>
<p>This tells the linker that it is expected that</p>
<p>lib1.dll</p>
<p>will only be loaded into a</p>
<p>program which has already loaded</p>
<p>lib2.dll</p>
<p>. The linker will allow unresolved</p>
<p>symbols in</p>
<p>lib1.dll</p>
<p>provided that they are exported by</p>
<p>lib2.dll</p>
<p>. This is in</p>
<p>preference to doing:</p>
<p>--posix_dll -o lib1.dll -undefined</p>
<p><b>Linker Output Analysis</b></p>
<p>This option category is contained within<b> Linker</b>.</p>
<p>These options control various forms of linker output.</p>
<p><b>Map File Generation</b></p>
<p>Controls the generation of a map file. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Generate Default Map File</b> (<b>-map</b>) â [default] Creates a map file with the</p>
<p>name of the object file plus a<b> .map</b> extension.</p>
<p>â¢</p>
<p><b>Generate User-Specified Map File</b> (<b>-map=<i>filename</b></i>) â Creates a map file</p>
<p>with the specified<i> filename</i>.</p>
<p>â¢</p>
<p><b>Suppress Map</b> (<b>-nomap</b>)</p>
<p><b>Map File Retention</b></p>
<p>Controls the retention of the map file in the event of a link error. Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-keepmap</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nokeepmap</b>) â [default]</p>
<p><b>Map File Page Length</b></p>
<p>Specifies the length,<i> n</i>, of a map file page. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-maplines=<i>n</b></i></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>248</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Map File Sorting</b></p>
<p>Controls the method for ordering the map file. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>Alphabetic</b> (<b>-Ma</b>) â [default] Generates a listing of symbols sorted</p>
<p>alphabetically by name.</p>
<p>â¢</p>
<p><b>Numeric</b> (<b>-Mn</b>) â Generates a listing of symbols sorted numerically by</p>
<p>address.</p>
<p>â¢</p>
<p><b>Both Alphabetic and Numeric</b> (<b>-Man</b>|<b>-Mna</b>) â Generates both a listing of</p>
<p>symbols sorted alphabetically by name and a listing of symbols sorted</p>
<p>numerically by address.</p>
<p><b>Map File Cross-Referencing</b></p>
<p>Controls the generation of cross-reference information in the map file. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Mx</b>)</p>
<p><b>Display Unused Functions in Map File</b></p>
<p>Marks unreferenced symbols in the map file.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Mu</b>) â Adds an extra column to the map file's table of symbols that</p>
<p>contains</p>
<p>D</p>
<p>for symbols which are unreferenced and therefore able to be deleted.</p>
<p>This includes symbols that have already been deleted by the<b> -delete</b> option (if</p>
<p>passed). This column contains</p>
<p>U</p>
<p>for any other symbols that remain unresolved,</p>
<p>including undefined weak symbols. It is possible that some unreferenced</p>
<p>symbols are not marked with</p>
<p>D</p>
<p>, either because they overlap with reachable</p>
<p>symbols or because they are referenced from profiling or debugging information.</p>
<p>For more information, see âDeleting Unused Functionsâ on page 507.</p>
<p><i>249</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Linker Output Analysis</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Display Local Symbols in Map File</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Ml</b>) â Adds list of locals to the linker-generated map file. This list does</p>
<p>not contain zero-sized symbols or compiler-generated symbols.</p>
<p><b>Display End-of-Function Symbols in Map File</b></p>
<p>Controls whether symbols of the form</p>
<p>__ghs_eofn_<i>name</i></p>
<p>appear in the map file,</p>
<p>where<i> name</i> is the name of a function. These symbols may be generated by the</p>
<p>compiler under certain circumstances, such as when</p>
<p>DWARF</p>
<p>is being output. By</p>
<p>default, end-of-function symbols appear in the map files unless the program is built</p>
<p>with<b> mapfile_type=2</b> (see âLinker-Specific Optionsâ on page 471). Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_map_eofn_symbols</b>)</p>
<p>â¢</p>
<p><b>On</b> (<b>-map_eofn_symbols</b>)</p>
<p><b>Output File Size Analysis</b></p>
<p>Controls use of the<b> gsize</b> utility to determine the size of the output executable.<b> gsize</b></p>
<p>creates a file called<i><b> executable_name</i>.siz</b>, which contains a list of the sizes of the</p>
<p>ROM sections of the output executable. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-gsize</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_gsize</b>) â [default]</p>
<p>For more information, see âThe gsize Utility Programâ on page 592.</p>
<p><b>Link-Time Checking</b></p>
<p>This option category is contained within<b> Linker</b>.</p>
<p>These options control various forms of linker checking.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>250</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Section Overlap Checking</b></p>
<p>Controls the treatment of overlapping sections. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>Errors on Any Overlap</b> (<b>-strict_overlap_check</b>) â Issues errors for all</p>
<p>overlapping sections, even when a section is zero bytes in size.</p>
<p>â¢</p>
<p><b>Errors on Non-Zero Overlap</b> (<b>-nooverlap</b>) â [default] Issues errors for</p>
<p>overlapping sections, except when one or both of the sections is zero bytes in</p>
<p>size.</p>
<p>â¢</p>
<p><b>Warnings</b> (<b>-overlap_warn</b>) â Similar to<b> -nooverlap</b>, but issues warnings</p>
<p>instead of errors.</p>
<p>â¢</p>
<p><b>Silent</b> (<b>-overlap</b>) â No warnings or errors are issued for overlapping sections.</p>
<p><b>Checksum</b></p>
<p>Controls the creation of section checksums. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-checksum</b>) â Appends a 4-byte checksum to the end of every initialized</p>
<p>program section using a standard 32-bit CRC algorithm.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nochecksum</b>) â [default]</p>
<p>The algorithm is a standard 32-bit CRC using the polynomial</p>
<p>0x10211021</p>
<p>(by</p>
<p>default), or</p>
<p>0x04C11DB7</p>
<p>(for INTEGRITY). For information about how to use</p>
<p>these checksums, see âVerifying Program Integrityâ on page 126. Sample source</p>
<p>code for verifying checksums is included in<b> src/libstartup/cksum.c</b> of your</p>
<p>installation.</p>
<p><b>Link-Time Global Variable Type Checking</b></p>
<p>Controls the level of link-time global variable type checking. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>Full</b> (<b>-globalcheck=full</b>) â Generates warnings in the event of inconsistent</p>
<p>types for the definition and uses of global variables, or where type checking</p>
<p>information is unavailable.</p>
<p><i>251</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Link-Time Checking</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Normal</b> (<b>-globalcheck=normal</b>) â Generates warnings in the event of</p>
<p>inconsistent types for the definition and uses of global variables only where</p>
<p>type checking information is available.</p>
<p>â¢</p>
<p><b>None</b> (<b>-globalcheck=none</b>) â [default] Does not generate or use global variable</p>
<p>type checking information.</p>
<p>The link-time global variable type checking verifies that the definition and all uses</p>
<p>of a global variable agree on the data type of the variable (size and signedness).</p>
<p>Qualifiers such as</p>
<p>const</p>
<p>and</p>
<p>volatile</p>
<p>can optionally also be checked by using</p>
<p><b>-globalcheck_qualifiers</b> (see âLink-Time Global Variable Type Qualifiersâ</p>
<p>on page 252)</p>
<p>This option should be passed both when compiling and when linking.</p>
<p><b>Note</b></p>
<p>Full type checking (<b>-globalcheck=full</b>) requires that all files in the project</p>
<p>be built with type checking. The standard libraries are not built with this</p>
<p>option enabled, so the linker may generate warnings about missing type</p>
<p>declarations for any library variables that are used in code where</p>
<p><b>-globalcheck=full</b> is passed. Some options, such as run-time error</p>
<p>checking, may generate implicit references to variables in the libraries.</p>
<p>In most cases, it is recommended that you use<b> -globalcheck=normal</b> for</p>
<p>type checking.</p>
<p><b>Link-Time Global Variable Type Qualifiers</b></p>
<p>Controls whether the linker verifies qualifiers such as</p>
<p>const</p>
<p>and</p>
<p>volatile</p>
<p>when</p>
<p>performing link-time global variable type checking. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-globalcheck_qualifiers</b>) â The type checking, if enabled, verifies</p>
<p>qualifiers on the type in addition to size and signedness.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_globalcheck_qualifiers</b>) â [default] The type checking, if enabled,</p>
<p>verifies only size and signedness.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>252</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Compiler Diagnostics Options</b></p>
<p>This is a top-level option category.</p>
<p>These options control the type, form, and quantity of diagnostic messages you may</p>
<p>receive during building.</p>
<p><b>Warnings</b></p>
<p>Controls the display of<i> warnings</i> for most Green Hills tools. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>Display</b> (<b>--warnings</b>) â [default]</p>
<p>â¢</p>
<p><b>Suppress</b> (<b>-w</b>)</p>
<p><b>Remarks</b></p>
<p>Controls the display of<i> remarks</i> for most Green Hills tools. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>Display</b> (<b>--remarks</b>)</p>
<p>â¢</p>
<p><b>Suppress</b> (<b>--no_remarks</b>) â [default]</p>
<p><b>Maximum Number of Errors to Display</b></p>
<p>Limits to<i> n</i> the number of error messages the compiler or linker prints before quitting.</p>
<p>The default is 100 and the minimum is 2.</p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-errmax=<i>n</b></i></p>
<p>Some errors are catastrophic, and the compiler stops the compilation process after</p>
<p>encountering such an error, regardless of whether the error limit has been reached.</p>
<p><i>253</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Compiler Diagnostics Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Redirect Error Output to File</b></p>
<p>Specifies a file to which all error output is redirected. This option is not supported</p>
<p>when parallel build mode is enabled (<b>-parallel</b>). The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-stderr=<i>filename</b></i></p>
<p><b>Quit Building if Warnings are Generated</b></p>
<p>Controls whether the build will terminate with an error if any warnings are generated,</p>
<p>providing the ability to treat all driver warnings as errors. This option does not affect</p>
<p>warnings issued by the Builder. To treat Builder warnings as errors, pass the<b> -strict</b></p>
<p>option to the Builder (for more information, see âThe gbuild Utility Programâ</p>
<p>on page 547. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--quit_after_warnings</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_quit_after_warnings</b>) â [default]</p>
<p><b>Display Version Information</b></p>
<p>Instructs the compiler and other tools to print its copyright banner and version</p>
<p>number. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-V</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_version</b>) â [default]</p>
<p><b>Write Version Info To .comment section</b></p>
<p>Creates or appends version and build information to the</p>
<p>.comment</p>
<p>section of any</p>
<p>object file generated by the assembler or compiler. (These are strings identifying</p>
<p>the version of the compiler and any driver options passed when the object was built.)</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-version_info</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_version_info</b>) â [default]</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>254</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Green Hills Standard Mode</b></p>
<p>Enables Green Hills Standard Mode, which enables warnings and errors that enforce</p>
<p>a stricter coding standard than regular C and C++. It was designed to aid you in</p>
<p>avoiding common pitfalls when designing complex programs. The versions of the</p>
<p>standard are named after the year they were finalized. The year does not necessarily</p>
<p>match the version number of the Green Hills Compiler. To suppress a diagnostic</p>
<p>issued by this mode, use<b> --diag_suppress=</b> (see âSet Message to Silentâ on page 260).</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>None</b> (<b>--ghstd=none</b>) â Explicitly disables Green Hills Standard Mode. Use</p>
<p>this option on children of a project for which Green Hills Standard Mode is</p>
<p>enabled to disable it for those children.</p>
<p>â¢</p>
<p><b>2010</b> (<b>--ghstd=2010</b>) â Enables the 2010 version of Green Hills Standard</p>
<p>Mode. This option is equivalent to</p>
<p>--coding_standard=ghstd2010</p>
<p>-Wformat</p>
<p>. For a list of diagnostics promoted or enabled by this option, see â</p>
<p>GHS Standard Modeâ on page 942.</p>
<p>â¢</p>
<p><b>last</b> (<b>--ghstd=last</b>) â Use the most recent version of Green Hills Standard</p>
<p>mode.</p>
<p><b>Coding Standard Profile</b></p>
<p>Specifies a coding standard profile. For information about coding standard profile</p>
<p>syntax and creating your own profiles, see Chapter 14, âCoding Standardsâ</p>
<p>on page 767. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>--coding_standard=<i>filename</b></i></p>
<p>Where<i> filename</i> is the name of a coding standard in the<b> defaults\coding_standards</b></p>
<p>subdirectory of your compiler installation (such as</p>
<p>ghstd2010</p>
<p>). Otherwise, the</p>
<p>argument is processed as the name of a coding standard relative to the current</p>
<p>directory.</p>
<p><b>Varying Message Format</b></p>
<p>This option category is contained within<b> Compiler Diagnostics</b>.</p>
<p>These options control various aspects of the display of diagnostic messages.</p>
<p><i>255</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Green Hills Standard Mode</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Brief Error Message Mode</b></p>
<p>Controls a mode in which a shorter form of the diagnostic output is used. When</p>
<p>enabled, the original source line is not displayed and the error message text is not</p>
<p>wrapped when it is too long to fit on a single line. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--brief_diagnostics</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_brief_diagnostics</b>) â [default]</p>
<p><b>Line Wrap Messages</b></p>
<p>Controls whether diagnostic messages are wrapped when they are too long to fit</p>
<p>on a single line. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--wrap_diagnostics</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_wrap_diagnostics</b>)</p>
<p><b>Display Error Message Paths</b></p>
<p>Controls whether full pathnames are given for files mentioned in diagnostic</p>
<p>messages. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-error_basename</b>) â Filenames in diagnostic messages include only the</p>
<p>name of the file. No path information is provided.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_error_basename</b>) â [default] â Filenames in diagnostic messages</p>
<p>include the path information that was passed to the driver.</p>
<p><b>C/C++ Messages</b></p>
<p>This option category is contained within<b> Compiler Diagnostics</b>.</p>
<p>These options control various diagnostic messages specific to the C and C++</p>
<p>languages.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>256</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Functions Without Prototypes</b></p>
<p>Controls the treatment of functions that are referenced or called when no prototype</p>
<p>has been provided. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Errors</b> (<b>--prototype_errors</b>)</p>
<p>â¢</p>
<p><b>Warnings</b> (<b>--prototype_warnings</b>) â [default]</p>
<p>â¢</p>
<p><b>Silent</b> (<b>--prototype_silent</b>)</p>
<p><b>Asm Statements</b></p>
<p>Controls the treatment of</p>
<p>asm</p>
<p>statements. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Errors</b> (<b>--asm_errors</b>)</p>
<p>â¢</p>
<p><b>Warnings</b> (<b>--asm_warnings</b>) â [default for strict ANSI C and strict ANSI</p>
<p>C++]</p>
<p>â¢</p>
<p><b>Silent</b> (<b>--asm_silent</b>) â [default for all other C and C++ modes]</p>
<p>In strict ANSI C, the spelling</p>
<p>asm</p>
<p>is not part of the C language. It is unknown to</p>
<p>the compiler and may be used as the name of a variable or function. To write an</p>
<p>asm</p>
<p>macro in strict ANSI C or strict ISO C99, you must use</p>
<p>__asm</p>
<p>. In non-strict</p>
<p>ANSI C and ISO C99, and in C++, the two spellings (</p>
<p>asm</p>
<p>and</p>
<p>__asm</p>
<p>) are identical.</p>
<p>Any correct use of</p>
<p>__asm</p>
<p>may still give a diagnostic indicating that</p>
<p>__asm</p>
<p>is</p>
<p>non-standard.</p>
<p><b>Unknown Pragma Directives</b></p>
<p>Controls the treatment of</p>
<p>#pragma</p>
<p>directives that are not recognized by the compiler.</p>
<p>Green Hills extension</p>
<p>#pragma</p>
<p>directives (those prefixed with</p>
<p>#pragma ghs</p>
<p>) are</p>
<p>always recognized by the compiler, even if the extension directives do not correspond</p>
<p>to known or supported behaviors. Incorrect uses of Green Hills extension</p>
<p>#pragma</p>
<p>directives are diagnosed according to the &quot;Incorrect Pragma Directives&quot; option. See</p>
<p>âIncorrect Pragma Directivesâ on page 258 and âGreen Hills Extension Pragma</p>
<p>Directivesâ on page 799. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Errors</b> (<b>--unknown_pragma_errors</b>)</p>
<p><i>257</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C/C++ Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Warnings</b> (<b>--unknown_pragma_warnings</b>) â [default]</p>
<p>â¢</p>
<p><b>Silent</b> (<b>--unknown_pragma_silent</b>)</p>
<p><b>Incorrect Pragma Directives</b></p>
<p>Controls the treatment of valid</p>
<p>#pragma</p>
<p>directives that use the wrong syntax.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Errors</b> (<b>--incorrect_pragma_errors</b>)</p>
<p>â¢</p>
<p><b>Warnings</b> (<b>--incorrect_pragma_warnings</b>) â [default]</p>
<p>â¢</p>
<p><b>Silent</b> (<b>--incorrect_pragma_silent</b>)</p>
<p><b>printf and scanf Argument Type Checking</b></p>
<p>Controls argument type checking against the format string in calls to</p>
<p>printf()</p>
<p>and</p>
<p>scanf()</p>
<p>. The checking is only performed if the format string is a constant.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Wformat</b>) â The compiler performs argument type checking against</p>
<p>printf()</p>
<p>and</p>
<p>scanf()</p>
<p>format strings. This option also defines the</p>
<p>__CHECK_PRINTF__</p>
<p>macro.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Wno-format</b>) â [default] The compiler does not perform argument type</p>
<p>checking against</p>
<p>printf()</p>
<p>or</p>
<p>scanf()</p>
<p>format strings.</p>
<p>This option has no effect if Green Hills header files are not used.</p>
<p><b>Implicit Int Return Type</b></p>
<p>Controls a warning that is issued if the return type of a function is not declared</p>
<p>before it is called (thus causing the return type to be implicitly declared</p>
<p>int</p>
<p>).</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Wimplicit-int</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Wno-implicit-int</b>) â [default]</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>258</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For broader prototype checking, see<b> Compiler DiagnosticsâC/C++</b></p>
<p><b>MessagesâFunctions Without Prototypes</b>.</p>
<p><b>Shadow Declarations</b></p>
<p>Controls a warning that is issued if the declaration of a local variable<i> shadows</i> the</p>
<p>declaration of a variable of the same name declared at the global scope, or at an</p>
<p>outer scope. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Wshadow</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Wno-shadow</b>) â [default]</p>
<p><b>Trigraphs</b></p>
<p>Controls a warning that is issued for any use of trigraphs. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Wtrigraphs</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Wno-trigraphs</b>) â [default]</p>
<p>This option does not control diagnostic 1967, which warns about trigraphs that may</p>
<p>unintentionally affect semantics. To disable this diagnostic as well, use</p>
<p><b>--diag_suppress 1967</b>.</p>
<p><b>Undefined Preprocessor Symbols</b></p>
<p>Controls a warning that is issued for undefined symbols in preprocessor expressions.</p>
<p>Such undefined symbols are always given the value of 0. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Wundef</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Wno-undef</b>) â [default]</p>
<p><b>Varying Message Severity</b></p>
<p>This option category is contained within<b> Compiler DiagnosticsâC/C++ Messages</b>.</p>
<p><i>259</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C/C++ Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p>These options allow you to increase or decrease the severity of<i> discretionary</i> C and</p>
<p>C++ compiler diagnostic messages. A diagnostic is discretionary if it is issued as</p>
<p>a remark, a warning, or an error with an error number followed by a &quot;</p>
<p>-D</p>
<p>&quot; suffix.</p>
<p>As arguments, these options take a list of either error numbers or error tags. Each</p>
<p>diagnostic has both an associated number and textual tag. For example, both</p>
<p>--diag_error=9</p>
<p>and</p>
<p>--diag_error=nested_comment</p>
<p>are equivalent. Values</p>
<p>for the error numbers can be obtained by enabling the<b> Compiler</b></p>
<p><b>DiagnosticsâC/C++ MessagesâVarying Message SeverityâDisplay Error</b></p>
<p><b>Message Numbers</b> (<b>--display_error_number</b>) option (see below). The complete</p>
<p>set of error numbers is also listed in the<i> MULTI: Toolchain Error Messages</i> book</p>
<p>(not available in print).</p>
<p>Set Message to Error</p>
<p>Sets the specified compiler diagnostic messages to the level of<i> error</i>:</p>
<p>â¢</p>
<p><b>--diag_error=<i>n[,n2]...</b></i></p>
<p>Set Message to Warning</p>
<p>Sets the specified compiler diagnostic messages to the level of<i> warning</i>:</p>
<p>â¢</p>
<p><b>--diag_warning=<i>n[,n2]...</b></i></p>
<p>Set Message to Remark</p>
<p>Sets the specified compiler diagnostic messages to the level of<i> remark</i>:</p>
<p>â¢</p>
<p><b>--diag_remark=<i>n[,n2]...</b></i></p>
<p>Set Message to Silent</p>
<p>Sets the specified diagnostics message to the level of<i> silent</i>. The equivalent driver</p>
<p>option is:</p>
<p>â¢</p>
<p><b>--diag_suppress<i> n[,n2]...</b></i></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>260</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Display Error Message Numbers</p>
<p>Controls the display of diagnostic error message numbers in the compiler and in</p>
<p>assemblers that support this feature. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--display_error_number</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_display_error_number</b>)</p>
<p>When a generated diagnostic error message number has a<b> -D</b> suffix, it is</p>
<p>discretionary. For example:</p>
<p>&quot;hello.c&quot;, line 24: warning #549-D:</p>
<p>variable &quot;i&quot; is used before its value is set</p>
<p>The severity level of discretionary diagnostics may be changed using the preceding</p>
<p>options.</p>
<p><b>Toolchain Messages</b></p>
<p>This option category is contained within<b> Compiler Diagnostics</b>.</p>
<p><b>Set Assembler Message to Error</b></p>
<p>Sets the specified</p>
<p>asm</p>
<p>diagnostic messages to the level of error:</p>
<p>â¢</p>
<p><b>-asm_diag_error=<i>n[,n2]...</b></i></p>
<p><b>Set Assembler Message to Warning</b></p>
<p>Sets the specified</p>
<p>asm</p>
<p>diagnostic messages to the level of warning:</p>
<p>â¢</p>
<p><b>-asm_diag_warning=<i>n[,n2]...</b></i></p>
<p><b>Set Assembler Message to Silent</b></p>
<p>Sets the specified</p>
<p>asm</p>
<p>diagnostic messages to the level of silent:</p>
<p>â¢</p>
<p><b>-asm_diag_suppress=<i>n[,n2]...</b></i></p>
<p><i>261</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Toolchain Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Set Linker Message to Error</b></p>
<p>Sets the specified</p>
<p>elxr</p>
<p>diagnostic messages to the level of error:</p>
<p>â¢</p>
<p><b>-elxr_diag_error=<i>n[,n2]...</b></i></p>
<p><b>Set Linker Message to Warning</b></p>
<p>Sets the specified</p>
<p>elxr</p>
<p>diagnostic messages to the level of warning:</p>
<p>â¢</p>
<p><b>-elxr_diag_warning=<i>n[,n2]...</b></i></p>
<p><b>Set Linker Message to Silent</b></p>
<p>Sets the specified</p>
<p>elxr</p>
<p>diagnostic messages to the level of silent:</p>
<p>â¢</p>
<p><b>-elxr_diag_suppress=<i>n[,n2]...</b></i></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>262</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>DoubleCheck (C/C++) Options</b></p>
<p>This is a top-level option category.</p>
<p><b>DoubleCheck Level</b></p>
<p>Each level performs a different degree of processing. The higher the level, the more</p>
<p>bugs can be identified, and a longer processing time is required. Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>None</b> (<b>-double_check.level=none</b>) â [default] DoubleCheck is disabled.</p>
<p>â¢</p>
<p><b>Low</b> (<b>-double_check.level=low</b>) â Looks for all types of bugs, but does not</p>
<p>follow execution paths involving function calls. DoubleCheck runs quickly</p>
<p>and should not greatly affect the time required to compile files.</p>
<p>â¢</p>
<p><b>Medium</b> (<b>-double_check.level=medium</b>) â Looks for all types of bugs, and</p>
<p>follows execution paths through calls between functions in all source files.</p>
<p>This extra processing requires more time than the low level.</p>
<p>â¢</p>
<p><b>High</b> (<b>-double_check.level=high</b>) â Extends the medium level by investigating</p>
<p>even more interprocedural execution paths. This requires more processing time</p>
<p>than the medium level.</p>
<p>The medium and high levels require two-pass compilation. The first pass summarizes</p>
<p>the contents of source files. The second pass uses the summaries of all source files</p>
<p>when compiling each file to identify potential intermodule paths.</p>
<p>For more information about DoubleCheck and these options, see Chapter 5, âThe</p>
<p>DoubleCheck Source Analysis Toolâ on page 365.</p>
<p><b>DoubleCheck Report File</b></p>
<p>Sets the name of the report file DoubleCheck generates. The equivalent driver option</p>
<p>is:</p>
<p>â¢</p>
<p><b>-double_check.report=</b></p>
<p>For more information about<b> -double_check.report=</b>, see âSpecifying a DoubleCheck</p>
<p>Report Fileâ on page 368.</p>
<p><i>263</i></p>
<p><i>Green Hills Software</i></p>
<p><i>DoubleCheck (C/C++) Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>DoubleCheck Config File</b></p>
<p>Specifies the configuration file containing function properties. The equivalent driver</p>
<p>option is:</p>
<p>â¢</p>
<p><b>-double_check.config=</b></p>
<p>For more information about<b> -double_check.config=</b>, see âSpecifying Function</p>
<p>Properties in a DoubleCheck Configuration Fileâ on page 369.</p>
<p><b>DoubleCheck Errors to Ignore</b></p>
<p>Disables a particular DoubleCheck error message or warning message for a specific</p>
<p>file or part of a build hierarchy. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-double_check.ignore=</b></p>
<p>For more information about<b> -double_check.ignore=</b>, see âIgnoring Source Analysis</p>
<p>Errors and Warningsâ on page 375.</p>
<p><b>DoubleCheck Output that Stops Builds</b></p>
<p>Specifies whether DoubleCheck error or warning messages stop the build process.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-double_check.stop_build=off</b>) â [default] DoubleCheck error and</p>
<p>warning messages do not stop the build.</p>
<p>â¢</p>
<p><b>Errors Only</b> (<b>-double_check.stop_build=errors</b>) â Only DoubleCheck error</p>
<p>messages stop the build.</p>
<p>â¢</p>
<p><b>Warnings and Errors</b> (<b>-double_check.stop_build=warnings</b>) â Both</p>
<p>DoubleCheck error and warning messages stop the build.</p>
<p>For more information about<b> -double_check.stop_build=</b>, see âPromoting Source</p>
<p>Analysis Errors and Warningsâ on page 375.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>264</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>GCores Options</b></p>
<p>This is a top-level option category.</p>
<p>These options are only applicable to MultiCoreArchive project files.</p>
<p>Please see<b> gcores</b> documentation âThe gcores Utility Programâ on page 532 for</p>
<p>more information and examples.</p>
<p><b>Gcores Output Filename</b></p>
<p>Specify the name of the final image.</p>
<p>If executed from the command line, the default is<b> multi_cores.mca</b>.</p>
<p>The<b> .mca</b> extension is compulsory for MultiCoreArchive final image names. If no</p>
<p>extension is provided (or provided a different one) it will be automatically changed</p>
<p>to<b> .mca</b> and a warning will be issued.</p>
<p>The equivalent option is:</p>
<p>â¢</p>
<p><b>-o<i> filename.mca</b></i></p>
<p><b>Gcores Shared Modules Import Symbols From Cores</b></p>
<p>Allows the shared module to import symbols from the cores. This is done utilizing</p>
<p>a two-pass build process. The shared module is first built with undefined symbol</p>
<p>errors disabled. This allows the cores to then be built importing symbols from the</p>
<p>shared module. The shared module is then re-built with undefined symbol errors</p>
<p>enabled and importing undefined symbols from the core modules. Because of the</p>
<p>nature of this method, users should take caution to prevent the shared module from</p>
<p>referencing symbols (defined or undefined) unintentionally that may exist in a core</p>
<p>module. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-shared_imports</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_shared_imports</b>) â [default]</p>
<p><i>265</i></p>
<p><i>Green Hills Software</i></p>
<p><i>GCores Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>GCores Disable Error Messages Concerning Overlapping Sections</b></p>
<p>By default<b> gcores</b> will warn if any symbol or code in a shared module (built as part</p>
<p>of the<b> -share</b> option) overlaps with any symbol or address in a core-specific module.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-allow_overlap</b>) â Disables these warnings.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_allow_overlap</b>) â [default]</p>
<p><b>GCores Cores Import Symbols From Other Cores</b></p>
<p>By default the core-specific files are not allowed to reference symbols in other</p>
<p>core-specific files. This option attempts to allow such symbol referencing. Use with</p>
<p>caution, as duplicate or undefined symbol names used between the components</p>
<p>may result in undesirable linkage. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-cross_core_imports</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_cross_core_imports</b>) â [default]</p>
<p><b>Gcores Common Link Options</b></p>
<p>Specifies a list of driver options that are used in the final linking stage for each core</p>
<p>and the shared module. If<b> gcores</b> is called from the command line, these options</p>
<p>are used together with the options specified in<b> -core</b> or<b> -share</b> to build the core or</p>
<p>the shared module. The option or options have to be enclosed between braces { }</p>
<p>. The equivalent option is:</p>
<p>â¢</p>
<p><b>-common {<i> common options</i> }</b></p>
<p><b>GCores Driver</b></p>
<p>Specify the driver/compiler for which to build the cores and the shared module. If</p>
<p>omitted, the default is</p>
<p>ccv850</p>
<p>. The equivalent option is:</p>
<p>â¢</p>
<p><b>-driver=<i>driver</b></i></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>266</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>GCores Cpu</b></p>
<p>Specify the processor for which to build the cores and the shared module. The</p>
<p>equivalent option is:</p>
<p>â¢</p>
<p><b>-cpu=<i>cpu</b></i></p>
<p><b>Keep GCores Temporary Files</b></p>
<p>Do not remove temporary files.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-keeptempfiles</b>) â<b> gcores</b> does not remove temporary files.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nokeeptempfiles</b>) â [default]<b> gcores</b> removes temporary files.</p>
<p><b>Import libraries into shared module</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-shared_libs</b>) â</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_shared_libs</b>) â</p>
<p><b>Automatically allocate shared memory for the cores and shared object</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-alloc_shared_mem</b>) â</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_alloc_shared_mem</b>) â</p>
<p><b>Gcores Exported Absolutes Only</b></p>
<p>Restricts the symbols that can be imported from either another core or from the</p>
<p>shared module to those that have been explicitly exported in the module that defines</p>
<p>them.</p>
<p>Three methods are available to export symbols:</p>
<p><i>267</i></p>
<p><i>Green Hills Software</i></p>
<p><i>GCores Cpu</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Through the</p>
<p>#pragma ghs exported</p>
<p>pragma directive in the source code.</p>
<p>This will export the symbol defined under the</p>
<p>#pragma</p>
<p>line.</p>
<p>â¢</p>
<p>Through the driver option<b> -exportall=library</b>. This will export all the symbols</p>
<p>of the provided library.</p>
<p>â¢</p>
<p>Through a file<b> library.ghsexports</b>. If a file named<b> library.ghsexports</b> is found</p>
<p>in the same directory as the library<b> library.a</b> is generated, the symbols (each</p>
<p>one in its own line) specified in the file will be exported.</p>
<p>The symbol names included in the file<b> .ghsexports</b> must be the same as the ones</p>
<p>existing in the symbol table of the library in question. Please add an underscore</p>
<p>(&quot;_&quot;)</p>
<p>to the beginning of the variable or function.</p>
<p>For instance, if a library<b> libshared_0.a</b> is exporting through its</p>
<p><b>libshared_0.ghsexports</b> file the variable</p>
<p>common_lib0_var2</p>
<p>and the function</p>
<p>common_lib0_f0</p>
<p>, then the symbols to add in<b> libshared_0.ghsexports</b> will be</p>
<p>(contents of the file<b> libshared_0.ghsexports</b>) :</p>
<p>_common_lib0_f0</p>
<p>_common_lib0_var2</p>
<p>In order to add a dependency to the<b> .ghsexports</b> file, use the Builder options</p>
<p><b>:depends</b>,<b> :dependsRelative</b> or<b> :dependsNonRelative</b> in the Core or SharedMemory</p>
<p>project file.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-exported_absolutes_only</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_exported_absolutes_only</b>) â [default]</p>
<p><b>GCores Generate Additional Output</b></p>
<p>Creates the specified output type in addition to the MultiCoreArchive final image.</p>
<p>The syntax<b> -<i>format</i>=<i>name</b></i> allows you to specify the name of the file. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>S-Record File</b> (<b>-srec</b>,<b> -srec=<i>name</b></i>) â Generates output file with</p>
<p>.run</p>
<p>extension containing the output of the MultiCoreArchive image as translated</p>
<p>by the<b> gsrec</b> utility program. For more information about<b> gsrec</b>, see âThe gsrec</p>
<p>Utility Programâ on page 594.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>268</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>HEX386 File</b> (<b>-hex</b>,<b> -hex=<i>name</b></i>) â Generates output file in HEX386 format</p>
<p>with</p>
<p>.run</p>
<p>extension containing the output of the MultiCoreArchive image as</p>
<p>translated by the<b> gsrec</b> utility program with<b> -hex386</b> passed to it. For more</p>
<p>information about<b> gsrec</b>, see âThe gsrec Utility Programâ on page 594.</p>
<p><i>269</i></p>
<p><i>Green Hills Software</i></p>
<p><i>GCores Generate Additional Output</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Advanced Options</b></p>
<p>This is a top-level option category.</p>
<p><b>Target Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p>These options control advanced settings that affect compilation for your target. For</p>
<p>more common options, see âTarget Optionsâ on page 129.</p>
<p><b>Target Processor</b></p>
<p>Specifies code generation for a particular target<i> processor</i> (see âV850 and RH850</p>
<p>Processor Variantsâ on page 53).</p>
<p>If you specify a processor, the driver selects the appropriate instruction set and a</p>
<p>generic<b> .ld</b> file. For more information about these<b> .ld</b> files, see âWorking with Linker</p>
<p>Directives Filesâ on page 80. You can override the default<b> .ld</b> file by specifying</p>
<p>an alternate linker directives file elsewhere on the command line. For a more detailed</p>
<p>discussion on<b> .ld</b> files, see âConfiguring the Linker with Linker Directives Filesâ</p>
<p>on page 475.</p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>Generic CPU</b> (<b>-cpu=<i>cpu</b></i>) â To obtain a list of supported processors from the</p>
<p>command line, enter<b> -cpu=?</b> (or<b> -cpu=\?</b> in many shells).</p>
<p><b>Additional SDA Base Registers</b></p>
<p>Specifies up to five additional SDA and ZDA base pointers, beginning at</p>
<p>R20</p>
<p>. The</p>
<p>equivalent driver option is:</p>
<p>â¢</p>
<p><b>-additional_sda_reg=<i>n</b></i></p>
<p>For more information, see âSpecifying Additional Registers for Special Data Areasâ</p>
<p>on page 106.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>270</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Additional SDA Base Registers (common)</b></p>
<p>Causes the compiler to generate code that is compatible with all settings of</p>
<p><b>-additional_sda_reg</b>=<i>n</i>.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-additional_sda_common</b>) â Generate code that can be safely linked</p>
<p>with modules that use additional SDA registers.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_additional_sda_common</b>) â [default] Generate code that assumes</p>
<p>no additional SDA registers will be used.</p>
<p><b>Initialize RAM at Startup</b></p>
<p>Controls whether to perform RAM initialization during startup for a program built</p>
<p>to boot from ROM.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-init_ram_at_startup</b>) â Perform initialization of RAM during startup.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_init_ram_at_startup</b>) â [default] Do not perform RAM initialization</p>
<p>during startup.</p>
<p>For more information, see âRun-Time RAM Initialization and RAM Initialization</p>
<p>Tableâ on page 512).</p>
<p><b>RAM Initialization Value</b></p>
<p>Specifies a 32-bit word pattern value used for initializing RAM at startup. If not</p>
<p>explicitly specified, the default value is 0. This option is only effective when</p>
<p><b>-init_ram_at_startup</b> is passed. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-ram_init_val=<i>value</b></i></p>
<p><b>Function Prologues</b></p>
<p>Controls the manner in which the compiler generates each function prologue and</p>
<p>epilogue. Permitted settings for this option are:</p>
<p><i>271</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Target Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>On</b> (<b>-inline_prologue</b>) â Forces the compiler to use inline code sequences.</p>
<p>This option may adversely impact the size of the generated code, so it should</p>
<p>only be used when necessary (for example, when the routines may not exist in</p>
<p>memory yet).</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_inline_prologue</b>) â Do not force the compiler to use inline code</p>
<p>sequences.</p>
<p>By default, the compiler selects the most efficient method based on optimization</p>
<p>settings and registers that must be saved.</p>
<p><b>Support for Very Large Switch Statements</b></p>
<p>Controls the size of switch statement offset entries. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-bigswitch</b>) â Use a 32-bit offset. This option is necessary when compiling</p>
<p>a file with a very large switch statement. The assembler or linker will give a</p>
<p>specific error if this option is needed for a particular file. Otherwise the option</p>
<p>is not necessary.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nobigswitch</b>) â [default] Use a 16-bit or 22-bit offset, which results in</p>
<p>smaller code.</p>
<p><b>Switch Tables</b></p>
<p>Controls how the compiler evaluates switch statements. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--switch_table</b>) â [default] The compiler evaluates switch statements</p>
<p>using any means including jump tables.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_switch_table</b>) â The compiler evaluates switch statements using</p>
<p>a series of conventional compare and branch instructions.</p>
<p><b>Advanced Floating-Point</b></p>
<p>This option category is contained within<b> AdvancedâTarget Options</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>272</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Warn for all floating point types</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Wfloat</b>) â Warns for any use of floating point. This option has no effect</p>
<p>on the code generated by the compiler. This option also does not hide</p>
<p>declarations in the standard C headers, so warnings will occur if certain header</p>
<p>files are used, even if the declarations in those header files are not needed.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Wnofloat</b>) â [default]</p>
<p>Warn for types double or long double</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Wdouble</b>) â Warns for any use of double precision floating point or</p>
<p>long double precision floating point. This option has no effect on the code</p>
<p>generated by the compiler. This option also does not hide declarations in the</p>
<p>standard C headers, so warnings will occur if certain header files are used, even</p>
<p>if the declarations in those header files are not needed.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Wnodouble</b>) â [default]</p>
<p>Do not allow types double or long double</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-fnodouble</b>) â Gives a fatal error for any use of double precision floating</p>
<p>point, as well as long double precision floating point, but allows single precision.</p>
<p>All floating point literals must have the</p>
<p>f</p>
<p>suffix, or they are rejected with an</p>
<p>error. All declarations that use the types</p>
<p>double</p>
<p>or</p>
<p>long double</p>
<p>are hidden</p>
<p>in the standard C header files so that the header files may still be included</p>
<p>without error. No error is given when a single precision floating point expression</p>
<p>is passed to a function that is not declared with a prototype or to a function that</p>
<p>takes variable parameters, even though the floating point expression will be</p>
<p>promoted to double precision before being passed.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-fnonodouble</b>) â [default] Takes no special action with respect to double</p>
<p>precision floating point or long double precision floating point.</p>
<p><i>273</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Target Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>See also the<b> -fnone</b> option in âFloating-Point Modeâ on page 132; it completely</p>
<p>disables floating point in the compiler and may cause different libraries to be</p>
<p>selected. If<b> -fnone</b> is used together with either<b> -fnonodouble</b> or<b> -fnodouble</b>,<b> -fnone</b></p>
<p>always takes precedence.</p>
<p><b>Advanced Operating System</b></p>
<p>This option category is contained within<b> AdvancedâTarget Options</b>.</p>
<p><b>Project Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p>These options control advanced project configuration settings. For more common</p>
<p>options, see âProject Optionsâ on page 160.</p>
<p><b>Binary Code Generation</b></p>
<p>Controls binary code generation. By default, the toolchain generates binary object</p>
<p>files directly from source code rather than via the creation of assembly language</p>
<p>files. Since the assembler is not invoked, binary code generation significantly</p>
<p>decreases compile time.</p>
<p>Certain options, such as<b> -dual_debug</b>, are incompatible with binary code generation,</p>
<p>and binary code generation will default to off if these are selected. Also, binary</p>
<p>code generation is automatically disabled on individual files if the compiler</p>
<p>determines that the file uses features (such as embedded assembly) that are</p>
<p>incompatible with binary code generation.</p>
<p>This option does not control the output file format. To generate a binary output file,</p>
<p>see the</p>
<p>-memory</p>
<p>driver option in âGenerate Additional Outputâ on page 236.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-obj</b>) â Enables direct binary generation.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-noobj</b>) â Disables direct binary generation.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>274</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Temporary Output Directory</b></p>
<p>Specifies a<i> directory</i> for writing temporary files to. This option is useful if your</p>
<p>default temporary directory is on a small file system that might run out of disk space</p>
<p>during compilations which involve inlining or template processing. The equivalent</p>
<p>driver option is:</p>
<p>â¢</p>
<p><b>-tmp=<i>directory</b></i></p>
<p>(Linux/Solaris) By default, temporary files are written to the first of the following</p>
<p>directories that exists:</p>
<p>â¢</p>
<p>The directory specified by the environment variable</p>
<p>TMPDIR</p>
<p>.</p>
<p>â¢</p>
<p>The directory specified by the constant value of variable</p>
<p>P_tmpdir</p>
<p>(usually</p>
<p><b>/var/tmp</b> on Solaris and<b> /tmp</b> on Linux), which is defined in the operating</p>
<p>system header file (usually located in<b> /usr/include/stdio.h</b>).</p>
<p>â¢</p>
<p><b>/tmp</b>.</p>
<p>(Windows) By default, temporary files are written to the first of the following</p>
<p>directories that exists:</p>
<p>â¢</p>
<p>The directory specified by the environment variable</p>
<p>TMP</p>
<p>.</p>
<p>â¢</p>
<p>The directory specified by the constant value of variable</p>
<p>P_tmpdir</p>
<p>(usually</p>
<p>the root directory of the current drive), which is defined in the operating system</p>
<p>header file.</p>
<p>â¢</p>
<p>The current working directory.</p>
<p><b>Temporary Output</b></p>
<p>Controls whether temporary files generated during compilation are retained.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Retain</b> (<b>-keeptempfiles</b>) â Prevents the deletion of temporary files after they</p>
<p>are used. If an assembly language file is created by the compiler, this option</p>
<p>will place it in the current directory instead of the temporary directory.</p>
<p>â¢</p>
<p><b>Delete</b> (<b>-nokeeptempfiles</b>) â [default]</p>
<p><i>275</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Project Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Temporary Assembly Output</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Retain</b> (<b>-keepasmfiles</b>) â Produces an<b> .s</b> file when the compiler is invoked</p>
<p>on a C or C++ file to produce an object file. The<b> .s</b> file resides in the same</p>
<p>location and has the same base name as the<b> .o</b> file. This option implies<b> -noobj</b>.</p>
<p>â¢</p>
<p><b>Delete</b> (<b>-nokeepasmfiles</b>) â [Default] Does not produce<b> .s</b> files.</p>
<p>The position of this option on the command line does not matter.</p>
<p><b>Temporary Preprocessor Output</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Retain</b> (<b>-keepcppfiles</b>) â Produces an<b> .i</b> file (preprocessed output) when the</p>
<p>compiler is invoked on a C or C++ file. Produces an<b> .si</b> file when the</p>
<p>preprocessor is invoked on an assembly file as a result of building with</p>
<p><b>-preprocess_assembly_files</b> (see âPreprocess Assembly Filesâ on page 232).</p>
<p>The<b> .i</b> and<b> .si</b> files reside in the same location and have the same base name as</p>
<p>the<b> .s</b> and/or<b> .o</b> file.</p>
<p>â¢</p>
<p><b>Delete</b> (<b>-nokeepcppfiles</b>) â [Default] Does not produce<b> .i</b> files.</p>
<p>The position of this option on the command line does not matter.</p>
<p><b>Input Languages</b></p>
<p>Explicitly specifies that a program or archive contains object files or libraries that</p>
<p>contain C++. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-language=<i>language</b></i> â where<i> language</i> is one of:</p>
<p>â</p>
<p>c</p>
<p>(this option has no effect; all programs are assumed to contain C object</p>
<p>files.)</p>
<p>â</p>
<p>cxx</p>
<p>At link time and archive time, the driver must know if any object files or libraries</p>
<p>contain languages other than C in order to select the correct libraries and perform</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>276</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>any special processing. If your project includes object files or libraries that were</p>
<p>compiled from a different language, you must set<b> -language=<i>language</b></i> on that</p>
<p>project. This option has no effect when set on an input file.</p>
<p>If your project includes source files that contain other languages and those files</p>
<p>appear on the command line, you do not need to set this option. If you invoke the</p>
<p>driver directly using<b> cxv850</b>,<b> -language=cxx</b> is implied.</p>
<p><b>Non-Standard Output Suffix</b></p>
<p>Controls the acceptance of non-standard output suffixes. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Accepted</b> (<b>--any_output_suffix</b>)</p>
<p>â¢</p>
<p><b>Not Accepted</b> (<b>--no_any_output_suffix</b>) â [default]</p>
<p><b>Source Directories Relative to Top-Level Project</b></p>
<p>Specifies a<i> directory</i> in which the builder should search for source files relative to</p>
<p>the location of your Top Project. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:sourceDirNonRelative=<i>directory</b></i></p>
<p>This is a<b> Builder</b>-only option. There is no equivalent driver option.</p>
<p><b>Intermediate Output Directory Relative to This File</b></p>
<p>Specifies the path to where object files (and any custom file types) are written,</p>
<p>relative to the location of the current project<b> .gpj</b> file. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:outputDirRelative=<i>directory</b></i></p>
<p>This option is most useful for custom tools that do not allow you to specify a</p>
<p>directory for intermediate output. For projects that use only Green Hills Tools, use</p>
<p><b>-object_dir</b> instead.<b> -object_dir</b> overrides this option.</p>
<p>This is a Builder-only option. There is no equivalent driver option.</p>
<p><i>277</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Project Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Binary Output Directory Relative to Top-Level Project</b></p>
<p>Specifies the path to where final executable output files are written, relative to the</p>
<p>location of your Top Project (usually<b> default.gpj</b>). The syntax for this option is:</p>
<p>â¢</p>
<p><b>:binDir=<i>directory</b></i></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Binary Output Directory Relative to This File</b></p>
<p>Specifies the path to where final executable output files are written, relative to the</p>
<p>location of the current<b> .gpj</b> project file. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:binDirRelative=<i>directory</b></i></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Dependencies Relative to Source Directory</b></p>
<p>Specifies that the present file<i> must</i> be rebuilt if the specified file, relative to the</p>
<p>location of your source directory, changes. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:depends=<i>filename</b></i></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Dependencies Relative to This File</b></p>
<p>Specifies that the present file<i> must</i> be rebuilt if the specified file, relative to the</p>
<p>location of the present<b> .gpj</b> project file, changes. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:dependsRelative=<i>filename</b></i></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>278</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Dependencies Relative to Top-Level Project</b></p>
<p>Specifies that the present file<i> must</i> be rebuilt if the specified file, relative to the</p>
<p>location of your Top Project (usually<b> default.gpj</b>), changes. The syntax for this</p>
<p>option is:</p>
<p>â¢</p>
<p><b>:dependsNonRelative=<i>filename</b></i></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Self-Dependency</b></p>
<p>Specifies that changes to this Green Hills Project (<b>.gpj</b>) file do not cause it or any</p>
<p>of its children to be rebuilt. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:noSelfDepend</b></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Suppress Dependencies</b></p>
<p>Specifies that the present file<i> must not</i> be rebuilt if the specified file changes. This</p>
<p>option overrides a previous<b> :depends</b> option on a<b> .gpj</b> file specified in a parent</p>
<p>project. To prevent changes to a<b> .gpj</b> file from causing a rebuild, use<b> :noSelfDepend</b></p>
<p>instead. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:nodepends=<i>filename</b></i></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Output Filename for Generic Types</b></p>
<p>Specifies a name for the output file of a build item. Use this only for file types that</p>
<p>do not accept<b> -o</b> or any other option that sets an output name. The syntax for this</p>
<p>option is:</p>
<p>â¢</p>
<p><b>:outputName=<i>filename</b></i></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><i>279</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Project Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Append Default Extension to Output Filename</b></p>
<p>Appends the default file extension to the output filename if it does not already have</p>
<p>an extension, or replaces the existing extension if it does. For example, this option</p>
<p>would replace the extension of an object file with<b> .o</b> (Linux/Solaris) or<b> .obj</b></p>
<p>(Windows). This option is not usually necessary unless you have manually changed</p>
<p>the output name of the file. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:appendExtension</b></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Commands to Execute Before Associated Command</b></p>
<p>Specifies commands that are executed before the file is processed. The commands</p>
<p>are executed immediately before the processing step for the file. If the file has no</p>
<p>processing step, the commands are not executed. The following table lists the</p>
<p>processing step for common file types:</p>
<p><b>Processing Step</b></p>
<p><b>File Type</b></p>
<p>Compilation</p>
<p>C/C++ Source</p>
<p>Assembling</p>
<p>Assembly Source</p>
<p>Linking</p>
<p>Program</p>
<p>Archiving</p>
<p>Library</p>
<p>None</p>
<p>C/C++ Header</p>
<p>None</p>
<p>Project</p>
<p>For example:</p>
<p>â¢</p>
<p>If you set<b> :preExec</b> on a Program, the commands are run after compiling the</p>
<p>source files in the Program, but before linking it.</p>
<p>â¢</p>
<p>If you set<b> :preExec</b> on a C/C++ Header file, the commands are not run.</p>
<p>If you are performing a parallel build, and it is not safe to execute the specified</p>
<p>commands while other build operations are running, use this option. See also âSafe</p>
<p>Commands to Execute Before Associated Commandâ on page 281.</p>
<p>The syntax for this option is:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>280</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>:preexec=<i>command</b></i></p>
<p>If<i> command</i> must include information about the file being processed, use a context</p>
<p>sensitive variable (see âContext Sensitive Variablesâ on page 997).</p>
<p>If you only want to execute the command when processing a file in certain contexts,</p>
<p>use a conditional control statement (see âConditional Control Statementsâ</p>
<p>on page 965). For example, to run<b> preProc.bat</b> on a file only when building on a</p>
<p>Windows host, use the following option:</p>
<p>{streq(__MULTI_HOST__, &quot;win32&quot;)} :preExec=&quot;preProc.bat<i> filename</i>&quot;</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Safe Commands to Execute Before Associated Command</b></p>
<p>Specifies commands that are executed before the file is processed. These commands</p>
<p>are guaranteed to be performed before the processing step, but may not be performed</p>
<p>immediately before. Commands specified with this option must be<i> safe</i>; they must</p>
<p>not modify any files related to the build (such as projects, source files, or object</p>
<p>files). If you are performing a parallel build, use this option instead of<b> :preExec</b> to</p>
<p>execute safe commands while other build operations are running, because it may</p>
<p>speed up the build process. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:preexecSafe=<i>command</b></i></p>
<p>For more information about when files are processed, see âCommands to Execute</p>
<p>Before Associated Commandâ on page 280.</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Commands to Execute Before Associated Command (via Shell)</b></p>
<p>Specifies commands to be executed in a shell before the file is processed. For more</p>
<p>information about when files are processed, see âCommands to Execute Before</p>
<p>Associated Commandâ on page 280.</p>
<p>If you are performing a parallel build, and it is not safe to execute the specified</p>
<p>commands while other build operations are running, use this option. See also âSafe</p>
<p>Commands to Execute Before Associated Command (via Shell)â on page 282.</p>
<p><i>281</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Project Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The syntax for this option is:</p>
<p>â¢</p>
<p><b>:preexecShell=<i>command</b></i></p>
<p>MULTI prepends the following text to<i> command</i> depending on your host's operating</p>
<p>system:</p>
<p>â¢</p>
<p>Windows â</p>
<p><i>COMSPEC</i> /c</p>
<p>, where<i> COMSPEC</i> is the value of the</p>
<p>COMSPEC</p>
<p>environment variable (usually</p>
<p>cmd</p>
<p>).</p>
<p>â¢</p>
<p>Linux and Solaris â</p>
<p>/bin/sh -c</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Safe Commands to Execute Before Associated Command (via</b></p>
<p><b>Shell)</b></p>
<p>Specifies commands that are executed in a command prompt or shell before the file</p>
<p>is processed. These commands are guaranteed to be performed before the processing</p>
<p>step, but may not be performed immediately before. Commands specified with this</p>
<p>option must be<i> safe</i>; they must not modify any files related to the build (such as</p>
<p>projects, source files, or object files). If you are performing a parallel build, use this</p>
<p>option instead of<b> :preExecShell</b> to execute safe commands while other build</p>
<p>operations are running, because it may speed up the build process.</p>
<p>â¢</p>
<p><b>:preexecShellSafe=<i>command</b></i></p>
<p>MULTI prepends the following text to<i> command</i> depending on your host's operating</p>
<p>system:</p>
<p>â¢</p>
<p>Windows â</p>
<p><i>COMSPEC</i> /c</p>
<p>, where<i> COMSPEC</i> is the value of the</p>
<p>COMSPEC</p>
<p>environment variable (usually</p>
<p>cmd</p>
<p>).</p>
<p>â¢</p>
<p>Linux and Solaris â</p>
<p>/bin/sh -c</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>282</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Commands to Execute After Associated Command</b></p>
<p>Specifies commands that are executed after the file is processed. The commands</p>
<p>are executed immediately after the processing step for the file. If the file has no</p>
<p>processing step, the commands are not executed. The following table lists the</p>
<p>processing step for common file types:</p>
<p><b>Processing Step</b></p>
<p><b>File Type</b></p>
<p>Compilation</p>
<p>C/C++ Source</p>
<p>Assembling</p>
<p>Assembly Source</p>
<p>Linking</p>
<p>Program</p>
<p>Archiving</p>
<p>Library</p>
<p>None</p>
<p>C/C++ Header</p>
<p>None</p>
<p>Project</p>
<p>For example:</p>
<p>â¢</p>
<p>If you set<b> :postExec</b> on an Assembly Source file, the commands are run after</p>
<p>assembling the file, but before linking it.</p>
<p>â¢</p>
<p>If you set<b> :postExec</b> on a C/C++ Header file, the commands are not run.</p>
<p>If you are performing a parallel build, and it is not safe to execute the specified</p>
<p>commands while other build operations are running, use this option. See also âSafe</p>
<p>Commands to Execute After Associated Commandâ on page 284.</p>
<p>The syntax for this option is:</p>
<p>â¢</p>
<p><b>:postexec=<i>command</b></i></p>
<p>If<i> command</i> must include information about the file being processed, use a context</p>
<p>sensitive variable (see âContext Sensitive Variablesâ on page 997).</p>
<p>If you only want to execute the command when processing a file in certain contexts,</p>
<p>use a conditional control statement (see âConditional Control Statementsâ</p>
<p>on page 965). For example, to run<b> postProc.bat</b> on a Program's output file when</p>
<p>building on a Windows host, use the following option:</p>
<p>{streq(__MULTI_HOST__, &quot;win32&quot;)} :postExec=&quot;postProc.bat $(OUTPUTFILE)&quot;</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><i>283</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Project Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Safe Commands to Execute After Associated Command</b></p>
<p>Specifies commands that are executed after the file is processed. These commands</p>
<p>are guaranteed to be performed after the processing step, but may not be performed</p>
<p>immediately after. Commands specified with this option must be<i> safe</i>; they must</p>
<p>not modify any files related to the build (such as projects, source files, or object</p>
<p>files). If you are performing a parallel build, use this option instead of<b> :postExec</b></p>
<p>to execute safe commands while other build operations are running, because it may</p>
<p>speed up the build process. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:postexecSafe=<i>command</b></i></p>
<p>For more information about when files are processed, see âCommands to Execute</p>
<p>After Associated Commandâ on page 283.</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Commands to Execute After Associated Command (via Shell)</b></p>
<p>Specifies commands to be executed in a command prompt or shell after the file is</p>
<p>processed. For more information about when files are processed, see âCommands</p>
<p>to Execute After Associated Commandâ on page 283.</p>
<p>If you are performing a parallel build, and it is not safe to execute the specified</p>
<p>commands while other build operations are running, use this option. See also âSafe</p>
<p>Commands to Execute After Associated Command (via Shell)â on page 285.</p>
<p>The syntax for this option is:</p>
<p>â¢</p>
<p><b>:postexecShell=<i>command</b></i></p>
<p>MULTI prepends the following text to<i> command</i> depending on your host's operating</p>
<p>system:</p>
<p>â¢</p>
<p>Windows â</p>
<p><i>COMSPEC</i> /c</p>
<p>, where<i> COMSPEC</i> is the value of the</p>
<p>COMSPEC</p>
<p>environment variable (usually</p>
<p>cmd</p>
<p>).</p>
<p>â¢</p>
<p>Linux and Solaris â</p>
<p>/bin/sh -c</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>284</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Safe Commands to Execute After Associated Command (via Shell)</b></p>
<p>Specifies commands that are executed in a command prompt or shell after the file</p>
<p>is processed. These commands are guaranteed to be performed after the processing</p>
<p>step, but may not be performed immediately after. Commands specified with this</p>
<p>option must be<i> safe</i>; they must not modify any files related to the build (such as</p>
<p>projects, source files, or object files). If you are performing a parallel build, use this</p>
<p>option instead of<b> :postExecShell</b> to execute safe commands while other build</p>
<p>operations are running, because it may speed up the build process.</p>
<p>â¢</p>
<p><b>:postexecShellSafe=<i>command</b></i></p>
<p>MULTI prepends the following text to<i> command</i> depending on your host's operating</p>
<p>system:</p>
<p>â¢</p>
<p>Windows â</p>
<p><i>COMSPEC</i> /c</p>
<p>, where<i> COMSPEC</i> is the value of the</p>
<p>COMSPEC</p>
<p>environment variable (usually</p>
<p>cmd</p>
<p>).</p>
<p>â¢</p>
<p>Linux and Solaris â</p>
<p>/bin/sh -c</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Additional Output Files</b></p>
<p>Specifies any non-standard output files that are generated during building, so that</p>
<p>the<b> Builder</b> can include them in file cleanup. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:extraOutputFile=<i>filename</b></i></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>'Select One' Project Extension List</b></p>
<p>For use with the Select One project type. Specifies a list of file extensions that</p>
<p>determines which file in the project the Builder chooses. The first extension in the</p>
<p>list has the highest priority, and the last extension has the lowest. The syntax for</p>
<p>this option is:</p>
<p>â¢</p>
<p><b>:select=</b></p>
<p><i>arg1</i>[,<i>arg2</i>...]</p>
<p><i>285</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Project Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For example, if you specify</p>
<p>c,asm</p>
<p>, the Builder searches your<b> Select One</b> project</p>
<p>for a</p>
<p>.c</p>
<p>file first, then a</p>
<p>.asm</p>
<p>file.</p>
<p>If you specify multiple<b> :select</b> options for the same project, the builder concatenates</p>
<p>them in the order they are specified.</p>
<p>For information about Select One project types, see the documentation about building</p>
<p>platform specific programs from the same source files in the<i> MULTI: Managing</i></p>
<p><i>Projects and Configuring the IDE</i> book.</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Pass Through Arguments</b></p>
<p>Passes unknown options to a command (any tool or utility invoked by the Builder).</p>
<p>This is one way of quickly defining custom types. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:passThrough=<i>argument</b></i></p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Reference</b></p>
<p>In a<b> Reference</b> project file, this option designates the project (<b>.gpj</b>) file that is the</p>
<p>target of the reference. Create a<b> Reference</b> project and use this option when you</p>
<p>want to include one project inside of another without carrying over the including</p>
<p>project's options. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>:reference=<i>root_proj</i>[;<i>child_proj</i>]â¦[;<i>target_proj</i>]</b></p>
<p><b>:reference</b> takes a string argument that is a semicolon-separated list of projects.</p>
<p>The Builder uses this list as a path to traverse the project build tree and find the</p>
<p>project you want to reference (<i>target_proj</i>). Each project in the path is the name of</p>
<p>a file listed in the build tree, or &quot;</p>
<p>..</p>
<p>&quot;, which refers to the parent of the previous</p>
<p>project.</p>
<p>If the first project in the list is &quot;</p>
<p>..</p>
<p>&quot;, the Builder traverses the list beginning at the</p>
<p><b>Reference</b> project's parent.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>286</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If the first project is the name of a file, the Builder traverses the list beginning at</p>
<p>the Top Project.</p>
<p>Each project in the list must match the name of a project in the build tree exactly</p>
<p>as defined in your project files. If a project's location is defined using a relative or</p>
<p>absolute disk path, you must include the disk path in the list. For example, if a</p>
<p>project is defined in its parent as<b> dir/x.gpj</b>, the<b> :reference</b> list item for this project</p>
<p>must be<b> dir/x.gpj</b>.</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Pattern of Files to Pull Into Project</b></p>
<p>Specifies the types of files to include in a project. The syntax for this option is:</p>
<p>â¢</p>
<p><b>:autoInclude</b></p>
<p>For more information about Auto Include project types, see the documentation</p>
<p>about auto include in the<i> MULTI: Managing Projects and Configuring the IDE</i></p>
<p>book.</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Options to Apply to Project</b></p>
<p>Specifies the name of an options file that contains a list of builder or driver options</p>
<p>and linker directives (<b>.ld</b>) files to use when building a project. This option allows</p>
<p>you to share a common set of options and linker directives files among multiple</p>
<p>projects. In this file:</p>
<p>â¢</p>
<p>Each line must contain only one option or linker directives file.</p>
<p>â¢</p>
<p>If the line contains an option, it must begin with a whitespace.</p>
<p>â¢</p>
<p>If the line contains a linker directives file, it must begin with the filename.</p>
<p>The lines in this file are processed as if they were present in the<b> .gpj</b> file<b> :optionsFile</b></p>
<p>is set in. These lines may use macros.</p>
<p>The syntax for this option is:</p>
<p><i>287</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Project Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>:optionsFile=<i>filename</b></i></p>
<p>where<i> filename</i> is a path to an options file relative to your Top Project. Options files</p>
<p>often have the<b> .opt</b> extension by convention, but this is not a requirement.</p>
<p>This option controls behavior in the Builder. There is no equivalent driver option.</p>
<p><b>Toolchain Component Locations</b></p>
<p>This option category is contained within<b> AdvancedâProject Options</b>.</p>
<p>These options allow you to vary the location of toolchain components. Note that</p>
<p>they should not be used to specify components of a different version than the</p>
<p>components that are used by default. These options are normally used only for</p>
<p>testing purposes at the advice of Green Hills Software staff.</p>
<p>Alternate Compiler Directory</p>
<p>Specifies an alternate location from which to invoke the compiler. The equivalent</p>
<p>driver option is:</p>
<p>â¢</p>
<p><b>-Y0,<i>directory</b></i></p>
<p>Alternate Library Directory</p>
<p>Specifies an alternate location to search for the standard system libraries if they are</p>
<p>not found in the default location. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-YL,<i>directory</b></i></p>
<p>To search for libraries in another location before searching the default location, use</p>
<p>the<b> -L<i>directory</b></i> option.</p>
<p>If you are not using the default startup code, note that this option changes only the</p>
<p>search path for libraries. This means that the linker always takes<b> crt0.o</b> from the</p>
<p>default location, even if it finds<b> libstartup.a</b> and<b> libsys.a</b> in another specified</p>
<p>location. For more information about how to configure your project to use custom</p>
<p>startup code, see the documentation about settings for Stand-Alone programs in the</p>
<p><i>MULTI: Managing Projects and Configuring the IDE</i> book.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>288</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Alternate Assembler Directory</p>
<p>Specifies an alternate location from which to invoke the assembler. The equivalent</p>
<p>driver option is:</p>
<p>â¢</p>
<p><b>-Ya,<i>directory</b></i></p>
<p>Alternate Linker Directory</p>
<p>Specifies an alternate location from which to invoke the linker. The equivalent</p>
<p>driver option is:</p>
<p>â¢</p>
<p><b>-Yl,<i>directory</b></i></p>
<p>Use 64-bit Toolchain Components</p>
<p>Specifies whether the compiler driver selects 64-bit versions of supported toolchain</p>
<p>components when both 32-bit and 64-bit versions are available. Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-host64</b>) â The driver selects any available 64-bit versions of toolchain</p>
<p>components.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_host64</b>) â The driver selects 32-bit toolchain components only.</p>
<p><b>-host64</b> is the default setting for 64-bit Windows and Linux hosts. (64-bit toolchain</p>
<p>components are not supported on Solaris hosts.) This option does not affect the</p>
<p>driver's behavior for components with explicitly specified locations (see âAlternate</p>
<p>Linker Directoryâ on page 289).</p>
<p><b>Optimization Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p>These options provide very low-level control over various minor optimizations.</p>
<p>These optimizations are generally controlled most effectively by the compiler when</p>
<p>you specify an<b> OptimizationâOptimization Strategy</b>, and you should not use</p>
<p>these options unless you have very particular optimization needs. For more common</p>
<p>options, see âOptimization Optionsâ on page 165.</p>
<p><i>289</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Optimization Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Inline Tiny Functions</b></p>
<p>Controls the inlining of very small functions. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--inline_tiny_functions</b>) â This setting is implied by an</p>
<p><b>OptimizationâOptimization Strategy</b> setting of<b> Optimize for Speed</b></p>
<p>(<b>-Ospeed</b>),<b> -Osize</b>, or<b> -Ogeneral</b> unless<b> DebuggingâDebugging Level</b> is set</p>
<p>to<b> -g</b> or<b> -G</b> or<b> C++ Inlining</b> is set to<b> -no_inlining</b>.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_inline_tiny_functions</b>) â [default]</p>
<p>For more information, see âAutomatic Inliningâ on page 325.</p>
<p><b>Inline Constant Math Functions</b></p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oinline_constant_math</b>) â Allows inlining of math functions with</p>
<p>constant parameters if this has been enabled by an optimization strategy.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Ono_inline_constant_math</b>) â Disables inlining of math functions</p>
<p>with constant parameters if this has been enabled by an optimization strategy.</p>
<p>For more information, see âInlining Constant Math Functionsâ on page 336.</p>
<p><b>Inline C Memory Functions</b></p>
<p>Explicitly controls the inlining of C Memory Functions. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Omemfuncs</b>) â Enables the inlining of C memory functions unless</p>
<p><b>-Onone</b>,<b> -Odebug</b>,<b> -Omoredebug</b>, or<b> -Omaxdebug</b> is enabled.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onomemfuncs</b>) â [default]</p>
<p>For more information, see âInlining of C Memory Functionsâ on page 333.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>290</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Convert C Memset to Memclr</b></p>
<p>Allows you to disable an optimization that replaces</p>
<p>memset</p>
<p>function calls with a</p>
<p>constant zero parameter to</p>
<p>__gh_memclr32</p>
<p>or</p>
<p>__gh_memclr</p>
<p>, depending on the</p>
<p>optimization strategy and whether the memory is known to be aligned. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onomemclr</b>) â Disables this optimization if it is enabled by another</p>
<p>optimization option (such as an optimization strategy). You may want to use</p>
<p>this option if you define your own</p>
<p>memset</p>
<p>function.</p>
<p>â¢</p>
<p><b>On</b> (<b>-Omemclr</b>) â [default] Cancels the effect of<b> -Onomemclr</b>.</p>
<p><b>Inline C String Functions</b></p>
<p>Controls the inlining of some C string functions. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onostrfuncs</b>) â Disables the inlining of C string functions if they have</p>
<p>been enabled by an optimization strategy.</p>
<p>â¢</p>
<p><b>On</b> (<b>-Ostrfuncs</b>) â Enables the inlining of C string functions, unless</p>
<p><b>-Omaxdebug</b>,<b> -Omoredebug</b>,<b> -Odebug</b>, or<b> -Onone</b> is enabled.</p>
<p>For more information, see âInlining of C String Functionsâ on page 333.</p>
<p><b>Simplify C Print Functions</b></p>
<p>Controls print function optimization. You may need to set this option to<b> off</b> if you</p>
<p>define your own print functions (such as</p>
<p>fprintf()</p>
<p>,</p>
<p>fputs()</p>
<p>,</p>
<p>printf()</p>
<p>,</p>
<p>puts()</p>
<p>,</p>
<p>etc.) Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoprintfuncs</b>) â Disables print function optimizations if they are</p>
<p>enabled by another optimization option (such as an optimization strategy).</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oprintfuncs</b>) â Cancels the effect of<b> -Onoprintfuncs</b>.</p>
<p><i>291</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Optimization Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Explode Jumps</b></p>
<p>Allows you to disable the explode jump optimization. This optimization will replace</p>
<p>jump instructions with the code they would otherwise jump to, duplicating code to</p>
<p>remove the jump instruction for speed. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oexplodejumps</b>) â Cancels the effect of<b> -Onoexplodejumps</b>.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoexplodejumps</b>) â Disables this optimization if it is enabled by</p>
<p>another optimization option (such as an optimization strategy).</p>
<p><b>Loop Unrolling</b></p>
<p>Controls the<i> Loop Unrolling</i> optimization. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onounroll</b>) â Disables loop unrolling if it has been enabled by an</p>
<p>optimization strategy.</p>
<p>â¢</p>
<p><b>On</b> (<b>-Ounroll</b>) â Cancels the effect of<b> -Onounroll</b>.</p>
<p>For more information, see âLoop Unrollingâ on page 350.</p>
<p><b>Register Allocation by Coloring</b></p>
<p>Controls the dynamic storage of variables in registers. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-overload</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nooverload</b>)</p>
<p>This option has limited effect when<b> -extend_liveness</b> is enabled, such as with</p>
<p><b>-Omoredebug</b> or<b> -Omaxdebug</b>.</p>
<p>For more information, see âRegister Allocation by Coloringâ on page 362.</p>
<p><b>Automatic Register Allocation</b></p>
<p>Controls the automatic allocation of local variables to registers. Permitted settings</p>
<p>for this option are:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>292</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>On</b> (<b>-autoregister</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-noautoregister</b>)</p>
<p>For more information, see âAutomatic Register Allocationâ on page 363.</p>
<p><b>Common Subexpression Elimination</b></p>
<p>Controls the<i> Common Subexpression Elimination</i> optimization. Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onocse</b>) â Disables common subexpression elimination if it has been</p>
<p>enabled by an optimization strategy.</p>
<p>â¢</p>
<p><b>On</b> (<b>-Ocse</b>) â Cancels the effect of<b> -Onocse</b>.</p>
<p>For more information, see âCommon Subexpression Eliminationâ on page 356.</p>
<p><b>Tail Calls</b></p>
<p>Controls the<i> Tail Recursion</i> optimization. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onotailrecursion</b>) â Disables tail recursion if it has been enabled by</p>
<p>an optimization strategy.</p>
<p>â¢</p>
<p><b>On</b> (<b>-Otailrecursion</b>) â Cancels the effect of<b> -Onotailrecursion</b>.</p>
<p>For more information, see âTail Callsâ on page 357.</p>
<p><b>Constant Propagation</b></p>
<p>Controls the<i> Constant Propagation</i> optimization. Permitted settings for this option</p>
<p>are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoconstprop</b>) â Disables constant propagation if it has been enabled</p>
<p>by an optimization strategy.</p>
<p>â¢</p>
<p><b>On</b> (<b>-Oconstprop</b>) â Cancels the effect of<b> -Onoconstprop</b>.</p>
<p>For more information, see âConstant Propagationâ on page 358.</p>
<p><i>293</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Optimization Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>C/C++ Minimum/Maximum Optimization</b></p>
<p>Controls the<i> C/C++ Minimum/Maximum</i> optimization. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onominmax</b>) â Disables minimum/maximum optimization if it has</p>
<p>been enabled by an optimization strategy.</p>
<p>â¢</p>
<p><b>On</b> (<b>-Ominmax</b>) â Cancels the effect of<b> -Onominmax</b>.</p>
<p>For more information, see âC/C++ Minimum/Maximum Optimizationâ on page 359.</p>
<p><b>Memory Optimization</b></p>
<p>Controls<i> Memory</i> optimizations. This optimization is enabled by all optimization</p>
<p>strategies except<b> -Onone</b> and<b> -Omaxdebug</b>. If no optimization strategy is selected,</p>
<p>this option enables<b> -Ogeneral</b>. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-OM</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onomemory</b>) â [default]</p>
<p>For more information, see âMemory Optimizationâ on page 359.</p>
<p><b>Optimize All Appropriate Loops</b></p>
<p>Turns on all the<b> General Use</b> optimizations, together with loop strength reduction,</p>
<p>loop unrolling, and loop invariant analysis. This optimization is enabled by<b> -Ospeed</b>.</p>
<p>If no optimization strategy is selected, this option enables<b> -Ospeed</b>. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-OL</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onoloop</b>) â [default]</p>
<p>For more information, see âLoop Optimizationsâ on page 347.</p>
<p><b>Peephole Optimization</b></p>
<p>Controls peephole optimizations. Permitted settings for this option are:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>294</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Off</b> (<b>-Onopeephole</b>) â Disables peephole optimizations if they have been</p>
<p>enabled by an optimization strategy.</p>
<p>â¢</p>
<p><b>On</b> (<b>-Opeep</b>) â Cancels the effect of<b> -Onopeephole</b>.</p>
<p>For more information, see âPeephole Optimizationâ on page 352.</p>
<p><b>Pipeline Instruction Scheduling</b></p>
<p>Controls pipeline optimizations. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-Onopipeline</b>) â Disables pipeline optimizations if they have been enabled</p>
<p>by an optimization strategy.</p>
<p>â¢</p>
<p><b>On</b> (<b>-Opipeline</b>) â Cancels the effect of<b> -Onopipeline</b>.</p>
<p>For more information, see âPipeline Instruction Schedulingâ on page 353.</p>
<p><b>GNU Compatibility Optimizations</b></p>
<p>For convenience, Green Hills provides compatibility with the general GNU</p>
<p>optimization options. For precise control over the compiler, we recommend that</p>
<p>you use Optimization Strategies instead (see âOptimization Strategyâ on page 165).</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>-O0</b> â Use<b> -Onone</b>.</p>
<p>â¢</p>
<p><b>-O1</b> â Use<b> -Ogeneral</b>.</p>
<p>â¢</p>
<p><b>-O2</b> â Use<b> -Ospeed</b> and<b> -Onounroll</b>.</p>
<p>â¢</p>
<p><b>-O3</b> â Use<b> -Ospeed</b>,<b> -OI</b>, and<b> -OB</b>.</p>
<p><b>Debugging Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p>These options provide control over advanced debugging features. For more common</p>
<p>options, see âDebugging Optionsâ on page 176.</p>
<p><i>295</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Debugging Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Generate Function Entry/Exit Instrumentation</b></p>
<p>Controls whether the compiler generates function entry/exit instrumentation. This</p>
<p>setting defaults to âOffâ. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_gen_entry_exit_history</b>)</p>
<p>â¢</p>
<p><b>On</b> (<b>-gen_entry_exit_history</b>)</p>
<p>For more information about function entry/exit generation, see âFunction Entry/Exit</p>
<p>Loggingâ on page 176.</p>
<p><b>Generate Function Entry/Exit Instrumentation with Arguments</b></p>
<p>Controls whether the compiler generates function entry/exit instrumentation with</p>
<p>function arguments. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_gen_entry_exit_arg_history</b>) â [default] Function entry/exit logging</p>
<p>instructions are not generated by the compiler.</p>
<p>â¢</p>
<p><b>On</b> (<b>-gen_entry_exit_arg_history</b>) â Function entry/exit logging instructions</p>
<p>are generated by the compiler in the prologue and epilogue of each logged</p>
<p>function.</p>
<p>For more information about function entry/exit generation, see âLogging Function</p>
<p>Entry and Exit (FEE) Eventsâ on page 50.</p>
<p><b>EAGLE Record Signal</b></p>
<p>Indicated EAGLE signals are enabled by the linker. Signals can be disabled at</p>
<p>run-time with the<b> eagleconfig</b> MULTI command. For information about this</p>
<p>command, see the MULTI: Debugging Command Reference. Please note that the</p>
<p><b>eagleconfig</b> command is only available for MULTI 7 or newer. The equivalent</p>
<p>driver option is:</p>
<p>â¢</p>
<p><b>-record_eagle_signal=<i>signal1[,signal2...]</b></i></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>296</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>EAGLE Mute Signal</b></p>
<p>Indicated EAGLE signals are disabled by the linker. Signals can be enabled at</p>
<p>run-time with the<b> eagleconfig</b> MULTI command. For information about this</p>
<p>command, see the MULTI: Debugging Command Reference. Please note that the</p>
<p><b>eagleconfig</b> command is only available for MULTI 7 or newer. The equivalent</p>
<p>driver option is:</p>
<p>â¢</p>
<p><b>-mute_eagle_signal=<i>signal1[,signal2...]</b></i></p>
<p><b>EAGLE Strip Signal</b></p>
<p>Indicated EAGLE signals are stripped from the code by the linker. (Stripped code</p>
<p>is similar though not identical to code without EAGLE signals.) Stripped signals</p>
<p>cannot be enabled at run-time with the<b> eagleconfig</b> MULTI command. For</p>
<p>information about this command, see the MULTI: Debugging Command Reference.</p>
<p>Please note that the<b> eagleconfig</b> command is only available for MULTI 7 or newer.</p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-strip_eagle_signal=<i>signal1[,signal2...]</b></i></p>
<p><b>Generate Target-Walkable Stack</b></p>
<p>Creates a frame pointer in register</p>
<p>r28</p>
<p>. You can use this option to perform stack</p>
<p>traces if you do not have debug information, however, optimizations might cause</p>
<p>gaps in the stack trace. The current V850 and RH850 libraries are built with the<b> -ga</b></p>
<p>option to support stack traces. Without this option, some routines do not create a</p>
<p>stack frame to reduce code size and improve performance. You must be careful if</p>
<p>you decide to use this option, however, as it may produce unexpected complications,</p>
<p>such as disabling good leaf procedure optimization. Using<b> -ga</b> without<b> -G</b> may only</p>
<p>guarantee a stack trace and use of the return button in the MULTI Debugger.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-gtws</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nogtws</b>) â [default]</p>
<p><i>297</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Debugging Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-Olimit= Without Debug Information</b></p>
<p>Instructs the compiler to limit optimizations for debugging, even when debug</p>
<p>information is not being generated. By default,<b> -Olimit=peephole</b> and</p>
<p><b>-Olimit=pipeline</b> are only meaningful when debug information is enabled. However,</p>
<p>the compiler can still make some attempt to restrict optimizations to assist debugging,</p>
<p>even when debug information is never generated. Note that the results will not be</p>
<p>as good as they would be if debug information were enabled. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-glimits</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-noglimits</b>) â [default]</p>
<p><b>Consistent code without debug information</b></p>
<p>Instructs the compiler to produce the same code with the<b> --no_debug</b> option as it</p>
<p>does with either<b> -g</b> or<b> -G</b>. Do not use this option with<b> -g</b>,<b> -gs</b>, or<b> -G</b>. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-consistentcode</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-noconsistentcode</b>) â [default]</p>
<p><b>Full Breakdots</b></p>
<p>Controls the number of breakdots available in the</p>
<p>MULTI</p>
<p>Debugger. This option</p>
<p>has an effect only when<b> -Onone</b>,<b> -Odebug</b>,<b> -Omoredebug</b>, or<b> -Omaxdebug</b> is</p>
<p>enabled. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-full_breakdots</b>) â Increases the number of breakdots available in the</p>
<p>MULTI Debugger, but may add additional instructions to your code. This is</p>
<p>the default setting if<b> -Omaxdebug</b> or<b> -Omoredebug</b> is enabled.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_full_breakdots</b>) â This is the default setting if<b> -Onone</b> or<b> -Odebug</b></p>
<p>are enabled.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>298</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Extend Variable Liveness</b></p>
<p>Controls access to local automatic variables in the MULTI Debugger. This option</p>
<p>has an effect only when<b> -Onone</b>,<b> -Odebug</b>,<b> -Omoredebug</b>, or<b> -Omaxdebug</b> is</p>
<p>enabled. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-extend_liveness</b>) â Local automatic variables are accessible from the</p>
<p>MULTI Debugger after they are written. This is the default setting if</p>
<p><b>-Omaxdebug</b> or<b> -Omoredebug</b> is enabled.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_extend_liveness</b>) â Local automatic variables are accessible from</p>
<p>the MULTI Debugger as long as they might be read before being written to.</p>
<p>This is the default setting if<b> -Onone</b> or<b> -Odebug</b> are enabled.</p>
<p><b>Search Path for .dbo Files</b></p>
<p>Specifies a<i> directory</i> to search for<b> .dbo</b> debugging information files. The equivalent</p>
<p>driver option is:</p>
<p>â¢</p>
<p><b>-dbopath<i> directory</b></i></p>
<p>This option is only needed if object files are moved between being compiled and</p>
<p>linked.</p>
<p><b>Search for DBA</b></p>
<p>Controls searching for<b> .dba</b> files in incremental link situations and enables creation</p>
<p>of a<b> .dba</b> file corresponding to the<b> .o</b> file created by an incremental link.</p>
<p>If you want to generate debug information for a relocatable object file (using<b> -G</b></p>
<p>and<b> -relobj</b>) and the machine that will be performing the subsequent link will not</p>
<p>have access to the original<b> .o</b> or<b> .dbo</b> files, pass the<b> -search_for_dba</b> option.</p>
<p>For example, the following set of options creates a<b> myobj.dba</b> file that you can</p>
<p>distribute with<b> myobj.o</b> to provide debug information to MULTI:</p>
<p>ccv850 file1.c file2.c -G -relobj -o myobj.o</p>
<p><i>299</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Debugging Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>When performing subsequent links with<b> myobj.o</b>, continue to pass the</p>
<p><b>-search_for_dba</b> option to force<b> dblink</b> to search for<b> myobj.dba</b> instead of only</p>
<p>looking for<b> myobj.dbo</b>.</p>
<p><b>-search_for_dba</b> is not necessary if the original<b> .dbo</b> files that comprise<b> myobj.dba</b></p>
<p>(<b>file1.dbo</b> and<b> file2.dbo</b> in the above example) are still available.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-search_for_dba</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_search_for_dba</b>) â [default]</p>
<p><b>Force Frame Pointer</b></p>
<p>Controls the use of a frame pointer during code generation. Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-ga</b>) â Always use a frame pointer. Implied by<b> DebuggingâRun-Time</b></p>
<p><b>Memory Checks</b>.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-noga</b>) â [default] Use of a frame pointer is not guaranteed.</p>
<p><b>Scan source files to augment native debug info</b></p>
<p>Improves the code browsing features of MULTI when using code compiled by</p>
<p>third-party compilers. This feature causes the<b> dwarf2dbo</b> or<b> stabs2dbo</b> Debug</p>
<p>Translator to gather information directly from source files.<b> --scan_source</b> causes</p>
<p>source scanning to occur whenever debugging information is translated as part of</p>
<p>the project build. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--scan_source</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_scan_source</b>)</p>
<p>You can use<b> --scan_source</b> if the root of your sources has changed. For more</p>
<p>information about<b> --scan_source</b>, see âBuilding and Debugging on Different Hostsâ</p>
<p>on page 58 and âSource Scanningâ on page 59.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>300</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Add Extra File to Debug Info</b></p>
<p>When this option is used, an entry for the specified file is added to the debug</p>
<p>information generated by the compiler. This allows the debugger to find that file</p>
<p>when you click its name or use the<b> e</b> command. This option is useful for including</p>
<p>notes or text-based custom files in to the set of files the debugger can display. By</p>
<p>default, the builder (command line or graphical) includes all source code and &quot;Text&quot;</p>
<p>files in the debug information. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-extra_file=<i>filename</b></i></p>
<p><b>Set Maximum DBO Not Found Warnings</b></p>
<p>Limits the number of &quot;</p>
<p>dbo not found</p>
<p>&quot; warnings to the given number. The default</p>
<p>limit is 9. Setting the limit to 0 hides all such warnings. The equivalent driver option</p>
<p>is:</p>
<p>â¢</p>
<p><b>-warn_dbo_not_found_max=<i>n</b></i></p>
<p><b>Wait for Debug Translation Before Exiting</b></p>
<p>Controls whether the compiler driver waits for debug information to be generated</p>
<p>before exiting. The program can be executed immediately after the driver exits, but</p>
<p>debugging is not possible until<b> dblink</b> has finished generating debug information.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-wait_for_dblink</b>) â [default] The compiler driver waits for<b> dblink</b> to</p>
<p>finish generating debug information before exiting.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-do_not_wait_for_dblink</b>) â The compiler driver does not wait for</p>
<p><b>dblink</b>. This option is not supported with<b> -strip</b>. When using this option, do</p>
<p>not open MULTI or other executables that require debug information until</p>
<p>debug translation has completed.</p>
<p><b>Profiling - Call Count</b></p>
<p>These options are deprecated and will be removed in a future release.</p>
<p><i>301</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Debugging Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Controls<i> call count</i> profiling, which records how many times each function is called.</p>
<p>Call count profiling is not thread safe. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On with Call Graph</b> (<b>-pg</b>) â Generates call count information that includes</p>
<p>the name of each caller. This information can be used to generate a call graph.</p>
<p>â¢</p>
<p><b>On</b> (<b>-p</b>) â Generates basic call count information.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-pnone</b>) â [default] Disables call count profiling.</p>
<p><b>Profiling - Legacy Coverage</b></p>
<p>This option has been replaced by the<b> -coverage</b> option (see âProfiling - Block</p>
<p>Coverageâ on page 177).</p>
<p>Controls legacy<i> coverage</i> profiling, which records whether your application contains</p>
<p>lines of code that are not used. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-a</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_coverage_analysis</b>) â [default]</p>
<p>Legacy coverage profiling might not be reliable when used in conjunction with</p>
<p>compiler optimizations, link-time optimizations, and options that cause code</p>
<p>instrumentation (for example, run-time error checking).</p>
<p><b>Multicore Configuration File</b></p>
<p>Specifies the path to a multi-core configuration file (<b>*.ghsmc</b>) that the MULTI</p>
<p>Debugger uses to set up your multi-core target. Note that this option is only available</p>
<p>for MULTI 7 or newer. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-ghsmc_file=<i>path</b></i></p>
<p>For more information, see the documentation about using a multi-core configuration</p>
<p>file in<i> MULTI: Debugging</i>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>302</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Multicore Core Count</b></p>
<p>Applies the project executable to any SMP hardware target whose core count is</p>
<p>within the specified range (boundaries are included). Note that this option is only</p>
<p>available for MULTI 7 or newer. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-ghsmc_core_count=<i>range</b></i></p>
<p>Where</p>
<p><i>range</i></p>
<p>can be specified in four ways:</p>
<p>Enable SMP debugging when target hardware</p>
<p>has exactly the number of cores as</p>
<p><i>CoreCount</i></p>
<p>.</p>
<p><b>-ghsmc_core_count=</b></p>
<p><i>CoreCount</i></p>
<p>Enable SMP debugging when target hardware</p>
<p>has at least as many cores as</p>
<p><i>MinCoreCount</i></p>
<p>.</p>
<p><b>-ghsmc_core_count=</b></p>
<p><i>MinCoreCount</i>-</p>
<p>Enable SMP debugging when target hardware</p>
<p>has up to</p>
<p><i>MaxCoreCount</i></p>
<p>cores.</p>
<p><b>-ghsmc_core_count=</b></p>
<p>-<i>MaxCoreCount</i></p>
<p>Enable SMP debugging when target hardware</p>
<p>has a number of cores that falls within</p>
<p><i>[MinCoreCount, MaxCoreCount]</i></p>
<p>,</p>
<p>inclusive.</p>
<p><b>-ghsmc_core_count=</b></p>
<p><i>MinCoreCount</i>-<i>MaxCoreCount</i></p>
<p><b>Reducing Debug File Size</b></p>
<p>This option category is contained within<b> AdvancedâDebugging Options</b>.</p>
<p>These options allow you to vary the amount of debugging information that will be</p>
<p>generated for use with the MULTI Debugger. Note that reducing the amount of</p>
<p>information collected may speed up performance, but it may also reduce the depth</p>
<p>of analysis available through the Debugger.</p>
<p>Cross-Reference Information</p>
<p>Controls the amount of debugging cross-referencing information that is generated.</p>
<p>By default, the compiler generates cross-reference data for each user-defined</p>
<p>construct (describing where the construct is declared, defined, read from, written</p>
<p>to, and so on), to allow the Debugger to display cross references. Permitted settings</p>
<p>for this option are:</p>
<p><i>303</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Debugging Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Generate for All Objects</b> (<b>--xref=full</b>) â [default] Generates cross-referencing</p>
<p>data for all objects.</p>
<p>â¢</p>
<p><b>Generate for Object Declarations and Definitions</b> (<b>--xref=declare</b>) â</p>
<p>Generates cross-referencing data only for the declarations and definitions of</p>
<p>the objects.</p>
<p>â¢</p>
<p><b>Generate for Objects in the Global Scope</b> (<b>--xref=global</b>) â Generates</p>
<p>cross-referencing data for the objects that are declared in the global scope.</p>
<p>â¢</p>
<p><b>Do Not Generate</b> (<b>--xref=none</b>) â Disables all cross-referencing data.</p>
<p>Debugging Information</p>
<p>Controls the generation of debugging information for types and defines that are</p>
<p>never used in a file. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>All</b> (<b>-full_debug_info</b>) â Enables the generation of debugging information</p>
<p>for types and defines that are never used in a file.</p>
<p>â¢</p>
<p><b>Reduced</b> (<b>-no_full_debug_info</b>) â [default] Disables the generation of</p>
<p>debugging information for types and defines that are never used in a file.</p>
<p><b>Native Debugging Information</b></p>
<p>This option category is contained within<b> AdvancedâDebugging Options</b>.</p>
<p>These options control the generation of alternate native debugging formats. Use</p>
<p>them only if you use third-party tools that require native debugging information.</p>
<p>The MULTI Debugger only uses the<b> .dbo</b> format.</p>
<p>Generate MULTI and Native Information</p>
<p>Enables the generation of DWARF debugging information in the object file (in</p>
<p>addition to the Green Hills<b> .dbo</b> format), according to the convention for your target.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-dual_debug</b>|<b>-dwarf2</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_dual_debug</b>) â [default]</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>304</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Requires that the<b> DebuggingâDebugging Level</b> be set to Plain or MULTI for the</p>
<p>option to have any effect (see âDebugging Optionsâ on page 176).</p>
<p>Convert DWARF Files to MULTI (.dbo) Format</p>
<p>Controls the conversion of DWARF debugging information to the MULTI<b> .dbo</b></p>
<p>format. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-dwarf_to_dbo</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_dwarf2dbo</b>) â [default]</p>
<p>This option will normally be invoked automatically when necessary by the builder.</p>
<p>Convert Stabs Files to MULTI (.dbo) Format</p>
<p>Controls the conversion of Stabs debugging information to the MULTI<b> .dbo</b> format.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-stabs2dbo</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_stabs2dbo</b>) â [default]</p>
<p>This option will normally be invoked automatically when necessary by the builder.</p>
<p><b>Preprocessor Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p>These options control advanced preprocessor settings. For more common options,</p>
<p>see âPreprocessor Optionsâ on page 182.</p>
<p><b>Files to Pre-Include</b></p>
<p>Includes the source code of each specified<i> filename</i> at the beginning of the</p>
<p>compilation. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-include<i> filename</i>[,filename]...</b></p>
<p><i>305</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Preprocessor Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>This can be used to establish standard macro definitions, and so on. The<i> filename</i></p>
<p>is searched for in the directories on the include search list.</p>
<p><b>Assembly Files to Pre-Include</b></p>
<p>Includes each<i> filename</i> at the beginning of any preprocessed assembly files, similar</p>
<p>to<b> -include</b>. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>--preinclude_asm<i> filename</i>[,filename]...</b></p>
<p><b>Definition of Standard Symbols</b></p>
<p>Controls the definition of the set of default symbols. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Define</b> (<b>-stddef</b>) â [default] You can use this option in a MULTI Project (<b>.gpj</b>)</p>
<p>file, but there is no equivalent driver option.</p>
<p>â¢</p>
<p><b>Do Not Define</b> (<b>-nostddef</b>)</p>
<p><b>Definition of Unsafe Symbols</b></p>
<p>Controls the predefinition of preprocessor macros without leading underscores.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Define</b> (<b>--unsafe_predefines</b>) â Predefine macros both with and without</p>
<p>leading underscores.</p>
<p>â¢</p>
<p><b>Do Not Define</b> (<b>--no_unsafe_predefines</b>) â [default] Predefine macros only</p>
<p>with leading underscores.</p>
<p>When compiling C++ code in Strict Standard Mode, this option has no effect.</p>
<p><b>Retain Comments During Preprocessing</b></p>
<p>Controls the retention of comments by the preprocessor. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Retain</b> (<b>-C</b>)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>306</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Strip</b> (<b>--no_comments</b>) â [default]</p>
<p><b>Advanced Include Directories</b></p>
<p>This option category is contained within<b> AdvancedâPreprocessor Options</b>.</p>
<p>By default, the Builder and driver search for header files in various standard</p>
<p>directories provided with your distribution. These options allow you to vary the</p>
<p>location of these standard directories.</p>
<p>Standard Include Directories</p>
<p>Controls whether the standard include directories are searched. Permitted settings</p>
<p>for this option are:</p>
<p>â¢</p>
<p><b>Search</b> (<b>-stdinc</b>) â [default]</p>
<p>â¢</p>
<p><b>Do Not Search</b> (<b>-nostdinc</b>)</p>
<p>C Include Directories</p>
<p>Changes the default location in which the compiler searches for C header files. The</p>
<p>equivalent driver option is:</p>
<p>â¢</p>
<p><b>-c_include_directory<i> directory</b></i></p>
<p>C++ Standard Include Directories</p>
<p>Changes the default location in which the compiler searches for C++ header files.</p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-std_cxx_include_directory<i> directory</b></i></p>
<p>System Include Directories</p>
<p>Changes the default location in which the compiler searches for system header files.</p>
<p>This option may be specified multiple times to cause the compiler to search in</p>
<p><i>307</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Preprocessor Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>multiple directories. Any directory that is not specified with an absolute path is</p>
<p>located relative to the current working directory. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-sys_include_directory<i> directory</b></i></p>
<p><b>C/C++ Compiler Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p>These options control advanced C and C++ compilation settings. For more common</p>
<p>options, see âC/C++ Compiler Optionsâ on page 184.</p>
<p><b>C++ Inlining Level</b></p>
<p>Controls the inlining of C++ functions. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Maximum</b> (<b>--max_inlining</b>) â Considers all appropriate functions for inlining.</p>
<p>Appropriate functions include</p>
<p>inline</p>
<p>functions and functions defined inside</p>
<p>of classes.</p>
<p>â¢</p>
<p><b>Maximum Unless Debugging</b> (<b>--max_inlining_unless_debug</b>) â Performs</p>
<p>maximum inlining unless debugging information is being collected.</p>
<p>â¢</p>
<p><b>Standard</b> (<b>--inlining</b>) â [default] Considers only relatively small functions</p>
<p>without control flow statements for inlining.</p>
<p>â¢</p>
<p><b>Standard Unless Debugging</b> (<b>--inlining_unless_debug</b>) â Performs standard</p>
<p>inlining unless debugging information is being collected. If debugging</p>
<p>information is being collected, this option disables inlining of C++ functions,</p>
<p>but unlike</p>
<p>--no_inlining</p>
<p>, it does not disable</p>
<p>--inline_tiny_functions</p>
<p>,</p>
<p>-OI</p>
<p>,</p>
<p>-Oipsmallinlining</p>
<p>, and</p>
<p>-Oiponesiteinlining</p>
<p>).</p>
<p>â¢</p>
<p><b>None</b> (<b>--no_inlining</b>) â Disables inlining of C++ functions. This option also</p>
<p>disables<b> --inline_tiny_functions</b>,<b> -OI</b>,<b> -Oipsmallinlining</b>, and</p>
<p><b>-Oiponesiteinlining</b>. This option does not disable<b> -inline_trivial</b> in the linker.</p>
<p>For more information, see âAdditional C++ Inlining Informationâ on page 335.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>308</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Emulated GNU Version</b></p>
<p>Controls the version of the GNU compiler that the Green Hills compiler provides</p>
<p>compatibility with. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>GNU 3.3</b> (<b>--gnu_version=30300</b>) â When using a GNU dialect, provide close</p>
<p>compatibility with the GNU 3.3 compiler.</p>
<p>â¢</p>
<p><b>GNU 4.3</b> (<b>--gnu_version=40300</b>) â [default] When using a GNU dialect,</p>
<p>provide close compatibility with the GNU 4.3 compiler.</p>
<p><b>-gnu99 Inline Semantics</b></p>
<p>Controls how the<b> -gnu99</b> C dialect will determine the linkage for functions with</p>
<p>the</p>
<p>inline</p>
<p>keyword. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>ISO C99 Inline Semantics</b> (<b>-fno-gnu89-inline</b>) â [default] The</p>
<p>inline</p>
<p>keyword will be handled in accordance with the ISO C99 standard.</p>
<p>â¢</p>
<p><b>GNU C89 Inline Semantics</b> (<b>-fgnu89-inline</b>) â The</p>
<p>inline</p>
<p>keyword will</p>
<p>be handled in a manner similar to that of earlier GNU compilers.</p>
<p><b>Prepend String to Every Section Name</b></p>
<p>Specifies a<i> string</i> to prepend to every section name. The equivalent driver option</p>
<p>is:</p>
<p>â¢</p>
<p><b>--section_prefix<i> string</b></i></p>
<p><b>Append String to Every Section Name</b></p>
<p>Specifies a<i> string</i> to append to every section name. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>--section_suffix<i> string</b></i></p>
<p><b>WChar Size</b></p>
<p>Controls the type of</p>
<p>wchar_t</p>
<p>, which is known to the compiler, declared in<b> stddef.h</b>,</p>
<p>and used in various C library functions. Permitted settings for this option are:</p>
<p><i>309</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C/C++ Compiler Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>-wchar_u16</b> â [default]</p>
<p>wchar_t</p>
<p>is</p>
<p>unsigned short</p>
<p>. This option is not</p>
<p>supported with Embedded Linux. The default setting for Embedded Linux is</p>
<p><b>-wchar_s32</b>.</p>
<p>â¢</p>
<p><b>-wchar_s32</b> â</p>
<p>wchar_t</p>
<p>is signed and 32 bits. This option is not supported</p>
<p>with INTEGRITY.</p>
<p>This option also determines the C and C++ libraries selected by the driver (see</p>
<p>âStandard Function Names Converted by the Linkerâ on page 861) and causes the</p>
<p>linker to associate calls to some standard C library functions to alternate names (see</p>
<p>âLibrariesâ on page 820). When this option is set to a non-default value, the</p>
<p>deprecated<b> -no_floatio</b> is not supported.</p>
<p><b>longjmp() Does Not Restore Local Vars</b></p>
<p>Controls whether the values of local non-volatile variables are modified by</p>
<p>longjmp</p>
<p>calls. ANSI C standards require only that the values of volatile variables are not</p>
<p>modified. Protecting non-volatile values requires additional overhead. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-locals_unchanged_by_longjmp</b>) â Guarantees that the values of all</p>
<p>local variables are not modified by</p>
<p>longjmp</p>
<p>calls.</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_locals_unchanged_by_longjmp</b>) â [default] Guarantees only that</p>
<p>the values of volatile local variables are not modified by</p>
<p>longjmp</p>
<p>calls.</p>
<p><b>Accept GNU __asm__ statements</b></p>
<p>Provides a way to enable the GNU extended</p>
<p>asm</p>
<p>syntax support. This support is</p>
<p>unconditionally enabled in<b> -gcc</b> and<b> --g++</b> modes, and enabled by default in</p>
<p>non-GNU modes. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--gnu_asm</b>) â [default in GNU and non-GNU modes] Enables GNU</p>
<p>extended</p>
<p>asm</p>
<p>syntax support for most common use cases. Not all use cases</p>
<p>and constraints are supported.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_gnu_asm</b>) â Disables GNU extended</p>
<p>asm</p>
<p>syntax support. The<b> -gcc</b></p>
<p>and<b> --g++</b> options override this option, because GNU mode implies support</p>
<p>for GNU</p>
<p>asm</p>
<p>syntax.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>310</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Identifier Definition</b></p>
<p>Passes the arbitrary string<i> string</i> to the output file. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-ident=<i>string</b></i></p>
<p>This is the same as using the directive</p>
<p>#pragma ident &quot;<i>string</i>&quot;</p>
<p>in C (see</p>
<p>âGeneral Pragma Directivesâ on page 796). This option can be used to place the</p>
<p>date of the source file in the object file.</p>
<p><b>Identifier Support</b></p>
<p>Controls support for identifier definition and insertion (via the Builder and driver</p>
<p>options above, and through</p>
<p>#pragma ident &quot;<i>string</i>&quot;</p>
<p>). Permitted settings for</p>
<p>this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-identoutput</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>-noidentoutput</b>)</p>
<p><b>Advanced C++ Options</b></p>
<p>This option category is contained within<b> AdvancedâC/C++ Compiler Options</b>.</p>
<p>These options control advanced C++ compilation settings.</p>
<p>Demangling of Names in Linker Messages</p>
<p>Controls whether linker error output is written to a file and filtered after the link is</p>
<p>finished, or printed to standard output at link time. This option is most commonly</p>
<p>enabled for C++ programs; output is written to a file and filtered so that symbol</p>
<p>names can be demangled before you view them. The error messages usually indicate</p>
<p>undefined or multiply defined symbols. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--link_filter</b>) â [default]</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_link_filter</b>)</p>
<p><i>311</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C/C++ Compiler Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>C++ Linking Method</p>
<p>Controls the method for generating constructors/destructors at link-time. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>Use Linker</b> (<b>--linker_link</b>) â [default]</p>
<p>â¢</p>
<p><b>Create Array of Static Constructors/Destructors for Post-Link Phase</b></p>
<p>(<b>--munch</b>)</p>
<p>â¢</p>
<p><b>Do not Generate Constructors/Destructors</b> (<b>--nocpp</b>)</p>
<p>Distinct C and C++ Functions</p>
<p>Controls whether identical C and C++ functions are treated as distinct. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--c_and_cpp_functions_are_distinct</b>) â Treat function types as distinct</p>
<p>if their only difference is that one has</p>
<p>extern &quot;C&quot;</p>
<p>linkage and the other has</p>
<p>extern &quot;C++&quot;</p>
<p>routine linkage.</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_c_and_cpp_functions_are_distinct</b>) â [default] Do not treat such</p>
<p>functions as distinct.</p>
<p>Support for Implicit Extern C Type Conversion</p>
<p>Controls an extension to permit implicit type conversion in C++ between a pointer</p>
<p>to an</p>
<p>extern C</p>
<p>function and a pointer to an</p>
<p>extern C++</p>
<p>function. Also, see</p>
<p>âDistinct C and C++ Functionsâ on page 312. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>--implicit_extern_c_type_conversion</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>--no_implicit_extern_c_type_conversion</b>) â [default]</p>
<p><b>Assembler Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p>These options control advanced assembler settings. For more common options, see</p>
<p>âC/C++ Compiler Optionsâ on page 184.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>312</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Assembler Warnings</b></p>
<p>Controls the display of assembler warning messages. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Display</b> (<b>--assembler_warnings</b>) â</p>
<p>â¢</p>
<p><b>Suppress</b> (<b>--no_assembler_warnings</b>) [default]</p>
<p><b>Linker Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p>These options control advanced linker settings. For more common options, see</p>
<p>âLinker Optionsâ on page 235. If you use the driver to compile and link your program</p>
<p>in multiple steps, pass the same set of options for each step.</p>
<p><b>Support floating point types in scanf</b></p>
<p>Controls the inclusion of floating-point</p>
<p>scanf()</p>
<p>code. Permitted settings for this</p>
<p>option are:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-no_float_scanf</b>) â Inform the compiler and linker that no calls to</p>
<p>scanf()</p>
<p>or its related functions, such as</p>
<p>fscanf()</p>
<p>or</p>
<p>sscanf()</p>
<p>, use floating</p>
<p>point, therefore it is not necessary to bring in the support code for floating-point</p>
<p>scanf()</p>
<p>, saving space in the target program. This option is implied by<b> -fnone</b>.</p>
<p>â¢</p>
<p><b>On</b> (<b>-float_scanf</b>) â [default] Bring in the floating-point support code for</p>
<p>scanf()</p>
<p>if there is any call to</p>
<p>scanf()</p>
<p>or its related functions.</p>
<p><b>Linker Directives Directory</b></p>
<p>Specifies the directory containing the default linker directives file or files. This</p>
<p>option has no effect if you explicitly specify a linker directives file in your project</p>
<p>or on the command line. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-directive_dir=<i>directory</b></i></p>
<p><i>313</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Linker Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Link in Standard Libraries</b></p>
<p>Controls the linking-in of any Green Hills standard startup files or libraries.</p>
<p>User-specified libraries are not affected. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Link</b> (<b>-stdlib</b>) â [default] Use Green Hills standard libraries.</p>
<p>â¢</p>
<p><b>Do Not Link</b> (<b>-nostdlib</b>) â Do not use Green Hills standard libraries, or link</p>
<p>against the Green Hills or any user-defined start or end files (see âStart and</p>
<p>End Filesâ on page 244).</p>
<p>When you use this option, the linker may return an unresolved symbol error</p>
<p>due to references to architecture support routines, even if your code has no</p>
<p>apparent external library dependencies.</p>
<p><b>Link in Minimum Libraries</b></p>
<p>This option causes only the target-specific run-time support library<b> libarch.a</b> to be</p>
<p>searched. No other Green Hills libraries will be searched.<b> libarch.a</b> is the most</p>
<p>basic library; it provides definitions of internal symbols that may be required by</p>
<p>any file compiled with the Green Hills compilers. This option does not remove the</p>
<p><b>-L</b> option that points to the Green Hills library directories, or the start-up files (which</p>
<p>can be done with<b> -nostartfiles</b>), and the option does not change how the linker</p>
<p>directives files are handled.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-minlib</b>)</p>
<p>â¢</p>
<p><b>Off</b> (<b>-nominlib</b>) â [default]</p>
<p><b>Link Mode</b></p>
<p>Controls overwriting of an existing executable. By default, the linker overwrites</p>
<p>any existing file with the same name as the specified output file. However, the driver</p>
<p>can also save a temporary backup copy of the existing file in order to restore it if</p>
<p>the link fails. If the link succeeds, the backup copy is silently deleted. Permitted</p>
<p>settings for this option are:</p>
<p>â¢</p>
<p><b>Overwrite the existing executable</b> (<b>--link_output_mode_reuse</b>) â [default]</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>314</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Save a temporary copy unless the existing file is a symlink</b></p>
<p>(<b>--link_output_mode_safe</b>)</p>
<p>â¢</p>
<p><b>Save a temporary copy, even if the existing file is a symlink</b></p>
<p>(<b>--link_output_mode_linksafe</b>)</p>
<p>â¢</p>
<p><b>Remove the existing executable before writing a new version</b></p>
<p>(<b>--link_output_mode_unlink</b>)</p>
<p><b>Linking Sections with Different Types</b></p>
<p>Allows the linker to combine and link sections from different object files that have</p>
<p>different section types (for example,</p>
<p>SHT_PROGBITS</p>
<p>and</p>
<p>SHT_NOBITS</p>
<p>). Without</p>
<p>this option, the linker will provide an error message and not complete the link. The</p>
<p>equivalent driver option is:</p>
<p>â¢</p>
<p><b>--allow_different_section_types</b></p>
<p>â¢</p>
<p><b>--no_allow_different_section_types</b> â [default]</p>
<p><b>Physical Address Offset From Virtual Address</b></p>
<p>Instructs the linker to make</p>
<p>p_paddr</p>
<p>(the physical address) in the ELF program</p>
<p>headers equal to</p>
<p>p_vaddr</p>
<p>(the virtual address) plus this offset,<i> n</i>. Specifying 0 for</p>
<p>the offset makes</p>
<p>p_paddr</p>
<p>equal to</p>
<p>p_vaddr</p>
<p>. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-paddr_offset=<i>n</b></i></p>
<p><b>Follow Section</b></p>
<p>The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-follow_section<i> x</i>=<i>y</b></i></p>
<p>â¢</p>
<p><b>-follow_section &quot;<i>x</i>=<i>y</i> [<i>start_expression</i>] [<i>attributes</i>] : [{<i> contents</i> }] [&gt;</b></p>
<p><i><b>memname</i> | &gt;.]&quot;</b></p>
<p>Inserts a definition for section<i> y</i> into the section map immediately following the</p>
<p>definition of section<i> x</i>. The<i> start_expression</i>,<i> attributes</i>, and<i> contents</i> of section<i> y</i></p>
<p>may be specified explicitly, using standard linker directives file syntax. If section</p>
<p><i>x</i> has the</p>
<p>ABS</p>
<p>,</p>
<p>CLEAR</p>
<p>, or</p>
<p>NOCLEAR</p>
<p>attributes, section<i> y</i> inherits them. If the section</p>
<p><i>315</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Linker Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>map contains a section<i> z</i> with the attribute</p>
<p>ROM(<i>x</i>)</p>
<p>,</p>
<p>CROM(<i>x</i>)</p>
<p>, or</p>
<p>ROM_NOCOPY(<i>x</i>)</p>
<p>,</p>
<p>then a new definition for the section</p>
<p>.ROM<i>y</i></p>
<p>, .</p>
<p>CROM<i>y</i></p>
<p>, or</p>
<p>.ROM_NOCOPY<i>y</i></p>
<p>is inserted</p>
<p>following<i> z</i> as well.</p>
<p>For more information about these attributes and linker directives file syntax, see</p>
<p>Chapter 9, âThe elxr Linkerâ on page 469.</p>
<p><b>Archiver Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p><b>Output Archives in 64-Bit Format</b></p>
<p>Specifies when the archiver should output archives in 64-bit format, and when to</p>
<p>print related warning messages. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>When Needed (With Warnings)</b> (<b>-auto_large_archive</b>) â [default] The</p>
<p>archiver detects when to output a 64-bit archive and prints a warning when it</p>
<p>does. If the archiver takes a 64-bit archive as input but detects that it does not</p>
<p>need a 64-bit output file, it prints a warning and does not use the 64-bit format.</p>
<p>â¢</p>
<p><b>When Needed (Suppress Warnings)</b> (<b>-quiet_auto_large_archive</b>) â The</p>
<p>archiver detects when to output a 64-bit archive. If the archiver takes a 64-bit</p>
<p>archive as input but detects that it does not need a 64-bit output file, it does not</p>
<p>use the 64-bit format. The archiver does not print any warnings related to 64-bit</p>
<p>archives.</p>
<p>â¢</p>
<p><b>Always</b> (<b>-large_archive</b>) â The archiver always uses 64-bit archives. The</p>
<p>archiver does not print any warnings related to 64-bit archives.</p>
<p>â¢</p>
<p><b>Never</b> (<b>-no_large_archive</b>) â The archiver never uses 64-bit archives. The</p>
<p>archiver does not print any warnings related to 64-bit archives, but it does print</p>
<p>an error if it needs to truncate any values because the archive format does not</p>
<p>provide enough space.</p>
<p><b>Error on Duplicate Symbols in an Archive</b></p>
<p>When creating an archive, controls whether an error is generated if the archive</p>
<p>would have more than one symbol with the same name in its table of contents.</p>
<p>Permitted settings for this option are:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>316</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Generate Error</b> (<b>-reject_duplicates</b>)</p>
<p>â¢</p>
<p><b>Ignore</b> (<b>-no_reject_duplicates</b>) â [default]</p>
<p><b>When Rejecting Duplicate Symbols in An Archive, Certain Symbols</b></p>
<p><b>Generated by the C++ Front End in COMMON Sections Are Ignored</b></p>
<p>When rejecting duplicate symbols in an archive, controls whether those symbols</p>
<p>known to be generated automatically by the compiler in order to support C++</p>
<p>language features are allowed, as opposed to those present in the original source.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Ignore Duplicates</b> (<b>-allow_cxx_duplicates</b>)</p>
<p>â¢</p>
<p><b>Generate Error</b> (<b>-no_allow_cxx_duplicates</b>) â [default]</p>
<p><b>When Rejecting Duplicate Symbols in An Archive, Symbols in</b></p>
<p><b>.ghs.linkonce Sections Are Ignored</b></p>
<p>When rejecting duplicate symbols in an archive, controls whether those symbols</p>
<p>in sections with names beginning with</p>
<p>.ghs.linkonce</p>
<p>are allowed. These symbols</p>
<p>are automatically generated by the compiler to support template instantiation.</p>
<p>Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Ignore Duplicates</b> (<b>-allow_linkonce_duplicates</b>)</p>
<p>â¢</p>
<p><b>Generate Error</b> (<b>-no_allow_linkonce_duplicates</b>) â [default]</p>
<p><b>Compiler Diagnostics Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p><b>Redirect Error Output to Overwriting File</b></p>
<p>Redirects error output to a file, overwriting any existing file, unlike<b> -stderr=</b> which</p>
<p>just appends output to a file. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-stderr_overwrite=<i>filename</b></i></p>
<p><i>317</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Compiler Diagnostics Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Because the overwriting takes effect when compiling each individual source file,</p>
<p><b>-stderr_overwrite</b> is probably only desired in a makefile situation where the</p>
<p>stderr</p>
<p>output filename is named after the input filename. For example:</p>
<p>ccv850 file1.c -stderr_overwrite=file1.err -c</p>
<p>ccv850 file2.c -stderr_overwrite=file2.err -c</p>
<p>as opposed to how you might normally use<b> -stderr</b>:</p>
<p>ccv850 file1.c -stderr=err.out -c</p>
<p>ccv850 file2.c -stderr=err.out -c</p>
<p><b>Symbol Blacklist</b></p>
<p>Specifies the path to a file containing a newline-separated list of symbols. The</p>
<p>compiler, assembler, and linker will produce a diagnostic if the output ELF file</p>
<p>would reference or define a non-static symbol contained in the blacklist. Symbol</p>
<p>names for C++ functions must be mangled. In the case of a build that separately</p>
<p>performs compilation, assembly, or linkage, this option must be passed to each</p>
<p>driver invocation to catch all references and definitions of blacklisted symbols. The</p>
<p>equivalent driver option is:</p>
<p>â¢</p>
<p><b>-symbol_blacklist_file</b>=<i>filename</i></p>
<p><b>Identifier Blacklist</b></p>
<p>Specifies the path to a file containing a newline-separated list of identifiers. The</p>
<p>compiler will produce a diagnostic if the source file contains any identifiers in the</p>
<p>blacklist. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-identifier_blacklist_file</b>=<i>filename</i></p>
<p><b>Support Diagnostics Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p>You should use these options only if instructed to do so by Green Hills support</p>
<p>staff.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>318</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>X-Switches</b></p>
<p>Specifies one or more internal compiler switches. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>-X<i>switch</b></i></p>
<p><b>EDG Front End Options</b></p>
<p>Specifies one or more internal EDG front end options. The equivalent driver option</p>
<p>is:</p>
<p>â¢</p>
<p><b>--option=<i>option</b></i></p>
<p><b>Change Assembler</b></p>
<p>Specifies the assembler to use. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>Use Old Assembler</b> (<b>-old_assembler</b>) â [default]</p>
<p>â¢</p>
<p><b>Use New Assembler</b> (<b>-new_assembler</b>)</p>
<p><b>Debug Information (.dbo) Tracing Diagnostics</b></p>
<p>Controls the collection of diagnostic information pertaining to a search for<b> .dbo</b></p>
<p>files. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>On</b> (<b>-dbo_trace</b>)</p>
<p>This option is useful if you are seeking support for an incident involving missing</p>
<p><b>.dbo</b> files.</p>
<p><b>Dbo File Version</b></p>
<p>Specifies an older version of<b> .dbo</b> debugging information files, for use with an old</p>
<p>MULTI Debugger. The equivalent driver option is:</p>
<p>â¢</p>
<p><b>--dbo_version=<i>n</b></i></p>
<p><i>319</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Support Diagnostics Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>HTML Compiler Options</b></p>
<p>This option category is contained within<b> Advanced</b>.</p>
<p>This options in this section are deprecated and provided for backwards compatibility</p>
<p>only.</p>
<p><b>Alternate Source Name</b></p>
<p>This option is deprecated and provided for backwards compatibility only.</p>
<p>Renames an output file. The equivalent HTML compiler option is:</p>
<p>â¢</p>
<p><b>-o</b></p>
<p><b>HTML File Compression</b></p>
<p>This option is deprecated and provided for backwards compatibility only.</p>
<p>Omits HTML file compression. Permitted settings for this option are:</p>
<p>â¢</p>
<p><b>No HTML Compression</b> (<b>-c</b>)</p>
<p>â¢</p>
<p><b>HTML Compression</b> (<b>-C</b>)</p>
<p><b>Alternate Compression Table</b></p>
<p>This option is deprecated and provided for backwards compatibility only.</p>
<p>Filename of alternate compression table. The equivalent HTML compiler option</p>
<p>is:</p>
<p>â¢</p>
<p><b>-p</b></p>
<p><b>Alternate Header Name</b></p>
<p>This option is deprecated and provided for backwards compatibility only.</p>
<p>Renames the generated include file. The equivalent HTML compiler option is:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>320</i></p>
<p><i>Chapter 3. Builder and Driver Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>-h</b></p>
<p><i>321</i></p>
<p><i>Green Hills Software</i></p>
<p><i>HTML Compiler Options</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 4</b></p>
<p><b>Optimizing Your Programs</b></p>
<p><b>Contents</b></p>
<p>Optimization Strategies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>324</p>
<p>Inlining Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>324</p>
<p>Interprocedural Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>338</p>
<p>Loop Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>347</p>
<p>General Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>352</p>
<p>Default Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>362</p>
<h1 style="page-break-before:always; "></h1>
<p>The Green Hills Compiler and toolchain provide many ways to reduce the size and</p>
<p>increase the speed of your code. This chapter begins by explaining how to enable</p>
<p>optimization strategies and goes on to cover specific optimizations and how they</p>
<p>transform code.</p>
<p><b>Optimization Strategies</b></p>
<p>Begin optimizing your code by selecting an<i> optimization strategy</i>, an option that</p>
<p>groups several optimizations together into one setting. The strategies provided by</p>
<p>Green Hills strike different balances among speed, size, and debugging ability that</p>
<p>cover the needs for many different types of projects and development cycles. To</p>
<p>enable a strategy:</p>
<p>Set the<b> OptimizationâOptimization Strategy</b> option to one of the provided</p>
<p>strategies. For details about each strategy, see âOptimization Strategyâ on page 165.</p>
<p><b>Note</b></p>
<p>Enabling debugging information with the<b> -g</b> or<b> -G</b> options disables some</p>
<p>optimizations in order to make code easier to debug.</p>
<p>The remaining sections in this chapter provide detailed descriptions of the</p>
<p>optimizations available with the Green Hills V850 and RH850 compiler. These</p>
<p>sections are provided for advanced users who are interested in the code</p>
<p>transformations that these optimizations perform, and who want to control individual</p>
<p>optimizations.</p>
<p><b>Inlining Optimizations</b></p>
<p>The term<i> inlining</i> refers to the process of substituting a call to a function or</p>
<p>subroutine with the actual content of that function or subroutine. This eliminates</p>
<p>the overhead of a subroutine call and may result in faster code.</p>
<p>Typically, the best candidate for inlining is a small, frequently executed function</p>
<p>or subroutine that the program calls from only a few locations. Inlining can then</p>
<p>increase efficiency in high usage areas without significantly increasing program</p>
<p>size.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>324</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The Green Hills implementation of inlining is language independent within the</p>
<p>Green Hills family of compilers. Routines of one language may be freely inlined</p>
<p>into programs of another language. Additionally, the Green Hills compilers perform</p>
<p>inlining across modules. Therefore, if a program defines a function within one</p>
<p>module, and several modules use that same function, the compiler can inline the</p>
<p>function within all the appropriate modules.</p>
<p><b>What Can Be Inlined</b></p>
<p>Using the methods described below, you can request that any number of functions</p>
<p>be considered for inlining. But the compiler will not necessarily inline all such</p>
<p>functionsâthe overall size of the function to be inlined, the calling function, and</p>
<p>other factors are always taken into consideration. In addition, if<b> -Omaxdebug</b> or</p>
<p><b>--no_inlining</b> is enabled, the compiler will ignore all inlining requests.</p>
<p><b>Automatic Inlining</b></p>
<p>Automatic inlining is generally controlled by the setting you specify in the</p>
<p><b>OptimizationâOptimization Strategy</b> option (see âGeneral Optimizationsâ</p>
<p>on page 352). It is not enabled by<b> -Onone</b>,<b> -Odebug</b>,<b> -Omoredebug</b>, or</p>
<p><b>-Omaxdebug</b> and is explicitly disabled by<b> --no_inlining</b>.</p>
<p>The compiler may automatically inline the following functions:</p>
<p>â¢</p>
<p>Static functions that a file references only one time.</p>
<p>â¢</p>
<p>Very small functions (for example, single simple assignments).</p>
<p><b>Manual Inlining</b></p>
<p>This section explains how to manually suggest functions for inlining.</p>
<p><b>Manual Inlining In C</b></p>
<p>To manually indicate that the compiler should consider a function for inlining, place</p>
<p>an inline keyword immediately before the declaration of the function. A list of inline</p>
<p>keywords is provided in the table at the end of this section.</p>
<p><i>325</i></p>
<p><i>Green Hills Software</i></p>
<p><i>What Can Be Inlined</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If the compiler decides that a function declared with an inline keyword cannot be</p>
<p>inlined, it must either create an out-of-line copy in the module or externally link to</p>
<p>another module's out-of-line copy. There are three different methods the toolchain</p>
<p>uses to link these functions, depending on how the function was declared. The table</p>
<p>at the end of this section describes the declarations, and the following list describes</p>
<p>the methods:</p>
<p>â¢</p>
<p><i>Exported Inline</i> â The compiler always generates an out-of-line copy of the</p>
<p>function, even if it is not required by the module. If you have two exported</p>
<p>inline functions with the same name, the linker will report that you have multiply</p>
<p>defined symbols.</p>
<p>â¢</p>
<p><i>Imported Inline</i> â The compiler never generates an out-of-line copy of the</p>
<p>function. It always assumes that a copy exists in another module. If you declare</p>
<p>an imported inline function and there is no exported inline definition of the</p>
<p>function in any translation unit, the linker may report that you have an undefined</p>
<p>symbol.</p>
<p>â¢</p>
<p><i>Static Inline</i> â The compiler generates a normal static function only when it</p>
<p>is required by the module (for example, if you take the address of the function</p>
<p>or if the function is recursive). While you will not get linker errors with static</p>
<p>inline functions, there are some important consequences:</p>
<p>â</p>
<p>If you compare two static inline functions in different modules, they will</p>
<p>not equate because they have different addresses.</p>
<p>â</p>
<p>Your code size might increase, because there might be multiple out-of-line</p>
<p>copies of the function.</p>
<p>If you want to manually inline functions, we recommend that you use static inlining</p>
<p>whenever possible. Static inlined functions are portable, do not cause linker errors,</p>
<p>and behave exactly the same as static functions when they cannot be inlined. If you</p>
<p>want to explicitly control the linkage of one of these functions to decrease code</p>
<p>size:</p>
<p>â¢</p>
<p>Make one exported inline definition of the function.</p>
<p>â¢</p>
<p>For all other inline declarations, make imported inline declarations.</p>
<p>â¢</p>
<p>If you do not want to inline the function in a certain translation unit, provide</p>
<p>a non-inline external declaration in the translation unit. For example:</p>
<p>/* do not inline the function in this translation unit */</p>
<p>extern int inline_max(int, int);</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>326</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The following table lists which linking behavior the compiler uses for inline functions</p>
<p>based on your C language dialect and the keyword you use when declaring the</p>
<p>function.</p>
<p><b>Dialect</b></p>
<p><b>Keyword</b></p>
<p><b>C89/C99</b></p>
<p><b>GNU99</b></p>
<p><b>GNU</b></p>
<p>imported</p>
<p>imported</p>
<p>exported</p>
<p>inline</p>
<p>static</p>
<p>imported</p>
<p>exported</p>
<p>__inline</p>
<p>static</p>
<p>imported</p>
<p>exported</p>
<p>__inline__</p>
<p>exported</p>
<p>exported</p>
<p>imported</p>
<p>extern inline</p>
<p>static</p>
<p>exported</p>
<p>imported</p>
<p>extern __inline</p>
<p>static</p>
<p>exported</p>
<p>imported</p>
<p>extern __inline__</p>
<p>static</p>
<p>static</p>
<p>static</p>
<p>static inline</p>
<p><b>Manual Inlining in C++</b></p>
<p>To manually indicate that the compiler should consider a C++ function for inlining,</p>
<p>place the</p>
<p>inline</p>
<p>keyword immediately before the declaration of the function.</p>
<p>Member functions that are defined inside</p>
<p>class</p>
<p>or</p>
<p>struct</p>
<p>type definitions are</p>
<p>also considered inline, even if you do not declare the function with an inline keyword.</p>
<p>Such functions are known as<i> implicitly inline member functions</i>.</p>
<p>In C++, the compiler generates an out-of-line copy of the function only when it is</p>
<p>required by the module (for example, if you take the address of the function or if</p>
<p>the function is recursive). Static data within the function is shared among all copies.</p>
<p>While you will not get linker errors if you internally inline functions, there are some</p>
<p>important consequences:</p>
<p>â¢</p>
<p>If you compare two functions in different modules, they will not compare as</p>
<p>equal, because they have different addresses.</p>
<p>â¢</p>
<p>Your code size might increase, because there might be multiple out-of-line</p>
<p>copies of the function.</p>
<p>If you want force the compiler to use just one out-of-line copy of an inline function</p>
<p>for the whole program, use the<b> --instantiate_extern_inline</b> option and declare that</p>
<p>function with</p>
<p>extern inline</p>
<p>(see âInstantiate Extern Inlineâ on page 222).</p>
<p><i>327</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Manual Inlining</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Single-pass Inlining</b></p>
<p>This optimization is enabled by default and cannot be disabled.</p>
<p>Only those functions indicated by the user in the source code will be considered</p>
<p>for inlining.</p>
<p><b>Example 4.1. Inlining Principles</b></p>
<p>The following program illustrates the basic principles of inlining. The main program</p>
<p>in this case contains a simple loop that calls the function</p>
<p>sub()</p>
<p>. The call itself</p>
<p>occurs only once in the program code, but the function is executed for each iteration</p>
<p>of the loop. The call is easily replaced by the code for</p>
<p>sub()</p>
<p>itself, eliminating</p>
<p>both the need for parameter passing and the overhead of a jump-to-subroutine. The</p>
<p>reduced overhead per execution results in an increase in program speed.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>int main() {</p>
<p>int i;</p>
<p>for (i=1;i&lt;10;i++)</p>
<p>printf(&quot;x=%d\n&quot;,i);</p>
<p>return 0;</p>
<p>}</p>
<p>__inline void sub(int x) {</p>
<p>printf(&quot;x=%d\n&quot;,x);</p>
<p>return;</p>
<p>}</p>
<p>int main() {</p>
<p>int i;</p>
<p>for (i=1;i&lt;10;i++)</p>
<p>sub(i);</p>
<p>return 0;</p>
<p>}</p>
<p><b>Two-Pass Inlining (Intermodule Inlining)</b></p>
<p>Two-pass inlining involves a special precompilation pass over all of the source files</p>
<p>to generate intermediate code for all of the functions to be inlined. This code is</p>
<p>stored in files with the<b> .inf</b> extension. On the second pass, each source file is</p>
<p>compiled normally, but the compiler is given all of the<b> .inf</b> files as additional input.</p>
<p>In this way, the compiler is able to inline functions across source files and across</p>
<p>programming languages.</p>
<p>In two-pass inlining, compiler warnings are suppressed on the first pass so that</p>
<p>duplicate warnings will not be issued.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>328</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If you have different projects that share the same source file and you are using</p>
<p>two-pass inlining, set a different<b> :outputDir</b> option for each of the projects to</p>
<p>prevent linker errors.</p>
<p><b>Selecting All Small Functions for Two-Pass Inlining</b></p>
<p>To control this optimization, use the<b> OptimizationâIntermodule Inlining</b> option</p>
<p>(<b>-OI</b> /<b>-Onoinline</b> ).</p>
<p>This optimization instructs the compiler to consider most small functions as</p>
<p>candidates for inlining. You do not need determine which functions to inline, or</p>
<p>modify the source code.</p>
<p>Any functions that have been manually specified will also be considered for inlining.</p>
<p><b>Selecting a Specific Function for Two-Pass Inlining</b></p>
<p>To specify particular functions for consideration for inlining:</p>
<p>Specify the functions to consider for inlining in the<b> OptimizationâIndividual</b></p>
<p><b>FunctionsâInline Specific Functions</b> option (<b>-OI=<i>fn1</i>[,<i>fn2</i>â¦]</b></p>
<p>).</p>
<p>This optimization allows you to specify a list of functions to be considered for</p>
<p>inlining. This is similar to manual inlining in that the user determines whether or</p>
<p>not each function will be inlined, except that it does not require modification of the</p>
<p>source code. Like<b> -OI</b>,<b> -OI=</b> does two-pass compilation.</p>
<p>Any functions that have been manually specified (see âManual Inliningâ on page 325)</p>
<p>will also be considered for inlining.</p>
<p><b>Tip</b></p>
<p>You can specify both<b> -OI</b> and<b> -OI=fn[,fn2...]</b> on the same command line.</p>
<p><i>329</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Two-Pass Inlining (Intermodule Inlining)</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 4.2. Two-Pass Inlining: Combining the Inlining Option Variants</b></p>
<p>Given the following contents of<b> file_a.c</b> and<b> file_b.c</b>:</p>
<p>file_a.c:</p>
<p>int a_very_big_function()</p>
<p>{</p>
<p>/* lots of code in here, not shown for brevity... */</p>
<p>return 0;</p>
<p>}</p>
<p>int b()</p>
<p>{</p>
<p>return 2;</p>
<p>}</p>
<p>file_b.c:</p>
<p>extern int a_very_big_function(), b();</p>
<p>static inline int c()</p>
<p>{</p>
<p>return 3;</p>
<p>}</p>
<p>int main()</p>
<p>{</p>
<p>return a_very_big_function() + b() + c();</p>
<p>}</p>
<p>there are several ways to use the inlining option variants.</p>
<p>Given the command line:</p>
<p>ccv850 -OI file_a.c file_b.c:</p>
<p>â¢</p>
<p>The function</p>
<p>a_very_big_function()</p>
<p>will not be inlined, even though</p>
<p><b>OptimizationâIntermodule Inlining</b> (<b>-OI</b>) is enabled, because the compiler</p>
<p>deems it to be too large.</p>
<p>â¢</p>
<p>The function</p>
<p>b()</p>
<p>will be inlined because<b> OptimizationâIntermodule Inlining</b></p>
<p>(<b>-OI</b>) is enabled and</p>
<p>b()</p>
<p>is small.</p>
<p>â¢</p>
<p>The function</p>
<p>c()</p>
<p>will be inlined because it was declared with</p>
<p>inline</p>
<p>in the</p>
<p>same module as the caller.</p>
<p>â¢</p>
<p>The functions</p>
<p>a_very_big_function()</p>
<p>and</p>
<p>b()</p>
<p>will be generated out-of-line</p>
<p>in module</p>
<p>a</p>
<p>. The function</p>
<p>c()</p>
<p>will not be generated out-of-line because it is</p>
<p>declared with</p>
<p>inline</p>
<p>and it was successfully inlined everywhere.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>330</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Given the command line:</p>
<p>ccv850 -OI=a_very_big_function file_a.c file_b.c</p>
<p>â¢</p>
<p>The function</p>
<p>a_very_big_function()</p>
<p>will be inlined because it was</p>
<p>specified with<b> OptimizationâIndividual FunctionsâInline Specific</b></p>
<p><b>Functions</b> (<b>-OI=a_very_big_function</b>).</p>
<p>â¢</p>
<p>The function</p>
<p>b()</p>
<p>will not be inlined because<b> OptimizationâIntermodule</b></p>
<p><b>Inlining</b> (<b>-OI</b>) was not enabled.</p>
<p>â¢</p>
<p>The function</p>
<p>c()</p>
<p>will be inlined because it was declared with</p>
<p>inline</p>
<p>in the</p>
<p>same module as the caller.</p>
<p>â¢</p>
<p>The functions</p>
<p>a_very_big_function()</p>
<p>and</p>
<p>b()</p>
<p>will be generated out-of-line</p>
<p>in module</p>
<p>a</p>
<p>. The function</p>
<p>c()</p>
<p>will not be generated out-of-line.</p>
<p>Given the command line:</p>
<p>ccv850 file_a.c file_b.c</p>
<p>â¢</p>
<p>The functions</p>
<p>a_very_big_function()</p>
<p>and</p>
<p>b()</p>
<p>will not be inlined because</p>
<p><b>OptimizationâIntermodule Inlining</b> (<b>-OI</b>) was not enabled.</p>
<p>â¢</p>
<p>The function</p>
<p>c()</p>
<p>will be inlined because it was declared with</p>
<p>inline</p>
<p>in the</p>
<p>same module as the caller.</p>
<p>â¢</p>
<p>The functions</p>
<p>a_very_big_function()</p>
<p>and</p>
<p>b()</p>
<p>will be generated out-of-line</p>
<p>in module</p>
<p>a</p>
<p>.</p>
<p>c()</p>
<p>will not be generated out-of-line.</p>
<p><b>Varying Inlining Thresholds</b></p>
<p>To increase the size threshold beneath which the compiler will consider functions</p>
<p>for inlining:</p>
<p>Set the<b> OptimizationâOptimization ScopeâInline Larger Functions</b> option</p>
<p>to<b> On</b> (<b>-OB</b> ).</p>
<p>The compiler will still not consider very large functions for inlining unless they are</p>
<p>specified using the<b> OptimizationâIndividual FunctionsâInline Specific</b></p>
<p><i>331</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Varying Inlining Thresholds</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Functions</b> option (<b>-OI=<i>fn1</i>[,<i>fn2</i>â¦]</b>). For example, if<b> OptimizationâIntermodule</b></p>
<p><b>Inlining</b> (<b>-OI</b>) is not inlining sufficiently large functions for your needs, pass:</p>
<p>ccv850 -OI -OB</p>
<p>If you need even larger functions to be inlined, then you must specify them</p>
<p>individually using<b> OptimizationâIndividual FunctionsâInline Specific</b></p>
<p><b>Functions</b> option (<b>-OI=<i>fn1</i>[,<i>fn2</i>â¦]</b>). For example, to enable automatic two-pass</p>
<p>inlining with the higher<b> OptimizationâOptimization ScopeâInline Larger</b></p>
<p><b>Functions</b> (<b>âOB</b>) threshold, and to additionally inline the function</p>
<p>a_very_big_function()</p>
<p>, pass:</p>
<p>ccv850 -OI -OB -OI=a_very_big_function</p>
<p><b>Advantages of Inlining</b></p>
<p>Inlining is traditionally considered an optimization that improves program speed at</p>
<p>the cost of increasing program size. However, although inlining creates more code</p>
<p>(because the compiler may generate a single function multiple times within the</p>
<p>program), it may actually decrease the overall program size. When a call is replaced</p>
<p>by inlined code, the compiler can usually avoid saving and restoring several registers</p>
<p>before and after the call. Parameters which normally must be passed on the stack</p>
<p>to a called routine can be accessed directly by the inlined routine in their original</p>
<p>location. Furthermore, because Green Hills compilers perform inlining before most</p>
<p>global optimizations, the process of inlining may significantly enhance the</p>
<p>opportunities for additional optimizations. This can result in very efficient code.</p>
<p>For example, if one or more parameter values are constant, large portions of the</p>
<p>inlined routine may be reduced or eliminated at compile time, and loops which</p>
<p>normally execute a variable number of times may become constant.</p>
<p>Register allocation may improve because inlining eliminates the overhead associated</p>
<p>with a call. On most architectures, any function call within a routine reduces the</p>
<p>number of registers available for local variables and temporaries. If all function</p>
<p>calls can be eliminated by inlining, the number of registers available for variables</p>
<p>and temporaries increases.</p>
<p>Pessimistic assumptions made by the compiler when compiling the caller may not</p>
<p>be necessary if no call is made. Normally the compiler must assume that when a</p>
<p>call is performed, global variables may be changed. This prevents the compiler from</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>332</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>optimizing the values of expressions containing global variables across a call to a</p>
<p>function. When the function is inlined, the call is eliminated and the global variables</p>
<p>can be optimized more freely.</p>
<p><b>Note</b></p>
<p>Source line number information related to inlined routines is deleted.</p>
<p>When a program is executed under the control of a source debugger, no</p>
<p>source code is available for the inlined routine. Single stepping by source</p>
<p>line will cause the entire inlined call to be executed as a single statement.</p>
<p>You can, however, debug the inlined call by stepping through the</p>
<p>sequence of inlined machine instructions at the point of the source-level</p>
<p>call.</p>
<p><b>Inlining of C Memory Functions</b></p>
<p>By default, all optimization strategies except<b> -Onone</b>,<b> -Odebug</b>,<b> -Omoredebug</b>,</p>
<p><b>-Omaxdebug</b>, and<b> -Osize</b> enable the inlining of calls to C memory functions</p>
<p>(</p>
<p>memmove()</p>
<p>,</p>
<p>memchr()</p>
<p>, and</p>
<p>memcmp()</p>
<p>) if<b> string.h</b> is included. This option has</p>
<p>no effect unless an optimization strategy other than the ones mentioned above is</p>
<p>enabled. To explicitly enable or disable this optimization:</p>
<p>Set the<b> AdvancedâOptimization OptionsâInline C Memory Functions</b> option</p>
<p>to<b> On</b> or<b> Off</b> (<b>-Omemfuncs</b> or<b> -Onomemfuncs</b></p>
<p>).</p>
<p>This option may produce multiple copies of memory functions; do not use it if those</p>
<p>functions require unique addresses. This option's behavior is not strictly</p>
<p>standards-compliant.</p>
<p><b>Inlining of C String Functions</b></p>
<p>Depending on optimization strategy, the compiler may inline some string functions,</p>
<p>including</p>
<p>strlen()</p>
<p>,</p>
<p>strcpy()</p>
<p>, and</p>
<p>strcmp()</p>
<p>. The option<b> -Ostrfuncs</b> explicitly</p>
<p>allows the compiler to inline additional string functions, including</p>
<p>strchr()</p>
<p>,</p>
<p>strrchr()</p>
<p>,</p>
<p>strncmp()</p>
<p>,</p>
<p>strncpy()</p>
<p>,</p>
<p>strcat()</p>
<p>,</p>
<p>strncat()</p>
<p>, and</p>
<p>strstr()</p>
<p>.</p>
<p>The option<b> -Onostrfuncs</b> prevents the compiler from inlining any string functions.</p>
<p><i>333</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Inlining of C Memory Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>Most inlining of string functions requires the inclusion of<b> string.h</b>.</p>
<p><b>-Ostrfuncs</b> may produce multiple copies of string functions; do not use</p>
<p>the option if these functions require unique addresses. Additionally, this</p>
<p>option is not strictly standards-compliant. Optimization strategies</p>
<p><b>-Omaxdebug</b>,<b> -Omoredebug</b>,<b> -Odebug</b>, and<b> -Onone</b> will cause</p>
<p><b>-Ostrfuncs</b> to have no effect.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>334</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Additional C++ Inlining Information</b></p>
<p>Although the C++ standard dictates that all member functions defined inside class</p>
<p>definitions are implicitly declared inline, the compiler does not consider all such</p>
<p>functions for inlining. The reason is that small amounts of code in C++ can expand</p>
<p>into dozens of lines in assembly code. If the compiler were to inline every function</p>
<p>that is implicitly declared inline, it might create unacceptably bloated code (especially</p>
<p>when size is more important than speed). As a consequence, the compiler inlines</p>
<p>by default functions composed entirely of straightline code.</p>
<p>If the default C++ inlining behavior does not inline enough functions (the program</p>
<p>is too slow) or inlines too many functions (the program is too big), you can override</p>
<p>the default behavior with the options documented in âC++ Inlining Levelâ</p>
<p>on page 308.</p>
<p>You can use these options to control C++ inlining for all modules that make up an</p>
<p>executable, or module-by-module. You can also combine them. For example, you</p>
<p>could enable maximum inlining for modules that contain only small functions and</p>
<p>disable all inlining for modules that contain large functions.</p>
<p>To exclude certain functions from inlining within a C++ file, even if they are member</p>
<p>functions defined inside a class, place the</p>
<p>#pragma ghs startnoinline</p>
<p>directive</p>
<p>before such functions and the</p>
<p>#pragma ghs endnoinline</p>
<p>directive after such</p>
<p>functions. Because the</p>
<p>__noinline</p>
<p>keyword can also be used to suppress the</p>
<p>inlining of functions, it can be used equivalently to the</p>
<p>#pragma ghs</p>
<p>startnoinline</p>
<p>and</p>
<p>#pragma ghs endnoinline</p>
<p>directives.</p>
<p>However, the</p>
<p>__noinline</p>
<p>keyword takes on an enhanced meaning when applied</p>
<p>to template member functions or member functions of template classes. In these</p>
<p>cases, the</p>
<p>__noinline</p>
<p>keyword controls whether the function is considered to</p>
<p>have been declared inline. That is, it can override the standard behavior that member</p>
<p>functions defined inside of the class body are otherwise implicitly inline. This means</p>
<p>member function templates defined with</p>
<p>__noinline</p>
<p>will be treated as if they</p>
<p>were defined outside of the class body.</p>
<p>Note that this behavior of</p>
<p>__noinline</p>
<p>is distinct from the non-template case. For</p>
<p>templates,</p>
<p>__noinline</p>
<p>changes whether the function was considered to have been</p>
<p>declared inline. For non-templates,</p>
<p>__noinline</p>
<p>prevents the compiler from inlining</p>
<p>calls to the function but does not change whether the function is considered to have</p>
<p>been declared inline. (That is, non-template member functions defined in the class</p>
<p><i>335</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Additional C++ Inlining Information</i></p>
<h1 style="page-break-before:always; "></h1>
<p>body will still be considered inline because being inline has an effect on their</p>
<p>linkage.)</p>
<p>To exclude template member functions or member functions of template classes,</p>
<p>use the</p>
<p>__noinline</p>
<p>keyword by adding it to the source code in the same place</p>
<p>where you would normally use the</p>
<p>inline</p>
<p>keyword. The</p>
<p>__noinline</p>
<p>keyword</p>
<p>treats an inline member function as though it were defined outside of the class body.</p>
<p>This has the effect of generating a single, global, out-of-line copy for that template</p>
<p>instantiation. This is preferable to disabling all inlining, because it does not generate</p>
<p>duplicate copies in different modules.</p>
<p>To control whether</p>
<p>__noinline</p>
<p>has this alternate effect on template functions or</p>
<p>whether it has no effect on template functions:</p>
<p>Set the<b> C/C++ CompilerâC++âKeyword SupportâSupport __noinline</b></p>
<p><b>Keyword for Templates</b> option to<b> On</b> (<b>--enable_noinline</b>).</p>
<p><b>Note</b></p>
<p>If<b> --no_instantiate_extern_inline</b> is enabled, then<b> --enable_noinline</b> is</p>
<p>automatically enabled when you set the<b> OptimizationâOptimization</b></p>
<p><b>Strategy</b> option to<b> Optimize for Size</b>.</p>
<p>Consequently, you can compile the same source code differently without having to</p>
<p>remove the</p>
<p>__noinline</p>
<p>keyword. To disable the effect of the</p>
<p>__noinline</p>
<p>keyword, set the<b> C/C++ CompilerâC++âKeyword SupportâSupport</b></p>
<p><b>__noinline Keyword for Templates</b> option to<b> Off</b> (<b>--disable_noinline</b>).</p>
<p>The Green Hills C++ library header files make use of the</p>
<p>__noinline</p>
<p>keyword</p>
<p>on some member functions which are known to cause large code bloats.</p>
<p><b>Inlining Constant Math Functions</b></p>
<p>This optimization is performed by default under optimization strategies<b> -Ogeneral</b>,</p>
<p><b>-Osize</b>, and<b> -Ospeed</b>. It is not performed if another optimization strategy is selected.</p>
<p>To explicitly enable or disable this optimization:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>336</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Set the<b> AdvancedâOptimization OptionsâInline Constant Math Functions</b></p>
<p>option to<b> On</b> or<b> Off</b> (<b>-Oinline_constant_math</b> or<b> -Ono_inline_constant_math</b>).</p>
<p>At compile time, this optimization evaluates certain calls to math library functions</p>
<p>that have compile-time constant arguments.</p>
<p>sqrt()</p>
<p>and</p>
<p>sqrtf()</p>
<p>are evaluated</p>
<p>for all finite, non-negative values, and</p>
<p>exp2()</p>
<p>and</p>
<p>exp2f()</p>
<p>are evaluated for all</p>
<p>integer values that do not cause underflow or overflow. In addition, various special</p>
<p>cases for the following functions are recognized for both the single- and</p>
<p>double-precision versions:</p>
<p>exp()</p>
<p>,</p>
<p>exp2()</p>
<p>,</p>
<p>log()</p>
<p>,</p>
<p>log2()</p>
<p>,</p>
<p>log10()</p>
<p>,</p>
<p>sin()</p>
<p>,</p>
<p>asin()</p>
<p>,</p>
<p>cos()</p>
<p>,</p>
<p>acos()</p>
<p>,</p>
<p>tan()</p>
<p>,</p>
<p>atan()</p>
<p>.</p>
<p><i>337</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Inlining Constant Math Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Interprocedural Optimizations</b></p>
<p>Interprocedural optimizations allow optimizations based on knowledge of functions</p>
<p>being called, such as interprocedural alias analysis.<b> -Ointerproc</b> does not require</p>
<p>that the entire program is available during compilation (see âWholeprogram</p>
<p>Optimizationsâ on page 341). Because interprocedural optimizations require analysis</p>
<p>of many files at the same time, your host machine may run out of memory if your</p>
<p>project is large.</p>
<p>To enable interprocedural optimizations:</p>
<p>Set the<b> OptimizationâInterprocedural Optimizations</b> option to<b> Interprocedural</b></p>
<p>(<b>-Ointerproc</b> ).</p>
<p>Interprocedural options are incompatible with the option</p>
<p><b>--one_instantiation_per_object</b>, as well as export templates (enabled with<b> --export</b>).</p>
<p>Furthermore, interprocedural optimizations are not compatible with the prelinker,</p>
<p>and thus require the use of link-once template instantiation.</p>
<p><b>Related Topics:</b></p>
<p>â¢</p>
<p>Example 1.5. Using Interprocedural Optimizations With Makefiles on page 19.</p>
<p>â¢</p>
<p>âLink-Once Template Instantiationâ on page 749.</p>
<p>â¢</p>
<p>âExported Templatesâ on page 753.</p>
<p>This class of optimizations analyzes interaction between functions, and includes:</p>
<p>â¢</p>
<p><b>Alias analysis</b> â Determines what memory can be read and written by function</p>
<p>calls. Without this optimization, the compiler assumes that most global memory</p>
<p>can be read and written by function calls.</p>
<p>To disable read-based interprocedural alias analysis:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP Alias Reads</b> option to<b> Off</b></p>
<p>(<b>-Onoipaliasreads</b> ).</p>
<p>To disable write-based interprocedural alias analysis:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>338</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Set the<b> OptimizationâOptimization ScopeâIP Alias Writes</b> option to</p>
<p><b>Off</b> (<b>-Onoipaliaswrites</b> ).</p>
<p>To disable interprocedural alias analysis of some standard C functions:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP Alias Lib Functions</b> option</p>
<p>to<b> Off</b> (<b>-Onoipaliaslibfuncs</b> ).</p>
<p>â¢</p>
<p><b>Propagation of constant returns from function calls</b> â When functions</p>
<p>return constant values, those values can be propagated to the caller.</p>
<p>To disable propagation of constant returns from function calls:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP Constant Returns</b> option</p>
<p>to<b> Off</b> (<b>-Onoipconstantreturns</b> ).</p>
<p>See Example 4.4. Constant Returns on page 340 for a demonstration on how</p>
<p>this option works.</p>
<p>â¢</p>
<p><b>Inlining small functions</b> â Small functions can be inlined across modules.</p>
<p>To disable this inlining of small functions:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP Small Inlining</b> option to</p>
<p><b>Off</b> (<b>-Onoipsmallinlining</b> ).</p>
<p>The following example displays a program before and after interprocedural alias</p>
<p>analysis is applied.</p>
<p><b>Example 4.3. Interprocedural Alias Analysis</b></p>
<p><b>Initial C Source Code:</b></p>
<p><i>339</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Interprocedural Optimizations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>int X = 0;</p>
<p>int Y;</p>
<p>void may_write_X()</p>
<p>{</p>
<p>Y = 10; // Does not write X</p>
<p>}</p>
<p>void use_global()</p>
<p>{</p>
<p>X = 1;</p>
<p>may_write_X();</p>
<p>if (X != 1)</p>
<p>do_large_computation();</p>
<p>}</p>
<p><b>Optimized C Source Code:</b></p>
<p>int X = 0;</p>
<p>int Y;</p>
<p>void may_write_X()</p>
<p>{</p>
<p>Y = 10; // Does not write X</p>
<p>}</p>
<p>void use_global()</p>
<p>{</p>
<p>X = 1;</p>
<p>may_write_X();</p>
<p>}</p>
<p><b>Example 4.4. Constant Returns</b></p>
<p><b>Initial C Source Code</b></p>
<p>int x = 0;</p>
<p>int foo()</p>
<p>{</p>
<p>x++;</p>
<p>return 0;</p>
<p>}</p>
<p>void bar()</p>
<p>{</p>
<p>if (foo())</p>
<p>x *= 100;</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>340</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Optimized C Source Code</b></p>
<p>int x = 0;</p>
<p>int foo()</p>
<p>{</p>
<p>x++;</p>
<p>return 0;</p>
<p>}</p>
<p>void bar()</p>
<p>{</p>
<p>foo();</p>
<p>}</p>
<p><b>Wholeprogram Optimizations</b></p>
<p>Wholeprogram optimizations analyze program control and data flow at a high level,</p>
<p>then optimize your code using several techniques, including:</p>
<p>â¢</p>
<p>Single call-site inlining</p>
<p>â¢</p>
<p>Interprocedural constant propagation</p>
<p>â¢</p>
<p>Interprocedural dead code elimination</p>
<p>â¢</p>
<p>Interprocedural alias analysis</p>
<p>Wholeprogram optimizations can improve program speed and size, often</p>
<p>simultaneously.</p>
<p>To enable wholeprogram optimizations:</p>
<p>Set the<b> OptimizationâInterprocedural Optimizations</b> option to<b> Wholeprogram</b></p>
<p>(<b>-Owholeprogram</b> ).</p>
<p>All function call-sites must be made available to the compiler during each</p>
<p>compilation. Therefore, if there are functions or variables in the source code that</p>
<p>are referenced from files that are being compiled separately or from assembly files</p>
<p>and assembly code, you must use the<b> -external</b> option to list those functions to keep</p>
<p>invalid optimizations from being applied. For more information, see âSymbols</p>
<p>Referenced Externallyâ on page 170. A weaker set of intermodule optimizations can</p>
<p><i>341</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Wholeprogram Optimizations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>be enabled by using<b> -Ointerproc</b> (those optimizations are included with</p>
<p><b>-Owholeprogram</b>). See âInterprocedural Optimizationsâ on page 338 for additional</p>
<p>information.</p>
<p><b>Note</b></p>
<p>All symbols used in assembly files, inline assembly, and separate</p>
<p>compilation units must be marked as externally visible to ensure that</p>
<p>Wholeprogram optimizations are not incorrectly applied.</p>
<p>You can use<b> âexternal</b>,<b> âexternal_file</b>,</p>
<p>#pragma ghs</p>
<p>start_externally_visible</p>
<p>, or the GNU attribute</p>
<p>externally_visible</p>
<p>to specify which symbols are externally visible.</p>
<p>Symbols referenced in object files or libraries included during compilation</p>
<p>are not required to be listed.</p>
<p>The wholeprogram optimization includes all interprocedural optimizations, as well</p>
<p>as:</p>
<p>â¢</p>
<p><b>Inlining functions that only have one call-site and are otherwise</b></p>
<p><b>unreferenced</b> â If there is only one call to a function, the function call is</p>
<p>inlined.</p>
<p>To disable one-site inlining:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP One-Site Inlining</b> option</p>
<p>to<b> Off</b> (<b>-Onoiponesiteinlining</b> ).</p>
<p>This option can be enabled with interprocedural optimizations, although it is</p>
<p>not enabled by default. Set the<b> OptimizationâOptimization ScopeâIP</b></p>
<p><b>One-Site Inlining</b> option to<b> On</b> (<b>-Oiponesiteinlining</b> ). This option is only</p>
<p>effective with<b> -Ointerproc</b> if most call-sites are visible and you have link-time</p>
<p>function deletion enabled (<b>-delete</b>).</p>
<p>â¢</p>
<p><b>Constant propagation on function parameters</b> â Conventional constant</p>
<p>propagation is performed on the arguments of function calls.</p>
<p>To disable constant propagation on function parameters:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP Constant Propagation</b></p>
<p>option to<b> Off</b> (<b>-Onoipconstprop</b> ).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>342</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>Deletion of unneeded and constant function returns</b> â When the result of</p>
<p>a function call is not required, the return statement is removed.</p>
<p>To disable deletion of unneeded and constant function returns:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP Remove Returns</b> option</p>
<p>to<b> Off</b> (<b>-Onoipremovereturns</b> ).</p>
<p>â¢</p>
<p><b>Deletion of unneeded and constant parameters</b> â When certain parameters</p>
<p>are not required, the parameters are removed, and function calls do not pass</p>
<p>arguments for them.</p>
<p>To disable deletion of unneeded and constant parameters:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP Remove Parameters</b></p>
<p>option to<b> Off</b> (<b>-Onoipremoveparams</b> ).</p>
<p>â¢</p>
<p><b>Propagation of constant-value global variables</b> â When a global variable</p>
<p>is initialized to a constant value and never changed, and the variable is not</p>
<p>indirectly referenced, the initial value is propagated into the uses of the variable.</p>
<p>A limited form of this optimization is also applied to static variables when</p>
<p>interprocedural optimizations are enabled.</p>
<p>To disable the propagation of constant-value global variables:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP Constant Globals</b> option</p>
<p>to<b> Off</b> (<b>-Onoipconstglobals</b> ).</p>
<p>â¢</p>
<p><b>Deletion of unreachable functions</b> â Code is not produced for functions that</p>
<p>are unreachable. A limited form of this optimization is also applied to static</p>
<p>functions when interprocedural optimizations are enabled. Functions that have</p>
<p>all uses inlined may still be removed.</p>
<p>To disable the<b> -Owholeprogram</b> deletion of unreachable functions:</p>
<p><i>343</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Wholeprogram Optimizations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Set the<b> OptimizationâOptimization ScopeâIP Delete Functions</b> option</p>
<p>to<b> Off</b> (<b>-Onoipdeletefunctions</b> ).</p>
<p>â¢</p>
<p><b>Deletion of constant-value global variables</b> â Symbols are not produced for</p>
<p>global variables that have their constant values propagated to all of their uses.</p>
<p>A limited form of this optimization is also applied to static variables when</p>
<p>interprocedural optimizations are enabled.</p>
<p>To disable the deletion of constant-value global variables:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP Delete Globals</b> option to</p>
<p><b>Off</b> (<b>-Onoipdeleteglobals</b> ).</p>
<p>â¢</p>
<p><b>Localization of global variables</b> â Global variables whose uses are isolated</p>
<p>to a single function (after inlining) may be represented with local variables</p>
<p>allocated to registers, rather than being loaded and stored in memory. A limited</p>
<p>form of this optimization is also applied to static variables when interprocedural</p>
<p>optimizations are enabled.</p>
<p>To disable the localization of global variables:</p>
<p>Set the<b> OptimizationâOptimization ScopeâIP Localize Globals</b> option</p>
<p>to<b> Off</b> (<b>-Onoiplocalizeglobals</b> ).</p>
<p>â¢</p>
<p>To disable all interprocedural and wholeprogram optimizations:</p>
<p>Set the<b> OptimizationâInterprocedural Optimizations</b> option to<b> Off</b></p>
<p>(<b>-Onoipa</b> ).</p>
<p>The following example displays a program before and after the interprocedural</p>
<p>constant propagation is applied.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>344</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 4.5. Interprocedural Constant Propagation</b></p>
<p><b>Initial C Source Code</b></p>
<p>int can_be_simple(int x, int y)</p>
<p>{</p>
<p>if (x != 0 || y &gt; 2)</p>
<p>do_large_computation();</p>
<p>return x+y;</p>
<p>}</p>
<p>int is_simple()</p>
<p>{</p>
<p>return can_be_simple(0, 1) + can_be_simple(0, 2);</p>
<p>}</p>
<p><b>Optimized C Source Code</b></p>
<p>int can_be_simple(int y)</p>
<p>{</p>
<p>return y;</p>
<p>}</p>
<p>int is_simple()</p>
<p>{</p>
<p>return can_be_simple(1) + can_be_simple(2);</p>
<p>}</p>
<p><b>Using gbuild with Interprocedural Optimizations</b></p>
<p>When using Wholeprogram optimizations, you must make all parts of your program</p>
<p>available to the compiler for analysis, or the compiler might apply those</p>
<p>optimizations incorrectly.</p>
<p>To configure the compiler to perform Wholeprogram analysis on all parts of your</p>
<p>program, but prevent the compiler from performing Wholeprogram optimizations</p>
<p>on certain parts of that program:</p>
<p>â¢</p>
<p>Set<b> OptimizationâInterprocedural Optimizations</b> to<b> Wholeprogram</b></p>
<p>(<b>-Owholeprogram</b>) for your program.</p>
<p>â¢</p>
<p>Set<b> OptimizationâInterprocedural Optimizations</b> to<b> Analysis Without</b></p>
<p><b>Optimizations</b> (<b>-Oip_analysis_only</b>) for the parts of the program that you</p>
<p>want to exclude from Wholeprogram optimizations.</p>
<p><i>345</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Using gbuild with Interprocedural Optimizations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>When you set<b> OptimizationâInterprocedural Optimizations</b> to<b> Interprocedural</b></p>
<p>(<b>-Ointerproc</b>),<b> -Oip_analysis_only</b> is not necessary because the compiler does not</p>
<p>need to analyze the entire program to perform optimizations on each part. If you</p>
<p>want the compiler to optimize some parts of a program with<b> -Ointerproc</b>, but not</p>
<p>others:</p>
<p>â¢</p>
<p>Set<b> -Ointerproc</b> for your program.</p>
<p>â¢</p>
<p>Set<b> OptimizationâInterprocedural Optimizations</b> to<b> Off</b> (<b>-Onoipa</b>) for</p>
<p>each part of the program on which you do not want to have interprocedural</p>
<p>optimizations applied.</p>
<p><b>Note</b></p>
<p>When the compiler compiles files together, those files cannot use different</p>
<p>levels of interprocedural optimization. For example, you cannot enable</p>
<p><b>-Owholeprogram</b> on some files and<b> -Ointerproc</b> on others. However,</p>
<p>you can do so with<b> -Owholeprogram</b>,<b> -Oip_analysis_only</b>, and<b> -Onoipa</b>,</p>
<p>or<b> -Ointerproc</b> and<b> -Onoipa</b> as in the preceding paragraphs.</p>
<p>If a program contains libraries, there are two interprocedural optimization modes</p>
<p>that<b> gbuild</b> can run in when compiling those libraries:</p>
<p>â¢</p>
<p>When you set<b> -Ointerproc</b> for a program, the compiler compiles that program's</p>
<p>libraries separately from the rest of the program.</p>
<p>â¢</p>
<p>When you set<b> -Owholeprogram</b> for a program, the compiler compiles that</p>
<p>program's libraries separately from the rest of the program.<b> gbuild</b> also sets</p>
<p><b>-Oip_analysis_only</b> for each of those libraries. As a result, the compiler</p>
<p>considers information in those libraries when performing Wholeprogram</p>
<p>optimizations on the rest of the program, without performing those optimizations</p>
<p>on the libraries themselves.</p>
<p><b>-Owholeprogram</b> is intended for programs only. If you enable it for both a program</p>
<p>and an included library, the compiler analyzes and optimizes that library on its own,</p>
<p>without regard to the program it is included in.</p>
<p>If you have different projects that share the same source file and you are using</p>
<p>interprocedural optimizations, set a different<b> :outputDir</b> option for each of the</p>
<p>projects to prevent linker errors.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>346</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Loop Optimizations</b></p>
<p>The compiler uses most of its resources to optimize code in the innermost loops in</p>
<p>your source files. Therefore, this optimization is most effective for code containing</p>
<p>many loop structures that are executed frequently.</p>
<p>This optimization includes:</p>
<p>â¢</p>
<p>strength reduction</p>
<p>â¢</p>
<p>loop invariant analysis</p>
<p>â¢</p>
<p>loop unrolling</p>
<p><b>Automatic Loop Optimization</b></p>
<p>This optimization is generally controlled by the setting you specify in the</p>
<p><b>OptimizationâOptimization Strategy</b> option (see âGeneral Optimizationsâ</p>
<p>on page 352). To control it individually:</p>
<p>Use the<b> AdvancedâOptimization OptionsâOptimize All Appropriate Loops</b></p>
<p>option (<b>-OL</b> /<b>-Onoloop</b> ).</p>
<p>Enabling automatic loop optimization enables loop unrolling. If code size is a priority</p>
<p>but loop optimization is still desired, you can force off loop unrolling by setting</p>
<p><b>AdvancedâOptimization OptionsâLoop Unrolling</b> to<b> Off</b> (<b>-Onounroll</b> ).</p>
<p><b>Loop Optimizing Specific Functions</b></p>
<p>To specify particular functions for consideration for loop optimizations:</p>
<p>Specify the functions in the<b> OptimizationâIndividual FunctionsâLoop</b></p>
<p><b>Optimize Specific Functions</b> option (<b>-OL=<i>fn1</i>[,<i>fn2</i>â¦]</b></p>
<p>).</p>
<p><b>-OL=<i>fn1</i>[,<i>fn2</i>â¦]</b> has higher precedence than<b> -Onoloop</b>. If<b> -OL=<i>fn1</i>[,<i>fn2</i>â¦]</b> is</p>
<p>specified, loops in functions<i> fn1</i> and<i> fn2</i> will be optimized even if<b> -Onoloop</b> is</p>
<p>specified. If<b> -Oloop</b> is specified, loops in all functions will be optimized and</p>
<p><b>-OL=<i>fn1</i>[,<i>fn2</i>â¦]</b> is redundant.</p>
<p><i>347</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Loop Optimizations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For example, the following command line specifies that loop optimizations will be</p>
<p>applied to</p>
<p>sub</p>
<p>and</p>
<p>sub2</p>
<p>:</p>
<p>ccv850 -OL=sub,sub2 main.c prog1.c prog2.c</p>
<p><b>Strength Reduction</b></p>
<p>This optimization is included in loop optimization, which is enabled by either</p>
<p><b>AdvancedâOptimization OptionsâOptimize All Appropriate Loops</b> or</p>
<p><b>OptimizationâIndividual FunctionsâLoop Optimize Specific Functions</b>.</p>
<p>This optimization is applied to arrays subscripted with the loop index. Most</p>
<p>compilers access the array element by multiplying the size of the element by the</p>
<p>loop index. The Green Hills compilers store the address of the array in a register</p>
<p>and add the size of the array element to the register on each iteration of the loop.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>subr()</p>
<p>{</p>
<p>int i;</p>
<p>int q[4];</p>
<p>int *_ptr;</p>
<p>for (i=0, _ptr=q; i&lt;4; i++)</p>
<p>*_ptr++ = i;</p>
<p>}</p>
<p>subr()</p>
<p>{</p>
<p>int i;</p>
<p>int q[4];</p>
<p>for (i=0;i&lt;4;i++)</p>
<p>q[i]=i;</p>
<p>}</p>
<p>Strength reduction also applies to multiplying a loop invariant with the loop index.</p>
<p>The optimizer replaces a multiply operation with add operations.</p>
<p><b>Loop Invariant Analysis</b></p>
<p>This optimization is included in loop optimization, which is enabled by either</p>
<p><b>AdvancedâOptimization OptionsâOptimize All Appropriate Loops</b> or</p>
<p><b>OptimizationâIndividual FunctionsâLoop Optimize Specific Functions</b>.</p>
<p>This optimization examines loops for expressions or address calculations that do</p>
<p>not change within the loop. Where such computations are identified, they are</p>
<p>relocated to outside the loop and their values are stored in registers.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>348</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>This optimization is especially useful for reducing code generated to access an array</p>
<p>element when the array index does not change within the loop.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>subr()</p>
<p>{</p>
<p>int i,j;</p>
<p>int q[4],p[4];</p>
<p>int tmp;</p>
<p>for (i=3; i&gt;=0; i--) {</p>
<p>q[i] = i;</p>
<p>for (j=0, tmp = q[i]; j&lt;4; j++)</p>
<p>p[j] = tmp;</p>
<p>}</p>
<p>}</p>
<p>subr()</p>
<p>{</p>
<p>int i,j;</p>
<p>int q[4],p[4];</p>
<p>for (i=3;i&gt;=0;i--) {</p>
<p>q[i]=i;</p>
<p>for (j=0;j&lt;4;j++)</p>
<p>p[j]=q[i];</p>
<p>}</p>
<p>}</p>
<p><i>349</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Loop Invariant Analysis</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Loop Unrolling</b></p>
<p>This optimization is included in loop optimization, which is enabled by either</p>
<p><b>AdvancedâOptimization OptionsâOptimize All Appropriate Loops</b> or</p>
<p><b>OptimizationâIndividual FunctionsâLoop Optimize Specific Functions</b>.</p>
<p>This optimization duplicates the code in innermost loops to produce more straightline</p>
<p>code. This removes much of the loop overhead required for testing for stop condition</p>
<p>and branching, and allows for more instruction pipelining and better use of the</p>
<p>register allocator. It is most effective when the innermost loop is relatively short,</p>
<p>causing minimal increase in code size.</p>
<p>The following example uses a loop with a constant iteration count of 100 and an</p>
<p>unrolling factor of 4.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>subr(a)</p>
<p>int a[];</p>
<p>{</p>
<p>int i;</p>
<p>for (i=0;i&lt;100;i+=4) {</p>
<p>a[i]=i;</p>
<p>a[i+1]=i+1;</p>
<p>a[i+2]=i+2;</p>
<p>a[i+3]=i+3;</p>
<p>}</p>
<p>}</p>
<p>subr(a)</p>
<p>int a[];</p>
<p>{</p>
<p>int i;</p>
<p>for (i=0;i&lt;100;i++)</p>
<p>a[i]=i;</p>
<p>}</p>
<p>The initial code has:</p>
<p>â¢</p>
<p>1 comparison</p>
<p>â¢</p>
<p>1 memory store</p>
<p>â¢</p>
<p>1 increment</p>
<p>â¢</p>
<p>1 branch</p>
<p>for a total of 4 instructions per iteration. Assuming each instruction takes exactly</p>
<p>one cycle to complete, and assuming time outside of the loop is negligible, this code</p>
<p>takes 100 * 4 = 400 cycles to complete.</p>
<p>The optimized code has:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>350</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>1 comparison</p>
<p>â¢</p>
<p>3 additions</p>
<p>â¢</p>
<p>4 memory stores</p>
<p>â¢</p>
<p>1 increment</p>
<p>â¢</p>
<p>1 branch</p>
<p>for a total of 10 instructions per iteration. Using the same assumptions, this code</p>
<p>takes 100 / 4 * 10 = 250 cycles to complete, for a 37.5% improvement.</p>
<p>To increase the maximum size of loops that may be unrolled:</p>
<p>Set the<b> OptimizationâOptimization ScopeâUnroll Larger Loops</b> option to</p>
<p><b>On</b> (<b>-Ounrollbig</b> ).</p>
<p>To disable loop unrolling (recommended when code size is a priority):</p>
<p>Set the<b> AdvancedâOptimization OptionsâLoop Unrolling</b> option to<b> Off</b></p>
<p>(<b>-Onounroll</b></p>
<p>).</p>
<p><i>351</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Loop Unrolling</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>General Optimizations</b></p>
<p>To enable the optimizations in this section:</p>
<p>Set the<b> OptimizationâOptimization Strategy</b> option to one of the following</p>
<p>settings:</p>
<p>â¢</p>
<p><b>Maximum Debugging and Limited Optimizations</b> (<b>-Omoredebug</b>)</p>
<p>â¢</p>
<p><b>Optimize for Debuggability</b> (<b>-Odebug</b>)</p>
<p>â¢</p>
<p><b>Optimize for Size</b> (<b>-Osize</b> ).</p>
<p>â¢</p>
<p><b>Optimize for General Use</b> (<b>-Ogeneral</b></p>
<p>).</p>
<p>â¢</p>
<p><b>Optimize for Speed</b> (<b>-Ospeed</b> ).</p>
<p>The following options have no effect without an optimization strategy selected.</p>
<p>They are all enabled when a strategy is selected, except when noted otherwise.</p>
<p><b>Peephole Optimization</b></p>
<p>This optimization is generally controlled by the setting you specify in the</p>
<p><b>OptimizationâOptimization Strategy</b> option (see âGeneral Optimizationsâ</p>
<p>on page 352). To disable it individually:</p>
<p>Use the<b> AdvancedâOptimization OptionsâPeephole Optimization</b> option</p>
<p>(<b>-Opeep</b> /<b>-Onopeephole</b> ).</p>
<p>You may find it helpful to select the<b> Restrict peephole optimization scope to</b></p>
<p><b>increase debuggability</b> setting of the<b> OptimizationâOptimization</b></p>
<p><b>ScopeâPipeline and Peephole Scope</b> option (<b>-Olimit=peephole</b> ).</p>
<p>This optimization identifies common code patterns and replaces them with more</p>
<p>efficient code. This includes optimizations such as flow of control, algebraic</p>
<p>simplifications, and removal of unreachable code. The compiler only performs this</p>
<p>optimization when local code analysis ensures that the results will be correct without</p>
<p>further analysis of the surrounding code.</p>
<p><b>Optimized pseudo code</b></p>
<p><b>Initial pseudo code</b></p>
<p>mac r4 &lt;- r2, r3</p>
<p>mul r1 &lt;- r2, r3</p>
<p>add r4 &lt;- r1, r4</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>352</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Pipeline Instruction Scheduling</b></p>
<p>This optimization is generally controlled by the setting you specify in the</p>
<p><b>OptimizationâOptimization Strategy</b> option (see âGeneral Optimizationsâ</p>
<p>on page 352). To disable it individually:</p>
<p>Use the<b> AdvancedâOptimization OptionsâPipeline Instruction Scheduling</b></p>
<p>option (<b>-Opipeline</b> /<b>-Onopipeline</b> ).</p>
<p>When debugging, you may find it helpful to select the<b> Restrict pipeline</b></p>
<p><b>optimization scope to increase debuggability</b> setting of the</p>
<p><b>OptimizationâOptimization ScopeâPipeline and Peephole Scope</b> option</p>
<p>(<b>-Olimit=pipeline</b> ).</p>
<p>This is a low-level time optimization from which a majority of architectures benefit.</p>
<p>These architectures (which include all RISC implementations, most new CISC</p>
<p>implementations, many DSP processors, and even new application-specific cores)</p>
<p>are pipelined, and usually expose at least certain aspects of that pipeline to users.</p>
<p>Instruction scheduling involves reordering instructions for these architectures to</p>
<p>make more efficient use of the associated pipelines. The optimizer uses three methods</p>
<p>for pipeline instruction scheduling:</p>
<p>â¢</p>
<p>branch scheduling</p>
<p>â¢</p>
<p>basic block scheduling</p>
<p>â¢</p>
<p>superscalar scheduling (for certain architecture implementations only)</p>
<p>These are among the most important optimizations for many architectures, and can</p>
<p>increase code speed for the majority of applications.</p>
<p><b>Example 4.6. Branch Scheduling and Basic Block Scheduling</b></p>
<p>For this generic machine example, assume that:</p>
<p>â¢</p>
<p>there is one delay slot after a branch</p>
<p>â¢</p>
<p>at least one instruction is required between a load into a register and the use of</p>
<p>that register</p>
<p>â¢</p>
<p>the last register of a three operand instruction is the destination</p>
<p><i>353</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Pipeline Instruction Scheduling</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>(b) After Scheduling Pseudo Code</b></p>
<p><b>(a) Before Scheduling Pseudo Code</b></p>
<p>load r0, 0(r5)</p>
<p>load r0, 0(r5)</p>
<p>1</p>
<p>load r1, 4(r6)</p>
<p>load r1, 4(r6)</p>
<p>2</p>
<p>add r7, r8, r9</p>
<p>add r0, r1, r2</p>
<p>3</p>
<p>add r0, r1, r2</p>
<p>add r7, r8, r9</p>
<p>4</p>
<p>branch L2</p>
<p>sub r0, r3, r4</p>
<p>5</p>
<p>sub r0, r3, r4</p>
<p>branch L2</p>
<p>6</p>
<p>nop</p>
<p>7</p>
<p>Branch scheduling consists of two different areas: filling branch delay slots and</p>
<p>filling a delay between a comparison and a branch based on that comparison.</p>
<p>In this example, the branch delay slot is filled when instruction 5 from sequence</p>
<p>(a) is placed in the</p>
<p>nop</p>
<p>slot after the branch at instruction 6 in sequence (b). This</p>
<p>causes the normally unused cycles after the branch to be used on the</p>
<p>sub</p>
<p>pseudo</p>
<p>instruction.</p>
<p>Certain architectures require a number of cycles to elapse between a comparison</p>
<p>and branch based on that comparison. The method shown above is used to move</p>
<p>one or more instructions between the compare and the branch to make use of those</p>
<p>cycles.</p>
<p>Basic block scheduling is performed within a basic block (a sequence of instructions</p>
<p>which always executes as a group). The instructions within a single basic block are</p>
<p>sorted so that the new sequence produces the same result as the original sequence.</p>
<p>In this example, this change is made by reversing the order of the two</p>
<p>add</p>
<p>instructions at lines 3 and 4 between sequence (a) and sequence (b) to allow for the</p>
<p>load delay in instruction 2. This will prevent a stall after the load and instead use</p>
<p>those cycles on the</p>
<p>add</p>
<p>instruction.</p>
<p><b>Example 4.7. Superscalar Scheduling</b></p>
<p>Scheduling for superscalar implementations involves taking into account the</p>
<p>existence of multiple execution units. Many architectures are now designed with</p>
<p>multiple integer, floating-point, or load-store units in a single implementation. The</p>
<p>compiler can schedule the instructions of these architectures so that the instructions</p>
<p>associated with multiple execution units can execute at the same time.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>354</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For this generic superscalar machine example, assume the same architecture</p>
<p>characteristics as in the previous example and, also, that:</p>
<p>â¢</p>
<p>one integer and one floating-point instruction can be issued in the same cycle</p>
<p>â¢</p>
<p>the floating-point instruction must follow the integer instruction with which it</p>
<p>is paired</p>
<p>This example uses the same instructions as the last example, with the addition of a</p>
<p>floating-point</p>
<p>add</p>
<p>instruction and a floating-point</p>
<p>sub</p>
<p>instruction at lines 6 and 7.</p>
<p><b>(b) After Scheduling Pseudo Code</b></p>
<p><b>(a) Before Scheduling Pseudo Code</b></p>
<p>load r0, 0(r5)</p>
<p>load r0, 0(r5)</p>
<p>1</p>
<p>load r1, 4(r6)</p>
<p>load r1, 4(r6)</p>
<p>2</p>
<p>add r7, r8, r9</p>
<p>add r0, r1, r2</p>
<p>3</p>
<p>addd f0, f1, f2</p>
<p>add r7, r8, r9</p>
<p>4</p>
<p>add r0, r1, r2</p>
<p>sub r0, r3, r4</p>
<p>5</p>
<p>subd f3, f2, f4</p>
<p>addd f0, f1, f2</p>
<p>6</p>
<p>branch L2</p>
<p>subd f3, f2, f4</p>
<p>7</p>
<p>sub r0, r3, r4</p>
<p>branch L2</p>
<p>8</p>
<p>nop</p>
<p>9</p>
<p>In this example, the two floating-point instructions at lines 6 and 7 from sequence</p>
<p>(a) have been moved to lines 4 and 6 in sequence (b), making the most efficient use</p>
<p>of the multiple instruction issue capability of the integer and floating-point execution</p>
<p>units.</p>
<p><i>355</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Pipeline Instruction Scheduling</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Common Subexpression Elimination</b></p>
<p>This optimization is generally controlled by the setting you specify in the</p>
<p><b>OptimizationâOptimization Strategy</b> option (see âGeneral Optimizationsâ</p>
<p>on page 352). It is not enabled by<b> -Onone</b>,<b> -Odebug</b>,<b> -Omoredebug</b>, or</p>
<p><b>-Omaxdebug</b>. To disable it individually:</p>
<p>Use the<b> AdvancedâOptimization OptionsâCommon Subexpression</b></p>
<p><b>Elimination</b> option (<b>-Ocse</b> /<b>-Onocse</b> ).</p>
<p>This optimization is implemented when the compiler determines that a previously</p>
<p>calculated expression is part of a later expression and none of the variable values</p>
<p>in the subexpression have changed. The compiler retains the value of the</p>
<p>subexpression in a register for reuse.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>int subr(int x, int y)</p>
<p>{</p>
<p>int a, b, _v6;</p>
<p>x+=(_v6=a+b);</p>
<p>y+=_v6;</p>
<p>if (y&lt;0)</p>
<p>return (y);</p>
<p>return (x);</p>
<p>}</p>
<p>int subr(int x, int y)</p>
<p>{</p>
<p>int a, b;</p>
<p>x += a+b;</p>
<p>y += a+b;</p>
<p>if (y &lt; 0)</p>
<p>return (y);</p>
<p>return (x);</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>356</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Tail Calls</b></p>
<p>Tail call optimization is generally controlled by the<b> OptimizationâOptimization</b></p>
<p><b>Strategy</b> option (see âGeneral Optimizationsâ on page 352). It is not enabled by</p>
<p><b>-Onone</b>,<b> -Odebug</b>,<b> -Omoredebug</b>, or<b> -Omaxdebug</b>. To disable it individually:</p>
<p>Use the<b> AdvancedâOptimization OptionsâTail Calls</b> option (<b>-Otailrecursion</b></p>
<p>/<b>-Onotailrecursion</b> ).</p>
<p>A function</p>
<p>foo()</p>
<p>is considered for tail call optimization if the last executed</p>
<p>statement returns the value of a function call</p>
<p>bar()</p>
<p>. With the optimization, the</p>
<p>compiler branches from</p>
<p>foo()</p>
<p>to</p>
<p>bar()</p>
<p>, and</p>
<p>bar()</p>
<p>returns directly to</p>
<p>foo()</p>
<p>'s</p>
<p>caller. For example:</p>
<p><b>Optimized assembly</b></p>
<p><b>Initial assembly</b></p>
<p><b>C source code</b></p>
<p>branch to bar()</p>
<p>restore registers</p>
<p>restore stack frame</p>
<p>return to caller()</p>
<p>call bar()</p>
<p>restore registers</p>
<p>restore stack frame</p>
<p>return to foo()</p>
<p>restore registers</p>
<p>restore stack frame</p>
<p>return to caller()</p>
<p>int bar(void);</p>
<p>int foo(void)</p>
<p>{</p>
<p>return bar();</p>
<p>}</p>
<p>This option also controls tail recursion optimizations. A function is considered tail</p>
<p>recursive if the last statement executed is a call to itself followed by a return</p>
<p>statement. This optimization replaces the call with a branch instruction and eliminates</p>
<p>the return statement. For example:</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>int sum(int n)</p>
<p>{</p>
<p>int _v3=0;</p>
<p>L1:</p>
<p>if (n &lt;= 1)</p>
<p>return _v3+1;</p>
<p>_v3 += n;</p>
<p>n--;</p>
<p>goto L1;</p>
<p>}</p>
<p>int sum(int n)</p>
<p>{</p>
<p>if (n &lt;= 1)</p>
<p>return (1);</p>
<p>else</p>
<p>return (n+ sum(n-1));</p>
<p>}</p>
<p><i>357</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Tail Calls</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Constant Propagation</b></p>
<p>This optimization is generally controlled by the setting you specify in the</p>
<p><b>OptimizationâOptimization Strategy</b> option (see âGeneral Optimizationsâ</p>
<p>on page 352). It is not enabled by<b> -Onone</b>,<b> -Odebug</b>,<b> -Omoredebug</b>, or</p>
<p><b>-Omaxdebug</b>. To disable it individually:</p>
<p>Use the<b> AdvancedâOptimization OptionsâConstant Propagation</b> option</p>
<p>(<b>-Oconstprop</b> /<b>-Onoconstprop</b> ).</p>
<p>This optimization replaces a variable with a constant, where the compiler determines</p>
<p>that the value of the variable does not change.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>int main()</p>
<p>{</p>
<p>int i,b;</p>
<p>b = 0;</p>
<p>for (i=0; i&lt;1000; i++)</p>
<p>b+=3;</p>
<p>printf(&quot;%d\n&quot;, b);</p>
<p>return 0;</p>
<p>}</p>
<p>int main()</p>
<p>{</p>
<p>int i,a,b;</p>
<p>a = 3;</p>
<p>b = 0;</p>
<p>for (i=0;i&lt;1000;i++)</p>
<p>b += a;</p>
<p>printf(&quot;%d\n&quot;, b);</p>
<p>return 0;</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>358</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>C/C++ Minimum/Maximum Optimization</b></p>
<p>This optimization is generally controlled by the setting you specify in the</p>
<p><b>OptimizationâOptimization Strategy</b> option (see âGeneral Optimizationsâ</p>
<p>on page 352). To disable it individually:</p>
<p>Use the<b> AdvancedâOptimization OptionsâC/C++ Minimum/Maximum</b></p>
<p><b>Optimization</b> option (<b>-Ominmax</b> /<b>-Onominmax</b> ).</p>
<p>This optimization can generate special code for minimum, maximum, and absolute</p>
<p>value expressions of the form:</p>
<p>(i &lt; j) ? i : j</p>
<p>(i &gt; j) ? i : j</p>
<p>(i &lt; 0) ? -i : i</p>
<p><b>Memory Optimization</b></p>
<p>This optimization is generally controlled by the setting you specify in the</p>
<p><b>OptimizationâOptimization Strategy</b> option (see âGeneral Optimizationsâ</p>
<p>on page 352). To disable it individually:</p>
<p>Use the<b> AdvancedâOptimization OptionsâMemory Optimization</b> option</p>
<p>(<b>-OM</b> /<b>-Onomemory</b> ).</p>
<p><b>Note</b></p>
<p>This optimization assumes that non-volatile memory locations only change</p>
<p>with explicit store instructions and thus are not affected by any external</p>
<p>sources (such as memory-mapped I/O or interrupt handlers). If you are</p>
<p>writing an application that makes use of external sources, we recommend</p>
<p>that you use the</p>
<p>volatile</p>
<p>keyword appropriately. Alternatively, you</p>
<p>can disable this optimization.</p>
<p>This optimization instructs the compiler to optimize repeated memory reads by</p>
<p>placing the value in a local temporary location. Subsequent read operations then</p>
<p>refer to the register rather than the actual memory location.</p>
<p><i>359</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C/C++ Minimum/Maximum Optimization</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>This optimization is only enabled through the</p>
<p><b>OptimizationâOptimization Strategy</b> option for ANSI C and C++.</p>
<p>To enable it when compiling K&amp;R C code, you must set the</p>
<p><b>AdvancedâOptimization OptionsâMemory Optimization</b> option to</p>
<p><b>On</b> (<b>-OM</b>).</p>
<p>To disable memory optimization in ANSI C or C++, use the</p>
<p>volatile</p>
<p>keyword</p>
<p>to explicitly declare any object that may change without the compiler's knowledge</p>
<p>or control (see âType Qualifiersâ on page 686), or set the<b> AdvancedâOptimization</b></p>
<p><b>OptionsâMemory Optimization</b> option to<b> Off</b> (<b>-Onomemory</b>).</p>
<p><b>Dead Code Elimination</b></p>
<p>This optimization is generally controlled by the setting you specify in the</p>
<p><b>OptimizationâOptimization Strategy</b> option. It is not enabled by<b> -Onone</b>,</p>
<p><b>-Odebug</b>,<b> -Omoredebug</b>, or<b> -Omaxdebug</b>, and it cannot be controlled individually.</p>
<p>It removes code that computes values which are never used and eliminates blocks</p>
<p>that are determined to be unreachable.</p>
<p>In the following example, after the expression</p>
<p>0*x</p>
<p>is constant folded and the value</p>
<p>0</p>
<p>is constant propagated into the</p>
<p>if</p>
<p>conditional, this optimization is able to</p>
<p>determine that the</p>
<p>then</p>
<p>block is unreachable and removes the call</p>
<p>foo()</p>
<p>and the</p>
<p>return c</p>
<p>. Then, it can determine that the value of variable</p>
<p>c</p>
<p>is no longer used,</p>
<p>and is able to eliminate the expression</p>
<p>c = 3 * x</p>
<p>.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>int subr(int x)</p>
<p>{</p>
<p>int b;</p>
<p>b = 2 * x;</p>
<p>bar();</p>
<p>return b;</p>
<p>}</p>
<p>int subr(int x)</p>
<p>{</p>
<p>int a, b, c;</p>
<p>a = 0 * x;</p>
<p>b = 2 * x;</p>
<p>c = 3 * x;</p>
<p>if (a) {</p>
<p>foo();</p>
<p>return c;</p>
<p>} else {</p>
<p>bar();</p>
<p>return b;</p>
<p>}</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>360</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Static Address Elimination</b></p>
<p>This optimization is generally controlled by the setting you specify in the</p>
<p><b>OptimizationâOptimization Strategy</b> option. It is not enabled by<b> -Onone</b>,</p>
<p><b>-Odebug</b>,<b> -Omoredebug</b>, or<b> -Omaxdebug</b>, and it cannot be controlled individually.</p>
<p>It instructs the optimizer to assign frequently used static variables to registers within</p>
<p>the scope of the function. This eliminates the loads and stores required with memory</p>
<p>allocation.</p>
<p>In these examples, the address of the static variable</p>
<p>x</p>
<p>is maintained in a register.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>int subr(int q)</p>
<p>{</p>
<p>static int x=0;</p>
<p>register int x_ = x;</p>
<p>x_++;</p>
<p>q+=x_;</p>
<p>x=x_;</p>
<p>return(q);</p>
<p>}</p>
<p>int subr(int q)</p>
<p>{</p>
<p>static int x=0;</p>
<p>x++;</p>
<p>q+=x;</p>
<p>return(q);</p>
<p>}</p>
<p><b>Note</b></p>
<p>This optimization is performed not only for locally defined static variables,</p>
<p>but also for global variables, as shown in the following example.</p>
<p><b>Example 4.8. Using Global Variables with Static Address Elimination</b></p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>int x = 0;</p>
<p>int subr(int q)</p>
<p>{</p>
<p>register int x_ = x;</p>
<p>x_++;</p>
<p>q+=x_;</p>
<p>x=x_;</p>
<p>return(q);</p>
<p>}</p>
<p>int x = 0;</p>
<p>int subr(int q)</p>
<p>{</p>
<p>x++;</p>
<p>q+=x;</p>
<p>return q;</p>
<p>}</p>
<p><i>361</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Static Address Elimination</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Default Optimizations</b></p>
<p>The optimizations in this section are very basic and are enabled even if no</p>
<p><b>OptimizationâOptimization Strategy</b> is specified.</p>
<p><b>Register Allocation by Coloring</b></p>
<p>This optimization is enabled by default. To disable it:</p>
<p>Set the<b> AdvancedâOptimization OptionsâRegister Allocation by Coloring</b></p>
<p>option to<b> Off</b> (<b>-nooverload</b> ).</p>
<p>This optimization permanently maintains a selected set of</p>
<p>local</p>
<p>scalar variables</p>
<p>in registers, based on their frequency of reference and their lifetimes. The compiler</p>
<p>uses data flow analysis to determine the lifetime of each variable. The register</p>
<p>allocator uses this information to assign different variables within a function to the</p>
<p>same register if the lifetimes of the variables do not overlap. This increases the</p>
<p>opportunity for allocating variables to registers, which in turn enables the compiler</p>
<p>to significantly optimize the code, (since additional memory load and store</p>
<p>instructions are not required to reference the variables).</p>
<p>In the following example, the variables</p>
<p>a</p>
<p>and</p>
<p>b</p>
<p>are both assigned to the same register</p>
<p>because their lifetimes do not overlap (note that the code could be optimized further,</p>
<p>but is not here in order to simplify the example).</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>int subr(int x)</p>
<p>{</p>
<p>int a;</p>
<p>a=x;</p>
<p>a=x*2;</p>
<p>return a;</p>
<p>}</p>
<p>int subr(int x)</p>
<p>{</p>
<p>int a,b;</p>
<p>a=x;</p>
<p>b=x*2;</p>
<p>return b;</p>
<p>}</p>
<p>Scalar variables are generally considered for register allocation unless their values</p>
<p>are accessed with the address operator (</p>
<p>&amp;</p>
<p>).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>362</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Automatic Register Allocation</b></p>
<p>This optimization is enabled by default. To disable it:</p>
<p>Set the<b> AdvancedâOptimization OptionsâAutomatic Register Allocation</b></p>
<p>option to<b> Off</b> (<b>-noautoregister</b> ).</p>
<p>This optimization enables the automatic allocation of local variables to registers.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>extern int global;</p>
<p>int foo(int e)</p>
<p>{</p>
<p>register int local = e;</p>
<p>if (global)</p>
<p>local = local * 2;</p>
<p>return local;</p>
<p>}</p>
<p>extern int global;</p>
<p>int foo(int e)</p>
<p>{</p>
<p>int local = e;</p>
<p>if (global)</p>
<p>local = local * 2;</p>
<p>return local;</p>
<p>}</p>
<p><b>Register Coalescing</b></p>
<p>This optimization is enabled by default and cannot be disabled. It eliminates the</p>
<p>additional register-to-register copies required when using a temporary register.</p>
<p>When evaluating an expression, the compiler uses the destination register as a work</p>
<p>register and organizes the instruction sequence so that the result ends up in that</p>
<p>register.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>int fun(int a,int b,int c)</p>
<p>{</p>
<p>return a+b+c;</p>
<p>}</p>
<p>int fun(int a,int b,int c)</p>
<p>{</p>
<p>int ret = a+b+c;</p>
<p>return ret;</p>
<p>}</p>
<p><i>363</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Automatic Register Allocation</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Constant Folding</b></p>
<p>This optimization is enabled by default, and cannot be disabled. If the compiler</p>
<p>determines that an expression is a constant, it substitutes the constant in place of</p>
<p>any reference to the expression. In the following example, the expression</p>
<p>SHRT_MAX/2</p>
<p>is a constant with a value of</p>
<p>16383</p>
<p>.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>short subr()</p>
<p>{</p>
<p>int x;</p>
<p>x = 16383;</p>
<p>return(x);</p>
<p>}</p>
<p>#define SHRT_MAX 32767</p>
<p>short subr()</p>
<p>{</p>
<p>int x;</p>
<p>x=SHRT_MAX/2;</p>
<p>return(x);</p>
<p>}</p>
<p><b>Loop Rotation</b></p>
<p>This optimization is enabled by default and cannot be disabled. It locates the</p>
<p>termination test and a conditional branch at the bottom of the loop. This causes the</p>
<p>loop to process only one branch instruction on each iteration.</p>
<p><b>Optimized C source code</b></p>
<p><b>Initial C source code</b></p>
<p>int subr(int i)</p>
<p>{</p>
<p>goto L7;</p>
<p>do {</p>
<p>i *= i;</p>
<p>L7:</p>
<p>} while (i &lt; 10);</p>
<p>return(i);</p>
<p>}</p>
<p>int subr(int i)</p>
<p>{</p>
<p>while (i &lt; 10)</p>
<p>i *= i;</p>
<p>return(i);</p>
<p>}</p>
<p>If the compiler determines that the loop is executed at least once, it is entered at the</p>
<p>top. If not, the compiler generates an unconditional branch before the loop to the</p>
<p>termination test.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>364</i></p>
<p><i>Chapter 4. Optimizing Your Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 5</b></p>
<p><b>The DoubleCheck Source</b></p>
<p><b>Analysis Tool</b></p>
<p><b>Contents</b></p>
<p>Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>366</p>
<p>Enabling DoubleCheck . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>367</p>
<p>Using Custom Functions with DoubleCheck . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>368</p>
<p>Viewing DoubleCheck Reports . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>373</p>
<p>Controlling DoubleCheck Output . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>374</p>
<p>Using DoubleCheck With Run-Time Error Checking . . . . . . . . . . . . . . . . . . .</p>
<p>376</p>
<p>Source Analysis Error and Warning Messages . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>377</p>
<h1 style="page-break-before:always; "></h1>
<p><b>Introduction</b></p>
<p>DoubleCheck is a tool for identifying bugs in C and C++ code. It finds code that,</p>
<p>when executed, might cause unexpected behavior or harmful corruption of other</p>
<p>programs. While a typical compiler alerts you to basic potential code problems,</p>
<p>DoubleCheck is a powerful static analysis tool that can analyze large pieces of code</p>
<p>spanning many source files and find bugs caused by complex interactions between</p>
<p>these pieces of code. Without DoubleCheck, you must track down bugs with</p>
<p>intensive debugging after they manifest themselves in a running program. By using</p>
<p>DoubleCheck, you can catch these bugs without even running the program.</p>
<p>DoubleCheck works by finding potential execution paths through code, and then</p>
<p>determining how the values of variables can change over these paths. The variables</p>
<p>can be in memory or registers. The execution paths can proceed through function</p>
<p>calls in the same or different files.</p>
<p>DoubleCheck runs at the same time a program is compiled so that no separate tool</p>
<p>or separate pass is required. After you enable DoubleCheck in your project, any</p>
<p>time you build all or part of the project, DoubleCheck quickly analyzes code and</p>
<p>issues errors and warnings illustrating how the bugs it finds might occur.</p>
<p>DoubleCheck can also produce a report file containing extensive information about</p>
<p>the bugs it identifies. The report explains where and under what circumstances the</p>
<p>bugs exist. It also provides statistics about the project, such as the number of lines</p>
<p>of source code, and statistics about the bugs it finds, such as the number of errors</p>
<p>per line of source code. DoubleCheck breaks the statistics down by source file and</p>
<p>directory. You can view the report using the provided report viewer (see âEnabling</p>
<p>DoubleCheckâ on page 367), which allows you to sort and mask different error types</p>
<p>for a custom view that fits your needs.</p>
<p>DoubleCheck is pre-configured with knowledge of properties of standard library</p>
<p>functions. It uses this information to detect errors in code that calls these functions.</p>
<p>For example, DoubleCheck checks that when calling the function</p>
<p>free()</p>
<p>, the caller</p>
<p>only passes a pointer to memory allocated by functions like</p>
<p>malloc()</p>
<p>.</p>
<p>You can also assign these properties to user-defined functions. For example, if you</p>
<p>use a custom memory allocation system, you can assign properties to functions in</p>
<p>that system to aid DoubleCheck in looking for memory allocation bugs. By assigning</p>
<p>properties to functions, you also reduce the number of<i> false positives</i>, which are</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>366</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p>potential bugs identified by DoubleCheck that do not cause errors during program</p>
<p>execution.</p>
<p><b>Enabling DoubleCheck</b></p>
<p>When you enable DoubleCheck, the compiler outputs source analysis errors and</p>
<p>source analysis warnings along with the normal compiler errors and warnings as it</p>
<p>builds source files. To enable DoubleCheck, use the<b> -double_check.level=<i>setting</b></i></p>
<p>option, where<i> setting</i> is one of the following:</p>
<p>â¢</p>
<p><b>None</b> (<b>-double_check.level=none</b>) â [default] DoubleCheck is disabled.</p>
<p>â¢</p>
<p><b>Low</b> (<b>-double_check.level=low</b>) â Looks for all types of bugs, but does not</p>
<p>follow execution paths involving function calls. DoubleCheck runs quickly</p>
<p>and should not affect the time required to compile files.</p>
<p>â¢</p>
<p><b>Medium</b> (<b>-double_check.level=medium</b>) â Looks for all types of bugs, and</p>
<p>follows execution paths through calls between functions in all source files.</p>
<p>This extra processing requires more time than the low level.</p>
<p>â¢</p>
<p><b>High</b> (<b>-double_check.level=high</b>) â Extends the medium level by investigating</p>
<p>even more inter-function execution paths. This requires more processing time</p>
<p>than the medium level.</p>
<p>Each level performs a different degree of processing. At a higher level, DoubleCheck</p>
<p>can identify more bugs than at a lower level, but will require more time to analyze</p>
<p>your code.</p>
<p>The medium and high levels require a two-pass compilation. The first pass</p>
<p>summarizes the contents of source files. The second pass uses the summaries of all</p>
<p>source files when compiling each file, which identifies potential intermodule paths.</p>
<p>Adjusting compiler inlining settings may affect DoubleCheck analysis. For example,</p>
<p>enabling inlining may provide DoubleCheck with more execution pathways to</p>
<p>analyze, while disabling inlining may provide DoubleCheck with more out-of-line</p>
<p>function copies to analyze.</p>
<p><b>Note</b></p>
<p>Enabling DoubleCheck may cause minor differences in code generation.</p>
<p><i>367</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Enabling DoubleCheck</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Specifying a DoubleCheck Report File</b></p>
<p>The most useful way to view DoubleCheck output is to generate a report file and</p>
<p>open it using the Web-based report viewer. Report files contain more detailed</p>
<p>information than the errors and warnings DoubleCheck issues as source files are</p>
<p>built.</p>
<p>To set the name of the report file DoubleCheck generates, use the</p>
<p><b>-double_check.report=<i>Report_File.gsr</b></i> option, where<i> Report_File.gsr</i> is the name</p>
<p>of the file. For example:</p>
<p>-double_check.report=Project1.gsr</p>
<p>After you have specified a report file and built your application, you can view the</p>
<p>report by right-clicking a project in the Project Manager and selecting<b> View</b></p>
<p><b>DoubleCheck Report</b>. See âViewing DoubleCheck Reportsâ on page 373 for</p>
<p>additional report viewing methods.</p>
<p><b>Note</b></p>
<p>The report contains information about the most recent build of source</p>
<p>files. If you fix an error and rebuild the corresponding source file, the</p>
<p>report will no longer show the error. When working with projects that</p>
<p>cause a source file to be built multiple times, we recommend that you</p>
<p>generate multiple report files in order to maintain errors from each build.</p>
<p><b>Using Custom Functions with DoubleCheck</b></p>
<p>DoubleCheck uses pre-configured properties of standard C and C++ library functions</p>
<p>to determine how it should analyze calls to those functions, and when to report an</p>
<p>error or warning. When running at the medium or high level, DoubleCheck can</p>
<p>sometimes infer these properties for other functions. When DoubleCheck is running</p>
<p>at the low level, or when functions exist in an external library, it is much less likely</p>
<p>that DoubleCheck will be able to infer these properties. In these cases, you can tell</p>
<p>DoubleCheck about the properties of other functions to increase the number of</p>
<p>relevant bugs it finds in your source code. At a minimum, you should specify</p>
<p>properties of functions that do not return, such as error handling functions, if they</p>
<p>abort execution.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>368</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The following sections describe how to specify properties of functions to</p>
<p>DoubleCheck, and what those properties mean:</p>
<p>â¢</p>
<p>âSpecifying Function Properties in a DoubleCheck Configuration Fileâ</p>
<p>on page 369</p>
<p>â¢</p>
<p>âSpecifying Function Properties with Pragma Directivesâ on page 370</p>
<p>â¢</p>
<p>âProperty Typesâ on page 370</p>
<p><b>Specifying Function Properties in a DoubleCheck Configuration File</b></p>
<p>You can specify function properties to DoubleCheck by using a configuration file.</p>
<p>You do not have to modify source code when using a configuration file.</p>
<p>Configuration files specify one property per line, except lines that start with</p>
<p>#</p>
<p>,</p>
<p>which are ignored. The format of each line is:</p>
<p><i>Property_Type</i></p>
<p><i>Argument_Number</i></p>
<p><i>Function_Name</i></p>
<p>where:</p>
<p>â¢</p>
<p><i>Property_Type</i> â The property type (for example,</p>
<p>no_return</p>
<p>). See âProperty</p>
<p>Typesâ on page 370 for a list of property types.</p>
<p>â¢</p>
<p><i>Argument_Number</i> â The number of the argument to which this property</p>
<p>refers. Specify</p>
<p>0</p>
<p>if this property refers to the return value of the function (for</p>
<p>example,</p>
<p>needs_null_check</p>
<p>) or to the function itself (for example,</p>
<p>no_return</p>
<p>).</p>
<p>â¢</p>
<p><i>Function_Name</i> â The name of the function to which you are assigning the</p>
<p>property.</p>
<p>When using C++, do not specify class or argument types. For example, specify</p>
<p>MyFunc</p>
<p>instead of</p>
<p>MyClass::MyFunc(int my_var)</p>
<p>. This will match all</p>
<p>functions named</p>
<p>MyFunc</p>
<p>. Use mangled function names to differentiate the</p>
<p>parent class or argument types. You can find mangled function names by</p>
<p>running<b> gdump -nx</b> or<b> gnm</b> on the compiled object module (see Chapter 11,</p>
<p>âUtility Programsâ on page 525).</p>
<p>When naming a DoubleCheck configuration file, use the<b> .dcc</b> extension. Specify</p>
<p>the configuration file to the compiler with the<b> -double_check.config=<i>filename.dcc</b></i></p>
<p>option, where<i> filename.dcc</i> is the configuration file.</p>
<p><i>369</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Specifying Function Properties in a DoubleCheck Configuration File</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 5.1. DoubleCheck Configuration File</b></p>
<p># This file defines properties of a function called</p>
<p># another_malloc to be exactly the same as the standard malloc</p>
<p>needs_null_check 0 another_malloc</p>
<p>malloced 0 another_malloc</p>
<p>malloc_size 1 another_malloc</p>
<p><b>Specifying Function Properties with Pragma Directives</b></p>
<p>You can also specify function properties to DoubleCheck by inserting</p>
<p>#pragma</p>
<p>directives in your source code. Insert the</p>
<p>#pragma</p>
<p>directive near the declaration</p>
<p>of a function in a header file. We recommend this because you are likely to remember</p>
<p>to update the</p>
<p>#pragma</p>
<p>directive if you change the function declaration. When you</p>
<p>place a</p>
<p>#pragma</p>
<p>directive in a header file, DoubleCheck reads the directive</p>
<p>whenever another file</p>
<p>#includes</p>
<p>that header file. The format of the DoubleCheck</p>
<p>#pragma</p>
<p>directives is as follows:</p>
<p>#pragma double_check<i> Property_Type</i></p>
<p><i>Argument_Number</i></p>
<p><i>Function_Name</i></p>
<p>where<i> Property_Type</i>,<i> Argument_Number</i>, and<i> Function_Name</i> have the same</p>
<p>meaning as in âSpecifying Function Properties in a DoubleCheck Configuration</p>
<p>Fileâ on page 369.</p>
<p><b>Property Types</b></p>
<p>The following sections describe the property types that can be used in<i> Property_Type</i></p>
<p>(see âSpecifying Function Properties in a DoubleCheck Configuration Fileâ</p>
<p>on page 369). Some of these property types (such as</p>
<p>needs_null_check</p>
<p>) help</p>
<p>DoubleCheck find more bugs, while others (such as</p>
<p>no_return</p>
<p>) help avoid false</p>
<p>positives by preventing DoubleCheck from analyzing infeasible execution paths.</p>
<p><b>needs_null_check</b></p>
<p>Indicates that a function's return value might be</p>
<p>NULL</p>
<p>. A program must verify that</p>
<p>the function's return value is not equal to</p>
<p>NULL</p>
<p>before it dereferences that value.</p>
<p>The argument number of this property must be</p>
<p>0</p>
<p>because it refers to the function's</p>
<p>return value.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>370</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>malloced</b></p>
<p>Indicates that a function's return value is allocated and must be deallocated before</p>
<p>being overwritten or falling out of scope to avoid resource leaks. The argument</p>
<p>number of this property must be</p>
<p>0</p>
<p>because it refers to the function's return value.</p>
<p>If a function with the</p>
<p>malloced</p>
<p>property allocates a resource, that resource should</p>
<p>be deallocated by a function with the</p>
<p>frees</p>
<p>property. Use the</p>
<p>malloc_size</p>
<p>property if arguments to this function indicate the size of a memory region that this</p>
<p>function allocates.</p>
<p><b>malloc_size</b></p>
<p>Indicates that a particular argument specifies the size of a memory region allocated</p>
<p>and returned by this function. You can use</p>
<p>malloc_size</p>
<p>twice if the two arguments</p>
<p>are multiplied together to specify the size. For example, a function that behaves</p>
<p>like</p>
<p>calloc</p>
<p>might use the following properties:</p>
<p>malloc_size 1 another_calloc</p>
<p>malloc_size 2 another_calloc</p>
<p><b>frees</b></p>
<p>Indicates that the specified argument contains a pointer that the function deallocates.</p>
<p>If a function with the</p>
<p>frees</p>
<p>property deallocates a resource, that resource should</p>
<p>have been allocated by a function with the</p>
<p>malloced</p>
<p>property.</p>
<p><b>derefed</b></p>
<p>Indicates that a function argument is unconditionally dereferenced. This is true only</p>
<p>if the dereference always happens and is not preceded by a</p>
<p>NULL</p>
<p>check. For example,</p>
<p>this</p>
<p>#pragma</p>
<p>directive specifies the correct property for the</p>
<p>df</p>
<p>function:</p>
<p>#pragma double_check derefed 1 df</p>
<p>int df(int *x)</p>
<p>{</p>
<p>return *x;</p>
<p>}</p>
<p><i>371</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Property Types</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>no_return_when_zero</b></p>
<p>Indicates that the function never returns when the specified argument has a value</p>
<p>of zero. For example, this</p>
<p>#pragma</p>
<p>specifies the correct property for the</p>
<p>my_check</p>
<p>function:</p>
<p>#pragma double_check no_return_when_zero 1 my_check</p>
<p>void my_check(int *x)</p>
<p>{</p>
<p>if (x == 0) {</p>
<p>printf(&quot;An error has occurred\n&quot;);</p>
<p>exit(1);</p>
<p>}</p>
<p>}</p>
<p><b>no_return_when_non_zero</b></p>
<p>Indicates that the function never returns when the specified argument has a non-zero</p>
<p>value. For example, this</p>
<p>#pragma</p>
<p>specifies the correct property for the</p>
<p>my_check2</p>
<p>function:</p>
<p>#pragma double_check no_return_when_non_zero 1 my_check2</p>
<p>void my_check2(int *x)</p>
<p>{</p>
<p>if (x) {</p>
<p>printf(&quot;An error has occurred\n&quot;);</p>
<p>while(1);</p>
<p>}</p>
<p>}</p>
<p><b>no_return</b></p>
<p>Indicates that a function never returns. The function should always enter an infinite</p>
<p>loop or call another</p>
<p>no_return</p>
<p>function such as</p>
<p>exit</p>
<p>or</p>
<p>abort</p>
<p>. The argument</p>
<p>number of this property must be</p>
<p>0</p>
<p>because it refers to the function itself.</p>
<p><b>unsaved</b></p>
<p>Indicates that a particular argument is never copied to global memory, or saved to</p>
<p>any other storage accessible outside a particular call to the function. The function</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>372</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p>can dereference the argument's value, but should not deallocate the memory region</p>
<p>pointed to by the argument.</p>
<p>unsaved</p>
<p>is useful for helping DoubleCheck catch</p>
<p>memory leaks. For example, DoubleCheck can catch the following memory leak</p>
<p>even when you run it at the<b> low</b> level:</p>
<p>#pragma double_check unsaved 1 store</p>
<p>void store(int *x, int y)</p>
<p>{</p>
<p>*x = y;</p>
<p>}</p>
<p>void buggy()</p>
<p>{</p>
<p>int *x = (int*)malloc(sizeof(int));</p>
<p>store(x, 5);</p>
<p>// store does not save x anywhere</p>
<p>}</p>
<p>// x leaked!</p>
<p><b>uninit</b></p>
<p>Indicates that a functionâs return value is a pointer to uninitialized memory and the</p>
<p>memory must be initialized before being read to avoid unexpected behavior. The</p>
<p>argument number of this property must be</p>
<p>0</p>
<p>, because it refers to the functionâs</p>
<p>return value.</p>
<p><b>Viewing DoubleCheck Reports</b></p>
<p>You can configure DoubleCheck to output a report file containing information about</p>
<p>source analysis errors and warnings. The report contains more detailed information</p>
<p>than the errors and warnings DoubleCheck issues as source files are built. The report</p>
<p>file also contains some useful metrics and statistics. Viewing the report files with</p>
<p>the viewer is the best way to browse DoubleCheck's results.</p>
<p><b>Launching the Report Viewer from the MULTI Project Manager</b></p>
<p>To launch the report viewer from the Project Manager, select<b> Tools</b> â<b> View</b></p>
<p><b>DoubleCheck Report</b> or right-click a project and select<b> View DoubleCheck Report</b>.</p>
<p>This menu item is only enabled if the project generates a report (that is, if the</p>
<p><b>-double_check.level=<i>setting</b></i> and<b> -double_check.report=<i>Report_File.gsr</b></i> options</p>
<p>are set) and has been built.</p>
<p><i>373</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Viewing DoubleCheck Reports</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Launching the Report Viewer From the Command Prompt</b></p>
<p>The report viewer is a Web server that you execute using the<b> gsar</b> command. You</p>
<p>can invoke<b> gsar</b> on any DoubleCheck report file. For example:</p>
<p>gsar Project1.gsr</p>
<p>On Windows hosts,<b> gsar</b> launches the default Web browser to display the report.</p>
<p>On other hosts, you must use the<b> -browser=</b> option to specify a browser to launch.</p>
<p>For example:</p>
<p>gsar -browser=firefox Project1.gsr</p>
<p><b>gsar Options</b></p>
<p>Use the following options with<b> gsar</b> to control report viewing:</p>
<p>â¢</p>
<p><b>-browser=<i>B</b></i> â Launches Web browser<i> B</i> on the main report after starting the</p>
<p>Web server. On Windows hosts,<b> gsar</b> launches the default Web browser if you</p>
<p>do not specify this option.</p>
<p>â¢</p>
<p><b>-port=<i>N</b></i> â Starts the Web server using port<i> N</i>. The default port is 13065.</p>
<p>â¢</p>
<p><b>-tabsize=<i>N</b></i> â Substitutes each tab character in your source files with<i> N</i> spaces.</p>
<p>The default size is 8.</p>
<p>â¢</p>
<p><b>-quiet</b> â Stops<b> gsar</b> from printing any status messages.</p>
<p><b>Controlling DoubleCheck Output</b></p>
<p>By default, the source analysis errors and warnings generated by DoubleCheck</p>
<p>during a build do not interrupt or terminate the build like other compiler-generated</p>
<p>errors. To get the most benefit out of DoubleCheck, we recommend that you fix all</p>
<p>the bugs that DoubleCheck finds, and then raise the priority of source analysis errors</p>
<p>and warnings to the same level as normal compiler-generated errors. Raising the</p>
<p>priority prevents future code changes from adding bugs, because the code will fail</p>
<p>to build.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>374</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Promoting Source Analysis Errors and Warnings</b></p>
<p>To raise source analysis error and/or warning message priority to stop the build,</p>
<p>use<b> -double_check.stop_build=<i>setting</b></i> option, where<i> setting</i> is one of the following:</p>
<p>â¢</p>
<p><b>Off</b> (<b>-double_check.stop_build=off</b>) â [default] Source analysis error and</p>
<p>warning messages do not stop the build.</p>
<p>â¢</p>
<p><b>Errors Only</b> (<b>-double_check.stop_build=errors</b>) â Only source analysis</p>
<p>error messages stop the build.</p>
<p>â¢</p>
<p><b>Warnings and Errors</b> (<b>-double_check.stop_build=warnings</b>) â Source</p>
<p>analysis error and warning messages stop the build.</p>
<p><b>Ignoring Source Analysis Errors and Warnings</b></p>
<p>In certain cases it might be useful to ignore source analysis error and warning</p>
<p>messages. For example, if certain parts of your project cannot be modified, you can</p>
<p>ignore source analysis errors that occur in those parts. You can ignore source analysis</p>
<p>errors and warnings with a build option or by inserting</p>
<p>#pragma</p>
<p>directives in your</p>
<p>code.</p>
<p><b>Note</b></p>
<p>You might also want to disable these messages if they report code paths</p>
<p>that you know are impossible. However, if the code is complex enough</p>
<p>to fool DoubleCheck, it is probably complex enough to fool a less</p>
<p>experienced programmer into making a change that introduces a bug.</p>
<p>Instead of ignoring DoubleCheck, we recommend that you change the</p>
<p>code's control flow to avoid the possibility of uncovering problems later.</p>
<p><b>Using a Builder Option to Ignore Source Analysis Errors and</b></p>
<p><b>Warnings</b></p>
<p>To disable a particular source analysis error or warning message for a file or part</p>
<p>of a build hierarchy, use the<b> -double_check.ignore=<i>number</b></i> option, where<i> number</i></p>
<p>is the number of the error or warning you want to ignore. For example, to ignore</p>
<p>this error:</p>
<p>source analysis error #5: potentially NULL pointer &quot;x&quot;</p>
<p>dereferenced</p>
<p><i>375</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Promoting Source Analysis Errors and Warnings</i></p>
<h1 style="page-break-before:always; "></h1>
<p>&quot;/temp/file038.c&quot;, line 24: pointer set to NULL</p>
<p>int i, *x = 0;</p>
<p>^</p>
<p>&quot;/temp/file038.c&quot;, line 33: pointer dereferenced</p>
<p>*x++ = 4;</p>
<p>^</p>
<p>use the<b> -double_check.ignore=5</b> option.</p>
<p><b>Using #pragma Directives to Ignore Source Analysis Errors and</b></p>
<p><b>Warnings</b></p>
<p>To ignore a particular source analysis error or warning on one line of code, place</p>
<p>the following</p>
<p>#pragma</p>
<p>before that line:</p>
<p>#pragma double_check ignore<i> number</i></p>
<p>where<i> number</i> is the number of the error or warning that you want to ignore, or an</p>
<p>asterisk (*) if you want to disable all types of errors and warnings.</p>
<p>To ignore a particular source analysis error or warning on several lines of code,</p>
<p>place the following</p>
<p>#pragmas</p>
<p>before and after the lines of code:</p>
<p>#pragma double_check start_ignore<i> number</i></p>
<p>/* your code with ignored errors goes here */</p>
<p>#pragma double_check end_ignore<i> number</i></p>
<p><b>Using DoubleCheck With Run-Time Error Checking</b></p>
<p>Enabling run-time error checks may cause DoubleCheck to miss potential bugs that</p>
<p>it would otherwise report. To use both DoubleCheck and run-time error checking</p>
<p>to debug your program, perform two separate builds, where one build uses</p>
<p>DoubleCheck and the other uses run-time error checking.</p>
<p>For more information about run-time error checking, see âRun-Time Error Checksâ</p>
<p>on page 178.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>376</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Source Analysis Error and Warning Messages</b></p>
<p>DoubleCheck can identify many different types of bugs. The following list explains</p>
<p>why you should fix these bugs, how you can fix them, and coding practices you</p>
<p>can use to avoid them in the future.</p>
<p><b>Error Messages</b></p>
<p><b>1: Pointer dereferenced before first being NULL-checked</b></p>
<p>DoubleCheck issues this error when your program calls a function that returns a</p>
<p>pointer that is potentially NULL, and then dereferences the resulting pointer without</p>
<p>performing a<i> NULL-check</i>. A NULL-check is an</p>
<p>if</p>
<p>statement that compares the</p>
<p>value of a pointer to</p>
<p>NULL</p>
<p>to determine whether or not it is a NULL pointer.</p>
<p>DoubleCheck knows which standard library functions potentially return NULL.</p>
<p>For other functions, DoubleCheck looks to see if you have assigned the</p>
<p>needs_null_check</p>
<p>property to that function.</p>
<p>Importance</p>
<p>Unexpected results might occur when a program dereferences a NULL pointer. The</p>
<p>dereference might access the value at memory address 0. The dereference might</p>
<p>trigger an exception. If you do not check the pointer before you dereference it, you</p>
<p>might lose the ability to properly handle a memory allocation failure (for example,</p>
<p>by producing a failure message indicating where in the code the failure occurred</p>
<p>and how much memory was requested). Knowing where in code the problem</p>
<p>occurred makes it easier to track down the cause of memory exhaustion. Knowing</p>
<p>how much memory was requested can help you determine if a negative size value</p>
<p>was accidentally passed to a function such as</p>
<p>malloc</p>
<p>.</p>
<p>Avoidance</p>
<p>Use a simple function to check the return value of library functions like</p>
<p>malloc</p>
<p>.</p>
<p>For example:</p>
<p><b>mm.h</b></p>
<p><i>377</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Source Analysis Error and Warning Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma double_check malloced 0 my_malloc</p>
<p>#pragma double_check malloc_size 1 my_malloc</p>
<p>void *my_malloc(size_t size);</p>
<p><b>mm.c</b></p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &quot;mm.h&quot;</p>
<p>void *my_malloc(size_t size)</p>
<p>{</p>
<p>void *p = malloc(size);</p>
<p>if (p == NULL) {</p>
<p>printf(&quot;Allocation of %lu bytes failed.\n&quot;,</p>
<p>(unsigned long)size);</p>
<p>exit(1);</p>
<p>}</p>
<p>return p;</p>
<p>}</p>
<p><b>2 / 3: Access extends beyond end of / Access extends beyond</b></p>
<p><b>beginning of</b></p>
<p>DoubleCheck issues this error when your program adjusts a pointer to a variable</p>
<p>or allocated memory region so that it points before the beginning or beyond the end</p>
<p>of the region, and then dereferences that pointer.</p>
<p>Importance</p>
<p>Reading past the beginning or end of a variable or allocated memory region returns</p>
<p>undefined results. Writing past the end or beginning of an allocated memory region</p>
<p>will often corrupt data structures internal to</p>
<p>malloc</p>
<p>and potentially other allocated</p>
<p>memory regions. This corruption can cause</p>
<p>malloc</p>
<p>to fail in the future. These bugs</p>
<p>can be hard to track down because they can occur long after the write that caused</p>
<p>the corruption.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>378</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Avoidance</p>
<p>We recommend that you define the size of an array or allocated memory region in</p>
<p>only one place in one header file. This enables you to reference one definition in</p>
<p>all the source files. Viewing one definition eliminates the chance that someone will</p>
<p>change only the part of the code that makes the definition of an array and not how</p>
<p>it is accessed elsewhere. We suggest that you do not write code that contains constant</p>
<p>sizes:</p>
<p>for (index = 0; index &lt; 8; index++)</p>
<p>array[index] = 0;</p>
<p>Instead, find the bounds of an array using the following technique:</p>
<p>#define DIM(a) (sizeof(a)/sizeof((a)[0]))</p>
<p>for (index = 0; index &lt; DIM(array); index++)</p>
<p>array[index] = 0;</p>
<p><b>4: Resource leak through pointer</b></p>
<p>DoubleCheck issues this error when an execution path exists where a resource is</p>
<p>allocated and is not freed, and the pointer to this resource is never saved so it cannot</p>
<p>be freed later.</p>
<p>Importance</p>
<p>Over time, resource leaks can lead to resource exhaustion. These bugs can be hard</p>
<p>to reproduce and track down because they might only happen when a program is</p>
<p>run for a long time or only in a certain way.</p>
<p>Avoidance</p>
<p>To avoid resource leaks, use statically allocated resources instead of dynamic ones.</p>
<p>For example, use a global-scoped or static function-scoped variable instead of</p>
<p>allocating memory resources with calls to</p>
<p>malloc()</p>
<p>. Statically allocating resources</p>
<p>also gives you the benefit of knowing the resource requirements of your application</p>
<p>before running it.</p>
<p><i>379</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Error Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If a resource must be dynamically allocated, try creating a clear execution path from</p>
<p>the allocation to the point where the resource is freed. If you cannot create a clear</p>
<p>execution path, use the C++</p>
<p>auto_ptr</p>
<p>template. In the following example,</p>
<p>obj</p>
<p>is</p>
<p>always freed and never leaked after allocation:</p>
<p>#include &lt;memory&gt;</p>
<p>...</p>
<p>void f()</p>
<p>{</p>
<p>std::auto_ptr&lt;Object&gt; obj(new Object);</p>
<p>if (error1)</p>
<p>return;</p>
<p>// obj freed here</p>
<p>if (error2)</p>
<p>return;</p>
<p>// obj freed here</p>
<p>}</p>
<p>// obj freed here</p>
<p><b>5: Potentially NULL pointer dereferenced</b></p>
<p>DoubleCheck issues this error when a feasible execution path exists between setting</p>
<p>a pointer to NULL and dereferencing that pointer.</p>
<p>Many compilers do not give errors for obvious cases, such as:</p>
<p>int *x = NULL;</p>
<p>*x = 0;</p>
<p>DoubleCheck catches these cases, as well as complex cases found through very</p>
<p>long execution paths with complicated control flow.</p>
<p>DoubleCheck does not consider an execution path to be feasible if control flow</p>
<p>checks guarantee that the program will modify the pointer's value after it is set to</p>
<p>NULL, but before it is dereferenced. For example, in the following code it is known</p>
<p>that no feasible path from</p>
<p>POINT A</p>
<p>to</p>
<p>POINT B</p>
<p>exists, and so DoubleCheck will</p>
<p>not issue this error:</p>
<p>#pragma double_check no_return 0 internal_error</p>
<p>void foo(int x)</p>
<p>{</p>
<p>int a, b;</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>380</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p>int *y = NULL;</p>
<p>// POINT A</p>
<p>switch (x) {</p>
<p>case 0:</p>
<p>y = &amp;a;</p>
<p>break;</p>
<p>case 1:</p>
<p>y = &amp;b;</p>
<p>break;</p>
<p>default:</p>
<p>internal_error();</p>
<p>// #pragma indicates we cannot reach this statement</p>
<p>break;</p>
<p>}</p>
<p>*y = 4;</p>
<p>// POINT B</p>
<p>}</p>
<p>Importance</p>
<p>Various problems might arise when you dereference a NULL pointer. See â1: Pointer</p>
<p>dereferenced before first being NULL-checkedâ on page 377 to learn more about</p>
<p>these problems.</p>
<p>Avoidance</p>
<p>Avoid any potential control flow path between setting a pointer to NULL and</p>
<p>dereferencing that pointer. Initializing pointers to NULL avoids the use of</p>
<p>uninitialized values. If there is complicated control flow between initializing a</p>
<p>pointer to NULL and dereferencing that pointer, perform a NULL-check before</p>
<p>dereferencing it:</p>
<p>int *x = NULL;</p>
<p>...</p>
<p>// complicated logic that might initialize x</p>
<p>...</p>
<p>if (x != NULL) {</p>
<p>...</p>
<p>// dereference of x</p>
<p>...</p>
<p>}</p>
<p><i>381</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Error Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>6: Access into deallocated memory</b></p>
<p>DoubleCheck issues this error when your program accesses a memory region after</p>
<p>deallocating it. For example, it is unsafe to free all elements in a list with the</p>
<p>following code:</p>
<p>void free_list(struct List *l)</p>
<p>{</p>
<p>while (l != NULL) {</p>
<p>free(l);</p>
<p>l = l-&gt;next;</p>
<p>// l-&gt;next is a read of deallocated memory</p>
<p>}</p>
<p>}</p>
<p>A pointer to a deallocated piece of memory is called a<i> dangling pointer</i>.</p>
<p>Importance</p>
<p>When your program deallocates memory, heap management functions such as</p>
<p>malloc</p>
<p>and</p>
<p>free</p>
<p>can modify it. This means that if your program reads from the</p>
<p>deallocated memory, you might get unexpected results. If a program writes to the</p>
<p>deallocated memory, it might corrupt internal data structures used by heap</p>
<p>management functions.</p>
<p>In a multi-threaded process, a memory region deallocated by thread A might be</p>
<p>allocated by thread B. This means that if thread A writes to the deallocated memory,</p>
<p>it might corrupt thread B's data, and if thread A reads from the deallocated memory,</p>
<p>it might return pieces of thread B's data.</p>
<p>Avoidance</p>
<p>Having dangling pointers present in your program can be disastrous. We suggest</p>
<p>that you structure your code so that the pointer falls out of scope immediately after</p>
<p>the program deallocates the memory to which it points. Alternatively, set the pointer</p>
<p>to NULL after the program deallocates the memory to which it points. Here is a</p>
<p>much safer implementation for freeing all elements in a list:</p>
<p>void free_list(struct List *l)</p>
<p>{</p>
<p>while (l != NULL) {</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>382</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p>struct List *tmp = l;</p>
<p>l = l-&gt;next;</p>
<p>free(tmp);</p>
<p>// tmp goes out of scope here, so no need to clear</p>
<p>}</p>
<p>}</p>
<p>Here are two other examples that demonstrate how to avoid dangling pointers:</p>
<p>void *x = malloc(X_SIZE);</p>
<p>...</p>
<p>free(x); x = NULL;</p>
<p>// dangling pointer now cleared</p>
<p>{</p>
<p>void *y = malloc(Y_SIZE);</p>
<p>...</p>
<p>free(y);</p>
<p>}</p>
<p>// dangling pointer now inaccessible</p>
<p><b>7: Memory area deallocated twice</b></p>
<p>DoubleCheck issues this error when your program deallocates the same memory</p>
<p>region twice without allocating it again.</p>
<p>Importance</p>
<p>Deallocating the same memory region twice might cause heap management functions</p>
<p>such as</p>
<p>malloc</p>
<p>and</p>
<p>free</p>
<p>to function improperly.</p>
<p>Avoidance</p>
<p>Avoid dangling pointers using techniques discussed in the Avoidance section of</p>
<p>â6: Access into deallocated memoryâ on page 382.</p>
<p><b>9: Attempt to deallocate stack memory</b></p>
<p>DoubleCheck issues this error when your program deallocates stack memory.</p>
<p><i>383</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Error Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p><i>Stack memory</i> is memory that your program uses to hold local variables and function</p>
<p>return addresses. The compiler generates code that manages stack memory.<i> Heap</i></p>
<p><i>memory</i> is memory that heap management functions such as</p>
<p>malloc</p>
<p>,</p>
<p>free</p>
<p>,</p>
<p>new</p>
<p>,</p>
<p>and</p>
<p>delete</p>
<p>use when allocating and deallocating regions. You should never pass</p>
<p>a pointer to stack memory to a heap management function.</p>
<p>Importance</p>
<p>Deallocating stack memory causes heap management functions like</p>
<p>malloc</p>
<p>,</p>
<p>free</p>
<p>,</p>
<p>new</p>
<p>, and</p>
<p>delete</p>
<p>to function improperly.</p>
<p>Avoidance</p>
<p>Avoid using the same pointer variable to refer to both stack memory and heap</p>
<p>memory. For example, if a variable contains pointers to heap memory 99 percent</p>
<p>of the time and pointers to stack memory 1 percent of the time, you might make the</p>
<p>mistake of unconditionally deallocating the memory to which the pointer points.</p>
<p>For example, use a separate variable for heap allocation and deallocation so that</p>
<p>they are never confused:</p>
<p>int *heap_buf = NULL, *buf, stack_buf[10];</p>
<p>if (...)</p>
<p>buf = stack_buf;</p>
<p>else {</p>
<p>buf = heap_buf = (int*)malloc(...);</p>
<p>if (buf == NULL)</p>
<p>return;</p>
<p>}</p>
<p>...</p>
<p>// complicated logic that uses buf</p>
<p>...</p>
<p>free(heap_buf);</p>
<p><b>10: Inactive stack address potentially returned</b></p>
<p>DoubleCheck issues this error when a function returns a pointer to a local variable.</p>
<p>For example:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>384</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p>char *int_to_string(int val)</p>
<p>{</p>
<p>char buffer[11];</p>
<p>for (int i = 9; i &gt;= 0; i--) {</p>
<p>buffer[i] = '0' + val % 10;</p>
<p>val /= 10;</p>
<p>}</p>
<p>buffer[10] = '\0';</p>
<p>return buffer;</p>
<p>}</p>
<p>// inactive stack memory returned!</p>
<p>Importance</p>
<p>When a function returns, any pointers to non-static local variables in that function</p>
<p>become pointers to inactive stack memory. If the function returns one of these</p>
<p>pointers and the caller dereferences it, you might get unexpected results because</p>
<p>another function call or interrupt handler might have changed the inactive stack</p>
<p>memory. If your program reads this memory, it might not return the desired value.</p>
<p>If your program writes to this memory, it might corrupt stack memory that contains</p>
<p>values critical to correct program execution.</p>
<p>Avoidance</p>
<p>Do not write functions that return pointers to local variables. One way to avoid</p>
<p>accessing inactive stack memory is to declare the variable as static, however, this</p>
<p>technique encourages accidental overlapping uses of the static variable. For example,</p>
<p>if you modify the</p>
<p>int_to_string()</p>
<p>example so that</p>
<p>buffer</p>
<p>is declared</p>
<p>static</p>
<p>,</p>
<p>this function does not correctly print two different integers:</p>
<p>void print_two_ints(int a, int b)</p>
<p>{</p>
<p>printf(&quot;%s %s\n&quot;, int_to_string(a), int_to_string(b));</p>
<p>}</p>
<p>To avoid returning pointers to local variables, require callers to pass in pointers so</p>
<p>that the caller can decide how to allocate the memory.</p>
<p><i>385</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Error Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>11: Write to potentially read-only memory</b></p>
<p>DoubleCheck issues this error when the program writes to read-only memory. For</p>
<p>example:</p>
<p>char *get_string()</p>
<p>{</p>
<p>return &quot;Hello&quot;;</p>
<p>}</p>
<p>char *get_lower_case_string()</p>
<p>{</p>
<p>char *st = get_string();</p>
<p>for (char *c = st; *c != '\0'; c++)</p>
<p>*c = tolower(*c);</p>
<p>// writing to read-only memory!</p>
<p>return st;</p>
<p>}</p>
<p>Importance</p>
<p>Writing to read-only memory can cause exceptions if the memory is write-protected.</p>
<p>Writing to read-only memory can cause unexpected future results. For example,</p>
<p>calling</p>
<p>get_lower_case_string()</p>
<p>changes what future calls to</p>
<p>get_string()</p>
<p>will return.</p>
<p>Avoidance</p>
<p>Use the</p>
<p>const</p>
<p>keyword when declaring pointers to read-only memory. Using this</p>
<p>keyword eliminates the chance of writing through the pointers. To correct the</p>
<p>preceding example, define</p>
<p>get_string</p>
<p>with return type</p>
<p>const char *</p>
<p>.</p>
<p><b>12 / 13: Memory deleted using ``delete[]`` instead of ``delete`` /</b></p>
<p><b>Memory deleted using ``delete`` instead of ``delete[]``</b></p>
<p>DoubleCheck issues this error when your program allocates memory with</p>
<p>new[]</p>
<p>and deallocates it with</p>
<p>delete</p>
<p>, or when it allocates memory with</p>
<p>new</p>
<p>and</p>
<p>deallocates it with</p>
<p>delete[]</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>386</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Importance</p>
<p>If you mix an allocator with the wrong deallocator, your program may not call the</p>
<p>appropriate destructor. This mismatch may not seem like a bug if, for example, a</p>
<p>destructor is not present. It is a better coding practice to use the proper</p>
<p>new</p>
<p>and</p>
<p>delete</p>
<p>calls in case you add a destructor in the future.</p>
<p>Avoidance</p>
<p>Always use</p>
<p>new</p>
<p>and</p>
<p>delete</p>
<p>calls that match. To strictly enforce this rule on a</p>
<p>certain class, overload the unwanted</p>
<p>new</p>
<p>or</p>
<p>delete</p>
<p>calls so that they output an</p>
<p>error message if you use them by mistake.</p>
<p><b>14: Read of potentially uninitialized variable</b></p>
<p>DoubleCheck issues this error when a local variable is never written with a value,</p>
<p>but is read on a particular execution path.</p>
<p>Importance</p>
<p>Relying on an uninitialized value can produce unexpected results. The uninitialized</p>
<p>value might not cause problems 99 percent of the time, which can make reproducing</p>
<p>failures very difficult.</p>
<p>Avoidance</p>
<p>It is good practice to always initialize local variables. This practice should not</p>
<p>degrade performance since the Green Hills compiler is very good at eliminating</p>
<p>unused initializers.</p>
<p><b>17: Read of uninitialized memory</b></p>
<p>DoubleCheck issues this error when memory is allocated but not initialized (for</p>
<p>example, by</p>
<p>malloc()</p>
<p>) and some piece of that memory is read prior to being</p>
<p>initialized.</p>
<p><i>387</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Error Messages</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Importance</p>
<p>Relying on uninitialized memory values can produce unexpected results. The</p>
<p>uninitialized value might not cause problems most of the time, making it very</p>
<p>difficult to reproduce failures.</p>
<p>Avoidance</p>
<p>It is good practice to always initialize memory. In C code, try using</p>
<p>calloc()</p>
<p>instead of</p>
<p>malloc()</p>
<p>. In C++ code, make sure every non-static data member is</p>
<p>initialized or constructed in constructors.</p>
<p><b>Warnings</b></p>
<p>Warnings indicate code that will not explicitly cause unexpected behavior, but is</p>
<p>worth investigating. The code might not be optimal or might contain checks for</p>
<p>problems that can arise in a different form.</p>
<p><b>8: Useless NULL-check after pointer has been dereferenced</b></p>
<p>DoubleCheck issues this warning when your program performs a NULL-check on</p>
<p>a pointer after it has already dereferenced that pointer.</p>
<p>Importance</p>
<p>When you perform a NULL-check, it indicates that you think the pointer will be</p>
<p>NULL in some cases. If you perform this check after dereferencing the pointer, this</p>
<p>in turn indicates that your program will dereference a NULL pointer in those cases.</p>
<p>Your program might exhibit unexpected behavior if it dereferences a NULL pointer.</p>
<p>Avoidance</p>
<p>To avoid this warning and related potential problems, move the NULL-check before</p>
<p>the dereference, and use the NULL-check to avoid executing the dereference when</p>
<p>the pointer is NULL.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>388</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>15: Value set but never read / Value overwritten before being read</b></p>
<p>DoubleCheck issues this warning when your program writes a variable with a value,</p>
<p>but no execution paths leading from this write perform a read of that variable.</p>
<p>Execution paths leading from this write might write the variable again, destroying</p>
<p>the first value and making it impossible to read.</p>
<p>DoubleCheck does not issue this warning when you clear a dangling pointer using</p>
<p>the following code:</p>
<p>free(x);</p>
<p>x = NULL;</p>
<p>Importance</p>
<p>This warning indicates that you might have intended to use the value written to the</p>
<p>variable, so some functionality might be missing from your program.</p>
<p>Avoidance</p>
<p>Avoid writing to a variable unless you intend to use the value stored in the variable</p>
<p>for some purpose.</p>
<p><b>16: Pointer dereferenced unconditionally after NULL-check</b></p>
<p>DoubleCheck issues this warning when your program performs a NULL-check on</p>
<p>a pointer, and then dereferences that pointer independent of the result. To avoid</p>
<p>producing these warnings on infeasible execution paths, assign properties to any</p>
<p>functions that affect execution paths. For example, the following piece of code will</p>
<p>produce a warning without the</p>
<p>#pragma</p>
<p>directive:</p>
<p>#pragma double_check no_return 0 my_error_handler</p>
<p>if (x == NULL)</p>
<p>my_error_handler();</p>
<p>*x = 0;</p>
<p><i>389</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Warnings</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Importance</p>
<p>When you perform a NULL-check, it indicates that you think the pointer will be</p>
<p>NULL in some cases. If you dereference a pointer after a NULL-check, it indicates</p>
<p>that you will dereference a NULL pointer in those cases. Your program might</p>
<p>exhibit unexpected behavior if it dereferences a NULL pointer.</p>
<p>Avoidance</p>
<p>When a pointer is found to be NULL, it is good practice to prevent your program</p>
<p>from dereferencing that pointer. You can do this by stopping execution with a call</p>
<p>that does not return (such as</p>
<p>exit</p>
<p>,</p>
<p>abort</p>
<p>, or a user-defined error handling function),</p>
<p>or by jumping to a point later in the control flow that bypasses the dereference.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>390</i></p>
<p><i>Chapter 5. The DoubleCheck Source Analysis Tool</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Part II</b></p>
<p><b>Using Advanced Tools</b></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 6</b></p>
<p><b>The ease850 Assembler</b></p>
<p><b>Contents</b></p>
<p>Running the Assembler from the Builder or Driver . . . . . . . . . . . . . . . . . . . . .</p>
<p>394</p>
<p>Running the Assembler Directly . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>395</p>
<p>Assembler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>396</p>
<p>Assembler Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>398</p>
<p>Expressions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>402</p>
<p>Labels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>408</p>
<p>Reading the Compiler's Assembly Output . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>408</p>
<h1 style="page-break-before:always; "></h1>
<p>The assembler translates ASCII files containing assembly language instructions</p>
<p>into binary files containing relocatable object code.</p>
<p><b>Running the Assembler from the Builder or Driver</b></p>
<p>We recommend that you invoke the assembler via the Builder or driver. Simply</p>
<p>add assembly files to the Project Manager's project tree, or to the driver's command</p>
<p>line. If your assembly file ends with<b> .800</b> rather than<b> .s</b>, the Builder or driver first</p>
<p>invokes the preprocessor to take advantage of preprocessor facilities (such as</p>
<p>#include</p>
<p>and</p>
<p>#define</p>
<p>) that are not normally available to an assembly language</p>
<p>programmer. To run the preprocessor on all assembly files (including those with a</p>
<p><b>.s</b> extension):</p>
<p>Set the<b> AssemblerâPreprocess Assembly Files</b> option to<b> On</b></p>
<p>(<b>-preprocess_assembly_files</b>).</p>
<p>The Builder and driver accept a limited number of assembler-specific options directly</p>
<p>(see âAssembler Optionsâ on page 232). To pass the full range of assembler options</p>
<p>listed in this chapter:</p>
<p>Enter the required assembler option (see âAssembler Optionsâ on page 396) in the</p>
<p><b>AssemblerâAdditional Assembler Options</b> option (<b>-asm=<i>assembler_option</b></i>).</p>
<p>When using the driver, you can either precede each assembler option with<b> -asm=</b>,</p>
<p>or list multiple options separated by whitespace and enclosed within quotes. Hence</p>
<p>the two following command lines are equivalent:</p>
<p>ccv850 -asm=-l -asm=-w stack.s -c -o stack.o</p>
<p>ccv850 -asm=&quot;-l -w&quot; stack.s -c -o stack.o</p>
<p>Alternatively, if you have a large number of options to pass to the assembler, you</p>
<p>can place them in a text file and enter its filename in the<b> AssemblerâAssembler</b></p>
<p><b>Command File</b> option (<b>-asmcmd=<i>filename</b></i>).</p>
<p><b>Generating Assembly Language Files</b></p>
<p>At times, you might want to generate and review assembly language output from</p>
<p>a high-level language file. To do this:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>394</i></p>
<p><i>Chapter 6. The ease850 Assembler</i></p>
<h1 style="page-break-before:always; "></h1>
<p>From the driver, pass the<b> -S</b> option. For example, the following command line</p>
<p>would compile<b> main.c</b> and place the assembly language output in the file<b> main.s</b>:</p>
<p>ccv850 -S main.c</p>
<p><b>Running the Assembler Directly</b></p>
<p>Whenever possible, you should invoke the assembler indirectly using the driver or</p>
<p>Project Manager. If you must invoke the assembler directly, the syntax is:</p>
<p>ease850 [<i>options</i>] [<i>input_file</i>]</p>
<p>where<i> options</i> are assembler options. When running the assembler directly, do not</p>
<p>use the<b> -asm=</b> option.</p>
<p><i>395</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Running the Assembler Directly</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Assembler Options</b></p>
<p>For information about using the following options with the Builder or driver, see</p>
<p>âRunning the Assembler from the Builder or Driverâ on page 394.</p>
<p><b>V850 and RH850-Specific Assembler Options</b></p>
<p><b>-bit_inst_error</b></p>
<p>Causes the assembler to fail with an error if it encounters a bit manipulation instruction</p>
<p>(</p>
<p>TST1/SET1/NOT1/CLR1</p>
<p>).</p>
<p><b>-cpu=<i>cpu</b></i></p>
<p>Specifies a particular V850 and RH850 target processor. For a complete list of supported</p>
<p>processors and the options to be passed to specify them, see âV850 and RH850 Processor</p>
<p>Variantsâ on page 53.</p>
<p><b>-noexpandbranch</b></p>
<p>Disables branch expansion. An error occurs when a branch that would normally require</p>
<p>expansion for its destination to be in range is encountered.</p>
<p><b>-nofpu</b></p>
<p>Disables support for all FPU instructions. FPU instruction usage will result in an error.</p>
<p><b>-nofpu_double</b></p>
<p>Disables support for double-precision FPU instructions only. Double-precision FPU instruction</p>
<p>usage will result in an error.</p>
<p><b>-fpu30</b></p>
<p><b>-nofpu30</b></p>
<p>Enables or disables support for RH850 FPU 3.0 instructions.</p>
<p><b>-nomacro</b></p>
<p>Disables macro expansion. An error occurs when a macro is encountered.</p>
<p><b>-noshortbranches</b></p>
<p>Instructs the assembler to only use the largest possible instruction when assembling a BCOND</p>
<p>local branch instruction.</p>
<p><b>-rh850_simd</b></p>
<p><b>-norh850_simd</b></p>
<p>Enables or disables support in the assembler for RH850 SIMD instructions.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>396</i></p>
<p><i>Chapter 6. The ease850 Assembler</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-rh850_fpsimd=none</b></p>
<p><b>-rh850_fpsimd=full</b></p>
<p><b>-rh850_fpsimd=half</b></p>
<p>Enables or disables support in the assembler for RH850 FPSIMD instructions.</p>
<p>-rh850_fpsimd=full</p>
<p>enables FPSIMD in Full Register Configuration mode.</p>
<p>-rh850_fpsimd=half</p>
<p>enables FPSIMD in Half Register Configuration mode. For more</p>
<p>information about the two modes, see âFloating-Point SIMDâ on page 157</p>
<p><b>General Assembler Options</b></p>
<p><b>@<i>filename</b></i></p>
<p>Passes commands listed in<i> filename</i> to the assembler.</p>
<p><b>-cpu=<i>cpu</b></i></p>
<p>Specifies the target<i> cpu</i>.</p>
<p><b>-help</b></p>
<p>Prints a help message.</p>
<p><b>-I<i> dir</b></i> (an uppercase letter â</p>
<p>i</p>
<p>â)</p>
<p>Searches directory<i> dir</i> for files specified in</p>
<p>.include</p>
<p>directives.</p>
<p><b>-list=<i>[filename]</b></i></p>
<p>Generates a source listing. If</p>
<p>=<i>filename</i></p>
<p>is not specified, then the listing file is written to a file</p>
<p>with the same name as the original file, but with an<b> .lst</b> extension. If</p>
<p>=<i>filename</i></p>
<p>is specified,</p>
<p>then the listing is written to<i> filename</i>.</p>
<p><b>-o<i> filename</b></i></p>
<p>Sets the name of the output object file to<i> filename</i>. Without the<b> -o</b> option, the assembler produces</p>
<p>an object file that has the name of the assembly language file with an<b> .o</b> extension. For example,</p>
<p><b>foo.o</b> is produced for<b> foo.s</b>.</p>
<p><b>-source=<i>name</b></i></p>
<p>Overrides the source file's<i> name</i>.</p>
<p><b>-V</b></p>
<p>Prints the assembler version number to the standard output.</p>
<p><i>397</i></p>
<p><i>Green Hills Software</i></p>
<p><i>General Assembler Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Assembler Syntax</b></p>
<p><b>Identifiers</b></p>
<p>Identifiers, or symbols, are composed of letters, digits, and the following special</p>
<p>characters: dollar sign (</p>
<p>$</p>
<p>), period (</p>
<p>.</p>
<p>), and underscore (</p>
<p>_</p>
<p>). The first character of an</p>
<p>identifier must be alphabetic, or one of these three special characters. Uppercase</p>
<p>and lowercase letters are distinct; the identifier</p>
<p>abc</p>
<p>is not the same as the identifier</p>
<p>ABC</p>
<p>. Characters in reserved symbols, such as directives, machine instructions, and</p>
<p>registers, are not case-sensitive.</p>
<p><b>Examples</b></p>
<p>The following table shows some valid and invalid identifiers:</p>
<p><b>Validity</b></p>
<p><b>Identifier</b></p>
<p>Invalid (may not contain</p>
<p>*</p>
<p>)</p>
<p>*star</p>
<p>Invalid (may not start with digit)</p>
<p>123test</p>
<p>Invalid (may not use hyphen)</p>
<p>f-ptr</p>
<p>Valid</p>
<p>_hello</p>
<p>Valid</p>
<p>LABEL</p>
<p>Valid</p>
<p>test4</p>
<p><b>Reserved Symbols</b></p>
<p>Operator names are reserved. For a list of operators, see âIntegral Expression</p>
<p>Operatorsâ on page 402.</p>
<p>In addition, the names of the special purpose registers (</p>
<p>SPR</p>
<p>'s) are reserved. Consult</p>
<p>the appropriate microprocessor user's manual for a list of implemented</p>
<p>SPR</p>
<p>'s.</p>
<p><b>Constants</b></p>
<p>Assembler constants can be numeric, character, or string constants.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>398</i></p>
<p><i>Chapter 6. The ease850 Assembler</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Numeric Constants</b></p>
<p>A sequence of digits defines a numeric constant. Constants can be specified in</p>
<p>hexadecimal, octal, or binary formats, or as floating-point numbers, by preceding</p>
<p>the number with one of the following special prefixes:</p>
<p><b>Example</b></p>
<p><b>Prefix</b></p>
<p><b>Type</b></p>
<p>0xb0b</p>
<p>0x</p>
<p>hexadecimal</p>
<p>0747</p>
<p>0</p>
<p>octal</p>
<p>0b110011</p>
<p>0b</p>
<p>binary</p>
<p>0f6.02e+23</p>
<p>0f</p>
<p>floating-point</p>
<p>Floating-point numeric constants are supported in limited cases, such as by the</p>
<p>.double</p>
<p>and</p>
<p>.float</p>
<p>directives.</p>
<p><b>String Constants</b></p>
<p>Some directives take a string constant as one or more of their arguments. A string</p>
<p>constant consists of a sequence of characters enclosed in double quotation marks</p>
<p>(</p>
<p>&quot;</p>
<p>). A string constant can contain any ASCII character (including ASCII null),</p>
<p>except newline. The null character is not appended to strings by the assembler, as</p>
<p>it is in C or C++.</p>
<p><b>Character Constants</b></p>
<p>A character constant can be used in any location where an integer constant is needed.</p>
<p>A character constant consists of the following items, enclosed within single quotation</p>
<p>marks (</p>
<p>' '</p>
<p>):</p>
<p>â¢</p>
<p>either a single ASCII character, or</p>
<p>â¢</p>
<p>a backslash character (</p>
<p>\</p>
<p>) and one of the escape character values</p>
<p>A character constant is considered equivalent to the ASCII value of the character</p>
<p>or escape sequence.</p>
<p>For example, the character constant</p>
<p>'a'</p>
<p>is equivalent to the decimal integer 97,</p>
<p>and the character constant</p>
<p>'\r'</p>
<p>is equivalent to the decimal integer 13.</p>
<p><i>399</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Reserved Symbols</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Character Escape Sequences</b></p>
<p>Character and string constants consist of ASCII characters. The ASCII backslash</p>
<p>(</p>
<p>\</p>
<p>) is used within character and string constants to escape the quotation marks and</p>
<p>to specify certain control characters symbolically. A backslash followed by any</p>
<p>non-escape character is equivalent to that character (for example,</p>
<p>\a</p>
<p>is equivalent</p>
<p>to</p>
<p>a</p>
<p>because</p>
<p>\a</p>
<p>is not an escape sequence).</p>
<p><b>ASCII value</b></p>
<p><b>Character</b></p>
<p><b>Escape</b></p>
<p><b>Sequence</b></p>
<p>0 (</p>
<p>0x0</p>
<p>)</p>
<p>null</p>
<p>\0</p>
<p>8 (</p>
<p>0x8</p>
<p>)</p>
<p>backspace</p>
<p>\b</p>
<p>9 (</p>
<p>0x9</p>
<p>)</p>
<p>horizontal tab</p>
<p>\t</p>
<p>10 (</p>
<p>0xA</p>
<p>)</p>
<p>newline</p>
<p>\n</p>
<p>11 (</p>
<p>0xB</p>
<p>)</p>
<p>vertical tab</p>
<p>\v</p>
<p>12 (</p>
<p>0xC</p>
<p>)</p>
<p>form feed</p>
<p>\f</p>
<p>13 (</p>
<p>0xD</p>
<p>)</p>
<p>return</p>
<p>\r</p>
<p>n/a</p>
<p>octal value<i> nnn</i></p>
<p>\<i>nnn</i></p>
<p>n/a</p>
<p>hexadecimal value<i> nn</i></p>
<p>\x<i>nn</i></p>
<p>39 (</p>
<p>0x27</p>
<p>)</p>
<p>single quotation mark</p>
<p>\'</p>
<p>34 (</p>
<p>0x22</p>
<p>)</p>
<p>double quotation mark</p>
<p>\&quot;</p>
<p>92 (</p>
<p>0x5C</p>
<p>)</p>
<p>backslash in a constant or string</p>
<p>\\</p>
<p><b>Source Statements</b></p>
<p>An assembler source statement consists of a series of fields delimited by spaces</p>
<p>and/or horizontal tabs, in the following format:</p>
<p>[label:] [operator [arguments]] [comments]</p>
<p><b>Label Field</b></p>
<p>See âLabelsâ on page 408.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>400</i></p>
<p><i>Chapter 6. The ease850 Assembler</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Operator Field</b></p>
<p>The operator field starts with the first non-whitespace character after the optional</p>
<p>label field and is terminated by the first whitespace character or line terminator</p>
<p>encountered after the operator. An operator is any symbolic opcode, directive, or</p>
<p>macro call. In order to avoid ambiguity with the label field, operators should not</p>
<p>begin in column 1.</p>
<p><b>Argument Field</b></p>
<p>The argument field starts with the first non-whitespace character following the</p>
<p>operator field and ends with a line terminator or the beginning of a comment field.</p>
<p>Arguments qualify the opcode, directive, or macro call.</p>
<p><b>Comment Field</b></p>
<p>The comment field is optional and begins with â</p>
<p>--</p>
<p>â. The assembler ignores all</p>
<p>characters to the right of the comment symbol until the end of the line.</p>
<p><b>Continuation Lines</b></p>
<p>The assembler does not support continuation lines.</p>
<p><b>Whitespace</b></p>
<p>Whitespace consists of spaces and horizontal tabs.</p>
<p><b>Line Terminators</b></p>
<p>Assembly input lines are terminated by a line feed or a carriage return and line feed</p>
<p>combination. A carriage return or form feed is insufficient.</p>
<p><i>401</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Source Statements</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Expressions</b></p>
<p><b>Assignment Statements</b></p>
<p>An expression is assigned to a symbol by an assignment statement in one of the</p>
<p>following forms, where<i> ident</i> is the symbol name:</p>
<p>â¢</p>
<p><i>ident</i> =[:]<i> const-expr</i></p>
<p>An assignment in the form</p>
<p>=</p>
<p>defines a local constant, while an assignment in</p>
<p>the form</p>
<p>=:</p>
<p>specifies that the symbol is also global. For example:</p>
<p>chair = 8</p>
<p>-- set chair to 8 (local constant)</p>
<p>table =: 5</p>
<p>-- set table to 5 (global)</p>
<p>â¢</p>
<p><i>ident</i> .equ<i> const-expr</i></p>
<p>You cannot use this directive multiple times for the same symbol. For example:</p>
<p>table .equ 8</p>
<p>-- set table to 8</p>
<p>table .equ 5</p>
<p>-- try to reset table to 5 (illegal)</p>
<p>â¢</p>
<p>.set<i> ident</i>,<i>const-expr</i></p>
<p>For example:</p>
<p>.set table,8</p>
<p>-- set table to 8</p>
<p>.set table,5</p>
<p>-- reset table to 5</p>
<p><i>const-expr</i> must be an absolute or relocatable expression (for more information, see</p>
<p>âExpression Typesâ on page 407).</p>
<p><b>Integral Expression Operators</b></p>
<p>A number of operators are available to form expressions. The type</p>
<p>unary</p>
<p>indicates</p>
<p>that the function is recognized when the operator has only a right operand. The type</p>
<p>binary</p>
<p>indicates that the operator has two operands, one to the left of the operator</p>
<p>and one to the right.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>402</i></p>
<p><i>Chapter 6. The ease850 Assembler</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Meaning</b></p>
<p><b>Type</b></p>
<p><b>Operator</b></p>
<p>Bitwise-not operator.</p>
<p>unary</p>
<p>~</p>
<p>Negative.</p>
<p>unary</p>
<p>-</p>
<p>Add.</p>
<p>binary</p>
<p>+</p>
<p>Subtract.</p>
<p>binary</p>
<p>-</p>
<p>Multiply.</p>
<p>binary</p>
<p>*</p>
<p>Divide.</p>
<p>binary</p>
<p>/</p>
<p>Modulo.</p>
<p>binary</p>
<p>%</p>
<p>Bitwise-and operator.</p>
<p>binary</p>
<p>&amp;</p>
<p>Bitwise-or operator.</p>
<p>binary</p>
<p>|</p>
<p>Bitwise-exclusive-or operator.</p>
<p>binary</p>
<p>^</p>
<p>Equality (0 or 1).</p>
<p>binary</p>
<p>=</p>
<p>,</p>
<p>==</p>
<p>Inequality (0 or 1).</p>
<p>binary</p>
<p>!=</p>
<p>Signed compare (0 or 1): greater than, greater than or equal</p>
<p>to, less than, less than or equal to.</p>
<p>binary</p>
<p>&gt;</p>
<p>,</p>
<p>&gt;=</p>
<p>,</p>
<p>&lt;</p>
<p>,</p>
<p>&lt;=</p>
<p>Unsigned compare (0 or 1): greater than, greater than or equal</p>
<p>to, less than, less than or equal to.</p>
<p>binary</p>
<p>:UGT:</p>
<p>,</p>
<p>:UGE:</p>
<p>,</p>
<p>:ULT:</p>
<p>,</p>
<p>:ULE:</p>
<p>Signed shift left, signed shift right.</p>
<p>binary</p>
<p>&lt;&lt;</p>
<p>,</p>
<p>&gt;&gt;</p>
<p>Unsigned shift right (shift 0 into high bit).</p>
<p>binary</p>
<p>:USHR:</p>
<p>Rotate right, rotate left.</p>
<p>binary</p>
<p>:ROTR:</p>
<p>,</p>
<p>:ROTL:</p>
<p><b>Operator Precedence</b></p>
<p>The following table lists the operators in decreasing order of precedence. The binary</p>
<p>operators associate from left to right:</p>
<p>~</p>
<p>and</p>
<p>-</p>
<p>(</p>
<p>unary</p>
<p>)</p>
<p>*</p>
<p>,</p>
<p>/</p>
<p>,</p>
<p>%</p>
<p>+</p>
<p>and</p>
<p>-</p>
<p>(</p>
<p>binary</p>
<p>)</p>
<p>&lt;&lt;</p>
<p>,</p>
<p>&gt;&gt;</p>
<p>,</p>
<p>:USHR:</p>
<p>,</p>
<p>:ROTR:</p>
<p>, and</p>
<p>:ROTL:</p>
<p>=</p>
<p>,</p>
<p>&lt;</p>
<p>,</p>
<p>&gt;</p>
<p>,</p>
<p>&lt;=</p>
<p>,</p>
<p>&gt;=</p>
<p>,</p>
<p>==</p>
<p>,</p>
<p>!=</p>
<p>,</p>
<p>:ULT</p>
<p>,</p>
<p>:UGT:</p>
<p>,</p>
<p>:ULE:</p>
<p>,</p>
<p>and</p>
<p>:UGE:</p>
<p>&amp;</p>
<p><i>403</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Integral Expression Operators</i></p>
<h1 style="page-break-before:always; "></h1>
<p>^</p>
<p>|</p>
<p>Expressions are grouped with matching parentheses ().</p>
<p><b>Relocation Expression Operators</b></p>
<p><b>Meaning</b></p>
<p><b>Type</b></p>
<p><b>Operator</b></p>
<p>Least significant 16 bits of<i> value.</i></p>
<p>unary</p>
<p>lo(<i>value</i>)</p>
<p>Most significant 16 bits of symbol<i> value</i> plus most significant</p>
<p>bit of</p>
<p>lo(<i>value</i>)</p>
<p>.</p>
<p>unary</p>
<p>hi(<i>value</i>)</p>
<p>Most significant 16 bits of<i> value</i>.</p>
<p>unary</p>
<p>hi0(<i>value</i>)</p>
<p>Least significant 16 bits of PID symbol<i> value.</i></p>
<p>unary</p>
<p>pidlo(<i>value</i>)</p>
<p>Most significant 16 bits of PID symbol<i> value</i> plus most</p>
<p>significant bit of</p>
<p>pidlo(<i>value</i>)</p>
<p>.</p>
<p>unary</p>
<p>pidhi(<i>value</i>)</p>
<p>Most significant 16 bits of PID symbol<i> value</i>.</p>
<p>unary</p>
<p>pidhi0(<i>value</i>)</p>
<p>16 bits of SDA symbol<i> value.</i></p>
<p>unary</p>
<p>sdaoff(<i>value</i>)</p>
<p>16 bits of read-only SDA symbol<i> value</i>.</p>
<p>unary</p>
<p>sdaoff2(<i>value</i>)</p>
<p>23 bits of SDA symbol<i> value.</i></p>
<p>unary</p>
<p>sdaoff23(<i>value</i>)</p>
<p>23 bits of read-only SDA symbol<i> value</i>.</p>
<p>unary</p>
<p>rosdaoff23(<i>value</i>)</p>
<p>16 bits of ZDA symbol<i> value.</i></p>
<p>unary</p>
<p>zdaoff(<i>value</i>)</p>
<p>23 bits of ZDA symbol<i> value.</i></p>
<p>unary</p>
<p>zdaoff23(<i>value</i>)</p>
<p>Least significant 16 bits of TDA symbol<i> value.</i></p>
<p>unary</p>
<p>tdaoff(<i>value</i>)</p>
<p>Since V850 immediate data is limited to 5-bit or 16-bit values, two instructions are</p>
<p>required to load a 32-bit data value into a register. The</p>
<p>hi</p>
<p>and</p>
<p>lo</p>
<p>operators access</p>
<p>the upper 16 and lower 16 bits of a 32-bit value, respectively, making it possible</p>
<p>to load a register with a 32-bit address. The following code loads register</p>
<p>r22</p>
<p>with</p>
<p>the value of the label</p>
<p>xyzzy</p>
<p>:</p>
<p>movhi hi(xyzzy), zero, r22</p>
<p>movea lo(xyzzy), r22, r22</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>404</i></p>
<p><i>Chapter 6. The ease850 Assembler</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>C Type Information Operators</b></p>
<p>If you enable the<b> -asm3g</b> option (see âSupport for C Type Information in Assemblyâ</p>
<p>on page 234), you can import type information from C header files using the</p>
<p>.inspect</p>
<p>directive and use it in the following operators:</p>
<p><b>Meaning</b></p>
<p><b>Expression</b></p>
<p>The offset of<i> ident</i> from the base type of<i> type</i> in bytes,</p>
<p>where<i> type</i> is a structure tag or a</p>
<p>typedef</p>
<p>identifier.</p>
<p>offsetof(<i>type</i>,<i> ident</i>)</p>
<p>The size of<i> type</i> in bytes, where<i> type</i> is a built-in type, a</p>
<p>structure tag, or a</p>
<p>typedef</p>
<p>identifier.</p>
<p>sizeof(<i>type</i>)</p>
<p>When specifying a structure tag for a</p>
<p>sizeof()</p>
<p>or</p>
<p>offsetof()</p>
<p>directive, do not</p>
<p>precede it with</p>
<p>struct</p>
<p>as you do when writing C code. For example, use</p>
<p>sizeof(foo)</p>
<p>instead of</p>
<p>sizeof(struct foo)</p>
<p>.</p>
<p>To specify a member</p>
<p>M</p>
<p>of a struct type</p>
<p>S</p>
<p>, use</p>
<p>sizeof(S-&gt;M)</p>
<p>. You must use</p>
<p>-&gt;</p>
<p>instead of</p>
<p>.</p>
<p>, because the assembler considers</p>
<p>.</p>
<p>a valid identifier character.</p>
<p>The second argument to</p>
<p>offsetof</p>
<p>must be a simple identifier. For example, the</p>
<p>following code is not allowed:</p>
<p>offsetof(myStruct, myArrayMember[5])</p>
<p><b>Note</b></p>
<p>Unlike</p>
<p>#include</p>
<p>, the result of</p>
<p>.inspect</p>
<p>is not visible to subsequent</p>
<p>.inspect</p>
<p>directives. A file processed with</p>
<p>.inspect</p>
<p>must resolve its</p>
<p>own dependencies (potentially using its own</p>
<p>#include</p>
<p>directives)</p>
<p>without relying on the context provided by prior</p>
<p>.inspect</p>
<p>directives.</p>
<p><i>405</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C Type Information Operators</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 6.1. Using C Type Information Operators</b></p>
<p>This example shows you how to use type information in assembly directives. The</p>
<p>following header file<b> foo.h</b> defines the type</p>
<p>myStruct</p>
<p>:</p>
<p>/* foo.h */</p>
<p>struct myStruct {</p>
<p>char myChar;</p>
<p>int myInt;</p>
<p>struct {</p>
<p>short myShort;</p>
<p>int myArray[5];</p>
<p>} nested;</p>
<p>};</p>
<p>The following assembly file<b> foo_asm.s</b> uses the type information for</p>
<p>myStruct</p>
<p>to</p>
<p>define objects:</p>
<p>-- foo_asm.s</p>
<p>-- Get type information for myStruct from foo.h</p>
<p>.inspect &quot;foo.h&quot;</p>
<p>.data</p>
<p>-- Use type information from myStruct to write data to objects</p>
<p>myStruct_size:</p>
<p>.word sizeof(myStruct)</p>
<p>nested_size:</p>
<p>.word sizeof(myStruct-&gt;nested)</p>
<p>myArray_size:</p>
<p>.word sizeof(myStruct-&gt;nested-&gt;myArray)</p>
<p>myInt_offset:</p>
<p>.word offsetof(myStruct, myInt)</p>
<p>myShort_offset:</p>
<p>.word offsetof(myStruct-&gt;nested, myShort)</p>
<p>-- The following two lines are syntax errors</p>
<p>--</p>
<p>.word sizeof(myStruct-&gt;myArray[0])</p>
<p>--</p>
<p>.word offsetof(myStruct, nested-&gt;myShort)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>406</i></p>
<p><i>Chapter 6. The ease850 Assembler</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Expression Types</b></p>
<p>The primary expression types are:</p>
<p><b>Meaning</b></p>
<p><b>Expression type</b></p>
<p>A value of an identifier or expression that is computed by the assembler</p>
<p>during assembly.</p>
<p>absolute</p>
<p>An integral constant expression. Unlike an</p>
<p>absolute</p>
<p>, this may not</p>
<p>contain the difference of labels.</p>
<p>integral constant</p>
<p>A C-style character string delimited by double quotation marks is used</p>
<p>in conjunction with a number of assembler directives. All string escape</p>
<p>sequences defined in the C language, such as</p>
<p>\n</p>
<p>for newline, are</p>
<p>allowed. These sequences are described in âCharacter Escape</p>
<p>Sequencesâ on page 400.</p>
<p>quoted string</p>
<p>A relocatable expression or identifier assigns a value relative to the</p>
<p>beginning of a particular section. These values are determined at link</p>
<p>time. All label identifiers are relocatable values.</p>
<p>relocatable</p>
<p>If an identifier is unassigned, its value cannot be determined until link</p>
<p>time. This is an undefined external.</p>
<p>undefined</p>
<p><b>Type Combinations</b></p>
<p>Constants can be combined with all operators. You can combine a constant with a</p>
<p>relocatable or absolute type using any of the operators in the following table:</p>
<p><b>Meaning</b></p>
<p><b>Type</b></p>
<p><b>Operator</b></p>
<p>addition (if one operand to the plus operator is a constant, the</p>
<p>result is the type of the other operand)</p>
<p>binary</p>
<p>+</p>
<p>subtraction (if the second operand is constant, the result is the</p>
<p>type of the first operand. If both operands are in the same</p>
<p>section, then the result is a constant that is the difference of</p>
<p>the addresses)</p>
<p>binary</p>
<p>-</p>
<p><b>Examples</b></p>
<p>4</p>
<p>-- constant</p>
<p>4*(5+6)</p>
<p>-- constant</p>
<p>label</p>
<p>-- relocatable</p>
<p><i>407</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Expression Types</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Labels</b></p>
<p>A statement can begin with one or more<i> named labels</i>, which are identifiers followed</p>
<p>by one or two colon characters. Labels defined with one colon are not referenced</p>
<p>outside the source module. A second colon specifies that the label is made visible</p>
<p>external to its source file, instead of local to that file.</p>
<p>To create temporary labels within a</p>
<p>.macro</p>
<p>directive, use the</p>
<p>.macrolocal</p>
<p>directive.</p>
<p><b>Current Location</b></p>
<p>The symbol</p>
<p>.</p>
<p>refers to the current location in the current section, which can be used</p>
<p>as an alternative to creating a label when the current location must be referenced.</p>
<p>For example:</p>
<p>sparse_table:</p>
<p>.word 1,2</p>
<p>-- move to address that is 16 bytes from sparse_table</p>
<p>.space 16-(.-sparse_table)</p>
<p>.word 3,4</p>
<p>-- move to address that is 32 bytes from sparse_table</p>
<p>.space 32-(.-sparse_table)</p>
<p>.word 5,6</p>
<p><b>Reading the Compiler's Assembly Output</b></p>
<p>The assembly language file generated by the Green Hills compilers contains many</p>
<p>useful comments, which are explained here. The format of these comments is subject</p>
<p>to change without notice. In particular, additional comments might be generated by</p>
<p>new releases of the compiler.</p>
<p>There are three sections of comments: a header comment at the beginning of the</p>
<p>file, a function comment after each function, and a file comment at the end of the</p>
<p>file.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>408</i></p>
<p><i>Chapter 6. The ease850 Assembler</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Header Comment File</b></p>
<p>The first comment shows the command line to invoke the compiler driver,<b> ccv850</b>:</p>
<p>--Driver Command: ccv850 file1.c -S</p>
<p>The next few lines provide the name of the source file, the compile-time directory,</p>
<p>the date and time the compiler was invoked, and the name and version of the host</p>
<p>operating system in use:</p>
<p>--Source File:</p>
<p>file1.c</p>
<p>--Directory:</p>
<p>/tmp</p>
<p>--Compile Date:</p>
<p>Thu Dec 13 13:45:02 2001</p>
<p>--Host OS:</p>
<p>SunOS 5.8 Generic_108528-06</p>
<p>Then the version of the compiler and the exact date of the compiler is shown:</p>
<p>--Version:</p>
<p><i>target version</i> RELEASE VERSION</p>
<p>--Release:</p>
<p>Version<i> version</i></p>
<p>--Revision Date:<i> Revision Date</i></p>
<p>--Release Date:</p>
<p><i>Release Date</i></p>
<p><b>Function Comment Section</b></p>
<p>The function comment section follows the function and lists parameters and local</p>
<p>variables. It indicates where they are stored, either in a register, on the stack, or in</p>
<p>static memory. However, if the program is compiled with optimization enabled, the</p>
<p>generated code might drastically reduce variable lifetimes and make other alterations.</p>
<p>In extreme cases, all uses of a variable in the register or memory location to which</p>
<p>it is assigned can be optimized away.</p>
<p>;_i</p>
<p>d6</p>
<p>local</p>
<p>-- _j</p>
<p>d1</p>
<p>local</p>
<p>-- .L106</p>
<p>.L118</p>
<p>static</p>
<p>-- count</p>
<p>d10</p>
<p>param</p>
<p>-- point</p>
<p>r6</p>
<p>param</p>
<p><i>409</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Header Comment File</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>File Comment Section</b></p>
<p>This section lists imported and static variables declared at the file level and indicates</p>
<p>where they are stored:</p>
<p>--y</p>
<p>y</p>
<p>static</p>
<p>--z</p>
<p>z</p>
<p>import</p>
<p><b>Source Line Comments</b></p>
<p>In addition to the three sections of comments described above, the Green Hills</p>
<p>compilers can show the original source code in the assembly language output file</p>
<p>in the form of comments. This is enabled with the</p>
<p>-passsource</p>
<p>option. Source</p>
<p>lines for</p>
<p>#include</p>
<p>files are never shown. Some blank or inconsequential lines are</p>
<p>deleted by the compiler. Otherwise, the source lines are shown exactly as they occur</p>
<p>in the original source before preprocessor expansion.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>410</i></p>
<p><i>Chapter 6. The ease850 Assembler</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 7</b></p>
<p><b>Assembler Directives</b></p>
<p><b>Contents</b></p>
<p>Alignment</p>
<p>Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>412</p>
<p>Conditional Assembly Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>413</p>
<p>Data Initialization Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>414</p>
<p>File Inclusion Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>416</p>
<p>Macro Definition Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>417</p>
<p>Repeat Block Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>420</p>
<p>Section Control Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>421</p>
<p>Source Listing Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>423</p>
<p>Symbol Definition Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>424</p>
<p>Symbolic Debugging Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>426</p>
<p>Miscellaneous Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>428</p>
<p>RH850 Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>429</p>
<h1 style="page-break-before:always; "></h1>
<p>Assembler directives are instructions to the assembler to perform various</p>
<p>functions.The following tables provide detailed descriptions of the assembler</p>
<p>directives available to you when using the<b> ease850</b> assembler.</p>
<p><b>Alignment Directives</b></p>
<p>.align<i> const-expr</i></p>
<p>.align<i> shift-expr</i> mod<i> bound-expr</i></p>
<p>Advances the location counter to the next address that is a multiple of the constant expression</p>
<p><i>bound-expr</i>, unless the location counter is already aligned to a multiple of<i> bound-expr</i> bytes.</p>
<p>If you specify the constant expression<i> shift-expr</i>, the location counter is shifted that many</p>
<p>additional bytes beyond the aligned address. As the location counter advances, skipped addresses</p>
<p>are filled with zeros for the</p>
<p>.data</p>
<p>section and</p>
<p>nop</p>
<p>instructions for the</p>
<p>.text</p>
<p>section.</p>
<p>The linker ensures that any section containing an .align directive begins on a sufficiently aligned</p>
<p>address. For example, suppose an assembly source file contains the following:</p>
<p>.data</p>
<p>.align 8</p>
<p>When the source file is linked, the starting address of the</p>
<p>.data</p>
<p>section is aligned on an 8-byte</p>
<p>boundary. If the addressing boundary is defined in more than one source file being linked, the</p>
<p>linker aligns the final section to the largest boundary found in the individual sections. For</p>
<p>example, suppose two source files,<b> file_1.s</b> and<b> file_2.s</b>, contain the following:</p>
<p>â¢</p>
<p><b>file_1.s</b>:</p>
<p>.data</p>
<p>.align 8</p>
<p>â¢</p>
<p><b>file_2.s</b>:</p>
<p>.data</p>
<p>.align 32</p>
<p>When<b> file_1.s</b> and<b> file_2.s</b> are linked, the</p>
<p>.data</p>
<p>section is aligned on a 32-byte boundary.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>412</i></p>
<p><i>Chapter 7. Assembler Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Conditional Assembly Directives</b></p>
<p>The</p>
<p>.if<i> integral-const</i></p>
<p>directive starts a block of assembly statements that</p>
<p>are assembled only if<i> integral-const</i> is true. The</p>
<p>.endif</p>
<p>directive terminates the</p>
<p>conditional block of assembly statements.</p>
<p>Within an</p>
<p>.if</p>
<p>/</p>
<p>.endif</p>
<p>block, the</p>
<p>.else</p>
<p>and</p>
<p>.elseif</p>
<p>directives provide</p>
<p>alternative assembly statements that are assembled only if the</p>
<p>.if</p>
<p><i>integral-const</i></p>
<p>directive evaluates to false.</p>
<p>.if x==2</p>
<p>.str &quot;if directive is TRUE&quot;</p>
<p>.elseif x-6</p>
<p>.str &quot;elseif directive is TRUE&quot;</p>
<p>.else</p>
<p>.str &quot;both if and elseif are FALSE&quot;</p>
<p>.endif</p>
<p>You can nest conditional blocks within conditional blocks.</p>
<p>By default, when the assembler creates a source listing, it always lists</p>
<p>.if</p>
<p>/</p>
<p>.endif</p>
<p>assembly statements, but lists the corresponding object code only if the block is</p>
<p>assembled. That is, the assembler produces and lists object code only if<i> integral-const</i></p>
<p>evaluates to true.</p>
<p>.else</p>
<p>Assembles the subsequent block of assembly statements if the previous</p>
<p>.if</p>
<p>directives evaluate</p>
<p>to false.</p>
<p>.elseif<i> integral-const</i></p>
<p>Assembles the subsequent block of assembly statements if the previous</p>
<p>.if</p>
<p>directives evaluate</p>
<p>to false and the</p>
<p>.elseif<i> integral-const</i></p>
<p>evaluates to true. The assembler must be able to</p>
<p>resolve<i> integral-const</i> to a constant without referring to information within the conditional block</p>
<p>of code that follows the</p>
<p>.elseif</p>
<p>directive.</p>
<p>.endif</p>
<p>Terminates the code block that began with the previous</p>
<p>.if</p>
<p>directive.</p>
<p>.if<i> integral-const</i></p>
<p>Starts a conditional block of assembly statements; the assembler generates object code for these</p>
<p>statements only if<i> integral-const</i> evaluates to true. The assembler must be able to resolve</p>
<p><i>integral-const</i> to a constant without referring to information within the</p>
<p>.if</p>
<p>/</p>
<p>.endif</p>
<p>conditional</p>
<p>block of code.</p>
<p><i>413</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Conditional Assembly Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Data Initialization Directives</b></p>
<p>The following directives evaluate expressions and place successive values of the</p>
<p>specified type in the assembly output.</p>
<p>Use</p>
<p>.offset</p>
<p>to advance the location counter to the address where you want to</p>
<p>place data.</p>
<p>.byte<i> const-expr</i>,<i>const-expr,...</i></p>
<p>Stores the values of constant expressions in successive bytes. Each constant expression must</p>
<p>be in the signed range -128 to 127 or in the unsigned range 0 to 255.</p>
<p>.double<i> flt-expr,flt-expr,...</i></p>
<p>Stores the values of floating-point expressions as successive 64-bit IEEE-754 floating-point</p>
<p>values. Each floating-point expression must be within double-precision range.</p>
<p>.hword<i> const-expr,const-expr,...</i></p>
<p>Stores the values of constant expressions as successive 16-bit data. The constant expressions</p>
<p>must be in the signed range -32768 to 32767 or the unsigned range 0 to 65535.</p>
<p>.offset<i> const-expr</i></p>
<p>Places subsequent data at the address offset<i> const-expr</i> from the beginning of the current section</p>
<p>in the current compilation unit. Attempting to place subsequent data prior to the current offset</p>
<p>will result in an error.</p>
<p>.single<i> flt-expr,flt-expr,...</i></p>
<p>Stores the values of floating-point expressions as successive 32-bit IEEE-754 floating-point</p>
<p>values. Each floating-point expression must be within single-precision range.</p>
<p>.space<i> const-expr</i></p>
<p>Generates<i> const-expr</i> bytes of zero data.</p>
<p>.str &quot;<i>string</i>&quot;</p>
<p>Evaluates a C-style string enclosed in double quotation marks (&quot; &quot;) and places the characters in</p>
<p>successive bytes. The delimiting double quotation mark characters and the implicit terminating</p>
<p>null are discarded.</p>
<p>.strz &quot;<i>string</i>&quot;</p>
<p>Evaluates a C-style string enclosed in double quotation marks (&quot; &quot;) and places the characters in</p>
<p>successive bytes. Unlike the</p>
<p>.str</p>
<p>directive, the terminating null is placed with the string. The</p>
<p>delimiting double quotation mark characters are discarded.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>414</i></p>
<p><i>Chapter 7. Assembler Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.word<i> const-expr,const-expr,...</i></p>
<p>Stores the values of constant expressions as successive 32-bit data. The expressions can be</p>
<p>absolute expressions, relocatable expressions, or undefined external identifiers. The actual values</p>
<p>of relocatable and undefined external identifiers are supplied at link time. The value of each</p>
<p>expression must be in the signed range -2147483648 to 2147483647 or the unsigned range 0 to</p>
<p>4294967295.</p>
<p><i>415</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Data Initialization Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>File Inclusion Directives</b></p>
<p>.include &quot;<i>file</i>&quot;</p>
<p>Inserts the contents of<i> file</i> at the location of this directive. The assembler searches for<i> file</i> in the</p>
<p>current working directory, then searches in directories specified by the<b> -I<i>inc_directory</b></i> compiler</p>
<p>driver option.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>416</i></p>
<p><i>Chapter 7. Assembler Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Macro Definition Directives</b></p>
<p>A</p>
<p>.macro/.endm</p>
<p>block defines the contents of a macro. When the name of the</p>
<p>macro appears in the same assembly file, the assembler replaces the name of the</p>
<p>macro with the macro's contents. This replacement is called<i> macro expansion</i>.</p>
<p>A macro might reference another macro. In this case, the assembler processes the</p>
<p>enclosed macro when it expands the enclosing macro. Macros can call themselves</p>
<p>recursively.</p>
<p>The</p>
<p>.macro</p>
<p>directive marks the beginning of a macro and is followed by the name</p>
<p>of the macro and a list of parameters. Next, the body of the macro contains assembly</p>
<p>statements that are included in an assembly file during macro expansion. To end</p>
<p>the body of the macro, place a</p>
<p>.endm</p>
<p>directive as the first symbol on a line.</p>
<p>If you want the assembler to prematurely terminate macro expansion when a certain</p>
<p>condition is true, enclose the</p>
<p>.exitm</p>
<p>directive within an</p>
<p>.if</p>
<p>/</p>
<p>.endif</p>
<p>block in</p>
<p>the body of the macro. The</p>
<p>.exitm</p>
<p>directive prematurely terminates macro</p>
<p>expansion.</p>
<p>To create a temporary label that changes each time a macro is called, use the</p>
<p>.macrolocal</p>
<p>directive. At every macro invocation, all identifiers throughout the</p>
<p>macro body that are listed with the</p>
<p>.macrolocal</p>
<p>directive are appended with a</p>
<p>suffix unique to that macro expansion. This allows local identifiers to be created</p>
<p>and referenced within the macro without conflicting with the equivalent identifiers</p>
<p>local to a subsequent macro expansion.</p>
<p><b>Example 7.1. Mangling Macros into Unique Labels</b></p>
<p>Each time the following macro</p>
<p>mymac</p>
<p>is invoked,</p>
<p>label</p>
<p>and</p>
<p>label2</p>
<p>are mangled</p>
<p>into unique labels.</p>
<p>.macro mymac</p>
<p>.macrolocal label, label2</p>
<p>blt label</p>
<p>mov r0, 1</p>
<p>bgt label2</p>
<p>mov r0, 0</p>
<p>b label2</p>
<p>label:</p>
<p>mvn r0, 0</p>
<p><i>417</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Macro Definition Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>label2:</p>
<p>.endm</p>
<p>If</p>
<p>mymac</p>
<p>was defined without the</p>
<p>.macrolocal</p>
<p>directive,</p>
<p>label</p>
<p>and</p>
<p>label2</p>
<p>would be defined more than once if the macro</p>
<p>mymac</p>
<p>was invoked more than once.</p>
<p>The following example defines two macros,</p>
<p>trythis</p>
<p>and</p>
<p>log_and</p>
<p>:</p>
<p>.macro trythis parm1</p>
<p>st.w r1,parm1*2 [r4]</p>
<p>.endm</p>
<p>.macro log_and parm1 parm2</p>
<p>st.w parm1, parm2 [r4]</p>
<p>.endm</p>
<p>To call a macro, put the name of the macro and its arguments in an assembly file.</p>
<p>The macro must have been previously defined in the assembly file. You must specify</p>
<p>a value for every parameter in the macro.</p>
<p>During macro expansion, the macro's parameters are replaced by the values specified</p>
<p>after the macro name. The concatenation operator</p>
<p>&gt;&lt;</p>
<p>can be used to concatenate</p>
<p>two parameters or a parameter with a symbol. The resulting assembly statement is</p>
<p>not scanned for further parameter matches.</p>
<p>For example, to invoke the macros</p>
<p>trythis</p>
<p>and</p>
<p>log_and</p>
<p>(defined above) and</p>
<p>place the resulting assembly statements in the</p>
<p>.text</p>
<p>section, enter the following:</p>
<p>.text</p>
<p>trythis 16</p>
<p>log_and r1, 0</p>
<p>log_and r1, 2</p>
<p>The assembler performs macro expansion and generates the following:</p>
<p>.text</p>
<p>st.w r1,32[r4]</p>
<p>st.w r1,0[r4]</p>
<p>st.w r1,2[r4]</p>
<p>.endm</p>
<p>Terminates the body of a macro whose definition began with a preceding</p>
<p>.macro</p>
<p>directive.</p>
<p>The</p>
<p>.endm</p>
<p>directive must be the first symbol on its line and cannot have a label.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>418</i></p>
<p><i>Chapter 7. Assembler Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.exitm</p>
<p>Causes the assembler to exit a macro without further expanding its body of assembly statements.</p>
<p>Use within a</p>
<p>.if</p>
<p>/</p>
<p>.endif</p>
<p>block to specify a condition under which you do not want a macro</p>
<p>expanded beyond that point.</p>
<p>.macro<i> name</i> [<i>param1</i>,<i> param2</i>,...]</p>
<p>Begins the definition of a macro, where<i> name</i> is a string representing the name of the macro</p>
<p>and<i> param1</i> is the first parameter that the macro accepts. Parameters must be separated by a</p>
<p>comma or whitespace.</p>
<p><i>419</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Macro Definition Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Repeat Block Directives</b></p>
<p>The following directives specify a block of assembly statements that repeat</p>
<p><i>integral-const</i> times.</p>
<p>.rept<i> integral-const</i></p>
<p>...</p>
<p>.endr</p>
<p>Repeat blocks can occur within repeat blocks. In this case, the enclosed repeat block</p>
<p>is expanded once for each expansion of the enclosing block. The repeat count of</p>
<p>an inner block is evaluated each time the block is expanded.</p>
<p>You can define a repeat block within a macro definition as long as the repeat block</p>
<p>is completely enclosed within the macro.</p>
<p>.endr</p>
<p>Terminates a repeat block that began with a preceding</p>
<p>.rept<i> const-expr</i></p>
<p>directive. The</p>
<p>.endr</p>
<p>directive must be the first symbol on its line and cannot have a label.</p>
<p>.rept<i> integral-const</i></p>
<p>Begins a block of assembly statements that repeats<i> integral-const</i> times, where<i> integral-const</i></p>
<p>resolves to a constant number.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>420</i></p>
<p><i>Chapter 7. Assembler Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Section Control Directives</b></p>
<p>These directives direct assembly output into the specified section.</p>
<p>.data</p>
<p>Changes the active section to the</p>
<p>.data</p>
<p>section. Data that follows this directive is placed in the</p>
<p>.data</p>
<p>section.</p>
<p>.note &quot;<i>string</i>&quot; [,&quot;a|b|w|x&quot;]</p>
<p>Changes the active section to an ELF note section. The new section is called<i> string</i>. The attribute</p>
<p>letters</p>
<p>a</p>
<p>,</p>
<p>b</p>
<p>,</p>
<p>w</p>
<p>, and</p>
<p>x</p>
<p>function as they do with the</p>
<p>.section</p>
<p>directive.</p>
<p>.org<i> const-expr</i></p>
<p>Creates an absolutely located data section at address<i> const-expr</i>. The name of the section is the</p>
<p>section's address, with a prefix of</p>
<p>org</p>
<p>. The MULTI Debugger cannot debug code placed at an</p>
<p>address with a</p>
<p>.org</p>
<p>directive. Therefore, we recommend that you use the</p>
<p>.section</p>
<p>directive</p>
<p>to declare code and data in a section instead, and then define the address of the section in a</p>
<p>linker directives file.</p>
<p>.previous</p>
<p>Changes the active section back to the one in use before the most recent section control directive.</p>
<p><i>421</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Section Control Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.section &quot;<i>string</i>&quot;[,&quot;a|b|w|x&quot;][ &gt;<i> const-expr</i>]</p>
<p>Directs assembly output into the section named<i> string</i>, which is defined in terms of the optional</p>
<p>attributes as listed below.</p>
<p>â¢</p>
<p>a</p>
<p>: the section should have memory allocated for it; that is, it should not be used solely for</p>
<p>debugging or for symbolic information.</p>
<p>â¢</p>
<p>b</p>
<p>: the section will have BSS semantics. Although normal data directives such as</p>
<p>.word</p>
<p>and</p>
<p>.byte</p>
<p>are allowed in a</p>
<p>.bss</p>
<p>section, all of the values specified in those directives are</p>
<p>discarded by the assembler. In the ELF output file, the assembler records only the size of</p>
<p>the section, and its contents are omitted. When the section is downloaded to the target,</p>
<p>space is allocated for the section, but no data is downloaded to this section. Instead, the</p>
<p>startup code is responsible for initializing all bytes in the section to zero.</p>
<p>â¢</p>
<p>w</p>
<p>â the section is writable.</p>
<p>â¢</p>
<p>x</p>
<p>â the section contains executable code.</p>
<p>If none of these letters are specified, then no attributes are set. This is appropriate only for</p>
<p>sections containing debugging or other information not intended to be part of the final linked</p>
<p>file. Sections that are intended to be part of the final linked output should have at least the</p>
<p>a</p>
<p>attribute. After the attributes are set they cannot be specified again.</p>
<p>The standard sections have predefined attributes as follows:</p>
<p>â¢</p>
<p>.text</p>
<p>(Program code) â</p>
<p>&quot;ax&quot;</p>
<p>â¢</p>
<p>.data</p>
<p>(Initialized data) â</p>
<p>&quot;aw&quot;</p>
<p>â¢</p>
<p>.rodata</p>
<p>(Read-only initialized data) â</p>
<p>&quot;a&quot;</p>
<p>â¢</p>
<p>.bss</p>
<p>(Uninitialized data) â</p>
<p>&quot;awb&quot;</p>
<p>If the optional</p>
<p>&gt;<i> const-expr</i></p>
<p>form is used, the section is marked as an absolute section located</p>
<p>at the address indicated by<i> const-expr</i>. This is similar to a section created with the</p>
<p>.org</p>
<p>directive,</p>
<p>except that this format allows you to specify the section's name and flags. If the</p>
<p>.section</p>
<p>directive appears more than once in a single assembly language file with the same section name,</p>
<p>only the first</p>
<p>.section</p>
<p>directive can use this form. Unlike the</p>
<p>.org</p>
<p>directive, absolute</p>
<p>executable sections created in this way can be debugged by the MULTI Debugger.</p>
<p>This example creates a section called</p>
<p>.mytext</p>
<p>with allocation and execute attributes:</p>
<p>.section &quot;.mytext&quot;,&quot;ax&quot;</p>
<p>.text</p>
<p>Changes the active section to the</p>
<p>.text</p>
<p>section. Assembly code and data that follows this</p>
<p>directive is placed in the</p>
<p>.text</p>
<p>section.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>422</i></p>
<p><i>Chapter 7. Assembler Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Source Listing Directives</b></p>
<p>The following directives control the format and content of the source listing produced</p>
<p>by the assembler. They do not affect how the assembler generates object code.</p>
<p>Use the<b> -list</b> compiler driver option to produce a source listing. For example, to</p>
<p>have the assembler produce a source listing<b> file.lst</b> when it assembles<b> file.s</b>, enter:</p>
<p>ccv850 file.s -list</p>
<p>.eject</p>
<p>Puts a form feed (</p>
<p>^L</p>
<p>) into the source listing.</p>
<p>.gen</p>
<p>Causes macros following this directive to be included in the source listing.</p>
<p>.list</p>
<p>Cancels the<b> .nolist</b> directive (re-enables source listing).</p>
<p>.nogen</p>
<p>Prevents macros in the sections following this directive from being included in the source listing.</p>
<p>.nolist</p>
<p>Causes the assembler to exclude information from the source listing until a corresponding</p>
<p>.list</p>
<p>directive is encountered.</p>
<p>.nowarning</p>
<p>Disables warnings.</p>
<p>.sbttl &quot;<i>string</i>&quot;</p>
<p>.subtitle &quot;<i>string</i>&quot;</p>
<p>Inserts<i> string</i> as the subtitle at the top of each page in the source listing. The double quotation</p>
<p>marks are discarded.</p>
<p>.title &quot;<i>string</i>&quot;</p>
<p>Inserts<i> string</i> as the title at the top of each page in the source listing. The double quotation marks</p>
<p>are discarded.</p>
<p>.warning [&quot;<i>string</i>&quot;]</p>
<p>Enables warnings. If â<i>string</i>â is specified, prints the warning â<i>string</i>â to standard error output.</p>
<p><i>423</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Source Listing Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Symbol Definition Directives</b></p>
<p>The following directives define the type and value of an identifier.</p>
<p>.comm<i> ident</i>,<i>const-expr[,const-expr]</i></p>
<p>Assigns the specified identifier<i> ident</i> to a common area of<i> const-expr</i> bytes in length, and causes</p>
<p><i>ident</i> to be visible externally. If<i> ident</i> is not defined by another relocatable object file, the linker</p>
<p>assigns space for the identifier in the</p>
<p>.bss</p>
<p>section. The optional<i> const-expr</i> specifies the variable</p>
<p>alignment in bytes.</p>
<p>.dsect</p>
<p>Begins a block for defining constants. Within a</p>
<p>.dsect</p>
<p>/</p>
<p>.end</p>
<p>block, only labels and</p>
<p>.space</p>
<p>directives are permitted. The symbolic names used for labels are defined to have values equal</p>
<p>to the number of bytes from the beginning of the</p>
<p>.dsect</p>
<p>block. No space is actually allocated;</p>
<p>only the symbolic names in the label fields are defined.</p>
<p>.end</p>
<p>Terminates a block of constants that began with a preceding</p>
<p>.dsect</p>
<p>directive. Defining this</p>
<p>directive outside of a</p>
<p>.dsect</p>
<p>directive may result in unexpected behavior.</p>
<p>.globl<i> ident</i></p>
<p>Causes the identifier<i> ident</i> to be visible externally. If the identifier is defined in the current</p>
<p>module, this directive allows the linker to resolve references by other modules. If the identifier</p>
<p>is not defined in the current module, the assembler resolves it externally.</p>
<p>.inspect &quot;<i>file.h</i>&quot;</p>
<p>Parses the C header file<i> file.h</i> to get type information. You can use this information in the</p>
<p>.struct</p>
<p>directive, and in the</p>
<p>offsetof()</p>
<p>and</p>
<p>sizeof()</p>
<p>operators (see âC Type Information</p>
<p>Operatorsâ on page 405).</p>
<p>This directive is available only when the<b> -asm3g</b> option is enabled (see âSupport for C Type</p>
<p>Information in Assemblyâ on page 234).</p>
<p>.lcomm<i> ident</i>,<i>const-expr[,const-expr]</i></p>
<p>Assigns the specified identifier<i> ident</i> to an area in</p>
<p>.bss</p>
<p>of<i> const-expr</i> bytes in length. The</p>
<p>optional<i> const-expr</i> specifies the variable alignment in bytes. The</p>
<p>.lcomm</p>
<p>directive is similar</p>
<p>to the</p>
<p>.comm</p>
<p>directive, except that<i> ident</i> is not exported.</p>
<p>.lsbss<i> ident</i>,<i>const-expr[,const-expr]</i></p>
<p>Assigns the specified identifier<i> ident</i> to an area in</p>
<p>.sbss</p>
<p>of<i> const-expr</i> bytes in length. The</p>
<p>optional<i> const-expr</i> specifies the variable alignment in bytes. The</p>
<p>.lsbss</p>
<p>directive is similar</p>
<p>to</p>
<p>.sbss</p>
<p>, except that<i> ident</i> is not exported.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>424</i></p>
<p><i>Chapter 7. Assembler Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.sbss<i> ident</i>,<i>const-expr[,const-expr]</i></p>
<p>Assigns the specified identifier<i> ident</i> to a common area of<i> const-expr</i> bytes in length and causes</p>
<p><i>ident</i> to be visible externally. If<i> ident</i> is not defined by another relocatable object file, the linker</p>
<p>assigns space for the identifier in the</p>
<p>.sbss</p>
<p>section. The optional<i> const-expr</i> specifies the</p>
<p>variable alignment in bytes.</p>
<p>.set<i> ident</i>,<i>const-expr</i></p>
<p>Defines the constant value<i> const-expr</i> to the symbol<i> ident</i>. You can use multiple</p>
<p>.set</p>
<p>directives</p>
<p>to change the value of the same symbol.</p>
<p>.weak<i> ident</i></p>
<p>Makes the symbol weak. If the<i> ident</i> cannot be located in any module at link time, the linker</p>
<p>sets the symbol's value to zero.</p>
<p>.zbss<i> ident</i>,<i>const-expr[,const-expr]</i></p>
<p>Assigns the specified identifier<i> ident</i> to a common area of<i> const-expr</i> bytes in length and causes</p>
<p><i>ident</i> to be visible externally. If<i> ident</i> is not defined by another relocatable object file, the linker</p>
<p>assigns space for the identifier in the</p>
<p>.zbss</p>
<p>section. The optional<i> const-expr</i> specifies the</p>
<p>variable alignment in bytes.</p>
<p><i>425</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Symbol Definition Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Symbolic Debugging Directives</b></p>
<p>These directives are used for symbolic debugging.</p>
<p>.endo<i> ident</i></p>
<p>Marks the end of a data object that sets both the type and size of the object symbol. The</p>
<p>.endo</p>
<p>directive is equivalent to using the</p>
<p>.type</p>
<p>and</p>
<p>.size</p>
<p>directives individually. Specifically,</p>
<p>.endo<i> ident</i></p>
<p>is equivalent to:</p>
<p>.type ident, $object</p>
<p>.size ident, .-ident</p>
<p>.file &quot;<i>string</i>&quot;</p>
<p>Stores source filename<i> string</i> in the object file symbol table. The<i> string</i> filename must be</p>
<p>delimited by double quotation marks. Use this directive no more than once per file.</p>
<p>.fsize<i> func</i>,<i> const</i></p>
<p>Specifies that the frame size for the current function is<i> const</i> bytes in size. This information may</p>
<p>be useful in certain situations when debugging call stacks involving assembly functions.</p>
<p>You must place this directive within the scope of the current function, before you define the</p>
<p>next function. The optional<i> func</i> parameter can be used to specify the current function's name.</p>
<p>Values specified with</p>
<p>.fsize</p>
<p>may also be used by<b> gstack</b> when no</p>
<p>.maxstack</p>
<p>directive is</p>
<p>present. We recommend using</p>
<p>.maxstack</p>
<p>, especially when the function allocates additional</p>
<p>stack after its frame has been set up. Use of</p>
<p>.fsize</p>
<p>for this purpose may be deprecated in the</p>
<p>future.</p>
<p>.maxinstances [<i>func,</i>]<i> const</i></p>
<p>Specifies the maximum number of instances<i> const</i> of the function<i> func</i> that can exist on the</p>
<p>stack at a given time. This information is used to provide<b> gstack</b> with an upper bound on possible</p>
<p>recursions so it can accurately compute the maximum stack usage of the program. You must</p>
<p>place this directive within the scope of the current function, before you define the next function.</p>
<p>The optional<i> func</i> parameter specifies the current function's name. For more information, see</p>
<p>âAnnotating Recursive Functionsâ on page 610.</p>
<p>.maxstack<i> func, const</i></p>
<p>Specifies that<i> func</i> uses no more than<i> const</i> bytes of stack. This information allows<b> gstack</b> to</p>
<p>compute accurate results for paths that involve calls to assembly functions. You must place this</p>
<p>directive within the scope of the current function, before you define the next function.</p>
<p>.nodebug</p>
<p>Turns off debugging.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>426</i></p>
<p><i>Chapter 7. Assembler Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.scall<i> func</i>,<i> dest</i></p>
<p>Specifies that<i> func</i> makes a static call to<i> dest</i>. This information helps<b> gstack</b> compute the</p>
<p>maximum stack size that the program might use. It also helps the Debugger generate a call</p>
<p>graph.</p>
<p>To indicate that<i> func</i> makes no static calls, use</p>
<p>0</p>
<p>or</p>
<p>__leaf__</p>
<p>for<i> dest</i>.</p>
<p>You can use multiple</p>
<p>.scall</p>
<p>directives to specify multiple calls for a single function, however,</p>
<p>if you use</p>
<p>0</p>
<p>or</p>
<p>__leaf__</p>
<p>, you must use just one</p>
<p>.scall</p>
<p>directive for<i> func</i>.</p>
<p>.size<i> ident</i>,<i> const-expr</i></p>
<p>Specifies the size,<i> const-expr</i>, of the function or data object<i> ident</i>. To successfully debug an</p>
<p>assembly language source file, it should either be assembled with the<b> -g</b> driver option, (which</p>
<p>outputs full debug symbols) or else a</p>
<p>.size</p>
<p>directive should be used to specify the size of each</p>
<p>function.</p>
<p>The</p>
<p>.size</p>
<p>directive should appear at the end of the function, just after the last assembly language</p>
<p>statement in the function. It should be of the form:</p>
<p>.size<i> ident</i>,.-<i>ident</i></p>
<p>where<i> ident</i> is the name of the function. The expression</p>
<p>.-<i>ident</i></p>
<p>will be equal to the size of</p>
<p>the function in bytes, allowing the creation of correct debugging information.</p>
<p>Use this directive when defining each symbol for function deletion to work properly.</p>
<p>.type<i> ident</i>, [ @function | @object ]</p>
<p>Specifies whether the symbol<i> ident</i> is a function or a data object. The</p>
<p>.type</p>
<p>directive is usually</p>
<p>used in conjunction with the</p>
<p>.size</p>
<p>directive to define a function or data object.</p>
<p>Use this directive when defining each symbol to get the best debugging information, and for</p>
<p>function deletion to work properly.</p>
<p><i>427</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Symbolic Debugging Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Miscellaneous Directives</b></p>
<p>.assert<i> integral-const</i></p>
<p>Gives an error if<i> integral-const</i> evaluates to false.</p>
<p>.ident &quot;<i>string</i>&quot;</p>
<p>Adds<i> string</i> to the</p>
<p>.comment</p>
<p>section within the object file. The</p>
<p>.comment</p>
<p>section is not</p>
<p>allocatable; it does not occupy memory on the target.</p>
<p>.need<i> ident</i></p>
<p>Defines a relationship between the function<i> ident</i> and the current function. The linker will not</p>
<p>delete the function<i> ident</i> as long as the current function is used, even if<i> ident</i> is not used. Suppose</p>
<p>a source file contains the following:</p>
<p>myfunc:</p>
<p>.need otherfunc</p>
<p>-- Insert assembly function here</p>
<p>The linker will not delete the function</p>
<p>otherfunc</p>
<p>, even if it is unused, because it is needed by</p>
<p>the function</p>
<p>myfunc</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>428</i></p>
<p><i>Chapter 7. Assembler Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>RH850 Directives</b></p>
<p>.rh850_flags<i> flags</i></p>
<p>Instructs the assembler on which RH850 ABI capabilities are supported in the current file. Please</p>
<p>refer to the RH850 ABI from Renesas Electronics for details. Depending on which flags are</p>
<p>specified, options may be set in the ELF E_FLAGS field of the current object file's ELF header,</p>
<p>or in the ABI features section of the</p>
<p>.note.renesas</p>
<p>ELF section of the current object file.</p>
<p>This option is only meaningful when targeting RH850 and later processors. Flags are specified</p>
<p>as a comma-separated list, with possible flags being:</p>
<p>Sets the ABI-conforming flag corresponding to cache usage.</p>
<p>CACHE</p>
<p>Sets the ABI-conforming flag which indicated an 8-byte aligned stack</p>
<p>and 8-byte aligned 64-bit types (e.g.: double, long long).</p>
<p>DATA_ALIGN8</p>
<p>Sets the ABI-conforming flag which indicated a 4-byte aligned stack</p>
<p>and 4-byte aligned 64-bit types (e.g.: double, long long).</p>
<p>DATA_ALIGN4</p>
<p>Sets the ABI-conforming flag corresponding to double-precision floating</p>
<p>point usage (see âFloating-Point Modeâ on page 132).</p>
<p>DOUBLE</p>
<p>Sets the ABI-conforming flag corresponding to double-precision floating</p>
<p>point usage (see âTreat Doubles as Singlesâ on page 133). Indicates that</p>
<p>double and long double types are four bytes in size.</p>
<p>DOUBLE32</p>
<p>Sets the ABI-conforming flag corresponding to double-precision floating</p>
<p>point usage (see âTreat Doubles as Singlesâ on page 133). Indicates that</p>
<p>double and long double types are eight bytes in size.</p>
<p>DOUBLE64</p>
<p>Sets the ABI-conforming flag that indicates that the</p>
<p>EP</p>
<p>(</p>
<p>r30</p>
<p>) register</p>
<p>was reserved for the TDA or not used for allocation (see âSpecial Data</p>
<p>Area Optimizationsâ on page 96 and âAllocate Pointers to the EP</p>
<p>Registerâ on page 152).</p>
<p>EP_FIX</p>
<p>Sets the ABI-conforming flag that indicates that the</p>
<p>EP</p>
<p>(</p>
<p>r30</p>
<p>) register</p>
<p>was not reserved for the TDA and was used for allocation (see âSpecial</p>
<p>Data Area Optimizationsâ on page 96 and âAllocate Pointers to the EP</p>
<p>Registerâ on page 152).</p>
<p>EP_NONFIX</p>
<p>Sets the ABI-conforming flag corresponding to single-precision floating</p>
<p>point usage (see âFloating-Point Modeâ on page 132).</p>
<p>FLOAT</p>
<p>Sets the ABI-conforming flag that indicates that FPSIMD unit is in use</p>
<p>and is in Full Register Configuration mode (see âFloating-Point SIMDâ</p>
<p>on page 157).</p>
<p>FPSIMD_FULL</p>
<p>Sets the ABI-conforming flag that indicates that FPSIMD unit is in use</p>
<p>and is in Half Register Configuration mode (see âFloating-Point SIMDâ</p>
<p>on page 157).</p>
<p>FPSIMD_HALF</p>
<p>Sets the ABI-conforming flag corresponding to FPU instruction (either</p>
<p>single-precision floating point or double-precision floating point) usage.</p>
<p>FPUCOMMON</p>
<p><i>429</i></p>
<p><i>Green Hills Software</i></p>
<p><i>RH850 Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Sets the ABI-conforming flag corresponding to FPU 2.0 only instruction</p>
<p>usage.</p>
<p>FPU20</p>
<p>Sets the ABI-conforming flag corresponding to FPU 3.0 only instruction</p>
<p>usage.</p>
<p>FPU30</p>
<p>Sets the ABI-conforming flag that indicates that the object file was built</p>
<p>for a RH850G3M core.</p>
<p>G3M</p>
<p>Sets the ABI-conforming flag that indicates that the object file was built</p>
<p>for a RH850G3K core.</p>
<p>G3K</p>
<p>Sets the ABI-conforming flag that indicates that the</p>
<p>GP</p>
<p>(</p>
<p>r4</p>
<p>) register</p>
<p>was reserved for the SDA (see âSpecial Data Area Optimizationsâ</p>
<p>on page 96) or PID.</p>
<p>GP_FIX</p>
<p>Sets the ABI-conforming flag that indicates that the</p>
<p>GP</p>
<p>(</p>
<p>r4</p>
<p>) register</p>
<p>was not reserved for the SDA (see âSpecial Data Area Optimizationsâ</p>
<p>on page 96) nor PID and was used for allocation.</p>
<p>GP_NONFIX</p>
<p>Sets the GHS-specific flag that indicates that loads and stores may be</p>
<p>misaligned (see âMisaligned Memory Accessâ on page 216).</p>
<p>GHS_MISALIGN</p>
<p>Sets the ABI-conforming flag corresponding to usage of the memory</p>
<p>management unit.</p>
<p>MMU</p>
<p>Sets the ABI-conforming flag that indicates that the</p>
<p>R2</p>
<p>register was</p>
<p>reserved (see âRegister r2â on page 129).</p>
<p>REG2_RESERVE</p>
<p>Sets the ABI-conforming flag that indicates that the</p>
<p>R2</p>
<p>register was not</p>
<p>reserved and was used for allocation(see âRegister r2â on page 129).</p>
<p>REG2_NONRESERVE</p>
<p>Sets the ABI-conforming flag corresponding to usage of the 22 register</p>
<p>mode (see âRegister Modeâ on page 130).</p>
<p>REGMODE22</p>
<p>Sets the ABI-conforming flag corresponding to usage of the 32 register</p>
<p>mode (see âRegister Modeâ on page 130).</p>
<p>REGMODE32</p>
<p>Sets the ABI-conforming flag corresponding to SIMD unit usage (see</p>
<p>âEnable SIMD instructions (RH850 and later)â on page 155).</p>
<p>SIMD</p>
<p>Sets the ABI-conforming flag that indicates that the</p>
<p>TP</p>
<p>(</p>
<p>r5</p>
<p>) register</p>
<p>was reserved for the ROSDA (see âSpecial Data Area Optimizationsâ</p>
<p>on page 96).</p>
<p>TP_FIX</p>
<p>Sets the ABI-conforming flag that indicates that the</p>
<p>TP</p>
<p>(</p>
<p>r5</p>
<p>) register</p>
<p>was not reserved for the ROSDA (see âSpecial Data Area</p>
<p>Optimizationsâ on page 96) and was used for allocation.</p>
<p>TP_NONFIX</p>
<p>Sets the ABI-conforming flag corresponding to virtualization or</p>
<p>hardware multi-threading unit usage.</p>
<p>VM_HWMT</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>430</i></p>
<p><i>Chapter 7. Assembler Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>Many of the flags referenced above are set automatically either by the</p>
<p>compiler or assembler based on command line arguments.</p>
<p><i>431</i></p>
<p><i>Green Hills Software</i></p>
<p><i>RH850 Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 8</b></p>
<p><b>V850 Assembler Reference</b></p>
<p><b>Contents</b></p>
<p>Reserved Symbols . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>434</p>
<p>Register Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>434</p>
<p>Addressing Modes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>443</p>
<p>Macro Expansion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>449</p>
<p>Programming in Assembly Language . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>457</p>
<p>Bitfields . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>468</p>
<h1 style="page-break-before:always; "></h1>
<p>This chapter provides detailed information about the V850 addressing modes and</p>
<p>instruction formats for writing and maintaining Green Hills V850 assembler code,</p>
<p>with a complete alphabetical listing of all V850 instructions. For additional</p>
<p>information, refer to the<i> V850 Design Specification</i> and<i> V850 Instruction Set</i>, which</p>
<p>cover related topics such as instruction set and exception handling.</p>
<p><b>Reserved Symbols</b></p>
<p>The following identifiers are part of the fundamental assembly language and, as</p>
<p>such, are reserved symbols in addition to those mentioned in âRelocation Expression</p>
<p>Operatorsâ on page 404. These symbols and their meanings are below.</p>
<p><b>Meaning</b></p>
<p><b>Identifier</b></p>
<p>Integer registers</p>
<p>r0</p>
<p>â</p>
<p>r31</p>
<p>Zero register (</p>
<p>r0</p>
<p>)</p>
<p>zero</p>
<p>Handler stack pointer (</p>
<p>r2</p>
<p>)</p>
<p>hp</p>
<p>Stack pointer (</p>
<p>r3</p>
<p>)</p>
<p>sp</p>
<p>Global pointer (</p>
<p>r4</p>
<p>)</p>
<p>gp</p>
<p>Text pointer (</p>
<p>r5</p>
<p>)</p>
<p>tp</p>
<p>Element pointer (</p>
<p>r30</p>
<p>)</p>
<p>ep</p>
<p>Link pointer (</p>
<p>r31</p>
<p>)</p>
<p>lp</p>
<p><b>Register Sets</b></p>
<p>There are two types of registers explained in detail below: general and system.</p>
<p><b>General Registers</b></p>
<p>There are 32 general purpose registers, each 32 bits wide. Although only</p>
<p>r0</p>
<p>has a</p>
<p>special usage at the hardware level, a convention was established where the following</p>
<p>V850 general registers have reserved usage at the software level:</p>
<p><b>Usage</b></p>
<p><b>Register names</b></p>
<p>Always contains the value zero. Any write to</p>
<p>r0</p>
<p>is ignored.</p>
<p>r0</p>
<p>(</p>
<p>zero</p>
<p>)</p>
<p>Reserved for the compiler or assembler.</p>
<p>r1</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>434</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Usage</b></p>
<p><b>Register names</b></p>
<p>Temporary register.</p>
<p>r2</p>
<p>(</p>
<p>hp</p>
<p>)</p>
<p>Stack pointer.</p>
<p>r3</p>
<p>(</p>
<p>sp</p>
<p>)</p>
<p>Global pointer.</p>
<p>r4</p>
<p>(</p>
<p>gp</p>
<p>)</p>
<p>Read-only small data pointer.</p>
<p>r5</p>
<p>Parameter registers.</p>
<p>r6</p>
<p>â</p>
<p>r9</p>
<p>Return register. (32-bit data)</p>
<p>r10</p>
<p>Return registers. (64-bit data)</p>
<p>r10</p>
<p>,</p>
<p>r11</p>
<p>Temporary registers.</p>
<p>r10</p>
<p>â</p>
<p>r19</p>
<p>Permanent registers.</p>
<p>r20</p>
<p>â</p>
<p>r29</p>
<p>Element pointer</p>
<p>r30</p>
<p>(</p>
<p>ep</p>
<p>)</p>
<p>Procedure return pointer.</p>
<p>r31</p>
<p>(</p>
<p>lp</p>
<p>)</p>
<p>The</p>
<p>jarl<i> routine</i>, lp</p>
<p>instruction overwrites the contents of register</p>
<p>lp</p>
<p>(</p>
<p>r31</p>
<p>)</p>
<p>with the return address generated by the call. However, the contents of</p>
<p>lp</p>
<p>may also</p>
<p>be overwritten by software if required.</p>
<p>If an instruction uses</p>
<p>r1</p>
<p>or writes to</p>
<p>r0</p>
<p>, the V850 assembler<b> as850</b> outputs a warning</p>
<p>message by default. You can suppress this warning message with the<b> -w</b> option.</p>
<p>By default, the V850 driver<b> ccv850</b> disables warnings. If you want to enable</p>
<p>assembler warnings, pass<b> --assembler_warnings</b> to the driver.</p>
<p>The V850 Tool Chain supports three software modes of register usage: 32 registers</p>
<p>(default), 26 registers (<b>ccv850</b> driver option:<b> -registermode=26</b>), and 22 registers</p>
<p>(<b>ccv850</b> driver option:<b> -registermode=22</b>). For more information, see âRegister</p>
<p>Usageâ on page 33.</p>
<p><b>SIMD Vector Registers</b></p>
<p>There are 32 vector registers on RH850 processors equipped with a SIMD</p>
<p>coprocessor. Each vector register is 64 bits wide. These registers, represented as</p>
<p>vr0</p>
<p>â</p>
<p>vr31</p>
<p>in the assembler, are all treated as temporary registers.</p>
<p><i>435</i></p>
<p><i>Green Hills Software</i></p>
<p><i>SIMD Vector Registers</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>FPSIMD Vector Registers</b></p>
<p>There are 32 vector registers on RH850 processors equipped with a FPSIMD</p>
<p>coprocessor. Each vector register is 128 bits wide. These registers, represented as</p>
<p>wr0</p>
<p>â</p>
<p>wr31</p>
<p>in the assembler, are all treated as temporary registers.</p>
<p>When the FPSIMD is enabled in Half Register Configuration mode, constraints</p>
<p>exist on the vector registers usage. See âFloating-Point SIMDâ on page 157 for more</p>
<p>information.</p>
<p><b>System Registers</b></p>
<p>There are 32 system registers, all 32-bits wide:</p>
<p><b>Usage</b></p>
<p><b>Name</b></p>
<p><b>Register ID</b></p>
<p>Exception/interrupt</p>
<p>PC</p>
<p>EIPC</p>
<p>0</p>
<p>Exception/interrupt</p>
<p>PSW</p>
<p>EIPSW</p>
<p>1</p>
<p>Fatal error</p>
<p>PC</p>
<p>FEPC</p>
<p>2</p>
<p>Fatal error</p>
<p>PSW</p>
<p>FEPSW</p>
<p>3</p>
<p>Exception cause register (read-only)</p>
<p>ECR</p>
<p>4</p>
<p>Program status word</p>
<p>PSW</p>
<p>5</p>
<p>In addition to the V850 system registers, the following system registers are valid</p>
<p>on the V850E:</p>
<p><b>Usage</b></p>
<p><b>Name</b></p>
<p><b>Register ID</b></p>
<p>callt PC</p>
<p>CTPC</p>
<p>16</p>
<p>callt PSW</p>
<p>CTPSW</p>
<p>17</p>
<p>Exception / debug trap</p>
<p>PC</p>
<p>DBPC</p>
<p>18</p>
<p>Exception / debug trap</p>
<p>PSW</p>
<p>DBPSW</p>
<p>19</p>
<p>callt</p>
<p>base pointer</p>
<p>CTBP</p>
<p>20</p>
<p>In addition to the V850E system registers, the following system registers are valid</p>
<p>on the V850E2:</p>
<p><b>Usage</b></p>
<p><b>Name</b></p>
<p><b>Register ID</b></p>
<p>Debug interface register</p>
<p>DIR</p>
<p>21</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>436</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The V850E2R and V850E2V3 processors introduced the concept of register banks,</p>
<p>selected via the new</p>
<p>BSEL</p>
<p>register. Although the ability to access the system registers</p>
<p>now depends on the current value of the</p>
<p>BSEL</p>
<p>register, the same symbolic names</p>
<p>supported with the V850E and their associated register ID values are made available</p>
<p>for use with instructions that require a system register operand, as are the additional</p>
<p>symbolic names below. However, the assembler assumes the user will have set the</p>
<p>BSEL</p>
<p>register to the appropriate register bank first.</p>
<p><b>Usage</b></p>
<p><b>Name</b></p>
<p><b>Register ID</b></p>
<p>EI level exception cause</p>
<p>EIIC</p>
<p>13</p>
<p>FE level exception cause</p>
<p>FEIC</p>
<p>14</p>
<p>DB level exception cause</p>
<p>DBIC</p>
<p>15</p>
<p>EI level exception working register</p>
<p>EIWR</p>
<p>28</p>
<p>FE level exception working register</p>
<p>FEWR</p>
<p>29</p>
<p>DB level exception working register</p>
<p>DBWR</p>
<p>30</p>
<p>Register bank selection</p>
<p>BSEL</p>
<p>31</p>
<p>Floating-point configuration/status</p>
<p>FPSR</p>
<p>6</p>
<p>Floating-point exception PC</p>
<p>FPEPC</p>
<p>7</p>
<p>Floating-point operation status</p>
<p>FPST</p>
<p>8</p>
<p>Floating-point comparison result</p>
<p>FPCC</p>
<p>9</p>
<p>Floating-point operation configuration</p>
<p>FPCFG</p>
<p>10</p>
<p>For a description of the purpose of each register, please refer to the appropriate</p>
<p>Design Specification documentation from Renesas Electronics.</p>
<p>The RH850 and newer processors replaced the old</p>
<p>BSEL</p>
<p>banked approach with</p>
<p>register groups. Rather than manipulating a register such as</p>
<p>BSEL</p>
<p>to select a register</p>
<p>group, the register group is now specified directly in the load or store instruction</p>
<p>used to access the register. The following table lists the symbolic names for these</p>
<p>registers supported by the RH850 assembler. When using these symbolic names,</p>
<p>users should not specify the group number in the instruction, as the assembler will</p>
<p>set it appropriately.</p>
<p><b>Usage</b></p>
<p><b>Name</b></p>
<p><b>Register</b></p>
<p><b>Number</b></p>
<p><b>Group</b></p>
<p><b>Number</b></p>
<p>Exception/Interrupt</p>
<p>PC</p>
<p>EIPC</p>
<p>0</p>
<p>0</p>
<p>Exception/Interrupt</p>
<p>PSW</p>
<p>EIPSW</p>
<p>1</p>
<p>0</p>
<p><i>437</i></p>
<p><i>Green Hills Software</i></p>
<p><i>System Registers</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Usage</b></p>
<p><b>Name</b></p>
<p><b>Register</b></p>
<p><b>Number</b></p>
<p><b>Group</b></p>
<p><b>Number</b></p>
<p>Fatal Error</p>
<p>PC</p>
<p>FEPC</p>
<p>2</p>
<p>0</p>
<p>Fatal Error</p>
<p>PSW</p>
<p>FEPSW</p>
<p>3</p>
<p>0</p>
<p>Program status word</p>
<p>PSW</p>
<p>5</p>
<p>0</p>
<p>Floating-point configuration/status register</p>
<p>FPSR</p>
<p>6</p>
<p>0</p>
<p>Floating-point exception</p>
<p>PC</p>
<p>FPEPC</p>
<p>7</p>
<p>0</p>
<p>Floating-point status</p>
<p>FPST</p>
<p>8</p>
<p>0</p>
<p>Floating-point comparison result</p>
<p>FPCC</p>
<p>9</p>
<p>0</p>
<p>Floating-point configuration</p>
<p>FPCFG</p>
<p>10</p>
<p>0</p>
<p>Floating-point exception control</p>
<p>FPEC</p>
<p>11</p>
<p>0</p>
<p>SIMD operation settings and status</p>
<p>SESR</p>
<p>12</p>
<p>0</p>
<p>EI level exception cause</p>
<p>EIIC</p>
<p>13</p>
<p>0</p>
<p>FE level exception cause</p>
<p>FEIC</p>
<p>14</p>
<p>0</p>
<p>callt PC</p>
<p>save register</p>
<p>CTPC</p>
<p>16</p>
<p>0</p>
<p>callt PSW</p>
<p>save register</p>
<p>CTPSW</p>
<p>17</p>
<p>0</p>
<p>callt</p>
<p>base pointer</p>
<p>CTBP</p>
<p>20</p>
<p>0</p>
<p>EI level exception working register</p>
<p>EIWR</p>
<p>28</p>
<p>0</p>
<p>FE level exception working register</p>
<p>FEWR</p>
<p>29</p>
<p>0</p>
<p>DB level exception working register</p>
<p>DBWR</p>
<p>30</p>
<p>0</p>
<p>Bank select. Reserved for backwards compatibility</p>
<p>on the RH850 only. This register is ignored by the</p>
<p>hardware</p>
<p>BSEL</p>
<p>31</p>
<p>0</p>
<p>CPU configuration</p>
<p>MCFG0</p>
<p>0</p>
<p>1</p>
<p>CPU configuration</p>
<p>MCFG1</p>
<p>1</p>
<p>1</p>
<p>Reset vector base address</p>
<p>RBASE</p>
<p>2</p>
<p>1</p>
<p>Exception handler vector address</p>
<p>EBASE</p>
<p>3</p>
<p>1</p>
<p>Interrupt handler address table base address</p>
<p>INTBP</p>
<p>4</p>
<p>1</p>
<p>CPU control</p>
<p>MCTL</p>
<p>5</p>
<p>1</p>
<p>Processor ID</p>
<p>PID</p>
<p>6</p>
<p>1</p>
<p>FPI exception interrupt priority setting</p>
<p>FPIPR</p>
<p>7</p>
<p>1</p>
<p>Hardware thread selection</p>
<p>TCSEL</p>
<p>10</p>
<p>1</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>438</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Usage</b></p>
<p><b>Name</b></p>
<p><b>Register</b></p>
<p><b>Number</b></p>
<p><b>Group</b></p>
<p><b>Number</b></p>
<p>SYSCALL</p>
<p>operation setting</p>
<p>SCCFG</p>
<p>11</p>
<p>1</p>
<p>SYSCALL</p>
<p>base pointer</p>
<p>SCBP</p>
<p>12</p>
<p>1</p>
<p>HVCALL</p>
<p>configuration</p>
<p>HVCCFG</p>
<p>13</p>
<p>1</p>
<p>HVCALL</p>
<p>base pointer</p>
<p>HVCBP</p>
<p>14</p>
<p>1</p>
<p>Virtual machine context selection</p>
<p>VCSEL</p>
<p>15</p>
<p>1</p>
<p>Virtual machine hardware thread assignment</p>
<p>VMPRT0</p>
<p>16</p>
<p>1</p>
<p>Virtual machine hardware thread assignment</p>
<p>VMPRT1</p>
<p>17</p>
<p>1</p>
<p>Virtual machine hardware schedule</p>
<p>VMSCCTL</p>
<p>23</p>
<p>1</p>
<p>Virtual machine schedule table setting</p>
<p>VMSCTBL0</p>
<p>24</p>
<p>1</p>
<p>Virtual machine schedule table setting</p>
<p>VMSCTBL1</p>
<p>25</p>
<p>1</p>
<p>Virtual machine schedule table setting</p>
<p>VMSCTBL2</p>
<p>26</p>
<p>1</p>
<p>Virtual machine schedule table setting</p>
<p>VMSCTBL3</p>
<p>27</p>
<p>1</p>
<p>Thread configuration</p>
<p>HTCFG0</p>
<p>0</p>
<p>2</p>
<p>Hardware thread control</p>
<p>HTCTL</p>
<p>5</p>
<p>2</p>
<p>Memory error address</p>
<p>MEA</p>
<p>6</p>
<p>2</p>
<p>Address space ID</p>
<p>ASID</p>
<p>7</p>
<p>2</p>
<p>Memory error information</p>
<p>MEI</p>
<p>8</p>
<p>2</p>
<p>Priority of interrupt being served</p>
<p>ISPR</p>
<p>10</p>
<p>2</p>
<p>Interrupt priority masking</p>
<p>PMR</p>
<p>11</p>
<p>2</p>
<p>Interrupt control status</p>
<p>ICSR</p>
<p>12</p>
<p>2</p>
<p>Interrupt function setting</p>
<p>INTCFG</p>
<p>13</p>
<p>2</p>
<p>TLB disable setting</p>
<p>TLBSCH</p>
<p>16</p>
<p>2</p>
<p>Hardware thread schedule setting</p>
<p>HTSCCTL</p>
<p>23</p>
<p>2</p>
<p>Hardware thread schedule table</p>
<p>HTSCTBL0</p>
<p>24</p>
<p>2</p>
<p>Hardware thread schedule table</p>
<p>HTSCTBL1</p>
<p>25</p>
<p>2</p>
<p>Hardware thread schedule table</p>
<p>HTSCTBL2</p>
<p>26</p>
<p>2</p>
<p>Hardware thread schedule table</p>
<p>HTSCTBL3</p>
<p>27</p>
<p>2</p>
<p>Hardware thread schedule table</p>
<p>HTSCTBL4</p>
<p>28</p>
<p>2</p>
<p>Hardware thread schedule table</p>
<p>HTSCTBL5</p>
<p>29</p>
<p>2</p>
<p><i>439</i></p>
<p><i>Green Hills Software</i></p>
<p><i>System Registers</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Usage</b></p>
<p><b>Name</b></p>
<p><b>Register</b></p>
<p><b>Number</b></p>
<p><b>Group</b></p>
<p><b>Number</b></p>
<p>Hardware thread schedule table</p>
<p>HTSCTBL6</p>
<p>30</p>
<p>2</p>
<p>Hardware thread schedule table</p>
<p>HTSCTBL7</p>
<p>31</p>
<p>2</p>
<p>TLB operation target index</p>
<p>TLBIDX</p>
<p>0</p>
<p>4</p>
<p>TLB entry Lo-side access control</p>
<p>TELO0</p>
<p>4</p>
<p>4</p>
<p>TLB entry Lo-side access control</p>
<p>TELO1</p>
<p>5</p>
<p>4</p>
<p>TLB entry Hi-side access control</p>
<p>TEHI0</p>
<p>6</p>
<p>4</p>
<p>TLB entry Hi-side access control</p>
<p>TEHI1</p>
<p>7</p>
<p>4</p>
<p>TLB configuration</p>
<p>TLBCFG</p>
<p>10</p>
<p>4</p>
<p>Bus write access error Lo</p>
<p>BWERRL</p>
<p>12</p>
<p>4</p>
<p>Bus write access error Hi</p>
<p>BWERRH</p>
<p>13</p>
<p>4</p>
<p>Bus read access error Lo</p>
<p>BRERRL</p>
<p>14</p>
<p>4</p>
<p>Bus read access error Hi</p>
<p>BRERRH</p>
<p>15</p>
<p>4</p>
<p>Instruction cache tag Lo access</p>
<p>ICTAGL</p>
<p>16</p>
<p>4</p>
<p>Instruction cache tag Hi access</p>
<p>ICTAGH</p>
<p>17</p>
<p>4</p>
<p>Instruction cache data Lo access</p>
<p>ICDATL</p>
<p>18</p>
<p>4</p>
<p>Instruction cache data Hi access</p>
<p>ICDATH</p>
<p>19</p>
<p>4</p>
<p>Data cache tag Lo access</p>
<p>DCTAGL</p>
<p>20</p>
<p>4</p>
<p>Data cache tag Hi access</p>
<p>DCTAGH</p>
<p>21</p>
<p>4</p>
<p>Data cache data Lo access</p>
<p>DCDATL</p>
<p>22</p>
<p>4</p>
<p>Data cache data Hi access</p>
<p>DCDATH</p>
<p>23</p>
<p>4</p>
<p>Instruction cache control</p>
<p>ICCTRL</p>
<p>24</p>
<p>4</p>
<p>Data cache control</p>
<p>DCCTRL</p>
<p>25</p>
<p>4</p>
<p>Instruction cache configuration</p>
<p>ICCFG</p>
<p>26</p>
<p>4</p>
<p>Data cache configuration</p>
<p>DCCFG</p>
<p>27</p>
<p>4</p>
<p>Instruction cache error</p>
<p>ICERR</p>
<p>28</p>
<p>4</p>
<p>Data cache error</p>
<p>DCERR</p>
<p>29</p>
<p>4</p>
<p>Memory protection operation mode setting</p>
<p>MPM</p>
<p>0</p>
<p>5</p>
<p>MPU region control</p>
<p>MPRC</p>
<p>1</p>
<p>5</p>
<p>MPU base region number</p>
<p>MPBRGN</p>
<p>4</p>
<p>5</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>440</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Usage</b></p>
<p><b>Name</b></p>
<p><b>Register</b></p>
<p><b>Number</b></p>
<p><b>Group</b></p>
<p><b>Number</b></p>
<p>MPU end region number</p>
<p>MPTRGN</p>
<p>5</p>
<p>5</p>
<p>Memory protection setting check address</p>
<p>MCA</p>
<p>8</p>
<p>5</p>
<p>Memory protection setting check size</p>
<p>MCS</p>
<p>9</p>
<p>5</p>
<p>Memory protection setting check command</p>
<p>MCC</p>
<p>10</p>
<p>5</p>
<p>Memory protection setting check result</p>
<p>MCR</p>
<p>11</p>
<p>5</p>
<p>MPU violation address</p>
<p>MPVADR</p>
<p>17</p>
<p>5</p>
<p>Protection area assignment</p>
<p>MPPRT0</p>
<p>20</p>
<p>5</p>
<p>Protection area assignment</p>
<p>MPPRT1</p>
<p>21</p>
<p>5</p>
<p>Protection area assignment</p>
<p>MPPRT2</p>
<p>22</p>
<p>5</p>
<p>Protection area minimum address</p>
<p>MPLA0</p>
<p>0</p>
<p>6</p>
<p>Protection area maximum address</p>
<p>MPUA0</p>
<p>1</p>
<p>6</p>
<p>Protection area attribute</p>
<p>MPAT0</p>
<p>2</p>
<p>6</p>
<p>Protection area minimum address</p>
<p>MPLA1</p>
<p>4</p>
<p>6</p>
<p>Protection area maximum address</p>
<p>MPUA1</p>
<p>5</p>
<p>6</p>
<p>Protection area attribute</p>
<p>MPAT1</p>
<p>6</p>
<p>6</p>
<p>Protection area minimum address</p>
<p>MPLA2</p>
<p>8</p>
<p>6</p>
<p>Protection area maximum address</p>
<p>MPUA2</p>
<p>9</p>
<p>6</p>
<p>Protection area attribute</p>
<p>MPAT2</p>
<p>10</p>
<p>6</p>
<p>Protection area minimum address</p>
<p>MPLA3</p>
<p>12</p>
<p>6</p>
<p>Protection area maximum address</p>
<p>MPUA3</p>
<p>13</p>
<p>6</p>
<p>Protection area attribute</p>
<p>MPAT3</p>
<p>14</p>
<p>6</p>
<p>Protection area minimum address</p>
<p>MPLA4</p>
<p>16</p>
<p>6</p>
<p>Protection area maximum address</p>
<p>MPUA4</p>
<p>17</p>
<p>6</p>
<p>Protection area attribute</p>
<p>MPAT4</p>
<p>18</p>
<p>6</p>
<p>Protection area minimum address</p>
<p>MPLA5</p>
<p>20</p>
<p>6</p>
<p>Protection area maximum address</p>
<p>MPUA5</p>
<p>21</p>
<p>6</p>
<p>Protection area attribute</p>
<p>MPAT5</p>
<p>22</p>
<p>6</p>
<p>Protection area minimum address</p>
<p>MPLA6</p>
<p>24</p>
<p>6</p>
<p>Protection area maximum address</p>
<p>MPUA6</p>
<p>25</p>
<p>6</p>
<p><i>441</i></p>
<p><i>Green Hills Software</i></p>
<p><i>System Registers</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Usage</b></p>
<p><b>Name</b></p>
<p><b>Register</b></p>
<p><b>Number</b></p>
<p><b>Group</b></p>
<p><b>Number</b></p>
<p>Protection area attribute</p>
<p>MPAT6</p>
<p>26</p>
<p>6</p>
<p>Protection area minimum address</p>
<p>MPLA7</p>
<p>28</p>
<p>6</p>
<p>Protection area maximum address</p>
<p>MPUA7</p>
<p>29</p>
<p>6</p>
<p>Protection area attribute</p>
<p>MPAT7</p>
<p>30</p>
<p>6</p>
<p>Protection area minimum address</p>
<p>MPLA8</p>
<p>0</p>
<p>7</p>
<p>Protection area maximum address</p>
<p>MPUA8</p>
<p>1</p>
<p>7</p>
<p>Protection area attribute</p>
<p>MPAT8</p>
<p>2</p>
<p>7</p>
<p>Protection area minimum address</p>
<p>MPLA9</p>
<p>4</p>
<p>7</p>
<p>Protection area maximum address</p>
<p>MPUA9</p>
<p>5</p>
<p>7</p>
<p>Protection area attribute</p>
<p>MPAT9</p>
<p>6</p>
<p>7</p>
<p>Protection area minimum address</p>
<p>MPLA10</p>
<p>8</p>
<p>7</p>
<p>Protection area maximum address</p>
<p>MPUA10</p>
<p>9</p>
<p>7</p>
<p>Protection area attribute</p>
<p>MPAT10</p>
<p>10</p>
<p>7</p>
<p>Protection area minimum address</p>
<p>MPLA11</p>
<p>12</p>
<p>7</p>
<p>Protection area maximum address</p>
<p>MPUA11</p>
<p>13</p>
<p>7</p>
<p>Protection area attribute</p>
<p>MPAT11</p>
<p>14</p>
<p>7</p>
<p>Protection area minimum address</p>
<p>MPLA12</p>
<p>16</p>
<p>7</p>
<p>Protection area maximum address</p>
<p>MPUA12</p>
<p>17</p>
<p>7</p>
<p>Protection area attribute</p>
<p>MPAT12</p>
<p>18</p>
<p>7</p>
<p>Protection area minimum address</p>
<p>MPLA13</p>
<p>20</p>
<p>7</p>
<p>Protection area maximum address</p>
<p>MPUA13</p>
<p>21</p>
<p>7</p>
<p>Protection area attribute</p>
<p>MPAT13</p>
<p>22</p>
<p>7</p>
<p>Protection area minimum address</p>
<p>MPLA14</p>
<p>24</p>
<p>7</p>
<p>Protection area maximum address</p>
<p>MPUA14</p>
<p>25</p>
<p>7</p>
<p>Protection area attribute</p>
<p>MPAT14</p>
<p>26</p>
<p>7</p>
<p>Protection area minimum address</p>
<p>MPLA15</p>
<p>28</p>
<p>7</p>
<p>Protection area maximum address</p>
<p>MPUA15</p>
<p>29</p>
<p>7</p>
<p>Protection area attribute</p>
<p>MPAT15</p>
<p>30</p>
<p>7</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>442</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For a description of the purpose of each register, please refer to the appropriate</p>
<p>documentation from Renesas Electronics.</p>
<p><b>Addressing Modes</b></p>
<p><b>Introduction</b></p>
<p>All the addressing modes offered by the V850 processor are supported and are</p>
<p>summarized below:</p>
<p><b>Example</b></p>
<p><b>Notation</b></p>
<p><b>Addressing mode</b></p>
<p>di</p>
<p>halt</p>
<p>(<i>no arguments</i>)</p>
<p>No arguments</p>
<p>trap 5</p>
<p><i>imm5</i></p>
<p>Immediate</p>
<p>jmp [lp]</p>
<p>[<i>reg</i>]</p>
<p>Register indirect jump</p>
<p>add r22, r23</p>
<p>cmp r22, r23</p>
<p><i>reg1</i>,<i> reg2</i></p>
<p>Two registers</p>
<p>add 5, r22</p>
<p><i>simm5</i>,<i> reg</i></p>
<p>Register with 5-bit immediate</p>
<p>shl 31, r22</p>
<p><i>imm5</i>,<i> reg</i></p>
<p>addi -74, r22, r23</p>
<p><i>simm16</i>,<i> reg1</i>,<i> reg2</i></p>
<p>Register with 16-bit</p>
<p>immediate</p>
<p>xori 0x8000, r7, r8</p>
<p><i>imm16</i>,<i> reg1</i>,<i> reg2</i></p>
<p>mov -30000, r7</p>
<p><i>simm16</i>,<i> reg1</i></p>
<p>ldsr r22, 5</p>
<p><i>reg</i>,<i> regID</i></p>
<p>System register</p>
<p>stsr 5, r22</p>
<p><i>regID</i>,<i> reg</i></p>
<p>ld.w 0x10[r22], r23</p>
<p><i>simm16</i>[<i>reg1</i>],<i> reg2</i></p>
<p>Register indirect with 16-bit</p>
<p>displacement</p>
<p>st.w r23, -0x56[r3]</p>
<p><i>reg2</i>,<i> simm16</i>[<i>reg1</i>]</p>
<p>sld.b 0x12[ep], r23</p>
<p><i>imm7</i>[</p>
<p>ep</p>
<p>],<i> reg2</i></p>
<p>Register indirect with 7-bit</p>
<p>displacement</p>
<p>sst.b r23, 24[ep]</p>
<p><i>reg2</i>,<i> imm7</i>[</p>
<p>ep</p>
<p>]</p>
<p>sld.w 4[ep], r23</p>
<p><i>imm8</i>[</p>
<p>ep</p>
<p>],<i> reg2</i></p>
<p>Register indirect with 8-bit</p>
<p>displacement</p>
<p>sst.w r23, 0x10[ep]</p>
<p><i>reg2</i>,<i> imm8</i>[</p>
<p>ep</p>
<p>]</p>
<p>bne 30</p>
<p><i>disp9</i></p>
<p>9-bit branch displacement</p>
<p><i>443</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Addressing Modes</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example</b></p>
<p><b>Notation</b></p>
<p><b>Addressing mode</b></p>
<p>jr 0x12346</p>
<p><i>disp22</i></p>
<p>22-bit branch displacement</p>
<p>jarl 0x12346, lp</p>
<p><i>disp22</i>,<i> reg2</i></p>
<p>setf z, r1</p>
<p><i>cccc</i>,<i> reg</i></p>
<p>Condition code</p>
<p>tst1 3, 0x24[r5]</p>
<p><i>bit#3</i>,<i> simm16</i>[<i>reg</i>]</p>
<p>Bit manipulation</p>
<p>In addition to the V850 addressing modes, the V850E supports the following</p>
<p>addressing modes:</p>
<p><b>Example</b></p>
<p><b>Notation</b></p>
<p><b>Addressing mode</b></p>
<p>zxh r24</p>
<p><i>reg</i></p>
<p>One register</p>
<p>callt 3</p>
<p><i>imm6</i></p>
<p>Immediate</p>
<p>div r22, r23, r14</p>
<p>mulu r22, r23, r24</p>
<p><i>reg1</i>,<i> reg2</i>,<i> reg3</i></p>
<p>Three registers</p>
<p>sld.bu 1[ep], r6</p>
<p><i>imm4</i>[</p>
<p>ep</p>
<p>],<i> reg</i></p>
<p>Register indirect with 4-bit</p>
<p>displacement</p>
<p>sld.hu 2[ep], r6</p>
<p><i>imm5</i>[</p>
<p>ep</p>
<p>],<i> reg</i></p>
<p>Register indirect with 5-bit</p>
<p>displacement</p>
<p>mov 0x12345678, r7</p>
<p><i>imm32</i>,<i> reg</i></p>
<p>Register with 32-bit</p>
<p>immediate</p>
<p>mul -65, r22, r23</p>
<p><i>simm9</i>,<i> reg2</i>,<i> reg3</i></p>
<p>Two registers with 9-bit</p>
<p>immediate</p>
<p>mulu 167, r22, r23</p>
<p><i>imm9</i>,<i> reg2</i>,<i> reg3</i></p>
<p>prepare {r20, r22-r27}, 16</p>
<p><i>list12</i>,<i> imm5</i></p>
<p>Register list</p>
<p>dispose 12, {r20, r22-r27},</p>
<p><i>imm5</i>,<i> list12</i></p>
<p>prepare {r21, r23-r25}, 16,</p>
<p>0x1000</p>
<p>prepare {r21}, 4, sp</p>
<p><i>list12</i>,<i> imm5</i>,<i> sp / imm16</i></p>
<p><i>/ imm32</i></p>
<p>dispose 4, {r21, r23-r25},</p>
<p>[lp]</p>
<p><i>imm5</i>,<i> list12</i>, [<i>reg</i>]</p>
<p>cmov ne, r18, r6, r22</p>
<p><i>cccc</i>,<i> reg1</i>,<i> reg2</i>,<i> reg3</i></p>
<p>Condition code</p>
<p>cmov e, -10, r6, r22</p>
<p><i>cccc</i>,<i> simm5</i>,<i> reg2</i>,<i> reg3</i></p>
<p>In addition to the V850 and V850E addressing modes, the V850E2 supports the</p>
<p>following addressing modes:</p>
<p>Example</p>
<p>Notation</p>
<p>Addressing mode</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>444</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>jr32 0x1234678</p>
<p><i>disp32</i></p>
<p>32-bit branch displacement</p>
<p>jarl32 0x1234678, lp</p>
<p><i>disp32</i>,<i> reg1</i></p>
<p>jmp 0x1234678[r20]</p>
<p><i>disp32</i>[<i>reg1</i>]</p>
<p>mac<i> r6</i>,<i> r7</i>,<i> r8</i>,<i> r10</i></p>
<p><i>reg1</i>,<i> reg2</i>,<i> reg3</i>,<i> reg4</i></p>
<p>Four registers</p>
<p>In addition to the V850, V850E and V850E2 addressing modes, the V850E2R</p>
<p>supports the following addressing modes:</p>
<p>Example</p>
<p>Notation</p>
<p>Addressing mode</p>
<p>cmovf.s fcc0, r7, r8, r9</p>
<p><i>fcc</i>,<i> reg1</i>,<i> reg2</i>,<i> reg3</i></p>
<p>Floating-point condition code</p>
<p>cmpf.d ole, r8, r10</p>
<p><i>fcond</i>,<i> reg1</i>,<i> reg2</i></p>
<p>cmpf.d ole, r8, r10, fcc1</p>
<p><i>fcond</i>,<i> reg1</i>,<i> reg2</i>,<i> fcc</i></p>
<p>trfsr fcc2</p>
<p><i>fcc</i></p>
<p>caxi [r6], r7, r12</p>
<p>[<i>reg1</i>],<i> reg2</i>,<i> reg3</i></p>
<p>Register indirect with two</p>
<p>registers</p>
<p>In addition to the V850, V850E, V850E2 and V850E2R addressing modes, the</p>
<p>V850E2V3 supports the following addressing modes:</p>
<p>Example</p>
<p>Notation</p>
<p>Addressing mode</p>
<p>ld.w 0x10000[r22], r23</p>
<p><i>simm23</i>[<i>reg1</i>],<i> reg2</i></p>
<p>Register indirect with 23-bit</p>
<p>displacement</p>
<p>st.w r23, -0x56000[r3]</p>
<p><i>reg2</i>,<i> simm23</i>[<i>reg1</i>]</p>
<p>In addition to the V850, V850E, V850E2, V850E2R and V850E2V3 addressing</p>
<p>modes, the RH850 supports the following addressing modes:</p>
<p>Example</p>
<p>Notation</p>
<p>Addressing mode</p>
<p>loop r12, .-0x1234</p>
<p><i>reg1</i>,<i> disp16</i></p>
<p>16-bit unsigned</p>
<p>branch-backwards</p>
<p>displacement</p>
<p>bne .+0x1234</p>
<p><i>disp17</i></p>
<p>17-bit branch displacement</p>
<p>popsp r4-r14</p>
<p><i>reg1-reg2</i></p>
<p>Register range</p>
<p>bins r7, 3, 5, r14</p>
<p><i>reg1, pos, width, reg2</i></p>
<p>Position and width</p>
<p>ldl.w [r10], r11</p>
<p><i>[reg1], reg2</i></p>
<p>Register indirect with no</p>
<p>displacement</p>
<p>stc.w r11, [r10]</p>
<p><i>reg1, [reg2]</i></p>
<p><i>445</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Introduction</i></p>
<h1 style="page-break-before:always; "></h1>
<p>mov.dw r10, vr12</p>
<p><i>reg1, vreg1</i></p>
<p>One general register and one</p>
<p>vector register</p>
<p>mov.dw vr12, r10</p>
<p><i>vreg1, reg1</i></p>
<p>vmaxge.h r8, vr10, vr12</p>
<p><i>reg1, vreg1, vreg2</i></p>
<p>One general register and two</p>
<p>vector registers</p>
<p>vconcat.b r8, vr10, vr12,</p>
<p>vr14</p>
<p><i>reg1, vreg1, vreg2, vreg3</i></p>
<p>One general register and three</p>
<p>vector registers</p>
<p>mov.w 1, r8, vr12</p>
<p><i>imm1, reg1, vreg1</i></p>
<p>One general register, one</p>
<p>vector register and a 1-bit</p>
<p>immediate</p>
<p>mov.w 1, vr12, r8</p>
<p><i>imm1, vreg1, reg1</i></p>
<p>cnvq15q30 vr10, vr12</p>
<p><i>vreg1, vreg2</i></p>
<p>Two vector registers</p>
<p>dup.w 1, vr10, vr12</p>
<p><i>imm1, vreg1, vreg2</i></p>
<p>Two vector registers and a</p>
<p>1-bit immediate</p>
<p>dup.h 2, vr10, vr12</p>
<p><i>imm2, vreg1, vreg2</i></p>
<p>Two vector registers and a</p>
<p>2-bit immediate</p>
<p>vsar.dh 2, vr10, vr12</p>
<p><i>imm4, vreg1, vreg2</i></p>
<p>Two vector registers and a</p>
<p>4-bit immediate</p>
<p>vsar.w 2, vr10, vr12</p>
<p><i>imm5, vreg1, vreg2</i></p>
<p>Two vector registers and a</p>
<p>5-bit immediate</p>
<p>vsar.dw 2, vr10, vr12</p>
<p><i>imm6, vreg1, vreg2</i></p>
<p>Two vector registers and a</p>
<p>6-bit immediate</p>
<p>pki16i32 vr10, vr12, vr14</p>
<p><i>vreg1, vreg2, vreg3</i></p>
<p>Three vector registers</p>
<p>vcalc.h vr7, vr10, vr12,</p>
<p>vr14</p>
<p><i>vreg1, vreg2, vreg3,</i></p>
<p><i>vreg4</i></p>
<p>Four vector registers</p>
<p>vld.b [r10]+, vr12</p>
<p><i>[reg1]+, vreg1</i></p>
<p>Register indirect with post</p>
<p>increment</p>
<p>vst.b vr12, [r10]+</p>
<p><i>vreg1, [reg1]+</i></p>
<p>vld.b [r10]+, r11, vr12</p>
<p><i>[reg1]+, reg2, vreg1</i></p>
<p>Register indirect with</p>
<p>specified post increment</p>
<p>vst.b vr12, [r10]+, r11</p>
<p><i>vreg1, [reg1]+, reg2</i></p>
<p>vld.b [r10]-, vr12</p>
<p><i>[reg1]-, vreg1</i></p>
<p>Register indirect with post</p>
<p>decrement</p>
<p>vst.b vr12, [r10]-</p>
<p><i>vreg1, [reg1]-</i></p>
<p>vld.b [r10]%, r11, vr12</p>
<p><i>[reg1]%, reg2, vreg1</i></p>
<p>Register indirect with modulo</p>
<p>addressing</p>
<p>vst.b vr12, [r10]+, r11</p>
<p><i>vreg1, [reg1]+, reg2</i></p>
<p>vld.dw 8[r10], vr12</p>
<p><i>simm8[reg1], vreg1</i></p>
<p>Register indirect with 8-bit</p>
<p>displacement</p>
<p>vst.dw vr12, 8[r10]</p>
<p><i>vreg1, simm8[reg1]</i></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>446</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>vst.dw vr12, [r10]!, r11</p>
<p><i>vreg1, [reg1]!, reg2</i></p>
<p>Register indirect with</p>
<p>pre-bit-reversal</p>
<p>vst.dw vr12, [r10]</p>
<p><i>vreg1, [reg1]</i></p>
<p>Register indirect with no</p>
<p>immediate</p>
<p>cache 0, [r10]</p>
<p><i>cacheop, [reg1]</i></p>
<p>Register indirect with cache</p>
<p>operation</p>
<p>pref 0, [r10]</p>
<p><i>prefop, [reg1]</i></p>
<p>Register indirect with prefetch</p>
<p>operation</p>
<p>Key:</p>
<p><b>Meaning</b></p>
<p><b>Term</b></p>
<p>The only general register in the instruction.</p>
<p><i>reg</i></p>
<p>The first general register.</p>
<p><i>reg1</i></p>
<p>The second general register.</p>
<p><i>reg2</i></p>
<p>The third general register.</p>
<p><i>reg3</i></p>
<p>The fourth general register.</p>
<p><i>reg4</i></p>
<p>The first vector register.</p>
<p><i>vreg1</i></p>
<p>The second vector register.</p>
<p><i>vreg2</i></p>
<p>The third vector register.</p>
<p><i>vreg3</i></p>
<p>The fourth vector register.</p>
<p><i>vreg4</i></p>
<p>The stack pointer register.</p>
<p><i>sp</i></p>
<p>The system register ID; it may take the values 0 through 31.</p>
<p><i>regID</i></p>
<p>An unsigned 1-bit value (0 or 1).</p>
<p><i>imm1</i></p>
<p>An unsigned 2-bit value (0 to 3).</p>
<p><i>imm2</i></p>
<p>An unsigned 4-bit value (0 to 15).</p>
<p><i>imm4</i></p>
<p>An unsigned 5-bit value (0 to 31).</p>
<p><i>imm5</i></p>
<p>A signed 5-bit value (-16 to 15).</p>
<p><i>simm5</i></p>
<p>An unsigned 6-bit value (0 to 63).</p>
<p><i>imm6</i></p>
<p>An unsigned 7-bit value (0 to 127).</p>
<p><i>imm7</i></p>
<p>An unsigned 8-bit value (0 to 255).</p>
<p><i>imm8</i></p>
<p>A signed 8-bit value (-128 to 127).</p>
<p><i>simm8</i></p>
<p>An unsigned 9-bit value (0 to 511).</p>
<p><i>imm9</i></p>
<p><i>447</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Introduction</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Meaning</b></p>
<p><b>Term</b></p>
<p>A signed 9-bit value (-256 to 255).</p>
<p><i>simm9</i></p>
<p>A comma-delimited list of registers enclosed in braces.</p>
<p><i>list12</i></p>
<p>An unsigned 16-bit value (0 to 65535).</p>
<p><i>imm16</i></p>
<p>A signed 16-bit value (-32768 to 32767).</p>
<p><i>simm16</i></p>
<p>An unsigned 32-bit value (0 to 4294967295) or a signed 32-bit value</p>
<p>(-2147483648 to 2147483647).</p>
<p><i>imm32</i></p>
<p>A signed 9-bit displacement value.</p>
<p><i>disp9</i></p>
<p>A signed 17-bit displacement value.</p>
<p><i>disp17</i></p>
<p>A signed 22-bit displacement value.</p>
<p><i>disp22</i></p>
<p>A 32-bit displacement value.</p>
<p><i>disp32</i></p>
<p>A 9-bit number (0 to 31)</p>
<p><i>pos</i></p>
<p>A 9-bit number (1 to 32)</p>
<p><i>width</i></p>
<p>A number. See your processor or cache documentation for possible</p>
<p>values.</p>
<p><i>cacheop</i></p>
<p>A number. See your processor or cache documentation for possible</p>
<p>values.</p>
<p><i>prefop</i></p>
<p>A 3 bit unsigned number (0 to 7) encoding the bit position within they</p>
<p>targeted byte.</p>
<p><i>bit#3</i></p>
<p>A 4 bit unsigned number (0 to 15) encoding the condition code or one</p>
<p>of the condition code mnemonics.</p>
<p><i>cccc</i></p>
<p>A 3 bit unsigned number (0 to 7) encoding the condition register ID or</p>
<p>one of the condition register mnemonics.</p>
<p><i>fcc</i></p>
<p>A 4 bit unsigned number (0 to 15) encoding the condition code or one</p>
<p>of the condition code mnemonics.</p>
<p><i>fcond</i></p>
<p>Every V850 instruction is either 2 bytes (16 bits) or 4 bytes (32 bits) long, including</p>
<p>those instructions containing immediate data. The V850E family also has 6 byte</p>
<p>(48 bits) and 8 byte (64 bits) instructions such as</p>
<p>mov</p>
<p>32 bit immediate and</p>
<p>prepare</p>
<p>.</p>
<p>In line with the RISC philosophy, there are relatively few instructions and only one</p>
<p>or two addressing modes apply to any given one. Also, a given addressing mode</p>
<p>applies to the instruction as a whole (in contrast to some architectures that allow</p>
<p>different addressing modes to be specified for each operand). The result is very</p>
<p>quick and easy instruction decoding. Therefore, the lack of complex instructions</p>
<p>and addressing modes is compensated with the attendant increase in performance.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>448</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Except for some two register instructions and the</p>
<p>caxi</p>
<p>instruction, data manipulation</p>
<p>instructions are non-destructive. In other words, the source operands are not</p>
<p>modified. For instance the</p>
<p>addi</p>
<p>instruction adds the contents of one source register</p>
<p>and a 16-bit immediate data and stores the result in a second destination register</p>
<p>(the destination register could be the same as the source register if required). In</p>
<p>contrast, the two register mode</p>
<p>add</p>
<p>instruction both reads and writes the second</p>
<p>general register.</p>
<p>Please see the architecture specification for your specific V850 and RH850 processor</p>
<p>for more details on the above addressing modes. These specifications can be obtained</p>
<p>from Renesas Electronics.</p>
<p><b>Macro Expansion</b></p>
<p>The V850 assembler supports several macro expansions described below. Specifying</p>
<p>the</p>
<p>-nomacro</p>
<p>and/or</p>
<p>-noexpandbranch</p>
<p>command line switches tells the assembler</p>
<p>not to accept any macros but instead report an error when given a macro.</p>
<p><b>ld, st, tst1, set1, clr1</b></p>
<p>The</p>
<p>ld</p>
<p>and</p>
<p>st</p>
<p>instructions (with their</p>
<p>.w</p>
<p>,</p>
<p>.h</p>
<p>,</p>
<p>.b</p>
<p>forms) and the</p>
<p>tst1</p>
<p>,</p>
<p>set1</p>
<p>, and</p>
<p>clr1</p>
<p>instructions are expanded to several instructions as follows. (Here,</p>
<p>ld.w</p>
<p>is</p>
<p>used in the examples.)</p>
<p>1.</p>
<p>Operand is a label.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movhi hi(<i>label</i>),<i> reg1</i>,</p>
<p>r1</p>
<p>ld.w lo(<i>label</i>)[</p>
<p>r1</p>
<p>],<i> reg2</i></p>
<p>ld.w<i> label</i>[<i>reg1</i>],<i> reg2</i></p>
<p>2.</p>
<p>Operand is an immediate value.</p>
<p>If displacement is within -32768 to 32767:</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>ld.w<i> disp16</i>[<i>reg1</i>],<i> reg2</i></p>
<p>ld.w<i> disp16</i>[<i>reg1</i>],<i> reg2</i></p>
<p>3.</p>
<p>Otherwise.</p>
<p><i>449</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Macro Expansion</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movhi hi(<i>disp32</i>),<i> reg1</i>,</p>
<p>r1</p>
<p>ld.w lo(<i>disp32</i>)[</p>
<p>r1</p>
<p>],<i> reg2</i></p>
<p>ld.w<i> disp32</i>[<i>reg1</i>],<i> reg2</i></p>
<p><b>add</b></p>
<p>The instruction</p>
<p>add</p>
<p>is expanded to several instructions as follows:</p>
<p>1.</p>
<p>Immediate is within -16 to 15.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>add<i> imm5</i>,<i> reg</i></p>
<p>add<i> imm5</i>,<i> reg</i></p>
<p>2.</p>
<p>Immediate is within -32768 to 32767, except case (1).</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>add<i> imm16</i>,<i> reg</i>,<i> reg</i></p>
<p>add<i> imm16</i>,<i> reg</i></p>
<p>3.</p>
<p>Otherwise</p>
<p>Bits 0 through 15 are all zeros.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movhi hi(<i>imm32</i>),</p>
<p>r0</p>
<p>,</p>
<p>r1</p>
<p>add</p>
<p>r1</p>
<p>,<i> reg</i></p>
<p>add<i> imm32</i>,<i> reg</i></p>
<p>Otherwise.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movhi hi(<i>imm32</i>),</p>
<p>r0</p>
<p>,</p>
<p>r1</p>
<p>movea lo(<i>imm32</i>),</p>
<p>r1</p>
<p>,</p>
<p>r1</p>
<p>add</p>
<p>r1</p>
<p>,<i> reg</i></p>
<p>add<i> imm32</i>,<i> reg</i></p>
<p><b>mov</b></p>
<p>The instruction</p>
<p>mov</p>
<p>is expanded to several instructions as follows:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>450</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>1.</p>
<p>Immediate is within -16 to 15.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>mov<i> imm5</i>,<i> reg</i></p>
<p>mov<i> imm5</i>,<i> reg</i></p>
<p>2.</p>
<p>Immediate is within -32768 to 32767, except case (1).</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movea<i> imm16</i>,</p>
<p>r0</p>
<p>,<i> reg</i></p>
<p>mov<i> imm16</i>,<i> reg</i></p>
<p>3.</p>
<p>Otherwise</p>
<p>Bits 0 through 15 are all zeros.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movhi hi(<i>imm32</i>),</p>
<p>r0</p>
<p>,<i> reg</i></p>
<p>mov<i> imm32</i>,<i> reg</i></p>
<p>Otherwise</p>
<p>If assembling for the V850E family</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>mov<i> imm32</i>,<i> reg</i></p>
<p>mov<i> imm32</i>,<i> reg</i></p>
<p>Otherwise</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movhi hi(<i>imm32</i>),</p>
<p>r0</p>
<p>,<i> reg</i></p>
<p>movea lo(<i>imm32</i>),<i> reg</i>,<i> reg</i></p>
<p>mov<i> imm32</i>,<i> reg</i></p>
<p><b>cmp</b></p>
<p>The instruction</p>
<p>cmp</p>
<p>is expanded to several instructions, as follows:</p>
<p>1.</p>
<p>Immediate is within -16 to 15.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>cmp<i> imm5</i>,<i> reg</i></p>
<p>cmp<i> imm5</i>,<i> reg</i></p>
<p><i>451</i></p>
<p><i>Green Hills Software</i></p>
<p><i>cmp</i></p>
<h1 style="page-break-before:always; "></h1>
<p>2.</p>
<p>Immediate is within -32768 to 32767, except case (1).</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movea<i> imm16</i>,</p>
<p>r0</p>
<p>,</p>
<p>r1</p>
<p>cmp</p>
<p>r1</p>
<p>,<i> reg</i></p>
<p>cmp<i> imm16</i>,<i> reg</i></p>
<p>3.</p>
<p>Otherwise</p>
<p>Same as</p>
<p>add</p>
<p>case (3).</p>
<p><b>sub, not</b></p>
<p>The instructions</p>
<p>sub</p>
<p>and</p>
<p>not</p>
<p>are expanded to several instructions as follows:</p>
<p>1.</p>
<p>Immediate is zero.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>CMD</p>
<p>r0</p>
<p>,<i> reg</i></p>
<p>CMD 0,<i> reg</i></p>
<p>2.</p>
<p>Immediate is within -16 to 15.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>mov<i> imm5</i>,</p>
<p>r1</p>
<p>CMD</p>
<p>r1</p>
<p>,<i> reg</i></p>
<p>CMD<i> imm5</i>,<i> reg</i></p>
<p>3.</p>
<p>Immediate is within -32768 to 32767, except cases (1) and (2).</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movea<i> imm16</i>,</p>
<p>r0</p>
<p>,</p>
<p>r1</p>
<p>CMD</p>
<p>r1</p>
<p>,<i> reg</i></p>
<p>CMD<i> imm16</i>,<i> reg</i></p>
<p>4.</p>
<p>Otherwise</p>
<p>Same as</p>
<p>add</p>
<p>case (3).</p>
<p><b>or, and, xor</b></p>
<p>The instructions</p>
<p>or</p>
<p>,</p>
<p>and</p>
<p>, and</p>
<p>xor</p>
<p>are expanded to several instructions as follows.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>452</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>(</p>
<p>CMD</p>
<p>can be replaced by any of the instructions</p>
<p>or</p>
<p>,</p>
<p>and</p>
<p>, and</p>
<p>xor</p>
<p>).</p>
<p>1.</p>
<p>Immediate is within -32768 to -17.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movea<i> imm16</i>,</p>
<p>r0</p>
<p>,</p>
<p>r1</p>
<p>CMD</p>
<p>r1</p>
<p>,<i> reg</i></p>
<p>CMD<i> imm16</i>,<i> reg</i></p>
<p>2.</p>
<p>Immediate is within -16 to -1.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>mov<i> imm5</i>,</p>
<p>r1</p>
<p>CMD</p>
<p>r1</p>
<p>,<i> reg</i></p>
<p>CMD<i> imm5</i>,<i> reg</i></p>
<p>3.</p>
<p>Immediate is zero.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>CMD</p>
<p>r0</p>
<p>,<i> reg</i></p>
<p>CMD 0,<i> reg</i></p>
<p>4.</p>
<p>Immediate is within 1 to 65535.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>CMDi<i> imm16</i>,<i> reg</i>,<i> reg</i></p>
<p>CMD<i> imm16</i>,<i> reg</i></p>
<p>5.</p>
<p>Otherwise</p>
<p>Same as</p>
<p>add</p>
<p>case (3).</p>
<p><b>addi, ori, andi, xori</b></p>
<p>The instructions</p>
<p>addi</p>
<p>,</p>
<p>ori</p>
<p>,</p>
<p>andi</p>
<p>, and</p>
<p>xori</p>
<p>are expanded to several instructions</p>
<p>as follows.</p>
<p>(</p>
<p>CMD</p>
<p>can be replaced by any of the instructions</p>
<p>addi</p>
<p>,</p>
<p>ori</p>
<p>,</p>
<p>andi</p>
<p>, and</p>
<p>xori</p>
<p>.)</p>
<p>1.</p>
<p>Immediate is within -32768 to -17.</p>
<p><i>453</i></p>
<p><i>Green Hills Software</i></p>
<p><i>addi, ori, andi, xori</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movea<i> imm16</i>,</p>
<p>r0</p>
<p>,<i> reg2</i></p>
<p>CMD<i> reg1</i>,<i> reg2</i></p>
<p>CMDi<i> imm16</i>,<i> reg1</i>, reg2</p>
<p>2.</p>
<p>Immediate is within -16 to -1.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>mov<i> imm5</i>,<i> reg2</i></p>
<p>CMD<i> reg1</i>,<i> reg2</i></p>
<p>CMDi<i> imm5</i>,<i> reg1</i>,<i> reg2</i></p>
<p>3.</p>
<p>Immediate is within 0 to 65535.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>CMDi<i> imm16</i>,<i> reg1</i>,<i> reg2</i></p>
<p>CMDi<i> imm16</i>,<i> reg1</i>,<i> reg2</i></p>
<p>4.</p>
<p>Otherwise</p>
<p>Bits 0 through 15 are all zeros.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movhi hi(<i>imm32</i>),</p>
<p>r0</p>
<p>,<i> reg2</i></p>
<p>CMD<i> reg1</i>,<i> reg2</i></p>
<p>CMDi<i> imm32</i>,<i> reg1</i>,<i> reg2</i></p>
<p>Otherwise.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movhi hi(<i>imm32</i>),</p>
<p>r0</p>
<p>,</p>
<p>r1</p>
<p>movea lo(<i>imm32</i>),</p>
<p>r1</p>
<p>,<i> reg2</i></p>
<p>CMD<i> reg1</i>,<i> reg2</i></p>
<p>CMDi<i> imm32</i>,<i> reg1</i>,<i> reg2</i></p>
<p><b>movea</b></p>
<p>The instruction</p>
<p>movea</p>
<p>is expanded to several instructions as follows.</p>
<p>1.</p>
<p>Immediate is within -32768 to 32767.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>454</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movea<i> imm16</i>,<i> reg1</i>,<i> reg2</i></p>
<p>movea<i> imm16</i>,<i> reg1</i>,<i> reg2</i></p>
<p>2.</p>
<p>Otherwise</p>
<p>Bits 0 through 15 are all zeros.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movhi hi(<i>imm32</i>),<i> reg1</i>,<i> reg2</i></p>
<p>movea<i> imm32</i>,<i> reg1</i>,<i> reg2</i></p>
<p>Otherwise.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>movhi hi(<i>imm32</i>),<i> reg1</i>,</p>
<p>r1</p>
<p>movea lo(<i>imm32</i>),</p>
<p>r1</p>
<p>,<i> reg2</i></p>
<p>movea<i> imm32</i>,<i> reg1</i>,<i> reg2</i></p>
<p><b>bcond</b></p>
<p>The 9-bit branch instructions</p>
<p>b<i>cond</i></p>
<p>are expanded to several instructions as follows</p>
<p>(this macro does not support a displacement that is out of the 9-bit range when</p>
<p>expressed as an immediate):</p>
<p>1.</p>
<p>Displacement is within -256 to 255.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>b<i>cond disp9</i></p>
<p>b<i>cond disp9</i></p>
<p>2.</p>
<p>Otherwise.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>b<i>rcond</i> Label</p>
<p>jr<i> disp22</i>-2</p>
<p>Label:</p>
<p>b<i>cond disp22</i></p>
<p>Here</p>
<p>b<i>rcond</i></p>
<p>is the reverse condition branch of</p>
<p>b<i>cond</i></p>
<p>.</p>
<p><i>455</i></p>
<p><i>Green Hills Software</i></p>
<p><i>bcond</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>jbr</b></p>
<p>The 9-bit branch instruction</p>
<p>jbr</p>
<p>is expanded to several instructions as follows (this</p>
<p>macro does not support an immediate displacement that is out of the 9-bit range):</p>
<p>1.</p>
<p>Displacement is within -256 to 255.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>br<i> disp9</i></p>
<p>jbr<i> disp9</i></p>
<p>2.</p>
<p>Otherwise.</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>jr<i> disp22</i></p>
<p>jbr<i> disp22</i></p>
<p><b>setf, cmov, adf, sbf</b></p>
<p>The following</p>
<p>setf</p>
<p>,</p>
<p>cmov</p>
<p>,</p>
<p>adf</p>
<p>, and</p>
<p>sbf</p>
<p>macros are supported by<b> as850</b>:</p>
<p>(</p>
<p>CMD</p>
<p>can be replaced by any of</p>
<p>setf</p>
<p>,</p>
<p>cmov</p>
<p>,</p>
<p>adf</p>
<p>, and</p>
<p>sbf</p>
<p>.<i> cond</i> can be any of the</p>
<p>mnemonics listed in the condition code table.<i> args</i> are the remaining arguments</p>
<p>according to the instruction's addressing mode.)</p>
<p><b>Macro expansion</b></p>
<p><b>Instruction</b></p>
<p>CMD<i> cond, args</i></p>
<p>CMD<i>cond args</i></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>456</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Programming in Assembly Language</b></p>
<p>This section provides brief examples with guidelines for writing V850 assembly</p>
<p>language subroutines.</p>
<p>For your subroutine to work with the Green Hills V850 toolchain, it must follow</p>
<p>the calling convention of the Green Hills V850 compilers. See âCalling Conventionsâ</p>
<p>on page 35.</p>
<p>Throughout this section, including in assembly code,</p>
<p>sp0</p>
<p>means the value of the</p>
<p>stack pointer as it was passed on entry to the subroutine, and</p>
<p>sp</p>
<p>means the stack</p>
<p>pointer after the subroutine makes any adjustments. The Green Hills V850 assembler</p>
<p>does not actually recognize the symbol</p>
<p>sp0</p>
<p>; it is used here only to avoid ambiguity.</p>
<p>In general, the stack looks like this:</p>
<p><i>nth</i> parameter word</p>
<p>High Address</p>
<p>(<i>n</i>-1)<i>th</i> parameter word</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>(<i>previous frame</i>)</p>
<p>6<i>th</i> parameter word</p>
<p>sp0</p>
<p>5<i>th</i> parameter word</p>
<p>sp +<i> framesize</i> - 4 (= sp0</p>
<p>- 4)</p>
<p>16-byte argument area</p>
<p>(only if necessary)</p>
<p>sp +<i> framesize</i> - 16</p>
<p>sp +<i> framesize</i> -<i> argarea</i></p>
<p>- 4</p>
<p>return address (</p>
<p>lp</p>
<p>)</p>
<p>sp +<i> framesize</i> -<i> argarea</i></p>
<p>- 8</p>
<p>frame pointer (</p>
<p>fp</p>
<p>)</p>
<p>permanent registers</p>
<p>local variables</p>
<p>(<i>current frame</i>)</p>
<p><i>nth</i> argument word</p>
<p>(<i>n</i>-1)<i>th</i> argument word</p>
<p><i>457</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Programming in Assembly Language</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.</p>
<p>.</p>
<p>.</p>
<p>6<i>th</i> argument word</p>
<p>sp (= sp0 -<i> framesize</i>)</p>
<p>5<i>th</i> argument word</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>(<i>next frame</i>)</p>
<p>Low Address</p>
<p>In this diagram,<i> parameters</i> are passed to our subroutine, and<i> arguments</i> are passed</p>
<p>to the subroutines that you call;<i> argarea</i> is 16 if you need the 16-byte argument</p>
<p>area, or zero if not.</p>
<p><b>Assembly Code Samples</b></p>
<p><b>Example 8.1. C code versus Assembly code with stack usage</b></p>
<p>C code:</p>
<p>int foo(int p)</p>
<p>{</p>
<p>int i,j;</p>
<p>i = bar(13, p);</p>
<p>j = cit();</p>
<p>wyk();</p>
<p>return i+j;</p>
<p>}</p>
<p>V850 assembly code:</p>
<p>.text</p>
<p>.align 2</p>
<p>.globl _foo</p>
<p>_foo:</p>
<p>add</p>
<p>-12,sp</p>
<p>st.w</p>
<p>lp,8[sp]</p>
<p>-- save the return address</p>
<p>st.w</p>
<p>r27,4[sp] -- save permanent register r27</p>
<p>st.w</p>
<p>r26,0[sp] -- save permanent register r26</p>
<p>mov</p>
<p>r6,r7</p>
<p>-- move p to r7</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>458</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>mov</p>
<p>13,r6</p>
<p>jarl</p>
<p>_bar, lp</p>
<p>-- call bar()</p>
<p>mov</p>
<p>r10,r27</p>
<p>-- assign result of bar() to i</p>
<p>jarl</p>
<p>_cit, lp</p>
<p>-- call cit()</p>
<p>mov</p>
<p>r10,r26</p>
<p>-- assign result of cit() to j</p>
<p>jarl</p>
<p>_wyk, lp</p>
<p>-- call wyk()</p>
<p>mov</p>
<p>r26,r10</p>
<p>-- move j to r10</p>
<p>add</p>
<p>r27,r10</p>
<p>-- r10 now contains i+j</p>
<p>ld.w</p>
<p>0[sp],r26 -- restore r26</p>
<p>ld.w</p>
<p>4[sp],r27 -- restore r27</p>
<p>ld.w</p>
<p>8[sp],lp</p>
<p>-- restore lp</p>
<p>add</p>
<p>12,sp</p>
<p>jmp</p>
<p>[lp]</p>
<p>-- return from subroutine</p>
<p>The stack,</p>
<p>framesize</p>
<p>= 12:</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>High Address</p>
<p>sp0</p>
<p>sp + 8</p>
<p>lp</p>
<p>sp + 4</p>
<p>r27</p>
<p>sp (=sp0 - 12)</p>
<p>r26</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>Low Address</p>
<p>The</p>
<p>.text</p>
<p>directive tells the assembler that the code following the directive should</p>
<p>be in the text segment. The</p>
<p>.align 2</p>
<p>directive forces the next instruction to align</p>
<p>to the next 2-byte boundary. To make the subroutine</p>
<p>_foo</p>
<p>globally accessible,</p>
<p>follow the convention of preceding an identifier with an underscore (</p>
<p>_</p>
<p>) and use</p>
<p>.globl _foo</p>
<p>.</p>
<p>In</p>
<p>_foo</p>
<p>, you need two registers to contain the values of</p>
<p>_i</p>
<p>and</p>
<p>_j</p>
<p>. You can</p>
<p>arbitrarily pick</p>
<p>r27</p>
<p>and</p>
<p>r26</p>
<p>from the set of permanent registers (</p>
<p>r20</p>
<p>to</p>
<p>r29</p>
<p>) to</p>
<p>contain</p>
<p>_i</p>
<p>and</p>
<p>_j</p>
<p>respectively, because these registers are preserved across</p>
<p>subroutine calls.</p>
<p>Just as</p>
<p>_bar</p>
<p>,</p>
<p>_cit</p>
<p>, and</p>
<p>_wyk</p>
<p>cannot destroy</p>
<p>r20</p>
<p>to</p>
<p>r29</p>
<p>when called, you must</p>
<p>also preserve the values of</p>
<p>r26</p>
<p>and</p>
<p>r27</p>
<p>as they were passed by the caller before</p>
<p>being overwritten. A good place to save these registers is on entry to this subroutine.</p>
<p><i>459</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Assembly Code Samples</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Similarly, you need to save the contents of</p>
<p>r31</p>
<p>(or</p>
<p>lp</p>
<p>, the link pointer, which</p>
<p>contains the return address) before making any of the calls, because the subroutine</p>
<p>calls will overwrite its value.</p>
<p>You can save the contents of these three registers by storing their values onto the</p>
<p>stack, so you will need 12 bytes of stack space. The calling convention requires the</p>
<p>stack pointer to always align to a 4-byte boundary, so you do not need to adjust the</p>
<p>stack any further. Since the stack âgrowsâ downward from higher addresses to lower</p>
<p>addresses, subtract 12 from the stack pointer</p>
<p>sp0</p>
<p>(</p>
<p>r3</p>
<p>) on entry to this subroutine.</p>
<p>Now you have 12 bytes of stack space to store</p>
<p>r26</p>
<p>,</p>
<p>r27</p>
<p>, and</p>
<p>lp</p>
<p>. In this case, the</p>
<p>Green Hills compiler saves the return address register at the highest address on the</p>
<p>local stack frame, so you can store</p>
<p>lp</p>
<p>at</p>
<p>sp+8</p>
<p>(with the instruction</p>
<p>st.w</p>
<p>lp,8[sp]</p>
<p>). Store</p>
<p>r26</p>
<p>at</p>
<p>sp+0</p>
<p>and</p>
<p>r27</p>
<p>at</p>
<p>sp+4</p>
<p>.</p>
<p>Next, make a call to</p>
<p>_bar</p>
<p>, passing 13 as the first parameter and</p>
<p>_p</p>
<p>as the second</p>
<p>parameter. To pass 13, put it in</p>
<p>r6</p>
<p>, the first parameter register. However,</p>
<p>_p</p>
<p>is the</p>
<p>first parameter to this subroutine, and it is in</p>
<p>r6</p>
<p>at this point, so you must first move</p>
<p>it from</p>
<p>r6</p>
<p>to</p>
<p>r7</p>
<p>, the second parameter register. Then you can move 13 into</p>
<p>r6</p>
<p>, and</p>
<p>make the call to</p>
<p>_bar</p>
<p>.</p>
<p>Since</p>
<p>r10</p>
<p>is the return register, you can find the value of</p>
<p>_bar</p>
<p>and assign the result</p>
<p>to</p>
<p>_i</p>
<p>. Register</p>
<p>r10</p>
<p>is moved to</p>
<p>r27</p>
<p>before calling</p>
<p>_cit</p>
<p>. Then you can assign the</p>
<p>return value</p>
<p>r10</p>
<p>to</p>
<p>_j</p>
<p>(in</p>
<p>r26</p>
<p>) and call</p>
<p>_wyk</p>
<p>. Finally, add</p>
<p>_i</p>
<p>and</p>
<p>_j</p>
<p>and return</p>
<p>the result in</p>
<p>r10</p>
<p>.</p>
<p>On exit from</p>
<p>_foo</p>
<p>, you can restore the values of these three registers by the</p>
<p>corresponding loads, adjust the stack pointer back, and return to the address in</p>
<p>lp</p>
<p>(with the instruction</p>
<p>jmp [lp]</p>
<p>).</p>
<p><b>Example 8.2. Setting up a stack frame to make a function call</b></p>
<p>C code:</p>
<p>void foo(void)</p>
<p>{</p>
<p>bar(3,1,4,1,5,9);</p>
<p>}</p>
<p>V850 assembly code:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>460</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.text</p>
<p>.align 2</p>
<p>.globl _foo</p>
<p>_foo:</p>
<p>add</p>
<p>-12,sp</p>
<p>st.w</p>
<p>lp,8[sp]</p>
<p>-- save return address</p>
<p>mov</p>
<p>3,r6</p>
<p>-- pass first 4 parameters in registers</p>
<p>mov</p>
<p>1,r7</p>
<p>mov</p>
<p>4,r8</p>
<p>mov</p>
<p>1,r9</p>
<p>mov</p>
<p>5,r16</p>
<p>-- pass the 5th and 6th on the stack</p>
<p>st.w</p>
<p>r16,0[sp]</p>
<p>mov</p>
<p>9,r16</p>
<p>st.w</p>
<p>r16,4[sp]</p>
<p>jarl</p>
<p>_bar, lp</p>
<p>-- call bar()</p>
<p>ld.w</p>
<p>8[sp],lp</p>
<p>-- restore return address</p>
<p>add</p>
<p>12,sp</p>
<p>jmp</p>
<p>[lp]</p>
<p>-- return from subroutine</p>
<p>The stack,</p>
<p>framesize</p>
<p>= 12:</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>High Address</p>
<p>sp + 8</p>
<p>lp</p>
<p>sp + 4</p>
<p>9</p>
<p>sp (= sp0 - 12)</p>
<p>5</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>Low Address</p>
<p>Here</p>
<p>_foo</p>
<p>passes six int's to</p>
<p>_bar</p>
<p>. You have four parameter registers</p>
<p>r6</p>
<p>,</p>
<p>r7</p>
<p>,</p>
<p>r8</p>
<p>,</p>
<p>and</p>
<p>r9</p>
<p>, so passing the first four arguments is trivial. However, the 5<i>th</i> and 6<i>th</i></p>
<p>arguments must go onto the stack. You also need 8 bytes to do that, so put the 5<i>th</i></p>
<p>and 6<i>th</i> arguments at</p>
<p>sp+0</p>
<p>and</p>
<p>sp+4</p>
<p>respectively.</p>
<p>Again you need to save the return address</p>
<p>lp</p>
<p>, making a total of 12 bytes on the</p>
<p>stack.</p>
<p><i>461</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Assembly Code Samples</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 8.3. A leaf subroutine</b></p>
<p>C code:</p>
<p>int foo(int i, int j)</p>
<p>{</p>
<p>return i+j;</p>
<p>}</p>
<p>V850 assembly code:</p>
<p>.text</p>
<p>.align 2</p>
<p>.globl _foo</p>
<p>_foo:</p>
<p>mov</p>
<p>r7,r10</p>
<p>-- move j to r10</p>
<p>add</p>
<p>r6,r10</p>
<p>-- add i to it. r10 now equals i+j</p>
<p>jmp</p>
<p>[lp]</p>
<p>-- return from subroutine</p>
<p>This example demonstrates a<i> leaf</i> subroutine, one that does not make any calls.</p>
<p>Also,</p>
<p>_foo</p>
<p>does not need to save any registers. In this case you do not have to</p>
<p>adjust the stack pointer.</p>
<p><b>Example 8.4. A function whose arguments are passed on the stack</b></p>
<p>C code:</p>
<p>int foo(a,b,c,d,e,f)</p>
<p>int a,b,c,d,e,f;</p>
<p>{</p>
<p>return e+f;</p>
<p>}</p>
<p>V850 assembly code:</p>
<p>.text</p>
<p>.align 2</p>
<p>.globl _foo</p>
<p>_foo:</p>
<p>ld.w</p>
<p>4[sp],r10</p>
<p>-- load e into r10</p>
<p>ld.w</p>
<p>0[sp],r15</p>
<p>-- load f into r15</p>
<p>add</p>
<p>r15,r10</p>
<p>-- add them, leaving the sum in r10</p>
<p>jmp</p>
<p>[lp]</p>
<p>-- return from subroutine</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>462</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The stack,<i> framesize</i> = 0 (no need to create a new stack frame):</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>High Address</p>
<p>sp0 + 4</p>
<p>_f</p>
<p>sp0</p>
<p>_e</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>Low Address</p>
<p>On entry to</p>
<p>_foo</p>
<p>, the caller has stored</p>
<p>_e</p>
<p>and</p>
<p>_f</p>
<p>on the stack at</p>
<p>sp0+0</p>
<p>and</p>
<p>sp0+4,</p>
<p>respectively. This is also a leaf subroutine.</p>
<p><b>Example 8.5. Arguments that must be passed in register pairs</b></p>
<p>C code:</p>
<p>void foo(int i, double d, int j)</p>
<p>{</p>
<p>bar(2,i,j,d);</p>
<p>}</p>
<p>V850 assembly code:</p>
<p>.text</p>
<p>.align 2</p>
<p>.globl _foo</p>
<p>_foo:</p>
<p>add</p>
<p>-12,sp</p>
<p>st.w</p>
<p>lp,8[sp]</p>
<p>-- save return address</p>
<p>st.w</p>
<p>r8,0[sp]</p>
<p>-- store d on the stack</p>
<p>st.w</p>
<p>r9,4[sp]</p>
<p>ld.w</p>
<p>12[sp],r8</p>
<p>-- load j from the stack</p>
<p>mov</p>
<p>r6,r7</p>
<p>-- move i to r7</p>
<p>mov</p>
<p>2,r6</p>
<p>jarl</p>
<p>_bar, lp</p>
<p>-- call bar()</p>
<p>ld.w</p>
<p>8[sp],lp</p>
<p>-- restore lp</p>
<p>add</p>
<p>12,sp</p>
<p>jmp</p>
<p>[lp]</p>
<p>-- return from subroutine</p>
<p><i>463</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Assembly Code Samples</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The stack,<i> framesize</i> = 12:</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>High Address</p>
<p>sp0 (= sp + 12)</p>
<p>_j</p>
<p>sp + 8</p>
<p>lp</p>
<p>sp + 4</p>
<p>_d</p>
<p>(</p>
<p>r9</p>
<p>)</p>
<p>sp (= sp0 - 12)</p>
<p>_d</p>
<p>(</p>
<p>r8</p>
<p>)</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>Low Address</p>
<p>In this example,</p>
<p>_d</p>
<p>is passed<i> not</i> in (</p>
<p>r7</p>
<p>,</p>
<p>r8</p>
<p>) but in (</p>
<p>r8</p>
<p>,</p>
<p>r9</p>
<p>) because a double, if</p>
<p>stored in memory, must have an 8-byte aligned offset relative to the first argument's</p>
<p>stack offset. Therefore, the first parameter</p>
<p>_i</p>
<p>has a zero offset,</p>
<p>_d</p>
<p>an offset of 8,</p>
<p>and</p>
<p>_j</p>
<p>an offset of 16. So the caller put</p>
<p>_i</p>
<p>in</p>
<p>r6</p>
<p>, skipped</p>
<p>_r7</p>
<p>, put</p>
<p>_d</p>
<p>in (</p>
<p>r8</p>
<p>,</p>
<p>r9</p>
<p>),</p>
<p>and stored</p>
<p>_j</p>
<p>onto the stack at</p>
<p>sp0</p>
<p>.</p>
<p>Similarly, to call</p>
<p>_bar</p>
<p>, pass 2,</p>
<p>_i</p>
<p>, and</p>
<p>_j</p>
<p>in</p>
<p>r6</p>
<p>,</p>
<p>r7</p>
<p>, and</p>
<p>r8</p>
<p>respectively, skip</p>
<p>r9</p>
<p>,</p>
<p>and then pass</p>
<p>_d</p>
<p>at</p>
<p>sp+0</p>
<p>and</p>
<p>sp+4</p>
<p>.</p>
<p><b>Example 8.6. Using the homing area</b></p>
<p>C code:</p>
<p>struct T { int i; int j; };</p>
<p>void foo(int k, struct T s)</p>
<p>{</p>
<p>bar(&amp;s.i, k);</p>
<p>}</p>
<p>V850 assembly code:</p>
<p>.text</p>
<p>.align 2</p>
<p>.globl _foo</p>
<p>_foo:</p>
<p>addi</p>
<p>-20,sp,sp</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>464</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>st.w</p>
<p>r8,12[sp] -- store s.j onto the stack</p>
<p>st.w</p>
<p>r7,8[sp]</p>
<p>-- store s.i onto the stack</p>
<p>st.w</p>
<p>lp,0[sp]</p>
<p>-- save the return address</p>
<p>mov</p>
<p>r6,r7</p>
<p>-- move k to r7</p>
<p>moeva 8,sp,r6</p>
<p>-- move the address of s.i to r6</p>
<p>jarl</p>
<p>_bar, lp</p>
<p>-- call bar()</p>
<p>ld.w</p>
<p>0[sp],lp</p>
<p>-- restore lp</p>
<p>addi</p>
<p>20,sp,sp</p>
<p>jmp</p>
<p>[lp]</p>
<p>-- return from subroutine</p>
<p>The stack,</p>
<p>framesize</p>
<p>= 20:</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>High Address</p>
<p>sp0 (= sp + 20)</p>
<p>sp + 16</p>
<p><i>(word for r9)</i></p>
<p>sp + 12</p>
<p>s.j</p>
<p>(</p>
<p>r8</p>
<p>)</p>
<p>sp + 8</p>
<p>s.i</p>
<p>(</p>
<p>r7</p>
<p>)</p>
<p>sp + 4</p>
<p><i>(word for r6)</i></p>
<p>sp (= sp0 - 20)</p>
<p>lp</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>Low Address</p>
<p>Here is a structure parameter passed by value, and part of the structure (in this case</p>
<p>the entire structure) is within the first four words (the second word specifically) of</p>
<p>the parameter list. Therefore, the caller passed</p>
<p>k</p>
<p>in</p>
<p>r6</p>
<p>and</p>
<p>s</p>
<p>in</p>
<p>r7</p>
<p>. The calling</p>
<p>convention requires that you allocate a 16-byte âhomingâ area immediately following</p>
<p>the previous stack frame and save the parts of the structure within the first four</p>
<p>words into this area. Below this area you can save the linker pointer (</p>
<p>lp</p>
<p>), etc. as</p>
<p>usual.</p>
<p>The following is a variation of this example.</p>
<p><b>Example 8.7. Another homing area example</b></p>
<p>C code:</p>
<p><i>465</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Assembly Code Samples</i></p>
<h1 style="page-break-before:always; "></h1>
<p>struct T { int i; int j; };</p>
<p>void foo(struct T s, struct T v)</p>
<p>{</p>
<p>bar(&amp;s.i, &amp;v.i);</p>
<p>}</p>
<p>V850 assembly code:</p>
<p>.text</p>
<p>.align 2</p>
<p>.globl _foo</p>
<p>_foo:</p>
<p>addi</p>
<p>-20,sp,sp</p>
<p>st.w</p>
<p>r9,16[sp]</p>
<p>-- store v.j onto the stack</p>
<p>st.w</p>
<p>r8,12[sp]</p>
<p>-- store v.i onto the stack</p>
<p>st.w</p>
<p>r7,8[sp]</p>
<p>-- store s.j onto the stack</p>
<p>st.w</p>
<p>r6,4[sp]</p>
<p>-- store s.i onto the stack</p>
<p>st.w</p>
<p>lp,0[sp]</p>
<p>-- save the return address</p>
<p>movea 12,sp,r7</p>
<p>-- move the address of v.i to r7</p>
<p>movea 4,sp,r6</p>
<p>-- move the address of s.i to r6</p>
<p>jarl</p>
<p>_bar, lp</p>
<p>-- call bar()</p>
<p>ld.w</p>
<p>0[sp],lp</p>
<p>-- restore lp</p>
<p>addi</p>
<p>20,sp,sp</p>
<p>jmp</p>
<p>[lp]</p>
<p>-- return from subroutine</p>
<p>The stack,</p>
<p>framesize</p>
<p>= 20:</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>High Address</p>
<p>sp0 (= sp + 20)</p>
<p>sp + 16</p>
<p>v.j</p>
<p>(</p>
<p>r9</p>
<p>)</p>
<p>sp + 12</p>
<p>v.i</p>
<p>(</p>
<p>r8</p>
<p>)</p>
<p>sp + 8</p>
<p>s.j</p>
<p>(</p>
<p>r7</p>
<p>)</p>
<p>sp + 4</p>
<p>s.i</p>
<p>(</p>
<p>r6</p>
<p>)</p>
<p>sp (= sp0 - 20)</p>
<p>lp</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>Low Address</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>466</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The following is another variation:</p>
<p><b>Example 8.8. When more than the homing area is needed</b></p>
<p>C code:</p>
<p>struct A { int i; };</p>
<p>struct B { int a,b,c; };</p>
<p>void foo(struct A s, int k, struct B v)</p>
<p>{</p>
<p>bar(&amp;s.i, &amp;v.c, k);</p>
<p>}</p>
<p>V850 assembly code:</p>
<p>.text</p>
<p>.align 2</p>
<p>.globl _foo</p>
<p>_foo:</p>
<p>addi</p>
<p>-20,sp,sp</p>
<p>st.w</p>
<p>r9,16[sp]</p>
<p>-- store v.a onto the stack</p>
<p>st.w</p>
<p>r7,8[sp]</p>
<p>-- store s.j onto the stack</p>
<p>st.w</p>
<p>r6,4[sp]</p>
<p>-- store s.i onto the stack</p>
<p>st.w</p>
<p>lp,0[sp]</p>
<p>-- save the return address</p>
<p>movea 24,sp,r7</p>
<p>-- move the address of v.c to r7</p>
<p>movea 4,sp,r6</p>
<p>-- move the address of s.i to r6</p>
<p>jarl</p>
<p>_bar, lp</p>
<p>-- call bar()</p>
<p>ld.w</p>
<p>0[sp],lp</p>
<p>-- restore lp</p>
<p>addi</p>
<p>20,sp,sp</p>
<p>jmp</p>
<p>[lp]</p>
<p>-- return from subroutine</p>
<p>The stack,<i> framesize</i> = 20:</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>High Address</p>
<p>sp0 (= sp + 24)</p>
<p>v.c</p>
<p>sp + 20</p>
<p>v.b</p>
<p>sp + 16</p>
<p>v.a</p>
<p>(</p>
<p>r9</p>
<p>)</p>
<p>sp + 12</p>
<p><i>(word for r8)</i></p>
<p><i>467</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Assembly Code Samples</i></p>
<h1 style="page-break-before:always; "></h1>
<p>sp + 8</p>
<p>s.j</p>
<p>(</p>
<p>r6</p>
<p>)</p>
<p>sp + 4</p>
<p>s.i</p>
<p>(</p>
<p>r6</p>
<p>)</p>
<p>sp (= sp0 - 20)</p>
<p>lp</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>Low Address</p>
<p><b>Bitfields</b></p>
<p>The V850 provides special bitfield manipulation instructions for modifying</p>
<p>individual bits in memory. Using the driver (<b>ccv850</b>) and the preprocessor facility</p>
<p>#define</p>
<p>, you can make bitfield manipulation assembly code easier to read.</p>
<p>In the following example, the address of</p>
<p>bar</p>
<p>is loaded into</p>
<p>r10</p>
<p>, then</p>
<p>bit0</p>
<p>,</p>
<p>bit1</p>
<p>,</p>
<p>and</p>
<p>bit10</p>
<p>are defined using the</p>
<p><i>bit</i>,<i>byte</i></p>
<p>notation to name three single bits into</p>
<p>bar</p>
<p>. To compile this file,<b> ccv850</b> is used.</p>
<p>.data</p>
<p>_bar:</p>
<p>.word 0x12345678</p>
<p>.text</p>
<p>.align 2</p>
<p>.globl _foo</p>
<p>_foo:</p>
<p>movhi hi(_bar),zero,r10</p>
<p>movea lo(_bar),r10,r10</p>
<p>#define bit0 0,0[r10]</p>
<p>#define bit1 1,0[r10]</p>
<p>#define bit10 2,1[r10]</p>
<p>clr1</p>
<p>bit0</p>
<p>cmp</p>
<p>zero,r6</p>
<p>bne</p>
<p>L</p>
<p>set1</p>
<p>bit1</p>
<p>jmp</p>
<p>[lp]</p>
<p>L:</p>
<p>clr1</p>
<p>bit10</p>
<p>jmp</p>
<p>[lp]</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>468</i></p>
<p><i>Chapter 8. V850 Assembler Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 9</b></p>
<p><b>The elxr Linker</b></p>
<p><b>Contents</b></p>
<p>Linker-Specific Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>471</p>
<p>Specifying the Program Entry Point . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>475</p>
<p>Configuring the Linker with Linker Directives Files . . . . . . . . . . . . . . . . . . . .</p>
<p>475</p>
<p>Symbol Definitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>503</p>
<p>Advanced Linker Features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>509</p>
<h1 style="page-break-before:always; "></h1>
<p>The Green Hills<b> elxr</b> linker is invoked by the driver and combines ELF object files</p>
<p>and libraries into a single executable program suitable for downloading onto your</p>
<p>target. To perform this task, it:</p>
<p>1.</p>
<p>combines all input files into a single output program that contains all necessary</p>
<p>objects.</p>
<p>2.</p>
<p>assigns a memory address to each of the objects.</p>
<p>3.</p>
<p>resolves relocations by replacing references to each object with the memory</p>
<p>address it assigned to that object.</p>
<p>When the linker combines object files, it uses a<i> section map</i> to determine which</p>
<p>sections in each object file to place into each program section. It also reads the</p>
<p>section map to assign program sections to memory blocks or addresses. The linker</p>
<p>reads a<i> memory map</i> to determine the size and location of memory blocks on your</p>
<p>target. The linker reads section maps, memory maps, and options from linker</p>
<p>directives (<b>.ld</b>) files (see âConfiguring the Linker with Linker Directives Filesâ</p>
<p>on page 475).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>470</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Linker-Specific Options</b></p>
<p>The driver recognizes many different options and passes them to the linker. For a</p>
<p>list of these driver options, see âLinker Optionsâ on page 235. If you use the driver</p>
<p>to compile and link your program in multiple steps, you must pass the exact same</p>
<p>set of options for each step. Though you should use driver options whenever possible,</p>
<p>the linker accepts a small set of options that the driver does not recognize. Be careful</p>
<p>when using linker-specific options, because they are not processed by the driver</p>
<p>and may conflict with driver options. To pass an option directly to the linker:</p>
<p>Use the<b> LinkerâAdditional Linker Options (before start file)</b> option (<b>-lnk=</b>).</p>
<p>See âAdditional Linker Options (before start file)â on page 240 for more information</p>
<p>about this option.</p>
<p>It is never necessary to invoke the linker directly; always specify linker-specific</p>
<p>options through the driver.</p>
<p><b>Note</b></p>
<p>During the C compilation process, an underscore (â</p>
<p>_</p>
<p>â) is added to the</p>
<p>beginning of all function and variable names. Consequently, when</p>
<p>specifying a function or variable name as the argument to a linker option,</p>
<p>you must add an underscore so that the linker can recognize the name in</p>
<p>the object file. Linker options that take function or variable names as</p>
<p>arguments include<b> -u</b>,<b> -keep</b>, and<b> -e</b>.</p>
<p>For example, to retain the function</p>
<p>foo</p>
<p>, when instructing the linker to</p>
<p>perform function deletion, you would pass the following options:</p>
<p><b>elxr</b> -delete -keep=_foo file.o</p>
<p>The following table lists linker-specific options:</p>
<p><b>-allabsolute</b></p>
<p>Imports all absolute symbols, not just those required. For use with the<b> -A</b> driver option (see</p>
<p>âImport Symbolsâ on page 247).</p>
<p><b>-allow_bad_relocations</b></p>
<p>Emits only warnings when encountering bad or unknown relocations. The default behavior is</p>
<p>to generate errors.</p>
<p><i>471</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Linker-Specific Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-any_p_align</b></p>
<p>Does not set an upper bound on the value of the</p>
<p>p_align</p>
<p>field in ELF program headers.</p>
<p><b>-max_p_align=<i>n</b></i></p>
<p>Limits the maximum value of the</p>
<p>p_align</p>
<p>field set in ELF program headers to</p>
<p><i>n</i></p>
<p>bytes. This</p>
<p>field is set based on the maximum section alignment requirement of sections contained by this</p>
<p>header, unless it would exceed the</p>
<p>max_p_align</p>
<p>value.</p>
<p><b>-no_p_align</b></p>
<p>Always sets the</p>
<p>p_align</p>
<p>field in ELF program headers to</p>
<p>0</p>
<p>. This option may allow a small</p>
<p>amount of alignment padding within ELF files, but it does not set the field in the program header.</p>
<p><b>-append</b></p>
<p>Suppresses warnings concerning object file sections that do not appear in the section map.</p>
<p><b>-earlyabsolute</b></p>
<p>Imports absolute symbols before searching libraries. For use with the<b> -A</b> driver option (see</p>
<p>âImport Symbolsâ on page 247).</p>
<p><b>-extractall</b></p>
<p>Forces all object files from libraries to be included in the executable. This option is different</p>
<p>from the<b> -extractall=</b> driver option in that it affects all libraries, not just the one specified (see</p>
<p>âForce All Symbols From Libraryâ on page 246).</p>
<p><b>-extractweak</b></p>
<p>Pulls in object files from libraries if they provide a definition for an undefined weak reference.</p>
<p>Normally, object files are only pulled in from a library if they provide a definition for an</p>
<p>undefined non-weak reference.</p>
<p><b>-help</b></p>
<p>Displays a list of the most commonly used linker options.</p>
<p><b>-Help</b></p>
<p>Displays a list of all available linker options.</p>
<p><b>-keep=<i>symbol</b></i></p>
<p>Prevents the deletion of the function pointed to by<i> symbol</i> when you specify the<b> -delete</b> option.</p>
<p>If you are using wholeprogram optimizations, you may also need to use âSymbols Referenced</p>
<p>Externallyâ on page 170.</p>
<p><b>-mapfile_type=<i>n</b></i></p>
<p>Controls the output format of symbols in the map file. Valid options are:</p>
<p>â¢</p>
<p><b>-mapfile_type=0</b> â MULTI 5.1 and earlier format</p>
<p>â¢</p>
<p><b>-mapfile_type=1</b> â [default] MULTI 5.2 and later format</p>
<p>â¢</p>
<p><b>-mapfile_type=2</b> â Detailed format.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>472</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-no_append</b></p>
<p>Promotes warnings concerning sections that do not appear in the section map to errors.</p>
<p><b>-no_crom</b></p>
<p>Disables the use of compressed ROM. Sections that are specified as compressed ROM copies</p>
<p>(through use of the attribute</p>
<p>CROM</p>
<p>) are treated as if they were specified as ROM copies using</p>
<p>the</p>
<p>ROM</p>
<p>attribute. For more information about the</p>
<p>CROM</p>
<p>attribute, see âUsing Section Attributesâ</p>
<p>on page 490.</p>
<p><b>-no_map_renaming</b></p>
<p>Does not include master section names for remapped sections in map file output.</p>
<p><b>-nosegments_always_executable</b></p>
<p>By default, the linker sets the execute bit (</p>
<p>p_flags &amp; 0x1</p>
<p>) on all ELF program headers,</p>
<p>meaning that code can be executed from any segment. If you pass this option to the linker, it</p>
<p>sets the program header execute bit only for segments that have at least one input section that</p>
<p>has its execute bit (</p>
<p>sh_flags &amp; 0x4</p>
<p>) set.</p>
<p><b>-no_uncompressed_copy</b></p>
<p>By default, the linker creates a notes section called</p>
<p>.UNCOMPRESSED<i>secname</i></p>
<p>for each</p>
<p>compressed ROM section<i> secname</i>. For example, the linker would create</p>
<p>.UNCOMPRESSED.text</p>
<p>for the</p>
<p>.text</p>
<p>section. This notes section contains an uncompressed copy of the section's contents</p>
<p>for use by the debugger. This notes section does not increase the size of the program image in</p>
<p>memory, but it does increase the size of the ELF file itself. Use<b> -no_uncompressed_copy</b> to</p>
<p>disable the generation of</p>
<p>.UNCOMPRESSED</p>
<p>notes sections, resulting in smaller ELF files and</p>
<p>limiting your ability to debug CROM sections.</p>
<p><b>-no_xda_modifications</b></p>
<p>By default, the linker will accept out-of-range SDA relocations if the destination symbol is</p>
<p>within the ROM SDA (if enabled) region or ZDA region. It will also accept out-of-range ROM</p>
<p>SDA relocations if the destination symbol is within the SDA (if enabled) region or ZDA region,</p>
<p>and similarly out-of-range ZDA relocations. The linker achieves this by modifying the relocated</p>
<p>instruction to use the appropriate base register. Customers requiring that the linker not modify</p>
<p>instruction operands other than the immediate may find this option useful. However,</p>
<p><b>-no_xda_modifications</b> is necessary for some C++ programs to link without generating a linker</p>
<p>error.</p>
<p><b>-prog2</b></p>
<p>Produces exactly two segments: one to contain sections</p>
<p>.text</p>
<p>and</p>
<p>.rodata</p>
<p>, and the other to</p>
<p>contain</p>
<p>.data</p>
<p>and</p>
<p>.bss</p>
<p>.</p>
<p><b>-retainlocals</b></p>
<p>By default, the linker strips most local module symbols from the ELF output, retaining only</p>
<p>global symbols in the new symbol table. If you pass this option, local symbol names remain a</p>
<p>part of the final image.</p>
<p><i>473</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Linker-Specific Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-T<i> file.ld</b></i></p>
<p>Reads additional options, memory maps, and section maps from the linker directives file<i> file.ld</i>.</p>
<p>You do not need to pass this option manually, because the driver determines the correct<b> -T</b></p>
<p>options to pass to the linker.</p>
<p><b>-unalign_debug_sections</b></p>
<p>Overrides the section alignment specified in object files and forces</p>
<p>.debug</p>
<p>sections to have a</p>
<p>1-byte alignment.</p>
<p><b>-underscore</b></p>
<p>Adds an underscore to the beginning of all symbols created at link time.</p>
<p><b>-unweak<i> symbol</b></i></p>
<p>If any undefined weak reference to<i> symbol</i> exists, it is promoted to a normal undefined reference.</p>
<p><b>-v</b></p>
<p>Prints verbose information about the activities of the linker, including the libraries it searches</p>
<p>to resolve undefined symbols.</p>
<p><b>-V</b></p>
<p>Displays the version number and copyright information for<b> elxr</b>.</p>
<p><b>-vimport</b></p>
<p>Prints information about why modules are pulled in from libraries. This information is a subset</p>
<p>of the information provided by<b> -v</b>.</p>
<p><b>-w</b></p>
<p>Suppresses linker warnings.</p>
<p><b>-wrap<i> sym</b></i></p>
<p>Resolves external references to</p>
<p>_<i>sym</i></p>
<p>to</p>
<p>___wrap_<i>sym</i></p>
<p>, and external references to</p>
<p>___real_<i>sym</i></p>
<p>to</p>
<p>_<i>sym</i></p>
<p>. This corresponds to C symbol names of</p>
<p><i>sym</i></p>
<p>,</p>
<p>__wrap_<i>sym</i></p>
<p>, and</p>
<p>__real_<i>sym</i></p>
<p>. This</p>
<p>can be used to provide your own wrapper function that can be called instead of the original</p>
<p>function from a library.</p>
<p>For example, if a third party library defines:</p>
<p>void critical_section(void);</p>
<p>you can check the calls to</p>
<p>critical_section()</p>
<p>by passing<b> -wrap</b></p>
<p>critical_section</p>
<p>to</p>
<p>the linker, and then define the following:</p>
<p>void __wrap_critical_section(void)</p>
<p>{</p>
<p>assert(is_safe_to_call_critical_section());</p>
<p>__real_critical_section();</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>474</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Specifying the Program Entry Point</b></p>
<p>Use the<b> LinkerâStart Address Symbol</b> option (<b>-e</b>) to specify the program entry</p>
<p>point.</p>
<p>If you do not set this option, the linker sets the entry point to an item in the following</p>
<p>list (in descending order of preference):</p>
<p>â¢</p>
<p>The value of the symbol</p>
<p>_start</p>
<p>, if present</p>
<p>â¢</p>
<p>The value of the symbol</p>
<p>start</p>
<p>, if present</p>
<p>â¢</p>
<p>The value of the symbol</p>
<p>_main</p>
<p>, if present</p>
<p>â¢</p>
<p>The value of the symbol</p>
<p>main</p>
<p>, if present</p>
<p>â¢</p>
<p>The zero address</p>
<p>If the entry symbol is copied from ROM to RAM during program startup, the entry</p>
<p>point is in the ROM version of the entry symbol.</p>
<p><b>Configuring the Linker with Linker Directives Files</b></p>
<p>This section explains how to use linker directives (<b>.ld</b>) files to define program</p>
<p>sections and assign those sections to memory blocks. The names, address, and sizes</p>
<p>of memory blocks are defined in a<i> memory map</i>. The names, attributes, and locations</p>
<p>of sections are defined in a<i> section map</i>. This section also describes linker directives</p>
<p>file syntax, describes the four linker directives, and discusses some advanced topics:</p>
<p>â¢</p>
<p>âLinker Directives File Syntaxâ on page 476</p>
<p>â¢</p>
<p>âSetting Linker Options with the OPTION Directiveâ on page 476</p>
<p>â¢</p>
<p>âSetting Defaults with the DEFAULTS Directiveâ on page 477</p>
<p>â¢</p>
<p>âDefining a Memory Map with the MEMORY Directiveâ on page 479</p>
<p>â¢</p>
<p>âDefining a Section Map with the SECTIONS Directiveâ on page 481</p>
<p>â¢</p>
<p>âModifying your Section Map for Speed or Sizeâ on page 498</p>
<p>â¢</p>
<p>âCustomizing the Run-Time Environment Program Sectionsâ on page 499</p>
<p>When you create a project with the<b> Project Wizard</b>, it generates default linker</p>
<p>directives files for various program layouts for your board. If you want to write</p>
<p>your own linker directives file, we recommend that you copy one of these default</p>
<p><i>475</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Specifying the Program Entry Point</i></p>
<h1 style="page-break-before:always; "></h1>
<p>files and modify it. For information about these default files, see âWorking with</p>
<p>Linker Directives Filesâ on page 80.</p>
<p>Use caution when removing program sections from the default section map, because</p>
<p>the Green Hills run-time environment might use them (see âCustomizing the</p>
<p>Run-Time Environment Program Sectionsâ on page 499).</p>
<p><b>Note</b></p>
<p>If you specify multiple linker directives files,<b> elxr</b> processes those files</p>
<p>in the order you specify them. If you define a memory map and section</p>
<p>map in separate files, you must specify the file containing the memory</p>
<p>map first.</p>
<p><b>Linker Directives File Syntax</b></p>
<p>This section covers general linker directives file syntax and expressions. For</p>
<p>information about syntax for a specific directive, see the documentation for that</p>
<p>directive.</p>
<p>â¢</p>
<p>Expressions â include all standard C assignment operators with their normal</p>
<p>precedence, as well as operators that have side effects. The following sections</p>
<p>indicate where you can use expressions in each directive.</p>
<p>â¢</p>
<p>Comments â begin with the number symbol (</p>
<p>#</p>
<p>) or two forward slashes (</p>
<p>//</p>
<p>).</p>
<p>If you use the<b> LinkerâPreprocess Linker Directives</b> option, you must use</p>
<p>forward slashes when writing comments.</p>
<p>â¢</p>
<p>The dot symbol (</p>
<p>.</p>
<p>) â evaluates to the linker's current position in laying out</p>
<p>memory blocks or sections. You can change the value of the dot symbol using</p>
<p>expressions.</p>
<p><b>Setting Linker Options with the OPTION Directive</b></p>
<p>You can include the linker options listed in âLinker-Specific Optionsâ on page 471</p>
<p>in a linker directives file using the following syntax:</p>
<p>OPTION (&quot;<i>option</i>â¦&quot;)</p>
<p>You cannot use expressions in the</p>
<p>OPTION</p>
<p>directive.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>476</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>This directive is provided for backwards compatibility; we recommend</p>
<p>that you specify linker options using the driver.</p>
<p><b>Example 9.1. Writing an OPTION Directive</b></p>
<p>This example defines an</p>
<p>OPTION</p>
<p>directive that specifies the<b> -extractweak</b> and</p>
<p><b>-append</b> options:</p>
<p>OPTION (&quot;-extractweak -append&quot;)</p>
<p><b>Note</b></p>
<p>You can also use the</p>
<p>OPTION</p>
<p>directive to specify which files you want</p>
<p>to link, using the following syntax:</p>
<p>OPTION (&quot;<i>file</i>&quot;)</p>
<p><b>Setting Defaults with the DEFAULTS Directive</b></p>
<p>Defaults are strings that you can use in place of absolute values when defining</p>
<p>section and memory maps in a linker directives file. Specify defaults with the</p>
<p>following syntax:</p>
<p>DEFAULTS {<i>name</i>=<i>value</i>â¦}</p>
<p>To set the default</p>
<p>foo</p>
<p>to the value</p>
<p>0x2000</p>
<p>, add the following line:</p>
<p>DEFAULTS {foo=0x2000}</p>
<p>You can specify multiple defaults by putting each default on its own line:</p>
<p>DEFAULTS {</p>
<p>foo = 0x2000</p>
<p>bar = 0x4000</p>
<p>}</p>
<p>You can use expressions in the</p>
<p>DEFAULTS</p>
<p>directive that include defaults set earlier</p>
<p>in the directive:</p>
<p>DEFAULTS {</p>
<p>foo = 0x2000</p>
<p><i>477</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Setting Defaults with the DEFAULTS Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p>// Set bar to 0x4000</p>
<p>bar = foo + 0x2000</p>
<p>}</p>
<p>When you specify an amount of memory, you can suffix the number of bytes with</p>
<p>M</p>
<p>to designate megabytes and</p>
<p>K</p>
<p>to designate kilobytes. You can also prefix the</p>
<p>number with</p>
<p>0x</p>
<p>to specify the amount in hexadecimal.</p>
<p><b>Note</b></p>
<p>If you specify a default with the</p>
<p>DEFAULTS</p>
<p>directive, you can change its</p>
<p>value at link time by passing the<b> -C</b> option (see âDefine Linker Constantâ</p>
<p>on page 246).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>478</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 9.2. Writing a DEFAULTS Directive</b></p>
<p>This example specifies a</p>
<p>DEFAULTS</p>
<p>directive that defines two defaults:</p>
<p>DEFAULTS {</p>
<p>// Set heap_reserve to 1048576</p>
<p>heap_reserve</p>
<p>= 1M</p>
<p>// Set stack_reserve to 524288</p>
<p>stack_reserve</p>
<p>= 512K</p>
<p>}</p>
<p><b>Defining a Memory Map with the MEMORY Directive</b></p>
<p>A memory map names and defines memory blocks on your target. Specify each of</p>
<p>the following elements to define a memory block:</p>
<p>MEMORY</p>
<p>{</p>
<p><i>memory_block</i>: ORIGIN=<i>origin_expression</i>, LENGTH=<i>length_expression</i></p>
<p>...</p>
<p>}</p>
<p>where:</p>
<p><i>memory_block</i></p>
<p>Specifies the name of a memory block.</p>
<p><i>origin_expression</i></p>
<p>Specifies the starting address of the memory block.</p>
<p><i>length_expression</i></p>
<p>Specifies the length of the memory block.</p>
<p>Expressions in the</p>
<p>MEMORY</p>
<p>directive can include:</p>
<p>â¢</p>
<p>defaults set in the</p>
<p>DEFAULTS</p>
<p>directive.</p>
<p>â¢</p>
<p>the dot symbol (</p>
<p>.</p>
<p>). In this context, the dot symbol evaluates to the first address</p>
<p>available after the end of the previous memory block.</p>
<p>If you pass a memory map to the linker, only the memory blocks named and defined</p>
<p>in it can be referenced in an associated section map.</p>
<p><i>479</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Defining a Memory Map with the MEMORY Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 9.3. Writing a MEMORY Directive</b></p>
<p>In this example, the</p>
<p>MEMORY</p>
<p>directive defines a memory map with two blocks:</p>
<p>DEFAULTS {</p>
<p>heap_reserve</p>
<p>= 1M</p>
<p>stack_reserve</p>
<p>= 512K</p>
<p>}</p>
<p>MEMORY</p>
<p>{</p>
<p>fast_memory</p>
<p>: ORIGIN = 0x80000000, LENGTH = 10M</p>
<p>slow_memory</p>
<p>: ORIGIN = 0xbfc00000, LENGTH = 10M</p>
<p>}</p>
<p>This memory map defines the memory blocks</p>
<p>fast_memory</p>
<p>, which begins at</p>
<p>0x80000000</p>
<p>, and</p>
<p>slow_memory</p>
<p>, which begins at</p>
<p>0xbfc0000</p>
<p>. They are both 10</p>
<p>megabytes in size.</p>
<p><b>Reserved Memory Blocks</b></p>
<p>Sometimes the default Green Hills linker directives files contain reserved memory</p>
<p>blocks. Typically, this is done to avoid using memory that preconfigured software</p>
<p>on your target, such as a monitor, already uses.</p>
<p>Reserved memory blocks are just like any other memory blocks, except that you</p>
<p>should not allocate sections to them.</p>
<p>MEMORY {</p>
<p>// 10MB of dram starting at 0x80000000</p>
<p>dram_rsvd1</p>
<p>: ORIGIN = 0x80000000, LENGTH = 32K</p>
<p>dram_memory</p>
<p>: ORIGIN = .,</p>
<p>LENGTH = 10M -32K</p>
<p>dram_rsvd2</p>
<p>: ORIGIN = .,</p>
<p>LENGTH = 0</p>
<p>// 10MB of flash starting at 0xbfc00000</p>
<p>flash_rsvd1</p>
<p>: ORIGIN = 0xbfc00000, LENGTH = 32K</p>
<p>flash_memory : ORIGIN = .,</p>
<p>LENGTH = 10M-32K</p>
<p>flash_rsvd2</p>
<p>: ORIGIN = .,</p>
<p>LENGTH = 0</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>480</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Defining a Section Map with the SECTIONS Directive</b></p>
<p>A section map maps each section in each object file to a program section. The section</p>
<p>map also maps program sections to memory blocks. Format a section map as follows:</p>
<p>SECTIONS</p>
<p>{</p>
<p><i>secname</i> [<i>start_expression</i>] [<i>attributes</i>] : [{<i> contents</i> }] [&gt;<i> memory_block</i>,â¦ | &gt;.]</p>
<p>...</p>
<p>}</p>
<p>where:</p>
<p><i>secname</i></p>
<p>Specifies name of the section.</p>
<p><i>start_expression</i></p>
<p>Specifies the starting address of the section. If you specify both<i> start_expression</i> and</p>
<p><i>memory_block</i>,<i> start_expression</i> takes precedence.</p>
<p><i>attributes</i></p>
<p>Specifies section attributes. You can use expressions in attribute parameters. For a list of section</p>
<p>attributes, see âUsing Section Attributesâ on page 490.</p>
<p>{<i> contents</i> }</p>
<p>Specifies the contents of the section. It contains<i> section inclusion commands</i> that dictate which</p>
<p>sections from which object files to place into the section, and assignments that create or modify</p>
<p>objects. You can use an unlimited number of commands and assignments.</p>
<p>&gt;<i> memory_block</i>,â¦ | &gt;.</p>
<p>Allocates the section to the memory block named<i> memory_block</i>, defined in the memory map.</p>
<p>If you specify both<i> start_expression</i> and<i> memory_block</i>,<i> start_expression</i> takes precedence.</p>
<p>Expressions in the</p>
<p>SECTIONS</p>
<p>directive can include:</p>
<p>â¢</p>
<p>defaults defined in the</p>
<p>DEFAULTS</p>
<p>directive.</p>
<p>â¢</p>
<p>memory blocks defined in the</p>
<p>MEMORY</p>
<p>directive.</p>
<p>â¢</p>
<p>the dot symbol (</p>
<p>.</p>
<p>). In this context, the dot symbol evaluates to the linker's</p>
<p>current position in laying out objects and sections.</p>
<p>â¢</p>
<p>ELF symbols defined in the object files passed to the linker.</p>
<p>â¢</p>
<p>the functions listed in âSECTIONS Directive Functionsâ on page 488.</p>
<p><i>481</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Defining a Section Map with the SECTIONS Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Specifying the Location of a Section</b></p>
<p>The following list describes where the linker allocates a section in memory depending</p>
<p>on how you specify<i> start_expression</i> and<i> memory_block</i>:</p>
<p>â¢</p>
<p>If you specify<i> start_expression</i>, the linker allocates the section starting at the</p>
<p>address<i> start_expression</i>, whether or not you specify<i> memory_block</i>.</p>
<p>â¢</p>
<p>If you specify just<i> memory_block</i>, the linker allocates the section starting at</p>
<p>the first available address in<i> memory_block</i>. If the section does not fit, the linker</p>
<p>returns an error.</p>
<p>â¢</p>
<p>If you do not specify<i> start_expression</i>, but you specify the dot symbol for</p>
<p><i>memory_block</i>, the linker allocates the section directly after the previous section,</p>
<p>in the same memory block. If the section does not fit, the linker returns an error.</p>
<p>â¢</p>
<p>If you do not specify<i> start_expression</i>, but you specify a comma-separated list</p>
<p>of memory blocks for<i> memory_block</i>, the linker allocates the section to the</p>
<p>first specified memory block with enough remaining space to hold it.</p>
<p>â¢</p>
<p>If you do not specify either<i> start_expression</i> or<i> memory_block</i>, the linker</p>
<p>allocates the section directly after the previous section, in the same memory</p>
<p>block. If the section does not fit, the linker allocates the section to the first</p>
<p>memory block with enough remaining space to hold it.</p>
<p>No matter whether the linker determines the start address from<i> start_expression</i> or</p>
<p><i>memory_block</i>, it might increase the address to satisfy the alignment requirements</p>
<p>of its contents. For example, say you have the following directive:</p>
<p>SECTIONS {</p>
<p>.text</p>
<p>0x10001 :</p>
<p>}</p>
<p>The final executable's</p>
<p>.text</p>
<p>section might be located at</p>
<p>0x10004</p>
<p>instead of</p>
<p>0x10001</p>
<p>if the</p>
<p>.text</p>
<p>section of any object file the linker places in this section</p>
<p>requires 4-byte alignment.</p>
<p><b>Example 9.4. Writing a SECTIONS Directive</b></p>
<p>In this example, the</p>
<p>SECTIONS</p>
<p>directive defines a section map that tells the linker</p>
<p>where to place the</p>
<p>.text</p>
<p>,</p>
<p>.data</p>
<p>,</p>
<p>.bss</p>
<p>, and custom</p>
<p>.mydata</p>
<p>sections in memory</p>
<p>on your target:</p>
<p>DEFAULTS {</p>
<p>heap_reserve</p>
<p>= 1M</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>482</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>stack_reserve</p>
<p>= 512K</p>
<p>}</p>
<p>MEMORY</p>
<p>{</p>
<p>fast_memory</p>
<p>: ORIGIN = 0x80000000, LENGTH = 10M</p>
<p>other_memory : ORIGIN = 0xbfc00000, LENGTH = 8M</p>
<p>slow_memory</p>
<p>: ORIGIN = 0xf2c00000, LENGTH = 10M</p>
<p>}</p>
<p>SECTIONS</p>
<p>{</p>
<p>// Place .text into fast_memory. Fail if it does not fit.</p>
<p>.text</p>
<p>: &gt; fast_memory</p>
<p>// Place .data into fast_memory after .text, or into other_memory if .data</p>
<p>// cannot fit into fast_memory, or into slow_memory if .data cannot fit</p>
<p>// into other_memory. Otherwise, fail.</p>
<p>.data</p>
<p>:</p>
<p>// Place .bss after .data. Fail if it does not fit in the same memory block.</p>
<p>.bss</p>
<p>: &gt;.</p>
<p>// Place .mysection starting at the first available address in fast_memory.</p>
<p>// If it does not fit, place it into other_memory instead.</p>
<p>.mysection</p>
<p>: &gt; fast_memory, other_memory</p>
<p>}</p>
<p><b>Specifying Multiple Memory Blocks for a Section</b></p>
<p>If you specify a single memory block for a section, and the section does not fit in</p>
<p>that memory block, the linker returns an error. If you specify multiple memory</p>
<p>blocks, the linker places the section in the first specified memory block with enough</p>
<p>remaining space to hold it (see Example 9.4. Writing a SECTIONS Directive</p>
<p>on page 482).</p>
<p>On targets that support Small Data Area (SDA) optimization, be careful when using</p>
<p>a comma-separated list of memory blocks with SDA sections. For example, it is</p>
<p>dangerous to write:</p>
<p>SECTIONS {</p>
<p>...</p>
<p>.sbss</p>
<p>: &gt; fast_but_small_memory, slow_but_large_memory</p>
<p>.sdata</p>
<p>: &gt; fast_but_small_memory, slow_but_large_memory</p>
<p>...</p>
<p>}</p>
<p>because</p>
<p>.sdata</p>
<p>and</p>
<p>.sbss</p>
<p>must be contiguous in memory. When using this section</p>
<p>map, the linker might put</p>
<p>.sbss</p>
<p>in the</p>
<p>fast_but_small_memory</p>
<p>block and</p>
<p>.sdata</p>
<p>in the</p>
<p>slow_but_large_memory</p>
<p>block (or vice versa, if</p>
<p>.sbss</p>
<p>does not</p>
<p>fit in the</p>
<p>fast_but_small_memory</p>
<p>block but</p>
<p>.sdata</p>
<p>does). Therefore, you</p>
<p><i>483</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Defining a Section Map with the SECTIONS Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p>should not use this syntax on SDA sections. See âSpecial Data Area Optimizationsâ</p>
<p>on page 96 for more information.</p>
<p><b>Writing Section Inclusion Commands</b></p>
<p>Section inclusion commands are part of the</p>
<p>{<i> contents</i> }</p>
<p>parameter in a line in</p>
<p>the section map. By default, the linker places each section from each object file into</p>
<p>the program section with the same name. If there is no program section with the</p>
<p>same name, the linker creates a new program section at the end of the current section</p>
<p>map and emits a warning (to silence or promote these warnings, see the<b> -append</b></p>
<p>and<b> -no_append</b> linker options).</p>
<p>If you want to change this behavior, use section inclusion commands to dictate</p>
<p>which sections from which object files the linker should place into each section of</p>
<p>the program. The linker executes section inclusion commands in the order that it</p>
<p>encounters them in the linker directives file. They use the syntax</p>
<p><i>filename</i>(<i>section_name</i>)</p>
<p>:</p>
<p>// Place the .data section from foo.o into .mydata</p>
<p>.mydata</p>
<p>:{ foo.o(.data) }</p>
<p>// Then, place .data sections from all remaining object files into .data</p>
<p>.data</p>
<p>:</p>
<p>Separate section inclusion commands with spaces, and write them in the order that</p>
<p>you want the linker to execute them:</p>
<p>// Place the .data section from foo.o and bar.o into .mydata</p>
<p>// The foo.o .data section goes first</p>
<p>.mydata</p>
<p>:{ foo.o(.data) bar.o(.data) }</p>
<p>If you want to place sections from a specific object file in a specific library into a</p>
<p>program section, include the library name using the form</p>
<p><i>library_name</i>(<i>filename</i>(<i>section_name</i>))</p>
<p>:</p>
<p>// Place the .data section from foo.o contained within lib.a into .mydata</p>
<p>.mydata</p>
<p>:{ lib.a(foo.o(.data)) }</p>
<p><b>Note</b></p>
<p>Do not include the full path to the library; use just the library name.</p>
<p>Library names are case-sensitive.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>484</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Using Wildcards in Section Inclusion Commands</p>
<p>Use an asterisk (â</p>
<p>*</p>
<p>â) in place of<i> filename</i> in a section inclusion command to specify</p>
<p>all object files passed to the linker:</p>
<p>// Place .data sections from all object files into .data</p>
<p>.data</p>
<p>:{ *(.data) }</p>
<p>Because the program section and the object file sections have the same name, you</p>
<p>do not need to specify a</p>
<p>{<i> contents</i> }</p>
<p>argument in this case, and the following</p>
<p>syntax is sufficient:</p>
<p>// Place .data sections from all object files into .data</p>
<p>.data</p>
<p>:</p>
<p>If the program section and object file sections have different names, you must</p>
<p>specify a</p>
<p>{<i> contents</i> }</p>
<p>argument:</p>
<p>// Place .data sections from all object files into .mydata</p>
<p>.mydata</p>
<p>:{ *(.data) }</p>
<p>You can also use wildcards inside<i> filename</i> and<i> section_name</i>. An asterisk (â</p>
<p>*</p>
<p>â)</p>
<p>matches multiple characters and a question mark (â</p>
<p>?</p>
<p>â) matches any single character.</p>
<p>When you use a wildcard in this fashion, surround the section inclusion command</p>
<p>in double quotes (</p>
<p>&quot;</p>
<p>):</p>
<p>// Place .text sections from all object files matching &quot;code_*.o&quot; into .mytext</p>
<p>.mytext</p>
<p>:{ &quot;code_*.o(.text)&quot; }</p>
<p>If you have multiple sections in your object files that have a similar naming</p>
<p>convention, you can use wildcards in a section inclusion command to assign them</p>
<p>all to the same section in the output executable:</p>
<p>// Place all sections matching &quot;.text_*&quot; into .mytext</p>
<p>.mytext</p>
<p>:{ &quot;*(.text_*)&quot; }</p>
<p>You can also use wildcards when specifying a library:</p>
<p>// Place .data sections from object files contained within lib.a into .mydata</p>
<p>.mydata</p>
<p>:{ lib.a(*(.data)) }</p>
<p>// Place .data sections from all other object files into .data</p>
<p>.data</p>
<p>:</p>
<p>By default, the linker will place sections matched by wildcards in the order they</p>
<p>are seen during linking. You can change this behavior by using the</p>
<p>SORT</p>
<p>or</p>
<p>SORT_BY_NAME</p>
<p>keyword on<i> section_name</i>s with wildcards. When using the</p>
<p>SORT</p>
<p><i>485</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Defining a Section Map with the SECTIONS Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p>or</p>
<p>SORT_BY_NAME</p>
<p>keyword, the linker will sort the sections into ascending order</p>
<p>by section name prior to placement.</p>
<p>// SORT all sections matching &quot;.bss.*&quot; before placing into .mybss</p>
<p>.mybss</p>
<p>:{&quot;*(SORT(.bss.*))&quot;}</p>
<p>Using the COMMON Section in Section Inclusion Commands</p>
<p>The</p>
<p>.bss</p>
<p>section of a fully linked executable contains all the data from the</p>
<p>.bss</p>
<p>section of each included object file. It also contains uninitialized global data from</p>
<p>the</p>
<p>COMMON</p>
<p>section. To instruct the linker to place</p>
<p>COMMON</p>
<p>data in a different section</p>
<p>from</p>
<p>.bss</p>
<p>data, use the</p>
<p>COMMON</p>
<p>keyword in a section inclusion command:</p>
<p>// Place all COMMON data into .mybss</p>
<p>.mybss</p>
<p>:{ *(COMMON) }</p>
<p>// Place all .bss data into .bss</p>
<p>.bss</p>
<p>:</p>
<p>To allocate only the</p>
<p>COMMON</p>
<p>data from the<b> main.o</b> object file to</p>
<p>.mybss</p>
<p>, enter the</p>
<p>following:</p>
<p>.mybss</p>
<p>:{ main.o(COMMON) }</p>
<p>You can also do this with the</p>
<p>.sbss</p>
<p>section and</p>
<p>SMALLCOMMON</p>
<p>, and the</p>
<p>.zbss</p>
<p>section and</p>
<p>ZEROCOMMON</p>
<p>.</p>
<p><b>Using Assignments</b></p>
<p>The syntax for an assignment is</p>
<p><i>symbol</i> =<i> expression</i>;</p>
<p>. You can set a symbol</p>
<p>to an absolute address or an address relative to a section.</p>
<p>â¢</p>
<p>To set a symbol to an absolute address, write the assignment on its own line</p>
<p>in the</p>
<p>SECTIONS</p>
<p>directive. The linker evaluates<i> expression</i> to an address, and</p>
<p>sets the symbol to that address. The dot symbol (</p>
<p>.</p>
<p>) evaluates to the absolute</p>
<p>address at the end of the last defined section.</p>
<p>â¢</p>
<p>To set a symbol to an address relative to a section, write the assignment inside</p>
<p>the</p>
<p>{<i> contents</i> }</p>
<p>parameter for that section. The linker evaluates<i> expression</i></p>
<p>to an offset<i> n</i>, and sets the symbol to an address<i> n</i> bytes from the beginning of</p>
<p>the section. The dot symbol evaluates to the current offset from the beginning</p>
<p>of the section.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>486</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>You can assign addresses to symbols whether or not they exist:</p>
<p>â¢</p>
<p>If you assign an address to a non-existent symbol, the linker creates that symbol.</p>
<p>â¢</p>
<p>If you assign an address to an existing symbol, the linker reassigns that symbol</p>
<p>without moving any data associated with that symbol. For example, if you</p>
<p>assign an address to</p>
<p>main</p>
<p>, the linker causes relocations to</p>
<p>main</p>
<p>to point to the</p>
<p>new address, but it does not move the actual code for</p>
<p>main</p>
<p>to that address.</p>
<p>To add padding at the current position in a section, increment dot. If you decrease</p>
<p>the value of dot, the linker issues an error. The following example sets the symbol</p>
<p>foo</p>
<p>to the beginning of</p>
<p>.mysection</p>
<p>and adds 4 bytes of padding between</p>
<p>foo</p>
<p>and</p>
<p>bar</p>
<p>:</p>
<p>.mysection : { foo = .; . += 4; bar = .; }</p>
<p>Without this padding, the linker would assign the same address to both</p>
<p>foo</p>
<p>and</p>
<p>bar</p>
<p>.</p>
<p><b>Example 9.5. Working with Absolute and Relative Assignments</b></p>
<p>This example shows you how to set symbols to absolute addresses and addresses</p>
<p>relative to a section.</p>
<p>SECTIONS {</p>
<p>// Set alias to the same absolute address as printf</p>
<p>alias = printf;</p>
<p>// Assignments end with semicolons, but section inclusion commands do not.</p>
<p>.text : { alpha = 0; *(.text) beta = .; *(.text2) bad = printf; } &gt; dram_memory</p>
<p>// Set gamma to address 0</p>
<p>gamma = 0;</p>
<p>// Set delta to the end of the .text section</p>
<p>delta = .;</p>
<p>}</p>
<p>alias</p>
<p>,</p>
<p>gamma</p>
<p>, and</p>
<p>delta</p>
<p>are assigned absolute addresses, because they are not</p>
<p>defined inside the contents of any section.</p>
<p>alpha</p>
<p>,</p>
<p>beta</p>
<p>, and</p>
<p>bad</p>
<p>are assigned</p>
<p>addresses relative to the beginning of</p>
<p>.text</p>
<p>, because they are defined inside its</p>
<p>{</p>
<p><i>contents</i> }</p>
<p>parameter.</p>
<p>The linker assigns addresses to the symbols in</p>
<p>.text</p>
<p>as follows:</p>
<p>â¢</p>
<p>alpha</p>
<p>is located at offset</p>
<p>0</p>
<p>from the start of</p>
<p>.text</p>
<p>.</p>
<p><i>487</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Defining a Section Map with the SECTIONS Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>beta</p>
<p>is located in</p>
<p>.text</p>
<p>after the</p>
<p>.text</p>
<p>input sections, at the same address</p>
<p>as the first object in the</p>
<p>.text2</p>
<p>input sections.</p>
<p>â¢</p>
<p>bad</p>
<p>is located at an offset that is</p>
<p>printf</p>
<p>bytes from the start of</p>
<p>.text</p>
<p>. It is</p>
<p>not located at the same address as</p>
<p>printf</p>
<p>, because the assignment is relative</p>
<p>to the section. For example, if</p>
<p>.text</p>
<p>starts at</p>
<p>0x4000</p>
<p>and</p>
<p>printf</p>
<p>is located</p>
<p>at</p>
<p>0x4020</p>
<p>, then</p>
<p>bad</p>
<p>is located at</p>
<p>.text+0x4020</p>
<p>, or</p>
<p>0x8020</p>
<p>.</p>
<p><b>SECTIONS Directive Functions</b></p>
<p>The linker recognizes the following functions during expression evaluation in the</p>
<p>SECTIONS</p>
<p>directive. Their names are case-insensitive.</p>
<p>absolute(<i>expr</i>)</p>
<p>Given a section-relative offset value,</p>
<p>absolute</p>
<p>returns the absolute address by adding the</p>
<p>address of the containing section to<i> expr</i>. It is an error to use</p>
<p>absolute</p>
<p>outside of the braces</p>
<p>that specify a section's contents.</p>
<p>addr(<i>sectname</i>)</p>
<p>Returns the memory address of the section or memory block<i> sectname</i>.</p>
<p>align(<i>value</i>)</p>
<p>Returns the current position (</p>
<p>.</p>
<p>) aligned to a<i> value</i>-byte boundary.<i> value</i> must be a power of</p>
<p>two. This is equivalent to:</p>
<p>(. +<i> value</i> - 1) &amp; ~(<i>value</i> - 1)</p>
<p>alignof(<i>sectname</i>)</p>
<p>Returns the alignment of the section<i> sectname</i>.</p>
<p>endaddr(<i>sectname</i>)</p>
<p>Returns the memory address of the current end of the section</p>
<p><i>sectname</i></p>
<p>, or the end of the</p>
<p>memory block<i> sectname</i>.</p>
<p>error(<i>&quot;string&quot;</i>)</p>
<p>Generates a linker error, displaying<i> string</i>, the current section's name and address, and the current</p>
<p>section offset.</p>
<p>final(<i>finalexpression</i> [<i>,earlyexpression</i>=<i>0</i>])</p>
<p>Evaluates the given expression only during the final layout pass. The linker evaluates the optional</p>
<p>second argument during all preceding passes. All symbols are expected to be resolved prior to</p>
<p>the final layout pass, but addresses are subject to change between passes.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>488</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>isdefined(<i>symbol</i>)</p>
<p>Returns</p>
<p>1</p>
<p>if<i> symbol</i> exists and is defined,</p>
<p>0</p>
<p>otherwise.</p>
<p>isweak(<i>symbol</i>)</p>
<p>Returns</p>
<p>1</p>
<p>if<i> symbol</i> is a weak global symbol,</p>
<p>0</p>
<p>otherwise.</p>
<p>memaddr(<i>sectname</i>)</p>
<p>See</p>
<p>addr</p>
<p>.</p>
<p>memendaddr(<i>sectname</i>)</p>
<p>See</p>
<p>endaddr</p>
<p>.</p>
<p>min(<i>value1</i>,<i>value2</i>)</p>
<p>max(<i>value1</i>,<i>value2</i>)</p>
<p>Returns the minimum or maximum, respectively, of the two values supplied.</p>
<p>pack_or_align(<i>value</i>)</p>
<p>Returns the current position (</p>
<p>.</p>
<p>) aligned such that the section cannot span a page boundary of</p>
<p>size<i> value</i>. Generally, you only use this expression as the<i> start_expression</i> for a section map. It</p>
<p>is equivalent to:</p>
<p>((. % value)+sizeof(this_section)&gt;value?align(value):.)</p>
<p>provide</p>
<p>(<i>name</i> =<i> expr</i>)</p>
<p>If the symbol</p>
<p><i>name</i></p>
<p>is not yet defined, then this is equivalent to</p>
<p><i>name</i> =<i> expr</i></p>
<p>. Otherwise, it is</p>
<p>equivalent to</p>
<p><i>expr</i></p>
<p>.</p>
<p>sizeof(<i>sectname</i>)</p>
<p>Returns the current size of the section<i> sectname</i>, or the size of the memory block<i> sectname</i>.</p>
<p><i>489</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Defining a Section Map with the SECTIONS Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 9.6. Incrementing the Address of an Existing Symbol</b></p>
<p>Depending on your target and the optimizations you enable, the linker might perform</p>
<p>program layout multiple times. When necessary, use the</p>
<p>final()</p>
<p>function to ensure</p>
<p>that the linker evaluates an expression during the final layout only.</p>
<p>For example, say that if the symbol</p>
<p>func</p>
<p>exists, you want to increment its address</p>
<p>by one. The following assignment might cause the linker to increment the address</p>
<p>of</p>
<p>func</p>
<p>multiple times:</p>
<p>// Incorrect - might increment multiple times</p>
<p>.text : { isdefined(func) ? (func += 1) : 0; }</p>
<p>Instead, use the</p>
<p>final()</p>
<p>function to ensure that the linker increments the address</p>
<p>of</p>
<p>func</p>
<p>once:</p>
<p>// Correct - only increments during the final layout</p>
<p>.text : { final(isdefined(func) ? (func += 1):0); }</p>
<p><b>Using Section Attributes</b></p>
<p>Use the following attributes to configure section behavior:</p>
<p>ABS</p>
<p>Sets a flag in the output file that indicates that this section has an absolute address and should</p>
<p>not be moved. Program loaders and other utilities that manipulate the output image should not</p>
<p>include this section in any movement related to position independent code or position independent</p>
<p>data.</p>
<p>ALIGN(<i>n</i>)</p>
<p>Aligns the start address of the section to the byte boundary given by<i> n</i>.</p>
<p>AT(<i>expr</i>)</p>
<p>LOAD(<i>expr</i>)</p>
<p>These attributes specify an expression<i> expr</i> that indicates the address where the section will be</p>
<p>loaded in memory. This is only relevant if the address the section is linked to is different than</p>
<p>the address where the section should be loaded.</p>
<p>Note that</p>
<p>AT</p>
<p>, unlike</p>
<p>LOAD</p>
<p>, must be placed after the</p>
<p>:</p>
<p>in the section map. This is mainly used</p>
<p>for enhanced compatibility with GNU linker directives files.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>490</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>CLEAR</p>
<p>NOCLEAR</p>
<p>Sets or removes the</p>
<p>CLEAR</p>
<p>attribute of the section. If</p>
<p>CLEAR</p>
<p>is set, the linker makes an entry</p>
<p>for the section in the run-time clear table. Startup code often uses this table to initialize memory</p>
<p>blocks to zero (see âRun-Time Clear and Copy Tablesâ on page 511).</p>
<p>If RAM initialization at startup is enabled, the linker also makes an entry for the section set with</p>
<p>CLEAR</p>
<p>attribute in the run-time RAM initialization table. Startup code uses this table to initialize</p>
<p>memory blocks in RAM before it clears them to zero for these sections (see âRun-Time RAM</p>
<p>Initialization and RAM Initialization Tableâ on page 512).</p>
<p>CLEAR</p>
<p>is implicitly specified on the</p>
<p>.bss</p>
<p>section, as well as the</p>
<p>.sbss</p>
<p>section and</p>
<p>.zbss</p>
<p>section. All other sections default to</p>
<p>NOCLEAR</p>
<p>. If you direct the linker to include</p>
<p>COMMON</p>
<p>,</p>
<p>ZEROCOMMON</p>
<p>, or</p>
<p>SMALLCOMMON</p>
<p>data in any other section, you should specify the</p>
<p>CLEAR</p>
<p>attribute</p>
<p>for that section. For suggested uses, see Example 9.8. Using CLEAR and NOCLEAR on page 494.</p>
<p>FILL(<i>value</i>)</p>
<p>Initializes the section to byte pattern<i> value</i> at run-time by making an entry in the run-time clear</p>
<p>table (see âRun-Time Clear and Copy Tablesâ on page 511). The section must have the</p>
<p>CLEAR</p>
<p>attribute set either explicitly or by default. If the</p>
<p>CLEAR</p>
<p>attribute is not set, the linker ignores</p>
<p>the</p>
<p>FILL</p>
<p>attribute. Only the least significant byte of<i> value</i> is used.</p>
<p>MAX_ENDADDRESS(<i>address</i>)</p>
<p>Causes the linker to generate an error if the section extends beyond<i> address</i> during final layout.</p>
<p>MAX_SIZE(<i>size</i>)</p>
<p>Causes the linker to generate an error if the section exceeds<i> size</i> bytes in length.</p>
<p>MIN_ENDADDRESS(<i>address</i>)</p>
<p>Instructs the linker to pad with zeros, if necessary, to ensure that the section extends to at least</p>
<p><i>address</i>.</p>
<p>MIN_SIZE(<i>size</i>)</p>
<p>Instructs the linker to pad with zeros, if necessary, to ensure that the section is at least<i> size</i> bytes</p>
<p>in length.</p>
<p>NOCHECKSUM</p>
<p>Instructs the linker to output the section without a checksum. This overrides the effect of the</p>
<p><b>-checksum</b> option for an individual section.</p>
<p>NOLOAD</p>
<p>Instructs the linker to output the section as</p>
<p>SHT_NOBITS</p>
<p>. The linker allocates the section into</p>
<p>the target image, but discards its contents.</p>
<p><i>491</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Defining a Section Map with the SECTIONS Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p>PAD(<i>value</i>)</p>
<p>Places<i> value</i> bytes of padding (in zeros) at the beginning of the section. This is equivalent to</p>
<p>specifying padding at the beginning of the section contents.</p>
<p>For example, the following two definitions are equivalent:</p>
<p>.stack pad(0x10000) : {}</p>
<p>.stack</p>
<p>: { . += 0x10000; }</p>
<p>ROM(<i>sect_name</i>)</p>
<p>CROM(<i>sect_name</i>)</p>
<p>ROM_NOCOPY(<i>sect_name</i>)</p>
<p>These attributes allocate the contents of a section named<i> sect_name</i> to ROM at link time, while</p>
<p>reserving space for the data to be copied to RAM. The</p>
<p>ROM</p>
<p>and</p>
<p>CROM</p>
<p>options instruct the linker</p>
<p>to put an entry in the real-time ROM copy table and compressed ROM copy table, respectively,</p>
<p>so that the Green Hills startup code copies the section from ROM to RAM. If RAM initialization</p>
<p>at startup is enabled, these options also instruct the linker to put an entry in the run-time RAM</p>
<p>initialization table, so the startup code will initialize the memory blocks in RAM for these</p>
<p>sections, before copying the images from ROM to RAM (see âRun-Time RAM Initialization</p>
<p>and RAM Initialization Tableâ on page 512).</p>
<p>CROM</p>
<p>compresses its copy by as much as</p>
<p>40%</p>
<p>to</p>
<p>50%</p>
<p>, and thus can greatly reduce the amount</p>
<p>of ROM required for your application. For more information, see âCopying a Section from</p>
<p>ROM to RAM at Startupâ on page 495.</p>
<p>ROM_NOCOPY</p>
<p>behaves like the</p>
<p>ROM</p>
<p>section attribute except that it does not instruct the linker to</p>
<p>put an entry in the real-time ROM copy table. As a result, the Green Hills startup code will not</p>
<p>copy the section from</p>
<p>ROM</p>
<p>to</p>
<p>RAM</p>
<p>. Use this option when you want to use your own startup code</p>
<p>for copying a section from ROM to RAM.</p>
<p>Uncompressed ROM sections that may be referenced by startup code before being copied should</p>
<p>maintain the same order and relative offsets for the ROM copies as their RAM equivalents.</p>
<p>SHFLAGS(<i>expr</i>)</p>
<p>Sets the</p>
<p>sh_flags</p>
<p>field of the section's ELF header to the given expression<i> expr</i>.</p>
<p>For example, to specify that a section should be given the</p>
<p>SHF_ALLOC</p>
<p>and</p>
<p>SHF_WRITE</p>
<p>flags,</p>
<p>use:</p>
<p>SHFLAGS(0x3)</p>
<p>For more information, see âSection Attribute Flagsâ on page 924.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>492</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 9.7. Setting the Size of the Stack and Heap</b></p>
<p>This example demonstrates how to set the size and alignment of the</p>
<p>.stack</p>
<p>and</p>
<p>.heap</p>
<p>sections using section attributes:</p>
<p>DEFAULTS {</p>
<p>heap_reserve</p>
<p>= 1M</p>
<p>stack_reserve</p>
<p>= 512K</p>
<p>}</p>
<p>MEMORY</p>
<p>{</p>
<p>fast_memory</p>
<p>: ORIGIN = 0x80000000, LENGTH = 10M</p>
<p>slow_memory</p>
<p>: ORIGIN = 0xbfc00000, LENGTH = 10M</p>
<p>}</p>
<p>SECTIONS</p>
<p>{</p>
<p>.text</p>
<p>: &gt; fast_memory</p>
<p>.data</p>
<p>: &gt; .</p>
<p>.bss</p>
<p>: &gt; .</p>
<p>.heap</p>
<p>ALIGN(8) PAD(heap_reserve)</p>
<p>: &gt; .</p>
<p>.stack</p>
<p>ALIGN(8) PAD(stack_reserve) : &gt; .</p>
<p>}</p>
<p>The</p>
<p>.heap</p>
<p>section has two attributes,</p>
<p>ALIGN</p>
<p>and</p>
<p>PAD</p>
<p>.</p>
<p>ALIGN(8)</p>
<p>directs the linker</p>
<p>to place</p>
<p>.heap</p>
<p>at an address that is a multiple of 8, regardless of the size of the</p>
<p>sections before it.</p>
<p>PAD(heap_reserve)</p>
<p>uses the</p>
<p>heap_reserve</p>
<p>default, and</p>
<p>effectively sets the size of the heap to 1 MB.</p>
<p>The</p>
<p>.stack</p>
<p>section has the same two attributes as the heap.</p>
<p>All of the sections following</p>
<p>.text</p>
<p>use the dot (</p>
<p>.</p>
<p>) in place of a memory block, so</p>
<p>the linker places them consecutively in</p>
<p>fast_memory</p>
<p>after</p>
<p>.text</p>
<p>. If all of the</p>
<p>sections do not fit into</p>
<p>fast_memory</p>
<p>, the linker returns an error.</p>
<p>If RAM initialization at startup is enabled, the linker will put an entry for both</p>
<p>.heap</p>
<p>and</p>
<p>.stack</p>
<p>sections in the run-time RAM initialization table so the memory</p>
<p>blocks in RAM for these sections will be initialized before they can be used for</p>
<p>heap and stack (see âRun-Time RAM Initialization and RAM Initialization Tableâ</p>
<p>on page 512).</p>
<p><i>493</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Defining a Section Map with the SECTIONS Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 9.8. Using CLEAR and NOCLEAR</b></p>
<p>This example shows you how to use the</p>
<p>CLEAR</p>
<p>and</p>
<p>NOCLEAR</p>
<p>attributes to control</p>
<p>whether or not the linker puts an entry for a section into the run-time clear table.</p>
<p>For more information about the table, and how startup code uses it to initialize</p>
<p>sections to zero, see âRun-Time Clear and Copy Tablesâ on page 511.</p>
<p>The following line specifies the</p>
<p>.bss</p>
<p>section:</p>
<p>.bss</p>
<p>:</p>
<p>By default, the linker makes an entry for</p>
<p>.bss</p>
<p>in the run-time clear table. When</p>
<p>the program starts, it will initialize all data in this section to zero.</p>
<p>This line describes a section named</p>
<p>.mybss</p>
<p>:</p>
<p>.mybss</p>
<p>CLEAR :{*(COMMON)}</p>
<p>{*(COMMON)}</p>
<p>directs the linker to put COMMON data in this section (see âUsing</p>
<p>the COMMON Section in Section Inclusion Commandsâ on page 486).</p>
<p>CLEAR</p>
<p>directs</p>
<p>the linker to make an entry in the clear table for</p>
<p>.mybss</p>
<p>. When the program starts,</p>
<p>it will initialize data in this section to zero.</p>
<p>You can also use</p>
<p>CLEAR</p>
<p>for the heap:</p>
<p>.heap CLEAR PAD(0x100000) :</p>
<p>By default, the linker does not make an entry in the run-time clear table for sections</p>
<p>other than</p>
<p>.bss</p>
<p>,</p>
<p>.zbss</p>
<p>, and</p>
<p>.sbss</p>
<p>.</p>
<p>CLEAR</p>
<p>overrides this behavior, so the linker</p>
<p>makes an entry for</p>
<p>.heap</p>
<p>.</p>
<p>PAD(0x100000)</p>
<p>adds 1 MB of padding to the beginning</p>
<p>of</p>
<p>.heap</p>
<p>, effectively setting the size of the heap to 1 MB. When the program starts,</p>
<p>it will allocate 1 MB of RAM for this section, and initialize it to zero.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>494</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Copying a Section from ROM to RAM at Startup</p>
<p>Use the</p>
<p>ROM</p>
<p>and</p>
<p>CROM</p>
<p>attributes to control whether or not the linker puts an entry</p>
<p>for a section into one of the run-time copy tables. Startup code uses these tables to</p>
<p>determine which sections to copy to RAM at startup. For more information about</p>
<p>these tables, see âRun-Time Clear and Copy Tablesâ on page 511.</p>
<p>If RAM initialization at startup is enabled, the linker also puts an entry for a section</p>
<p>specified with</p>
<p>ROM</p>
<p>or</p>
<p>CROM</p>
<p>attribute into the run-time RAM initialization table.</p>
<p>Startup code uses this table to initialize the memory blocks for the section in RAM,</p>
<p>before copying or decompressing its copy in</p>
<p>ROM</p>
<p>(see âRun-Time RAM Initialization</p>
<p>and RAM Initialization Tableâ on page 512).</p>
<p>When defining a new section with the</p>
<p>ROM</p>
<p>or</p>
<p>CROM</p>
<p>attributes:</p>
<p>â¢</p>
<p>The name of the new section must be</p>
<p>.ROM.<i>sect</i></p>
<p>, where<i> sect</i> is the name of</p>
<p>the existing section.<i> sect</i> must not include any periods (</p>
<p>.</p>
<p>).</p>
<p>â¢</p>
<p>The</p>
<p>ROM</p>
<p>or</p>
<p>CROM</p>
<p>attribute must also specify<i> sect</i>.</p>
<p>Do not specify section contents or any other attributes for the new section; the new</p>
<p>section inherits the attributes and contents of the existing section, and the existing</p>
<p>section becomes a placeholder in RAM. You cannot create multiple</p>
<p>ROM</p>
<p>or</p>
<p>CROM</p>
<p>copies of the same section.</p>
<p>For example, to place the</p>
<p>.data</p>
<p>section in ROM with instructions to have it copied</p>
<p>to RAM at startup, include the following lines in your section map:</p>
<p>.data</p>
<p>: &gt; RAM_memory_block</p>
<p>...</p>
<p>// Create a copy of .data in ROM and</p>
<p>// create an entry in the run-time ROM copy table</p>
<p>.ROM.data</p>
<p>ROM(.data) : &gt; ROM_memory_block</p>
<p>Startup code copies the ROM image of</p>
<p>.ROM.data</p>
<p>into the</p>
<p>.data</p>
<p>section, located</p>
<p>in RAM. If RAM initialization is enabled, startup code will initialize the</p>
<p>.data</p>
<p>section in RAM first before it copies the ROM image of</p>
<p>.ROM.data</p>
<p>(see âRun-Time</p>
<p>RAM Initialization and RAM Initialization Tableâ on page 512).</p>
<p>To place the</p>
<p>.text</p>
<p>section in compressed ROM with instructions to have it copied</p>
<p>to RAM at startup, include the following lines in your section map:</p>
<p><i>495</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Defining a Section Map with the SECTIONS Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.text</p>
<p>: &gt; RAM_memory_block</p>
<p>...</p>
<p>// Create a copy of .text, compress it in ROM, and</p>
<p>// create an entry in the run-time compressed ROM copy table</p>
<p>.CROM.text</p>
<p>CROM(.text) : &gt; ROM_memory_block</p>
<p>Startup code decompresses the compressed ROM image</p>
<p>.CROM.text</p>
<p>and copies</p>
<p>the decompressed image into the</p>
<p>.text</p>
<p>section, located in RAM. If RAM</p>
<p>initialization is enabled, startup code will initialize the</p>
<p>.text</p>
<p>section in RAM first</p>
<p>before it copies the decompressed image</p>
<p>.CROM.text</p>
<p>(see âRun-Time RAM</p>
<p>Initialization and RAM Initialization Tableâ on page 512).</p>
<p>If the placement of a section that is not a ROM copy or compressed ROM copy is</p>
<p>dependent on the size of a CROM section, you might get a link-time error.</p>
<p>Furthermore, relocations should not reference any symbols, including</p>
<p>__ghsbegin_<i>section</i></p>
<p>or</p>
<p>__ghsend_<i>section</i></p>
<p>, whose locations depend on the</p>
<p>size of a CROM section.</p>
<p>You can disable the effects of the CROM attribute by passing the option<b> -no_crom</b></p>
<p>on the command line (see âLinker-Specific Optionsâ on page 471). Sections marked</p>
<p>as</p>
<p>CROM</p>
<p>are still copied to ROM but are not compressed.</p>
<p><b>Example 9.9. Placing CROM Sections</b></p>
<p>The following section map generates errors because the placement of</p>
<p>.myrodata</p>
<p>depends on the size of</p>
<p>.CROM.mydata</p>
<p>and</p>
<p>.CROM.mytext</p>
<p>:</p>
<p>.mydata</p>
<p>: &gt;RAM</p>
<p>.mytext</p>
<p>:</p>
<p>...</p>
<p>.CROM.mydata</p>
<p>CROM(.mydata)</p>
<p>: &gt;ROM</p>
<p>.CROM.mytext</p>
<p>CROM(.mytext)</p>
<p>:</p>
<p>.myrodata</p>
<p>:</p>
<p>To correct this example, rearrange the sections so that only</p>
<p>CROM.mytext</p>
<p>depends</p>
<p>on the size of</p>
<p>.CROM.mydata</p>
<p>:</p>
<p>.mydata</p>
<p>: &gt;RAM</p>
<p>.mytext</p>
<p>:</p>
<p>...</p>
<p>.myrodata</p>
<p>: &gt;ROM</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>496</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.CROM.mydata</p>
<p>CROM(.mydata)</p>
<p>:</p>
<p>.CROM.mytext</p>
<p>CROM(.mytext)</p>
<p>:</p>
<p><i>497</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Defining a Section Map with the SECTIONS Directive</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Modifying your Section Map for Speed or Size</b></p>
<p>The<b> Project Wizard</b> (see the documentation about creating a project in the<i> MULTI:</i></p>
<p><i>Managing Projects and Configuring the IDE</i> book) provides a variety of default</p>
<p>linker directives files with section maps that either maximize the speed or minimize</p>
<p>the size of your program by varying the number of sections copied to RAM at</p>
<p>startup. You can control this feature by manually editing your section map.</p>
<p><b>Maximizing Execution Speed</b></p>
<p>Because access times for RAM are better than for ROM on most hardware, your</p>
<p>program will generally execute faster if all of its sections are copied from ROM to</p>
<p>RAM at startup. The Green Hills startup code copies from ROM to RAM those</p>
<p>sections identified with the</p>
<p>ROM</p>
<p>attribute (see âCopying a Section from ROM to</p>
<p>RAM at Startupâ on page 495).</p>
<p>If you want to use custom code instead of the Green Hills startup code to copy</p>
<p>sections from ROM to RAM, see âCustomizing the Run-Time Environment Program</p>
<p>Sectionsâ on page 499 and âRun-Time Clear and Copy Tablesâ on page 511.</p>
<p><b>Minimizing RAM Usage</b></p>
<p>To minimize RAM usage, you must ensure that as few program sections as possible</p>
<p>are copied to RAM at startup.</p>
<p>If a section does not change at run time, you do not need to copy it to RAM.</p>
<p>Although you must generally copy</p>
<p>.data</p>
<p>to RAM, the Green Hills compiler will</p>
<p>use the</p>
<p>.rodata</p>
<p>section for variables that do not change at run time. The</p>
<p>.rodata</p>
<p>section should be placed in the link map adjacent to the program</p>
<p>.text</p>
<p>section.</p>
<p>This will cause the data to be put into ROM along with the program text.</p>
<p>The</p>
<p>.rodata</p>
<p>section should be placed in the link map adjacent to the program</p>
<p>.text</p>
<p>section, causing this data to be put into ROM along with the program text.</p>
<p>If you use the SDA optimization (see âSpecial Data Area Optimizationsâ</p>
<p>on page 96), some data that would normally go into the</p>
<p>.rodata</p>
<p>section might be</p>
<p>placed in the</p>
<p>.rosdata</p>
<p>section.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>498</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If you use the ZDA optimization (see âSpecial Data Area Optimizationsâ</p>
<p>on page 96), some data that would normally go into the</p>
<p>.rodata</p>
<p>section might be</p>
<p>placed in the</p>
<p>.rozdata</p>
<p>section.</p>
<p>If you use the TDA optimization (see âV850 Tiny Data Area (TDA) Optimizationâ</p>
<p>on page 107), some data that would normally go into the</p>
<p>.rodata</p>
<p>section might be</p>
<p>placed in the</p>
<p>.tdata</p>
<p>section.</p>
<p><b>Customizing the Run-Time Environment Program Sections</b></p>
<p>The following material describes the special program sections that are created for</p>
<p>and maintained by the Green Hills run-time environment system (the libraries</p>
<p><b>libsys.a</b> and<b> libstartup.a</b> and the module<b> crt0.o</b>). These sections appear in all the</p>
<p>default linker directives files provided with your distribution, and their contents are</p>
<p>generated automatically, so you should not explicitly add to them.</p>
<p><b>Note</b></p>
<p>Any attempt to explicitly place text or data into the following sections is</p>
<p>likely to produce unexpected results. When creating custom-named</p>
<p>sections, you must take care not to use any of the names of these special</p>
<p>sections. For more detailed descriptions of the functions that use these</p>
<p>linker directives and special sections to set up the run-time environment,</p>
<p>see âCustomizing the Run-Time Environment Libraries and Object</p>
<p>Modulesâ on page 863. You can also look at the comments in the</p>
<p>customizable source files, which are located in the<b> src/libsys</b> and</p>
<p><b>src/libstartup</b> directories.</p>
<p><b>.fixaddr and .fixtype</b></p>
<p>The compiler creates</p>
<p>.fixaddr</p>
<p>and</p>
<p>.fixtype</p>
<p>.</p>
<p>These two sections contain information that enables the Green Hills startup code</p>
<p>to relocate PIC/PID initializers of data variables. The compiler generates data in</p>
<p>the</p>
<p>.fixaddr</p>
<p>and</p>
<p>.fixtype</p>
<p>sections, if needed, when using PIC and/or PID. The</p>
<p>default Green Hills run-time libraries might already have information in these</p>
<p>sections, because many of these libraries are always built with PIC and PID.</p>
<p><i>499</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Customizing the Run-Time Environment Program Sections</i></p>
<h1 style="page-break-before:always; "></h1>
<p>These two sections contain read-only data and can be placed in ROM. Failure to</p>
<p>include these sections in the linker directives file might cause the linker to add them</p>
<p>to the end of the section list, which might cause the following warning:</p>
<p>[elxr] warning: section .fixaddr from libsys.a(ind_crt1.o)</p>
<p>isn't included by the section map;</p>
<p>appending after last section.</p>
<p>add to section map or use -append to append without warning</p>
<p>If your program has dynamic memory that expands past the end of the last specified</p>
<p>section in a section map, it might be fatal to append sections to the end of the section</p>
<p>map, because those sections might be overwritten. Therefore, you should include</p>
<p>these sections in section maps.</p>
<p><b>.heap</b></p>
<p>The linker creates the</p>
<p>.heap</p>
<p>section with the information from your section map.</p>
<p>It specifies the size and location of the run-time heap. This section is required when</p>
<p>using the Green Hills run-time libraries for dynamic memory allocation. A reference</p>
<p>to the special linker symbol</p>
<p>__ghsbegin_heap</p>
<p>, which denotes the beginning of</p>
<p>the</p>
<p>.heap</p>
<p>section, is located in the<b> ind_heap.c</b> module of the<b> libsys.a</b> library.</p>
<p>If you do not include a</p>
<p>.heap</p>
<p>section in your linker directives file, and your program</p>
<p>pulls in</p>
<p>ind_heap.o</p>
<p>, you will get one or more linker errors, such as the following:</p>
<p>[elxr] (error) unresolved symbols: 1</p>
<p>'__ghsbegin_heap' from libsys.a(ind_heap.o)</p>
<p>If you are not using the Green Hills run-time libraries, you can omit the</p>
<p>.heap</p>
<p>section from your linker directives file.</p>
<p>The Green Hills run-time libraries ensure that dynamic memory allocation does not</p>
<p>overrun the specified</p>
<p>.heap</p>
<p>area. The libraries do so by returning an error code</p>
<p>from</p>
<p>sbrk()</p>
<p>that causes</p>
<p>malloc()</p>
<p>and other memory allocation routines to return</p>
<p>a</p>
<p>NULL</p>
<p>pointer. Your code should always check for erroneous return values when</p>
<p>calling dynamic memory allocation routines. You can customize the Green Hills</p>
<p>sbrk()</p>
<p>routine, located in<b> ind_heap.c</b>, to avoid using the</p>
<p>.heap</p>
<p>section.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>500</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>.rodata</b></p>
<p>The compiler creates the</p>
<p>.rodata</p>
<p>section. Some Green Hills compilers place</p>
<p>read-only data (such as data declared with the C</p>
<p>const</p>
<p>specifier and string constants)</p>
<p>into a read-only section called</p>
<p>.rodata</p>
<p>. By convention, you place</p>
<p>.rodata</p>
<p>with</p>
<p>other sections that can be placed in ROM. Failure to include a</p>
<p>.rodata</p>
<p>section in</p>
<p>the section map may cause the linker to append it to the end of the section map. If</p>
<p>you compile your program with either<b> -pic</b> or<b> -pid</b>, it does not use this section.</p>
<p><b>ROM Sections</b></p>
<p>When the linker encounters a section directive that has the</p>
<p>ROM</p>
<p>attribute, it creates</p>
<p>a read-only copy of the section. For debugging purposes, a section that contains the</p>
<p>ROM</p>
<p>attribute should be named</p>
<p>.ROM<i>.sect</i></p>
<p>, where<i> .sect</i> is the name of the section</p>
<p>that is copied from ROM into RAM (see âCopying a Section from ROM to RAM</p>
<p>at Startupâ on page 495). The Green Hills startup code,<b> ind_crt0.c</b> (see âind_crt0.câ</p>
<p>on page 867), copies the data from the</p>
<p>.ROM<i>.sect</i></p>
<p>section to the<i> .sect</i> section when</p>
<p>copying initialized data from ROM to RAM.</p>
<p>If you want to use your own custom code to copy a section from ROM to RAM at</p>
<p>program startup, use the</p>
<p>ROM_NOCOPY</p>
<p>attribute when defining the ROM section.</p>
<p>When you use this attribute, the linker will not create an entry in the copy table,</p>
<p>and the Green Hills startup code will not copy the section from ROM to RAM. This</p>
<p>attribute behaves similarly to the</p>
<p>ROM</p>
<p>and</p>
<p>CROM</p>
<p>attributes.</p>
<p>If the custom code uses the copy table, use the</p>
<p>ROM</p>
<p>attribute. Then, disable the</p>
<p>Green Hills code that copies sections from ROM to RAM by modifying or deleting</p>
<p>code in<b> ind_crt0.c</b>.</p>
<p>If you do not need to copy sections from ROM to RAM, do not include</p>
<p>.ROM<i>.sect</i></p>
<p>sections or use the</p>
<p>ROM</p>
<p>,</p>
<p>CROM</p>
<p>, or</p>
<p>ROM_NOCOPY</p>
<p>attributes in your linker directives</p>
<p>file.</p>
<p><b>.sdabase, .sda_start, and .sda_end</b></p>
<p>For completeness, all section maps should include</p>
<p>.sda_start</p>
<p>and</p>
<p>.sda_end</p>
<p>,</p>
<p>regardless of whether the target supports the SDA optimization.</p>
<p><i>501</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Customizing the Run-Time Environment Program Sections</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If SDA is implemented, section maps must use</p>
<p>.sda_start</p>
<p>/</p>
<p>.sda_end</p>
<p>or</p>
<p>.sdabase</p>
<p>. The former method is recommended. To implement the recommended</p>
<p>method, place the</p>
<p>.sda_start</p>
<p>section (a dummy, zero-sized section) just prior to</p>
<p>the start of the sections that make up the SDA. Place the</p>
<p>.sda_end</p>
<p>section (also</p>
<p>a dummy, zero-sized section) just after the last SDA section. The Green Hills startup</p>
<p>code will initialize the SDA base register using these sections.</p>
<p>To implement the latter method, place</p>
<p>.sdabase</p>
<p>just prior to the start of the sections</p>
<p>that make up the SDA. The Green Hills startup code will initialize the SDA base</p>
<p>register using the address of this section.</p>
<p><b>.secinfo</b></p>
<p>.secinfo</p>
<p>is a special section output by the Green Hills linker that contains</p>
<p>information about the section layout of programs. The startup code,<b> ind_crt0.c</b>,</p>
<p>uses this information to determine which sections must be cleared (for example,</p>
<p>.bss</p>
<p>sections) and which sections must be copied (for example, ROM sections) at</p>
<p>program startup. This section is read-only and thus can be placed in ROM. Failure</p>
<p>to include this section in the link map causes the linker to append it to the end of</p>
<p>the section map. The following three section flags control the information placed</p>
<p>in the</p>
<p>.secinfo</p>
<p>section:</p>
<p>â¢</p>
<p>a</p>
<p>â allocated for downloading</p>
<p>â¢</p>
<p>w</p>
<p>â writable</p>
<p>â¢</p>
<p>x</p>
<p>â executable</p>
<p>For example:</p>
<p>.section &quot;.foo&quot;, &quot;aw&quot;</p>
<p>.section &quot;.bar&quot;, &quot;ax&quot;</p>
<p>Consult the extensive comments in the<b> ind_crt0.c</b> file for further documentation</p>
<p>on the automatic copy/clear feature.</p>
<p>The linker allows a program to obtain the locations, sizes, and types of its sections</p>
<p>at run time. If the symbol</p>
<p>__secinfo</p>
<p>is referenced but not defined in a program,</p>
<p>the linker fills in additional section information in the</p>
<p>.secinfo</p>
<p>section and sets</p>
<p>the</p>
<p>__secinfo</p>
<p>symbol to point to it. The<b> indsecinfo.h</b> header file in the<b> src/libsys</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>502</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>directory of your distribution has a declaration for this structure and a sample</p>
<p>program that shows its use.</p>
<p><b>.stack</b></p>
<p>.stack</p>
<p>specifies your intended stack area and size, although there is no general</p>
<p>mechanism for ensuring that the stack will stay within the limits specified by the</p>
<p>.stack</p>
<p>section. Green Hills startup code (when running in stand-alone mode) and</p>
<p>debug servers initialize the stack pointer of a process based on this</p>
<p>.stack</p>
<p>section.</p>
<p>When building programs to run under an operating system that does not allow</p>
<p>user-specification of the stack area, an empty</p>
<p>.stack</p>
<p>section can still be included</p>
<p>in the section map to resolve references in the startup code. The reference to the</p>
<p>.stack</p>
<p>area in the Green Hills startup code (<b>crt0.o</b>) is used only when programs</p>
<p>are in stand-alone mode (that is, when they are not downloaded through the MULTI</p>
<p>Debugger). Use of the</p>
<p>.stack</p>
<p>section in the startup code can also be customized</p>
<p>by editing and rebuilding the<b> crt0.800</b> assembly module. The Debugger also allows</p>
<p>the initial stack pointer to be specified differently with each download of a program</p>
<p>via the special</p>
<p>_INIT_SP</p>
<p>variable; use of</p>
<p>_INIT_SP</p>
<p>supersedes use of a</p>
<p>.stack</p>
<p>section to locate the initial stack pointer.</p>
<p><b>.syscall</b></p>
<p>.syscall</p>
<p>contains the run-time library code for Green Hills emulation of system</p>
<p>calls. This section must be located in RAM if you use the Green Hills run-time</p>
<p>libraries for system call emulation. When system call emulation is not being handled</p>
<p>in this way, you can modify<b> ind_dots.800</b> to remove its dependency on the</p>
<p>.syscall</p>
<p>section (see âind_call.800, ind_dots.800â on page 869).</p>
<p><b>Symbol Definitions</b></p>
<p>The linker recognizes several symbols that, if referenced but not defined in the</p>
<p>source code, are given particular addresses corresponding to the final image.</p>
<p><b>Beginning, End, and Size of Section Symbols</b></p>
<p>When the linker performs final symbol resolution for a fully linked output file, it</p>
<p>recognizes that certain undefined symbols refer to memory addresses in the final</p>
<p><i>503</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Symbol Definitions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>section map. The names of these symbols are</p>
<p>__ghsbegin<i>section</i></p>
<p>,</p>
<p>__ghsend<i>section</i></p>
<p>, and</p>
<p>__ghssize<i>section</i></p>
<p>, where<i> section</i> is the name of each</p>
<p>section in the output file, with any dot (</p>
<p>.</p>
<p>) characters changed to underscores (â</p>
<p>_</p>
<p>â).</p>
<p>For example, for a section named</p>
<p>.text</p>
<p>, the symbols</p>
<p>__ghsbegin_text</p>
<p>and</p>
<p>__ghsend_text</p>
<p>resolve to the absolute addresses of the beginning and end of the</p>
<p>section, while</p>
<p>__ghssize_text</p>
<p>refers to its size.</p>
<p>For a section map containing these lines:</p>
<p>SECTIONS</p>
<p>{</p>
<p>.bss1</p>
<p>0x400000:</p>
<p>.bss:</p>
<p>}</p>
<p>and this portion of<b> main.c</b> program code:</p>
<p>extern char __ghsbegin_bss1[], __ghssize_bss1[];</p>
<p>void foo() {</p>
<p>memset(__ghsbegin_bss1, 0, (size_t)__ghssize_bss1);</p>
<p>__ghsbegin_bss[0] = 0xff;</p>
<p>}</p>
<p>if the size of section</p>
<p>.bss1</p>
<p>is</p>
<p>0x100</p>
<p>, then the linker resolves the following labels:</p>
<p>__ghsbegin_bss1</p>
<p>to</p>
<p>0x400000</p>
<p>__ghsend_bss1</p>
<p>to</p>
<p>0x400100</p>
<p>__ghssize_bss1</p>
<p>to</p>
<p>0x100</p>
<p>__ghsbegin_bss</p>
<p>to</p>
<p>0x400100</p>
<p><b>End of Function Symbols</b></p>
<p>When the linker performs final symbol resolution for a fully linked output file, it</p>
<p>recognizes that symbols named</p>
<p>__ghs_eofn_<i>function</i></p>
<p>, where<i> function</i> is a</p>
<p>function name, refer to the memory addresses of the end of functions in the final</p>
<p>executable. For example, for function</p>
<p>foo</p>
<p>, the symbol</p>
<p>__ghs_eofn_foo</p>
<p>resolves</p>
<p>to the virtual address of the end of that function.</p>
<p>For example:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>504</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>extern void __ghs_eofn_foo(void);</p>
<p>int foo(int x) { return x+1; }</p>
<p>int main() {</p>
<p>printf(&quot;Size of foo is %d\n&quot;,</p>
<p>(int)__ghs_eofn_foo - (int)foo);</p>
<p>return 0;</p>
<p>}</p>
<p>If the function</p>
<p>foo</p>
<p>is at address</p>
<p>0x100000</p>
<p>and has size</p>
<p>0x20</p>
<p>bytes, then the linker</p>
<p>resolves</p>
<p>__ghs_eofn_foo</p>
<p>to be</p>
<p>0x100020</p>
<p>.</p>
<p><b>Linker Generated Tables</b></p>
<p>When the linker performs final symbol resolution for a fully linked output file, it</p>
<p>recognizes undefined symbols named</p>
<p>__ghstable_<i>tablename</i></p>
<p>as tables. When</p>
<p>it encounters one of these symbols, the linker resolves the symbol to a table that it</p>
<p>allocates to the read-only</p>
<p>.rodata</p>
<p>section. The linker fills the table with the</p>
<p>addresses of all defined symbols named</p>
<p>__ghsentry_<i>tablename</i>_<i>entryname</i></p>
<p>,</p>
<p>and then terminates it with a NULL pointer. The order of the entries within the table</p>
<p>is unpredictable. If the name of an entry symbol matches multiple tables that the</p>
<p>linker is filling, the entry is added to the table with the longest matching name.</p>
<p><b>Note</b></p>
<p>__ghstable_<i>tablename</i></p>
<p>is not supported with Position Independent</p>
<p>Code (PIC) or Position Independent Data (PID).</p>
<p>In the following example,</p>
<p>__ghstable_resetvectors</p>
<p>is an array of pointers to</p>
<p>functions. The array contains the addresses of</p>
<p>__ghsentry_resetvectors_foo()</p>
<p>and</p>
<p>__ghsentry_resetvectors_bar()</p>
<p>. The function</p>
<p>reset_all()</p>
<p>has the</p>
<p>effect of calling both functions.</p>
<p>extern void (* const __ghstable_resetvectors[])(void);</p>
<p>int foo = 5;</p>
<p>void __ghsentry_resetvectors_foo(void)</p>
<p>{</p>
<p>foo = 0;</p>
<p>}</p>
<p>double bar = 2.0;</p>
<p>void __ghsentry_resetvectors_bar(void)</p>
<p><i>505</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Linker Generated Tables</i></p>
<h1 style="page-break-before:always; "></h1>
<p>{</p>
<p>bar = 0.0;</p>
<p>}</p>
<p>void reset_all()</p>
<p>{</p>
<p>int i;</p>
<p>for (i = 0; __ghstable_resetvectors[i] != 0; ++i) {</p>
<p>(__ghstable_resetvectors[i])();</p>
<p>}</p>
<p>}</p>
<p>The linker also recognizes</p>
<p>__ghstableauto_<i>tablename</i></p>
<p>and</p>
<p>__ghstablealways_<i>tablename</i></p>
<p>, which behave similarly to</p>
<p>__ghstable_<i>tablename</i></p>
<p>, except with regard to whether a</p>
<p>__ghsentry_<i>tablename</i></p>
<p>symbol from a library will be pulled into a program that</p>
<p>contains a corresponding</p>
<p>__ghstable</p>
<p>.</p>
<p>A</p>
<p>__ghsentry_<i>tablename</i></p>
<p>symbol in a library will not be pulled in solely because</p>
<p>the program contains a corresponding</p>
<p>__ghstable_<i>tablename</i></p>
<p>symbol. It will</p>
<p>be pulled in from a library if that table is</p>
<p>__ghstableauto_<i>tablename</i></p>
<p>and an</p>
<p>entry of the same name has not already been defined elsewhere. It will be pulled in</p>
<p>from a library if the table is</p>
<p>__ghstablealways_<i>tablename</i></p>
<p>regardless of whether</p>
<p>an identical entry has been defined (possibly resulting in a multiply defined symbol</p>
<p>error message).</p>
<p><b>Forcing the Linker to Pull in a Module From a Library</b></p>
<p>Normally, the linker only pulls in an object file from a library when that file provides</p>
<p>a global definition for an unresolved, non-weak symbol. You can use the<b> -extractall</b></p>
<p>and<b> -extractweak</b> options to change this behavior. However, you may only want</p>
<p>the linker to pull in particular object files from the library. For this reason, the linker</p>
<p>searches each library for global symbols beginning with</p>
<p>__ghsalwaysimport</p>
<p>or</p>
<p>__ghsautoimport</p>
<p>. If it finds an object file that defines a symbol beginning with</p>
<p>__ghsautoimport</p>
<p>, the linker will pull in the file unless the symbol is already</p>
<p>defined. In contrast, if the linker finds an object file that defines a symbol beginning</p>
<p>with</p>
<p>__ghsalwaysimport</p>
<p>, the linker will pull in the file regardless of whether it</p>
<p>is already defined.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>506</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Note that bringing in a symbol that is already defined will result in an error unless</p>
<p>the symbol is common. As such, it is advisable to use different names in each file</p>
<p>for global symbols beginning with</p>
<p>__ghsalwaysimport</p>
<p>or</p>
<p>__ghsautoimport</p>
<p>.</p>
<p>For more information about common symbols, see âC/C++ Data Allocationâ</p>
<p>on page 216.</p>
<p><b>Deleting Unused Functions</b></p>
<p>The<b> -delete</b> option instructs the linker to remove functions that are not referenced</p>
<p>in the final executable. The linker iterates to find functions that do not have</p>
<p>relocations pointing to them and eliminates them. If a symbol is referenced by a</p>
<p>relocation in the first pass, it can still be eliminated in a subsequent pass if the</p>
<p>referencing symbol is eliminated. Note that the<b> -delete</b> option can increase the time</p>
<p>and memory required for linking.</p>
<p><b>Note</b></p>
<p>If you are hand-coding assembly and intend to use the<b> -delete</b> option,</p>
<p>you must properly identify assembly labels as functions or objects with</p>
<p>the proper size.</p>
<p>The linker supports<b> -delete</b> only for object files produced by the Green Hills</p>
<p>assembler. Other assemblers might produce object files that do not preserve</p>
<p>information required for<b> -delete</b> to function properly.</p>
<p><b>Tip</b></p>
<p>In cases where a symbol should never be deleted, use the<b> -u</b> driver option,</p>
<p><b>-keep=<i>funcname</b></i> linker option, or the</p>
<p>.need</p>
<p>assembler directive.</p>
<p>The</p>
<p>.need</p>
<p>assembler directive introduces an explicit dependency between</p>
<p>two symbols (usually functions) so that the linker keeps one function if</p>
<p>another function is used. For example, use this directive when you have</p>
<p>an assembly function that does not return, but instead falls through into</p>
<p>the next function in the file.</p>
<p>The linker never deletes symbols preserved by these methods, even if</p>
<p>the symbols appear unused. It is useful to preserve symbols such as</p>
<p>interrupt table entry points, non-standard entry-points, or other portions</p>
<p>of code not reached by normal control transfer within the program.</p>
<p><i>507</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Deleting Unused Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If your code is written in C++, the compiler mangles the names of some</p>
<p>symbols, and the names passed to these options must match the mangled</p>
<p>names. To find the mangled names, pass the options<b> --no_link_filter</b></p>
<p><b>-lnk=-v</b> and the linker will list them in its output (see âDemangling of</p>
<p>Names in Linker Messagesâ on page 311).</p>
<p>Compiler-generated profiling instrumentation or debugging information might</p>
<p>create references to unused functions, preventing the linker from deleting them. See</p>
<p><b>-ignore_debug_references</b> in âLink-Time Ignore Debug Referencesâ on page 244</p>
<p>for more information.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>508</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Advanced Linker Features</b></p>
<p><b>Code Factoring</b></p>
<p>Code factoring is a link-time optimization that reduces overall program size by</p>
<p>removing redundant segments of code from object files. It removes these segments</p>
<p>by using subroutine calls and tail merges. This optimization is useful for reducing</p>
<p>program size, but may decrease program speed by increasing the number of branches.</p>
<p>The standard libraries provided with the Green Hills tools for V850 and RH850 are</p>
<p>all prepared for code factoring.</p>
<p>To enable code factoring:</p>
<p>Set the<b> LinkerâLinker OptimizationsâCode Factoring</b> option to<b> On</b></p>
<p>(<b>-codefactor</b>).</p>
<p>Code factoring does not work with libraries by themselves, but does affect the size</p>
<p>on an executable that links with the library.</p>
<p><b>Note</b></p>
<p>Code factoring might cause DWARF debugging information to be out</p>
<p>of sync with the program in memory.</p>
<p><b>Example 9.10. Basic Code Factoring</b></p>
<p>To factor code from source files<b> foo.c</b> and<b> bar.c</b>, use:</p>
<p>ccv850 -codefactor -o hello foo.c bar.c</p>
<p>This command generates two object files,<b> foo.o</b> and<b> bar.o</b>. They are prepared for</p>
<p>code factoring, and then the driver passes them to the<b> elxr</b> linker, which performs</p>
<p>the optimization and links them into an executable,<b> hello</b>.</p>
<p><b>Example 9.11. Controlling the Scope of Code Factoring</b></p>
<p>The linker performs code factoring on a per-section basis. For example, if you have</p>
<p>the following in your section map:</p>
<p><i>509</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Advanced Linker Features</i></p>
<h1 style="page-break-before:always; "></h1>
<p>SECTIONS {</p>
<p>.footext : { foo1.o(.text) foo2.o(.text) }</p>
<p>.bartext : { bar1.o(.text) bar2.o(.text) }</p>
<p>}</p>
<p>â¢</p>
<p>The linker factors code from the</p>
<p>.text</p>
<p>sections of both</p>
<p>foo1.o</p>
<p>and</p>
<p>foo2.o</p>
<p>,</p>
<p>and places the optimized code into the</p>
<p>.footext</p>
<p>section.</p>
<p>â¢</p>
<p>The linker factors code from the</p>
<p>.text</p>
<p>sections of both</p>
<p>bar1.o</p>
<p>and</p>
<p>bar2.o</p>
<p>,</p>
<p>and places the optimized code into the</p>
<p>.bartext</p>
<p>section.</p>
<p>This behavior can be useful when you want to prevent code factoring from creating</p>
<p>dependencies between sections that must remain independent.</p>
<p><b>Example 9.12. Code Factoring and Incremental Linking</b></p>
<p>Code factoring runs during the final stage of linking, when the linker produces an</p>
<p>executable file. If you incrementally link your files before producing an executable,</p>
<p>pass the</p>
<p>-codefactor</p>
<p>option at each stage to ensure that the linker preserves the</p>
<p>necessary relocation and symbol information. For example, to generate a relocatable</p>
<p>object file<b> mod.o</b> from object files<b> foo.c</b> and<b> bar.c</b>, enter the following:</p>
<p>ccv850 -codefactor -relobj -o mod.o foo.c bar.c</p>
<p>This command generates the relocatable object file<b> mod.o</b>, and preserves all symbol</p>
<p>and relocation information. To subsequently generate a code factored executable,</p>
<p>enter the following:</p>
<p>ccv850 -codefactor mod.o -o hello</p>
<p>This command produces the code-factored executable,<b> hello</b>.</p>
<p><b>Example 9.13. Partial Code Factoring</b></p>
<p>It is possible to apply code factoring to only some of the modules that are linked</p>
<p>into the final executable. If<b> foo.c</b>,<b> bar.c</b>, and<b> baz.c</b> are to be linked together to</p>
<p>produce the executable<b> hello</b>, but only<b> bar.c</b> and<b> baz.c</b> are to be code factored, first</p>
<p>generate an object file from<b> foo.c</b>, as follows:</p>
<p>ccv850 -c foo.c</p>
<p>This command produces an object file named<b> foo.o</b>, which is excluded from code</p>
<p>factoring in any subsequent link.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>510</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Next, generate object files from<b> bar.c</b> and<b> baz.c</b>, using the</p>
<p>-codefactor</p>
<p>option,</p>
<p>as follows:</p>
<p>ccv850 -codefactor -c bar.c baz.c</p>
<p>This command produces the object files<b> bar.o</b> and<b> baz.o</b>, which are prepared for</p>
<p>subsequent code factoring.</p>
<p>Finally, generate an executable, as follows:</p>
<p>ccv850 -codefactor foo.o bar.o baz.o -o hello</p>
<p>This command produces an executable,<b> hello</b>, in which code factoring is applied</p>
<p>only to<b> bar.o</b> and<b> baz.o</b>.</p>
<p><b>Note</b></p>
<p>Hand-written assembly code files and mixed assembly and C/C++</p>
<p>source files (that is, C or C++ source files with</p>
<p>#pragma asm</p>
<p>,</p>
<p>asm</p>
<p>â¢</p>
<p>macros, etc.) cannot be code factored by default. For optimal results,</p>
<p>do not mix both assembly and C/C++ code within the same source</p>
<p>file. If code factoring of mixed assembly and C/C++ source files is</p>
<p>necessary, see</p>
<p>#pragma ghs safeasm</p>
<p>and</p>
<p>#pragma ghs optasm</p>
<p>in âGreen Hills Extension Pragma Directivesâ on page 799.</p>
<p>â¢</p>
<p>When using the MULTI Debugger, you cannot set breakpoints on</p>
<p>lines of source code that have been altered or removed by code</p>
<p>factoring. These lines of code display a red breakdot instead of a</p>
<p>green breakdot. Switch to interlaced source and assembly mode, and</p>
<p>then set breakpoints at the assembly level.</p>
<p>â¢</p>
<p>To control code factoring in the linker, the compiler generates a</p>
<p>number of</p>
<p>.ghsnote</p>
<p>assembler directives (which reside in the</p>
<p>non-allocated notes section</p>
<p>.ghsinfo</p>
<p>, and have no impact on final</p>
<p>code size). You should not modify these directives or the section</p>
<p>contents.</p>
<p><b>Run-Time Clear and Copy Tables</b></p>
<p>These three tables are contained within the</p>
<p>.secinfo</p>
<p>section.</p>
<p><i>511</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Run-Time Clear and Copy Tables</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>The<i> clear</i> table is bounded by the symbols</p>
<p>__ghsbinfo_clear</p>
<p>and</p>
<p>__ghseinfo_clear</p>
<p>.</p>
<p>â¢</p>
<p>The<i> copy</i> table is bounded by the symbols</p>
<p>__ghsbinfo_copy</p>
<p>and</p>
<p>__ghseinfo_copy</p>
<p>.</p>
<p>â¢</p>
<p>The<i> compressed copy</i> table is bounded by the symbols</p>
<p>__ghsbinfo_comcopy</p>
<p>and</p>
<p>__ghseinfo_comcopy</p>
<p>.</p>
<p>These tables each contain zero or more records detailing the action to be taken at</p>
<p>startup.</p>
<p>By default, the Green Hills C run-time library<b> libstartup.a</b> automatically clears</p>
<p>.bss</p>
<p>and copies</p>
<p>ROM</p>
<p>and decompressed</p>
<p>CROM</p>
<p>sections to RAM based on this table.</p>
<p>The actual implementation of the above three routines for your CRT code can be</p>
<p>found in<b> src/libstartup/ind_crt0.c</b> and<b> src/libstartup/ind_uzip.c</b> in your Green</p>
<p>Hills product and differs slightly for PIC/PID support on some targets.</p>
<p><b>Run-Time RAM Initialization and RAM Initialization Table</b></p>
<p>When a program is built to boot from ROM, it usually needs to copy some of the</p>
<p>program, such as initialized data and sometimes code, into RAM during</p>
<p>startup.Usually RAM can be accessed without initialization. However in some</p>
<p>hardware systems, RAM may need to be initialized or specially accessed (for</p>
<p>example, in 32-bit chunks) before it can be properly accessed in smaller sizes. To</p>
<p>support such hardware systems, the Green Hills startup code can be configured to</p>
<p>perform a RAM initialization pass to initialize all RAM memory blocks that the</p>
<p>program uses all at once, by utilizing a RAM initialization table that the linker</p>
<p>generates and places in the</p>
<p>.secinfo</p>
<p>section. The table is bounded by the symbols</p>
<p>__ghsbinfo_init</p>
<p>and</p>
<p>__ghseinfo_init</p>
<p>and contains records detailing the</p>
<p>sections that reside in RAM and should be initialized at startup, including sections</p>
<p>that have the</p>
<p>CLEAR</p>
<p>attribute (specified either explicitly or implicitly), sections that</p>
<p>must be copied from ROM (either compressed or uncompressed) to RAM,</p>
<p>.stack</p>
<p>and</p>
<p>.heap</p>
<p>.</p>
<p>By default, RAM initialization is disabled at startup. To enable RAM initialization,</p>
<p>use the<b> -init_ram_at_startup</b> driver option. When RAM initialization is enabled,</p>
<p>it is performed before the startup code clears uninitialized data section and copies</p>
<p>sections from ROM to RAM. One can also use the<b> -ram_init_val=<i>value</b></i> driver</p>
<p>option to specify a 32-bit word pattern for initializing RAM. If a pattern is not</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>512</i></p>
<p><i>Chapter 9. The elxr Linker</i></p>
<h1 style="page-break-before:always; "></h1>
<p>specified, RAM is initialized to zero by default. See âInitialize RAM at Startupâ</p>
<p>on page 271 and âRAM Initialization Valueâ on page 271 for more information.</p>
<p>RAM initialization is not supported for programs built with PIC or PID. It does not</p>
<p>take effect for programs built with the<b> Program Layout</b> option set to</p>
<p>Link to</p>
<p>and Execute out of RAM</p>
<p>(see âAssigning Program Sections to ROM and RAMâ</p>
<p>on page 90).</p>
<p>The actual implementation of RAM initialization can be found in</p>
<p><b>src/libstartup/ind_initmem.800</b> in your Green Hills product, which is a module</p>
<p>in<b> libstartup.a</b>.</p>
<p><i>513</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Run-Time RAM Initialization and RAM Initialization Table</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 10</b></p>
<p><b>The ax Librarian</b></p>
<p><b>Contents</b></p>
<p>Creating a Library from the Compiler Driver . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>516</p>
<p>Modifying Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>517</p>
<p>Creating and Updating a Table of Contents . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>522</p>
<p>The Green Hills 64-Bit Archive Format . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>522</p>
<h1 style="page-break-before:always; "></h1>
<p>The librarian combines object files created by the assembler or linker into a library</p>
<p>(or archive file). By convention, libraries have the<b> .a</b> extension. At link time, the</p>
<p>linker can search through libraries for object files, and pull them in to provide</p>
<p>definitions for undefined symbols.</p>
<p><b>Creating a Library from the Compiler Driver</b></p>
<p>To create a library using the compiler driver, use the following syntax:</p>
<p><b>ccv850<i></b> filename</i> ... -archive -o<i> libname</i>.a</p>
<p>where each<i> filename</i> is a source file or object file that you want to include in the</p>
<p>library, and<i><b> libname</i>.a</b> is the name of the library you want the librarian to create.</p>
<p>The compiler driver compiles and assembles the source files, and then runs the</p>
<p>librarian to create a library from the resulting object files.</p>
<p>If<i><b> libname</i>.a</b> already exists, the librarian inserts the new object files into the existing</p>
<p>library. If the existing library contains an object file that has the same name as one</p>
<p>of the new object files, the librarian overwrites the existing object file with the new</p>
<p>one.</p>
<p>Use the<b> âupdate_archive</b> option to force the librarian to delete all leftover object</p>
<p>files from the library. The builder uses this option when creating and updating</p>
<p>libraries. This option is ignored with the option<b> -merge_archive</b>.</p>
<p>To create a<i> merged library</i> â a library that merges together several existing libraries</p>
<p>and/or object files â use the following syntax:</p>
<p><b>ccv850<i></b> filename</i> ...<i> input_library.a</i> ... -merge_archive -o<i> output_library</i>.a</p>
<p><b>-merge_archive</b> is similar to<b> -archive</b>, with the following differences:</p>
<p>â¢</p>
<p>If<i><b> output_library</i>.a</b> exists, it is replaced.</p>
<p>â¢</p>
<p>The entire contents of each specified<i><b> input_library</i>.a</b> is added to the library</p>
<p>(libraries specified with<b> -l<i>file</b></i> are ignored unless the option<b> --whole-archive</b></p>
<p>is enabled). The contents of each input debug library (<b>.dba</b>) are added to the</p>
<p>output debug library.</p>
<p>â¢</p>
<p>Any input archives are passed to the prelinker after</p>
<p>--</p>
<p>. Templates that are</p>
<p>instantiated in the archive may be used, but may not be rebuilt.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>516</i></p>
<p><i>Chapter 10. The ax Librarian</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-merge_archive</b> is implemented by passing the<b> C</b> and<b> M</b> command modifiers to</p>
<p>the archiver (see âLibrarian Command Modifiersâ on page 519).</p>
<p>If you need a 64-bit format archive, pass the<b> -large_archive</b> option.</p>
<p><b>Example 10.1. How to Create a Library</b></p>
<p>To create a library<b> libfoo.a</b> from the source file<b> foo.c</b>, enter:</p>
<p>ccv850 foo.c -archive -o libfoo.a</p>
<p>To create a library<b> libhello.a</b> from the object files<b> hello.o</b> and<b> world.o</b>, enter:</p>
<p>ccv850 hello.o world.o -archive -o libhello.a</p>
<p><b>Modifying Libraries</b></p>
<p>You can modify libraries (<b>.a</b> files) by invoking the<b> ax</b> librarian directly, as follows:</p>
<p><b>ax<i></b> -command</i> [<i>modifier</i>]... [<i>-option</i>]...<i> libraryfile</i> ... [<i>memberfile</i>]...</p>
<p>where:</p>
<p>â¢</p>
<p><i>-command</i> is one of the librarian commands</p>
<p>â¢</p>
<p>each<i> modifier</i> is a command modifier</p>
<p>â¢</p>
<p>each<i> -option</i> is a librarian option</p>
<p>â¢</p>
<p><i><b>libraryfile</b></i> is the name of the file you want to modify, including the extension.</p>
<p>â¢</p>
<p>each<i><b> memberfile</b></i> is the name of the file (usually an object file) in the library</p>
<p>you want to perform the command on, including the extension.</p>
<p>The following tables list valid command letters, modifiers, and options.</p>
<p><b>Librarian Commands</b></p>
<p>This table lists each librarian command, including the modifiers that you can use</p>
<p>with it. The librarian command modifiers are explained in the subsequent table,</p>
<p>âLibrarian Command Modifiersâ on page 519. Enter the command and modifiers</p>
<p>as one string without spaces.</p>
<p><i>517</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Modifying Libraries</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-d</b> [e] [S] [v]<i> libraryfile memberfile</i> ...</p>
<p>Deletes each specified<i> memberfile</i> from the specified<i> libraryfile</i>.</p>
<p><b>-p</b> [e]<i> libraryfile memberfile</i> ...</p>
<p>Prints each specified<i> memberfile</i> from the specified<i> libraryfile</i> to standard output (if the members</p>
<p>are object files, then the output might not be human-readable).</p>
<p><b>-r</b> [c] [C] [e] [S] [n] [m] [M] [v] [u]<i> libraryfile memberfile</i> ...</p>
<p>Replaces each specified<i> memberfile</i> in the specified<i> libraryfile</i>. The new version of<i> memberfile</i></p>
<p>overwrites the existing version.</p>
<p>If<i> memberfile</i> does not already exist in<i> libraryfile</i>, the librarian adds it.</p>
<p>If<i> libraryfile</i> does not exist, the librarian creates it.</p>
<p>We recommend that you create libraries with the compiler driver and not with the librarian,</p>
<p>because only the compiler driver generates the<b> .dba</b> files necessary for subsequent debugging.</p>
<p><b>-t</b> [e] [s] [v]<i> libraryfile</i> ...</p>
<p>Lists the names of the files contained in each specified<i> libraryfile</i>. Use the<b> v</b> option to list names,</p>
<p>file sizes, and the dates that the members were last modified.</p>
<p><b>-x</b> [e] [v] [o]<i> libraryfile memberfile</i> ...</p>
<p>Extracts each specified<i> memberfile</i> from the specified<i> libraryfile</i> into the current directory. The</p>
<p>librarian does not alter<i> libraryfile</i>.</p>
<p>If you only specify<i> libraryfile</i>, the librarian extracts all member files.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>518</i></p>
<p><i>Chapter 10. The ax Librarian</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Librarian Command Modifiers</b></p>
<p>These modifiers can be appended to the librarian command letters to give you greater</p>
<p>control over operations on library files. See âLibrarian Commandsâ on page 517 to</p>
<p>determine which modifiers are available with each command letter.</p>
<p><b>c</b></p>
<p>Suppresses warnings when creating a library that did not exist.</p>
<p><b>C</b></p>
<p>Replaces the existing library.</p>
<p><b>e</b></p>
<p>Prefixes messages with</p>
<p>ERROR</p>
<p>or</p>
<p>WARNING</p>
<p>. Equivalent to the compiler driver option</p>
<p><b>-prefixed_msgs</b>.</p>
<p><b>n</b></p>
<p><b>m</b></p>
<p><b>M</b></p>
<p>These options control how the librarian handles input files that are libraries. They are mutually</p>
<p>exclusive.</p>
<p>â¢</p>
<p><b>n</b> â [default] The librarian treats all input files as complete units and does not consider</p>
<p>that the input file might be a collection of files. Each input library is placed in the output</p>
<p>library as one complete unit.</p>
<p>â¢</p>
<p><b>m</b> â The librarian places each member of each input library into the output library as a</p>
<p>separate file.</p>
<p>â¢</p>
<p><b>M</b> â Similar to<b> m</b>, but the names of the files are mangled by prepending the base name</p>
<p>of the archive to each file. The full path and file extension are not used in this mangling</p>
<p>scheme. This modifier reduces the likelihood that the archive will contain two files with</p>
<p>the same name.</p>
<p><b>o</b></p>
<p>Keeps original timestamps when extracting files from a library.</p>
<p><b>s</b></p>
<p>Regenerates the table of contents; use with the<b> -t</b> command.</p>
<p><b>S</b></p>
<p>Prevents the creation of a table of contents.</p>
<p><b>u</b></p>
<p>Replaces files only if the timestamp is newer (use with<b> -r</b>).</p>
<p><i>519</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Librarian Command Modifiers</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>v</b></p>
<p>Prints verbose messages when executing a command.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>520</i></p>
<p><i>Chapter 10. The ax Librarian</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Librarian Options</b></p>
<p>The following options are recognized on the command line before the name of the</p>
<p>library:</p>
<p><b>-display_toc</b></p>
<p>Used with the<b> t</b> command letter to display the table of contents and the offset of each member</p>
<p>file within the archive.</p>
<p><b>-pecoff</b></p>
<p>When generating the table of contents, this option also generates a Microsoft Windows compatible</p>
<p>table of contents.</p>
<p><b>-stderr=<i>errfile</b></i></p>
<p>Redirects error output of the librarian to the named file.</p>
<p><b>-tmp=<i>dir</b></i></p>
<p>Specifies the temporary directory.</p>
<p><b>-auto_large_archive</b></p>
<p>The archiver detects when to output a 64-bit archive and prints a warning when it does. If the</p>
<p>archiver takes a 64-bit archive as input but detects that it does not need a 64-bit output file, it</p>
<p>prints a warning and does not use the 64-bit format.</p>
<p><b>-quiet_auto_large_archive</b></p>
<p>The archiver detects when to output a 64-bit archive. If the archiver takes a 64-bit archive as</p>
<p>input but detects that it does not need a 64-bit output file, it does not use the 64-bit format. The</p>
<p>archiver does not print any warnings related to 64-bit archives.</p>
<p><b>-large_archive</b></p>
<p>The archiver always uses 64-bit archives. The archiver does not print any warnings related to</p>
<p>64-bit archives.</p>
<p><b>-no_large_archive</b></p>
<p>The archiver never uses 64-bit archives. The archiver does not print any warnings related to</p>
<p>64-bit archives, but it does print an error if it needs to truncate any values because the archive</p>
<p>format does not provide enough space.</p>
<p><b>Examples</b></p>
<p>To add a new object file<b> foo.o</b> to an existing library<b> lib.a</b>, enter:</p>
<p><b>ax</b> -r lib.a foo.o</p>
<p><i>521</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Librarian Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>To delete object files<b> foo.o</b> and<b> bar.o</b> from library<b> lib.a</b>, enter:</p>
<p><b>ax</b> -d lib.a foo.o bar.o</p>
<p>To extract object file<b> foo.o</b> from library<b> lib.a</b> and rename it to<b> newfoo.o</b>, enter:</p>
<p><b>ax</b> -p lib.a foo.o &gt; newfoo.o</p>
<p>To print the table of contents of library<b> lib.a</b> in verbose mode, enter:</p>
<p><b>ax</b> -tv lib.a</p>
<p><b>Creating and Updating a Table of Contents</b></p>
<p>The librarian creates a table of contents, by default, whenever it creates or modifies</p>
<p>a library. This improves the linker's performance, because the linker does not have</p>
<p>to create the table of contents every time it reads a library at link time. The librarian</p>
<p>stores the table of contents in a hidden member file named<b> /</b> (slash), which is always</p>
<p>the first file in the library.</p>
<p>To subsequently create or update a table of contents without altering the library,</p>
<p>use the<b> -t</b> command with the<b> s</b> option. For example, if you want to create a table of</p>
<p>contents for<b> lib.a</b>, enter:</p>
<p><b>ax</b> -ts lib.a</p>
<p><b>The Green Hills 64-Bit Archive Format</b></p>
<p>The<b> ax</b> archiver provides an extended archive format that allows archives to exceed</p>
<p>2 GB in size. The archiver attempts to detect that the extended format is needed</p>
<p>based on its input files. If the archiver detects that the extended format is necessary,</p>
<p>it prints the following message:</p>
<p>ax:warning: Total size of archive exceeds 2GB limit, switching to large</p>
<p>archive format. Pass -large_archive to suppress this message, or</p>
<p>-no_large_archive to force normal archive output.</p>
<p>If the archiver downgrades input files from the 64-bit archive format, it prints the</p>
<p>following message:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>522</i></p>
<p><i>Chapter 10. The ax Librarian</i></p>
<h1 style="page-break-before:always; "></h1>
<p>ax: warning: Input archive is large-format, but large format is not necessary.</p>
<p>Switching to normal-format archive. Use -large_archive to force large output,</p>
<p>or -no_large_archive to suppress this message.</p>
<p>For information about controlling 64-bit archive format selection and warnings, see</p>
<p>âOutput Archives in 64-Bit Formatâ on page 316.</p>
<p><b>Note</b></p>
<p>Because the large archive format is specific to Green Hills Tools, archives</p>
<p>in this format are not compatible with third-party linkers or other</p>
<p>third-party utilities.</p>
<p><i>523</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The Green Hills 64-Bit Archive Format</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 11</b></p>
<p><b>Utility Programs</b></p>
<p><b>Contents</b></p>
<p>The gaddr2line Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>529</p>
<p>The gasmlist Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>530</p>
<p>The gcores Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>532</p>
<p>The gbin2c Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>536</p>
<p>The gbincmp Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>545</p>
<p>The gbuild Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>547</p>
<p>The gcolor Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>556</p>
<p>The gcompare Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>561</p>
<p>The gdump Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>564</p>
<p>The gfile Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>571</p>
<p>The gfunsize Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>572</p>
<p>The ghide Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>573</p>
<p>The gmemfile Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>574</p>
<p>The gnm Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>581</p>
<p>The gpatch Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>586</p>
<p>The gpjmodify Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>588</p>
<p>The gsize Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>592</p>
<p>The gsrec Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>594</p>
<p>The gstack Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>600</p>
<p>The gstrip Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>620</p>
<p>The gversion Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>621</p>
<h1 style="page-break-before:always; "></h1>
<p>The gwhat Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>623</p>
<p>The mevundump Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>626</p>
<p>AUTOSAR and OSEK Operating System Awareness . . . . . . . . . . . . . . . . . . .</p>
<p>644</p>
<p>The protrans Utility . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>655</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>526</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The MULTI IDE includes many useful command line utility programs, including</p>
<p>functional replacements for the standard Linux/Solaris utilities<b> dump</b>,<b> file</b>,<b> hide</b>,</p>
<p><b>nm</b>,<b> size</b>,<b> strip</b>, and<b> what</b>. All utility programs work with files generated by any</p>
<p>Green Hills development tools.</p>
<p>â¢</p>
<p><b>gaddr2line</b>: Similar to the Linux/Solaris<b> addr2line</b> program. Maps addresses</p>
<p>to filenames and line numbers.</p>
<p>â¢</p>
<p><b>gasmlist</b>: Generates interlaced assembly and source output (object files only).</p>
<p>â¢</p>
<p><b>gbin2c</b>: Converts binary files into C array definitions.</p>
<p>â¢</p>
<p><b>gcores</b>: Combines multiple images into a multi-core archive</p>
<p>â¢</p>
<p><b>gbincmp</b>: Compares two binary files (single object files or executables only).</p>
<p>â¢</p>
<p><b>gbuild</b>: A command line interface to the MULTI Builder.</p>
<p>â¢</p>
<p><b>gcolor</b>: Takes text input and colors it using ANSI escape sequences.</p>
<p>â¢</p>
<p><b>gcompare</b>: Compares space or time performance.</p>
<p>â¢</p>
<p><b>gdump</b>: Similar to the Linux/Solaris<b> dump</b> program. Dumps or disassembles</p>
<p>a file.</p>
<p>â¢</p>
<p><b>gfile</b>: Similar to the Linux/Solaris<b> file</b> program. Describes the file type.</p>
<p>â¢</p>
<p><b>gfunsize</b>: Returns the code size of a function.</p>
<p>â¢</p>
<p><b>ghide</b>: Similar to the Linux/Solaris<b> hide</b> program. Hides global symbols in an</p>
<p>object file.</p>
<p>â¢</p>
<p><b>gmemfile</b>: Converts an executable file to a binary image suitable for loading.</p>
<p>â¢</p>
<p><b>gnm</b>: Similar to the Linux/Solaris<b> nm</b> program. Displays file information.</p>
<p>â¢</p>
<p><b>gpatch</b>: Installs and creates simple patches. Use this utility to install patches</p>
<p>provided by Green Hills support.</p>
<p>â¢</p>
<p><b>gpjmodify</b>: Performs command line editing of<b> .gpj</b> project files.</p>
<p>â¢</p>
<p><b>gsize</b>: Similar to the Linux/Solaris<b> size</b> program. Displays section sizes.</p>
<p>â¢</p>
<p><b>gsrec</b>: Converts executable files or a multi-core archive into a Motorola</p>
<p>S-Record, Intel hexadecimal, or Tektronix hexadecimal format file.</p>
<p>â¢</p>
<p><b>gstack</b>: (for executable files) Computes stack size for each task.</p>
<p>â¢</p>
<p><b>gstrip</b>: Similar to the Linux/Solaris<b> strip</b> program. Removes symbol or</p>
<p>debugging information from an executable.</p>
<p>â¢</p>
<p><b>gversion</b>: (for executable files) Returns version date and time information.</p>
<p><i>527</i></p>
<p><i>Green Hills Software</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>gwhat</b>: Similar to the Linux/Solaris<b> what</b> program. Reports or updates version</p>
<p>information.</p>
<p>â¢</p>
<p><b>mevundump</b>: Converts (and merges, if multiple input files given) an input</p>
<p>event log of any format to<b> mevgui</b>'s event log format.</p>
<p>â¢</p>
<p><b>ccorti</b> and<b> osa_orti.so</b>: Provides operating systems awareness (OSA) for</p>
<p>ORTI-enabled operating systems such as many AUTOSAR and OSEK operating</p>
<p>systems.</p>
<p>â¢</p>
<p><b>protrans</b>: Gathers profiling data for use with MULTI.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>528</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gaddr2line Utility Program</b></p>
<p>The<b> gaddr2line</b> utility program displays the source filename and line number for</p>
<p>instruction addresses.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gaddr2line</b> [<i>options</i>]<i> addresses</i></p>
<p>where<i> addresses</i> is a whitespace-separated list of instruction addresses and<i> options</i></p>
<p>are listed in the following table:</p>
<p><b>-f</b></p>
<p>Display function names along with filename and line number.</p>
<p><b>-e<i> filename</b></i></p>
<p>Specifies the executable filename. The default is<b> a.out</b>.</p>
<p><b>-r</b></p>
<p>Display procedure relative line numbers instead of file relative line numbers.</p>
<p><b>-s</b></p>
<p>Display just the base filename, instead of the full path and filename.</p>
<p>The<b> gaddr2line</b> utility looks up each specified address in the debug information</p>
<p>for the program and prints the source filename and line number that correspond to</p>
<p>the address. The information is displayed as</p>
<p>filename:line number</p>
<p>. If there is</p>
<p>no debug information, or the address does not correspond to a valid source line,</p>
<p>then</p>
<p>??:0</p>
<p>is displayed. When the<b> -f</b> option is passed, the function name is displayed</p>
<p>on the line preceding the source line information, and</p>
<p>??</p>
<p>is displayed for unknown</p>
<p>functions. An example is shown below:</p>
<p>gaddr2line -e hello.out -f</p>
<p>0x10110 0x10114 0x99999999</p>
<p>main</p>
<p>hello.c:2</p>
<p>main</p>
<p>hello.c:4</p>
<p>??</p>
<p>??:0</p>
<p><i>529</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gaddr2line Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gasmlist Utility Program</b></p>
<p>The<b> gasmlist</b> utility program displays interlaced assembly and source for the</p>
<p>specified object files.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gasmlist</b> [<i>options</i>]<i> files</i></p>
<p>where<i> files</i> is a whitespace-separated list of files and<i> options</i> are listed in the</p>
<p>following table:</p>
<p><b>--all</b></p>
<p><b>--all_with_asm</b></p>
<p>Controls which files have source lines printed:</p>
<p>â¢</p>
<p><b>--all</b> prints source lines for all files</p>
<p>â¢</p>
<p><b>--all_with_asm</b> prints source lines for all files that produce assembly or, if<b> --src_then_asm</b></p>
<p>is specified, for all files.</p>
<p>The default is to restrict output to the object file's base source file (so only source lines from</p>
<p>the base source file are printed).</p>
<p><b>--file_num</b></p>
<p><b>--proc_num</b></p>
<p>Restricts identification of output lines to one of the following:</p>
<p>â¢</p>
<p>file line numbers</p>
<p>â¢</p>
<p>procedure line numbers</p>
<p>The default is to print both procedure and file line numbers.</p>
<p><b>--file_offset</b></p>
<p>Calculates offsets from the start of the present object file. The default is to calculate them from</p>
<p>the start of the present section.</p>
<p><b>--help</b></p>
<p>Prints usage information.</p>
<p><b>--hide_all_labels</b></p>
<p>Suppresses the printing of detailed label information.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>530</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>--hide_mangled</b></p>
<p>Suppresses the printing of mangled versions of labels. The demangled versions are always</p>
<p>printed.</p>
<p><b>-I<i> directory</b></i></p>
<p>Specifies an additional<i> directory</i> to search for source files.</p>
<p>The following directories are searched for source files in this order:</p>
<p>â¢</p>
<p>the relative or absolute path specified in the object file</p>
<p>â¢</p>
<p>directories specified using<b> -I<i> directory</b></i></p>
<p>â¢</p>
<p>the user's path</p>
<p>The current directory is not searched unless it is specified in one of these categories.</p>
<p><b>--max_header_lines<i> n</b></i></p>
<p>Specifies the maximum number<i> n</i> of header source lines to be printed.</p>
<p>The default value for<i> n</i> is 4. Setting<i> n</i> to 0 instructs<b> gasmlist</b> to print all associated header file</p>
<p>lines.</p>
<p><b>--no_prefix_file</b></p>
<p>Suppresses the printing of the filename at the beginning of each source line.</p>
<p><b>--omit_headings</b></p>
<p>Suppresses the printing of headings to separate files and sections.</p>
<p><b>--proc_num_on_left</b></p>
<p>When both file and procedure line numbers are enabled, prints the procedure numbers on the</p>
<p>left. The default is to print them on the right.</p>
<p><b>--root_remap<i> rt dir</b></i></p>
<p>Re-maps the original path<i> rt</i> to the new path<i> dir</i>. For example to map<b> a/b/c</b> to<b> d/c</b>, pass:</p>
<p>--root_remap a/b d</p>
<p><b>--show_func_labels</b></p>
<p>Prints line offsets with the label they are offset from. For instance,</p>
<p>+ 0x4</p>
<p>would instead be</p>
<p>printed</p>
<p>label + 0x4</p>
<p>.</p>
<p><b>--src_then_asm</b></p>
<p>Orients the output primarily towards source code. The default is to emphasize assembly.</p>
<p><i>531</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gasmlist Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gcores Utility Program</b></p>
<p>The<b> gcores</b> utility combines one or more core images and an optional shared section</p>
<p>into a single archive. This single file archive provides linked images and metadata</p>
<p>suitable for loading onto and debugging a multi-core target. It can be manipulated</p>
<p>with the GHS archiver (<b>ax</b>) and the<b> gdump</b> utility. Individual images can be</p>
<p>identified in the<b> gdump</b> output by looking for</p>
<p>multi-core(image)</p>
<p>where image</p>
<p>is the name of the linked image.</p>
<p>The syntax for this utility is:</p>
<p><b>gcores</b> [<i>options</i> -core<i> core1_specs</i> -core<i> core2_specs</i> -share<i> shared_spec</i> -common</p>
<p><i>common_options</i>] where the options, core specifications and shared specifications</p>
<p>are described below.</p>
<p>Options available only in the command line:</p>
<p><b>-h</b></p>
<p>Print usage</p>
<p><b>-p</b></p>
<p>Show progress. This is the default.</p>
<p><b>-q</b></p>
<p>Run in quiet mode. Do not show any progress.</p>
<p><b>-core {<i> core_or_shared_spec</i> }</b></p>
<p>Specify a linked core image to include in the multi-core archive. Within the braces, a relocatable</p>
<p>image, objects to include in the shared module and linker options may be specified. At least one</p>
<p>core must be specified.</p>
<p><b>-share {<i> core_or_shared_spec</i> }</b></p>
<p>Specify a shared module for the multi-core archive. This is an optional argument, and only one</p>
<p>shared specification is allowed. Within the braces, a relocatable image, objects to include in the</p>
<p>shared module and linker options may be specified.</p>
<p><b>-bsp<i> bsp</b></i></p>
<p>Specify a target board. The bsp will be provided to the underlying driver calls needed to build</p>
<p>the multi-core archive.</p>
<p>Options available in the command line and in a MultiCoreArchive<b> .gpj</b> project file:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>532</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-common</b></p>
<p>See the Builder documentation for âGcores Common Link Optionsâ on page 266.</p>
<p><b>-driver</b></p>
<p>See the Builder documentation for âGCores Driverâ on page 266.</p>
<p><b>-keeptempfiles</b></p>
<p>See the Builder documentation for âKeep GCores Temporary Filesâ on page 267.</p>
<p><b>-cpu</b></p>
<p>See the Builder documentation for âGCores Cpuâ on page 267.</p>
<p><b>-o</b></p>
<p>See the Builder documentation for âGcores Output Filenameâ on page 265.</p>
<p><b>-shared_imports</b></p>
<p>See the Builder documentation for âGcores Shared Modules Import Symbols From Coresâ</p>
<p>on page 265.</p>
<p><b>-cross_core_imports</b></p>
<p>See the Builder documentation for âGCores Cores Import Symbols From Other Coresâ</p>
<p>on page 266.</p>
<p><b>-exported_absolutes_only</b></p>
<p>See the Builder documentation for âGcores Exported Absolutes Onlyâ on page 267.</p>
<p><b>-srec[=<i>filename</i>]</b></p>
<p>See the Builder documentation for âGCores Generate Additional Outputâ on page 268.</p>
<p><b>-hex[=<i>filename</i>]</b></p>
<p>See the Builder documentation for âGCores Generate Additional Outputâ on page 268.</p>
<p><b>Note</b></p>
<p>Users should take care when constructing multi-core archives to ensure</p>
<p>that project components in a core or shared module only reference library</p>
<p>routines and compiler functionality (that may depend on library routines)</p>
<p>that is available to code executing in that module. For example, if all C</p>
<p>libraries are per-core, then features that depend on these libraries such</p>
<p>as run-time error checking may cause the shared module to fail linking</p>
<p>with unresolved symbol errors. Specifically, the symbols that exist in</p>
<p>those libraries will by default not be available to the shared module since</p>
<p>they are not themselves in the shared module.</p>
<p><i>533</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gcores Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>When linking a program, the linker will match unresolved symbols in</p>
<p>the core-specific programs to exported symbols in the shared module</p>
<p>last, after exhausting attempts to resolve the symbols elsewhere.</p>
<p><b>Example 11.1. Using gcores command line</b></p>
<p>gcores -bsp rh850_e1x_fcc -shared_imports -cross_core_imports -exported_absolutes_only</p>
<p>-o HyperthreadsDemo.mca</p>
<p>-share { -o shared.so ./shared.rel -extra_file=shared.ld }</p>
<p>-core { -o core0 core0.rel -extra_file=core00.ld</p>
<p>}</p>
<p>-core { -o core1 core1.rel -extra_file=core11.ld</p>
<p>}</p>
<p>A final image<b> HyperthreadsDemo.mca</b> is generated. It has a shared module and</p>
<p>two cores. Each core and the shared module are built out of a relocatable image,</p>
<p>and specify their linker directives file by providing a linker directives file (<b>.ld</b>) with</p>
<p>the<b> -extra_file</b> option in the specification.</p>
<p>The optional options<b> -shared_imports</b>,<b> -cross_core_imports</b> and</p>
<p><b>-exported_absolutes_only</b> are provided. By specifying the bsp (or the<b> cpu</b> could</p>
<p>have been specified instead), the right set of libraries will be used by the driver.</p>
<p><b>Example 11.2. Using gcores from MULTI</b></p>
<p>gcores can be called from a command line, as explained in the previous paragraph,</p>
<p>or automatically from MULTI as part of a multi-core build.</p>
<p>To achieve that, a<b> .gpj</b> of the type MultiCoreArchive can be created.</p>
<p>A MultiCoreArchive project file can include options that will be provided to gcores.</p>
<p>- A SharedMemory project file defines a fully linked program that will be shared</p>
<p>across all cores.</p>
<p>- A Core project file defines a fully linked program that represents a Core or a</p>
<p>Thread.</p>
<p>Driver options can be provided in the SharedMemory or Core projects (or in the</p>
<p>top most project if these options are wanted to be common). These options will be</p>
<p>used in the compile and initial linker stage (in order to produce the relocatable object</p>
<p>that will be passed automatically as input to<b> gcores</b>). If an option is needed in the</p>
<p>final linking stage, where the relocatable objects are resolved, this has to be provided</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>534</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>as a<b> -common { option1 [option2] ... [optionN] }</b> in the MultiCoreArchive . The</p>
<p>SharedMemory project is optional, and only one can be provided, but at least one</p>
<p>Core project should be included.</p>
<p>If the<b> -bsp</b> option is provided in the Top Project, it will automatically be passed to</p>
<p><b>gcores</b> to be used in the final Linking stage.</p>
<p>Each Core or SharedMemory project should be provided its own linker configuration</p>
<p>file for proper layout.</p>
<p>MultiCoreArchive example</p>
<p>The following example shows the contents of a MultiCoreArchive project file that</p>
<p>defines one SharedMemory and two Cores.</p>
<p>MultiCoreArchive<b> multicore.gpj</b></p>
<p>#!gbuild</p>
<p>[MultiCoreArchive]</p>
<p>-shared_imports</p>
<p>-cross_core_imports</p>
<p>-exported_absolutes_only</p>
<p>shared.gpj</p>
<p>[SharedMemory]</p>
<p>hardware_thread0.gpj</p>
<p>[Core]</p>
<p>hardware_thread1.gpj</p>
<p>[Core]</p>
<p>SharedMemory project file<b> shared.gpj</b></p>
<p>#!gbuild</p>
<p>[SharedMemory]</p>
<p>-o shared.so</p>
<p>shared.c</p>
<p>shared.ld</p>
<p>Core 0 project file<b> hardware_thread0.gpj</b></p>
<p>#!gbuild</p>
<p>[Core]</p>
<p>-o hardware_thread0</p>
<p>hardware_thread0.c</p>
<p>hardware_thread0.ld</p>
<p>Core 1 project file<b> hardware_thread1.gpj</b></p>
<p><i>535</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gcores Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#!gbuild</p>
<p>[Core]</p>
<p>-o hardware_thread1</p>
<p>hardware_thread1.c</p>
<p>hardware_thread1.ld</p>
<p><b>The gbin2c Utility Program</b></p>
<p>The<b> gbin2c</b> utility converts a group of binary files into a set of array definitions in</p>
<p>a source file suitable for inclusion in C or C++ projects. You can control the byte</p>
<p>by byte conversion of each binary file into a char array by passing command line</p>
<p>arguments.</p>
<p>The syntax for this utility is:<b> gbin2c</b> [<i>global_options</i>] [-input]<i> file1</i></p>
<p>[<i>file1_local_options</i>] ...</p>
<p>Command line options for<b> gbin2c</b> are divided into three categories.</p>
<p>â¢</p>
<p><i>Global options</i> â Apply to each binary file that you pass to<b> gbin2c</b> for</p>
<p>conversion. You can specify global options anywhere on the command line.</p>
<p>â¢</p>
<p><i>Module inclusion options</i> â Specify the binary files that you want to convert.</p>
<p>â¢</p>
<p><i>Local options</i> â Apply only to the binary file specified by the nearest preceding</p>
<p>module inclusion option.</p>
<p><b>Global Options</b></p>
<p><b>-allnoconst</b></p>
<p>Removes<b> const</b> from a data array type for all modules and their references in the module list.</p>
<p><b>-compat</b></p>
<p>Runs<b> gbin2c</b> in<b> gbin2src</b> compatibility mode.</p>
<p>Implies:</p>
<p>â¢</p>
<p>the<b> -list</b> global option</p>
<p>â¢</p>
<p>the<b> -static</b> local option for each binary file.</p>
<p>If an additional options file is not specified on the command line (with<b> -i</b>), this option also</p>
<p>instructs<b> gbin2c</b> to read standard input for additional options in lieu of an additional options</p>
<p>file.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>536</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-crc</b></p>
<p>Outputs a CRC value for each converted binary file, using the polynomial</p>
<p>0x10211021</p>
<p>. Sample</p>
<p>source code for verifying checksums is included in the<b> src/libstartup/cksum.c</b> file of your</p>
<p>installation.</p>
<p>The declaration of the CRC variable for the array named<i> name</i> is:</p>
<p>const unsigned int</p>
<p><i>name</i>_crc;</p>
<p><b>-cxx</b></p>
<p>Replaces</p>
<p>const</p>
<p>with</p>
<p>extern const</p>
<p>. Use this option if you will be including the output in a</p>
<p>C++ project.</p>
<p><b>-ghsentry<i> tablename</b></i></p>
<p>Outputs an entry for the linker generated table<i> tablename</i> for each converted module. Use this</p>
<p>option as an alternative to</p>
<p>-list</p>
<p>. For more information, see âLinker Generated Tablesâ</p>
<p>on page 505.</p>
<p><b>-help</b></p>
<p>Displays basic usage information.</p>
<p><b>-i<i> file</b></i></p>
<p>Reads<i> file</i> as a list of additional options.</p>
<p>The contents of<i> file</i> are parsed as additional options. Extra whitespace and newline characters</p>
<p>are ignored. Options listed in the file have the same effect as options on the command line with</p>
<p>the following exceptions:</p>
<p>â¢</p>
<p>The options file is not preprocessed by the user's shell so no special treatment, such as</p>
<p>wildcard substitution, is performed.</p>
<p>â¢</p>
<p>The meaning of the<b> -o</b> option in the additional options file context differs from its meaning</p>
<p>in the command line context. In the options file,<b> -o<i> name</b></i> means ârefer to the current module</p>
<p>as<i> name</i> in the module list, and set the array name for the current module to<i><b> name</i>_data</b>&quot;.</p>
<p>In essence, the<b> -o</b> option is an alias for the<b> -output</b> option when it occurs on the command</p>
<p>line and the<b> -module_name</b> and<b> -array_name</b> options when it occurs in the options file.</p>
<p>Note that only one additional options file can be specified using the<b> -i</b> option.</p>
<p><i>537</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Global Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-list</b></p>
<p>Outputs a list of converted modules.</p>
<p>The default definition for the type of each list element is:</p>
<p>struct static_module_info {</p>
<p>const char * const name;</p>
<p>const char * const data;</p>
<p>const struct static_module_info * const next;</p>
<p>};</p>
<p>The default declaration of the module list is:</p>
<p>const struct static_module_info __static_modules[];</p>
<p><b>-list_name<i> name</b></i></p>
<p>Sets the name of the module list to<i> name</i>.</p>
<p><b>-list_type<i> name</b></i></p>
<p>Sets the name of the module list element struct type to<i> name</i>.</p>
<p><b>-nullterm</b></p>
<p>Terminates each data array with a null character.</p>
<p><b>-o<i> file</b></i></p>
<p><b>-output<i> file</b></i></p>
<p>Writes output to<i> file</i>. See<b> -i</b>, above, for the<b> -o</b> option's alternate meaning in an options file.</p>
<p>If neither of these options is passed, then output is written to</p>
<p>stdout</p>
<p>.</p>
<p><b>-size</b></p>
<p>Outputs the length of each array written.</p>
<p>The declaration of the size variable for the array named<i> name</i> is:</p>
<p>const unsigned int<i> name</i>_size;</p>
<p><b>-size_array</b></p>
<p>Outputs an array containing the lengths of all data arrays written when<b> -list</b> is specified</p>
<p><b>-size_field</b></p>
<p>Adds a</p>
<p>size</p>
<p>field to the module list</p>
<p>struct</p>
<p>type.</p>
<p><b>-string</b></p>
<p>Formats output in string literal form instead of comma-separated hex values.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>538</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Module Inclusion Options</b></p>
<p><b>[-input]<i> file</b></i></p>
<p>Adds<i> file</i> to the list of binary files to convert.</p>
<p>An array is defined for each converted binary file. The default declaration for the array generated</p>
<p>from file<i> file</i> (stripped of all path information, and with any non-alphanumeric character replaced</p>
<p>with underscores) is:</p>
<p>const char<i> file</i>_data[];</p>
<p>The nature of the array can be controlled via the<i> local options</i>.</p>
<p><b>Note:</b> Non-alphanumeric special characters in the name of<i> file</i> are replaced with underscores.</p>
<p><b>Local Options</b></p>
<p>These options modify settings for the most recently included module:</p>
<p><b>-alignment<i> n</b></i></p>
<p>Sets the alignment of an array for the current module.</p>
<p><b>-array_name<i> name</b></i></p>
<p>Sets the array name for the current module to<i> name</i>.</p>
<p>By default the array name for a file is the base name of the file with all non-alphanumeric</p>
<p>characters replaced with underscores.</p>
<p><b>-limit<i> n</b></i></p>
<p>Outputs a maximum of<i> n</i> bytes of the current module.</p>
<p><b>-module_name<i> name</b></i></p>
<p>Refers to the current module as<i> name</i> in the module list.</p>
<p><b>-noconst</b></p>
<p>Removes</p>
<p>const</p>
<p>from the type of the array for the current module.</p>
<p><b>-signed</b></p>
<p><b>-unsigned</b></p>
<p>Adds</p>
<p>signed</p>
<p>or</p>
<p>unsigned</p>
<p>to the type of the array for the current module.</p>
<p><b>-skip<i> n</b></i></p>
<p>Skips the first<i> n</i> bytes of the current module.</p>
<p><b>-static</b></p>
<p>Adds</p>
<p>static</p>
<p>to the type of the array for the current module.</p>
<p><i>539</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Module Inclusion Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-volatile</b></p>
<p>Adds</p>
<p>volatile</p>
<p>to the type of array for the current module.</p>
<p><b>Example 11.3. Using gbin2c</b></p>
<p>gbin2c mod.o</p>
<p>The contents of<b> mod.o</b> are converted to a</p>
<p>const char</p>
<p>array named</p>
<p>mod_o_data</p>
<p>and printed on</p>
<p>stdout</p>
<p>. The output looks similar to the following:</p>
<p>/**</p>
<p>* This file was automatically generated by gbin2c v1.10</p>
<p>* Green Hills Software [ http://www.ghs.com ]</p>
<p>* Using command line: gbin2c mod.o</p>
<p>* Date generated: Fri Jun</p>
<p>17 13:17:13 2011</p>
<p>**/</p>
<p>/* mod.o: */</p>
<p>const char mod_o_data[] = {</p>
<p>0x7F, 0x45, etc.</p>
<p>};</p>
<p><b>Example 11.4. Using the -crc and -size Options</b></p>
<p>gbin2c -crc -size mod.o</p>
<p>In addition to the output from example 1, size and CRC information for<b> mod.o</b> are</p>
<p>displayed:</p>
<p>/**</p>
<p>* This file was automatically generated by gbin2c v1.10</p>
<p>* Green Hills Software [ http://www.ghs.com ]</p>
<p>* Using command line: gbin2c -crc -size mod.o</p>
<p>* Date generated: Fri Jun</p>
<p>17 13:17:13 2011</p>
<p>* Note: CRC of input file and this array can be found at end of file</p>
<p>**/</p>
<p>/* mod.o: */</p>
<p>const char mod_o_data[] = {</p>
<p>0x7F, 0x45, etc.</p>
<p>};</p>
<p>const unsigned int mod_o_data_size = 2620;</p>
<p>const unsigned int mod_o_data_crc = 0xD91D5642;</p>
<p>/* CRC of input file = 0xD91D5642 */</p>
<p>/* Note that file CRC may not match array CRC if -skip or -limit were used */</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>540</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 11.5. Using the static Keyword</b></p>
<p>gbin2c -crc -size mod.o -static -skip 64 -limit 4</p>
<p>In this example, the</p>
<p>static</p>
<p>keyword is added to the type of</p>
<p>mod_o_data</p>
<p>and only</p>
<p>bytes 64-67 (starting counting at 0) of<b> mod.o</b> are output:</p>
<p>/**</p>
<p>* This file was automatically generated by gbin2c v1.10</p>
<p>* Green Hills Software [ http://www.ghs.com ]</p>
<p>* Using command line: gbin2c -crc -size mod.o -static -skip 64 -limit 4</p>
<p>* Date generated: Fri Jun</p>
<p>17 13:17:13 2011</p>
<p>* Note: CRC of input file and this array can be found at end of file</p>
<p>**/</p>
<p>/* mod.o:</p>
<p>skipped 64 bytes and limited to 4 bytes */</p>
<p>static const char mod_o_data[] = {</p>
<p>0x65, 0x2F, 0x73, 0x73</p>
<p>};</p>
<p>const unsigned int mod_o_data_size = 4;</p>
<p>const unsigned int mod_o_data_crc = 0x358E11C6;</p>
<p>/* CRC of input file = 0xD91D5642 */</p>
<p>/* Note that file CRC may not match array CRC if -skip or -limit were used */</p>
<p><b>Example 11.6. Converting Multiple Files</b></p>
<p>gbin2c -crc mod.o -static foo -signed -size -array_name bar</p>
<p>In this example, both<b> mod.o</b> and<b> foo</b> are converted. Notice that the<b> -crc</b> and<b> -size</b></p>
<p>global options apply to both files while<b> -static</b> and<b> -signed</b> only apply to<b> mod.o</b></p>
<p>and<b> foo</b> respectively. This example also demonstrates the use of the<b> -array_name</b></p>
<p>option and its effect on the size and CRC variable names.</p>
<p>/**</p>
<p>* This file was automatically generated by gbin2c v1.10</p>
<p>* Green Hills Software [ http://www.ghs.com ]</p>
<p>* Using command line:</p>
<p>*</p>
<p>gbin2c -crc mod.o -static foo -signed -size -array_name bar</p>
<p>* Date generated: Fri Jun</p>
<p>17 13:17:13 2011</p>
<p>* Note: CRC of input file and this array can be found at end of file</p>
<p>**/</p>
<p>/* foo: */</p>
<p>const signed char bar[] = {</p>
<p>0x66, 0x64, 0x61, 0x73, 0x0A</p>
<p>};</p>
<p>const unsigned int bar_size = 5;</p>
<p><i>541</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Local Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>const unsigned int bar_crc = 0x11A9EBE1;</p>
<p>/* CRC of input file = 0x11A9EBE1 */</p>
<p>/* Note that file CRC may not match array CRC if -skip or -limit were used */</p>
<p>/* mod.o: */</p>
<p>static const char mod_o_data[] = {</p>
<p>0x7F, 0x45, etc.</p>
<p>};</p>
<p>const unsigned int mod_o_data_size = 2620;</p>
<p>const unsigned int mod_o_data_crc = 0xD91D5642;</p>
<p>/* CRC of input file = 0xD91D5642 */</p>
<p>/* Note that file CRC may not match array CRC if -skip or -limit were used */</p>
<p><b>Example 11.7. Outputting the Module List</b></p>
<p>gbin2c</p>
<p>mod.o foo -module_name bar -list</p>
<p>In this example the module list is output and the module name for<b> foo</b> is changed</p>
<p>to</p>
<p>bar</p>
<p>.</p>
<p>/**</p>
<p>* This file was automatically generated by gbin2c v1.10</p>
<p>* Green Hills Software [ http://www.ghs.com ]</p>
<p>* Using command line: gbin2c mod.o foo -module_name bar -list</p>
<p>* Date generated: Fri Jun</p>
<p>17 13:17:13 2011</p>
<p>**/</p>
<p>struct static_module_info {</p>
<p>const char * const name;</p>
<p>const char * const data;</p>
<p>const struct static_module_info * const next;</p>
<p>};</p>
<p>/* foo: */</p>
<p>const char foo_data[] = {</p>
<p>0x66, 0x64, 0x61, 0x73, 0x0A</p>
<p>};</p>
<p>/* mod.o: */</p>
<p>const char mod_o_data[] = {</p>
<p>0x7F, 0x45, etc.</p>
<p>};</p>
<p>const struct static_module_info __static_modules[] = {</p>
<p>{</p>
<p>&quot;bar&quot;,</p>
<p>(const char *)&amp;foo_data,</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>542</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>&amp;__static_modules[1]</p>
<p>},</p>
<p>{</p>
<p>&quot;mod.o&quot;,</p>
<p>(const char *)&amp;mod_o_data,</p>
<p>0</p>
<p>}</p>
<p>};</p>
<p><b>Example 11.8. Including an Additional Options File</b></p>
<p>gbin2c -i modules -list -crc</p>
<p>In this example, the<b> -i</b> option is used to include an additional options file called</p>
<p><b>modules</b>, which contains the following text:</p>
<p>mod.o</p>
<p>foo -o bar</p>
<p>The<b> -o</b> option in<b> modules</b> specifies that the module name for<b> foo</b> should be</p>
<p>bar</p>
<p>and that its array name should be</p>
<p>bar_data</p>
<p>.</p>
<p>/**</p>
<p>* This file was automatically generated by gbin2c v1.10</p>
<p>* Green Hills Software [ http://www.ghs.com ]</p>
<p>* Using command line: gbin2c -i modules -list -crc</p>
<p>* Additional options from file: mod.o foo -o bar</p>
<p>* Date generated: Fri Jun</p>
<p>17 13:17:13 2011</p>
<p>* Note: CRC of input file and this array can be found at end of file</p>
<p>**/</p>
<p>struct static_module_info {</p>
<p>const char * const name;</p>
<p>const char * const data;</p>
<p>const struct static_module_info * const next;</p>
<p>};</p>
<p>/* foo: */</p>
<p>const char bar_data[] = {</p>
<p>0x66, 0x64, 0x61, 0x73, 0x0A</p>
<p>};</p>
<p>const unsigned int bar_data_crc = 0x11A9EBE1;</p>
<p>/* CRC of input file = 0x11A9EBE1 */</p>
<p>/* Note that file CRC may not match array CRC if -skip or -limit were used */</p>
<p>/* mod.o: */</p>
<p>const char mod_o_data[] = {</p>
<p><i>543</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Local Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p>0x7F, 0x45, etc.</p>
<p>};</p>
<p>const unsigned int mod_o_data_crc = 0xD91D5642;</p>
<p>/* CRC of input file = 0xD91D5642 */</p>
<p>/* Note that file CRC may not match array CRC if -skip or -limit were used */</p>
<p>const struct static_module_info __static_modules[] = {</p>
<p>{</p>
<p>&quot;bar&quot;,</p>
<p>(const char *)&amp;bar_data,</p>
<p>&amp;__static_modules[1]</p>
<p>},</p>
<p>{</p>
<p>&quot;mod.o&quot;,</p>
<p>(const char *)&amp;mod_o_data,</p>
<p>0</p>
<p>}</p>
<p>};</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>544</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gbincmp Utility Program</b></p>
<p>The<b> gbincmp</b> utility program compares two binary input files. The two input files</p>
<p>can be ELF format object files or executable files.</p>
<p>If the sections in the two files are identical,<b> gbincmp</b> exits with no output. If they</p>
<p>differ, it prints the first difference, unless you specify the<b> -continue</b> option.</p>
<p>The<b> gbincmp</b> utility program can compare any of the following:</p>
<p>â¢</p>
<p>Contents of sections loaded on the target (target sections)</p>
<p>â¢</p>
<p>Contents of sections not loaded on the target (host sections)</p>
<p>â¢</p>
<p>Section headers</p>
<p>â¢</p>
<p>Relocation tables</p>
<p>â¢</p>
<p>String tables</p>
<p>â¢</p>
<p>Symbol tables</p>
<p>â¢</p>
<p>DWARF debug information sections</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gbincmp</b> [<i>options</i>]<i> file1 file2</i></p>
<p>where<i> file1</i> and<i> file2</i> are the names of the two files to be compared.</p>
<p>The<b> gbincmp<i></b> options</i> are:</p>
<p><b>-all</b></p>
<p>Compares all sections.</p>
<p><b>-continue</b></p>
<p>Instructs<b> gbincmp</b> not to stop at the first difference.</p>
<p><b>-debug</b></p>
<p><b>-nodebug</b></p>
<p>Enables or disables comparison of the</p>
<p>.debug</p>
<p>(DWARF) and</p>
<p>.debug_info</p>
<p>(DWARF2)</p>
<p>sections.</p>
<p><b>-help</b></p>
<p>Displays information about all options.</p>
<p><i>545</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gbincmp Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-host</b></p>
<p><b>-nohost</b></p>
<p>Enables or disables comparison of the contents of host sections.</p>
<p><b>-line</b></p>
<p><b>-noline</b></p>
<p>Enables or disables comparison of the line number information sections</p>
<p>.line</p>
<p>(DWARF) and</p>
<p>.debug_line</p>
<p>(DWARF2).</p>
<p><b>-normalize</b></p>
<p>Ignores differences in encoded timestamps.</p>
<p><b>-prefixed_msgs</b></p>
<p><b>-no_prefixed_msgs</b></p>
<p>Enables or disables the insertion of the words</p>
<p>WARNING</p>
<p>and</p>
<p>ERROR</p>
<p>before every warning and</p>
<p>error message.</p>
<p><b>-reloc</b></p>
<p><b>-noreloc</b></p>
<p>Enables or disables comparison of relocation information.</p>
<p><b>-section=<i>sections</b></i></p>
<p><b>-nosection=<i>sections</b></i></p>
<p>Enables or disables comparison of the sections named in the comma-separated<i> sections</i> list. For</p>
<p>example,</p>
<p>-section=text,data</p>
<p>(ELF only).</p>
<p><b>-string</b></p>
<p><b>-nostring</b></p>
<p>Enables or disables comparison of string table information.</p>
<p><b>-symbol</b></p>
<p><b>-nosymbol</b></p>
<p>Enables or disables comparison of symbol table information.</p>
<p><b>-target</b></p>
<p><b>-notarget</b></p>
<p>Enables or disables comparison of the contents of target sections.</p>
<p><b>-v</b></p>
<p>Verbose output. Shows what files and sections are compared.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>546</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gbuild Utility Program</b></p>
<p>The<b> gbuild</b> utility program provides a command line interface to build projects</p>
<p>created with the MULTI Project Manager (see the documentation about the MULTI</p>
<p>Project Manager in the<i> MULTI: Managing Projects and Configuring the IDE</i> book).</p>
<p>This utility can be used to integrate building your project into a script.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gbuild</b> [<i>option</i>]... [<i>file</i>]...</p>
<p>where the optional<i> file</i> parameter can be:</p>
<p>â¢</p>
<p>one or more project files (<b>.gpj</b>)</p>
<p>â¢</p>
<p>one or more source or object files</p>
<p>â¢</p>
<p>one or more executables</p>
<p>If you do not specify<i> file</i>,<b> gbuild</b> builds the file specified by the<b> -top</b> option. If you</p>
<p>do not specify<b> -top</b>,<b> gbuild</b> tries to build<b> default.gpj</b> in the current directory.</p>
<p>The<i> options</i> for<b> gbuild</b> are:</p>
<p><b>-#</b></p>
<p>Displays status messages and commands but does not perform any actions.</p>
<p>This option is a shortcut for<b> -info -commands</b>.</p>
<p><b>-all</b></p>
<p>Rebuilds all files, even if they are up to date.</p>
<p><b>-allcfg</b></p>
<p>Builds the project in all the configurations defined in your Top Project (<b>.gpj</b>) file. For example,</p>
<p>if a</p>
<p>Debug</p>
<p>configuration and a</p>
<p>Release</p>
<p>configuration are defined, this option builds both.</p>
<p>If you do not specify this option or<b> -cfg</b> (see below), and your Top Project file defines build</p>
<p>configurations, only the first configuration is built.</p>
<p>For more information, see âThe Header Sectionâ on page 957.</p>
<p><b>-allinfo</b></p>
<p>Displays the status messages that you would encounter if you rebuilt all files. This option does</p>
<p>not actually build your files or perform the actions described in the messages.</p>
<p>This option is a shortcut for<b> -all -info</b>.</p>
<p><i>547</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gbuild Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-cfg=<i>descriptive_name</b></i></p>
<p><b>-cfg=<i>short_name</b></i></p>
<p>Builds the project in the configuration specified by<i> descriptive_name</i> or<i> short_name</i>, where</p>
<p><i>descriptive_name</i> and<i> short_name</i> are the names defined for the configuration in the Top Project</p>
<p>file. For example, given<i> descriptive_names</i></p>
<p>Debug</p>
<p>and</p>
<p>Release</p>
<p>,<b> -cfg=Debug</b> builds the project</p>
<p>in the</p>
<p>Debug</p>
<p>configuration, while<b> -cfg=Release</b> builds the project in the</p>
<p>Release</p>
<p>configuration.</p>
<p>If you do not specify this option or<b> -allcfg</b> (see above), and your Top Project file defines build</p>
<p>configurations, only the first configuration is built.</p>
<p>For more information, see âThe Header Sectionâ on page 957.</p>
<p><b>-clean</b></p>
<p>Deletes all previous output files without building.</p>
<p><b>-cleanexternals</b></p>
<p>Deletes all previous output files from the current project and from all<b> externalDepends</b> projects.</p>
<p>This option is ignored if specified with a file.</p>
<p><b>-cleanfirst</b></p>
<p>Deletes all existing output files and then initiates a build.</p>
<p><b>-commands</b></p>
<p>Displays commands before they are executed.</p>
<p><b>-D<i>macro_name</i>[=<i>value</i>]</b></p>
<p>Defines a macro<i> macro_name</i> as<i> value</i> for use in project (<b>.gpj</b>) files and customization (<b>.bod</b>)</p>
<p>files. See âGreen Hills Project File Syntaxâ on page 956 for more information.</p>
<p>This option does not define a preprocessor symbol.</p>
<p><b>-find<i> filename</b></i></p>
<p>Displays the first build path to the file<i> filename</i>. The build path specifies a route through the</p>
<p>build structure to reach<i> filename</i>. If<i> filename</i> is not found in the current project,<b> externalDepends</b></p>
<p>projects (if any) are searched in order.</p>
<p><b>-findall<i> filename</b></i></p>
<p>Displays all build paths to the file<i> filename</i>. The build paths specify routes through the build</p>
<p>structure to reach<i> filename</i>. This option only displays build paths for the current project.</p>
<p><b>-fullexternals</b></p>
<p>Builds everything in the current project and all<b> externalDepends</b> projects. This option is ignored</p>
<p>if specified with a file.</p>
<p><b>-H</b></p>
<p>Displays includes (see âDisplay includes Preprocessor Directives Listingâ on page 182).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>548</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>--help</b></p>
<p><b>-help</b></p>
<p><b>-h</b></p>
<p>Displays usage information for basic<b> gbuild<i></b> options</i>.</p>
<p><b>-Help</b></p>
<p>Displays usage information for all<b> gbuild<i></b> options</i>.</p>
<p><b>-ignore</b></p>
<p>Continues building, even if compile or link errors occur.</p>
<p><b>-ignore_gbuild_dir_change</b></p>
<p>Do not rebuild a file simply because the current tools installation is different than the one used</p>
<p>to build the existing version of the file.</p>
<p><b>-ignore_parse_errors</b></p>
<p>Continues building even if errors occur while parsing project files. Some critical errors cannot</p>
<p>be ignored and will still halt the build.</p>
<p><b>-info</b></p>
<p>Displays status messages but does not perform the actions described in the messages.</p>
<p><b>-leave_output</b></p>
<p>Deletes only intermediate output files. This option is only available with<b> -clean</b> or<b> -cleanfirst</b>.</p>
<p><b>-link</b></p>
<p>Forces linking. The default behavior is to re-link the executable only if any of its components</p>
<p>have changed.</p>
<p><b>-list</b></p>
<p>Lists all filenames. This option does not perform any build actions.</p>
<p><b>-list_depends</b></p>
<p>Lists known dependencies. You must build your project before passing this option. This option</p>
<p>does not perform any build actions.</p>
<p><b>-list_options</b></p>
<p>Lists options specified in the<b> .gpj</b> file. This option does not perform any build actions.</p>
<p><b>-lockout</b></p>
<p>Uses a lock file to prevent simultaneous builds of the same program or library.</p>
<p><b>-lockoutretry</b></p>
<p>Waits to obtain a lock file. This option implies<b> -lockout</b>.</p>
<p><i>549</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gbuild Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-nested_commands</b></p>
<p>Displays full commands, including internal commands, before they are executed. If you specify</p>
<p>this option with<b> -info</b>, the output does not include internal commands.</p>
<p><b>-nice</b></p>
<p>Executes the build with low priority.</p>
<p><b>-nochecklibs</b></p>
<p>Disables Implicit Dependency Analysis. For more information, see âImplicit Dependency</p>
<p>Analysisâ on page 555.</p>
<p><b>-nolink</b></p>
<p>Generates object files but does not link them.</p>
<p><b>-noparallel</b></p>
<p>Specifies that<b> gbuild</b> cannot run parallel processes for the build. The build will be single threaded.</p>
<p><b>-noprogress</b></p>
<p>Suppresses progress messages.</p>
<p><b>-noreasons</b></p>
<p>Restricts the information given in progress messages.</p>
<p>For example, the message:</p>
<p>Compiling hello.c because hello.obj does not exist</p>
<p>is reduced to:</p>
<p>Compiling hello.c</p>
<p><b>-parallel[=<i>n</i>]</b></p>
<p>Specifies the number of processes that<b> gbuild</b> can run in parallel. The default value for<i> n</i> depends</p>
<p>on the number of cores in your host system.</p>
<p>-parallel=0</p>
<p>is equivalent to</p>
<p>-noparallel</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>550</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-parallel_level=<i>level</b></i></p>
<p>Controls how aggressively<b> gbuild</b> parallelizes the build. Valid values for<i> level</i> are:</p>
<p>â¢</p>
<p>low</p>
<p>â Parallelizes compiling source files within a single project (<b>.gpj</b>) file when safe to</p>
<p>do so. This setting is equivalent to<b> -parallel</b> behavior in MULTI 5 and earlier.</p>
<p>â¢</p>
<p>medium</p>
<p>â [default when<b> -nochecklibs</b> is enabled] Parallelizes processing files within a</p>
<p>single linked output when safe to do so. This option is similar to</p>
<p>low</p>
<p>, but parallelizes across</p>
<p>Subprojects.</p>
<p>â¢</p>
<p>high</p>
<p>â [default] Parallelizes processing files whenever safe to do so, including linking</p>
<p>tasks; however, if you have disabled Implicit Dependency Analysis with<b> -nochecklibs</b>,</p>
<p><b>gbuild</b> may not have enough information about link-time dependencies to parallelize linking</p>
<p>tasks, and defaults to</p>
<p>medium</p>
<p>.</p>
<p>If you use<b> -nochecklibs</b> with<b> -parallel_level=high</b>, you may want to explicitly specify</p>
<p>dependencies using the<b> :depends</b> builder option (see âDependencies Relative to Source</p>
<p>Directoryâ on page 278).</p>
<p>If you specify this option after<b> -noparallel</b>,<b> gbuild</b> runs with the default number of processes</p>
<p>instead of running a single-threaded build.</p>
<p><b>-path<i> list_of_project_files file</b></i></p>
<p>Specifies a build path of project (<b>.gpj</b>) files to follow when building the file<i> file</i>. The build path</p>
<p>specifies a route through the build structure to reach<i> file</i>. When using<b> -path</b>, you cannot specify</p>
<p>any file arguments to<b> gbuild</b> other than the one specified for<b> -path</b>. This option is helpful when</p>
<p>one file is utilized in multiple paths in your build tree, and you want to specify which path to</p>
<p>use for building. For an example, see Example 11.13. Building One of Multiple Projects with</p>
<p>the Same Name on page 554.</p>
<p><b>-preprocess</b></p>
<p>Only performs preprocessing on a project, generating<b> .i</b> files from applicable source.</p>
<p><b>-quiet</b></p>
<p><b>-silent</b></p>
<p>Prevents the utility from outputting any warning or error messages.</p>
<p><b>-skip=<i>target</b></i></p>
<p>Skips the specified build target<i> target</i> when building. Here,<i> target</i> is the output name associated</p>
<p>with a build file.</p>
<p><b>-statistics</b></p>
<p>Displays comprehensive timing information.</p>
<p><b>-stderr=<i>filename</b></i></p>
<p>Redirects stderr output (status and error messages) to<i> filename</i>.</p>
<p><i>551</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gbuild Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-strict</b></p>
<p>Aborts<b> gbuild</b> if<b> gbuild</b> is unable to open a<b> .gpj</b> file in your build tree or if you specify an</p>
<p>unrecognized option on the command line. Without this option, these problems only generate</p>
<p>warning messages.</p>
<p><b>-strict_config</b></p>
<p>Forces a build error if output from a build will overwrite previously built output from a different</p>
<p>build configuration. This option can be very helpful in verifying that outputs from different</p>
<p>build configurations do not overlap.</p>
<p><b>-time</b></p>
<p>Displays basic timing information.</p>
<p><b>-top<i> filename</i>.gpj</b></p>
<p>Specifies the Top Project file. By default,<b> gbuild</b> uses<b> default.gpj</b> in the current directory.</p>
<p>This option allows you to specify a path to a project file in another directory.</p>
<p><b>-unix</b></p>
<p>Displays directory slashes as /.</p>
<p><b>-verbose</b></p>
<p>Prints additional information during the build.</p>
<p><b>-within<i> intermediate.gpj</b></i></p>
<p>Restricts searching for the specified<i> file</i> arguments to children of<i> intermediate.gpj</i>.</p>
<p>This option is an alternative for<b> -path</b>; it allows you to specify multiple files, while restricting</p>
<p>the search for those files to a sub-tree of your project. This option is helpful when there are</p>
<p>multiple files with identical names in multiple sub-trees.</p>
<p>For an example, see Example 11.13. Building One of Multiple Projects with the Same Name</p>
<p>on page 554.</p>
<p><b>Using gbuild</b></p>
<p>The following examples take place in a directory,<b> MyProjects/Project1</b>, which</p>
<p>contains a Top Project file called<b> default.gpj</b>, and a number of levels of subprojects.</p>
<p><b>Example 11.9. Building the Entire Project</b></p>
<p>To build the entire project, enter the following:</p>
<p>gbuild</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>552</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If you do not pass any arguments,<b> gbuild</b> attempts to process<b> default.gpj</b> in the</p>
<p>current directory.</p>
<p><b>Example 11.10. Building Part of Your Project</b></p>
<p>To build a particular executable, you must specify either its project file or the name</p>
<p>of the executable itself.</p>
<p>For example, to build<b> print_utility.gpj</b>, a project file that generates an executable</p>
<p>called<b> print_utility</b>, enter the following:</p>
<p>gbuild print_utility.gpj</p>
<p>or:</p>
<p>gbuild print_utility</p>
<p><b>Example 11.11. Building Individual Object Files</b></p>
<p>To build individual object files, you must specify either the initial source files or</p>
<p>the object files that they will be compiled into.</p>
<p>For example, to build the source files<b> foo.c</b>,<b> bar.s</b>, and<b> baz.cxx</b> into object files,</p>
<p>enter the following:</p>
<p>gbuild foo.c bar.s baz.cxx</p>
<p>or:</p>
<p>gbuild foo.o bar.o baz.o</p>
<p><b>Example 11.12. Finding Project Files</b></p>
<p>As your project grows in size, it might become difficult to find individual files,</p>
<p>particularly if you are using several levels of subprojects. To search for the project</p>
<p>file<b> print_utility.gpj</b>, enter the following:</p>
<p>gbuild -find print_utility.gpj</p>
<p>This command prints the position of<b> print_utility.gpj</b> in the project tree and the</p>
<p>path to it from the current directory. The output resembles the following:</p>
<p>default.gpj utilities.gpj utilities/print_utility/print_utility.gpj</p>
<p><i>553</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Using gbuild</i></p>
<h1 style="page-break-before:always; "></h1>
<p>In this case,<b> print_utility.gpj</b> is a subproject of<b> utilities.gpj</b>, which is a subproject</p>
<p>of<b> default.gpj</b>. The actual file can be found at</p>
<p><b>utilities/print_utility/print_utility.gpj</b>.</p>
<p><b>Example 11.13. Building One of Multiple Projects with the Same Name</b></p>
<p>If your project contains identically named sub-projects, use the<b> -path</b> or<b> -within</b></p>
<p>options to specify which project to build. For example, if your project structure is:</p>
<p>default.gpj</p>
<p>target_one.gpj</p>
<p>foo.gpj</p>
<p>lib.gpj</p>
<p>target_two.gpj</p>
<p>foo.gpj</p>
<p>lib.gpj</p>
<p>â¢</p>
<p>To build the<b> lib.gpj</b> project in<b> target_two.gpj</b>, use the following command:</p>
<p>gbuild -path default.gpj target_two.gpj lib.gpj</p>
<p>The<b> -path</b> option only allows you to specify one item to build.</p>
<p>â¢</p>
<p>To build both the<b> lib.gpj</b> and<b> foo.gpj</b> projects in<b> target_two.gpj</b>, use the</p>
<p>following command:</p>
<p>gbuild -within target_two.gpj foo.gpj lib.gpj</p>
<p><b>Example 11.14. Running gbuild in a Project Subdirectory</b></p>
<p>When building a portion of your project,<b> gbuild</b> looks for a<b> default.gpj</b> in the</p>
<p>current directory to ensure that any build options set in the upper portions of the</p>
<p>project structure are inherited appropriately. If your Top Project is not named</p>
<p><b>default.gpj</b> or does not exist in the current directory, you must specify its location</p>
<p>with the<b> -top</b> option.</p>
<p>For example, if you have navigated to<b> utilities/print_utility/</b>, and intend to build</p>
<p><b>print_utility.gpj</b>, you should enter:</p>
<p>gbuild -top ../../default.gpj print_utility.gpj</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>554</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 11.15. Managing Identical Files in Projects</b></p>
<p>If a project contains a source, object, or executable file more than onceâand the</p>
<p>options associated with the files are not identicalâthe settings for the most recently</p>
<p>built file will be used. To correct this behavior, indicate unique output directories</p>
<p>for each instance of the file using<b> -object_dir</b> or<b> :outputDir</b>. For more information,</p>
<p>see âDefining Unique Output Directories for Build Configurationsâ on page 976.</p>
<p><b>Implicit Dependency Analysis</b></p>
<p>A program is explicitly dependent on all of its children in the project tree</p>
<p>(subprojects, libraries, source files, etc.). All other dependencies are considered</p>
<p>implicit dependencies. Implicit Dependency Analysis (IDA) attempts to locate two</p>
<p>specific kinds of implicit dependencies:</p>
<p>1.</p>
<p>Additional libraries referenced by<b> Prebuilt Library</b> objects within a project.</p>
<p>2.</p>
<p>Additional libraries or objects pulled in by options (for example,<b> -l</b>,<b> -kernel</b>,</p>
<p><b>-linker.args</b>), or declared by using<b> :depends</b>.</p>
<p>The first type of IDA is performed as soon as the builder encounters a<b> Prebuilt</b></p>
<p><b>Library</b> object. The second type of IDA is performed after all children of a program</p>
<p>have been built, and before the link phase begins.</p>
<p><b>gbuild</b> attempts to locate the build item that produces additional dependencies found</p>
<p>via IDA, and builds the dependencies automatically if they are not current.</p>
<p>Dependencies that<b> gbuild</b> cannot build (for example, because they are system</p>
<p>libraries) are ignored.</p>
<p>When searching for dependencies,<b> gbuild</b> looks for children of the following items</p>
<p>and builds the first instance of the implicit dependency it finds:</p>
<p>â¢</p>
<p>Ancestors of the Program<b> .gpj</b> being analyzed.</p>
<p>â¢</p>
<p>Project and Subproject<b> .gpj</b> files that are children of any of the program's</p>
<p>ancestors.</p>
<p>â¢</p>
<p>Project and Subproject<b> .gpj</b> files that are not descendants of a buildable item.</p>
<p>If your project depends on code built in an external project tree, you can extend the</p>
<p>implicit dependency analysis search to that external project tree by specifying an</p>
<p><b>externalDepends</b> directive in the header of your Top Project (see âGroup 1</p>
<p><i>555</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Implicit Dependency Analysis</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Directivesâ on page 961). External projects are searched in the order specified by</p>
<p><b>externalDepends</b> and are only searched if dependencies are not found in the Top</p>
<p>Project of the program being analyzed. When searching external projects,<b> gbuild</b></p>
<p>looks in:</p>
<p>â¢</p>
<p>Project and Subproject<b> .gpj</b> files that are not descendants of a buildable item.</p>
<p>Using<b> externalDepends</b> is especially recommended for INTEGRITY users whose</p>
<p>applications depend on source code in the INTEGRITY project tree.</p>
<p>An implicit dependency can be defined after an item that references it. As long as</p>
<p>it meets the preceding requirements, IDA will still find and build the implicit</p>
<p>dependency.<b> gbuild</b> does not perform IDA during the clean phase of a build. Thus,</p>
<p>implicit dependencies are not cleaned. You must clean the dependencies separately,</p>
<p>or clean a parent project.</p>
<p>IDA is enabled by default, and can be disabled by adding<b> -nochecklibs</b> to the default</p>
<p>build options in your Top Project. For more information about setting default build</p>
<p>options, see the documentation for the<b> defaultBuildOptions</b> group 1 directive in</p>
<p>âTop Project Directivesâ on page 961. Disabling IDA may degrade parallel build</p>
<p>performance. For more information, see the documentation for<b> -parallel_level=</b> in</p>
<p>âThe gbuild Utility Programâ on page 547.</p>
<p><b>The gcolor Utility Program</b></p>
<p>The<b> gcolor</b> program takes text input, colors it using ANSI escape sequences, and</p>
<p>outputs it to</p>
<p>stdout</p>
<p>.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gcolor</b> [<i>options</i>] [<i>filenames</i>]...</p>
<p>where<i> filenames</i> is an optional list of one or more whitespace-delimited input</p>
<p>filenames. If no files are specified,</p>
<p>stdin</p>
<p>is used.</p>
<p>The<i> options</i> for<b> gcolor</b> are:</p>
<p><b>-f</b></p>
<p>Forces coloring even when output is redirected.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>556</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-help</b></p>
<p>Shows the list of<b> gcolor</b> options.</p>
<p><b>-r<i> file</b></i></p>
<p>Reads the coloring rules from<i> file</i>. If this option is not passed, the default rules contained within</p>
<p><b>defaults/colors/build.rul</b> are used.</p>
<p>The<b> gcolor</b> utility reads in a set of rules from a rules file to determine how the input</p>
<p>should be colored. If a line from the input cannot be identified as conforming to</p>
<p>any rule, then no coloring is performed.</p>
<p>There are five types that can be defined using rules that are recognized by<b> gcolor</b>.</p>
<p>Each one can output a specific foreground, background, and attribute.</p>
<p><b>Default Coloring</b></p>
<p><b>Rule</b></p>
<p>Foreground = Bold, Default</p>
<p>info</p>
<p>Foreground = Bold, Magenta</p>
<p>warning</p>
<p>Foreground = Bold, Red</p>
<p>error</p>
<p>Foreground = Normal, Default</p>
<p>before</p>
<p>Foreground = Bold, Default</p>
<p>after</p>
<p><b>Note</b></p>
<p>The types</p>
<p>before</p>
<p>and</p>
<p>after</p>
<p>are used for coloring output from a</p>
<p>diff</p>
<p>,</p>
<p>for example when comparing two files.</p>
<p><b>Color Configuration Files</b></p>
<p>The color configuration for each of the types can be controlled by creating a</p>
<p><b>colors.ini</b> file and saving it in your user configuration directory.</p>
<p>The syntax of a color configuration file is as follows:</p>
<p>[<i>type</i>]</p>
<p>attribute =<i> value</i></p>
<p>foreground =<i> value</i></p>
<p>background =<i> value</i></p>
<p>where<i> type</i> and<i> value</i> are listed in the following tables:</p>
<p><i>557</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Color Configuration Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Attributes</b></p>
<p><b>Colors</b></p>
<p><b>Types</b></p>
<p><b>Attribute</b></p>
<p><b>Value</b></p>
<p><b>Background</b></p>
<p><b>or Foreground</b></p>
<p><b>Value</b></p>
<p>Default</p>
<p>-1</p>
<p>Default</p>
<p>-1</p>
<p>info</p>
<p>None</p>
<p>0</p>
<p>Black</p>
<p>0</p>
<p>warning</p>
<p>Bold</p>
<p>1</p>
<p>Red</p>
<p>1</p>
<p>error</p>
<p>Underscore</p>
<p>4</p>
<p>Green</p>
<p>2</p>
<p>before</p>
<p>Blink</p>
<p>5</p>
<p>Yellow</p>
<p>3</p>
<p>after</p>
<p>Reverse</p>
<p>7</p>
<p>Blue</p>
<p>4</p>
<p>Concealed</p>
<p>8</p>
<p>Magenta</p>
<p>5</p>
<p>Cyan</p>
<p>6</p>
<p>White</p>
<p>7</p>
<p>Comment lines must be prefixed with a '</p>
<p>#</p>
<p>'</p>
<p>character as the first non-whitespace</p>
<p>character.</p>
<p>For example, to make</p>
<p>info</p>
<p>display in normal white text on a blue background, you</p>
<p>would use the following:</p>
<p>[info]</p>
<p>attribute = 0</p>
<p>foreground = 7</p>
<p>background = 4</p>
<p><b>Note</b></p>
<p>If you do not specify coloring for a type, that type is colored in the default</p>
<p>manner. If you do not specify<i> values</i> for</p>
<p>attribute</p>
<p>,</p>
<p>foreground</p>
<p>, or</p>
<p>background</p>
<p>, the default values are used.</p>
<p><b>Rules Files</b></p>
<p>The default set of rules is located in<b> defaults/colors/build.rul</b>. These correspond</p>
<p>to the output from the builder and any of the programs that it invokes (the compiler,</p>
<p>assembler, linker, etc.).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>558</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Alternatively, you can specify your own set of rules to use with the<b> -r<i> file</b></i> option.</p>
<p>You must create a rules file (<i><b>file</i>.rul</b>) and save it in the following location:</p>
<p>â¢</p>
<p>Site-wide rules should be saved in the<b> config/colors</b> directory.</p>
<p>â¢</p>
<p>User-specific rules should be saved in your .<b>ghs/colors</b> directory.</p>
<p><b>Writing a Rules File</b></p>
<p>Rules are described using regular expressions. To add a rule to a rules file, first you</p>
<p>must give the type of the rule, followed by a colon, and then the desired regular</p>
<p>expression. The regular expression begins with the first non-whitespace character</p>
<p>following the colon.</p>
<p>For example, if you wanted to define directories in a standard Linux/Solaris-style</p>
<p>directory listing as</p>
<p>info</p>
<p>, you can use a simple rule such as:</p>
<p>info: /$</p>
<p>There are two special rule types:</p>
<p>none</p>
<p>and</p>
<p>previous</p>
<p>.The</p>
<p>none</p>
<p>type causes</p>
<p>matching text to be printed without color. This is useful if you want to prevent the</p>
<p>coloring of specific lines that would otherwise match against a later rule. For</p>
<p>example, the rules:</p>
<p>none: ^foobar</p>
<p>info: ^foo</p>
<p>would color lines beginning with</p>
<p>foo</p>
<p>, except those beginning with</p>
<p>foobar</p>
<p>.</p>
<p>The</p>
<p>previous</p>
<p>type causes matching text to be colored the same as the previous</p>
<p>line of text. This is useful to ensure that continuation lines are colored the same as</p>
<p>their parents.</p>
<p>Comment lines must be prefixed with a '</p>
<p>#</p>
<p>'</p>
<p>character as the first non-whitespace</p>
<p>character.</p>
<p><b>Example 11.16. Coloring a File</b></p>
<p>To color file<b> foo</b>, using your own set of rules contained within<b> myrules.rul</b>:</p>
<p>gcolor -r myrules.rul foo</p>
<p><i>559</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Rules Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>To color builder output using the standard rules, enter (for<b> sh</b> shells):</p>
<p>gbuild default.gpj 2&gt;&amp;1 | gcolor</p>
<p>Note that the syntax for<b> csh</b> shells is different. If you are using a<b> csh</b> shell, enter:</p>
<p>gbuild default.gpj |&amp; gcolor</p>
<p><b>Note</b></p>
<p>Regular expression support is provided by the PCRE library package,</p>
<p>which is open source software, written by Philip Hazel, and copyrighted</p>
<p>by the University of Cambridge, England. It can be downloaded from</p>
<p>the University of Cambridge FTP server</p>
<p>[ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/].</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>560</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gcompare Utility Program</b></p>
<p>The<b> gcompare</b> utility program compares the code size of matching functions in</p>
<p>two input files and produces a report. Input files can be ASCII text files, object</p>
<p>files, object file libraries, or executable files. If an input file is a text file, it consists</p>
<p>of lines in the following format:</p>
<p>name1</p>
<p>number1</p>
<p>name2</p>
<p>number2</p>
<p>...</p>
<p>Each name/number pair is on its own line, separated by blanks or tabs.</p>
<p>If either input file is an object file, an object library file, or an executable file,</p>
<p><b>gcompare</b> automatically runs<b> gfunsize -gcompare</b> (or another command specified</p>
<p>by the<b> -x</b> option) to produce an input text file to compare.</p>
<p>You can mix all input file types with no restrictions, including files for different</p>
<p>target CPUs.</p>
<p>The<b> gcompare</b> utility reads both input files. For any name that does not exist in</p>
<p>both files,<b> gcompare</b> prints a warning, unless<b> -w</b> is specified. For each name that</p>
<p>exists in both files,<b> gcompare</b> compares the old and new numbers. If the new number</p>
<p>is worse (larger is worse unless<b> -i</b> is specified),<b> gcompare</b> writes a line to the output</p>
<p>report file containing the name, new number, old number, and percentage by which</p>
<p>the new number is worse.</p>
<p>For example, if the size of the function</p>
<p>main</p>
<p>has increased from 28 bytes in<b> a.out</b></p>
<p>to 32 bytes in</p>
<p>b.out</p>
<p>, then</p>
<p>gcompare a.out b.out</p>
<p>will produce:</p>
<p>main</p>
<p>32</p>
<p>28</p>
<p>-14%</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gcompare</b> [<i>options</i>]<i> oldfile newfile</i></p>
<p>where<i> oldfile</i> is the baseline input file and<i> newfile</i> is the input file for which</p>
<p>deviations (improvements or degradations) are reported.</p>
<p><i>561</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gcompare Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The<b> gcompare<i></b> options</i> are:</p>
<p><b>-1</b></p>
<p>Produces a report with comparisons sorted from worst to best. All comparisons (including those</p>
<p>in which<i> newfile</i> is no larger than<i> oldfile</i>) are shown. In addition, a summary is provided at the</p>
<p>top, showing the aggregate size comparison between<i> newfile</i> and<i> oldfile</i>.</p>
<p><b>-a</b></p>
<p>Prints comparisons even when items exist in only one file.</p>
<p><b>-help</b></p>
<p>Displays information about all options.</p>
<p><b>-i</b></p>
<p>With<b> -i</b>, larger is better. Without<b> -i</b>, smaller is better.</p>
<p><b>-ignore<i> name</b></i></p>
<p>Suppresses comparisons of symbol<i> name</i>.</p>
<p><b>-L</b></p>
<p>Formats the report in 132-column (landscape) mode. The default is 80-column (portrait) mode.</p>
<p><b>-min=<i>n</b></i></p>
<p>Suppresses comparisons where the difference between the compared items is less than<i> n</i> bytes.</p>
<p><b>-r</b></p>
<p>Produces a 2-column report with comparisons sorted both from worst to best and from best to</p>
<p>worst.</p>
<p><b>-v</b></p>
<p>Verbose mode, similar to<b> -1</b>, but with additional diagnostics.</p>
<p><b>-w</b></p>
<p>Suppresses warnings.</p>
<p><b>-width=<i>n</b></i></p>
<p>Sets width (<i>n</i>) to any value greater than 32.</p>
<p><b>-x<i> cmd</b></i></p>
<p>Specifies the command to execute on an input file recognized as an object, object library, or</p>
<p>executable file. The default<b> -x</b> command is:</p>
<p>-x &quot;gfunsize -gcompare -all&quot;</p>
<p><b>-z</b></p>
<p>Does not show cases where files are the same.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>562</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If the<b> -r</b>,<b> -1</b>, or<b> -v</b> options are used, all comparisons are shown, regardless of the</p>
<p>result of the comparison. With<b> -r</b>, two reports are shown side by side in two columns.</p>
<p>The left column is sorted from best to worst, and the right column is sorted from</p>
<p>worst to best.</p>
<p>Sample<b> -r</b> output:</p>
<p>linpack.OS.o</p>
<p>|</p>
<p>linpack.O.o</p>
<p>vs linpack.O.o</p>
<p>| vs linpack.OS.o</p>
<p>BETTER by:</p>
<p>3208</p>
<p>3476 7.71% | WORSE by:</p>
<p>3476</p>
<p>3208 8.35%</p>
<p>---------------------------------------|---------------------------------------</p>
<p>epslon</p>
<p>20</p>
<p>20</p>
<p>0% | dgefa</p>
<p>484</p>
<p>356</p>
<p>-36%</p>
<p>main</p>
<p>912</p>
<p>928</p>
<p>2% | matgen</p>
<p>304</p>
<p>252</p>
<p>-21%</p>
<p>dmxpy</p>
<p>1188</p>
<p>1224</p>
<p>3% | dgesl</p>
<p>272</p>
<p>248</p>
<p>-10%</p>
<p>idamax</p>
<p>108</p>
<p>112</p>
<p>4% | dscal</p>
<p>52</p>
<p>48</p>
<p>-8%</p>
<p>daxpy</p>
<p>76</p>
<p>80</p>
<p>5% | daxpy</p>
<p>80</p>
<p>76</p>
<p>-5%</p>
<p>dscal</p>
<p>48</p>
<p>52</p>
<p>8% | idamax</p>
<p>112</p>
<p>108</p>
<p>-4%</p>
<p>dgesl</p>
<p>248</p>
<p>272</p>
<p>9% | dmxpy</p>
<p>1224</p>
<p>1188</p>
<p>-3%</p>
<p>matgen</p>
<p>252</p>
<p>304</p>
<p>17% | main</p>
<p>928</p>
<p>912</p>
<p>-2%</p>
<p>dgefa</p>
<p>356</p>
<p>484</p>
<p>26% | epslon</p>
<p>20</p>
<p>20</p>
<p>0%</p>
<p>This output can require many columns. Use the<b> -L</b> option for a 132-column format.</p>
<p>On Linux/Solaris, use the<b> lpr -L</b> command to print in landscape mode.</p>
<p><i>563</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gcompare Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gdump Utility Program</b></p>
<p>The<b> gdump</b> utility program performs a similar function to the Linux/Solaris<b> dump</b></p>
<p>program. It produces information about various types of files.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gdump</b> [<i>options</i>]<i> filename</i></p>
<p>where<i> filename</i> is the name of the input file, and<i> options</i> are listed in one of the</p>
<p>following tables:</p>
<p><b>Debugging File Options</b></p>
<p>You can use the<b> gdump</b> utility to print symbolic debugging information from a</p>
<p><b>.dbo</b>,<b> .dba</b>,<b> .dlo</b>,<b> .dla</b>, or<b> .dnm</b> file. The options for<b> .dnm</b> files are different than</p>
<p>those for the other debugging files.</p>
<p><b>-c</b></p>
<p>Performs internal consistency checks.</p>
<p><b>-C</b></p>
<p>Performs internal consistency checks, but ignores warnings.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>564</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-d<i>info</b></i></p>
<p>Enables the display of particular information, where<i> info</i> is a letter from the lists below.</p>
<p>The following values for<i> info</i> are available for all debugging file formats:</p>
<p>â¢</p>
<p>a</p>
<p>â the attributes</p>
<p>â¢</p>
<p>f</p>
<p>â the file table</p>
<p>â¢</p>
<p>h</p>
<p>â the file header</p>
<p>â¢</p>
<p>t</p>
<p>â the</p>
<p>typedef</p>
<p>table</p>
<p>The following values for<i> info</i> are available for all debugging file formats except<b> .dnm</b>:</p>
<p>â¢</p>
<p>c</p>
<p>â static call information</p>
<p>â¢</p>
<p>d</p>
<p>â the</p>
<p>#define</p>
<p>table</p>
<p>â¢</p>
<p>g</p>
<p>â actual call information</p>
<p>â¢</p>
<p>i</p>
<p>â include reference information</p>
<p>â¢</p>
<p>m</p>
<p>â frames</p>
<p>â¢</p>
<p>o</p>
<p>â code trees</p>
<p>â¢</p>
<p>p</p>
<p>â the procedure table</p>
<p>â¢</p>
<p>s</p>
<p>â the symbol table</p>
<p>â¢</p>
<p>u</p>
<p>â the auxiliary table</p>
<p>â¢</p>
<p>x</p>
<p>â cross reference information</p>
<p>The following values for<i> info</i> are available for the<b> .dnm</b> file format only:</p>
<p>â¢</p>
<p>b</p>
<p>â linkage stubs</p>
<p>â¢</p>
<p>d</p>
<p>â<b> .dlo</b> files</p>
<p>â¢</p>
<p>e</p>
<p>â the global</p>
<p>#define</p>
<p>table</p>
<p>â¢</p>
<p>i</p>
<p>â the trace regions table</p>
<p>â¢</p>
<p>k</p>
<p>â link labels</p>
<p>â¢</p>
<p>l</p>
<p>â libraries</p>
<p>â¢</p>
<p>s</p>
<p>â sections</p>
<p>â¢</p>
<p>u</p>
<p>â<b> .dnm</b> updates</p>
<p><b>-help</b></p>
<p>Displays information about all options.</p>
<p><b>-v</b></p>
<p>Performs internal consistency checks only. Does not display symbols.</p>
<p><i>565</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Debugging File Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-V</b></p>
<p>Same as<b> -v</b>, but ignores warnings.</p>
<p><b>ELF File Options</b></p>
<p>The<b> gdump<i></b> options</i> for ELF format files are as follows:</p>
<p><b>-asm</b></p>
<p>Produces text sections as pure assembly language (see also the<b> -ytext</b> option).</p>
<p><b>-dwarf</b></p>
<p>Produces DWARF information only.</p>
<p><b>-full</b></p>
<p>Produces everything except section contents (see also the<b> -ysec</b> option).</p>
<p><b>-help</b></p>
<p>Displays information about all options.</p>
<p><b>-integrity_checksum</b></p>
<p>Applies the checksum calculation method used by INTEGRITY when the<b> -print_checksum</b> or</p>
<p><b>-verify_checksum</b> options are specified.</p>
<p><b>-load</b></p>
<p>Displays ELF header summary.</p>
<p><b>-map</b></p>
<p>Displays section summary.</p>
<p><b>-N</b></p>
<p>Only displays information as indicated by the<b> -y</b> options.</p>
<p><b>-no_trunc_sec_names</b></p>
<p>Displays full section names with<b> -map</b>, instead of truncating to 20 characters.</p>
<p><b>-print_checksum</b></p>
<p>Prints the checksum for each appropriate section. If<b> -verify_checksum</b> is also specified,</p>
<p>checksums are assumed to exist and<b> -print_checksum</b> prints them for those sections where the</p>
<p>checksum is found to be correct. If the<b> -verify_checksum</b> option is not specified, checksums</p>
<p>are assumed not to exist in the section, so they are calculated using all bytes in the section.</p>
<p><b>-raw</b></p>
<p>If the<b> -ysec</b> option is specified, this produces text sections in hexadecimal format instead of</p>
<p>disassembly.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>566</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-section=<i>name</b></i></p>
<p>Displays the contents of the specified section only.</p>
<p><b>-sx</b></p>
<p><b>-nx</b></p>
<p>Enables or disables attempted shorter C++ demangling.</p>
<p><b>-sym</b></p>
<p>Uses symbol names instead of numbers in relocation output.</p>
<p><b>-v1</b></p>
<p><b>-v2</b></p>
<p>Specifies display of DWARF Version 1 or 2. The DWARF version in use is detected</p>
<p>automatically by<b> gdump</b>, and the appropriate option set automatically.</p>
<p><b>-verify_checksum</b></p>
<p>Instructs<b> gdump</b> that all non-empty, allocated sections have a 4-byte checksum generated by</p>
<p>the Green Hills linker. Compares the content of each section against the existing checksum and,</p>
<p>if they do not match, displays both.</p>
<p><b>-y<i>info</b></i></p>
<p><b>-n<i>info</b></i></p>
<p>Enables or disables the display of particular information, where<i> info</i> is one of:</p>
<p>â¢</p>
<p>d</p>
<p>: DWARF debugging information</p>
<p>â¢</p>
<p>dynamic</p>
<p>: dynamic linkage information</p>
<p>â¢</p>
<p>f</p>
<p>: DWARF call frame information</p>
<p>â¢</p>
<p>g</p>
<p>: global offset table</p>
<p>â¢</p>
<p>h</p>
<p>: ELF header information</p>
<p>â¢</p>
<p>l</p>
<p>: DWARF line number information</p>
<p>â¢</p>
<p>m</p>
<p>: DWARF macro information</p>
<p>â¢</p>
<p>r</p>
<p>: relocation information</p>
<p>â¢</p>
<p>p</p>
<p>: procedure linkage table</p>
<p>â¢</p>
<p>s</p>
<p>: symbol table information</p>
<p>â¢</p>
<p>sec</p>
<p>: section contents</p>
<p>â¢</p>
<p>sh</p>
<p>: section header information</p>
<p>â¢</p>
<p>str</p>
<p>: string table information</p>
<p>â¢</p>
<p>text</p>
<p>: text section contents</p>
<p><i>567</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ELF File Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>COFF File Options</b></p>
<p>The<b> gdump<i></b> options</i> for COFF files are as follows:</p>
<p><b>-ascii</b></p>
<p>Displays section contents in ASCII.</p>
<p><b>-aux</b></p>
<p>Displays auxiliary entries (in hex) with symbol entries.</p>
<p><b>-bigendian</b></p>
<p><b>-littleendian</b></p>
<p>Forces either a big or little endian target.</p>
<p><b>-brief</b></p>
<p>Displays symbols only.</p>
<p><b>-c</b></p>
<p>Displays string table.</p>
<p><b>-cpu=<i>name</b></i></p>
<p>Sets CPU type (<i>name</i>).</p>
<p><b>-d<i> num</i> [+d<i> num2</i>]</b></p>
<p>Displays section<i> num</i> or sections from<i> num</i> to<i> num2</i>.</p>
<p><b>-f</b></p>
<p>Displays file header.</p>
<p><b>-full</b></p>
<p>Displays everything.</p>
<p><b>-g</b></p>
<p>Displays global symbols.</p>
<p><b>-h</b></p>
<p>Displays section headers.</p>
<p><b>-helpcoff</b></p>
<p>Displays all options relating to COFF files.</p>
<p><b>-l</b></p>
<p>Displays line number information.</p>
<p><b>-map</b></p>
<p>Displays section summary.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>568</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-nx</b></p>
<p>Does not attempt to demangle C++ names.</p>
<p><b>-o</b></p>
<p>Displays optional header.</p>
<p><b>-r</b></p>
<p>Displays relocation information.</p>
<p><b>-raw</b></p>
<p>Produces section contents in raw form.</p>
<p><b>-s</b></p>
<p>Produces section contents.</p>
<p><b>-sx</b></p>
<p>Attempts shorter C++ demangling.</p>
<p><b>-sym</b></p>
<p>Uses symbol names instead of numbers in relocation output.</p>
<p><b>-t<i> num</i> [+t<i> num2</i>]</b></p>
<p>Displays symbol<i> num</i> or symbols from<i> num</i> to<i> num2</i>.</p>
<p><b>-ysec</b></p>
<p><b>-ytext</b></p>
<p>Enables the display of section contents and/or text section contents.</p>
<p><b>BSD a.out File Options</b></p>
<p>The<b> gdump<i></b> options</i> for BSD a.out format files are as follows:</p>
<p><b>-c</b></p>
<p>Displays section contents.</p>
<p><b>-h</b></p>
<p>Displays file header.</p>
<p><b>-helpbsd</b></p>
<p>Displays information about all BSD-specific options.</p>
<p><b>-r</b></p>
<p>Displays relocation entries.</p>
<p><i>569</i></p>
<p><i>Green Hills Software</i></p>
<p><i>BSD a.out File Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-s</b></p>
<p>Displays symbol table.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>570</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gfile Utility Program</b></p>
<p>The<b> gfile</b> utility program performs a similar function to the Linux/Solaris<b> file</b></p>
<p>program. It displays the file type of each filename argument, and can also display</p>
<p>additional information. For example, if a machine supports both big endian and</p>
<p>little endian data ordering, then for an object file, object file library, or executable</p>
<p>file,<b> gfile</b> displays the machine type and byte order. For unrecognized object files,</p>
<p><b>gfile</b> prints</p>
<p>unknown machine type</p>
<p>. In general,<b> gfile</b> handles BSD a.out, ELF,</p>
<p>and some COFF formats.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gfile<i></b> filenames</i> ...</p>
<p>where<i> filenames</i> is a list of one or more filenames separated by whitespace.</p>
<p>If the current host system is a SPARC workstation running the Solaris 2.<i>x</i> operating</p>
<p>system (which uses the ELF format for executable files), you will see the following</p>
<p>behavior:</p>
<p>gfile /bin/od</p>
<p>/bin/od:</p>
<p>SPARC big endian executable (ELF)</p>
<p><i>571</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gfile Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gfunsize Utility Program</b></p>
<p>The<b> gfunsize</b> utility program displays the code size of one or more named functions</p>
<p>in an object file, library file, or executable. The code size of ELF functions is usually</p>
<p>part of the ELF symbol information.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gfunsize</b> [<i>options</i>]<i> filename</i></p>
<p>where<i> filename</i> is the file to examine, and<i> options</i> are listed in the following table:</p>
<p><b>-addr</b></p>
<p>Displays the address of each function.</p>
<p><b>-file</b></p>
<p>Displays the filename before each function.</p>
<p><b>-func=<i>name</b></i></p>
<p>Displays the code sizes of the specified function or functions.</p>
<p><b>-gcompare</b></p>
<p>Displays the output in a format suitable for input to the<b> gcompare</b> utility program.</p>
<p><b>-help</b></p>
<p>Displays information about all options.</p>
<p><b>-hex</b></p>
<p>Displays function code sizes and addresses in hexadecimal.</p>
<p><b>-nounderscores</b></p>
<p>Removes leading underscores from function names.</p>
<p>The following options are mutually exclusive:</p>
<p>â¢</p>
<p><b>-sect=<i>name</b></i></p>
<p>Displays functions in section<i> name</i>.</p>
<p>â¢</p>
<p><b>-sectnum=<i>n</b></i></p>
<p>Displays functions in section number<i> n</i>.</p>
<p><b>-w</b></p>
<p>Suppresses warnings.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>572</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The ghide Utility Program</b></p>
<p>The<b> ghide</b> utility program modifies the symbol table of an existing object file by</p>
<p>converting all global symbols to local symbols, except for a specified list of global</p>
<p>symbols that remain global.<b> ghide</b> does not affect</p>
<p>COMMON</p>
<p>variables. The object</p>
<p>file can be either relocatable or not relocatable, but it must contain a symbol table;</p>
<p>otherwise<b> ghide</b> has no effect.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>ghide</b> [<i>options</i>]<i> retain_list object_file</i></p>
<p>where<i> retain_list</i> is the name of an input file containing symbol names, separated</p>
<p>by whitespace or newline characters, that are to be retained (not hidden), and</p>
<p><i>object_file</i> is the name of the existing object file to be modified by<b> ghide</b>.</p>
<p>The<b> ghide<i></b> options</i> are:</p>
<p><b>-help</b></p>
<p>Displays information about<b> ghide</b>.</p>
<p><b>Using ghide</b></p>
<p>Suppose an embedded application system consists of a kernel and several application</p>
<p>tasks, all developed independently. Some global functions in the kernel are for</p>
<p>kernel use only. Other global kernel functions can be called from the application</p>
<p>tasks.</p>
<p>First, the kernel is linked into a single file using the linker's<b> -r</b> option to retain</p>
<p>relocation information. Then,<b> ghide</b> is run on the kernel using a retain list of the</p>
<p>functions that should remain visible to the application tasks. Finally, the application</p>
<p>tasks are linked with the kernel file, producing a complete executable file.</p>
<p>The use of<b> ghide</b> ensures that only the desired global symbols in the kernel are</p>
<p>visible to the application tasks. This also prevents duplicate symbol errors in the</p>
<p>linker if any application might have a global symbol with the same name as an</p>
<p>internal kernel-only function.</p>
<p><i>573</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The ghide Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gmemfile Utility Program</b></p>
<p>The<b> gmemfile</b> utility program creates a binary memory image of a fully linked</p>
<p>executable. This memory image is suitable for downloading to target memory. Use</p>
<p>the</p>
<p>-memory</p>
<p>driver option to automatically invoke</p>
<p>gmemfile</p>
<p>. For more information</p>
<p>about</p>
<p>-memory</p>
<p>, see âGenerate Additional Outputâ on page 236.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gmemfile<i></b> executable</i> [<i>options</i>]</p>
<p>where<i> executable</i> is the name of the executable from which to generate the memory</p>
<p>image, and<i> options</i> are listed in the following table:</p>
<p><b>-byte<i> b</i> [of]<i> n</b></i></p>
<p>By default,<b> gmemfile</b> outputs all data bytes to the memory image. This option looks at data in</p>
<p>the input file in chunks the size of the bus width (<i>n</i>) and writes only the specified data bytes (<i>b</i>)</p>
<p>within each data chunk in the input data to the output file. It can be used to separate odd or even</p>
<p>data bytes or words for burning PROMs when the size of the PROMs differs from the size of</p>
<p>the bus. It is also used to reverse the order of the data bytes for a shared bus environment.</p>
<p>The width,<i> n</i>, represents the width of the data bus. The maximum width allowed is 32 that</p>
<p>represents a 256 bit bus. The bytes,<i> b</i>, within the specified bus width<i> n</i> are numbered 1 through</p>
<p><i>n</i> where 1 is the first byte and<i> n</i> is the last byte.</p>
<p>The bytes,<i> b</i>, can be specified in one of the following ways:</p>
<p>â¢</p>
<p>as a single byte (for example,</p>
<p>-byte 1 of 4</p>
<p>). In this example, for each 4 byte chunk of</p>
<p>input data, only byte 1 is written to the output file.</p>
<p>â¢</p>
<p>as a range of bytes (for example,</p>
<p>-byte 1-4 of 8</p>
<p>). In this example, for each 8 byte</p>
<p>chunk of data in the input file, bytes 1, 2, 3 and 4 are written to the output file.</p>
<p>â¢</p>
<p>as a list of bytes (for example,</p>
<p>-byte 4,3,2,1 of 4</p>
<p>). In this example, for each 4 byte</p>
<p>chunk of data, the bytes are reversed and written to the output file.</p>
<p>â¢</p>
<p>as a combination of a list and a range (for example,</p>
<p>-byte 1-4,6,9-12 of 16</p>
<p>).</p>
<p><b>-end<i> address</b></i></p>
<p>Specifies the highest address of data to be placed in the memory image. If<i> address</i> is higher</p>
<p>than the highest address of the executable, the bytes between them are padded with zeros unless</p>
<p><b>-fill<i>x</b></i> is passed. You can specify a section name instead of an address, and the highest address</p>
<p>of that section is used.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>574</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-fill<i>x</b> start end value</i></p>
<p>Fills holes before, after, or between sections of the executable in the specified range<i> start</i> to<i> end</i></p>
<p>with the specified<i> value</i>. The byte order of the input file (big or little endian) is applied to the</p>
<p>fill value.</p>
<p><b>-fill1</b> fills holes with a single byte of data.</p>
<p><b>-fill2</b> fills holes with two bytes of data, aligning the fill bytes on a 2-byte boundary.</p>
<p><b>-fill4</b> fills holes with four bytes of data, aligning the fill bytes on a 4-byte boundary.</p>
<p>If the<i> start</i> and/or<i> end</i> parameters are outside the address range of the data in the executable,</p>
<p>the fill value is applied to the gaps at the beginning and/or end of the memory image. Section</p>
<p>names can be specified instead of addresses for the<i> start</i> and<i> end</i> parameters. The start address</p>
<p>of a section is used for the<i> start</i> parameter. The end address of a section is used for the<i> end</i></p>
<p>parameter.</p>
<p>When multiple<b> -fill</b> options cover the same area,<b> -fill4</b>,<b> -fill2</b>,<b> -fill1</b> options are processed in that</p>
<p>order. The<b> -start</b> and<b> -end</b> options take precedence over the<b> -fill</b> options and can be used to</p>
<p>control the bounds of the memory image.</p>
<p><b>-help</b></p>
<p>Displays a summary of the command line syntax and options for using<b> gmemfile</b>.</p>
<p><b>-hole<i> size</b></i></p>
<p>Overrides the default checking for holes between sections.</p>
<p>By default, a warning message is displayed if there is a hole larger than 4096 bytes; no error is</p>
<p>generated for any size hole.</p>
<p>This option causes an error to be emitted if there is a hole larger than<i> size</i> bytes.</p>
<p><b>-import<i> start filename</b></i></p>
<p>Copies the binary data from the specified<i> filename</i> to the specified<i> start</i> address in the memory</p>
<p>image. Use the<b> -import</b> option to bring in input from a previous run of<b> gmemfile</b> or from some</p>
<p>other utility that produces a memory image.</p>
<p>If you specify a section name for the<i> start</i> parameter, the binary data is copied to the next byte</p>
<p>after the last address in the specified section.</p>
<p><b>-map<i> filename</b></i></p>
<p>Creates a detailed map file. The map file contains the command input, a list of all sections from</p>
<p>the input executable file, a list of<b> -import</b> data, a memory map of the output memory file, and</p>
<p>a summary of the memory image.</p>
<p><b>-o<i> filename</b></i></p>
<p>Specifies the name of the memory image file to be output. The default is the name of the</p>
<p>executable with the extension, if any, replaced by</p>
<p>.bin</p>
<p>. If there is no input file, the default name</p>
<p>of the output file is<b> a.bin</b>.</p>
<p><i>575</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gmemfile Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-size<i> value</b></i></p>
<p>Sets the size of the memory image to<i> value</i> bytes. This is an alternative to using the<b> -end</b> option.</p>
<p>An error is displayed if both<b> -size</b> and<b> -end</b> appear in the command input.</p>
<p>By default, all data from the executable is written to the memory image.</p>
<p><b>-skip<i> sname</b></i></p>
<p>Excludes data in the specified section<i> sname</i> of the executable from the memory image.</p>
<p><b>-start<i> address</b></i></p>
<p>Specifies the<i> address</i> in the executable at which to begin copying data to the memory image.</p>
<p>A section name can be specified instead of an address, and then the start address is the first</p>
<p>address in the section. If the start address is lower than the lowest address in the executable, the</p>
<p>bytes between the start address and the executable are padded with zeros or with a fill value if</p>
<p>one was specified with<b> -fill1</b>,<b> -fill2</b>, or<b> -fill4</b>.</p>
<p><b>-w</b></p>
<p>Does not display warnings.</p>
<p><b>Data Splitting</b></p>
<p>In some hardware implementations, the width of the data bus differs from the width</p>
<p>of the PROMs. Depending on how the bus and PROMs are connected, it might be</p>
<p>necessary to store low bytes, or words, in one PROM and high bytes, or words, in</p>
<p>another PROM. The<b> gmemfile</b> utility supports such<i> data splitting</i> through the<b> -byte</b></p>
<p>option (see Example 11.22. Separating Low and High Bytes of Data into Separate</p>
<p>PROMs on page 578 and Example 11.23. Separating the Low Half and High Half</p>
<p>of Each 4-byte Interval on page 579).</p>
<p>The following examples use for illustration a program file<b> prog1</b> that contains the</p>
<p>following sections:</p>
<p><b>Size</b></p>
<p><b>End Address</b></p>
<p><b>Start Address</b></p>
<p><b>Name</b></p>
<p>0x100</p>
<p>0x10ff</p>
<p>0x1000</p>
<p>.text</p>
<p>0x200</p>
<p>0x12ff</p>
<p>0x1100</p>
<p>.rodata</p>
<p>0x300</p>
<p>0x15ff</p>
<p>0x1300</p>
<p>.rdata</p>
<p>0x300</p>
<p>0x22ff</p>
<p>0x2000</p>
<p>.data</p>
<p>0x200</p>
<p>0x24ff</p>
<p>0x2300</p>
<p>.bss</p>
<p>The</p>
<p>.text</p>
<p>section contains all of the code in the program that is executed from</p>
<p>ROM. The</p>
<p>.rodata</p>
<p>section contains read-only data that is accessed in ROM. The</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>576</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.rdata</p>
<p>section contains initialized data that is stored in ROM and copied to</p>
<p>.data</p>
<p>in RAM at program startup. The program references initialized data at the addresses</p>
<p>in section</p>
<p>.data</p>
<p>in RAM. The</p>
<p>.bss</p>
<p>section contains uninitialized data. It is set to</p>
<p>zero at program startup.</p>
<p><b>Example 11.17. Using gmemfile</b></p>
<p>gmemfile prog1.elf</p>
<p>In this example, because no options have been specified, the output file is called</p>
<p><b>prog1.bin</b>, the first byte in the memory image is the first byte of section</p>
<p>.text</p>
<p>,</p>
<p>and its last byte is the last byte of</p>
<p>.rdata</p>
<p>(which is the last section that contains</p>
<p>initialized data).</p>
<p><b>Example 11.18. Using the -start and -o Options</b></p>
<p>gmemfile -start 0 prog1.elf -o prog1.mem</p>
<p>In this example, the option</p>
<p>-start 0</p>
<p>sets the starting address at which<b> gmemfile</b></p>
<p>begins reading the executable to 0. Because the first section of the executable is</p>
<p>.text</p>
<p>, which begins at</p>
<p>0x1000</p>
<p>, the first</p>
<p>0x1000</p>
<p>bytes of the memory image are</p>
<p>set to zero. The utility continues reading and outputting the data from sections</p>
<p>.text</p>
<p>,</p>
<p>.rodata</p>
<p>, and</p>
<p>.rdata</p>
<p>. The last byte in the memory image is the last byte</p>
<p>of section</p>
<p>.rdata</p>
<p>, which is at file offset</p>
<p>0x15ff</p>
<p>in the memory image and at</p>
<p>address</p>
<p>0x15ff</p>
<p>in the executable.</p>
<p>The option</p>
<p>-o prog1.mem</p>
<p>sets the name of the memory image to<b> prog1.mem</b>.</p>
<p><b>Example 11.19. Using the -fill Option</b></p>
<p>gmemfile prog1.elf -fill2 0 .text 0x3e7f -o prog1.mem</p>
<p>In this example, the</p>
<p>-fill2</p>
<p>option specifies that any holes between 0 and the end</p>
<p>of section</p>
<p>.text</p>
<p>be filled with the value</p>
<p>0x3e7f</p>
<p>. The initialized data in</p>
<p>.text</p>
<p>is</p>
<p>not overwritten by</p>
<p>-fill2</p>
<p>. The memory image produced in this example has the</p>
<p>same start (</p>
<p>0</p>
<p>) and end (</p>
<p>0x15ff</p>
<p>) addresses as that in the previous example (the</p>
<p>-start 0</p>
<p>option is not needed, since</p>
<p>-fill2</p>
<p>starts at zero).</p>
<p><b>Example 11.20. Using the -start and -end Options</b></p>
<p>gmemfile prog1.elf -start 0 -end 0x1fff -o prog1.mem</p>
<p><i>577</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Data Splitting</i></p>
<h1 style="page-break-before:always; "></h1>
<p>In this example, the PROM is</p>
<p>0x2000</p>
<p>bytes wide and the PROM burner requires</p>
<p>that all bytes in the PROM be filled. The<b> prog1</b> executable has a hole in front of</p>
<p>its first section (from</p>
<p>0x0</p>
<p>to</p>
<p>0xfff</p>
<p>) and after the end of its initialized data (from</p>
<p>0x1600</p>
<p>to</p>
<p>0x1fff</p>
<p>).</p>
<p>The</p>
<p>-start</p>
<p>option sets the start address of the memory image to zero and</p>
<p>-end</p>
<p>sets its end address to</p>
<p>0x1fff</p>
<p>. Because no</p>
<p>-fill</p>
<p>options have been used, the holes</p>
<p>0x0</p>
<p>to</p>
<p>0xfff</p>
<p>and</p>
<p>0x1600</p>
<p>to</p>
<p>0x1fff</p>
<p>are filled with zeros.</p>
<p><b>Example 11.21. Using the -start and -size Options</b></p>
<p>gmemfile prog1.elf -start 0 -size 0x2000 -o prog1.mem</p>
<p>In this example, the memory image produced is identical to that of the previous</p>
<p>example. Instead of specifying an end address with</p>
<p>-end</p>
<p>, a size is specified with</p>
<p>-size 0x2000</p>
<p>.</p>
<p><b>Example 11.22. Separating Low and High Bytes of Data into Separate PROMs</b></p>
<p>gmemfile -byte 1 of 2 prog1.elf -start .text -size 0x100 -o prog1.low.mem</p>
<p>gmemfile -byte 2 of 2 prog1.elf -start .text -size 0x100 -o prog1.high.mem</p>
<p>In this example it is necessary to separate low and high bytes of data into separate</p>
<p>PROMs, each of which is</p>
<p>0x100</p>
<p>bytes wide. The<b> gmemfile</b> utility is run twice,</p>
<p>using the</p>
<p>-byte</p>
<p>option to select alternate bytes for each of the output files.</p>
<p>In the first command line, the option</p>
<p>-byte 1 of 2</p>
<p>outputs the first byte of data</p>
<p>in each two byte interval. The</p>
<p>-start</p>
<p>option sets<b> gmemfile</b> to reading the</p>
<p>executable at</p>
<p>0x1000</p>
<p>(the first byte of</p>
<p>.text</p>
<p>). The</p>
<p>-size</p>
<p>option sets the size of</p>
<p>the memory image to</p>
<p>0x100</p>
<p>bytes.</p>
<p>The first byte of data in the memory image is the first byte of data in section</p>
<p>.text</p>
<p>.</p>
<p>The second byte of data in the memory image is the third byte of data in section</p>
<p>.text</p>
<p>. The last byte of data in the memory image at file offset</p>
<p>0xff</p>
<p>is from the</p>
<p>.rodata</p>
<p>section in the executable at address</p>
<p>0x11fe</p>
<p>(</p>
<p>0x200</p>
<p>bytes above</p>
<p>0x1000</p>
<p>).</p>
<p>If the bytes in the .</p>
<p>text</p>
<p>section of the executable consisted of:</p>
<p>01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10...</p>
<p>The following bytes would be output to the first memory image file:</p>
<p>01 03 05 07 09 0b 0d 0f...</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>578</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The second command line takes the second byte in each 2-byte interval starting at</p>
<p>the address of</p>
<p>.text</p>
<p>(</p>
<p>0x1000</p>
<p>). The first byte of data in the memory image is the</p>
<p>second byte of data in section</p>
<p>.text</p>
<p>. The second byte of data in the memory image</p>
<p>is the fourth byte of data in section</p>
<p>.text</p>
<p>. The last byte of data in the memory</p>
<p>image is the byte in section</p>
<p>.rodata</p>
<p>at address</p>
<p>0x11ff</p>
<p>.</p>
<p>If the bytes in the</p>
<p>.text</p>
<p>section of the executable consisted of:</p>
<p>01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10...</p>
<p>The following bytes would be in the second memory image file:</p>
<p>02 04 06 08 0a 0c 0e 10...</p>
<p><b>Example 11.23. Separating the Low Half and High Half of Each 4-byte Interval</b></p>
<p>gmemfile -byte 1,2 of 4 prog1.elf -start .text -size 0x100 -o prog1.low.mem</p>
<p>gmemfile -byte 3,4 of 4 prog1.elf -start .text -size 0x100 -o prog1.high.mem</p>
<p>This example is similar to the previous example, except that the low half and high</p>
<p>half of each 4-byte interval is separated. The first command takes the low 2-byte</p>
<p>half of each 4-byte interval of data in the executable starting at the address of</p>
<p>.text</p>
<p>(</p>
<p>x1000</p>
<p>) until there are</p>
<p>0x100</p>
<p>bytes of data in the memory image.</p>
<p>If the bytes in the</p>
<p>.text</p>
<p>section of the executable consisted of:</p>
<p>01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10...</p>
<p>The following bytes would be in the first memory image file:</p>
<p>01 02 05 06 09 0a 0d 0e...</p>
<p>The second command takes the high 2-byte half of each 4-byte interval of data in</p>
<p>the executable starting at the address of</p>
<p>.text</p>
<p>(</p>
<p>x1000</p>
<p>) until there are</p>
<p>0x100</p>
<p>bytes</p>
<p>of data in the memory image.</p>
<p>If the bytes in the</p>
<p>.text</p>
<p>section of the executable consisted of:</p>
<p>01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10...</p>
<p>The following bytes would be in the second memory image file:</p>
<p>03 04 07 08 0b 0c 0f 10...</p>
<p><i>579</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Data Splitting</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 11.24. Changing Data in the .rdata Section</b></p>
<p>This example shows you how to change the endianness of the data in the</p>
<p>.rdata</p>
<p>section of<b> prog1.elf</b>.</p>
<p>gmemfile prog1.elf -start .rdata -end .rdata -byte 4,3,2,1 of 4 -o reverse.bin</p>
<p>gmemfile prog1.elf -skip .rdata -import .rodata reverse.bin -o prog1.bin</p>
<p>The first command loads just the</p>
<p>.rdata</p>
<p>section of<b> prog1.elf</b> into memory. The</p>
<p>-byte 4,3,2,1 of 4</p>
<p>option reverses the byte order of the data. Then,<b> gmemfile</b></p>
<p>writes the result to the memory image file<b> reverse.bin</b>.</p>
<p>The second command loads<b> prog1.elf</b> into memory, but the</p>
<p>-skip .rdata</p>
<p>option</p>
<p>discards any data in the</p>
<p>.rdata</p>
<p>section. The</p>
<p>-import .rodata reverse.bin</p>
<p>option loads<b> reverse.bin</b> after the end of the</p>
<p>.rodata</p>
<p>section (the beginning of</p>
<p>the</p>
<p>.rdata</p>
<p>section). Finally<b> gmemfile</b> writes the result to<b> prog1.bin</b>.</p>
<p><b>Note</b></p>
<p>Because the</p>
<p>-import</p>
<p>option instructs<b> gmemfile</b> to place the data in</p>
<p>reverse.bin</p>
<p>immediately after the</p>
<p>.rodata</p>
<p>section, this example</p>
<p>works only if the end of the</p>
<p>.rodata</p>
<p>section is one byte before the</p>
<p>beginning of the</p>
<p>.rdata</p>
<p>section.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>580</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gnm Utility Program</b></p>
<p>The<b> gnm</b> utility program performs a similar function to the Linux/Solaris<b> nm</b></p>
<p>program. It displays the symbol table of an object file, object library file, or</p>
<p>executable file created by Green Hills development tools.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gnm</b> [<i>options</i>]<i> filenames</i> ...</p>
<p>where<i> filenames</i> is one or more whitespace-delimited input files, and<i> options</i> are</p>
<p>listed in the general options table and the appropriate object format options table:</p>
<p><b>General Options</b></p>
<p>The general<b> gnm</b> options are as follows:</p>
<p><b>-help</b></p>
<p>Displays general options and ELF-specific options.</p>
<p><b>-helpbsd</b></p>
<p>Displays BSD-specific options.</p>
<p><b>-helpcoff</b></p>
<p>Displays COFF-specific options.</p>
<p><b>-helpelf</b></p>
<p>Displays ELF-specific options.</p>
<p><b>-output<i> file</b></i></p>
<p>Writes the output from<b> gnm</b> to<i> file</i>.</p>
<p><b>-V</b></p>
<p>Prints the<b> gnm</b> version.</p>
<p><b>ELF File Options</b></p>
<p>The<b> gnm</b> options for ELF format files are as follows:</p>
<p><b>-a</b></p>
<p>Prints special symbols that are normally suppressed.</p>
<p><i>581</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gnm Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-D</b></p>
<p>Prints symbols from the dynamic symbol table.</p>
<p><b>-defined_only</b></p>
<p>Prints only defined symbols.</p>
<p><b>-dg</b></p>
<p>Prints defined symbols and global symbols. It does not print debug symbols.</p>
<p><b>-g</b></p>
<p>Prints only global symbols.</p>
<p><b>-h</b></p>
<p>Does not print headers.</p>
<p><b>-l</b></p>
<p>Prints an asterisk (</p>
<p>*</p>
<p>) after symbol type for WEAK symbols. This is for<b> -p</b> mode only.</p>
<p><b>-n</b></p>
<p>Sorts output by symbol name.</p>
<p><b>-no_debug</b></p>
<p>Does not print debug symbols such as</p>
<p>..bof</p>
<p>,</p>
<p>..eof</p>
<p>, and</p>
<p>..lin</p>
<p><b>-no_dotdot</b></p>
<p>Does not print any symbols beginning with â</p>
<p>..</p>
<p>â.</p>
<p><b>-no_line</b></p>
<p>Does not print line debug symbols. For example,</p>
<p>..lin</p>
<p>.</p>
<p><b>-o</b></p>
<p>Prints value and size of symbols in octal.</p>
<p><b>-p</b></p>
<p>Uses 3-column output format.</p>
<p><b>-prefixed_msgs</b></p>
<p><b>-no_prefixed_msgs</b></p>
<p>Enables or disables the printing of</p>
<p>WARNING</p>
<p>and</p>
<p>ERROR</p>
<p>before messages.</p>
<p><b>-r</b></p>
<p>Prefixes filename to each line of output.</p>
<p><b>-R</b></p>
<p>Prefixes archive name and filename to each line of output.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>582</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-S</b></p>
<p>In 3âcolumn output mode,<b> -S</b> prints section names instead of one-letter codes.</p>
<p><b>-u</b></p>
<p>Prints undefined symbols only.</p>
<p><b>-v</b></p>
<p>Sorts output by symbol value.</p>
<p><b>-X</b></p>
<p>Does not print local compiler labels (</p>
<p>.L<i>n</i></p>
<p>).</p>
<p><b>-x</b></p>
<p>Prints value and size of symbols in hexadecimal.</p>
<p><b>BSD a.out File Options</b></p>
<p>The<b> gnm</b> options for BSD a.out format files are as follows:</p>
<p><b>-a</b></p>
<p>Prints all symbols, including debugging information. Not available with the<b> -s</b> option.</p>
<p><b>-g</b></p>
<p>Prints only external symbols.</p>
<p><b>-n</b></p>
<p>Sorts symbols by value.</p>
<p><b>-o</b></p>
<p>Prefixes lines with object or archive element name.</p>
<p><b>-p</b></p>
<p>Does not sort symbols.</p>
<p><b>-r</b></p>
<p>Sorts in reverse order.</p>
<p><b>-s</b></p>
<p>Sorts external symbols by size.</p>
<p><b>-u</b></p>
<p>Prints only undefined symbols.</p>
<p><i>583</i></p>
<p><i>Green Hills Software</i></p>
<p><i>BSD a.out File Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>COFF File Options</b></p>
<p><b>-a</b></p>
<p>Prints special symbols that are normally suppressed.</p>
<p><b>-A</b></p>
<p>Uses System V output format.</p>
<p><b>-E</b></p>
<p>Treats input files as Alpha ECOFF format.</p>
<p><b>-g</b></p>
<p>Prints only global symbols.</p>
<p><b>-h</b></p>
<p>Does not print headers.</p>
<p><b>-p</b></p>
<p>Uses 3-column output format.</p>
<p><b>-r</b></p>
<p>Prefixes filename to each line of output.</p>
<p><b>-s</b></p>
<p>Prints section names.</p>
<p><b>-t</b></p>
<p>Truncates standard call suffixes (Win32).</p>
<p><b>-T</b></p>
<p>Truncates names to 20 characters.</p>
<p><b>-u</b></p>
<p>Prints only undefined symbols.</p>
<p><b>Output Formats</b></p>
<p>By default,<b> gnm</b> produces output similar to the following excerpt (indices 3 through</p>
<p>11 are omitted for brevity):</p>
<p>[Index]</p>
<p>Value</p>
<p>Size</p>
<p>Type</p>
<p>Bind</p>
<p>Other Shndx</p>
<p>Name</p>
<p>[1]</p>
<p>|</p>
<p>0|</p>
<p>0|FILE |LOCL |0</p>
<p>|ABS</p>
<p>|hi.c</p>
<p>[2]</p>
<p>|</p>
<p>0|</p>
<p>0|SECT |LOCL |0</p>
<p>|.text</p>
<p>|.text</p>
<p>[12]</p>
<p>|</p>
<p>0|</p>
<p>52|FUNC |GLOB |0</p>
<p>|.text</p>
<p>|main</p>
<p>[13]</p>
<p>|</p>
<p>0|</p>
<p>0|NOTY |GLOB |0</p>
<p>|UNDEF</p>
<p>|printf</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>584</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Meaning</b></p>
<p><b>Column</b></p>
<p>Position of symbol in the symbol table.</p>
<p>Index</p>
<p>The value or address of the symbol.</p>
<p>Value</p>
<p>Size of the symbol (for example, a 4-byte integer symbol has a size of 4).</p>
<p>Size</p>
<p>One of the following:</p>
<p>â¢</p>
<p>NOTY</p>
<p>: Symbol without type.</p>
<p>â¢</p>
<p>FILE</p>
<p>: Filename symbol.</p>
<p>â¢</p>
<p>SECT</p>
<p>: Section name symbol.</p>
<p>â¢</p>
<p>OBJT</p>
<p>: Data symbol.</p>
<p>â¢</p>
<p>FUNC</p>
<p>: Code symbol.</p>
<p>Type</p>
<p>One of the following:</p>
<p>â¢</p>
<p>LOCL</p>
<p>: Local symbol (for example, C/C++ static).</p>
<p>â¢</p>
<p>GLOB</p>
<p>: Global symbol.</p>
<p>â¢</p>
<p>WEAK</p>
<p>: Weak global symbol (if undefined, the symbol's value resolves to zero).</p>
<p>Bind</p>
<p>Reserved field, generally zero.</p>
<p>Other</p>
<p>The name of the section where the symbol is defined. For example:</p>
<p>â¢</p>
<p>.text</p>
<p>: Code defined in the</p>
<p>.text</p>
<p>section.</p>
<p>â¢</p>
<p>.data</p>
<p>: Data defined in the</p>
<p>.data</p>
<p>section.</p>
<p>â¢</p>
<p>ABS</p>
<p>: No section (for example, a filename symbol).</p>
<p>â¢</p>
<p>COMMON</p>
<p>: Common variable whose section is not yet determined.</p>
<p>Shndx</p>
<p>Symbol name.</p>
<p>Name</p>
<p>The<b> -p</b> option enables an alternative, easily parsable, 3-column format, which</p>
<p>provides backward compatibility with tools that can read only this format:</p>
<p>0000000000 F hi.c</p>
<p>0000000000 S .text</p>
<p>0000000000 T main</p>
<p>0000000000 U printf</p>
<p>The first column is the value or address of the symbol. The second column is its</p>
<p>type (as shown in the following table), and the third is the symbol name. Note that</p>
<p>this format cannot fully describe all sections and storage classes.</p>
<p><i>585</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Output Formats</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Meaning</b></p>
<p><b>Type</b></p>
<p>External absolute</p>
<p>A</p>
<p>Local absolute</p>
<p>a</p>
<p>External zeroed data</p>
<p>B</p>
<p>Local zeroed data</p>
<p>b</p>
<p>Common variable (same as</p>
<p>B</p>
<p>except not yet assigned to a section)</p>
<p>C</p>
<p>External initialized data</p>
<p>D</p>
<p>Local initialized data</p>
<p>d</p>
<p>Filename</p>
<p>F</p>
<p>Local thread local-storage</p>
<p>I</p>
<p>External thread-local storage</p>
<p>L</p>
<p>Informational symbol</p>
<p>N</p>
<p>Section name</p>
<p>S</p>
<p>External text</p>
<p>T</p>
<p>Local text</p>
<p>t</p>
<p>External undefined</p>
<p>U</p>
<p><b>The gpatch Utility Program</b></p>
<p>The<b> gpatch</b> command line utility program allows you to install and create simple</p>
<p>patches. It is most commonly used to install a patch provided by Green Hills support</p>
<p>staff.</p>
<p>To install a patch into the current working directory, ensure the MULTI IDE or</p>
<p>Compiler installation directory is in your path and run:</p>
<p><b>gpatch</b> [-install_patch]<i> patch_filename</i></p>
<p>The following table describes command line options supported by<b> gpatch</b>.</p>
<p><b>-help</b></p>
<p>Displays documentation for all<b> gpatch</b> command line options.</p>
<p><b>-install_patch<i> patch_filename</b></i></p>
<p>Installs the patch</p>
<p><i>patch_filename</i></p>
<p>. By default, the patch is installed into the current working</p>
<p>directory, but you may also pass<b> -target_dir</b> (below) to specify another location.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>586</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-key<i> installation_key</b></i></p>
<p>Decrypts the patch using</p>
<p><i>installation_key</i></p>
<p>.</p>
<p><b>-list</b></p>
<p>Lists the files contained in the archive. This does not install the patch.</p>
<p><b>-nouninstall</b></p>
<p>Does not create an uninstallation archive.</p>
<p><b>-target_dir<i> directory</b></i></p>
<p>Specifies the directory where the patch will be installed. If you do not pass this option, the patch</p>
<p>is installed into your current working directory.</p>
<p>For a complete list of the command line options available for use with<b> gpatch</b>, run</p>
<p><b>gpatch -help</b>. Example uses of the<b> gpatch</b> utility program follow.</p>
<p>To list all files in<b> patch_1234.iff</b> without installing the patch:</p>
<p>&gt; gpatch -list -install_patch patch_1234.iff</p>
<p>To install patch<b> 2028.iff</b> into<b> C:\ghs\multi_<i>xxx</b></i>:</p>
<p>&gt; gpatch -install_patch 2028.iff -target_dir C:\ghs\multi_<i>xxx</i></p>
<p><i>587</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gpatch Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gpjmodify Utility Program</b></p>
<p>The<b> gpjmodify</b> utility program allows you to automate editing of project<b> .gpj</b> files.</p>
<p>General editing should be performed through the Project Manager (see the</p>
<p>documentation about the MULTI Project Manager in the<i> MULTI: Managing Projects</i></p>
<p><i>and Configuring the IDE</i> book), or via a text editor.</p>
<p><b>Note</b></p>
<p>You can edit only one file at a time using<b> gpjmodify</b>.</p>
<p><b>Editing Existing .gpj Files</b></p>
<p>The syntax for editing existing<b> .gpj</b> files is as follows:</p>
<p><b>gpjmodify<i></b> file</i>.gpj [[<i>sub</i>.gpjâ¦]|[@<i>path-to-sub</i>]] [<i>options</i>]<i> action</i></p>
<p>where:</p>
<p>â¢</p>
<p><i><b>file</i>.gpj</b> is a Top Project file. This is either the file to be edited or the ultimate</p>
<p>parent of<i><b> sub</i>.gpj</b>.</p>
<p>â¢</p>
<p>The optional<i><b> sub</i>.gpjâ¦</b> is an immediate child subproject of<i><b> file</i>.gpj</b> or a chain</p>
<p>of subprojects (the last of which will be edited). Alternately, you can specify</p>
<p><b>@path-to-sub.gpj</b>, an absolute path to a subproject at any point in the project</p>
<p>tree.</p>
<p>â¢</p>
<p><i>options</i> are listed in the following table:</p>
<p><b>-cfg=<i>configname</b></i></p>
<p>Specifies a configuration<i> configname</i>, where<i> configname</i> is the descriptive or short name</p>
<p>of a profile. Note that setting this option when modifying files or other options does not</p>
<p>cause the modifications to be configuration-specific.</p>
<p><b>-f</b></p>
<p>Forces the edit, even if errors would result.</p>
<p><b>-help</b></p>
<p>Displays help information.</p>
<p><b>-o<i> output</i>.gpj</b></p>
<p>Writes the edited file to<i><b> output</i>.gpj</b>. By default, edits are written to the existing file.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>588</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-quiet</b></p>
<p>Suppresses warning messages.</p>
<p><b>-toolsdir<i> directory</b></i></p>
<p>Specifies an alternative MULTI Compiler installation<i> directory</i>.</p>
<p>â¢</p>
<p><i>action</i> listed in the following table:</p>
<p><b>-add_after<i> child</i> [-filetype<i> type</i>]<i> files</i> [-sourcedir<i> dir_paths</i>]</b></p>
<p>Inserts<i> files</i> in the project's list of children, directly after<i> child</i>.</p>
<p><b>-add_before<i> child</i> [-filetype<i> type</i>]<i> files</i> [-sourcedir<i> dir_paths</i>]</b></p>
<p>Inserts<i> files</i> in the project's list of children, directly before<i> child</i>.</p>
<p><b>-add_customization_file<i> filename</b></i></p>
<p>Adds a customization file to the Top Project.</p>
<p><b>-add_to_back [-filetype<i> type</i>]<i> files</i> [-sourcedir<i> dir_paths</i>]</b></p>
<p>Inserts<i> files</i> at the end of the project's list of children.</p>
<p><b>-add_to_front [-filetype<i> type</i>]<i> files</i> [-sourcedir<i> dir_paths</i>]</b></p>
<p>Inserts<i> files</i> at the beginning of the project's list of children.</p>
<p><b>-change_macro<i> name</i>=<i>value</b></i></p>
<p>Changes the value of the existing macro<i> name</i> to<i> value</i>.</p>
<p><b>-make_tree_canonical</b></p>
<p>Canonicalizes filenames used in the project. This option applies to the entire project tree,</p>
<p>not just the specified project file.</p>
<p><b>-modify<i> old_option new_option</b></i></p>
<p>Replaces all instances of<i> old_option</i> in the specified project with<i> new_option</i>.</p>
<p><b>-remove<i> files</b></i></p>
<p>Deletes the specified<i> files</i> from the project's list of children.</p>
<p><b>-remove_customization_file<i></b> filename</i></p>
<p>Removes the specified customization file from the Top Project.</p>
<p><b>-replace_with<i> existing_child</i> [-filetype<i> type</i>]<i> new_child</b></i></p>
<p>Replaces the references to the file<i> existing_child</i> with references to<i> new_child</i>.</p>
<p><b>-set<i> options</b></i></p>
<p>Inserts a list of build<i> options</i>.</p>
<p><i>589</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Editing Existing .gpj Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-set_target<i></b> target_file</i></p>
<p>Specifies the project's target file. This is only saved if you are modifying a Top Project</p>
<p>file.</p>
<p><b>-unset<i> options</b></i></p>
<p>Deletes a list of build<i> options</i>.</p>
<p>Pass the<b> -filetype<i> type</b></i> parameter only if the files you are adding have non-standard</p>
<p>extensions that<b> gpjmodify</b> is unable to recognize. For a list of accepted values, see</p>
<p>âFile Typesâ on page 970. If<i> type</i> contains a space, you must enclose it in quotes.</p>
<p>The<b> -sourcedir<i> dir_paths</b></i> option specifies paths in which to search for the specified</p>
<p><i>files</i>.<b> gpjmodify</b> always uses the first file that it finds.</p>
<p>For any of the actions that require a list of<i> files</i> or<i> options</i>, each item in the list must</p>
<p>be separated with a space. If one of the items in the list contains a space, you must</p>
<p>enclose that item in quotes.</p>
<p><b>Creating a New .gpj File</b></p>
<p>The syntax for creating a new<b> .gpj</b> file is as follows:</p>
<p><b>gpjmodify<i></b> file</i>.gpj -create<i> type</i> -target<i> target_file</i> [<i>options</i>]</p>
<p>where<i><b> file</i>.gpj</b> is the name of the file to be created,<i> type</i> is the type of project file</p>
<p>to create (usually</p>
<p>Project</p>
<p>,</p>
<p>Subproject</p>
<p>,</p>
<p>Program</p>
<p>, or</p>
<p>Library</p>
<p>), and<i> target_file</i></p>
<p>specifies the project's target. Valid<i> options</i> are listed in the following table:</p>
<p><b>-quiet</b></p>
<p>Suppresses warning messages.</p>
<p><b>-toolsdir<i> directory</b></i></p>
<p>Specifies an alternative MULTI Compiler installation<i> directory</i>.</p>
<p><b>-top</b></p>
<p>Specifies that the new file will be a Top Project project file.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>590</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Generating a Makefile</b></p>
<p>Normally, if you need to build your project from the command line, you should use</p>
<p>the<b> gbuild</b> utility program, which provides a command line interface to build MULTI</p>
<p>projects (see âThe gbuild Utility Programâ on page 547). However, if you need to</p>
<p>integrate Green Hills tools with an existing makefile structure, the<b> gpjmodify</b> utility</p>
<p>can generate a rudimentary makefile from a project (<b>.gpj</b>) file. Use this makefile</p>
<p>as a guide when writing makefiles for your project.</p>
<p>To generate a makefile with<b> gpjmodify</b>, enter the following command:<b> gpjmodify</b></p>
<p><i>file</i>.gpj -generate_makefile [<i>options</i>]</p>
<p>where<i><b> file</i>.gpj</b> is the<b> .gpj</b> file to be converted, and valid<i> options</i> are listed in the</p>
<p>following table:</p>
<p><b>-quiet</b></p>
<p>Suppresses warning messages.</p>
<p><b>-toolsdir<i> directory</b></i></p>
<p>Specifies an alternative MULTI Compiler installation<i> directory</i>.</p>
<p><b>Tip</b></p>
<p>If you also need to know the commands<b> gbuild</b> executes when building</p>
<p>your project, enter the following command:</p>
<p>gbuild -info -commands<i> file</i>.gpj</p>
<p><i>591</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Generating a Makefile</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gsize Utility Program</b></p>
<p>The<b> gsize</b> utility program performs a similar function to the Linux/Solaris<b> size</b></p>
<p>program. It analyzes object files, object library files, or executable files and, for</p>
<p>each file, displays the size of each section in bytes. If more than one file is named,</p>
<p>or if an object library is named,<b> gsize</b> prints the name of the file with the section</p>
<p>name and totals for each section.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gsize</b> [<i>options</i>]<i> filename</i></p>
<p>where<i> filename</i> is the name of the input object file, object file library, or executable</p>
<p>file.</p>
<p>The<i> options</i> for<b> gsize</b> are as follows.</p>
<p><b>-all</b></p>
<p>Causes all sections to be displayed, including empty sections and non-allocated sections.</p>
<p><b>-commons</b></p>
<p>Displays a block of information describing each</p>
<p>COMMON</p>
<p>symbol in each output file (see âText</p>
<p>and Data Placementâ on page 82). This block is suppressed if you pass the<b> -table</b>,<b> -nodetails</b>,</p>
<p>or<b> -nobss</b> options. This option implies<b> -count_commons</b>.</p>
<p><b>-count_commons</b></p>
<p>Includes the size of common variables in the total size of</p>
<p>.bss</p>
<p>, the size of zero-common variables</p>
<p>in the total size of</p>
<p>.zbss</p>
<p>, and the size of small-common variables in the total size of</p>
<p>.sbss</p>
<p>.</p>
<p>This option has no effect if you pass the<b> -bss</b> option.</p>
<p><b>-details</b> â [default]</p>
<p><b>-nodetails</b></p>
<p>Displays or suppresses detailed information about each section in each file.</p>
<p><b>-help</b></p>
<p>Displays information about all options.</p>
<p><b>-nobss</b></p>
<p>Suppresses</p>
<p>bss</p>
<p>sections. This option makes<b> -commons</b> and<b> -count_commons</b> have no effect.</p>
<p><b>-nodata</b></p>
<p>Suppresses</p>
<p>data</p>
<p>sections.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>592</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-notext</b></p>
<p>Suppresses</p>
<p>text</p>
<p>sections.</p>
<p><b>-table</b></p>
<p>Displays output in table format. This option implies<b> -details</b> and<b> -nototals</b>.</p>
<p><b>-text</b></p>
<p>Only displays</p>
<p>text</p>
<p>sections, suppressing</p>
<p>data</p>
<p>and</p>
<p>bss</p>
<p>sections. This is the same as<b> -nodata</b></p>
<p>and<b> -nobss</b>.</p>
<p><b>-totals</b> â [default]</p>
<p><b>-nototals</b></p>
<p>Displays or suppresses the summary information. If you pass<b> -totals</b>, summary information is</p>
<p>output only if<b> gsize</b> is processing multiple files or common symbols.</p>
<p><b>-zero</b></p>
<p>Displays zero-length sections.</p>
<p><i>593</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gsize Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gsrec Utility Program</b></p>
<p>The<b> gsrec</b> utility program converts executable files or a multi-core archive into</p>
<p>Motorola S-Record, Intel hexadecimal, or Tektronix hexadecimal format. These</p>
<p>file formats contain ASCII representations of binary data. Many simulators,</p>
<p>In-Circuit Emulators (ICEs), PROM programmers, and debuggers use one of them</p>
<p>as a program download format. Use the</p>
<p>-hex</p>
<p>and</p>
<p>-srec</p>
<p>driver options to</p>
<p>automatically invoke</p>
<p>gsrec</p>
<p>and generate a Intel hexadecimal or S-Record file after</p>
<p>linking a program. For more information about these driver options, see âGenerate</p>
<p>Additional Outputâ on page 236.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gsrec</b> [<i>options</i>]<i> filenames</i></p>
<p>where<i> filename</i> is the name of an input executable file or multi-core archive to be</p>
<p>converted to one of the output formats. Motorola S-Records is the default output</p>
<p>format.</p>
<p>The<b> gsrec<i></b> options</i> are:</p>
<p><b>-allow_overlap</b></p>
<p>Allows sections to overlap. By default with more than one executable file or a multi-core archive</p>
<p>a fatal error will be given if any non-empty sections overlap.</p>
<p><b>-allow_relocated_sections</b></p>
<p>Allows sections with a non-empty matching .</p>
<p>rel</p>
<p>or .</p>
<p>rela</p>
<p>section to be converted to hex.</p>
<p><b>-auto</b></p>
<p>Determines byte order from the file header. This is the default.</p>
<p><b>-B</b></p>
<p><b>-L</b></p>
<p>Specifies a big or little endian input file.</p>
<p><b>-bytes<i> n</b></i></p>
<p>Sets the maximum count of data bytes per record (minimum 4). For S-Record output, the</p>
<p>maximum and default are 28. For Intel hexadecimal output, the maximum and default are 32.</p>
<p><b>-e<i> addr</b></i></p>
<p>Sets entry point in the termination record to given address.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>594</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-end<i> address</b></i></p>
<p>Specifies the highest<i> address</i> of data to be output.</p>
<p><b>-eol<i> char-seq</b></i></p>
<p>Specifies the character sequence used to terminate each S-Record, where<i> char-seq</i> is one of:</p>
<p>â¢</p>
<p>cr</p>
<p>: a</p>
<p>\r</p>
<p>character.</p>
<p>â¢</p>
<p>crlf</p>
<p>: a</p>
<p>\r\n</p>
<p>combination. This is the default in Windows.</p>
<p>â¢</p>
<p>lf</p>
<p>: a</p>
<p>\n</p>
<p>character. This is the default in Linux/Solaris.</p>
<p><b>-fill<i>x n1 n2 v</b></i></p>
<p>Fills memory from address<i> n1</i> to address<i> n2</i> with the<i> x</i>-byte value<i> v</i> (where<i> x</i> is 1, 2, or 4). This</p>
<p>option is not supported with multiple input files or a multi-core archive.</p>
<p><b>-help</b></p>
<p>Displays information about all options.</p>
<p><b>-hex86</b></p>
<p><b>-hex386</b></p>
<p><b>-tekhex</b></p>
<p>Specifies output of Intel HEX86, HEX386, or extended Tektronix hexadecimal format.</p>
<p>The Intel HEX86 hexadecimal format can handle memory addresses only in the range of</p>
<p>0x00000000</p>
<p>to</p>
<p>0x0010ffef</p>
<p>. When this address range is exceeded,<b> gsrec</b> displays the message:</p>
<p>an address is too big</p>
<p>.</p>
<p>The Intel HEX386 format supports the full 32-bit address space. A linear address record</p>
<p>containing the upper 16-bits of the address was added to the HEX86 format to form the HEX386</p>
<p>format.</p>
<p>The Tektronix extended tekhex format supports the full 32-bit address space. The<b> -tekhex</b> option</p>
<p>is deprecated and may be removed in future versions of<b> MULTI</b>.</p>
<p><b>-interval<i> n</i>[:<i>m</i>]</b></p>
<p>Places only those data bytes from the input file that occur within the specified interval in the</p>
<p>output file. Values for<i> n</i> are 1 through 8. The default is 1, indicating that every byte will be</p>
<p>output. The<i> m</i> value specifies the number of output bytes for each interval. For example,</p>
<p>4:2</p>
<p>outputs 2 consecutive bytes out of every 4.</p>
<p>This option requires that you set the<b> -start</b> and<b> -romaddr</b> options.</p>
<p><b>-name<i> string</b></i></p>
<p>Uses the first 10 characters of<i> string</i> as the module name in the</p>
<p>S0</p>
<p>initial record.</p>
<p><b>-noS0</b></p>
<p>Suppresses production of an</p>
<p>S0</p>
<p>initial record.</p>
<p><i>595</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gsrec Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-noS5</b></p>
<p>Suppresses production of an</p>
<p>S5</p>
<p>block count record.</p>
<p><b>-noSLA</b></p>
<p>Do not output the Start Linear Address Record in HEX386 mode. Instead, the start address is</p>
<p>placed in the end record.</p>
<p><b>-o<i> filename</b></i></p>
<p>Specifies the output filename. By default, output is sent to standard output.</p>
<p><b>-pad<i>x n1 n2 v</b></i></p>
<p>Pads<i> x</i>-byte holes between hexadecimal data records from address<i> n1</i> to<i> n2</i> with value<i> v</i>.<i> x</i> may</p>
<p>be</p>
<p>1</p>
<p>,</p>
<p>2</p>
<p>, or</p>
<p>4</p>
<p>. This option is not supported with multiple input files or a multi-core archive.</p>
<p><b>-page_boundary</b></p>
<p><b>-no_page_boundary</b></p>
<p><b>-page_boundary</b> ensures that no record crosses a 64 kbyte boundary, and only applies to<b> -hex86</b></p>
<p>or<b> -hex386</b>. The default behavior is<b> -no_page_boundary</b>.</p>
<p><b>-prefixed_msgs</b></p>
<p><b>-no_prefixed_msgs</b></p>
<p>Enables or disables the printing of</p>
<p>WARNING</p>
<p>and</p>
<p>ERROR</p>
<p>before messages.</p>
<p><b>-raw</b></p>
<p>Treats input files as raw data to be placed at the address specified by<b> -romaddr</b>. This option is</p>
<p>not supported with a multi-core archive.</p>
<p><b>-romaddr<i> addr</b></i></p>
<p>Sets start address in ROM to place data. The default is the same address as in the input file.</p>
<p><b>-S<i>type</b></i></p>
<p>Specifies the type of S-Record to be produced, where<i> type</i> is one of the following:</p>
<p>â¢</p>
<p>1</p>
<p>:</p>
<p>S1</p>
<p>data records (16-bit addresses)</p>
<p>â¢</p>
<p>2</p>
<p>:</p>
<p>S2</p>
<p>data records (24-bit addresses)</p>
<p>â¢</p>
<p>3</p>
<p>(default):</p>
<p>S3</p>
<p>data records (32-bit addresses)</p>
<p>â¢</p>
<p>5</p>
<p>: an</p>
<p>S5</p>
<p>record with a count of data records (32-bit count)</p>
<p>â¢</p>
<p>5old</p>
<p>: an old format</p>
<p>S5</p>
<p>record (16-bit count)</p>
<p>â¢</p>
<p>7</p>
<p>: an</p>
<p>S7</p>
<p>end record (32-bit entry point)</p>
<p>â¢</p>
<p>8</p>
<p>: an</p>
<p>S8</p>
<p>end record (24-bit entry point)</p>
<p>â¢</p>
<p>9</p>
<p>: an</p>
<p>S9</p>
<p>end record (16-bit entry point)</p>
<p>The default is to produce</p>
<p>S3</p>
<p>data records, an</p>
<p>S5</p>
<p>record, and an</p>
<p>S7</p>
<p>end record.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>596</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-skip<i> s</b></i></p>
<p>Does not output data for section<i> s</i>.</p>
<p><b>-skip_unknown_file</b></p>
<p>Silently ignores files which are neither ELF nor COFF.</p>
<p><b>-sort</b></p>
<p>Sorts output records in ascending order. If multiple executable files or an archive containing</p>
<p>multiple files is given, records will only be sorted within each file. If input files contain</p>
<p>overlapping addresses, records will be output for both input files.</p>
<p><b>-start<i> address</b></i></p>
<p>Specifies the lowest<i> address</i> of data to be output.</p>
<p><b>-w</b></p>
<p>Does not issue a warning when the input is a relocatable COFF object file.</p>
<p><b>-warn_overlap</b></p>
<p>Issues warnings for input sections that overlap.</p>
<p><b>S-Record Output Format</b></p>
<p>An S-Record file contains ASCII text that can be displayed or edited. There are</p>
<p>eight types of S-Records, numbered</p>
<p>S0</p>
<p>to</p>
<p>S9</p>
<p>, including the following:</p>
<p>â¢</p>
<p>An</p>
<p>S0</p>
<p>header record that identifies the program.</p>
<p>â¢</p>
<p>Data records that represent the binary data in the program.</p>
<p>â¢</p>
<p>An</p>
<p>S5</p>
<p>data count record that contains the count of data records in the S-Record</p>
<p>file.</p>
<p>â¢</p>
<p>A termination record that contains the address to begin program execution.</p>
<p>Not all S-Record reader programs behave the same way. Some programs require</p>
<p>certain types of data records. Some target environments do not accept</p>
<p>S5</p>
<p>data count</p>
<p>records, and some require certain types of termination records. The<b> gsrec</b> utility</p>
<p>provides options that handle many of these cases.</p>
<p>Every S-Record begins with the letter S followed by a digit (0 through 9)</p>
<p>representing the format of the line. The next two characters are a hexadecimal</p>
<p>representation of the number of bytes in the remainder of the line, which always</p>
<p>consists of the fields referred to as address, data, and checksum. The address field</p>
<p><i>597</i></p>
<p><i>Green Hills Software</i></p>
<p><i>S-Record Output Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p>may contain 2, 3, or 4 bytes depending on the format. The length of the data field</p>
<p>varies. The checksum field always contains 1 byte.</p>
<p>For example, the following</p>
<p>S3</p>
<p>record has a length of 33 (</p>
<p>0x21</p>
<p>) bytes.</p>
<p>S3 21 00000000 00E280FF04001FE80848074006384036000006360000B20580FF0000 B5</p>
<p>The 4-byte address is</p>
<p>00000000</p>
<p>, the data field contains 28 bytes, and the checksum</p>
<p>is one byte.</p>
<p><b>Data and Termination Records</b></p>
<p>A data record contains the address where data is loaded, followed by the data itself.</p>
<p>The three types of data records,</p>
<p>S1</p>
<p>,</p>
<p>S2</p>
<p>, and</p>
<p>S3</p>
<p>, differ in load address size, as</p>
<p>indicated in the previous table.</p>
<p>By default, an</p>
<p>S5</p>
<p>data count record is emitted. If your S-Record loader does not</p>
<p>handle</p>
<p>S5</p>
<p>records, use the option<b> -noS5</b> to avoid outputting an</p>
<p>S5</p>
<p>data count record.</p>
<p>By default, the</p>
<p>S5</p>
<p>data record contains a 4-byte address. Some old S-Record readers</p>
<p>expect an</p>
<p>S5</p>
<p>record to contain a 2-byte address. In this case, use the<b> -S5old</b> option.</p>
<p>A termination record contains the entry point (the address where program execution</p>
<p>begins). There are three types of termination records,</p>
<p>S7</p>
<p>,</p>
<p>S8</p>
<p>, and</p>
<p>S9</p>
<p>, as indicated</p>
<p>in the previous table.</p>
<p>Some S-Record readers accept data records up to a specified length. Use the option</p>
<p><b>-bytes<i> size</b></i> to set the maximum data record length.</p>
<p>If you forget to specify the entry point address when linking, you can use<b> -e<i></b> address</i></p>
<p>to set the entry point to the given<i> address</i>.</p>
<p><b>Data Splitting</b></p>
<p>In some hardware implementations, the width of the bus differs from the width of</p>
<p>the PROMs. Depending on how the bus and PROM's are connected, it might be</p>
<p>necessary to store even bytes in one PROM and odd bytes in another PROM.<i> Data</i></p>
<p><i>splitting</i> is a technique of dividing the data into even and odd bytes, or in other</p>
<p>ways.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>598</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>gsrec</b> can perform data splitting. The<b> -start</b> option specifies the starting address of</p>
<p>the data in the object input file to output to the S-Record output file. The<b> -end</b> option</p>
<p>specifies the last address of data in the object input file to output. The<b> -interval</b></p>
<p>option specifies the distance between bytes in the input file to output. A value of 2</p>
<p>for<b> -interval</b> outputs every other byte. Sometimes it is necessary to relocate the</p>
<p>data to address zero in the S-Record output file for programming PROMs. The</p>
<p><b>-romaddr</b> option specifies the start address of the data bytes in the S-Record output</p>
<p>file. The last two succeeding examples separate even and odd bytes into two different</p>
<p>S-Record files.</p>
<p>The following examples use a program file<b> prog1</b> that contains the following</p>
<p>sections:</p>
<p>1: .text,</p>
<p>address: 0x1000, size: 0x100</p>
<p>2: .data,</p>
<p>address: 0x2000, size: 0x200</p>
<p>3: .bss,</p>
<p>address: 0x3000, size: 0x200 (No Load Section)</p>
<p>4: .data2,</p>
<p>address: 0x4000, size: 0x200</p>
<p><b>gsrec Examples</b></p>
<p><b>Example 11.25. Using gsrec</b></p>
<p>gsrec prog1</p>
<p>The<b> gsrec</b> program reads the data in the input file<b> prog1</b> and writes the S-Records</p>
<p>to the standard output. Because the contents of section<b> .bss</b> are not loaded, no</p>
<p>S-Records are output for its data.</p>
<p><b>Example 11.26. Using the -Stype Options</b></p>
<p>gsrec -S1 -S9 prog1 -o</p>
<p>prog1.run</p>
<p>The<b> gsrec</b> program reads the data in the input file<b> prog1</b> and writes the S-Records</p>
<p>to the specified output file<b> prog1.run</b>. Data are output as</p>
<p>S1</p>
<p>records that have a</p>
<p>16-bit address space. The start address is output as an</p>
<p>S9</p>
<p>record that has a 16-bit</p>
<p>address space.</p>
<p><b>Example 11.27. Using the -start, -end, and -o Options</b></p>
<p>gsrec -start 0x1000 -end 0x1080 prog1 -o prog1.run</p>
<p><i>599</i></p>
<p><i>Green Hills Software</i></p>
<p><i>gsrec Examples</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The<b> gsrec</b> program reads the data in the input file<b> prog1</b> starting at address</p>
<p>0x1000</p>
<p>and ending at address</p>
<p>0x1080</p>
<p>and writes the resulting S-Records to the output file</p>
<p><b>prog1.run</b>.</p>
<p><b>Example 11.28. Using the -romaddr Option</b></p>
<p>gsrec -start 0x1000 -end 0x1080 -romaddr 0 prog1 -o prog1.run</p>
<p>The<b> gsrec</b> program reads the data in the input file<b> prog1</b> starting at address</p>
<p>0x1000</p>
<p>and ending at address</p>
<p>0x1080</p>
<p>, relocates the data to start at address zero, and writes</p>
<p>the resulting S-Records to the output file<b> prog1.run</b>.</p>
<p><b>Example 11.29. Using the -interval Option for Even Data Bytes</b></p>
<p>gsrec -start 0x1000 -end 0x1080 -romaddr 0 -interval 2 prog1</p>
<p>The<b> gsrec</b> program reads the data bytes at even addresses in the input file<b> prog1</b></p>
<p>starting at address</p>
<p>0x1000</p>
<p>and ending at address</p>
<p>0x1080</p>
<p>, relocates the data to start</p>
<p>at address zero, and writes the resulting S-Records to the standard output.</p>
<p><b>Example 11.30. Using the -interval Option for Odd Data Bytes</b></p>
<p>gsrec -start 0x1001 -end 0x107F -romaddr 0 -interval 2 prog1</p>
<p>The<b> gsrec</b> program reads the data bytes at odd addresses in the input file<b> prog1</b></p>
<p>starting at address</p>
<p>0x1001</p>
<p>and ending at address</p>
<p>0x107F</p>
<p>, relocates the data to start</p>
<p>at address zero, and writes the resulting S-Records to the standard output.</p>
<p><b>Example 11.31. Using the -interval Option for 2 Out of Every 4 Data Bytes</b></p>
<p>gsrec -start 0x1002 -end 0x107F -romaddr 0 -interval 4:2 prog1</p>
<p>The<b> gsrec</b> program reads 2 out of every 4 data bytes in the input file<b> prog1</b> starting</p>
<p>at address</p>
<p>0x1002</p>
<p>and ending at address</p>
<p>0x107F</p>
<p>, relocates the data to start at</p>
<p>address zero, and writes the resulting S-Records to the standard output.</p>
<p><b>The gstack Utility Program</b></p>
<p>The<b> gstack</b> utility program analyzes a program to report the maximum stack size</p>
<p>each task might need during execution and the call chain that produces it. Bugs</p>
<p>caused by exceeding the available stack can be very difficult to track down, and</p>
<p>they are often responsible for intermittent crashes, errant behaviors, and security</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>600</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>leaks. By using<b> gstack</b> on a regular basis, you can be sure that your program will</p>
<p>never exceed the available stack.</p>
<p>The syntax for the<b> gstack</b> utility is:</p>
<p><b>gstack</b> [<i>options</i>]<i> program</i></p>
<p>For a list of options, see âgstack Optionsâ on page 615.</p>
<p><b>Note</b></p>
<p>GNU also has a utility named<b> gstack</b>. When invoking<b> gstack</b>, make sure</p>
<p>to check that you are using the program in your Green Hills installation.</p>
<p><b>Preparing Your Program for gstack Analysis</b></p>
<p>The Green Hills toolchain produces debugging information that allows<b> gstack</b> to</p>
<p>analyze the call graph of a program and determine the maximum amount of stack</p>
<p>it needs. While this information should be sufficient for most code,<b> gstack</b> may</p>
<p>require you to provide additional information in order to produce correct results.</p>
<p>There are also ways to modify your code to make it easier for<b> gstack</b> to analyze,</p>
<p>particularly when it uses function pointers or recursion.</p>
<p>To prepare your program for use with<b> gstack</b>:</p>
<p>1.</p>
<p>Make sure all files in your project are built with the debug level set to anything</p>
<p>other than<b> --no_debug</b> (see âDebugging Levelâ on page 176).</p>
<p>2.</p>
<p>Determine the program entry points that you want to analyze. Run<b> gstack</b> on</p>
<p>your program, passing the entry point functions as arguments, and examine</p>
<p>the report that it generates. For example:</p>
<p>&gt; gstack -entry_point main a.out</p>
<p>For each function that you specify as an entry point,<b> gstack</b> reports the</p>
<p>maximum amount of stack that can be used by a call chain starting with that</p>
<p>function. Stack used by a program before the entry point is not included.</p>
<p>3.</p>
<p>If the<b> gstack</b> report contains a</p>
<p>Missing Information</p>
<p>section, you need to</p>
<p>specify additional information to<b> gstack</b>. Address each of the following types</p>
<p>of missing information in the list as follows:</p>
<p><i>601</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Preparing Your Program for gstack Analysis</i></p>
<h1 style="page-break-before:always; "></h1>
<p>MC</p>
<p>(missing call) â An assembly function for which no call information</p>
<p>has been provided. See âAnnotating Assembly Functions for gstackâ</p>
<p>on page 602.</p>
<p>â¢</p>
<p>â¢</p>
<p>MS</p>
<p>(missing stack) â An assembly function for which no stack information</p>
<p>has been provided. See âAnnotating Assembly Functions for gstackâ</p>
<p>on page 602.</p>
<p>â¢</p>
<p>IC</p>
<p>(incomplete call) â A C function that requires additional call</p>
<p>information. See âAnnotating C Functions for gstackâ on page 603.</p>
<p>â¢</p>
<p>IS</p>
<p>(incomplete stack) â A C function that requires additional stack</p>
<p>information. See âAnnotating C Functions for gstackâ on page 603.</p>
<p>At this time, ignore items specified as</p>
<p>MI</p>
<p>(maximum instances); they will be</p>
<p>addressed in step 5.</p>
<p>4.</p>
<p>Break up recursive clusters wherever possible. See âWorking With Recursive</p>
<p>Clustersâ on page 605.</p>
<p>5.</p>
<p>At this point, the remaining items in the</p>
<p>Missing Information</p>
<p>section</p>
<p>should be marked only with</p>
<p>MI</p>
<p>(maximum instances). These are functions that</p>
<p><b>gstack</b> has determined may appear more than once in a given call stack, but</p>
<p>for which an upper bound on the number of times they may appear has not</p>
<p>been specified and cannot be computed. To address these items, see âAnnotating</p>
<p>Recursive Functionsâ on page 610.</p>
<p>6.</p>
<p>If your program uses interrupts or similar features where the program's</p>
<p>execution may be interrupted and continued from some other function using</p>
<p>the same stack, this information must be provided with the appropriate</p>
<p>command line options. See âSpecifying Interruptsâ on page 612.</p>
<p>7.</p>
<p>Use the<b> -stack_limit</b> option to specify an upper bound on the stack usage (in</p>
<p>bytes) for each specified entry point.<b> gstack</b> issues an error if it determines</p>
<p>that the stack limit for any entry point can be exceeded during the program's</p>
<p>execution.</p>
<p><b>Annotating Assembly Functions for gstack</b></p>
<p>When a function is defined in assembly, either in an assembly source file or within</p>
<p>a</p>
<p>pragma asm</p>
<p>block in a C file, you must provide<b> gstack</b> with information about</p>
<p>the stack usage of the function and any calls it makes. If<b> gstack</b> detects an assembly</p>
<p>function for which this information is missing, it lists the function in the</p>
<p>Missing</p>
<p>Information</p>
<p>section of its report with</p>
<p>MC</p>
<p>(missing call) and/or</p>
<p>MS</p>
<p>(missing stack).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>602</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If the function is defined in an assembly file, you must provide the missing</p>
<p>information with assembler directives that immediately follow the definition of the</p>
<p>function. If the function is defined in a C file, you must declare the function outside</p>
<p>the</p>
<p>pragma asm</p>
<p>block, and provide the missing information with pragma directives</p>
<p>immediately before the declaration.<b> gstack</b>-specific assembler directives in C source</p>
<p>files are ignored.</p>
<p>To specify call information for an assembly function, use one of the following for</p>
<p>each distinct function that the assembly function calls:</p>
<p>â¢</p>
<p>Assembly file â</p>
<p>.scall<i> func</i>,<i> callee</i></p>
<p>â¢</p>
<p>C file â</p>
<p>#pragma ghs stactic_call<i> callee</i></p>
<p>â¢</p>
<p>Command line â<b> -a<i> func</i>:<i>callee1</i>,<i>callee2</i>,...</b></p>
<p>If the function does not make any calls, use:</p>
<p>â¢</p>
<p>Assembly file â</p>
<p>.scall<i> func</i>, __leaf__</p>
<p>â¢</p>
<p>C file â</p>
<p>#pragma ghs static_call 0</p>
<p>â¢</p>
<p>Command line â<b> -a<i> func</i>:__leaf__</b></p>
<p>To specify stack information for an assembly function, use one of the following:</p>
<p>â¢</p>
<p>Assembly file â</p>
<p>.maxstack<i> func</i>,<i> size</i></p>
<p>â¢</p>
<p>C file â</p>
<p>#pragma ghs max_stack (<i>size</i>)</p>
<p>â¢</p>
<p>Command line â<b> -f<i> func</i>=<i>size</b></i></p>
<p>where<i> size</i> is the maximum amount of stack that is allocated by the function at any</p>
<p>point during its execution. The</p>
<p>.maxstack</p>
<p>directive is ignored unless at least one</p>
<p>.scall</p>
<p>directive is specified for the same function.</p>
<p><b>Annotating C Functions for gstack</b></p>
<p>There are certain constructs for which information needed by<b> gstack</b> is not statically</p>
<p>computed. For example,<b> gstack</b> is unaware of:</p>
<p>â¢</p>
<p>function calls within</p>
<p>asm</p>
<p>statements</p>
<p>â¢</p>
<p>stack usage of</p>
<p>asm</p>
<p>statements</p>
<p><i>603</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Annotating C Functions for gstack</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>stack usage of variable length arrays (VLAs)</p>
<p>â¢</p>
<p>stack usage of calls to</p>
<p>alloca()</p>
<p>If it detects any of these constructs within a C function, it lists the function in the</p>
<p>Missing Information</p>
<p>section of its report with</p>
<p>IC</p>
<p>(incomplete call) and/or</p>
<p>IS</p>
<p>(incomplete stack).</p>
<p>When using pragma directives to provide this information to<b> gstack</b>, specify the</p>
<p>directive immediately before the start of the function.</p>
<p>To specify call information for a C function, use one of the following:</p>
<p>â¢</p>
<p>C file â</p>
<p>#pragma ghs static_call<i> callee</i></p>
<p>â¢</p>
<p>Command line â<b> -a<i> func</i>:<i>callee1</i>,<i>callee2</i>,...</b></p>
<p>If no calls are made from within the function's</p>
<p>asm</p>
<p>statements, use:</p>
<p>â¢</p>
<p>C file â</p>
<p>#pragma ghs static_call 0</p>
<p>â¢</p>
<p>Command line â<b> -a<i> func</i>:__leaf__</b></p>
<p>To specify stack information, use one of the following:</p>
<p>â¢</p>
<p>C file â</p>
<p>#pragma ghs extra_stack (<i>size</i>)</p>
<p>â¢</p>
<p>Command line â<b> -x<i> func</i>=<i>size</b></i></p>
<p>where<i> size</i> is a C constant that represents the total additional stack usage required</p>
<p>by the</p>
<p>asm</p>
<p>statements, VLAs, and</p>
<p>alloca()</p>
<p>calls used within the function.</p>
<p>If a function for which you have provided all necessary information inlines a callee</p>
<p>for which you have not provided enough call or stack information,<b> gstack</b> may list</p>
<p>the function as missing call or stack information. We recommend that you make</p>
<p>sure the necessary information is provided for all of a function's callees before</p>
<p>providing the information for the function itself.</p>
<p><b>Warning</b></p>
<p><b>gstack</b> results are undefined if the stack pointer is different upon entry</p>
<p>and exit from an</p>
<p>asm</p>
<p>statement.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>604</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Working With Recursive Clusters</b></p>
<p>When<b> gstack</b> analyzes your program, it computes the program's<i> recursive clusters</i>,</p>
<p>sets of functions for which any function can reach any other function in the set,</p>
<p>either through a direct call or series of calls.</p>
<p>When computing the program's maximum stack usage,<b> gstack</b> assumes that a call</p>
<p>chain containing any function that belongs to a recursive cluster will incur the total</p>
<p>possible stack usage of that cluster. That value is computed by multiplying the</p>
<p>individual stack usage of each of the cluster's functions by the function's maximum</p>
<p>instances value (the maximum number of times it can appear in a single call stack)</p>
<p>and summing the result over all of the functions that make up the cluster.</p>
<p>This approach ensures that<b> gstack</b> always computes a correct upper bound for the</p>
<p>cluster's stack usage, but it also means that the value will often be very conservative,</p>
<p>particularly for large or complex clusters. We strongly recommend that you modify</p>
<p>your code to eliminate or simplify recursive clusters as much as possible to get the</p>
<p>best results.</p>
<p>To eliminate and simplify clusters:</p>
<p>1.</p>
<p>Use strong function pointer types to remove spurious recursions that appear</p>
<p>in the call graph due to the ambiguity of function pointers (see âUsing Strong</p>
<p>Function Pointersâ on page 606).</p>
<p>2.</p>
<p>Identify and remove recursions that cannot occur at run time. For example,</p>
<p>you should remove the call from</p>
<p>funcTwo()</p>
<p>to</p>
<p>funcOne()</p>
<p>below:</p>
<p>int funcOne(int x);</p>
<p>int funcTwo(int x){</p>
<p>if(x &gt; 0)</p>
<p>// This condition cannot be met</p>
<p>return funcOne(x); // so funcOne() never gets called</p>
<p>else</p>
<p>return 0;</p>
<p>}</p>
<p>int funcOne(int x){</p>
<p>x--;</p>
<p>return funcTwo(x);</p>
<p>}</p>
<p>int main(void){</p>
<p>int x = funcOne(0);</p>
<p>return x;</p>
<p>}</p>
<p><i>605</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Working With Recursive Clusters</i></p>
<h1 style="page-break-before:always; "></h1>
<p>3.</p>
<p>Re-factor code to separate distinct recursive cycles into smaller clusters (see</p>
<p>âRe-Factoring Code to Simplify Recursive Clustersâ on page 609).</p>
<p>In addition to improving the quality of<b> gstack</b> results, breaking up recursive clusters</p>
<p>makes it easier to determine accurate maximum instances values in cases where it</p>
<p>would otherwise be difficult or impossible to do so. Providing accurate maximum</p>
<p>instances information is a necessary step in preparing programs that use recursion</p>
<p>for<b> gstack</b> (see âAnnotating Recursive Functionsâ on page 610).</p>
<p><b>Using Strong Function Pointers</b></p>
<p>Calls made through</p>
<p>unknown</p>
<p>function pointers â pointers that do not have strong</p>
<p>function pointer types â are represented in the call graph using references to a special</p>
<p>&lt;&lt;address_taken&gt;&gt;</p>
<p>node. This node has its own outgoing references that point</p>
<p>to any function whose address is ever taken (except if it is only taken to assign it</p>
<p>to a strong function pointer).</p>
<p>This allows<b> gstack</b> to correctly compute the maximum stack usage for programs</p>
<p>that use function pointers, since there is a path in the call graph from each caller to</p>
<p>any function that may be reached by its calls. However, since many of these paths</p>
<p>reflect calls that cannot actually happen, use of unknown function pointers can cause</p>
<p><b>gstack</b> results to be very conservative and its call graph to contain spurious or overly</p>
<p>complex recursive clusters. For example:</p>
<p>int funcTwo(void)</p>
<p>{</p>
<p>return 0;</p>
<p>}</p>
<p>int (*fptrTwo)(void) = funcTwo;</p>
<p>int funcOne(void)</p>
<p>{</p>
<p>return fptrTwo();</p>
<p>}</p>
<p>int (*fptrOne)(void) = funcOne;</p>
<p>int main()</p>
<p>{</p>
<p>int x = fptrOne();</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>606</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>return x;</p>
<p>}</p>
<p>Both</p>
<p>main()</p>
<p>and</p>
<p>funcOne()</p>
<p>call through unknown function pointers, so they</p>
<p>each have a reference to the</p>
<p>&lt;&lt;address_taken&gt;&gt;</p>
<p>node. Because both</p>
<p>funcOne()</p>
<p>and</p>
<p>funcTwo()</p>
<p>have their addresses assigned to unknown function pointers, the</p>
<p>&lt;&lt;address_taken&gt;&gt;</p>
<p>node has its own references that point to them:</p>
<p>main</p>
<p>. &lt;&lt;address_taken&gt;&gt;</p>
<p>. . funcTwo</p>
<p>. . funcOne</p>
<p>. . . &lt;&lt;address_taken&gt;&gt;</p>
<p>[RPT]</p>
<p>This call graph allows<b> gstack</b> to correctly compute an upper bound on the stack</p>
<p>usage of the program, because it contains paths from</p>
<p>main()</p>
<p>to</p>
<p>funcOne()</p>
<p>and</p>
<p>from</p>
<p>funcOne()</p>
<p>to</p>
<p>funcTwo()</p>
<p>. However, it also contains a path from</p>
<p>funcOne()</p>
<p>to itself, which could cause the computed stack usage to be conservative, and which</p>
<p>results in the following erroneous recursive cluster:</p>
<p>&lt;&lt;address_taken&gt;&gt;</p>
<p>. funcOne</p>
<p>. . &lt;&lt;address_taken&gt;&gt;</p>
<p>[RPT]</p>
<p>You can address this problem by using strong function pointer types, which are</p>
<p>created by the</p>
<p>strong_fptr</p>
<p>attribute and provide a means of tracking the possible</p>
<p>destinations of distinct function pointer calls separately from one another (for</p>
<p>detailed information about this attribute, see</p>
<p>strong_fptr</p>
<p>on page 725).</p>
<p>When a function makes a call through a strong function pointer, the call graph</p>
<p>contains a reference from the function to a node that represents the strong function</p>
<p>pointer type. That node has its own outgoing references that point to any function</p>
<p>whose address is assigned to a pointer of that type. The previous example can be</p>
<p>updated to use strong function pointer types as follows:</p>
<p>typedef __attribute__((strong_fptr)) int (*FPTR_ONE)(void);</p>
<p>typedef __attribute__((strong_fptr)) int (*FPTR_TWO)(void);</p>
<p>int funcTwo(void)</p>
<p>{</p>
<p>return 0;</p>
<p>}</p>
<p><i>607</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Working With Recursive Clusters</i></p>
<h1 style="page-break-before:always; "></h1>
<p>FPTR_TWO fptrTwo = funcTwo;</p>
<p>int funcOne(void)</p>
<p>{</p>
<p>return fptrTwo();</p>
<p>}</p>
<p>FPTR_ONE fptrOne = funcOne;</p>
<p>int main()</p>
<p>{</p>
<p>int x = fptrOne();</p>
<p>return x;</p>
<p>}</p>
<p><b>gstack</b> now reports the call graph as follows:</p>
<p>main</p>
<p>. (FPTR_ONE *)</p>
<p>. . funcOne</p>
<p>. . . (FPTR_TWO *)</p>
<p>. . . . funcTwo</p>
<p>The graph still contains the paths necessary to correctly compute the stack usage,</p>
<p>but the path from</p>
<p>funcOne()</p>
<p>to itself and the corresponding recursive cluster are</p>
<p>eliminated.</p>
<p>Replacing unknown function pointers with strong function pointers is an important</p>
<p>and powerful means of improving the accuracy of<b> gstack</b> results for your program.</p>
<p>However, when updating your code you should take care to use separate strong</p>
<p>function pointer types wherever possible, since sharing the same type between</p>
<p>multiple pointers can result in the exact same problems associated with unknown</p>
<p>function pointers. Note that if the previous change had used the same strong type,</p>
<p>FPTR_ONE</p>
<p>, for both pointers, the resulting call graph looks similar, but there is an</p>
<p>FPTR_ONE</p>
<p>node in place of the</p>
<p>&lt;&lt;address_taken&gt;&gt;</p>
<p>node:</p>
<p>main</p>
<p>. (FPTR_ONE *)</p>
<p>. . funcTwo</p>
<p>. . funcOne</p>
<p>. . . (FPTR_ONE *)</p>
<p>[RPT]</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>608</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The graph also contains the recursive cluster:</p>
<p>(FPTR_ONE *)</p>
<p>. funcOne</p>
<p>. . (FPTR_ONE *)</p>
<p>[RPT]</p>
<p>By default, if<b> gstack</b> detects a call through an unknown function pointer, it lists the</p>
<p>name of the function that makes the call in a section of its report titled</p>
<p>Problems</p>
<p>During Execution</p>
<p>(see âThe Problems During Execution Report Sectionâ</p>
<p>on page 617). To disable this behavior, pass the</p>
<p><b>--ignore_unknown_func_ptr_warnings</b> option.</p>
<p><b>Re-Factoring Code to Simplify Recursive Clusters</b></p>
<p>In some situations, your code may include recursive clusters that can be simplified</p>
<p>by re-factoring. The following example code contains a single recursive cluster</p>
<p>consisting of</p>
<p>funcOne()</p>
<p>,</p>
<p>funcTwo()</p>
<p>, and</p>
<p>funcThree()</p>
<p>:</p>
<p><b>Diagram of Cluster</b></p>
<p><b>Code</b></p>
<p>int funcOne(int x);</p>
<p>int funcThree(int x)</p>
<p>{</p>
<p>return 1 + funcOne(x-1);</p>
<p>}</p>
<p>int funcTwo(int x)</p>
<p>{</p>
<p>return 1 + funcOne(x+1);</p>
<p>}</p>
<p>int funcOne(int x)</p>
<p>{</p>
<p>if (x &gt; 0)</p>
<p>return funcThree(x);</p>
<p>else if (x &lt; 0)</p>
<p>return funcTwo(x);</p>
<p>else</p>
<p>return 0;</p>
<p>}</p>
<p>int main(void) {</p>
<p>int x = funcOne(5) + funcOne(-5);</p>
<p>return x;</p>
<p>}</p>
<p><b>gstack Output</b></p>
<p>Recursive Cluster #0 (3 nodes):</p>
<p>funcOne</p>
<p>. funcThree</p>
<p>. . funcOne</p>
<p>[RPT]</p>
<p>. funcTwo</p>
<p>. . funcOne</p>
<p>[RPT]</p>
<p><i>609</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Working With Recursive Clusters</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>[RPT]</p>
<p>indicates that the node is repeated. Its callees are not displayed</p>
<p>again.</p>
<p>This code actually contains two separate recursive loops:</p>
<p>funcOne()</p>
<p>â</p>
<p>funcTwo()</p>
<p>â</p>
<p>funcOne()</p>
<p>, and</p>
<p>funcOne()</p>
<p>â</p>
<p>funcThree()</p>
<p>â</p>
<p>funcOne()</p>
<p>. You could rewrite it as follows to</p>
<p>break the cluster up into two smaller clusters, each consisting of two nodes:</p>
<p><b>Diagram of Cluster</b></p>
<p>funcTwo</p>
<p><b>Code</b></p>
<p>int funcOnePos(int x);</p>
<p>int funcOneNeg(int x);</p>
<p>int funcThree(int x)</p>
<p>{</p>
<p>return 1 + funcOnePos(x-1);</p>
<p>}</p>
<p>int funcTwo(int x)</p>
<p>{</p>
<p>return 1 + funcOneNeg(x+1);</p>
<p>}</p>
<p>int funcOnePos(int x)</p>
<p>{</p>
<p>if (x &gt; 0)</p>
<p>return funcThree(x);</p>
<p>else</p>
<p>return 0;</p>
<p>}</p>
<p>int funcOneNeg(int x)</p>
<p>{</p>
<p>if (x &lt; 0)</p>
<p>return funcTwo(x);</p>
<p>else</p>
<p>return 0;</p>
<p>}</p>
<p>int main(void) {</p>
<p>int x = funcOnePos(5) + funcOneNeg(-5);</p>
<p>return x;</p>
<p>}</p>
<p><b>gstack Output</b></p>
<p>Recursive Cluster #0 (2 nodes):</p>
<p>funcOnePos</p>
<p>. funcThree</p>
<p>. . funcOnePos</p>
<p>[RPT]</p>
<p>Recursive Cluster #1 (2 nodes):</p>
<p>funcOneNeg</p>
<p>. funcTwo</p>
<p>. . funcOneNeg</p>
<p>[RPT]</p>
<p><b>Annotating Recursive Functions</b></p>
<p>In order to correctly compute the maximum stack usage for a program,<b> gstack</b> needs</p>
<p>to know the maximum number of instances of each recursive function that can</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>610</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>appear on the stack at a given time. If it detects a recursive function for which a</p>
<p>maximum instances value has not been specified and cannot be computed,<b> gstack</b></p>
<p>lists the function in the</p>
<p>Missing Information</p>
<p>section of its report with</p>
<p>MI</p>
<p>. To</p>
<p>provide this information to<b> gstack</b>, add the following directive immediately before</p>
<p>the definition of the function if it is defined in a C file:</p>
<p>#pragma ghs max_instances(<i>n</i>)</p>
<p>or add the following directive within the scope of the function if it is defined in an</p>
<p>assembly file:</p>
<p>.maxinstances<i> func</i>,<i> n</i></p>
<p>or use the following command line option:</p>
<p>-max_instances func=<i>n</i></p>
<p><b>Note</b></p>
<p>The</p>
<p>.maxinstances</p>
<p>directive is ignored unless at least one</p>
<p>.scall</p>
<p>directive is specified for the same function.</p>
<p>Because<b> gstack</b> tries to infer a function's maximum instances value based on the</p>
<p>values of its callers and callees, it may not be necessary to specify a value for every</p>
<p>function in a particular recursive cluster. However, the values<b> gstack</b> computes</p>
<p>may be conservative. Providing<b> gstack</b> with additional values could yield more</p>
<p>accurate results. For example:</p>
<p>int funcOne(int x);</p>
<p>int funcThree(int x)</p>
<p>{</p>
<p>return 3 + funcOne(x-1);</p>
<p>}</p>
<p>int funcTwo(int x)</p>
<p>{</p>
<p>return 2 + funcOne(x-1);</p>
<p>}</p>
<p>int funcOne(int x)</p>
<p>{</p>
<p>if (x &lt;= 0)</p>
<p>return 0;</p>
<p>else if (x &amp; 1)</p>
<p>return funcTwo(x);</p>
<p>else</p>
<p>return funcThree(x);</p>
<p><i>611</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Working With Recursive Clusters</i></p>
<h1 style="page-break-before:always; "></h1>
<p>}</p>
<p>int main (void){</p>
<p>int x = funcOne(10);</p>
<p>return x;</p>
<p>}</p>
<p>Specifying a maximum instances value of 11 for</p>
<p>funcOne()</p>
<p>would cause<b> gstack</b></p>
<p>to compute a maximum instance values of 11 for both</p>
<p>funcTwo()</p>
<p>and</p>
<p>funcThree()</p>
<p>. However, because neither of these functions exist on the stack more</p>
<p>than 5 times, specifying individual maximum instances values for each of them</p>
<p>would lead to a lower computed maximum stack usage for the cluster.</p>
<p><b>Note</b></p>
<p>If a function is inlined its value is no longer used to compute the values</p>
<p>for other nodes in the cluster, so building your program with different</p>
<p>sets of options may require you to annotate more functions.</p>
<p><b>gstack</b> computes the maximum stack usage for a recursive cluster by multiplying</p>
<p>each function's individual stack usage by its maximum instances value, and summing</p>
<p>the result over all the functions in the cluster. Therefore, large or complex recursive</p>
<p>clusters can cause<b> gstack</b> results to become extremely conservative, and it is strongly</p>
<p>recommended that you modify your code to simplify them as much as possible (see</p>
<p>âWorking With Recursive Clustersâ on page 605).</p>
<p><b>Specifying Interrupts</b></p>
<p>If your program uses any feature that causes execution to be interrupted, such as</p>
<p>interrupts or signals, and the handler uses the same stack as the main program, you</p>
<p>need to provide this information to<b> gstack</b> to get accurate results.</p>
<p>Specify each of your program's interrupt handlers and associated priority levels as</p>
<p>follows:</p>
<p>-interrupt_level<i> func</i>:<i>levels</i></p>
<p>where<i> func</i> is the name of the handler and<i> levels</i> is a comma-separated list of priority</p>
<p>levels at which the interrupts serviced by the handler can fire. Each entry in the list</p>
<p>is a single level or a range of levels (denoted by a hyphen). For example, the</p>
<p>following option specifies that</p>
<p>myFunc</p>
<p>is handler that services interrupts that can</p>
<p>fire at priority levels 1 through 5, level 7, and levels 10 through 15:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>612</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-interrupt_level myFunc:1-5,7,10-15</p>
<p>If your program uses an interrupt dispatch function that calls off to the actual</p>
<p>handlers, that function should be specified with the<b> -interrupt_entry_point</b> option.</p>
<p>The maximum stack usage of the dispatch function is added to the total stack usage</p>
<p>for the worst interrupt handler for each distinct priority level when computing the</p>
<p>worst possible interrupt stack.</p>
<p>After specifying interrupt handlers, specify the maximum interrupt nesting depth,</p>
<p>which is the number of interrupts that can fire on top of each other without their</p>
<p>associated handlers being popped off of the stack. Specify the depth as follows:</p>
<p>-interrupt_depth<i> depth</i></p>
<p>If you do not specify this option,<b> gstack</b> issues a warning and uses the number of</p>
<p>distinct priority levels for which at least one handler is specified. To use this behavior</p>
<p>and ignore the warning, use:</p>
<p>-interrupt_depth<i> max</i></p>
<p>When computing the combination of nested interrupts that would use the most stack,</p>
<p><b>gstack</b> assumes that only one interrupt triggers for each priority level. Therefore,</p>
<p>the worst possible interrupt stack consists of the<i> depth</i> distinct priority levels whose</p>
<p>associated handlers have the largest total stack usages. The total amount of stack</p>
<p>used by this combination of handlers is added to the maximum non-interrupt stack</p>
<p>usage of each entry point when deciding whether it can exceed its allocated stack</p>
<p>limit.</p>
<p>Use the<b> -i</b> option to tell<b> gstack</b> to include the</p>
<p>Interrupt Functions</p>
<p>section in</p>
<p>its report, which lists all interrupt functions along with their stack usages and</p>
<p>associated priority levels.</p>
<p><b>gstack Report Format</b></p>
<p>By default,<b> gstack</b> outputs a report that contains the results of its analysis and prints</p>
<p>a message pointing to the location of the report. If you specify<b> -quiet</b>,<b> gstack</b> does</p>
<p>not print a message unless it detects a problem that requires attention. If you pass</p>
<p>the<b> -skip_report</b> option, no message is printed and no report is generated unless a</p>
<p>problem is detected. If an error occurs before report generation begins, no report is</p>
<p>generated.</p>
<p><i>613</i></p>
<p><i>Green Hills Software</i></p>
<p><i>gstack Report Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Contains</b></p>
<p><b>Appears When</b></p>
<p><b>Name</b></p>
<p>a high-level overview of the</p>
<p>report</p>
<p>always</p>
<p>Executive Summary</p>
<p>the name, worst stack usage,</p>
<p>and specified stack limit for</p>
<p>each entry point that exceeds</p>
<p>its limit</p>
<p>at least one entry point exceeds</p>
<p>its provided stack limit</p>
<p>STACK LIMIT EXCEEDED</p>
<p>an explanation of each</p>
<p>problem</p>
<p><b>gstack</b> detects problems that</p>
<p>could cause its results to be</p>
<p>incorrect or conservative</p>
<p>Problems During</p>
<p>Execution</p>
<p>details about what</p>
<p>information is missing</p>
<p><b>gstack</b> detects missing</p>
<p>information</p>
<p>Missing Information</p>
<p>details about what</p>
<p>information was supplied by</p>
<p>the user</p>
<p><b>gstack</b> detects user-supplied</p>
<p>information</p>
<p>User Supplied</p>
<p>Information</p>
<p>a list of unbounded recursive</p>
<p>clusters</p>
<p><b>gstack</b> detects unbounded</p>
<p>recursive clusters</p>
<p>Unbounded Recursive</p>
<p>Clusters</p>
<p>a list of bounded recursive</p>
<p>clusters</p>
<p><b>gstack</b> detects bounded</p>
<p>recursive clusters</p>
<p>Bounded Recursive</p>
<p>Clusters</p>
<p>the worst stack usage and the</p>
<p>call stack that yields it for</p>
<p>each entry point</p>
<p>at least one entry point is</p>
<p>specified</p>
<p>Worst Call Stacks from</p>
<p>Entry Points</p>
<p>the worst interrupt stack for</p>
<p>each entry point that has one</p>
<p>and the worst call stacks</p>
<p>from the contributing</p>
<p>interrupt handlers</p>
<p>at least one entry point has an</p>
<p>interrupt stack with non-zero</p>
<p>stack usage</p>
<p>Worst Interrupt Stacks</p>
<p>for Entry Points</p>
<p>a listing of all interrupt</p>
<p>functions, their stack sizes,</p>
<p>and the priorities at which</p>
<p>they can fire</p>
<p><b>-i</b> is specified</p>
<p>Interrupt Functions</p>
<p>all nodes and their maximum</p>
<p>stack usages</p>
<p><b>-j</b> is specified</p>
<p>Max Stack Usages For</p>
<p>All Nodes</p>
<p>the call graph</p>
<p><b>-g</b> is specified</p>
<p>Call Graph</p>
<p>all nodes that have no callers</p>
<p><b>-u</b> is specified</p>
<p>Nodes With No Callers</p>
<p>information about callers of</p>
<p>specific nodes</p>
<p><b>-c</b> is specified</p>
<p>Callers from Procs</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>614</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Contains</b></p>
<p><b>Appears When</b></p>
<p><b>Name</b></p>
<p>the command line used to</p>
<p>invoke<b> gstack</b></p>
<p>always</p>
<p>Command Line</p>
<p><b>gstack Options</b></p>
<p><b>-a<i> caller</i>:<i>callee1</i>[,<i>callee2</i>,...]</b></p>
<p>Adds connections to the call graph.</p>
<p>-a</p>
<p>caller:callee1,callee2</p>
<p>adds calls from</p>
<p>caller</p>
<p>to</p>
<p>callee1</p>
<p>and</p>
<p>callee2</p>
<p>to the call graph.</p>
<p><b>-c<i> func</b></i></p>
<p>Displays all callers of<i> func</i>.</p>
<p><b>-d<i> callee</i>[:<i>caller,...</i>]</b></p>
<p>If you specify one function, this option deletes all calls</p>
<p>to that function. For example,</p>
<p>-d callee</p>
<p>deletes all</p>
<p>calls to</p>
<p>callee</p>
<p>.</p>
<p>If you also specify a list of callers, this option deletes</p>
<p>all calls from those callers to the specified callee. For</p>
<p>example,</p>
<p>-d callee:caller1,caller2</p>
<p>deletes all</p>
<p>calls from</p>
<p>caller1</p>
<p>and</p>
<p>caller2</p>
<p>to</p>
<p>callee</p>
<p>.</p>
<p><b>-f<i> func</i>=<i>size</b></i></p>
<p>Specifies function maximum stack usage<i> size</i>.</p>
<p><b>-g</b></p>
<p>Displays the call graph.</p>
<p><b>-help</b></p>
<p>Displays information about all options.</p>
<p><b>-entry_point<i> func</b></i>,<b> -e<i> func</b></i></p>
<p>Specifies a function<i> func</i> to add to the set of entry points</p>
<p>for the program.<b> gstack</b> displays information for each</p>
<p>of these functions, including the call stack and the</p>
<p>combination of nested interrupts that would use the</p>
<p>most stack.</p>
<p><b>-entry_point_options<i> entry opt1</i> [<i>opt2...</i>] -+</b>,</p>
<p><b>-e_opts<i> entry opt1</i> [<i>opt2...</i>] -+</b></p>
<p>Specifies a list of options that apply to a single entry</p>
<p>point. The list must begin with the name of the entry</p>
<p>point and end with</p>
<p>-+</p>
<p>. The following options are</p>
<p>allowed:<b> -stack_limit</b>,<b> -interrupt_depth</b>, and</p>
<p><b>-interrupt_level</b>.<b> -stack_limit</b> and<b> -interrupt_depth</b></p>
<p>options specified inside the list override those specified</p>
<p>outside the list.<b> -interrupt_level</b> options specified inside</p>
<p>the list do not override those specified outside the list.</p>
<p><b>@<i>filename</b></i>,<b> -opt_file=<i>filename</b></i></p>
<p>Specifies a file containing additional options. For more</p>
<p>information, see âUsing a Driver Options Fileâ</p>
<p>on page 15.</p>
<p><i>615</i></p>
<p><i>Green Hills Software</i></p>
<p><i>gstack Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>--ignore_mismatched_prototype_warnings</b></p>
<p>Suppresses warnings about possible mismatches</p>
<p>between the prototypes and definitions of certain library</p>
<p>functions that take function pointer arguments, which</p>
<p>can cause<b> gstack</b> results to be incorrect.</p>
<p><b>--ignore_unknown_func_ptr_warnings</b></p>
<p>Suppresses warnings about calls through unknown</p>
<p>function pointers, which can cause<b> gstack</b>'s results to</p>
<p>be conservative.</p>
<p><b>--ignore_wrap_warnings</b></p>
<p>Suppresses warnings about detected uses of the<b> -wrap</b></p>
<p>option, which can cause<b> gstack</b>'s results to be</p>
<p>conservative.</p>
<p><b>-interrupt_entry_point<i> func</b></i></p>
<p>Specifies the dispatch function that calls the actual</p>
<p>interrupt handlers. If this option is specified multiple</p>
<p>times, only the last value for<i> func</i> is used.</p>
<p><b>-interrupt_level<i></b> func</i>:<i>m</i>-<i>n</i>[,<i>o</i>,<i>p</i>-<i>q</i>...]</p>
<p>Specifies functions that are interrupts, and the interrupt</p>
<p>levels at which they can occur. You must specify at</p>
<p>least one level or range of levels after<i> func</i>.</p>
<p><b>-interrupt_depth<i></b> depth</i></p>
<p>Specifies the maximum depth of the interrupt stack.</p>
<p><b>-interrupt_funcs</b>,<b> -i</b></p>
<p>Displays all interrupt functions, their stack usages, and</p>
<p>the priorities at which they can fire.</p>
<p><b>-j</b></p>
<p>Displays all functions and their maximum stack usages.</p>
<p><b>--legacy</b></p>
<p>Run<b> gstack</b> in legacy mode.</p>
<p><b>--link_names</b></p>
<p>Prints the function's global symbol, as opposed to its</p>
<p>address, in parentheses when the function's name is not</p>
<p>unique. See âSpecifying Functions with Non-Unique</p>
<p>Namesâ on page 617.</p>
<p><b>-max_instances<i> func</i>=<i>n</b></i></p>
<p>Specifies the maximum number of instances<i> n</i> of the</p>
<p>function<i> func</i> that can exist on the stack at any given</p>
<p>time. This option helps<b> gstack</b> compute the stack use</p>
<p>of recursive clusters.</p>
<p><b>-o<i> filename</b></i></p>
<p>Specifies the name of the report output file.</p>
<p><b>-quiet</b></p>
<p>Hides the message pointing to the location of<b> gstack</b></p>
<p>output, unless a problem is detected.</p>
<p><b>-skip_report</b></p>
<p>Skips report generation unless a problem is detected.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>616</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-stack_limit<i> n</b></i></p>
<p>Specifies the maximum amount of stack in bytes that</p>
<p>is allocated for each entry point.<b> gstack</b> reports an error</p>
<p>if the stack limit for any entry point is exceeded.</p>
<p><b>-u</b></p>
<p>Displays all nodes that have no callers.</p>
<p><b>-x<i> func</i>=<i>n</b></i></p>
<p>Specifies an additional amount<i> n</i> to add to the known</p>
<p>maximum stack value for function<i> func</i>. This option is</p>
<p>the equivalent of</p>
<p>#pragma ghs extra_stack</p>
<p>.</p>
<p><b>Note</b></p>
<p>The<b> -a</b>,<b> -d</b>, and<b> -c</b> options may also be applied to nodes that represent</p>
<p>strong function pointer types. If one of the names used with any of these</p>
<p>functions could refer either to a function node or a type node,<b> gstack</b></p>
<p>issues an error. To resolve the ambiguity, prefix the name with either</p>
<p>.f.</p>
<p>or</p>
<p>.t.</p>
<p>to specify whether the option is to be applied to the function</p>
<p>node or the type node, respectively.</p>
<p><b>Specifying Functions with Non-Unique Names</b></p>
<p>Often a program will contain multiple functions with the same name. For example,</p>
<p>this can happen if static functions with the same name are defined in different source</p>
<p>files.</p>
<p>When<b> gstack</b> prints the name of a function whose name is not unique, it follows</p>
<p>the name with the function's address in parentheses. If the<b> --link_names</b> option is</p>
<p>used,<b> gstack</b> prints the global symbol associated with the function instead of its</p>
<p>address.</p>
<p>To specify a function whose name is not unique to<b> gstack</b>, use the function's address</p>
<p>or its global symbol in place of the function's name in order to avoid ambiguity</p>
<p>with the other functions.</p>
<p><b>The Problems During Execution Report Section</b></p>
<p>This section explains warnings given for problems that may cause<b> gstack</b> results</p>
<p>to be incorrect or conservative.</p>
<p><i>617</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Specifying Functions with Non-Unique Names</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Misunderstood call table entries</b></p>
<p>This warning is given when<b> gstack</b> is unable to load all of the debug info</p>
<p>necessary to compute its results. This could be because the debug info has been</p>
<p>corrupted, or because<b> gstack</b> is being run on a program that was built with a</p>
<p>different version toolchain, which is not supported.</p>
<p><b>Use of __builtin_set_return_address() compiler intrinsic</b></p>
<p>This warning is given when<b> gstack</b> detects use of the</p>
<p>__builtin_set_return_address</p>
<p>compiler intrinsic, which is not supported.</p>
<p><b>Mismatched prototype</b></p>
<p>This warning is given when<b> gstack</b> detects a mismatch between the prototype</p>
<p>and the definition for a library function that takes a strong function pointer as</p>
<p>an argument. This issue means the call graph is incorrect, and should be addressed</p>
<p>by making sure the prototype for the function comes from the appropriate header</p>
<p>file, or by using the<b> -a</b> and<b> -d</b> options to modify the call graph appropriately.</p>
<p>To suppress this warning, use the<b> --ignore_mismatched_prototype_warnings</b></p>
<p>option.</p>
<p><b>Use of -wrap option</b></p>
<p>This warning is given when<b> gstack</b> detects use of the<b> -wrap</b> linker option, which</p>
<p>is handled safely but conservatively by assuming that all calls to function<i> foo</i></p>
<p>may also go to<i> __wrap_foo</i>, and all calls to<i> __real_foo</i> may also go to<i> foo</i>, if</p>
<p>the respective nodes exist. When using<b> -wrap</b>, you may want to use the<b> -d</b> option</p>
<p>for<b> gstack</b> to manually delete references from the call graph in order to achieve</p>
<p>more accurate results. To suppress this warning, use the</p>
<p><b>--ignore_wrap_warnings</b> option.</p>
<p><b>Call(s) through unknown function pointer</b></p>
<p>This warning is given when<b> gstack</b> detects a call through an unknown function</p>
<p>pointer, which can cause results to be extremely conservative and can lead to</p>
<p>other problems, such as spurious recursions being added to the call graph. To</p>
<p>suppress this warning, use the<b> --ignore_unknown_func_ptr_warnings</b> option.</p>
<p>For more information, see âUsing Strong Function Pointersâ on page 606.</p>
<p><b>Interrupt Nesting Depth not specified</b></p>
<p>This warning is given when the<b> -interrupt_level</b> option is used to specify</p>
<p>interrupt handlers, without the<b> -interrupt_depth</b> option also being used to</p>
<p>specify a maximum interrupt nesting depth, which can cause results to be</p>
<p>conservative. To tell<b> gstack</b> not to use a maximum nesting depth in its</p>
<p>calculations without issuing the warning, use<b> -interrupt_depth max</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>618</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Caveats</b></p>
<p>â¢</p>
<p><b>gstack</b> does not account for changes to the call graph made by third-party</p>
<p>linkers (such as<b> ld</b> or<b> link</b>).</p>
<p>â¢</p>
<p><b>gstack</b> is not supported for programs that contain code built with third-party</p>
<p>tools, including any libraries provided with a third-party operating system.</p>
<p>â¢</p>
<p><b>gstack</b> is not supported for programs that were built with a different version</p>
<p>of the toolchain.</p>
<p>â¢</p>
<p><b>gstack</b> does not support the use of the GNU C/C++ extension that allows you</p>
<p>to take the address of a statement label.</p>
<p>â¢</p>
<p><b>gstack</b> may not provide accurate results for programs built with linker</p>
<p>optimizations such as<b> -delete</b> or<b> -codefactor</b>.</p>
<p>â¢</p>
<p>Using Green Hills C++ libraries may result in errors about missing information</p>
<p>and unbounded recursive clusters, or warnings about unknown function pointers.</p>
<p>â¢</p>
<p><b>gstack</b> is not supported for programs that use linker generated tables whose</p>
<p>entries contain function pointers, unless each table is an array of function</p>
<p>pointers or an array of pointers to function pointers. Tables of things like structs</p>
<p>that contain function pointers are not supported, even if the fields of the structs</p>
<p>are defined using strong function pointer types. Linker generated tables that</p>
<p>are defined in or populated with entries that are defined in assembly files are</p>
<p>not supported. For more information, see âLinker Generated Tablesâ</p>
<p>on page 505.</p>
<p><i>619</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Caveats</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gstrip Utility Program</b></p>
<p>The<b> gstrip</b> utility program can remove line number, symbol table, and debugging</p>
<p>information from an executable, relocatable, or library file to reduce its file size on</p>
<p>disk.<b> gstrip</b> can only remove DWARF line number and debugging information.</p>
<p>Since it does not modify Green Hills debugging information, stripping an executable</p>
<p>does not generally affect debugging. However, it can impact some operations, such</p>
<p>as reading from a section whose offset within the file has changed as a result of</p>
<p>earlier sections being stripped out.</p>
<p>The<b> gstrip</b> utility processes executable files created by the Green Hills Software</p>
<p>linker as well as those created by some native linkers.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gstrip</b> [<i>options</i>]<i> filename</i></p>
<p>where<i> filename</i> is the name of an executable file.</p>
<p>If no options are specified,<b> gstrip</b> removes line number, symbol table, and debugging</p>
<p>information. The<i> options</i> for<b> gstrip</b> are as follows:</p>
<p><b>-a</b></p>
<p>Removes all unallocated sections except</p>
<p>.shstrtab</p>
<p>(ELF only).</p>
<p><b>-help</b></p>
<p>Displays information about all the options.</p>
<p><b>-l</b></p>
<p>Removes line number information only, without stripping the symbol table or debugging</p>
<p>information.</p>
<p><b>-r=<i>secname</b></i></p>
<p>Removes sections named<i> secname</i>.</p>
<p><b>-stripreloc</b></p>
<p>Enable stripping of relocatable objects and libraries. When<b> -stripreloc</b> is passed, the symbol</p>
<p>table and string table may not be stripped regardless of other options.</p>
<p><b>-V</b></p>
<p>Displays the version number of<b> gstrip</b> to standard error output.</p>
<p><b>-x</b></p>
<p>Does not remove the symbol table; debugging and line number information might be removed.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>620</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gversion Utility Program</b></p>
<p>The<b> gversion</b> utility program extracts and prints date and time information from an</p>
<p>executable file provided by Green Hills. If no options or slots are specified, then</p>
<p><b>gversion</b> outputs the executable's revision and release dates from slots</p>
<p>0</p>
<p>and</p>
<p>6</p>
<p>.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gversion</b> [<i>options</i>] [<i>slot</i>] [<i>file1</i>] [<i>file2</i> ...]</p>
<p>where:</p>
<p>â¢</p>
<p><i>options</i>: Listed in the table below.</p>
<p>â¢</p>
<p><i>slot</i>: A single digit number, specifying the slot to print (see</p>
<p>Example 11.32. Using gversion on page 622).<b> gversion</b> displays the file</p>
<p>modification date when no valid time stamp corresponding to the slot requested</p>
<p>can be found.</p>
<p>â¢</p>
<p><i>file1</i>,<i> file2</i>: The executable files for which you want to print date and time</p>
<p>information.</p>
<p><b>-all</b></p>
<p>Displays all non-zero dates, marked</p>
<p>[0]</p>
<p>through</p>
<p>[9]</p>
<p>. Each date is preceded by a digit in square</p>
<p>brackets â[]â called a time stamp. The revision date is preceded by</p>
<p>[0]</p>
<p>and the release date is</p>
<p>preceded by</p>
<p>[6]</p>
<p>. See Example 11.33. Using -all on page 622.</p>
<p><b>-date</b> (default)</p>
<p>Displays the value as a date string.</p>
<p><b>-help</b></p>
<p>Displays information about all options.</p>
<p><b>-mtime</b></p>
<p><b>-nomtime</b> (default)</p>
<p>Enables or disables display of the file's modification date. The<b> -mtime</b> option must be used with</p>
<p><b>-all</b>. See Example 11.34. Using -mtime on page 622.</p>
<p><b>-quiet</b></p>
<p>Suppresses errors for files that are not stamped.</p>
<p><b>-value</b></p>
<p>Displays all stamp values without converting to date.</p>
<p><i>621</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gversion Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 11.32. Using gversion</b></p>
<p>In this example, suppose the executable<b> gversion</b> has only time slot</p>
<p>0</p>
<p>set:</p>
<p>&gt; ./gversion gversion</p>
<p>gversion: Green Hills Software, MULTI v2012.0</p>
<p>gversion:</p>
<p>Revision Date Mon Nov</p>
<p>9 10:48:25 PST 2009</p>
<p>gversion:</p>
<p>Release Date</p>
<p>Mon Dec 14 17:08:14 PST 2009</p>
<p>If asked to print the value of slot 1, which is not stamped,<b> gversion</b> displays an</p>
<p>error message:</p>
<p>&gt; ./gversion 1 gversion</p>
<p>gversion: Green Hills Software, MULTI v2012.0</p>
<p>gversion has not been time stamped</p>
<p>gversion:</p>
<p>[m] Mon Nov</p>
<p>9 10:48:25 2009</p>
<p><b>Example 11.33. Using -all</b></p>
<p>When using</p>
<p>-all</p>
<p>,<b> gversion</b> displays all non-empty time stamps.</p>
<p>&gt; ./gversion -all gversion</p>
<p>gversion: Green Hills Software, MULTI v2012.0</p>
<p>gversion:</p>
<p>[0] Mon Nov</p>
<p>9 10:48:25 PST 2009</p>
<p>gversion:</p>
<p>[6] Mon Dec 14 17:08:14 PST 2009</p>
<p>gversion: License Managed by Green Hills License Manager</p>
<p><b>Example 11.34. Using -mtime</b></p>
<p>The<b> -mtime</b> option must be used with<b> -all</b>. It provides the file's modification date.</p>
<p>&gt; ./gversion -mtime -all gversion</p>
<p>gversion: Green Hills Software, MULTI v2012.0</p>
<p>gversion:</p>
<p>[0] Mon Nov</p>
<p>9 10:48:25 PST 2009</p>
<p>gversion:</p>
<p>[6] Mon Dec 14 17:08:14 PST 2009</p>
<p>gversion: License Managed by Green Hills License Manager</p>
<p>gversion:</p>
<p>[m] Mon Nov</p>
<p>9 10:48:25 2009</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>622</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The gwhat Utility Program</b></p>
<p>The<b> gwhat</b> utility program performs a similar function to the Linux/Solaris<b> what</b></p>
<p>program. It reports or updates the version information of a file.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>gwhat</b> [<i>options</i>] [<i>file1</i>] [<i>file2</i> ...]</p>
<p>The options to<b> gwhat</b> are as follows:</p>
<p><b>-all</b></p>
<p>Prints out all</p>
<p>what</p>
<p>-strings.</p>
<p><b>-c<i> what_str</b></i></p>
<p>Overwrites the default</p>
<p>what</p>
<p>-string space reserved for customers with<i> what_str</i>.</p>
<p><b>-f</b></p>
<p>Overwrites the</p>
<p>what</p>
<p>-string, even if it is read-only.</p>
<p><b>-help</b></p>
<p>Displays help message.</p>
<p><b>-m<i> what_str</b></i></p>
<p>Overwrites the Green Hills</p>
<p>what</p>
<p>-string space with<i> what_str</i>.</p>
<p><b>-s<i>n</b></i></p>
<p>Stops after the<i> nth</i> occurrence of the pattern. The default is 1 (first occurrence). There is no</p>
<p>space between the<b> -s</b> and<i> n</i>.</p>
<p><b>-w<i> what_str</b></i></p>
<p>Changes the</p>
<p>what</p>
<p>-string marker from</p>
<p>@(#)</p>
<p>to<i> what_str</i>.</p>
<p>If neither the<b> -c</b> nor<b> -m</b> option is specified, then by default<b> gwhat</b> outputs the first</p>
<p>string in the file. You can set the number of strings to output with the<b> -all</b> or<b> -s</b></p>
<p>option.</p>
<p><b>Version Extract Mode</b></p>
<p>In version extract mode,<b> gwhat</b> searches each filename for occurrences of the</p>
<p>following 4-byte</p>
<p>what</p>
<p>-string marker:</p>
<p>@(#)</p>
<p><i>623</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The gwhat Utility Program</i></p>
<h1 style="page-break-before:always; "></h1>
<p>It then displays all subsequent characters up to but not including any of the following</p>
<p>terminator characters (expressed in C) or end-of-file:</p>
<p><b>Character name</b></p>
<p><b>Character</b></p>
<p>Straight double quotation mark</p>
<p>&quot;</p>
<p>Greater than sign</p>
<p>&gt;</p>
<p>Backslash</p>
<p>\\</p>
<p>Newline</p>
<p>\n</p>
<p>Null character</p>
<p>\0</p>
<p>For example, if the C program in file<b> program.c</b> contains:</p>
<p>char sccsid[] = &quot;@(#)Version 3.0&quot;;</p>
<p>and if<b> program.c</b> is compiled to yield<b> program.o</b> and linked to yield<b> a.out</b>, then</p>
<p>the command:</p>
<p>gwhat program.c program.o a.out</p>
<p>produces:</p>
<p>program.c:</p>
<p>Version 3.0</p>
<p>program.o:</p>
<p>Version 3.0</p>
<p>a.out:</p>
<p>Version 3.0</p>
<p><b>Version Update Mode</b></p>
<p>In version update mode,<b> gwhat</b> can write new version information into a file. This</p>
<p>feature has several applications. All Green Hills executables are built with two</p>
<p>default</p>
<p>what</p>
<p>-strings. For example:</p>
<p>&quot;@(#)Green Hills Software, Version 201200&quot;</p>
<p>&quot;@(#)[Customer version stamp space]&quot;</p>
<p>Under some circumstances, Green Hills may change the Green Hills release</p>
<p>what</p>
<p>-string, using the<b> -m</b> option. For example:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>624</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>gwhat -m 'special release abc' elxr</p>
<p>gwhat -s2 elxr</p>
<p>Green Hills Software, special release abc</p>
<p>[Customer version stamp space]</p>
<p>This capability is available to Green Hills customers as well, although it is</p>
<p>recommended that the Green Hills release</p>
<p>what</p>
<p>-string be left unchanged.</p>
<p>If you want to stamp a Green Hills executable with a private identification mark,</p>
<p>change the</p>
<p>[Customer version stamp space]</p>
<p>that is provided for this purpose.</p>
<p>For example:</p>
<p>gwhat -c 'Mary likes this version' elxr</p>
<p>gwhat -s2 elxr</p>
<p>Green Hills Software, Version 201200</p>
<p>Mary likes this version</p>
<p>The<b> -c</b> option can only be used once on a binary because it looks for the original</p>
<p>[Customer version stamp space]</p>
<p>identifier.</p>
<p>You might want to build a custom</p>
<p>what</p>
<p>-string into your own software to mark the</p>
<p>executables. For example, suppose your executable,<b> acmeprog</b>, contains a C source</p>
<p>file that contains:</p>
<p>char sccsid[] = &quot;@(#)ACME SOFTWARE</p>
<p>&quot;;</p>
<p>The following shows the different outputs of<b> gwhat</b> before and after using the<b> -m</b></p>
<p>and<b> -w</b> options.</p>
<p>gwhat acmeprog</p>
<p>ACME SOFTWARE</p>
<p>gwhat -w &quot;@(#)ACME SOFTWARE &quot; -m &quot;version 12&quot; acmeprog</p>
<p>gwhat acmeprog</p>
<p>ACME SOFTWARE version 12</p>
<p><i>625</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Version Update Mode</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The mevundump Utility Program</b></p>
<p>The<b> mevundump</b> utility program converts (and merges, if multiple input files are</p>
<p>given) an input event log of any format to<b> mevgui</b>'s event log format.</p>
<p>The syntax for this utility is as follows:</p>
<p><b>mevundump<i></b> options InputConfig1 InputEventLog1</i> [<i>InputConfig2</i></p>
<p><i>InputEventLog2</i>...]<i> OutputName</i></p>
<p>The options to<b> mevundump</b> are as follows:</p>
<p><b>-h</b></p>
<p>Prints out usage dialogue.</p>
<p><b>-d</b></p>
<p>Enables extra debugging info and warnings to be output to stderr.</p>
<p><b>-a<i> N | H</b></i></p>
<p>N</p>
<p>- Natural alignment. The original timestamps in each input event log are used so if one log</p>
<p>begins at 500 ms and another begins at 1200 ms, the event at time 500 ms will be considered 0</p>
<p>time for all event logs (so the events from the second log will begin 700 ms after the first event</p>
<p>in the output log). If no option is given,<b> mevundump</b> defaults to this behavior.</p>
<p>H</p>
<p>- Head alignment. The timestamps in each input event log are justified against the first event</p>
<p>of that log. If one log's events start at time 500 ms and another starts at time 1200 ms, the first</p>
<p>event from both logs will appear at time 0 in the output event log.</p>
<p><b>-confDir<i> dir_path</b></i></p>
<p>Designates the directory in which to look for the input configuration file(s).</p>
<p><b>-logDir<i> dir_path</b></i></p>
<p>Designates the directory in which to look for the input event log file(s).</p>
<p><b>-outConfDir<i> dir_path</b></i></p>
<p>Designates the directory in which to create the output<b> mevgui</b> configuration file(s).</p>
<p><b>-outLogDir<i> dir_path</b></i></p>
<p>Designates the directory in which to create the output event log files.</p>
<p><b>mevundump</b> is a stand alone conversion tool for event logs. It accepts, as input,</p>
<p>up to 16 pairs of input configuration files and event logs (in their native format)</p>
<p>and a single output name and produces a<b> mevgui</b> compatible event log triplet of</p>
<p>files (<b>OutputName.mes</b>,<b> .mei</b>, and<b> .mev</b>) and a<b> mevgui</b> compatible configuration</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>626</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>file (<b>OutputName.mc</b>). If more than one input pair is given, the inputs are merged</p>
<p>according to the event alignment option given on the command line.</p>
<p>There are some differences between input and output event logs to be aware of:</p>
<p>â¢</p>
<p>The timestamps will change. In both timestamp alignment options above, the</p>
<p>timestamps will be justified to some event. Unless the event they are being</p>
<p>aligned with has a timestamp of 0, the timestamps will change by a difference</p>
<p>of the aligning event's timestamp.</p>
<p>â¢</p>
<p>The task IDs will change. Each task ID will be shifted left by 4 bits and have</p>
<p>a process ID masked in to it. The process ID denotes which input log the event</p>
<p>corresponds to. If only one input log is given, this process ID will always be</p>
<p>0. Also note that because of the shift, the top 4 bits of the task ID will be lost</p>
<p>(currently uses a 32 bit</p>
<p>int</p>
<p>to store/report task ID).</p>
<p>â¢</p>
<p>The specific values used for each event may change. These output values/codes</p>
<p>are generated based on the order the events are presented in the input</p>
<p>configuration file. Note: this does not affect how the input file is read, this only</p>
<p>affects the output event log and output configuration file.</p>
<p>â¢</p>
<p>The values of statuses will change. Like task IDs, statuses will have a process</p>
<p>ID shifted in to their value. This feature allows statuses of the same value to</p>
<p>be treated differently depending on which file they come from.</p>
<p>Again, the top 4 bits will be lost in the shift (currently using 32 bit</p>
<p>int</p>
<p>).</p>
<p>These differences do not affect the visual output of the logs, nor the order of the</p>
<p>events on the time line, but the user should be aware of them if trying to find specific</p>
<p>information in the log, such as a task or status by its value in the input log. The best</p>
<p>way to find the output values of events and statuses is to open the output</p>
<p>configuration file and check there.</p>
<p><b>Input Configuration File</b></p>
<p>The input configuration file describes how the input event log should be interpreted</p>
<p>by<b> mevundump</b>. An input configuration file is made up of 3 main sections</p>
<p>â¢</p>
<p>a single<i> Header</i> block</p>
<p>â¢</p>
<p>one or more<i> Event</i> blocks</p>
<p>â¢</p>
<p>0 or more<i> Status</i> blocks</p>
<p><i>627</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Input Configuration File</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Each of these blocks has its own list of options and sub-blocks, which are described</p>
<p>below. The<i> Header</i> block contains general information about how to read the input</p>
<p>event log and where specific information may be found in the file. Each<i> Event</i> block</p>
<p>describes where to find information for that event and the formatting to be output</p>
<p>to the output configuration file. Each<i> Status</i> block describes the configuration</p>
<p>information that will describe the status in the output configuration file. If no<i> Status</i></p>
<p>blocks are given, the status list will be generated from the event's<i> Status_Change</i></p>
<p>sub-blocks using a rotating color scheme and default values.</p>
<p>The table below outlines the options that can be set in this file. Any values with a</p>
<p>vertical bar between them (</p>
<p>|</p>
<p>) imply that those values should be used literally (i.e.</p>
<p>'endian: B|L'</p>
<p>means either a literal</p>
<p>B</p>
<p>or</p>
<p>L</p>
<p>should be used as the value). A value</p>
<p>of</p>
<p>#</p>
<p>implies any number can be given, as decimal or (with a leading</p>
<p>0x</p>
<p>) as</p>
<p>hexadecimal. A value of '</p>
<p>OFFSET</p>
<p>'</p>
<p>can be written as either a number (in decimal or</p>
<p>hex, if led with an</p>
<p>0x</p>
<p>) or as a file offset to be read to find the value. This offset</p>
<p>should be led with a</p>
<p>*</p>
<p>. For example, to use the value</p>
<p>32</p>
<p>, you can write</p>
<p>32</p>
<p>or</p>
<p>0x20</p>
<p>.</p>
<p>To use the offset</p>
<p>33</p>
<p>you would write</p>
<p>*33</p>
<p>or</p>
<p>*0x21</p>
<p>. All offsets are counted in bytes</p>
<p>from the beginning of the file, unless otherwise noted.<b> mevundump</b> will read</p>
<p>addr_size</p>
<p>bytes, beginning at the offset, using the given endianness, as the value</p>
<p>for the given option.</p>
<p>For</p>
<p>OFFSET</p>
<p>type values, think of it as an address to dereference. For example,</p>
<p>something like</p>
<p>version</p>
<p>:</p>
<p>OFFSET</p>
<p>, which expects a number, would dereference the</p>
<p>given</p>
<p>OFFSET</p>
<p>and read the file from there to get the version # (think</p>
<p>int*</p>
<p>).</p>
<p>However, a field like</p>
<p>event_list_head: OFFSET</p>
<p>, which expects an offset to</p>
<p>the first event, would dereference the given</p>
<p>OFFSET</p>
<p>, read the value at</p>
<p>OFFSET</p>
<p>, and</p>
<p>use that value as the file offset to the first event (</p>
<p>void**</p>
<p>).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>628</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><i>Header Block</i></p>
<p>General setup options</p>
<p><b>Comments</b></p>
<p><b>Default Value</b></p>
<p><b>Option</b></p>
<p>Indicates what endianness the input event log</p>
<p>should be read in. All output event logs will</p>
<p>be in big endian format.</p>
<p>B</p>
<p>endian: B|L</p>
<p>Indicates what version of<b> mevundump</b> this</p>
<p>input configuration is built for.</p>
<p>#define</p>
<p>CURRENT_VERSION</p>
<p>(1)</p>
<p>version: OFFSET</p>
<p>The number of bytes used to represent an</p>
<p>address in this file. Also will be used as the #</p>
<p>of bytes to read for a majority of OFFSET</p>
<p>values.</p>
<p>4 bytes</p>
<p>addr_size: #</p>
<p>Default value is used by uVelOSity event logs.</p>
<p>100000</p>
<p>timer_tick_freq:</p>
<p>OFFSET</p>
<p>Indicates which word of a 64 bit value comes</p>
<p>first (Upper or Lower). For example a</p>
<p>timestamp of</p>
<p>0x1234 5678 abcd cdef</p>
<p>in</p>
<p>Lower format would be written as</p>
<p>0xabcd</p>
<p>cdef 1234 5678</p>
<p>U (Upper)</p>
<p>timestamp_format:</p>
<p>U|L</p>
<p>Indicates whether the event log is a binary or</p>
<p>text file.</p>
<p>bin(ary)</p>
<p>filetype</p>
<p>bin|text</p>
<p>Offset to the first event in the log,</p>
<p>chronologically.</p>
<p>Mandatory</p>
<p>event_list_head:</p>
<p>OFFSET</p>
<p>Offset to the last event in the log,</p>
<p>chronologically.</p>
<p>event_list_head</p>
<p>event_list_tail:</p>
<p>OFFSET</p>
<p>Offset to the start of the event list (by location</p>
<p>in file). This is necessary for circular buffers,</p>
<p>so that the front of the list can be found and</p>
<p>wrapped after reaching the end.</p>
<p>0</p>
<p>event_pool:</p>
<p>OFFSET</p>
<p><i>629</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Input Configuration File</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Comments</b></p>
<p><b>Default Value</b></p>
<p><b>Option</b></p>
<p>The offset to the start of the header block of</p>
<p>information in the original memory block. For</p>
<p>uVelOSity logs, this is necessary because the</p>
<p>other offsets (head, tail, etc.) are all just</p>
<p>addresses to memory of the running program.</p>
<p>When saved to a log file, they must be changed</p>
<p>to be relative to the file, which was output from</p>
<p>the memory beginning at</p>
<p>event_header_start</p>
<p>. If not given,</p>
<p><b>mevundump</b> will attempt to calculate it based</p>
<p>on other information, like expected</p>
<p>task_count</p>
<p>and</p>
<p>task_chunk_size</p>
<p>(assumes event list comes immediately after</p>
<p>task list, like in a ThreadX log)</p>
<p>0</p>
<p>event_header_start:</p>
<p>OFFSET</p>
<p>Total # of bytes used for the event list.</p>
<p>Especially important for circular buffers, as</p>
<p>this tells<b> mevundump</b> when to return to the</p>
<p>beginning (</p>
<p>event_pool</p>
<p>).</p>
<p>0</p>
<p>event_list_size:</p>
<p>OFFSET</p>
<p>The # of bytes for every event in the log. Use</p>
<p>this if all of the events have the same size, or</p>
<p>all events store their size at the same location.</p>
<p>Otherwise, each event can define its own size.</p>
<p>0</p>
<p>event_chunk_size:</p>
<p>OFFSET</p>
<p># of bytes used to store the event chunk size.</p>
<p>addr_size</p>
<p>event_chunk_size_size:</p>
<p>#</p>
<p>Offset from the start of each event 'chunk'</p>
<p>to</p>
<p>the type value. This value should be the event</p>
<p>identifier (the</p>
<p>native_type</p>
<p>field of each</p>
<p>event).</p>
<p>Mandatory</p>
<p>event_type_offset:</p>
<p>#</p>
<p># of bytes used to store the event type.</p>
<p>addr_size</p>
<p>event_type_size:</p>
<p>OFFSET</p>
<p>Tells<b> mevundump</b> how to read in the task list.</p>
<p>1 - A task list will be given in the configuration</p>
<p>file (see next option). 2 - A task list is given in</p>
<p>the event log, and the options to read it will</p>
<p>follow (see next several options). 3 - Tasks will</p>
<p>be reported on the fly through special events.</p>
<p>In this mode, any new task ID discovered will</p>
<p>be considered a new task.</p>
<p>3</p>
<p>task_input:</p>
<p>1|2|3</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>630</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Comments</b></p>
<p><b>Default Value</b></p>
<p><b>Option</b></p>
<p>Describes the executing tasks in the event log.</p>
<p>The list is semicolon delimited and should</p>
<p>follow this format:</p>
<p>TaskName1, TaskID1,</p>
<p>TaskPriority1; TaskName2, TaskID2,</p>
<p>...</p>
<p>NULL</p>
<p>- mandatory for</p>
<p>task_input: 1</p>
<p>mode</p>
<p>task_list:</p>
<p>String</p>
<p>Offset from start of file to the first byte of the</p>
<p>task list.</p>
<p>0</p>
<p>- mandatory for</p>
<p>task_input: 2</p>
<p>mode</p>
<p>task_list_offset:</p>
<p>OFFSET</p>
<p># of bytes used for each task.</p>
<p>0</p>
<p>- mandatory for</p>
<p>task_input: 2</p>
<p>mode</p>
<p>task_size:</p>
<p>OFFSET</p>
<p>The expected number of tasks to be read in.</p>
<p>0</p>
<p>- mandatory for</p>
<p>task_input: 2</p>
<p>mode</p>
<p>task_count:</p>
<p>OFFSET</p>
<p># of bytes used to store</p>
<p>task_count</p>
<p>.</p>
<p>addr_size</p>
<p>task_count_size:</p>
<p>#</p>
<p>Offset to any kind of valid flag to know if the</p>
<p>current task should be used. If not given, every</p>
<p>task read will be assumed to be valid.</p>
<p>0</p>
<p>valid_offset:</p>
<p>OFFSET</p>
<p>Offset within each task 'chunk' to find the task</p>
<p>ID.</p>
<p>0</p>
<p>- mandatory for</p>
<p>task_input: 2</p>
<p>mode</p>
<p>id_offset:</p>
<p>OFFSET</p>
<p># of bytes used to store the task ID.</p>
<p>addr_size</p>
<p>id_size: OFFSET</p>
<p>Offset within each task 'chunk' to find the task</p>
<p>priority.</p>
<p>0</p>
<p>- mandatory for</p>
<p>task_input: 2</p>
<p>mode</p>
<p>priority_offset:</p>
<p>OFFSET</p>
<p># of bytes used to store the task priority.</p>
<p>addr_size</p>
<p>priority_size:</p>
<p>OFFSET</p>
<p>Offset within each task 'chunk' to find the task</p>
<p>name.</p>
<p>0</p>
<p>- mandatory for</p>
<p>task_input: 2</p>
<p>mode</p>
<p>name_offset:</p>
<p>OFFSET</p>
<p>Length of each task name in bytes.</p>
<p>32 chars</p>
<p>-</p>
<p>mandatory for</p>
<p>task_input: 2</p>
<p>mode</p>
<p>name_len: OFFSET</p>
<p>The event type code for task creation events.</p>
<p>-1</p>
<p>- mandatory for</p>
<p>task_input: 3</p>
<p>mode</p>
<p>creation_type: #</p>
<p><i>631</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Input Configuration File</i></p>
<h1 style="page-break-before:always; "></h1>
<p><i>Event Block</i></p>
<p>Event specific options and information. One block per event type.</p>
<p><b>Comments</b></p>
<p><b>Default Value</b></p>
<p><b>Option</b></p>
<p>The unique identifier for this event type.</p>
<p>Mandatory</p>
<p>native_type: #</p>
<p># of bytes used by this event type.</p>
<p>event_chunk_size</p>
<p>size: OFFSET</p>
<p># of bytes from the start of the event chunk to</p>
<p>the subtype.</p>
<p>Mandatory</p>
<p>subtype_offset:</p>
<p>#</p>
<p># of bytes used by this event subtype. NOTE:</p>
<p>currently only 2 bytes are supported, as<b> mevgui</b></p>
<p>only accepts 2 bytes for event type and subtype.</p>
<p>2</p>
<p>subtype_size: #</p>
<p># of bytes from the start of the event chunk to</p>
<p>the task ID responsible for the event.</p>
<p>Mandatory</p>
<p>taskID_offset: #</p>
<p># of bytes used by the task ID.</p>
<p>addr_size</p>
<p>taskID_size: #</p>
<p># of bytes from the start of the event chunk to</p>
<p>the timestamp.</p>
<p>0</p>
<p>timestamp_offset:</p>
<p>#</p>
<p># of bytes used by this event timestamp.</p>
<p>8</p>
<p>timestamp_size:</p>
<p>#</p>
<p>Indicates this is a special task change event</p>
<p>(sets the associated task's status as executing).</p>
<p>false</p>
<p>task_change:</p>
<p>true|false</p>
<p>Indicates this is a special name change event</p>
<p>(often used as a synthetic refresh to make</p>
<p><b>mevgui</b> aware of a new task being created or</p>
<p>used to change task priority).</p>
<p>false</p>
<p>name_change:</p>
<p>true|false</p>
<p>Indicates this task halts the execution of all</p>
<p>other tasks when it runs.</p>
<p>false</p>
<p>halt_others:</p>
<p>true|false</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>632</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><i>Status_Change Sub-Block</i></p>
<p>If an event or event subtype contains this sub-block, it implies that the event/subtype</p>
<p>is a status change event. Also, the</p>
<p>status</p>
<p>sub-sub-blocks contains within it can</p>
<p>be used to generate a full status list, using a rotating color scheme and default values.</p>
<p>Also, at least one status sub-sub-blocks must be present in each</p>
<p>status_change</p>
<p>sub-block.</p>
<p><b>Comments</b></p>
<p><b>Default Value</b></p>
<p><b>Option</b></p>
<p># of bytes from the start of the event to the</p>
<p>status code this event changes its task to. If not</p>
<p>given, this event will always switch to the first</p>
<p>status</p>
<p>sub-sub-block contained within this</p>
<p>status_change</p>
<p>block.</p>
<p>0</p>
<p>code_offset: #</p>
<p><i>Status Sub-Block</i></p>
<p>This sub-sub-block is essentially a reference to the status blocks described below.</p>
<p>If this sub-sub-block describes as status that does not have a corresponding status</p>
<p>block,<b> mevundump</b> will automatically generate a status block for it, using default</p>
<p>values and a rotating color scheme.</p>
<p><b>Comments</b></p>
<p><b>Default Value</b></p>
<p><b>Option</b></p>
<p>The value that identifies this status, or * to</p>
<p>describe all unmatched statuses.</p>
<p>Mandatory</p>
<p>code: # | *</p>
<p>The name that identifies this status and will be</p>
<p>displayed by<b> mevgui</b></p>
<p>Mandatory</p>
<p>disp_name:</p>
<p>String</p>
<p>If true, the associated icon (described in the</p>
<p>status block) will be displayed by<b> mevgui</b>. This</p>
<p>is only useful for an auto-generated list, as the</p>
<p>main status block's visible: option will override</p>
<p>this one.</p>
<p>false</p>
<p>visible:</p>
<p>true|false</p>
<p><i>633</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Input Configuration File</i></p>
<h1 style="page-break-before:always; "></h1>
<p><i>Extra Sub-Block</i></p>
<p>This sub-block described the extra data fields of each event and how they should</p>
<p>be reported to<b> mevgui</b>.</p>
<p><b>Comments</b></p>
<p><b>Default Value</b></p>
<p><b>Option</b></p>
<p>The name of this extra data field as<b> mevgui</b></p>
<p>will report it</p>
<p>NULL - Mandatory</p>
<p>name: String</p>
<p>The name of this extra data field as<b> mevgui</b></p>
<p>will report it</p>
<p>NULL - Mandatory</p>
<p>name: String</p>
<p>The name of this extra data field as<b> mevgui</b></p>
<p>will report it</p>
<p>NULL - Mandatory</p>
<p>name: String</p>
<p><i>Subtype Sub-Block</i></p>
<p>This sub-block described the extra data fields of each event and how they should</p>
<p>be reported to<b> mevgui</b>. Each event must have at least one subtype (that one may be</p>
<p>a</p>
<p>*</p>
<p>subtype, to capture all subtypes of the given event).</p>
<p><b>Comments</b></p>
<p><b>Default Value</b></p>
<p><b>Option</b></p>
<p>The native value of this subtype, or</p>
<p>*</p>
<p>to match</p>
<p>all unmatched subtypes of the parent event.</p>
<p>*</p>
<p>subtype: # | *</p>
<p>The name to display in<b> mevgui</b> for this subtype</p>
<p>of event.</p>
<p>NULL - Mandatory</p>
<p>disp_name:</p>
<p>String</p>
<p>The name of the bitmap icon to use for this</p>
<p>event in<b> mevgui</b>.</p>
<p>disp_name</p>
<p>bitmap_name:</p>
<p>String</p>
<p>A</p>
<p>printf</p>
<p>format string to use in place of the</p>
<p>parent event's extra data output. This allows</p>
<p>subtypes to display the extra data of the event</p>
<p>differently, or (if an empty string is given) to</p>
<p>not display any extra data, even if the parent</p>
<p>event collects it. If not given, the parent event's</p>
<p>extra data will be used.</p>
<p>NULL</p>
<p>extra: String</p>
<p>Describes which event category this subtype</p>
<p>belongs to. Subtypes will be grouped by</p>
<p>category in the output<b> mevgui</b> configuration</p>
<p>file.</p>
<p>Default</p>
<p>category: String</p>
<p>Describes whether or not this subtype's icon</p>
<p>will be displayed by<b> mevgui</b>.</p>
<p>true</p>
<p>visible:</p>
<p>true|false</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>634</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Comments</b></p>
<p><b>Default Value</b></p>
<p><b>Option</b></p>
<p>Indicates this is a special task change event</p>
<p>(sets the associated task's status as executing).</p>
<p>Inherits from parent</p>
<p>Event</p>
<p>task_change:</p>
<p>true|false</p>
<p>Indicates this is a special name change event</p>
<p>(often used as a synthetic refresh to make</p>
<p><b>mevgui</b> aware of a new task being created or</p>
<p>used to change task priority).</p>
<p>Inherits from parent</p>
<p>Event</p>
<p>name_change:</p>
<p>true|false</p>
<p>Indicates this task halts the execution of all</p>
<p>other tasks when it runs.</p>
<p>Inherits from parent</p>
<p>Event</p>
<p>halt_others:</p>
<p>true|false</p>
<p>A</p>
<p>status_change</p>
<p>block within a subtype is</p>
<p>formatted the same as one in an event. See</p>
<p>above for reference.</p>
<p>N/A</p>
<p><i>status_change{}</i></p>
<p><i>635</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Input Configuration File</i></p>
<h1 style="page-break-before:always; "></h1>
<p><i>Status Block</i></p>
<p>Gives a full description of a task status, including all configuration info for<b> mevgui</b>.</p>
<p><b>Comments</b></p>
<p><b>Default Value</b></p>
<p><b>Option</b></p>
<p>The value that identifies this status, or * to</p>
<p>describe all unmatched statuses.</p>
<p>*</p>
<p>code: # | *</p>
<p>The name<b> mevgui</b> will display for this status.</p>
<p>NULL - Mandatory</p>
<p>disp_name:</p>
<p>String</p>
<p>The name of the bitmap file to display for the</p>
<p>event of the actual status change. Usually, just</p>
<p>&quot;statuschange&quot; and the icon's visibility is set</p>
<p>to false (see below).</p>
<p>disp_name</p>
<p>(with any</p>
<p>non-alphanumeric</p>
<p>characters changed to</p>
<p>an _)</p>
<p>bitmap_name:</p>
<p>String</p>
<p>The color to use for the status's line segment.</p>
<p>0x000000 (Black)</p>
<p>rgb: #</p>
<p>The style of the line to use for the status's line</p>
<p>segment. - = Dashed, . = Dotted, s = Solid.</p>
<p>s (Solid)</p>
<p>style: -|.|s</p>
<p>The thickness of the line to use for the status's</p>
<p>line segment. Note, for easy visibility,</p>
<p>auto-generated statuses use a thickness of 2</p>
<p>(not the default value).</p>
<p>1</p>
<p>thickness: #</p>
<p>Describes whether or not this status change's</p>
<p>icon will be displayed by<b> mevgui</b>. This is for</p>
<p>the actual event during which the status</p>
<p>changes, this does not affect the visibility of</p>
<p>the line segment representing the status.</p>
<p>true</p>
<p>visible:</p>
<p>true|false</p>
<p>This will mark the status as a special case. The</p>
<p>three special cases are used as follows:</p>
<p>exec</p>
<p>- This is the status a task will change to</p>
<p>whenever there is a context switch to it.</p>
<p>ready</p>
<p>- This is the status all other tasks will be set to</p>
<p>when a &quot;</p>
<p>halt_others</p>
<p>&quot; context switch occurs.</p>
<p>init</p>
<p>- This is the initial status all new tasks</p>
<p>are started in. This often appears as</p>
<p>&quot;Unknown&quot;. If the status is not a special status,</p>
<p>do not include this option. If any of the three</p>
<p>special statuses are never defined in the input</p>
<p>configuration file, the default values are</p>
<p>0x0</p>
<p>for</p>
<p>ready</p>
<p>,</p>
<p>0x1</p>
<p>for</p>
<p>exec</p>
<p>, and</p>
<p>0x2</p>
<p>for</p>
<p>init</p>
<p>.</p>
<p>NULL (Not a</p>
<p>special status)</p>
<p>type:</p>
<p>exec|ready|init</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>636</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Input Configuration Example</b></p>
<p>The following is an excerpt from the</p>
<p>uVelOSity</p>
<p>input configuration file.</p>
<p>header{</p>
<p>os: uVelosity</p>
<p>event_list_head: *48</p>
<p>event_list_tail: *44</p>
<p>event_type_offset: 1</p>
<p>event_pool: *0x1164</p>
<p>event_header_start: *36</p>
<p>event_list_size: *32</p>
<p>timestamp_format: L</p>
<p>event_chunk_size: *0</p>
<p>event_chunk_size_size: 1</p>
<p>task_input: 1</p>
<p>#task_list must come next</p>
<p>task_list: task_1, 0xbe98, 0xa; task_2, 0xbf28, 0xb; Interrupts, 0, 0;</p>
<p>}</p>
<p>event{</p>
<p>#refresh</p>
<p>native_type: 0x6</p>
<p>subtype_offset: 0x3</p>
<p>subtype_size: 2</p>
<p>taskID_offset: 13</p>
<p>timestamp_offset: 0x5</p>
<p>timestamp_size: 8</p>
<p>name_change: true</p>
<p>subtype{</p>
<p>subtype: 0xa</p>
<p>disp_name: TaskNameRefresh</p>
<p>bitmap_name: statuschange</p>
<p>visible: false</p>
<p>category: uv_mpool</p>
<p>extra:</p>
<p>status_change{</p>
<p>status{</p>
<p>code: 0xa</p>
<p>name: Unknown</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>subtype{ #catch any other type 0x6 events</p>
<p>disp_name: TaskNameRefresh</p>
<p>bitmap_name: statuschange</p>
<p>category: uv_mpool</p>
<p>extra:</p>
<p>}</p>
<p>}</p>
<p>status{</p>
<p>code: 0xa</p>
<p>disp_name: Unknown</p>
<p>bitmap_name: statuschange</p>
<p>style: -</p>
<p>type: init</p>
<p>}</p>
<p><i>637</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Input Configuration File</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>mevundump_lib RPC Library</b></p>
<p>The functions of<b> mevundump</b> can also be accessed through a remote procedure</p>
<p>call shared object,<b> mevundump_lib.so</b>. This library provides the same functionality</p>
<p>as the C implementation (full translation and merging of event logs) but also exposes</p>
<p>pieces of<b> mevundump</b> so that it can be extended easily.</p>
<p>The functions available and a brief description of each can be found in the tables</p>
<p>below. Each function accepts a</p>
<p>JsValue</p>
<p>structure with the given key/value pairs</p>
<p>added to it. Each function also returns a</p>
<p>JsValue</p>
<p>structure with the given key/value</p>
<p>pairs defined in it. If the function called fails,</p>
<p>err</p>
<p>will be set to a value other than</p>
<p>0, and</p>
<p>errMsg</p>
<p>will contain the error message, otherwise</p>
<p>err</p>
<p>will be set to 0.</p>
<p>Input Configuration Reading Functions</p>
<p><b>Description</b></p>
<p><b>Function</b></p>
<p>Parses the given configuration file (at</p>
<p>cDir/filename) and stores the returned</p>
<p>MevConfigData</p>
<p>structure to an internal list.</p>
<p>On success, it returns the index (in the internal</p>
<p>list) of the new</p>
<p>MevConfigData</p>
<p>, and the</p>
<p>evCount</p>
<p>- the number of events parsed in the</p>
<p>new</p>
<p>MevConfigData</p>
<p>.</p>
<p>ParseConfigFile(filename=(char*),</p>
<p>cDir=(char*), evBase=(int),</p>
<p><i>procInd=(int)</i>)</p>
<p>returns</p>
<p>(configIndex=(int),</p>
<p>evCount=(int), err=(int),</p>
<p>errMsg=(char*))</p>
<p>This will empty the internal list of</p>
<p>MevConfigData</p>
<p>structures.</p>
<p>ClearConfigList()</p>
<p>returns</p>
<p>(Empty JsValue)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>638</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Event Log Writer Functions</p>
<p><b>Description</b></p>
<p><b>Function</b></p>
<p>Creates and initializes a new output event log.</p>
<p>OpenMESFile(filename=(char*),</p>
<p>oDir=(char*), osName=(char*),</p>
<p>freq=(int), addrSize=(int))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p>Flushes and Closes the output event log.</p>
<p>CloseMESFile()</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p>Writes a task creation event to the output event</p>
<p>log using the given information. For</p>
<p>clarification, &quot;</p>
<p>id</p>
<p>&quot; is the task ID, &quot;</p>
<p>priority</p>
<p>&quot;</p>
<p>is the task priority, &quot;</p>
<p>name</p>
<p>&quot; is the task name,</p>
<p>&quot;</p>
<p>refresh</p>
<p>&quot; is the code for a task</p>
<p>creation/refresh event, &quot;</p>
<p>init</p>
<p>&quot; is the status</p>
<p>code to start the new task in. &quot;</p>
<p>idS</p>
<p>&quot;, and</p>
<p>&quot;</p>
<p>prioS</p>
<p>&quot; is the number of bytes to be used for</p>
<p>&quot;</p>
<p>id</p>
<p>&quot; and &quot;</p>
<p>priority</p>
<p>&quot;, respectively. However,</p>
<p><b>mevundump</b> currently only supports 4 byte</p>
<p>task IDs. &quot;</p>
<p>pNameLen</p>
<p>&quot;, &quot;</p>
<p>pInd</p>
<p>&quot;, and</p>
<p>&quot;</p>
<p>procName</p>
<p>&quot; should only be used if this task</p>
<p>needs process information associated with it</p>
<p>(i.e. when merging multiple input event logs).</p>
<p>&quot;</p>
<p>pInd</p>
<p>&quot; is the process index for this task's</p>
<p>process, &quot;</p>
<p>procName</p>
<p>&quot; is the name of the</p>
<p>process, and &quot;</p>
<p>pNameLen</p>
<p>&quot; is the length of</p>
<p>procName</p>
<p>. If including process information</p>
<p>with this task,</p>
<p>pNameLen</p>
<p>must be &gt; 0,</p>
<p>otherwise it will be ignored.</p>
<p>OutputTask(id=(int64), idS=(int),</p>
<p>priority=(int64), prioS=(int),</p>
<p>name=(char*), nameLen=(int),</p>
<p>refresh=(int), init=(int),</p>
<p>bigEndian=(bool),<i> pNameLen=(int),</i></p>
<p><i>procName=(char*), pInd=(int)</i>)</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p><i>639</i></p>
<p><i>Green Hills Software</i></p>
<p><i>mevundump_lib RPC Library</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Description</b></p>
<p><b>Function</b></p>
<p>Writes an event to the output event log using</p>
<p>the provided information. &quot;</p>
<p>time</p>
<p>&quot; is the</p>
<p>timestamp of the event, &quot;</p>
<p>type</p>
<p>&quot; is the output</p>
<p>type code of the event, &quot;</p>
<p>subtype</p>
<p>&quot; is the</p>
<p>subtype of the event, &quot;</p>
<p>buffer</p>
<p>&quot; is a byte array</p>
<p>containing the extra data information,</p>
<p>&quot;</p>
<p>procInd</p>
<p>&quot; is the process number that is</p>
<p>executing this event, &quot;</p>
<p>execStat</p>
<p>&quot; is the status</p>
<p>code for an executing task, &quot;</p>
<p>readyStat</p>
<p>&quot; is</p>
<p>the status code for a task that is ready to</p>
<p>execute, &quot;</p>
<p>stat</p>
<p>&quot;, &quot;</p>
<p>task</p>
<p>&quot;, &quot;</p>
<p>name</p>
<p>&quot;, and &quot;</p>
<p>halt</p>
<p>&quot;</p>
<p>describe the effect this event has on the status</p>
<p>of the system - each would be true if the event</p>
<p>is a status change, task change, name change</p>
<p>(refresh), or if this event halts all other running</p>
<p>tasks in its process.</p>
<p>OutputEvent(time=(int64),</p>
<p>type=(int), subtype=(int),</p>
<p>buffer=(int[]), procInd=(int),</p>
<p>execStat=(int), readyStat=(int),</p>
<p>stat=(bool), task=(bool),</p>
<p>name=(bool), halt=(bool))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p>Converts<i> buffer</i>, an array of bytes, into event</p>
<p>data. &quot;</p>
<p>proc</p>
<p>&quot; is the process number associated</p>
<p>with this byte array, &quot;</p>
<p>bigEndian</p>
<p>&quot; is the</p>
<p>endianness of the byte array, &quot;</p>
<p>LLFormat</p>
<p>&quot; is</p>
<p>the word order for a 64 bit value (true if the</p>
<p>lower word comes first), &quot;</p>
<p>typeOff</p>
<p>&quot;,</p>
<p>&quot;</p>
<p>subtypeOff</p>
<p>&quot;, &quot;</p>
<p>timestampOff</p>
<p>&quot;, and</p>
<p>&quot;</p>
<p>taskIDOff</p>
<p>&quot; are byte offsets into<i> buffer</i> to</p>
<p>find the given information and the</p>
<p>corresponding *Size values are the number of</p>
<p>bytes each piece of information is stored in.</p>
<p>&quot;</p>
<p>edList</p>
<p>&quot; is the list of extra data configuration</p>
<p>values - each one has an &quot;</p>
<p>offset</p>
<p>&quot; and a</p>
<p>&quot;</p>
<p>size</p>
<p>&quot;.</p>
<p>TranslateEvent(buffer=(int[]),</p>
<p>proc=(int), bigEndian=(bool),</p>
<p>LLFormat=(bool), typeOff=(int),</p>
<p>subtypeOff=(int),</p>
<p>timestampOff=(int),</p>
<p>taskIDOff=(int), typeSize=(int),</p>
<p>subtypeSize=(int),</p>
<p>timestampSize=(int),</p>
<p>taskIDSize=(int),</p>
<p>edList=(offset=(int), size=(int)))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*),</p>
<p>type=(int64), subtype=(int64),</p>
<p>taskID=(int64), timestamp=(int64),</p>
<p>extra=(int[]))</p>
<p>Takes &quot;</p>
<p>memNames</p>
<p>&quot;, a list of input event log</p>
<p>filenames, and &quot;</p>
<p>output</p>
<p>&quot;, the name of the</p>
<p>output event log file (and their respective</p>
<p>directory paths), and converts and merges the</p>
<p>input event logs into the output event log using</p>
<p>the internal</p>
<p>MevConfigData</p>
<p>list. Calls to this</p>
<p>function assume that</p>
<p>ParseConfig</p>
<p>has</p>
<p>already been run on each associated input</p>
<p>configuration file.</p>
<p>ConvertAndMerge(memNames=(char*[]),</p>
<p>lDir=(char*), output=(char*),</p>
<p>outputDir=(char*), align=(int))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>640</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Output Configuration Writer Functions</p>
<p><b>Description</b></p>
<p><b>Function</b></p>
<p>Writes the configuration information in the</p>
<p>internal</p>
<p>MevConfigData</p>
<p>list to the given</p>
<p>output configuration file. This function will</p>
<p>open the output configuration file (No need to</p>
<p>open it beforehand) but does not flush/close</p>
<p>the file, so the user can add more after this call</p>
<p>completes.</p>
<p>WriteFullConfig(filename=(char*),</p>
<p>oDir=(char*))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p>Opens the given output configuration file for</p>
<p>writing. Also, writes in the default</p>
<p>MEV_Misc</p>
<p>settings.</p>
<p>OpenMEVConfig(osName=(char*),</p>
<p>oDir=(char*))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p>Flushes and closes the current output</p>
<p>configuration file. Note: only one file can be</p>
<p>open at a time. If the users attempts to open</p>
<p>multiple files, all except the first open will be</p>
<p>silently ignored.</p>
<p>CloseMEVConfig()</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p>Writes a line of text to the configuration file,</p>
<p>appending a new line afterwards.</p>
<p>WriteConfigLine(text=(char*))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p>Writes a</p>
<p>MEV_Status</p>
<p>to the configuration file</p>
<p>using the given information. &quot;</p>
<p>rgb</p>
<p>&quot; is a hex</p>
<p>RGB color and for &quot;</p>
<p>style</p>
<p>&quot;, 0 = Solid, 1 =</p>
<p>Dashed, 2 = Dotted lines.</p>
<p>WriteConfigStatus(code=(char*),</p>
<p>name=(char*), rgb=(int),</p>
<p>style=(int), thickness=(int),</p>
<p>visibility=(bool))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p>Writes a</p>
<p>MEV_Event_Category</p>
<p>to the</p>
<p>configuration file. All following events (until</p>
<p>the next</p>
<p>MEV_Event_Category</p>
<p>) will be</p>
<p>included in this category.</p>
<p>WriteConfigEventCategory(name=(char*))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p>Writes a</p>
<p>MEV_Event</p>
<p>to the configuration file.</p>
<p>&quot;</p>
<p>name</p>
<p>&quot; is the name that<b> mevgui</b> will display</p>
<p>for the given event, &quot;</p>
<p>bitmap</p>
<p>&quot; is the name of</p>
<p>the .bmp file to use as the icon for the event</p>
<p>(do not include file extension), &quot;</p>
<p>extra</p>
<p>&quot; is the</p>
<p>extra data format string.</p>
<p>WriteConfigEvent(type=(int),</p>
<p>subtype=(int), name=(char*),</p>
<p>bitmap=(char*), extra=(char*),</p>
<p>visibility=(bool))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p>Writes a</p>
<p>MEV_Event</p>
<p>to the configuration file.</p>
<p>This function is the same as</p>
<p><b>WriteConfigEvent</b>, except that it accepts a</p>
<p>string for subtype instead of an int.</p>
<p>WriteConfigSEvent(type=(int),</p>
<p>subtype=(char*), name=(char*),</p>
<p>bitmap=(char*), extra=(char*),</p>
<p>visibility=(bool))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p><i>641</i></p>
<p><i>Green Hills Software</i></p>
<p><i>mevundump_lib RPC Library</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Description</b></p>
<p><b>Function</b></p>
<p>Writes a</p>
<p>MEV_Event</p>
<p>to the configuration file.</p>
<p>This function is the same as</p>
<p><b>WriteConfigEvent</b>, except that it accepts an</p>
<p>array of extra data information: &quot;</p>
<p>size</p>
<p>&quot; is the</p>
<p>number of digits to use for the extra data value</p>
<p>and &quot;</p>
<p>name</p>
<p>&quot; is the name it should be marked</p>
<p>as. For example, if</p>
<p>size=4</p>
<p>and</p>
<p>name=&quot;PC&quot;</p>
<p>,</p>
<p>the resulting event would have an extra data</p>
<p>format string of</p>
<p>&quot;PC=%4X&quot;</p>
<p>.</p>
<p>WriteConfigArrEvent(type=(int),</p>
<p>subtype=(int), name=(char*),</p>
<p>bitmap=(char*), extra=(size=(int),</p>
<p>name=(char*)), visibility=(bool))</p>
<p>returns</p>
<p>(err=(int), errMsg=(char*))</p>
<p><b>Python RPC Example</b></p>
<p>The next page is a Python implementation of<b> mevundump</b>, using the RPC library.</p>
<p>It accepts the same arguments as<b> mevundump</b>. Remember to import the</p>
<p><b>mevundump_lib</b> shared object:</p>
<p>#load the MEV shared object library</p>
<p>import shlibproxy</p>
<p>proxy = shlibproxy.SharedLibraryServiceProxy(</p>
<p>&quot;/export/devl/linux86-deploy/mevundump_lib.so&quot;,</p>
<p>&quot;InitMevUndump&quot;,</p>
<p>&quot;MevUndumpDispatch&quot;)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>642</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#!/usr/bin/env python</p>
<p># pymev.py: Python library to access mevundump functions</p>
<p>import sys</p>
<p>#load the MEV shared object library</p>
<p>import shlibproxy</p>
<p>proxy = shlibproxy.SharedLibraryServiceProxy(</p>
<p>&quot;/export/devl/linux86-deploy/mevundump_lib.so&quot;,</p>
<p>&quot;InitMevUndump&quot;,</p>
<p>&quot;MevUndumpDispatch&quot;)</p>
<p># parse command line, initialize vars, etc. not shown</p>
<p>######################## parse in input config(s) ########################</p>
<p>evCount = 0</p>
<p>for i in range(0, len(configNames)):</p>
<p>rv = proxy.ParseConfigFile(filename=configNames[i], \</p>
<p>cDir=confDir, evBase=evCount)</p>
<p>print configNames[i]</p>
<p>print confDir</p>
<p>if (rv[&quot;err&quot;] == 0): #success</p>
<p>evCount += rv[&quot;evCount&quot;]</p>
<p>print rv[&quot;errMsg&quot;]</p>
<p>else:</p>
<p>print &quot;Error processesing &quot; + configNames[i]</p>
<p>print &quot;Error Code: %d\nErrorMsg : %s\n&quot; % \</p>
<p>(rv[&quot;err&quot;], rv[&quot;errMsg&quot;])</p>
<p>#delete any bad ones</p>
<p>del configNames[i]</p>
<p>del logNames[i]</p>
<p>if (len(logNames) &lt;= 0):</p>
<p>sys.exit(&quot;Did not successfully parse any configuration files.&quot;)</p>
<p>###################### merge input to output logs ########################</p>
<p>rv = proxy.ConvertAndMerge(lDir=logDir, output=outputName, \</p>
<p>outputDir=outDir, align=alignIn, memNames=logNames);</p>
<p>if (rv[&quot;err&quot;] != 0): #something went wrong</p>
<p>print &quot;Error converting memfiles.&quot;</p>
<p>print &quot;Error Code: %d\nErrorMsg : %s\n&quot; % \</p>
<p>(rv[&quot;err&quot;], rv[&quot;errMsg&quot;])</p>
<p>sys.exit(&quot;Check files and try again.\n&quot;);</p>
<p>print rv[&quot;errMsg&quot;]</p>
<p>######################## write mev config file ###########################</p>
<p>rv = proxy.WriteFullConfig(filename=outputName, oDir=outCDir);</p>
<p>if (rv[&quot;err&quot;] != 0): #something went wrong</p>
<p>print &quot;Error writing MEV config file &quot; + outputName</p>
<p>print &quot;Error Code: %d\nErrorMsg : %s\n&quot; % \</p>
<p>(rv[&quot;err&quot;], rv[&quot;errMsg&quot;])</p>
<p>sys.exit(&quot;Check files and try again.\n&quot;);</p>
<p>print rv[&quot;errMsg&quot;]</p>
<p>proxy.CloseMEVConfig()</p>
<p>proxy.ClearConfigList()</p>
<p><i>643</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Python RPC Example</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>AUTOSAR and OSEK Operating System Awareness</b></p>
<p>AUTOSAR and OSEK operating system awareness enables the MULTI IDE</p>
<p>debugger to present information specific to your operating system implementation</p>
<p>in the debugger, and to be aware of operating system elements such as threads and</p>
<p>other resources. This awareness is enabled using an industry-standard ORTI (OSEK</p>
<p>Run Time Interface) file typically provided by your operating system vendor. With</p>
<p>that in mind, this documentation assumes that you have either written your own</p>
<p>standards compliant ORTI file or have obtained one from your operating system</p>
<p>vendor or its associated configuration software. This documentation is not an</p>
<p>instruction manual on writing an ORTI file. If you are interested in writing your</p>
<p>own ORTI file, please refer to the ORTI documentation easily found online.</p>
<p>This documentation is broken into five distinct sections. The first two sections</p>
<p>(Compiling the ORTI File and Launching the ORTI OSA Explorer) below describe</p>
<p>compiling an ORTI file, and using the result in the ORTI OSA Explorer inside the</p>
<p>MULTI IDE debugger. These sections are designed to be a quick start reference</p>
<p>for readers looking to get started using the operating system awareness features</p>
<p>quickly. The next two sections (<b>ccorti</b> Reference and ORTI OSA Explorer</p>
<p>Reference) provide a comprehensive reference to both the ORTI compiler (<b>ccorti</b>)</p>
<p>and the ORTI OSA Explorer. These sections serve as both a convenient command</p>
<p>reference, as well as documentation on how to overcome limitations that may be</p>
<p>encountered with the ORTI file provided by the operating system vendor. The final</p>
<p>section (ORTI Troubleshooting) expands upon this by providing a general</p>
<p>troubleshooting guide for frequently encountered issues.</p>
<p>Using AUTOSAR and OSEK operating system awareness with the Green Hills</p>
<p>MULTI IDE debugger requires two separate steps:</p>
<p>â¢</p>
<p>First, the user's ORTI file(s) must be compiled prior to invoking the MULTI</p>
<p>IDE.</p>
<p>â¢</p>
<p>And then finally the MULTI IDE can be used to debug OS(s) that match the</p>
<p>information in the ORTI file(s), using the ORTI OSAExplorer.</p>
<p>An ORTI file is necessary to use the AUTOSARand OSEK operating system</p>
<p>awareness. These files describe the basic properties of a simple operating system</p>
<p>executive in a standardized format. In particular they provide details on context</p>
<p>information (where to find registers for non-running tasks), message containers,</p>
<p>alarms, etc. as well as vendor-specific extensions.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>644</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>It is not uncommon for an operating system vendor to not provide sufficient</p>
<p>information to visualize all operating system objects, or perform all operating system</p>
<p>awareness tasks (such as retrieving register values for non-running tasks). Several</p>
<p>methods to overcome this are described in the documentation below, and the reader</p>
<p>may contact Green Hills support for additional assistance. However, the AUTOSAR</p>
<p>and OSEK operating system awareness feature is designed to be flexible, and will</p>
<p>handle even an ORTI file that fails to provide any task information whatsoever.</p>
<p><b>Compiling the ORTI File</b></p>
<p>In order to use AUTOSARand OSEK operating system awareness with the ORTI</p>
<p>OSA Explorer, two files are required: the ORTI file and a file describing various</p>
<p>configuration and layout options of the ORTI OSA Explorer, commonly referred</p>
<p>to as as an<b> .osa</b> file.</p>
<p>The format and specification of an<b> .osa</b> file is internal to the MULTI IDE, therefore</p>
<p>the ORTI compiler (<b>ccorti</b>) is required to generate one from the ORTI file.</p>
<p>Note that both the<b> .osa</b> file and the ORTI file will be needed later to use the ORTI</p>
<p>OSA Explorer in the MULTI IDE debugger.</p>
<p>An<b> .osa</b> file can easily be created using the following example command:</p>
<p>ccorti myortifile.orti -o myosafile.osa</p>
<p><b>Note</b></p>
<p>The<b> .osa</b> file will contain a reference to the ORTI file so do not delete it.</p>
<p>If you move it, please edit the<b> .osa</b> file to refer to the new location.</p>
<p>Otherwise the ORTI OSA Explorer will fail to operate correctly.</p>
<p>Since the MULTI IDE will automatically look in the subdirectory<b> defaults/os_aware</b></p>
<p>off of its installation directory for<b> .osa</b> files by default, it is recommended that<b> .osa</b></p>
<p>files be kept in that location for convenience. It may also be useful to store ORTI</p>
<p>files in that location as well.</p>
<p>For additional<b> ccorti</b> options, please see the<b> ccorti</b> Reference.</p>
<p>If the compiler returns an error, please consult the Troubleshooting section.</p>
<p><i>645</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Compiling the ORTI File</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Launching the ORTI OSA Explorer</b></p>
<p>Users can connect to the ORTI OSA Explorer by invoking the MULTI IDE debugger</p>
<p>with the<b> -osa</b> command line option. The syntax for this option is:</p>
<p><b>-osa<i></b> osa_name</i>[#<b>cfg</b>=<i>configuration_file</i>][#<b>lib</b>=<i>library_name</i>][#<b>log</b>=<i>log_file</i>]</p>
<p>where<i> osa_name</i> is the name of your<b> .osa</b> file created with<b> ccorti</b>, but without the</p>
<p><b>.osa</b> extension. For more details, please see the MULTI documentation. However,</p>
<p>if your<b> .osa</b> file created with<b> ccorti</b> was placed in the<b> defaults/os_aware</b> subdirectory</p>
<p>of your MULTI installation, and you called it, for example,<b> myortiosa.osa</b>, then</p>
<p><b>-osa myortiosa</b> should be sufficient for most use cases.</p>
<p>Users can also connect to the ORTI OSA Explorer from within the MULTI IDE</p>
<p>debugger, which is useful if MULTI was not invoked with the appropriate option.</p>
<p>To do so, the user should use the<b> osasetup</b> command from the MULTI command</p>
<p>(MULTI&gt;) pane. Its general syntax is:</p>
<p><b>osasetup<i></b> osa_name</i> [<b>-cfg<i></b> config_filename</i>] [<b>-lib<i></b> module_name</i>] [<b>-log<i></b> log_file</i>]</p>
<p>where<i> osa_name</i> is the name of your<b> .osa</b> file created with<b> ccorti</b>, but without the</p>
<p><b>.osa</b> extension. For more details, please see the documentation for this command</p>
<p>in the MULTI documentation. Similar to the command line options, if your<b> .osa</b></p>
<p>file created with<b> ccorti</b> was placed in the<b> defaults/os_aware</b> subdirectory of your</p>
<p>MULTI installation, and you called it, for example,<b> myortiosa.osa</b>, then in most</p>
<p>cases<b> osasetup myortiosa</b> will be sufficient. In other words,<b> osasetup myortiosa</b></p>
<p>will launch the OSA Explorer for the<b> .osa</b> file<b> myortiosa.osa</b> located in</p>
<p><b>defaults/os_aware</b>.</p>
<p><b>Enabling the ORTI OSA Explorer</b></p>
<p>To get the benefit of the operating system awareness provided with the ORTI OSA</p>
<p>Explorer, you must first connect to your target, download you application, and begin</p>
<p>running it. If you are not familiar with this process, please refer to the MULTI</p>
<p>documentation.</p>
<p>Once connected to your running application, you can access the operating system</p>
<p>awareness capabilities at any time by stopping your application and opening the</p>
<p>ORTI OSA Explorer (if it was not previously opened). You can open the ORTI</p>
<p>OSA Explorer from the MULTI Debugger menu, under<b> View -&gt; OSA Explorer...</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>646</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The ORTI OSA Explorer Window</b></p>
<p>The ORTI OSA Explorer window contains one tab for each underlying operating</p>
<p>system object that was defined in the ORTI file. The ORTI 2.2 specification allows</p>
<p>for seven standard object types (all optional) and an unlimited number of vendor</p>
<p>extensions.</p>
<p>The ORTI OSA Explorer supports all seven standard object types, which are</p>
<p>â¢</p>
<p>OS</p>
<p>â¢</p>
<p>TASK</p>
<p>â¢</p>
<p>CONTEXT</p>
<p>â¢</p>
<p>STACK</p>
<p>â¢</p>
<p>ALARM</p>
<p>â¢</p>
<p>RESOURCE</p>
<p>â¢</p>
<p>MESSAGECONTAINER</p>
<p>These standard object types allow the<b> ccorti</b> compiler and the ORTI OSA Explorer</p>
<p>to make certain assumptions about their underlying attributes. In the sample</p>
<p>screenshot above, a generic OS is displayed containing all seven standard objects</p>
<p>and one vendor extension (ISR).</p>
<p>The ORTI OSA Explorer provides special double-click capabilities for TASK,</p>
<p>STACK, and MESSAGECONTAINER objects.</p>
<p>â¢</p>
<p>Double-clicking a TASK entry will highlight the task in the MULTI debugger.</p>
<p><i>647</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Launching the ORTI OSA Explorer</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Double-clicking a STACK entry will open up a Memory View Window on the</p>
<p>associated STACK's Base Address (if available). Double-clicking a</p>
<p>MESSAGECONTAINER will open up a Memory View Window on the</p>
<p>associated MESSAGECONTAINER's First Message attribute (if available).</p>
<p>The ORTI OSA Explorer also provides special right-click context menu capabilities</p>
<p>for STACK and MESSAGECONTAINER objects, in addition to the right-click</p>
<p>context menu items available with all MULTI OSA Explorers. For STACK objects,</p>
<p>the ability to open Memory View windows and standard View windows on the Base</p>
<p>Address attribute's value, when the Base Address is available. Similarly, Memory</p>
<p>View windows and standard View windows can also be opened on the value of a</p>
<p>MESSAGECONTAINER's First Message attribute, when that attribute is available.</p>
<p>Standard View windows can also be open on both of these attribute's evaluated</p>
<p>underlying expressions from the right-click context menu.</p>
<p><b>Cross-reference Capabilities</b></p>
<p>The ORTI specification provides a means of cross-referencing an attribute of one</p>
<p>operating system object to another operating system object. For example, an ORTI</p>
<p>file might provide a way to map a TASK's Task Stack attribute to the actual STACK</p>
<p>object associated with it. If this information is available, the ORTI OSA Explorer</p>
<p>will provide a way to access this through the right-click context menu. In our above</p>
<p>example, a user would right-click a specific task entry and select<b> Go to STACK</b>.</p>
<p>It is also possible to display these cross-references in the GUI. However, as this</p>
<p>capability consumes a large amount of the space in the ORTI OSA Explorer window,</p>
<p>it is not enabled by default. To enable this capability, the ORTI file must be compiled</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>648</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>with<b> ccorti</b>'s<b> -x</b> option. See<b> ccorti</b> Reference for further details on this option. A</p>
<p>sample screenshot with this option enabled is shown above.</p>
<p><b>ccorti Reference</b></p>
<p>The<b> ccorti</b> compiler options are:</p>
<p><b>--extended_syntax</b></p>
<p>Enables support for non-standard ORTI syntax that some vendors use.</p>
<p><b>--help</b></p>
<p>Prints a list of supported commands and associated help text.</p>
<p><b>--check_context_validity</b></p>
<p>See the command<b> set check_context_validity</b> in the ORTI OSA Explorer Reference for details.</p>
<p><b>--cmd<i></b> command</i></p>
<p>Instructs the ORTI OSA Explorer to run the specified command on startup. See the ORTI OSA</p>
<p>Explorer Reference for a list of possible commands</p>
<p><b>--loglevel<i></b> number</i></p>
<p>For debugging purposes; this option can affect the verbosity of messages displayed by the ORTI</p>
<p>OSA Explorer.</p>
<p><b>-m</b></p>
<p>See the Missing Context Information for details.</p>
<p><b>-o<i></b> string</i></p>
<p>Specifies the output filename.</p>
<p><b>-t<i></b> string</i></p>
<p>Specifies what name to give the ORTI OSA Explorer window.</p>
<p><b>-x</b></p>
<p>See Cross-reference Capabilities for details.</p>
<p><b>ORTI OSA Explorer Reference</b></p>
<p>Commands can be issued to the ORTI OSA Explorer from the MULTI IDE</p>
<p>Debugger's command (MULTI&gt;) pane, or at startup in the<b> .osa</b> file using<b> ccorti</b>'s</p>
<p><b>--cmd</b> option. For details on the<b> --cmd</b> option approach, see the<b> ccorti</b> Reference.</p>
<p><i>649</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ccorti Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Issuing commands from the MULTI IDE Debugger's command pane is done using</p>
<p>the<b> osacmd</b> command. For example:</p>
<p>MULTI&gt; osacmd version</p>
<p>ORTI OSA Module 0.1, Copyright (c) 2009 Green Hills Software Inc.</p>
<p>The following commands are supporting by the ORTI OSA Explorer:</p>
<p><b>clearcache</b></p>
<p>Clears all cached information.</p>
<p><b>help</b></p>
<p>This command displays a list of currently supported commands along with a short description.</p>
<p><b>loadconfig<i></b> filename</i></p>
<p>Loads previously saved configuration data from the specified filename. This command is the</p>
<p>complement to the<b> saveconfig</b> command. If no filename is specified, the name of the current</p>
<p>ORTI file will have<b> .cfg</b> appended to it, and a configuration file of this name will be loaded (if</p>
<p>it exists) from the user's local user directory (exact location varies based on host operating</p>
<p>system). For example, if your ORTI file was named<b> sample.orti</b>, then the configuration file</p>
<p>would be loaded from<b> ~/.ghs/sample.orti.cfg</b>.</p>
<p><b>mapregname<i></b> register_id register_name</i></p>
<p>Maps a MULTI IDE debugger register ID (from a GRD file) to a register name.</p>
<p><b>mapregloc<i></b> task_id register_name multi_expression</i></p>
<p>This command is used to augment the task context information provided in the ORTI file. It is</p>
<p>most commonly needed when an error like the following is encountered:</p>
<p>Task 0x1 (basicTaskFirst) is missing complete context information</p>
<p>in your ORTI file.</p>
<p>Register 5 (r5) was not found</p>
<p>Task aware debugging may not be fully available.</p>
<p>The debugger will not be able to reconstruct all of this task's registers.</p>
<p>If the user knows how to access the</p>
<p>r5</p>
<p>register in</p>
<p>basicTaskFirst</p>
<p>'s saved register context,</p>
<p>then they can use the<b> mapregloc</b> command to teach the ORTI OSA Explorer this information.</p>
<p>For example, suppose this register is located at:</p>
<p>*((unsigned int*)[taskStacks[1]-&gt;stack-&gt;registers[5*4])</p>
<p>Then the following command would instruct the ORTI OSA Explorer to find</p>
<p>r5</p>
<p>for Task 1 at</p>
<p>this location:</p>
<p>mapregloc 1 r5 *((unsigned int*)[taskStacks[1]-&gt;stack-&gt;registers[5*4])</p>
<p>Note that<i> multi_expression</i> can be any expression valid in the MULTI IDE Debugger. You may</p>
<p>want to test the expression by attempting to view or print its value first before issuing this</p>
<p>command.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>650</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>regname<i></b> register_id</i></p>
<p>Displays the register name(s) for the specified MULTI IDE debugger register ID.</p>
<p><b>saveconfig<i></b> filename</i></p>
<p>Saves current configuration to the specified filename. If no filename is specified, the name of</p>
<p>the current ORTI file will have<b> .cfg</b> appended to it, and a configuration file of this name will</p>
<p>be saved in the user's local user directory (exact location varies based on host operating system).</p>
<p>For example, if your ORTI file was named<b> sample.orti</b>, the configuration file would be saved</p>
<p>to<b> ~/.ghs/sample.orti.cfg</b>.</p>
<p><b>set check_context_validity<i></b> [on|off|true|false|1|0]</i></p>
<p>When set to on, the ORTI OSA Explorer will not attempt to access a register saved in a task's</p>
<p>saved context information if the context information is flagged as not valid.</p>
<p>By default the ORTI OSA Explorer ignores the valid markers for context information.</p>
<p><b>set suppress_context_errors<i></b> [on|off|true|false|1|0]</i></p>
<p>By default the ORTI OSA Explorer will complain if the OS vendor's ORTI file did not contain</p>
<p>information about where to find a task's saved registers when the task is not the currently running</p>
<p>task. This option can be used to suppress those warnings. When the warnings are suppressed,</p>
<p>the ORTI OSA Explorer will use the current value of any register requested.</p>
<p><b>togglesymbols</b></p>
<p>Replaces values with the expressions used to obtain those values in the ORTI OSA Explorer</p>
<p>window.</p>
<p><b>version</b></p>
<p>This command displays a version string that can be used to identify the ORTI OSA Explorer</p>
<p>software being used when conversing with Green Hills Software, Inc.'s support staff.</p>
<p><b>ORTI Troubleshooting</b></p>
<p><b>ccorti Syntax Errors</b></p>
<p>ccorti: error: syntax error parsing (line 102):</p>
<p>CONTEXT</p>
<p>ccorti: info: Done parsing ORTI KOIL information from myortifile.orti</p>
<p>ccorti: error: Customers current on maintenance may wish to contact support@ghs.com</p>
<p>for assistance with these errors</p>
<p>ccorti: fatal: 1 errors encountered</p>
<p>Syntax errors are most commonly encountered when the ORTI file provided by the</p>
<p>OS vendor contains an error, or is not in conformance with the ORTI standard</p>
<p>supported by<b> ccorti</b>.</p>
<p><i>651</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ORTI Troubleshooting</i></p>
<h1 style="page-break-before:always; "></h1>
<p>To receive assistance with these problems, and to possibly receive instructions on</p>
<p>how to modify the ORTI file to work around or avoid the error, customers current</p>
<p>on maintenance with their product can contact Green Hills Software's technical</p>
<p>support for assistance. Please be sure to provide a copy of the ORTI file in question.</p>
<p><b>Missing Context Information</b></p>
<p>ccorti: warning: Your ORTI file did not contain any register context information.</p>
<p>You may want to recompile with -m to avoid errors with the ORTI OSA Explorer</p>
<p>The above warning is given if the ORTI file did not contain information recognized</p>
<p>by the compiler describing where to locate registers associated with tasks that are</p>
<p>not currently running. This information is necessary in order for the MULTI IDE</p>
<p>to indicate where a pended task was before its context was switched; specifically</p>
<p>MULTI needs to be able to access the saved program counter (PC) register. The</p>
<p>saved stack pointer and return/link register, as well as other registers may be required</p>
<p>on some architectures to display this information. Additionally, without context</p>
<p>information, MULTI will not be able to display the saved register values for a task.</p>
<p>This warning is typically the result of the OS vendor failing to provide the necessary</p>
<p>information in the ORTI file.</p>
<p>Users will notice these problems when the ORTI OSA Explorer displays an error</p>
<p>such as the following error in the MULTI debugger indicating that register</p>
<p>r5</p>
<p>could</p>
<p>not be read due to missing context information:</p>
<p>Task 0x1 (basicTaskFirst) is missing complete context information</p>
<p>in your ORTI file.</p>
<p>Register 5 (r5) was not found</p>
<p>Task aware debugging may not be fully available.</p>
<p>MULTI will not be able to reconstruct all of this task's registers.</p>
<p>Users have two options when this situation arises:</p>
<p>1.</p>
<p>Ignore the problem</p>
<p>2.</p>
<p>Attempt to teach the ORTI OSA Explorer how to overcome the problem by</p>
<p>dynamically updating the ORTI information.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>652</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Ignoring the Problem</p>
<p>If the user wishes to ignore the problem, these messages can be suppressed. When</p>
<p>these messages are suppressed, the ORTI OSA Explorer will substitute the current</p>
<p>values of the registers from the current running task</p>
<p>The easiest way to achieve this is to do nothing. The first time these errors are</p>
<p>printed for a specific register, the ORTI OSA Explorer will remember the problem</p>
<p>and not print the error again for future accesses to the same register. This setting,</p>
<p>however, is not remembered across sessions.</p>
<p>Alternatively, the user can instruct the ORTI OSA Explorer to substitute the values</p>
<p>of all missing registers with the values those registers have on the target. This can</p>
<p>be done temporarily by issuing this command:</p>
<p>osacmd set suppress_context_errors</p>
<p>Or it can be done permanently by recompiling the ORTI file with the<b> -m</b> option, as</p>
<p>suggested by the original error message produced by<b> ccorti</b>.</p>
<p>Updating the ORTI Information Dynamically</p>
<p>The user can instruct the ORTI OSA Explorer on how to find the missing register</p>
<p>by using the<b> mapregloc</b> command. Please see the documentation for this command</p>
<p>in the ORTI OSA Explorer Reference.</p>
<p>To preserve these settings across a session, the ORTI file can be re-compiled with</p>
<p>the appropriate<b> --cmd</b> options to<b> ccorti</b>. Please see the<b> ccorti</b> Reference for details</p>
<p>on this option.</p>
<p><b>Missing ORTI File</b></p>
<p>Target: Could not open file C:/svn/orti/sample.orti: No such file or directory</p>
<p>Target: Failed to execute command &quot;load_orti &quot;C:/svn/orti/sample.orti&quot;&quot; in orti OSA.</p>
<p>This error is given when the<b> .osa</b> file references an ORTI file that does not exist.</p>
<p>The<b> .osa</b> file should be edited, and the</p>
<p>OSA_CONFIG:OSA_INIT_COMMAND:load_orti</p>
<p>line updated to point to the proper</p>
<p>location of the ORTI file used to create the<b> .osa</b> file. On Windows, the</p>
<p>\</p>
<p>path</p>
<p><i>653</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ORTI Troubleshooting</i></p>
<h1 style="page-break-before:always; "></h1>
<p>delimiter must be escaped. Alternatively, the forward slash (/) character may be</p>
<p>used.</p>
<p><b>Other Issues</b></p>
<p>If you have questions or problems not addressed by the documentation herein, and</p>
<p>are under maintenance for this product, please contact Green Hills Software's</p>
<p>technical support for further assistance.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>654</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The protrans Utility</b></p>
<p><b>Note</b></p>
<p>This information is only relevant if you are profiling a run-mode task or</p>
<p>AddressSpace on an INTEGRITY target, or if you are profiling a</p>
<p>stand-alone program.</p>
<p>Running<b> protrans</b> separately is useful when you want to automate the acquisition</p>
<p>of large amounts of profiling data and then use the<b> Profile</b> window to display the</p>
<p>data once all the executions are complete. Normally, when you use MULTI to collect</p>
<p>profiling data, the actions of the<b> protrans</b> utility are transparent to you. This utility</p>
<p>reads the profiling data that is produced when a program is executed, and it can</p>
<p>accumulate profiling data over multiple executions of a program. It then translates</p>
<p>the data into an intermediate format that the<b> Profile</b> window uses when displaying</p>
<p>profiling information.</p>
<p>The information in this section is provided for advanced users who want to run</p>
<p><b>protrans</b> outside of the MULTI environment. To run this utility manually, issue</p>
<p>the following command from a command shell:</p>
<p>protrans<i> options program</i></p>
<p>where</p>
<p><i>options</i></p>
<p>can be any non-conflicting combination of the options described</p>
<p>in the following table.</p>
<p><b>Meaning</b></p>
<p><b>Option</b></p>
<p>Adds the profiling data for the current execution to a summary profile</p>
<p>with a<b> .pro</b> extension. Without this switch, a new profile, which overwrites</p>
<p>the previous profile, is generated with each execution.</p>
<p><b>-a</b></p>
<p>Writes the error messages to a file with the same base name and an<b> .err</b></p>
<p>extension.</p>
<p><b>-e</b></p>
<p>Suppresses message printing. Without this switch,<b> protrans</b> prints a small</p>
<p>message for each execution, describing the type of profiling data found.</p>
<p><b>-q</b></p>
<p>Specifies</p>
<p><i>file</i></p>
<p>as a<b> mon.out</b> file containing call count (but not call graph)</p>
<p>profiling data. You can specify multiple files with multiple uses of this</p>
<p>option.</p>
<p><b>-m<i> file</b></i></p>
<p>Specifies</p>
<p><i>file</i></p>
<p>as a<b> bmon.out</b> file containing coverage analysis profiling</p>
<p>data. You can specify multiple files with multiple uses of this option.</p>
<p><b>-b<i> file</b></i></p>
<p><i>655</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The protrans Utility</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Meaning</b></p>
<p><b>Option</b></p>
<p>Specifies</p>
<p><i>file</i></p>
<p>as a<b> bmon64.out</b> file containing coverage analysis</p>
<p>profiling data containing 64-bit counters. You can specify multiple files</p>
<p>with multiple uses of this option.</p>
<p><b>-b64<i> file</b></i></p>
<p>Specifies output</p>
<p><i>file</i></p>
<p>as a<b> .gpro</b> profile recording that contains debug</p>
<p>information and profile information.</p>
<p><b>-G<i> file</b></i></p>
<p>Specifies</p>
<p><i>file</i></p>
<p>as a raw memory dump of the</p>
<p>.ghcovcz</p>
<p>section</p>
<p>containing coverage counts. You can specify multiple files with multiple</p>
<p>uses of this option.</p>
<p><b>-cc<i> file</b></i></p>
<p>Specifies</p>
<p><i>file</i></p>
<p>as a raw memory dump of the</p>
<p>.ghcovdz</p>
<p>section</p>
<p>containing 64-bit coverage counts. You can specify multiple files with</p>
<p>multiple uses of this option.</p>
<p><b>-cd<i> file</b></i></p>
<p>Specifies</p>
<p><i>file</i></p>
<p>as a raw memory dump of the</p>
<p>.ghcovfz</p>
<p>section</p>
<p>containing coverage flags. You can specify multiple files with multiple</p>
<p>uses of this option.</p>
<p><b>-cf<i> file</b></i></p>
<p>Specifies</p>
<p><i>dir</i></p>
<p>as a directory that contains one or more raw memory dumps</p>
<p>of the</p>
<p>.ghcovcz</p>
<p>section containing coverage counts.</p>
<p><b>-ccdir<i> dir</b></i></p>
<p>Specifies</p>
<p><i>dir</i></p>
<p>as a directory that contains one or more raw memory dumps</p>
<p>of the</p>
<p>.ghcovdz</p>
<p>section containing 64-bit coverage counts.</p>
<p><b>-cddir<i> dir</b></i></p>
<p>Specifies</p>
<p><i>dir</i></p>
<p>as a directory that contains one or more raw memory dumps</p>
<p>of the</p>
<p>.ghcovfz</p>
<p>section containing coverage flags.</p>
<p><b>-cfdir<i> dir</b></i></p>
<p>Specifies</p>
<p><i>file</i></p>
<p>as a<b> .dbp</b> file containing PC samples. The contents of the</p>
<p>file depend on the data collected.</p>
<p><b>-d<i> file</b></i></p>
<p>Specifies the target is big endian. The default endianness is that of the</p>
<p>host.</p>
<p><b>-B</b></p>
<p>Specifies the target is little endian. The default endianness is that of the</p>
<p>host.</p>
<p><b>-L</b></p>
<p>Suppose you have a big endian V850 and RH850 program called<b> dylan</b>, built with</p>
<p>call graph and legacy coverage analysis profiling (<b>-a</b>), and with a collection of</p>
<p>sample input files:<b> sampleinput1</b>,<b> sampleinput2</b>, etc. Now consider the following</p>
<p><b>csh</b> shell script for Linux/Solaris hosts.</p>
<p>#!/bin/csh</p>
<p>foreach p (sampleinput*)</p>
<p>sim850 dylan $p</p>
<p>protrans -a -B -q dylan</p>
<p>end</p>
<p>rm -f gmon.out bmon.out</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>656</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>This script repeatedly runs the<b> dylan</b> program with the sample input using<b> sim850</b>,</p>
<p>and calls the<b> protrans</b> utility to read in the generated profiling data for each</p>
<p>execution. The argument<b> dylan</b> specifies the profiled program for the generated</p>
<p>data (the default is<b> a.out</b>).</p>
<p>After the script finishes, an intermediate profiling data file is generated that contains</p>
<p>the summary profile. The intermediate file has a<b> .pro</b> extension appended to the</p>
<p>program name if it has no extension.</p>
<p>In the preceding example, the file<b> dylan.pro</b> is generated in the same directory</p>
<p>where the shell script is executed.</p>
<p>After you have generated this file, you can process the data in the Debugger. You</p>
<p>can read in the summary profile stored in<b> dylan.pro</b>, and then use the various</p>
<p>features of the<b> Profile</b> window to view the information.</p>
<p>You can also dump the contents of this file using the<b> gdump</b> utility, which will</p>
<p>display the data in an easy-to-read format. For information about the<b> gdump</b> utility,</p>
<p>see âThe gdump Utility Programâ on page 564.</p>
<p>The last line in the preceding script deletes any remaining profiling data files after</p>
<p>executions of the profiled program. By default, the<b> protrans</b> utility looks for the</p>
<p>following files:</p>
<p>â¢</p>
<p><b>mon.out</b> â This file is produced after running a program built for call count</p>
<p>profiling (without call graph support).</p>
<p>â¢</p>
<p><b>gmon.out</b> â This file is produced after running a program built for call count</p>
<p>profiling with call graph support enabled.</p>
<p><b>Note</b></p>
<p>A program can only produce one or the other of<b> mon.out</b> or</p>
<p><b>gmon.out</b>.</p>
<p>â¢</p>
<p><b>bmon.out</b> â This file is produced after running a program built for coverage</p>
<p>analysis. This type of profiling is done alone or in conjunction with either call</p>
<p>count profiling or call count with call graph profiling.</p>
<p>â¢</p>
<p><b>bmon64.out</b> â This file is produced after running a native program built for</p>
<p>coverage analysis with 64-bit counts. This type of profiling is done alone or in</p>
<p><i>657</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The protrans Utility</i></p>
<h1 style="page-break-before:always; "></h1>
<p>conjunction with either call count profiling or call count with call graph</p>
<p>profiling.</p>
<p>For more information about the profiling options that generate these files, see</p>
<p>âObtaining Profiling Informationâ on page 63. Files are not created by default for</p>
<p>the<b> -coverage=</b> option. To get profiling information into a file on your host machine</p>
<p>while using<b> -coverage=</b>, you must dump the relevant memory section from your</p>
<p>target into a file on your host. For more information about these memory sections,</p>
<p>see âEnabling Instrumented Coverage or Performance Profilingâ on page 64. For</p>
<p>information about dumping a memory section, see âBeginning, End, and Size of</p>
<p>Section Symbolsâ on page 503.</p>
<p>You can also specify other specific data files to<b> protrans</b>.</p>
<p>Thus, the shell script example for Linux/Solaris hosts that is given earlier could be</p>
<p>rewritten to:</p>
<p>#!/bin/csh</p>
<p>foreach p (sampleinput*)</p>
<p>sim850 dylan $p</p>
<p>mv gmon.out gmon.$p</p>
<p>mv bmon.out bmon.$p</p>
<p>end</p>
<p>foreach p (sampleinput*)</p>
<p>protrans -a -B -q -g gmon.$p -b bmon.$p dylan</p>
<p>rm -f gmon.$p bmon.$p</p>
<p>end</p>
<p>The first loop runs<b> dylan</b> with the sample input and stores the generated data files</p>
<p>into uniquely named temporary files. The second loop then calls<b> protrans</b> to read</p>
<p>in the data from these files and produces a summary profile. The<b> -g</b> option specifies</p>
<p>a call count with call graph profiling data file, and the<b> -b</b> option specifies a coverage</p>
<p>analysis data file. You can specify multiple files of a single profiling data type with</p>
<p>multiple uses of these options. For example:</p>
<p>protrans -g gmon.1 -g gmon.2 -g gmon.3</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>658</i></p>
<p><i>Chapter 11. Utility Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Part III</b></p>
<p><b>Language Reference</b></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 12</b></p>
<p><b>Green Hills C</b></p>
<p><b>Contents</b></p>
<p>Specifying a C Language Dialect . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>662</p>
<p>ANSI C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>663</p>
<p>Strict ANSI C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>669</p>
<p>GNU C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>670</p>
<p>Strict ISO C99 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>677</p>
<p>ISO C99 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>677</p>
<p>K&amp;R C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>679</p>
<p>Motor Industry Software Reliability Association (MISRA) Rules . . . . . . . . .</p>
<p>684</p>
<p>Japanese Automotive C Extensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>684</p>
<p>Sequence Related Undefined Behavior Checking . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>685</p>
<p>Type Qualifiers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>686</p>
<p>Assignment and Comparisons on struct and union Types . . . . . . . . . . . . . . . .</p>
<p>688</p>
<p>Bitfields . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>688</p>
<p>Enumerated Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>692</p>
<p>Functions with Variable Arguments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>692</p>
<p>The asm Statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>695</p>
<p>The Preprocessor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>697</p>
<p>Extended Characters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>697</p>
<p>Compiler Limitations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>701</p>
<p>C Implementation-Defined Features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>702</p>
<p>Attributes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>718</p>
<h1 style="page-break-before:always; "></h1>
<p>This chapter describes the Green Hills implementation of C, including aspects of</p>
<p>the language particular to our compilers.</p>
<p><b>Specifying a C Language Dialect</b></p>
<p>The Green Hills C Compiler supports several main variants of the C Language.</p>
<p>To specify a C dialect:</p>
<p>Set the<b> C/C++ CompilerâC Language Dialect</b> option to one of the following</p>
<p>settings:</p>
<p>â¢</p>
<p><b>Strict ISO C99</b> (<b>-C99</b>) â Accepts the ISO C99 language without extensions,</p>
<p>as defined by<i> ISO/IEC 9899:1999</i>, including Technical Corrigenda 1, 2, and</p>
<p>3.</p>
<p>â¢</p>
<p><b>ISO C99</b> (<b>-c99</b>) â Accepts the ISO C99 language with extensions (see âISO</p>
<p>C99â on page 677).</p>
<p>â¢</p>
<p><b>Strict ANSI C</b> (<b>-ANSI</b>) â Accepts the ANSI C language without extensions,</p>
<p>as defined by<i> X3.159â1989</i>, including Amendment 1 and Technical</p>
<p>Corrigenda 1 and 2.</p>
<p>â¢</p>
<p><b>ANSI C</b> (<b>-ansi</b>) â [default] Recommended for all new development, and</p>
<p>for the compilation of any existing C code which approximates to ANSI C.</p>
<p>For more information, see âANSI Câ on page 663.</p>
<p>â¢</p>
<p><b>GNU C</b> (<b>-gcc</b>) â Recommended for porting existing GNU code to the Green</p>
<p>Hills development environment. For more information, see âGNU Câ</p>
<p>on page 670.</p>
<p>â¢</p>
<p><b>GNU C99</b> (<b>-gnu99</b>) â Accepts the ISO C99 language along with several</p>
<p>GNU-specific extensions.</p>
<p>â¢</p>
<p><b>K+R C</b> (<b>-k+r</b>) â Support for K&amp;R mode is deprecated and may be removed</p>
<p>in future versions of MULTI. Recommended only for porting existing K&amp;R</p>
<p>code to the Green Hills development environment. For more information,</p>
<p>see âK&amp;R Câ on page 679.</p>
<p>The ANSI C standard can be considered the base of all dialects. Each dialect provides</p>
<p>certain extensions and features in addition to the basic ANSI language, except K&amp;R</p>
<p>C, which omits some features and allows various non-standard constructs. If your</p>
<p>program is written in standard ANSI C, any of the modes except for K&amp;R C should</p>
<p>compile your program correctly with few exceptions. All dialects use the same</p>
<p>library and header files, which provide the complete ISO C99 library. A few header</p>
<p>files and their associated functions are only supported in the ISO C99 dialect. We</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>662</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>strongly recommend that you compile all modules in a particular program using</p>
<p>the same dialect, as a failure to do so could result in obscure failures at link time or</p>
<p>run time.</p>
<p>In addition to supporting the aforementioned primary C dialects, we also provide</p>
<p>support for:</p>
<p>â¢</p>
<p>the Motor Industry Software Reliability Association (MISRA) C rules (see</p>
<p>âMISRA C 2004â on page 187)</p>
<p>â¢</p>
<p>the Japanese Automotive C extensions (see âJapanese Automotive C</p>
<p>Extensionsâ on page 684)</p>
<p><b>ANSI C</b></p>
<p>The ANSI C dialect is the default dialect. We recommend that you use this mode</p>
<p>for all new development, as well as for the compilation of any existing C code that</p>
<p>comes close to ANSI C.</p>
<p>To use this dialect:</p>
<p>Set the<b> C/C++ CompilerâC Language Dialect</b> option to<b> ANSI C</b> (<b>-ansi</b>).</p>
<p>The compiler accepts the ANSI C mode as defined by<i> X3.159â1989</i>, with the</p>
<p>addition of support for numerous extensions. These extensions may be useful, or</p>
<p>even necessary, in certain cases. Some cases which are prohibited by the ANSI</p>
<p>standard generate a warning in this mode.</p>
<p><b>ANSI C Extensions</b></p>
<p>The extensions provided in this mode are as follows:</p>
<p>â¢</p>
<p>Bitfields may have base types that are enumerated or integral types besides</p>
<p>int</p>
<p>and</p>
<p>unsigned int</p>
<p>. This matches A.6.5.8 in the ANSI Common</p>
<p>Extensions appendix.</p>
<p>â¢</p>
<p>Empty source files.</p>
<p><i>663</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ANSI C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>A translation unit (input file) can contain no declarations.</p>
<p>â¢</p>
<p>The last member of a structure may have an incomplete array type. It may not</p>
<p>be the only member of the structure (otherwise, the structure would have zero</p>
<p>size).</p>
<p>â¢</p>
<p>A file-scope array can have an incomplete structure, union, or enumerated type</p>
<p>as its element type. The type must be completed before the array is subscripted</p>
<p>(if it is), and by the end of the compilation if the array is not</p>
<p>extern</p>
<p>.</p>
<p>â¢</p>
<p>enum</p>
<p>tags may be forward-declared; one may define the tag name and resolve</p>
<p>it later (by specifying the brace-enclosed list).</p>
<p>â¢</p>
<p>The values of enumeration constants may be given by expressions that evaluate</p>
<p>to unsigned quantities that fit in the</p>
<p>unsigned int</p>
<p>range, but not in the</p>
<p>int</p>
<p>range. A warning is issued for suspicious cases. For example:</p>
<p>/* when ints are 32 bits: */</p>
<p>enum a { w = -2147483648}; /* No warning */</p>
<p>enum b { x = 0x80000000};</p>
<p>/* No warning */</p>
<p>enum c { y = 0x80000001};</p>
<p>/* No warning */</p>
<p>enum d { z = 2147483649};</p>
<p>/* Warning */</p>
<p>â¢</p>
<p>An extra comma is allowed at the end of an</p>
<p>enum</p>
<p>list.</p>
<p>â¢</p>
<p>A label or</p>
<p>case</p>
<p>label can be immediately followed by a right brace. (Normally,</p>
<p>a statement must follow a label.)</p>
<p>â¢</p>
<p>An initializer expression that is a single value and is used to initialize an entire</p>
<p>static array, structure, or union need not be enclosed in braces. Strict ANSI C</p>
<p>requires the braces. This extension is not allowed in GNU mode.</p>
<p>â¢</p>
<p>In an initializer with a file-scope variable, a pointer constant value may be cast</p>
<p>to an integral type if the integral type is big enough to contain it.</p>
<p>â¢</p>
<p>The address of a variable with</p>
<p>register</p>
<p>storage class can be taken. A warning</p>
<p>is issued.</p>
<p>â¢</p>
<p>In an integral constant expression, an integer constant may be cast to a pointer</p>
<p>type and then back to an integral type.</p>
<p>â¢</p>
<p>long float</p>
<p>is accepted as a synonym for</p>
<p>double</p>
<p>.</p>
<p>â¢</p>
<p>The</p>
<p>long long</p>
<p>and</p>
<p>unsigned long long</p>
<p>types are accepted. Integer</p>
<p>constants suffixed by</p>
<p>LL</p>
<p>are given the type</p>
<p>long long</p>
<p>, and those suffixed by</p>
<p>ULL</p>
<p>are given the type</p>
<p>unsigned long long</p>
<p>(any of the suffix letters may</p>
<p>be written in lowercase).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>664</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Benign redeclarations of</p>
<p>typedef</p>
<p>names are allowed. That is, a</p>
<p>typedef</p>
<p>name may be redeclared in the same scope as long as it is declared with the</p>
<p>same type. A warning is issued.</p>
<p>â¢</p>
<p>Dollar signs (</p>
<p>$</p>
<p>) are accepted in identifiers, even in strict dialects.</p>
<p>â¢</p>
<p>Numbers are scanned according to the syntax for numbers rather than the</p>
<p>pp-number</p>
<p>syntax. Thus,</p>
<p>0x123e+1</p>
<p>is scanned as three tokens instead of one</p>
<p>invalid token.</p>
<p>â¢</p>
<p>Assignment and pointer difference are allowed between pointers to types that</p>
<p>are interchangeable but not identical (for example,</p>
<p>unsigned char *</p>
<p>and</p>
<p>char *</p>
<p>). This includes pointer to same-sized integral types (for example,</p>
<p>typically,</p>
<p>int *</p>
<p>and</p>
<p>long *</p>
<p>). Assignment of a string constant to a pointer to</p>
<p>any kind of character is allowed without a warning.</p>
<p>â¢</p>
<p>Assignment of pointer types is allowed in cases where the destination type has</p>
<p>added type qualifiers that are not at the top level (for example,</p>
<p>int **</p>
<p>to</p>
<p>const int **</p>
<p>). Comparison and pointer difference of such pairs of pointer</p>
<p>types are also allowed. A warning is issued.</p>
<p>â¢</p>
<p>The expressions</p>
<p>p+i</p>
<p>,</p>
<p>p-i</p>
<p>, and</p>
<p>p-q</p>
<p>are allowed when</p>
<p>p</p>
<p>and</p>
<p>q</p>
<p>are of type</p>
<p>void</p>
<p>*</p>
<p>, and behave like the same operations on</p>
<p>char *</p>
<p>.</p>
<p>â¢</p>
<p>Pointers to different function types may be assigned or compared for equality</p>
<p>(</p>
<p>==</p>
<p>) or inequality (</p>
<p>!=</p>
<p>) without an explicit type cast. A warning is issued.</p>
<p>â¢</p>
<p>A pointer to</p>
<p>void</p>
<p>may be implicitly converted to or from a pointer to a function</p>
<p>type.</p>
<p>â¢</p>
<p>The</p>
<p>#assert</p>
<p>preprocessing extensions of AT&amp;T System V Release 4 are</p>
<p>allowed. This feature is deprecated and may be removed in future versions of</p>
<p>MULTI. These allow definition and testing of predicate names. Such names</p>
<p>are in a name space distinct from all other names, including macro names. A</p>
<p>predicate name is given a definition by a preprocessing directive of the form:</p>
<p>#assert name</p>
<p>#assert name(token-sequence)</p>
<p>which defines the predicate<i> name</i>. In the first form, the predicate is not given</p>
<p>a value. In the second form, it is given the value</p>
<p>token-sequence</p>
<p>. Such a</p>
<p>predicate can be tested in a</p>
<p>#if</p>
<p>expression, as follows:</p>
<p>#name(token-sequence)</p>
<p><i>665</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ANSI C Extensions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>which has the value</p>
<p>1</p>
<p>if</p>
<p>#assert</p>
<p>of that</p>
<p>name</p>
<p>with that</p>
<p>token-sequence</p>
<p>has appeared, and</p>
<p>0</p>
<p>otherwise. A given predicate can be given more than one</p>
<p>value at a given time. A predicate may be deleted by a preprocessing directive</p>
<p>of the form:</p>
<p>#unassert name</p>
<p>#unassert name(token-sequence)</p>
<p>The first form removes all definitions of the indicated predicate name; the</p>
<p>second form removes just the indicated definition, leaving any others that might</p>
<p>exist.</p>
<p>â¢</p>
<p>The keyword</p>
<p>asm</p>
<p>is recognized as a synonym for</p>
<p>__asm</p>
<p>. This feature is</p>
<p>disabled in Strict ANSI C mode because it conflicts with the ANSI C Standard</p>
<p>for statements such as:</p>
<p>asm(&quot;xyz&quot;);</p>
<p>ANSI C interprets this syntax as a call of an implicitly defined function</p>
<p>asm</p>
<p>,</p>
<p>which (by default) the compiler interprets as an</p>
<p>asm</p>
<p>statement.</p>
<p>â¢</p>
<p>asm</p>
<p>macros are accepted, and</p>
<p>__asm</p>
<p>is recognized as a synonym for</p>
<p>asm</p>
<p>. An</p>
<p>asm</p>
<p>macro must be declared with no storage class (except</p>
<p>static</p>
<p>) and with</p>
<p>a prototyped parameter list:</p>
<p>asm void f(int a, int b) {</p>
<p>...</p>
<p>}</p>
<p>For more information, see Chapter 18, âEnhanced asm Macro Facility for C</p>
<p>and C++â on page 897.</p>
<p>â¢</p>
<p>An extension is supported to allow constructs similar to C++ anonymous unions.</p>
<p>In addition, anonymous structures are allowedâthat is, their members are</p>
<p>promoted to the scope of the containing structure and looked up in the same</p>
<p>manner as ordinary members.</p>
<p>â¢</p>
<p>An ellipsis can appear as the only thing in a function's parameter list:</p>
<p>void f(...);</p>
<p>â¢</p>
<p>External entities declared in other scopes are visible. A warning is issued. For</p>
<p>example:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>666</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>void f1(void) { extern void f(); }</p>
<p>void f2() { f(); /* Using out of scope declaration */ }</p>
<p>â¢</p>
<p>C99-style comments (using</p>
<p>//</p>
<p>as delimiter) are supported.</p>
<p>â¢</p>
<p>The C99</p>
<p>_Pragma</p>
<p>preprocessing operator is accepted in all dialects.</p>
<p>â¢</p>
<p>A structure that has no named fields, but at least one unnamed field (such as a</p>
<p>zero-length bitfield), is accepted by default. A warning is issued.</p>
<p>â¢</p>
<p>The</p>
<p>#warning</p>
<p>preprocessor directive, similar to</p>
<p>#error</p>
<p>, is supported in all</p>
<p>dialects.</p>
<p>â¢</p>
<p>Attributes, introduced by the keyword</p>
<p>__attribute__</p>
<p>, can be used on</p>
<p>declarations of variables, functions, types, and fields. This extension mimics</p>
<p>the GNU compiler for the attributes that are accepted. For a complete list of</p>
<p>supported attributes, see âAttributesâ on page 718.</p>
<p>â¢</p>
<p>The</p>
<p>externally_visible</p>
<p>attribute expresses that a symbol might be</p>
<p>referenced from outside of the program, and affects Wholeprogram</p>
<p>optimizations. Similarly, you can specify that a symbol is externally visible</p>
<p>using the<b> -external=</b> and<b> -external_file=</b> options (see âOptimization Scopeâ</p>
<p>on page 168), or by using</p>
<p>#pragma ghs start_externally_visible</p>
<p>and</p>
<p>#pragma ghs end_externally_visible</p>
<p>(see âGreen Hills Extension</p>
<p>Pragma Directivesâ on page 799). To learn more about the use of the</p>
<p>externally_visible</p>
<p>attribute, see âWholeprogram Optimizationsâ</p>
<p>on page 341.</p>
<p>â¢</p>
<p>The</p>
<p>__alignof__</p>
<p>keyword is supported. It is similar to</p>
<p>sizeof</p>
<p>, but returns</p>
<p>the alignment requirement value for a type, or</p>
<p>1</p>
<p>if there is no alignment</p>
<p>requirement. It can be followed by a type or expression in parentheses:</p>
<p>__alignof__(type)</p>
<p>__alignof__(expression)</p>
<p>The expression in the second form is not evaluated.</p>
<p>â¢</p>
<p>Preprocessing directive</p>
<p>#import</p>
<p>is supported.</p>
<p>#import &quot;filename&quot;</p>
<p>or</p>
<p>#import &lt;filename&gt;</p>
<p><i>667</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ANSI C Extensions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>causes<i> filename</i> to be included only once. This feature is deprecated and may</p>
<p>be removed in future versions of MULTI.</p>
<p>â¢</p>
<p>The preprocessor directive</p>
<p>#include_next</p>
<p>is deprecated and may be removed</p>
<p>in future versions of MULTI.</p>
<p>â¢</p>
<p>Keyword</p>
<p>__inline__</p>
<p>is supported (see âManual Inlining In Câ on page 325).</p>
<p>â¢</p>
<p>Keyword</p>
<p>__typeof__</p>
<p>is supported. It takes an expression as the argument,</p>
<p>and returns the type of the expression. For instance, the following code:</p>
<p>int i;</p>
<p>__typeof__(i) j;</p>
<p>would declare variables</p>
<p>i</p>
<p>and</p>
<p>j</p>
<p>, both of type</p>
<p>int</p>
<p>.</p>
<p>â¢</p>
<p>The macros</p>
<p>__FUNCTION__</p>
<p>and</p>
<p>__PRETTY_FUNCTION__</p>
<p>are supported. They</p>
<p>expand to the name of the function surrounding them. In C++,</p>
<p>__PRETTY_FUNCTION__</p>
<p>expands to the fully qualified name of the surrounding</p>
<p>function.</p>
<p>â¢</p>
<p>A function can be declared with the</p>
<p>__linkonce</p>
<p>storage class. The compiler</p>
<p>will place the function in a special section whose name begins with</p>
<p>.ghs.linkonce</p>
<p>and whose name encodes the function name. The linker</p>
<p>arbitrarily selects one object file from which to include a link-once section</p>
<p>corresponding to each unique name.</p>
<p>__linkonce</p>
<p>functions cannot be static.</p>
<p>â¢</p>
<p>The language is extended with the</p>
<p>__packed</p>
<p>,</p>
<p>__bytereversed</p>
<p>,</p>
<p>__bigendian</p>
<p>, and</p>
<p>__littleendian</p>
<p>type qualifiers. For more information</p>
<p>about these type qualifiers, see âType Qualifiersâ on page 686</p>
<p>â¢</p>
<p>The C99</p>
<p>_Bool</p>
<p>type is accepted in all dialects.</p>
<p>â¢</p>
<p>C99 digraph tokens, such as</p>
<p>&lt;%</p>
<p>and</p>
<p>%:</p>
<p>, are accepted in all C and C++ dialects.</p>
<p>â¢</p>
<p>As in C99, the C preprocessor treats all integer types as equivalent to</p>
<p>intmax_t</p>
<p>or</p>
<p>uintmax_t</p>
<p>during expression evaluation. For example:</p>
<p>int main()</p>
<p>{</p>
<p>#if 0x80000000*2 != 0</p>
<p>puts(&quot;The preprocessor uses 64-bit arithmetic on most targets&quot;);</p>
<p>#endif</p>
<p>if (0x80000000*2 == 0)</p>
<p>puts(&quot;Normal arithmetic uses 32-bit arithmetic on 32-bit targets&quot;);</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>668</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Strict ANSI C</b></p>
<p><b>-ANSI</b> implements the standard C language that is defined in<i> X3.159â1989</i>. In this</p>
<p>mode, only a few extensions to the standard are permitted (for example,</p>
<p>long</p>
<p>long</p>
<p>) and a number of rules are strictly enforced.</p>
<p>To specify use of this dialect:</p>
<p>Set the<b> C/C++ CompilerâC Language Dialect</b> option to<b> Strict ANSI C</b> (<b>-ANSI</b>).</p>
<p><i>669</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Strict ANSI C</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>GNU C</b></p>
<p>The GNU C dialect provides close compatibility with code written for the GNU</p>
<p>compiler. It accepts all of the ANSI C dialect features, together with a number of</p>
<p>GNU-specific extensions listed below. It is recommended that you use this dialect</p>
<p>only when porting existing GNU-compiled code to the Green Hills development</p>
<p>environment.</p>
<p>To specify use of this dialect:</p>
<p>Set the<b> C/C++ CompilerâC Language Dialect</b> option to<b> GNU C</b> (<b>-gcc</b>).</p>
<p><b>GNU C Only Extensions</b></p>
<p>This dialect enables all the ANSI extensions listed in âANSI C Extensionsâ</p>
<p>on page 663, together with the extensions listed in this section, and those listed in</p>
<p>âGNU C/C++ Extensionsâ on page 673.</p>
<p>â¢</p>
<p>Variable length arrays (VLAs) are supported. GNU C also allows VLA types</p>
<p>for fields of local structures, which can lead to run-time dependent sizes and</p>
<p>offsets. The front end does not implement this, but instead treats such arrays</p>
<p>as having length zero (with a warning); this enables some popular programming</p>
<p>idioms involving fields with VLA types.</p>
<p>void f(int n)</p>
<p>{</p>
<p>struct {</p>
<p>int a[n]; /* Warning: variable-length array field type will be</p>
<p>treated as zero-length array field type */</p>
<p>};</p>
<p>}</p>
<p>â¢</p>
<p>A nonconstant may appear in the initializer list of an aggregate variable with</p>
<p>automatic storage class.</p>
<p>â¢</p>
<p>You can use GNU C-style inlining by using the keywords</p>
<p>inline</p>
<p>or</p>
<p>__inline__</p>
<p>. For more information about inlining functions manually, see</p>
<p>âManual Inliningâ on page 325.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>670</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Structs and unions without fields are accepted. They have size zero. Class types</p>
<p>containing only fields of size zero (zero-length bitfields, zero-length arrays,</p>
<p>and class types of size zero) also have size zero.</p>
<p>â¢</p>
<p>In conditional expressions, the middle operand can be left out. When that is</p>
<p>the case, the result of the expression is the value of the first operand if that first</p>
<p>operand is âtrueâ.</p>
<p>x = x ?: -1; /* If x is zero, evaluates to -1; otherwise, just x */</p>
<p>â¢</p>
<p>Old-style definitions with unpromoted parameter types can follow prototype</p>
<p>declarations with those same types.</p>
<p>void f(short);</p>
<p>// Prototype</p>
<p>void f() short p; {} // Old-style definition OK</p>
<p>â¢</p>
<p>An unprototyped declaration can follow a prototyped declaration. After such</p>
<p>a redeclaration the original prototype is ignored. A warning is issued.</p>
<p>void f(char);</p>
<p>// Original prototype</p>
<p>void f();</p>
<p>// Unprototyped redeclaration</p>
<p>void f(double x) {} // Accepted in GNU C mode</p>
<p>// (original prototype ignored)</p>
<p>â¢</p>
<p><b>GNU 3.3 ONLY</b> Certain âgeneralized lvaluesâ are supported. The ternary</p>
<p>conditional operator produces an lvalue if its second and third operand are</p>
<p>lvalues of the same type. Similarly, the comma operator produces an lvalue if</p>
<p>its second operand is an lvalue. Some casts also preserve the lvalueness of their</p>
<p>operand. For example:</p>
<p>unsigned x, y, z;</p>
<p>(x ? y : z) = 4; // Updates y or z depending on x (GNU 3.3 only)</p>
<p>(x += y, y) = 3; // Updates y (allowed in all non-strict modes)</p>
<p>(int)x = -1;</p>
<p>// Updates x (warning in all non-strict modes))</p>
<p>A â</p>
<p>?</p>
<p>â operator can also be treated as an lvalue if its operands have types that</p>
<p>are different but are close enough that an lvalue cast can bridge the gap (for</p>
<p>example,</p>
<p>int</p>
<p>and</p>
<p>int *</p>
<p>). A warning is issued.</p>
<p>â¢</p>
<p>An expression can be cast to a union type containing a field with the type of</p>
<p>that expression. For example:</p>
<p><i>671</i></p>
<p><i>Green Hills Software</i></p>
<p><i>GNU C Only Extensions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>union X { int i; char c; };</p>
<p>union X f(int i) { return (union X)i; }</p>
<p>â¢</p>
<p>Implicit conversions are allowed between integral and pointer types, and</p>
<p>between incompatible pointer types, with a warning. Implicit conversions</p>
<p>between pointer types can drop cv-qualifiers (for example,</p>
<p>const char *</p>
<p>to</p>
<p>char *</p>
<p>).</p>
<p>â¢</p>
<p>Pointer arithmetic applies to</p>
<p>void</p>
<p>pointers and function pointers as if they</p>
<p>were</p>
<p>char *</p>
<p>.</p>
<p>â¢</p>
<p>Explicit casts to struct and union types are allowed if they are do-nothing casts,</p>
<p>that is, if the source type is the same as the destination type. (cv-qualifier</p>
<p>differences are allowed but ignored.) The result is an lvalue if the source is an</p>
<p>lvalue.</p>
<p>â¢</p>
<p>Functions with return type</p>
<p>void</p>
<p>can have return expressions. A warning is</p>
<p>issued if the return expression does not have type</p>
<p>void</p>
<p>.</p>
<p>â¢</p>
<p><b>GNU 3.3 ONLY</b> Bitfield lengths that are too large for the associated type are</p>
<p>ignored with a warning (that is, the field becomes an ordinary field whose</p>
<p>address can be taken). For example:</p>
<p>struct S {</p>
<p>char c: 9; // Oversized bitfield becomes regular field of type char</p>
<p>};</p>
<p>// (assuming a char can hold at most 8 bits)</p>
<p>â¢</p>
<p><b>GNU 3.3 ONLY</b> Casts on an lvalue that do not fall under the usual âlvalue</p>
<p>castâ interpretation (for example, because they cast to a type having a different</p>
<p>size) are ignored, and the operand remains an lvalue. A warning is issued.</p>
<p>int i;</p>
<p>(short)i = 0; // Accepted,cast is ignored; entire int is set</p>
<p>â¢</p>
<p>â</p>
<p>?</p>
<p>â operators with mixed void/non-void operands in the second and third</p>
<p>operands are accepted. The result has type</p>
<p>void</p>
<p>.</p>
<p>â¢</p>
<p><b>GNU 3.3 ONLY</b> In function definitions, local declarations can hide parameters.</p>
<p>void f(int x) {</p>
<p>double x; // Accepted in GNU C mode (with a warning).</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>672</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>An old-style parameter list can be followed by an ellipsis to indicate that the</p>
<p>function accepts variable-length argument lists.</p>
<p>void f(x) int x; ... {} // Accepted in GNU C mode</p>
<p><b>GNU C/C++ Extensions</b></p>
<p>The extensions listed in this section are enabled when GNU C or GNU C++ is</p>
<p>selected. See also âGNU C Only Extensionsâ on page 670 and âGNU C++</p>
<p>Extensionsâ on page 743.</p>
<p>â¢</p>
<p>A function can be declared</p>
<p>inline</p>
<p>. It denotes that the inliner should attempt</p>
<p>to inline calls to the function. The keyword</p>
<p>inline</p>
<p>is ignored (with a warning)</p>
<p>on variable declarations and on block-</p>
<p>extern</p>
<p>function declarations.</p>
<p>â¢</p>
<p>Keyword</p>
<p>typeof</p>
<p>is supported. It behaves exactly like</p>
<p>__typeof__</p>
<p>. For more</p>
<p>information, see âANSI C Extensionsâ on page 663.</p>
<p>â¢</p>
<p>Implicit conversion of pointer types with the source type having a more qualified</p>
<p>base type is allowed with a warning. Hence, only a warning is issued in the</p>
<p>following case:</p>
<p>const char *s;</p>
<p>char</p>
<p>*p;</p>
<p>/* ... */</p>
<p>p = s;</p>
<p>/* error in ANSI, warning with GNU */</p>
<p>â¢</p>
<p>Compound literals are accepted. In addition to the features of C99 compound</p>
<p>literals, GNU C mode also allows such literals to be used to initialize variables</p>
<p>in file scope (if they only involve constant-expressions) and to initialize</p>
<p>elements of aggregate types in brace-enclosed aggregate initializers.</p>
<p>â¢</p>
<p>The</p>
<p>__extension__</p>
<p>keyword is accepted preceding declarations and certain</p>
<p>expressions. It has no effect on the meaning of a program:</p>
<p>__extension__ __inline__ int f(int a) {</p>
<p>return a &gt; 0 ? a/2 : f(__extension__ 1-a); }</p>
<p>â¢</p>
<p>Zero-length array types are supported. These are complete types of size zero.</p>
<p>â¢</p>
<p>C99-style flexible array members are accepted. In GNU C++ mode, flexible</p>
<p>array members are treated exactly like zero-length arrays.</p>
<p><i>673</i></p>
<p><i>Green Hills Software</i></p>
<p><i>GNU C/C++ Extensions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>The</p>
<p>sizeof</p>
<p>operator is applicable to</p>
<p>void</p>
<p>and to function types and evaluates</p>
<p>to the value</p>
<p>1</p>
<p>.</p>
<p>â¢</p>
<p>The âassembler nameâ of variables and routines can be specified. For example:</p>
<p>int counter __asm__(&quot;counter_v1&quot;) = 0;</p>
<p>Assembler names containing whitespace, non-identifier characters such as</p>
<p>$</p>
<p>or</p>
<p>@</p>
<p>, leading periods (</p>
<p>.</p>
<p>), or leading underscores (</p>
<p>_</p>
<p>) may not behave as expected.</p>
<p>â¢</p>
<p>Excess aggregate initializers are ignored with a warning.</p>
<p>struct S { int a, b; };</p>
<p>struct S a1 = { 1, 2, 3 }; // &quot;3&quot; ignored with a warning; no error</p>
<p>int a2[2] = { 7, 8, 9 };</p>
<p>// &quot;9&quot; ignored with a warning; no error</p>
<p>â¢</p>
<p>The</p>
<p>__restrict__</p>
<p>keyword is accepted. It is identical to the C99</p>
<p>restrict</p>
<p>keyword, except for its spelling.</p>
<p>â¢</p>
<p>Extended variadic macros are supported.</p>
<p>â¢</p>
<p>C99 hexadecimal floating point constants are recognized.</p>
<p>â¢</p>
<p>The</p>
<p>\e</p>
<p>escape sequence is recognized and stands for the ASCII â</p>
<p>ESC</p>
<p>â character.</p>
<p>â¢</p>
<p>The address of a statement label can be taken by use of the prefix â</p>
<p>&amp;&amp;</p>
<p>â operator,</p>
<p>for example,</p>
<p>void *a = &amp;&amp;L</p>
<p>. A transfer to the address of a label can be done</p>
<p>by the â</p>
<p>goto *</p>
<p>â statement, for example,</p>
<p>goto *a</p>
<p>.</p>
<p>â¢</p>
<p>The last line of an include file can end with a backslash.</p>
<p>â¢</p>
<p>Case ranges are supported. For example:</p>
<p>case 'a'...'z'</p>
<p>â¢</p>
<p>A large number of special functions of the form</p>
<p>__builtin_xyz</p>
<p>(for example,</p>
<p>__builtin_alloca</p>
<p>) are predeclared.</p>
<p>â¢</p>
<p>Some expressions are considered to be constant-expressions even though they</p>
<p>are not so considered in standard C and C++. For example:</p>
<p>â</p>
<p>((char *)&amp;((struct S *)0)-&gt;c[0]) - (char *)0</p>
<p>â</p>
<p>(int)&quot;Hello&quot; &amp; 0</p>
<p>â¢</p>
<p>The macro</p>
<p>__GNUC__</p>
<p>is predefined to the major version number of the emulated</p>
<p>GNU compiler. Similarly, the macro</p>
<p>__GNUC_MINOR__</p>
<p>is predefined to the</p>
<p>corresponding minor version number. Finally,</p>
<p>__VERSION__</p>
<p>is predefined to</p>
<p>a string describing the compiler version.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>674</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Nonstandard casts are allowed in null pointer constants. For example, the</p>
<p>following is considered a null pointer constant in spite of the pointer cast in</p>
<p>the middle:</p>
<p>(int)(int *)0</p>
<p>â¢</p>
<p>Either the</p>
<p>__GNUC_STDC_INLINE__</p>
<p>macro or the</p>
<p>__GNUC_GNU_INLINE__</p>
<p>macro will be predefined, depending on the style of inlining in use by the</p>
<p>compiler.</p>
<p>â¢</p>
<p>Statement expressions such as</p>
<p>({int j; j = f(); j;})</p>
<p>are accepted.</p>
<p>Branches into a statement expression are not allowed. In C++ mode, branches</p>
<p>out are also not allowed. Variable-length arrays, destructible entities, try, catch,</p>
<p>local non-POD class definitions, and dynamically initialized local static</p>
<p>variables are not allowed inside a statement expression.</p>
<p>â¢</p>
<p>Labels can be declared to be local in statement expressions by introducing them</p>
<p>with a</p>
<p>__label__</p>
<p>declaration.</p>
<p>({ __label__ lab; int i = 4; lab: i = 2*i-1; if (!(i%17)) goto lab; i; })</p>
<p>â¢</p>
<p>The C99 predefined identifier</p>
<p>__func__</p>
<p>is recognized.</p>
<p>The following GNU extensions are not currently supported in any GNU mode:</p>
<p>â¢</p>
<p>GNU-style complex numbers (including complex literals).</p>
<p>â¢</p>
<p>Nested functions.</p>
<p>â¢</p>
<p>The</p>
<p>decltype</p>
<p>keyword</p>
<p>â¢</p>
<p>Type trait helpers (</p>
<p>is_enum()</p>
<p>,</p>
<p>is_array()</p>
<p>, etc.)</p>
<p>â¢</p>
<p>Binary literals</p>
<p><b>Differences Between GNU Mode and the GNU Compiler</b></p>
<p>Signedness of Bitfields</p>
<p>The Green Hills compiler differs from the GNU compiler in the treatment of bitfields</p>
<p>without an explicit signed or unsigned qualifier. The Green Hills compiler defaults</p>
<p>to determining the signedness of such bitfields on a per processor family basis. This</p>
<p>is in contrast to the GNU compiler, which always defaults to using signed bitfields.</p>
<p><i>675</i></p>
<p><i>Green Hills Software</i></p>
<p><i>GNU C/C++ Extensions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Further, the Green Hills compiler also has a special case for the signedness of</p>
<p>single-bit bitfields; the GNU compiler has no such special case. For more</p>
<p>information, see âSignedness of Bitfieldsâ on page 689.</p>
<p>Default Behavior of the GNU/C99 Dialects</p>
<p>The GNU compiler's default behavior of the inline keyword in its</p>
<p>-std={c99,gnu99}</p>
<p>modes is version-dependent. Newer GNU compilers default</p>
<p>to using ISO C99 semantics for the inline keyword in these modes while older GNU</p>
<p>compilers default to using GNU89 semantics for the inline keyword. The Green</p>
<p>Hills compiler, when in the<b> -gnu99</b> dialect, always defaults to using ISO C99</p>
<p>semantics for the inline keyword, regardless of which GNU version is being</p>
<p>emulated. To change the inline semantics used in the<b> -gnu99</b> dialect, see â-gnu99</p>
<p>Inline Semanticsâ on page 309.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>676</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Strict ISO C99</b></p>
<p>The Green Hills compiler and libraries fully support the ISO C99 standard, which</p>
<p>introduced numerous features in both the language and libraries. Previous releases</p>
<p>of the Green Hills compiler and library included some features of ISO C99 as</p>
<p>extensions to ANSI C (in the<b> -ansi</b> dialect), but now the complete language and</p>
<p>libraries are also provided as a separate dialect.</p>
<p>To use the Strict ISO C99 dialect:</p>
<p>Set the<b> C/C++ CompilerâC Language Dialect</b> option to<b> Strict ISO C99</b> (<b>-C99</b>).</p>
<p><b>ISO C99</b></p>
<p>The ISO C99 dialect provides all of the features of the language defined by<i> ISO/IEC</i></p>
<p><i>9899:1999</i>, in addition to several useful extensions. This mode is recommended</p>
<p>when developing projects that can benefit from the more precise definition of the</p>
<p>language and extended features provided by C99. For a complete description of the</p>
<p>ISO C99 language, see the<i> ISO/IEC 9899:1999</i> standard.</p>
<p>To use the ISO C99 dialect:</p>
<p>Set the<b> C/C++ CompilerâC Language Dialect</b> option to<b> ISO C99</b> (<b>-c99</b>).</p>
<p>In a few cases, the exact definition of a feature in the ISO C99 standard is different</p>
<p>from the existing Green Hills implementation.</p>
<p>Features that are supported in C99 mode but not in ANSI mode:</p>
<p>â¢</p>
<p>Complex types and<b> complex.h</b>.</p>
<p>â¢</p>
<p>Hexadecimal floating point constants.</p>
<p>â¢</p>
<p>The</p>
<p>restrict</p>
<p>keyword.</p>
<p>â¢</p>
<p>Type-generic macros and<b> tgmath.h</b></p>
<p><i>677</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Strict ISO C99</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Declarations after statements in a function or block, as in C++.</p>
<p>â¢</p>
<p>Declaration of variables in the header of a</p>
<p>for</p>
<p>loop, as in C++.</p>
<p>â¢</p>
<p>Non-constant initializers for automatic arrays, structures, and unions.</p>
<p>â¢</p>
<p>static</p>
<p>in parameter array declarators.</p>
<p>â¢</p>
<p>Universal character names (UCNs) designated with</p>
<p>\u</p>
<p>or</p>
<p>\U</p>
<p>.</p>
<p><b>Preprocessor Support in C99 Mode</b></p>
<p>Preprocessor features that are only supported in C99 mode:</p>
<p>â¢</p>
<p>The macro</p>
<p>__STDC_VERSION__</p>
<p>has the value</p>
<p>199901L</p>
<p>(in other modes the</p>
<p>macro has the value</p>
<p>199409L</p>
<p>).</p>
<p>â¢</p>
<p>#pragma STDC FP_CONTRACT</p>
<p>and</p>
<p>#pragma STDC FENV_ACCESS</p>
<p>.</p>
<p>â¢</p>
<p>__func__</p>
<p>predefined identifier.</p>
<p>â¢</p>
<p>The macros</p>
<p>__STDC_IEC_559__</p>
<p>,</p>
<p>__STDC_IEC_559_COMPLEX__</p>
<p>, and</p>
<p>__STDC_ISO_10646__</p>
<p>are undefined, which indicates that the implementation</p>
<p>does not conform to the IEC-559 standard for floating point or the ISO-10646</p>
<p>standard for</p>
<p>wchar_t</p>
<p>.</p>
<p><b>Enforced Requirements in C99 Mode</b></p>
<p>Requirements that are enforced in C99 mode:</p>
<p>â¢</p>
<p>Functions must be declared before use, although the prototype form is not</p>
<p>required.</p>
<p>â¢</p>
<p>Return statements must return a value if the function is non-void, and cannot</p>
<p>return a value if the function is void.</p>
<p><b>Differences Between C99 Mode and ANSI C Mode</b></p>
<p>When using C99 mode, the following features differ from ANSI C mode:</p>
<p>â¢</p>
<p>Large integer constants promote differently unless designated as</p>
<p>unsigned</p>
<p>or</p>
<p>long long</p>
<p>by using suffixes such as<b> U</b> or<b> LL</b>.</p>
<p>â¢</p>
<p>Many of the extensions accepted in</p>
<p>-ansi</p>
<p>are not accepted in</p>
<p>-c99</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>678</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>K&amp;R C</b></p>
<p>Support for K&amp;R C is deprecated and may be removed in future versions of MULTI.</p>
<p>K&amp;R is the classic dialect of C in which UNIX was originally written. The first</p>
<p>edition of<i> The C Programming Language</i> by Kernighan and Ritchie describes the</p>
<p>K&amp;R dialect. The most important implementation of this dialect was the<i> Portable</i></p>
<p><i>C Compiler</i> (PCC). Although this dialect has important historical significance and</p>
<p>might be necessary for compiling legacy applications, it is recommended that</p>
<p>wherever possible, applications should be converted to one of the newer modes of</p>
<p>the C language.</p>
<p>To specify use of this dialect:</p>
<p>Set the<b> C/C++ CompilerâC Language Dialect</b> option to<b> K+R C</b> (<b>-k+r</b>).</p>
<p>The following is a list of incompatibilities between the Green Hills K&amp;R Mode and</p>
<p>PCC:</p>
<p>â¢</p>
<p>Token pasting is not performed outside of macro expansions when only a</p>
<p>comment separates two tokens. For example,</p>
<p>a/**/b</p>
<p>is not considered to be</p>
<p>ab</p>
<p>. The PCC behavior in that case can be achieved by preprocessing to a text</p>
<p>file and then compiling that file.</p>
<p>Note that</p>
<p>/**/</p>
<p>may be used to concatenate two strings in macro definitions.</p>
<p>â¢</p>
<p>PCC considers the result of a</p>
<p>? :</p>
<p>operator to be an lvalue if the first operand</p>
<p>is constant and the second and third operands are compatible lvalues. The Green</p>
<p>Hills compilers do not.</p>
<p>â¢</p>
<p>PCC incorrectly parses the third operand of a</p>
<p>? :</p>
<p>operator in a way that some</p>
<p>programs exploit. For example:</p>
<p>i ? j : k += l</p>
<p>is parsed by PCC as</p>
<p>i ? j : (k += l)</p>
<p><i>679</i></p>
<p><i>Green Hills Software</i></p>
<p><i>K&amp;R C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>which is incorrect, since the precedence of</p>
<p>+=</p>
<p>is lower than the precedence of</p>
<p>? :</p>
<p>. The compiler will generate an error for that case.</p>
<p>The following section lists K&amp;R Mode extensions to K&amp;R C.</p>
<p><b>K&amp;R Mode Extensions to K&amp;R C</b></p>
<p>â¢</p>
<p>the</p>
<p>void</p>
<p>keyword</p>
<p>â¢</p>
<p>enum</p>
<p>types</p>
<p>â¢</p>
<p>the predefined macro names</p>
<p>__LINE__</p>
<p>,</p>
<p>__FILE__</p>
<p>,</p>
<p>__TIME__</p>
<p>, and</p>
<p>__DATE__</p>
<p>â¢</p>
<p>#error</p>
<p>,</p>
<p>#ident</p>
<p>,</p>
<p>#elif</p>
<p>,</p>
<p>#defined(<i>id</i>)</p>
<p>preprocessor directives</p>
<p>â¢</p>
<p>functions that return</p>
<p>struct</p>
<p>types</p>
<p>â¢</p>
<p>asm(<i>str</i>)</p>
<p>statements</p>
<p>â¢</p>
<p>initialized</p>
<p>extern</p>
<p>variables</p>
<p>â¢</p>
<p>initialized variables of</p>
<p>union</p>
<p>types</p>
<p>â¢</p>
<p>initialized automatic variables of</p>
<p>struct</p>
<p>and array types</p>
<p>â¢</p>
<p>keywords</p>
<p>const</p>
<p>,</p>
<p>signed</p>
<p>, and</p>
<p>volatile</p>
<p>are recognized</p>
<p>â¢</p>
<p>Declarations of the form</p>
<p>typedef some-type void;</p>
<p>are ignored.</p>
<p>â¢</p>
<p>Assignment is allowed between pointers and integers, and between incompatible</p>
<p>pointer types, without an explicit cast. A warning is issued.</p>
<p>â¢</p>
<p>A field selection of the form</p>
<p>p-&gt;field</p>
<p>is allowed if</p>
<p>p</p>
<p>does not point to a</p>
<p>structure or union that contains</p>
<p>field</p>
<p>.</p>
<p>p</p>
<p>must be a pointer or an integer.</p>
<p>Likewise,</p>
<p>x.field</p>
<p>is allowed even if</p>
<p>x</p>
<p>is not a structure or union that contains</p>
<p>field</p>
<p>.</p>
<p>x</p>
<p>must be an lvalue. For both cases, all definitions of</p>
<p>field</p>
<p>as a field</p>
<p>must have the same offset within their structure or union.</p>
<p>â¢</p>
<p>Overflows detected while folding signed integer operations on constants cause</p>
<p>warnings rather than errors.</p>
<p>â¢</p>
<p>A warning will be issued for an</p>
<p>&amp;</p>
<p>applied to an array. The type of such an</p>
<p>operation is âaddress of array elementâ rather than âaddress of arrayâ.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>680</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>For the shift operators</p>
<p>&lt;&lt;</p>
<p>and</p>
<p>&gt;&gt;</p>
<p>, the usual arithmetic conversions are done,</p>
<p>the right operand is converted to</p>
<p>int</p>
<p>, and the result type is the type of the left</p>
<p>operand. In ANSI C, the integral promotions are done on the two operands,</p>
<p>and the result type is the type of the left operand. The effect of this difference</p>
<p>is that, in K&amp;R mode, a</p>
<p>long</p>
<p>shift count will force the shift to be done as</p>
<p>long</p>
<p>.</p>
<p>â¢</p>
<p>When preprocessing output is generated, the line-identifying directives will</p>
<p>have the K&amp;R form instead of the ANSI form.</p>
<p>â¢</p>
<p>sizeof</p>
<p>may be applied to bitfields; the size is that of the underlying type (for</p>
<p>example,</p>
<p>unsigned int</p>
<p>).</p>
<p>â¢</p>
<p>lvalues cast to a type of the same size remain lvalues, except when they involve</p>
<p>a floating-point conversion.</p>
<p>â¢</p>
<p>When a function parameter list begins with a</p>
<p>typedef</p>
<p>identifier, the parameter</p>
<p>list is considered prototyped only if the</p>
<p>typedef</p>
<p>identifier is followed by</p>
<p>something other than a comma or right parenthesis:</p>
<p>typedef int t;</p>
<p>int f(t) {}</p>
<p>/* Old-style list */</p>
<p>int g(t x) {}</p>
<p>/* Prototyped list, parameter x of type t */</p>
<p>That is, function parameters are allowed to have the same names as</p>
<p>typedef</p>
<p>identifiers. In the normal ANSI mode, any parameter list that begins with a</p>
<p>typedef</p>
<p>identifier is considered prototyped, so the first example above would</p>
<p>give an error.</p>
<p>â¢</p>
<p>The names of functions and of external variables are always entered at the file</p>
<p>scope.</p>
<p>â¢</p>
<p>A function declared</p>
<p>static</p>
<p>, used, and never defined is treated as if its storage</p>
<p>class were</p>
<p>extern</p>
<p>.</p>
<p>â¢</p>
<p>A file-scope array that has an unspecified storage class and remains incomplete</p>
<p>at the end of the compilation will be treated as if its storage class is</p>
<p>extern</p>
<p>(in ANSI mode, the number of elements is changed to 1, and the storage class</p>
<p>remains unspecified).</p>
<p>â¢</p>
<p>The empty declaration:</p>
<p>struct x;</p>
<p>will not hide an outer-scope declaration of the same tag.</p>
<p><i>681</i></p>
<p><i>Green Hills Software</i></p>
<p><i>K&amp;R Mode Extensions to K&amp;R C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>In a declaration of a member of a structure or union, no diagnostic is issued</p>
<p>for omitting the declarator list; nevertheless, such a declaration has no effect</p>
<p>on the layout. For example:</p>
<p>struct s {</p>
<p>char a;</p>
<p>int;</p>
<p>char b[2];</p>
<p>} v;</p>
<p>/* sizeof(v) is 3 */</p>
<p>â¢</p>
<p>short</p>
<p>,</p>
<p>long</p>
<p>, and</p>
<p>unsigned</p>
<p>are treated as âadjectivesâ in type specifiers, and</p>
<p>they may be used to modify a</p>
<p>typedef</p>
<p>type.</p>
<p>â¢</p>
<p>A âplainâ</p>
<p>char</p>
<p>is considered to be the same as either</p>
<p>signed char</p>
<p>or</p>
<p>unsigned char</p>
<p>, depending on the target and command line options. In ANSI</p>
<p>C, âplainâ</p>
<p>char</p>
<p>is a third type distinct from both</p>
<p>signed char</p>
<p>and</p>
<p>unsigned</p>
<p>char</p>
<p>.</p>
<p>â¢</p>
<p>Free-standing tag declarations are allowed in the parameter declaration list for</p>
<p>a function with old-style parameters.</p>
<p>â¢</p>
<p>Declaration specifiers are allowed to be completely omitted in declarations</p>
<p>(ANSI C allows this only for function declarations). Thus,</p>
<p>i;</p>
<p>declares</p>
<p>i</p>
<p>as an</p>
<p>int</p>
<p>variable. A warning is issued.</p>
<p>â¢</p>
<p>All</p>
<p>float</p>
<p>operations are done as</p>
<p>double</p>
<p>.</p>
<p>â¢</p>
<p>__STDC__</p>
<p>is left undefined.</p>
<p>â¢</p>
<p>Extra spaces to prevent the pasting of easily confused adjacent tokens are not</p>
<p>generated in textual preprocessing output.</p>
<p>â¢</p>
<p>The first directory searched for include files is the directory containing the file</p>
<p>containing the</p>
<p>#include</p>
<p>instead of the directory containing the primary source</p>
<p>file.</p>
<p>â¢</p>
<p>Trigraphs are not recognized.</p>
<p>â¢</p>
<p>Comments are deleted entirely (instead of being replaced by one space) in</p>
<p>preprocessing output.</p>
<p>â¢</p>
<p>0x</p>
<p>is accepted as a hexadecimal value</p>
<p>0</p>
<p>, with a warning.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>682</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>1E+</p>
<p>is accepted as a floating-point constant with an exponent of</p>
<p>0</p>
<p>, and a</p>
<p>warning is emitted.</p>
<p>â¢</p>
<p>The compound assignment operators may be written as two tokens (for example,</p>
<p>+=</p>
<p>may be written as</p>
<p>+ =</p>
<p>).</p>
<p>â¢</p>
<p>The digits 8 and 9 are allowed in octal constants.</p>
<p>â¢</p>
<p>A warning, rather than an error, is issued for integer constants that are larger</p>
<p>than can be accommodated in the largest unsigned integer type. The value is</p>
<p>truncated to an acceptable number of low-order bits.</p>
<p>â¢</p>
<p>The types of large integer constants are determined according to the K&amp;R rules</p>
<p>(they will not be</p>
<p>unsigned</p>
<p>in some cases where ANSI C would define them</p>
<p>that way). Integer constants with apparent values larger than</p>
<p>LONG_MAX</p>
<p>are</p>
<p>typed as</p>
<p>long</p>
<p>and are also marked as ânon-arithmeticâ, which suppresses some</p>
<p>warnings when using them.</p>
<p>â¢</p>
<p>The escape</p>
<p>\a</p>
<p>(alert) is not recognized in character and string constants.</p>
<p>â¢</p>
<p>Macro expansion is performed differently. Arguments to macros are not</p>
<p>macro-expanded before being inserted into the expansion of the macro. Any</p>
<p>macro invocations in the argument text are expanded when the macro expansion</p>
<p>is rescanned. With this method, macro recursion is both possible and checked</p>
<p>for.</p>
<p>â¢</p>
<p>Token pasting inside macro expansions is performed differently. End-of-token</p>
<p>markers are not maintained, so tokens that abut after macro substitution may</p>
<p>be parsed as a single token.</p>
<p>â¢</p>
<p>Macro parameter names inside character and string constants are recognized</p>
<p>and appropriately substituted.</p>
<p>â¢</p>
<p>Macro invocations having too many arguments are flagged with a warning</p>
<p>rather than an error. The extra arguments are ignored.</p>
<p>â¢</p>
<p>Macro invocations having too few arguments are flagged with a warning rather</p>
<p>than an error. A null string is used as the value of the missing parameters.</p>
<p>â¢</p>
<p>Extra</p>
<p>#else</p>
<p>statements (after the first has appeared in an</p>
<p>#if</p>
<p>block) are</p>
<p>ignored, and a warning is emitted.</p>
<p>â¢</p>
<p>The promotion rules for integers are different;</p>
<p>unsigned char</p>
<p>and</p>
<p>unsigned</p>
<p>short</p>
<p>are promoted to</p>
<p>unsigned int</p>
<p>.</p>
<p>â¢</p>
<p>An identifier in a function is allowed to have the same name as a parameter of</p>
<p>the function. A warning is issued.</p>
<p><i>683</i></p>
<p><i>Green Hills Software</i></p>
<p><i>K&amp;R Mode Extensions to K&amp;R C</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Motor Industry Software Reliability Association (MISRA) Rules</b></p>
<p>We provide support for the Motor Industry Software Reliability Association</p>
<p>(MISRA) rules. For more information, see âMISRA C 2004â on page 187.</p>
<p><b>Japanese Automotive C Extensions</b></p>
<p>We provide support for the Japanese Automotive C extensions to ANSI C, which</p>
<p>are used by Japanese automobile manufacturers. For complete specifications, refer</p>
<p>to the<i> C-Language Specification for Automotive Control (Proposal)</i> by Toyota</p>
<p>Motor Corporation, July 29, 1993.</p>
<p>Japanese Automotive C generally conforms to the principles of ISO 9899, equivalent</p>
<p>to the ANSI<i> X3.159â1989</i> standard, with the exception of the</p>
<p>âImplementation-Defined Behaviorâ specification of Annex G.3, which it modifies</p>
<p>and extends to support portability. These extensions conform to the âCommon</p>
<p>Extensionâ section, in Annex G.5.</p>
<p>To enable support for the Japanese Automotive C extensions:</p>
<p>Set the<b> C/C++ CompilerâC Japanese Automotive Extensions</b> option to<b> On</b></p>
<p>(<b>-japanese_automotive_c</b>).</p>
<p>Enabling<b> C/C++ CompilerâC Japanese Automotive Extensions</b></p>
<p>(<b>-japanese_automotive_c</b>) implicitly modifies the following options:</p>
<p>â¢</p>
<p>Sets<b> C/C++ CompilerâC Language Dialect</b> option to<b> ANSI C</b> (<b>-ansi</b>).</p>
<p>â¢</p>
<p>Sets<b> C/C++ CompilerâData TypesâSignedness of Char Type</b> to<b> Unsigned</b></p>
<p>(<b>--unsigned_chars</b>)</p>
<p>â¢</p>
<p>Sets<b> C/C++ CompilerâData TypesâSignedness of Bitfields</b> to<b> Unsigned</b></p>
<p>(<b>--unsigned_fields</b>)</p>
<p>â¢</p>
<p>Sets<b> C/C++ CompilerâData TypesâUse Smallest Type Possible for Enum</b></p>
<p>to<b> Off</b> (<b>--no_short_enum</b>)</p>
<p>â¢</p>
<p>Sets<b> Compiler DiagnosticsâC/C++ MessagesâAsm Statements</b> to<b> Silent</b></p>
<p>(<b>--asm_silent</b>)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>684</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>In addition, the Green Hills tools satisfy the following Japanese Automotive C</p>
<p>extensions by default:</p>
<p>â¢</p>
<p>#pragma intvect</p>
<p>,</p>
<p>#pragma asm</p>
<p>, and</p>
<p>#pragma endasm</p>
<p>are supported.</p>
<p>â¢</p>
<p>If</p>
<p>sizeof(void *) == sizeof(int)</p>
<p>, any pointer to an object may be</p>
<p>converted to an</p>
<p>int</p>
<p>and then back to a pointer that compares as equal to the</p>
<p>original pointer.</p>
<p>â¢</p>
<p>Bitfields may have arbitrary base types (satisfied by the<b> -ansi</b> option).</p>
<p>For example, if you compile the following code with the<b> C/C++ CompilerâC</b></p>
<p><b>Language Dialect</b> option set to<b> Strict ANSI C</b> (<b>-ANSI</b>) :</p>
<p>struct {</p>
<p>char b:3;</p>
<p>} s;</p>
<p>the compiler generates the following errors:</p>
<p>&quot;x.c&quot;, line 2: error #230-D: nonstandard type for a bit field</p>
<p>char b:3;</p>
<p>^</p>
<p>Enabling<b> C/C++ CompilerâC Japanese Automotive Extensions</b></p>
<p>(<b>-japanese_automotive_c</b>) sets the language dialect to<b> ANSI C</b> (<b>-ansi</b>), which</p>
<p>suppresses these errors.</p>
<p><b>Sequence Related Undefined Behavior Checking</b></p>
<p>The Green Hills compiler attempts to detect undefined behavior that results from</p>
<p>improperly sequenced expressions. For example, the following code results in</p>
<p>undefined behavior because the stored value of</p>
<p>a</p>
<p>is modified more than once with</p>
<p>no intervening sequence point.</p>
<p>int a = 0;</p>
<p>a = a++;</p>
<p>// Undefined behavior</p>
<p>Likewise, an object may not have its stored value both modified and read without</p>
<p>an intervening sequence point. The one exception to this is when the read of the</p>
<p>stored value is used to determine the new value to be stored.</p>
<p><i>685</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Sequence Related Undefined Behavior Checking</i></p>
<h1 style="page-break-before:always; "></h1>
<p>int a = 0, b = 0;</p>
<p>a = a + 1;</p>
<p>// Okay</p>
<p>a = a + a++;</p>
<p>// Undefined behavior</p>
<p>b = a + a++;</p>
<p>// Undefined behavior</p>
<p><b>Note</b></p>
<p>While the compiler is fairly good at detecting this case of undefined</p>
<p>behavior, it does not do so exhaustively. That is, a diagnostic is not</p>
<p>necessarily generated for all such cases of undefined behavior. This is</p>
<p>especially true for large, complex expressions. Furthermore, the compiler</p>
<p>may sometimes diagnose well-defined expressions, so such diagnostics</p>
<p>should not be taken as guarantees of undefined behavior.</p>
<p>To disable this checking and its associated diagnostics (2017, 2018) altogether, the</p>
<p><b>--diag_suppress=2017,2018</b> option may be used.</p>
<p><b>Type Qualifiers</b></p>
<p>The following type qualifiers are available:</p>
<p><b>__bytereversed</b></p>
<p>The</p>
<p>__bytereversed</p>
<p>type qualifier is used to designate that the data is stored in</p>
<p>the opposite endianness, and that special means must be used to access it.</p>
<p>The</p>
<p>__bytereversed</p>
<p>qualifier should not be used for automatic variables or</p>
<p>parameters, although automatic pointers to</p>
<p>bytereversed</p>
<p>objects are allowed.</p>
<p><b>Example 12.1. Using the __bytereversed Qualifier</b></p>
<p>__bytereversed int x;</p>
<p>void foo(void)</p>
<p>{</p>
<p>/* OK - automatic pointer to bytereversed data */</p>
<p>__bytereversed int *p = &amp;x;</p>
<p>/* Not OK - __bytereversed should not apply to an automatic variable */</p>
<p>int * __bytereversed p2;</p>
<p>...</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>686</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__bytereversed</p>
<p>should be applied only to integral and pointer types wider than</p>
<p>char</p>
<p>.</p>
<p>__bytereversed</p>
<p>variables should not be defined with an initializer.</p>
<p><b>__bigendian and __littleendian</b></p>
<p>Similarly,</p>
<p>__bigendian</p>
<p>and</p>
<p>__littleendian</p>
<p>can be used in place of</p>
<p>__bytereversed</p>
<p>to indicate a big or little endian byte ordering on the data. It is</p>
<p>recommended that you do not use the type qualifier unnecessarily because this</p>
<p>might cause problems or performance degradation if the code is ever ported to a</p>
<p>CPU of the opposite endianness.</p>
<p><b>__packed</b></p>
<p>Use the</p>
<p>__packed</p>
<p>type qualifier to designate that an object might be misaligned,</p>
<p>so the program must access it using a series of smaller, aligned accesses. For</p>
<p>example, if you use</p>
<p>__packed</p>
<p>when declaring a pointer, you can safely use that</p>
<p>pointer to access a field in a packed structure (see âStructure Packingâ on page 28).</p>
<p><b>volatile</b></p>
<p>Use the</p>
<p>volatile</p>
<p>type qualifier to designate that an object may change due to an</p>
<p>external process.</p>
<p>When your<b> C/C++ CompilerâC Language Dialect</b> is set to any mode other than</p>
<p>K&amp;R, enabling any of the<b> OptimizationâOptimization Strategy</b> settings (see</p>
<p>âOptimization Optionsâ on page 165) will implicitly enable the</p>
<p><b>AdvancedâOptimization OptionsâMemory Optimization</b> option (<b>-OM</b>), which</p>
<p>assumes that memory locations only change under the control of the compiler. This</p>
<p>assumption is usually, but not always, true. Exceptions include memory which is</p>
<p>updated by interrupt routines, and memory-mapped I/O.</p>
<p>This optimization allows the compiler sometimes to avoid and/or delay reads or</p>
<p>writes to memory locations by maintaining a copy of the memory location in a</p>
<p>register. This is generally much faster because reads and writes to registers are faster</p>
<p>than reads and writes to memory. You can use the</p>
<p>volatile</p>
<p>qualifier to disable</p>
<p>this optimization for particular variables (indicating that they may change), and</p>
<p>retain its use for all other variables.</p>
<p><i>687</i></p>
<p><i>Green Hills Software</i></p>
<p><i>__bigendian and __littleendian</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>const</b></p>
<p>The compiler gives a compile-time error for any attempt to modify an object declared</p>
<p>const</p>
<p>. This qualifier also provides the compiler with additional information for</p>
<p>use in optimizations. Wherever the value of a</p>
<p>const</p>
<p>variable is visible, the optimizer</p>
<p>makes full use of the fact that this variable is simply a named constant value,</p>
<p>combining it with other constants at compile time, and performing other</p>
<p>simplifications. Even when the value of a</p>
<p>const</p>
<p>is not visible, the optimizer can</p>
<p>make use of the fact that the variable is invariant to re-sequence statements and</p>
<p>instructions or to move them outside of loops.</p>
<p>When</p>
<p>const</p>
<p>is used with</p>
<p>volatile</p>
<p>, the compiler never replaces a use of the object</p>
<p>with its value, even if the value of the object is visible.</p>
<p><b>Assignment and Comparisons on struct and union Types</b></p>
<p>The assignment operator (</p>
<p>=</p>
<p>), which is supported in all modes of C, can be used to</p>
<p>assign a value of a structure or a union type to a variable of the same type.</p>
<p>If there are padding bytes between fields or members of a</p>
<p>struct</p>
<p>or</p>
<p>union</p>
<p>type</p>
<p>due to memory alignment requirements, those holes cannot be accessed by means</p>
<p>of the structure or union. Note also that global variables will always be initialized</p>
<p>to zero, and therefore the holes will always be zero; local variables, however, may</p>
<p>have random data in the holes. Therefore, two structures or unions with the same</p>
<p>values for every field might not be equal when compared. For structures or unions</p>
<p>that will be compared, it is important to either have no holes in the memory</p>
<p>representation or to explicitly set the âholeâ bytes to zero via a call to</p>
<p>memset</p>
<p>before</p>
<p>the comparison.</p>
<p>A structure or a union can be passed as an argument to a function without restriction.</p>
<p>The structure or union is copied when it is passed, however, so passing a very large</p>
<p>structure or union is much less efficient than passing a pointer. For this reason, we</p>
<p>recommend that pointers be passed where possible.</p>
<p><b>Bitfields</b></p>
<p>Bitfields in C have a base type which determines the field's alignment, maximum</p>
<p>size, and whether the field is signed or unsigned.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>688</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>ANSI C Limitations</b></p>
<p>The ANSI C standard requires that the base type of a bitfield be either</p>
<p>int</p>
<p>,</p>
<p>signed</p>
<p>int</p>
<p>, or</p>
<p>unsigned int</p>
<p>. This restriction is enforced when the<b> C/C++ CompilerâC</b></p>
<p><b>Language Dialect</b> option is set to<b> Strict ANSI C</b> (<b>-ANSI</b>), and is ignored without</p>
<p>a warning for all other dialects.</p>
<p><b>Signedness of Bitfields</b></p>
<p>Bitfields defined without either a</p>
<p>signed</p>
<p>or</p>
<p>unsigned</p>
<p>qualifier are</p>
<p>signed</p>
<p>by</p>
<p>default (this default varies between target processor families). To control the</p>
<p>signedness of bitfields manually:</p>
<p>Use the<b> C/C++ CompilerâData TypesâSignedness of Bitfields</b> option</p>
<p>(<b>--signed_fields</b>/<b>--unsigned_fields</b>).</p>
<p>For example, if you set this option to<b> --signed_fields</b>:</p>
<p>â¢</p>
<p>int x:2</p>
<p>is a signed bitfield, by the default rule.</p>
<p>â¢</p>
<p>char c:2</p>
<p>has the same signedness as the char type (see âSignedness of Char</p>
<p>Typeâ on page 213).</p>
<p>â¢</p>
<p>enum { MIN=-2, MAX=1 } e:2</p>
<p>is a signed bitfield, because the</p>
<p>enum</p>
<p>type</p>
<p>has at least one negative enumerator.</p>
<p>â¢</p>
<p>enum { MIN=0, MAX=3 } e:2</p>
<p>is an unsigned bitfield, because the</p>
<p>enum</p>
<p>type has at least one positive enumerator which would not fit in the bitfield if</p>
<p>it were signed.</p>
<p>â¢</p>
<p>enum { MIN=0, MAX=100 } e:2</p>
<p>is an unsigned bitfield, because the</p>
<p>enum</p>
<p>type has at least one positive enumerator which would not fit in the bitfield if</p>
<p>it were signed (even though the enumerator still does not fit in the unsigned</p>
<p>bitfield).</p>
<p>â¢</p>
<p>enum { MIN=0, MAX=1 } e:2</p>
<p>is a signed bitfield, by the default rule.</p>
<p>If you set this option to<b> --unsigned_fields</b>:</p>
<p>â¢</p>
<p>int x:2</p>
<p>is an unsigned bitfield.</p>
<p>â¢</p>
<p>char c:2</p>
<p>is an unsigned bitfield, even if plain</p>
<p>char</p>
<p>is signed.</p>
<p><i>689</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ANSI C Limitations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>enum { MIN=-2, MAX=1 } e:2</p>
<p>is a signed bitfield, because the</p>
<p>enum</p>
<p>type</p>
<p>has at least one negative enumerator.</p>
<p>â¢</p>
<p>enum { MIN=0, MAX=1 } e:2</p>
<p>is an unsigned bitfield.</p>
<p>â¢</p>
<p>enum { MIN=0, MAX=3 } e:2</p>
<p>is an unsigned bitfield.</p>
<p>â¢</p>
<p>enum { MIN=0, MAX=100 } e:2</p>
<p>is an unsigned bitfield.</p>
<p>However, single-bit bitfields of integer type that are not explicitly declared</p>
<p>signed</p>
<p>are always unsigned. Regardless of the setting of<b> --signed_fields</b> or<b> --signed_chars</b>:</p>
<p>â¢</p>
<p>int x:1</p>
<p>is an unsigned bitfield</p>
<p>â¢</p>
<p>char c:1</p>
<p>is an unsigned bitfield</p>
<p>The choice of signed versus unsigned bitfields can also affect</p>
<p>code efficiency.</p>
<p>Unless the processor has special instructions for this purpose, it may require two</p>
<p>or even three instructions to extract the bits of a signed field whenever that field is</p>
<p>evaluated. This is because the bits must be sign-extended to the size of an</p>
<p>int</p>
<p>,</p>
<p>which may require two arithmetic shifts.</p>
<p>The following example demonstrates another difficulty with signed bitfields:</p>
<p>int i;</p>
<p>struct {int x:2; } y;</p>
<p>y.x = 2;</p>
<p>i = y.x;</p>
<p>if (y.x &gt; 0) func();</p>
<p>â¢</p>
<p>If</p>
<p>x</p>
<p>is an unsigned field,</p>
<p>i</p>
<p>is assigned the value</p>
<p>2</p>
<p>and</p>
<p>func()</p>
<p>is called.</p>
<p>â¢</p>
<p>If</p>
<p>x</p>
<p>is a signed field,</p>
<p>i</p>
<p>is assigned the value</p>
<p>-2</p>
<p>and</p>
<p>func()</p>
<p>is not called. This</p>
<p>is because the range represented by a signed field with two bits is from</p>
<p>-2</p>
<p>to</p>
<p>1</p>
<p>. The value</p>
<p>2</p>
<p>is out of range. Out-of-range assignments are detected at compile</p>
<p>time if warning 69 is enabled, or at run time if the translation unit has been</p>
<p>compiled with<b> -check=assignbound</b> (see âRun-Time Error Checksâ</p>
<p>on page 178).</p>
<p><b>Size and Alignment of Bitfields</b></p>
<p>There is a close relationship between the base type of a field and the space it</p>
<p>occupies, which can be summarized in three ways.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>690</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>First, an individual bitfield can never have more bits than its base type.</p>
<p>Second, an unpacked bitfield must always fit entirely within a memory location</p>
<p>that could hold its base type. It cannot cross a boundary that a simple variable of</p>
<p>that type cannot cross. Thus, a field of type</p>
<p>char</p>
<p>can be placed in any memory</p>
<p>location, but cannot cross a byte boundary. For example:</p>
<p>struct {</p>
<p>char a:4;</p>
<p>char b:6;</p>
<p>char c:6;</p>
<p>} w;</p>
<p>Variable</p>
<p>w</p>
<p>requires three bytes because fields</p>
<p>a</p>
<p>and</p>
<p>b</p>
<p>do not fit in a single byte.</p>
<p>Therefore, four bits of padding are inserted before field</p>
<p>b</p>
<p>. Similarly, the fields</p>
<p>b</p>
<p>and</p>
<p>c</p>
<p>do not fit in a single byte, so two bits of padding are inserted before the field</p>
<p>c</p>
<p>. On the other hand, if we had:</p>
<p>struct {</p>
<p>short a:4;</p>
<p>short b:6;</p>
<p>short c:6;</p>
<p>} x;</p>
<p>then variable</p>
<p>x</p>
<p>would require only two bytes because the total size of the three</p>
<p>fields is less than or equal to the size of a</p>
<p>short</p>
<p>.</p>
<p>Third, the alignment of a bitfield is determined by its base type. Padding may be</p>
<p>inserted so that the field and the structure containing it are properly aligned. In the</p>
<p>examples above,</p>
<p>w</p>
<p>has the alignment of a</p>
<p>char</p>
<p>, which is usually one byte, and</p>
<p>x</p>
<p>has the alignment of a</p>
<p>short</p>
<p>, which is usually either one or two bytes. Neither</p>
<p>w</p>
<p>nor</p>
<p>x</p>
<p>would be any larger due to alignment. However, in the following example,</p>
<p>y</p>
<p>will have an extra byte of padding added if</p>
<p>short</p>
<p>is 2 byte aligned:</p>
<p>struct {</p>
<p>short a:4;</p>
<p>short b:6;</p>
<p>short c:6;</p>
<p>char byte;</p>
<p>/* padding added after</p>
<p>'byte' for alignment */</p>
<p>} y;</p>
<p><i>691</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Size and Alignment of Bitfields</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For information about the size and alignment of C and C++ data types, see âV850</p>
<p>and RH850 Characteristicsâ on page 26.</p>
<p><b>Enumerated Types</b></p>
<p>An</p>
<p>enum</p>
<p>type is treated as one of the integral types. By default, the members of an</p>
<p>enum</p>
<p>type (enumerators) are treated as integral constants of type</p>
<p>int</p>
<p>. If you are</p>
<p>compiling a C++ file or using a GNU C dialect (<b>-gcc</b> or<b> -gnu99</b>) and the values of</p>
<p>the enumerators are outside of</p>
<p>int</p>
<p>range, they are treated as a larger integral type.</p>
<p>To instruct the compiler to attempt to use the smallest possible predefined type</p>
<p>(including unsigned types) that allows representation of all listed values:</p>
<p>Set the<b> C/C++ CompilerâData TypesâUse Smallest Type Possible for Enum</b></p>
<p>option to<b> On</b> (<b>--short_enum</b>).</p>
<p>The ANSI standard does not call for strict type checking with respect to</p>
<p>enum</p>
<p>types.</p>
<p>In fact, a variable of enumerated type is considered equivalent to any other integral</p>
<p>value. Most operations which are allowed on values of integral types are also allowed</p>
<p>on enumerated types, including assignment of a variable or parameter of one</p>
<p>enumerated type to a variable or parameter of another type.</p>
<p><b>Functions with Variable Arguments</b></p>
<p>Green Hills C and C++ compilers support functions with variable parameters. In</p>
<p>ANSI C modes and C++, it is done using the<b> &lt;stdarg.h&gt;</b> facility. In K&amp;R C mode,</p>
<p>this is done using the<b> &lt;varargs.h&gt;</b> facility (though both this mode and the facility</p>
<p>are deprecated). The two implementations are different and incompatible. Take care</p>
<p>to use the correct facility for the appropriate mode of C.</p>
<p>An important limitation of variable parameters is that the types</p>
<p>char</p>
<p>,</p>
<p>short</p>
<p>, and</p>
<p>float</p>
<p>are not supported. When a function with variable parameters is called, the</p>
<p>caller promotes expressions of these types to</p>
<p>int</p>
<p>(for</p>
<p>char</p>
<p>and</p>
<p>short</p>
<p>) and</p>
<p>double</p>
<p>(for</p>
<p>float</p>
<p>).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>692</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The &lt;varargs.h&gt; Facility</b></p>
<p>The<b> &lt;varargs.h&gt;</b> facility is deprecated and may be removed in future versions of</p>
<p><b>MULTI</b>.</p>
<p>To use the<b> &lt;varargs.h&gt;</b> facility, you must perform the following steps:</p>
<p>1.</p>
<p>The line</p>
<p>#include &lt;varargs.h&gt;</p>
<p>must appear before the first function</p>
<p>definition.</p>
<p>2.</p>
<p>The last parameter of a variable argument list function must be named</p>
<p>va_alist</p>
<p>.</p>
<p>3.</p>
<p>The last parameter declaration of a variable argument list function must be</p>
<p>va_dcl</p>
<p>.</p>
<p>4.</p>
<p>There must not be a semicolon (</p>
<p>;</p>
<p>) between</p>
<p>va_dcl</p>
<p>and the initial left brace</p>
<p>(</p>
<p>{</p>
<p>) of the function.</p>
<p>5.</p>
<p>There must be a variable declared in the function of type</p>
<p>va_list</p>
<p>.</p>
<p>6.</p>
<p>The<b> &lt;varargs.h&gt;</b> facility must be initialized at the top of the function by</p>
<p>passing the variable of type</p>
<p>va_list</p>
<p>to a call of the macro</p>
<p>va_start</p>
<p>.</p>
<p>7.</p>
<p>To obtain the variable arguments to the function, in left-to-right order, the</p>
<p>macro</p>
<p>va_arg</p>
<p>is invoked once for each argument. The first argument to the</p>
<p>macro</p>
<p>va_arg</p>
<p>is the variable of type</p>
<p>va_list</p>
<p>. The second argument is the</p>
<p>type of the current argument of the function. The</p>
<p>va_arg</p>
<p>macro returns the</p>
<p>value of the current argument of the function.</p>
<p>8.</p>
<p>The<b> &lt;varargs.h&gt;</b> facility must be terminated by passing the variable of type</p>
<p>va_list</p>
<p>to a call of the macro</p>
<p>va_end</p>
<p>at the end of the function.</p>
<p><b>Example 12.2. Using the &lt;varargs.h&gt; Facility</b></p>
<p>#include &lt;varargs.h&gt;</p>
<p>/* Return the sum of a variable number of &quot;int&quot; arguments */</p>
<p>Sum(n, va_alist)</p>
<p>int n;</p>
<p>va_dcl</p>
<p>/* steps 3 and 4 */</p>
<p>{</p>
<p>va_list params;</p>
<p>/* step 5 */</p>
<p>int ret = 0;</p>
<p>va_start(params);</p>
<p>/* step 6 */</p>
<p>while (n-- &gt; 0) {</p>
<p>ret += va_arg(params,int);</p>
<p>/* step 7 */</p>
<p><i>693</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The &lt;varargs.h&gt; Facility</i></p>
<h1 style="page-break-before:always; "></h1>
<p>}</p>
<p>va_end(params);</p>
<p>/* step 8 */</p>
<p>return(ret);</p>
<p>}</p>
<p><b>The &lt;stdarg.h&gt; Facility</b></p>
<p>The<b> &lt;stdarg.h&gt;</b> facility has some additional limitations. First, every function with</p>
<p>variable parameters is required to have at least one fixed parameter. Second, a</p>
<p>prototype for the function must appear before its first invocation.</p>
<p>To use the<b> &lt;stdarg.h&gt;</b> facility, you must perform the following steps:</p>
<p>1.</p>
<p>The line</p>
<p>#include &lt;stdarg.h&gt;</p>
<p>must appear before the first function</p>
<p>definition.</p>
<p>2.</p>
<p>In the function definition, at least one fixed parameter must appear in the</p>
<p>parameter list before the ellipsis (</p>
<p>...</p>
<p>).</p>
<p>3.</p>
<p>The last parameter in the function's parameter list must be ellipsis (</p>
<p>...</p>
<p>).</p>
<p>4.</p>
<p>There must be a variable declared in the function of type</p>
<p>va_list</p>
<p>.</p>
<p>5.</p>
<p>The variable argument processing must be initialized by invoking the macro</p>
<p>va_start</p>
<p>at the beginning of the function with two parameters: (1) the variable</p>
<p>of type</p>
<p>va_list</p>
<p>, and (2) the last fixed parameter in the function parameter</p>
<p>list.</p>
<p>6.</p>
<p>To obtain the variable parameters to the function in left to right order, invoke</p>
<p>the macro</p>
<p>va_arg</p>
<p>once for each parameter. The first parameter to</p>
<p>va_arg</p>
<p>is</p>
<p>the variable of type</p>
<p>va_list</p>
<p>. The second parameter is the type of the current</p>
<p>parameter of the function. The</p>
<p>va_arg</p>
<p>macro returns the value of the current</p>
<p>parameter of the function.</p>
<p>7.</p>
<p>The variable argument processing must be terminated by invoking the macro</p>
<p>va_end</p>
<p>with the variable of type</p>
<p>va_list</p>
<p>as its parameter. If the function</p>
<p>passes the</p>
<p>va_list</p>
<p>variable to another function such as</p>
<p>vprintf</p>
<p>, the calling</p>
<p>function must invoke</p>
<p>va_end</p>
<p>before returning.</p>
<p><b>Example 12.3. Using the &lt;stdarg.h&gt; Facility</b></p>
<p>#include &lt;stdarg.h&gt;</p>
<p>/* Return the sum of the parameter, with the first</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>694</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>parameter being a parameter type string. */</p>
<p>double sum(const char *key, ...)</p>
<p>{</p>
<p>double ret = 0;</p>
<p>va_list ap;</p>
<p>va_start(ap, key);</p>
<p>while (*key) {</p>
<p>switch (*key++) {</p>
<p>case 'i': ret += va_arg(ap, int); break;</p>
<p>case 'l': ret += va_arg(ap, long); break;</p>
<p>case 'd': ret += va_arg(ap, double); break;</p>
<p>case 'p': ret += *(va_arg(ap, int*)); break;</p>
<p>}</p>
<p>}</p>
<p>va_end(ap);</p>
<p>return ret;</p>
<p>}</p>
<p><b>The asm Statement</b></p>
<p>The</p>
<p>asm</p>
<p>statement generates in-line assembly code; it can be used anywhere a</p>
<p>statement can be used within a function and anywhere a declaration can be used</p>
<p>outside of a function. There are two spellings:</p>
<p>__asm</p>
<p>and</p>
<p>asm</p>
<p>.</p>
<p>asm</p>
<p>is supported in</p>
<p>both ISO C99 and ANSI C modes (<b>-c99</b> and<b> -ansi</b>), but not their strict counterparts</p>
<p>(<b>-C99</b> and<b> -ANSI</b>).</p>
<p>__asm</p>
<p>is supported in all modes.</p>
<p>__asm (&quot;<i>assembler_string</i>&quot;);</p>
<p>or</p>
<p>asm (&quot;<i>assembler_string</i>&quot;);</p>
<p>The entire contents of the string will be passed through to the assembly language</p>
<p>output file in the same position as it appears in the source file. If the underlying</p>
<p>assembler requires a space or tab before the opcode, this tab or space must appear</p>
<p>in the string.</p>
<p>See also Chapter 18, âEnhanced asm Macro Facility for C and C++â on page 897.</p>
<p>To control the diagnostic messages associated with</p>
<p>asm</p>
<p>statements (667 and 1546):</p>
<p><i>695</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The asm Statement</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Set the<b> Compiler DiagnosticsâC/C++ MessagesâAsm Statements</b> option to</p>
<p>one of the following settings:</p>
<p>â¢</p>
<p><b>Errors</b> (<b>--asm_errors</b>)</p>
<p>â¢</p>
<p><b>Warnings</b> (<b>--asm_warnings</b>)</p>
<p>â¢</p>
<p><b>Silent</b> (<b>--asm_silent</b>)</p>
<p><b>Note</b></p>
<p>The compiler uses assembly language instructions and directives</p>
<p>throughout the file without concern for possible interactions with user</p>
<p>asm</p>
<p>statements. Furthermore, the allocation of variables to registers and</p>
<p>memory may vary from one compilation to another. Therefore, the use</p>
<p>of the</p>
<p>asm</p>
<p>statement is considered non-portable and may be difficult to</p>
<p>maintain.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>696</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The Preprocessor</b></p>
<p>Green Hills C and C++ compilers include a built-in preprocessor. Preprocessing is</p>
<p>normally performed in a single pass. The behavior of the preprocessor is affected</p>
<p>by the<b> C/C++ CompilerâC Language Dialect</b> option.</p>
<p><b>Preprocessor Output File</b></p>
<p>By default, preprocessing is performed concurrently with compilation and no</p>
<p>intermediate output is generated. To write preprocessed output to a file:</p>
<p>Pass the<b> -P</b> option to the driver.</p>
<p>Preprocessed output from a C or C++ file is saved with a<b> .i</b> extension, while output</p>
<p>from an assembly file is saved with a<b> .si</b> extension.</p>
<p>You can also use the<b> -E</b> option to direct output to</p>
<p>stdout</p>
<p>. This latter option</p>
<p>includes</p>
<p>#line</p>
<p>directives corresponding to the original file.</p>
<p><b>Extended Characters</b></p>
<p>English has a small alphabet, which is easily represented in eight bits by the ASCII</p>
<p>character set. However, many languages require more space, and character sets that</p>
<p>need more than 8 bits can be handled in two ways by ISO C/C++:</p>
<p>â¢</p>
<p><i>Multi-Byte Characters</i> â uses traditional C strings to represent the non-ASCII</p>
<p>characters. For example, Kanji characters in the EUC or Shift-JIS format require</p>
<p>two consecutive bytes to represent a single Kanji character. In both cases, the</p>
<p>first byte has a value outside the normal ASCII range, which allows a program</p>
<p>to recognize that the following byte should be treated as the rest of the current</p>
<p>Kanji character. Multi-byte characters can be mixed with normal ASCII</p>
<p>characters within the same string. Thus the length of a string in bytes does not</p>
<p>directly correspond to the number of characters represented by the string. Some</p>
<p>characters are one byte and others require more. Hence the term multi-byte.</p>
<p>â¢</p>
<p><i>Wide Characters</i> â are simply fixed-width (16- or 32- bit) characters. Wide</p>
<p>characters were introduced by the ANSI/ISO C standard of 1990. The prefix</p>
<p>â</p>
<p>L</p>
<p>â is used to mark a character or string literal as wide. The</p>
<p>wchar_t</p>
<p>type</p>
<p>matches the type of</p>
<p>L'x'</p>
<p>and</p>
<p>L&quot;hello&quot;[3]</p>
<p>.</p>
<p><i>697</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The Preprocessor</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The multi-byte string looks just like a traditional string in C, where each element</p>
<p>of the string has type</p>
<p>char</p>
<p>. The wide character string uses more space because</p>
<p>each element of the string has type</p>
<p>wchar_t</p>
<p>, which occupies either 16 or 32 bits</p>
<p>depending on the target and build options.</p>
<p>The advantages of wide characters over multi-byte characters are:</p>
<p>â¢</p>
<p>The length of the string directly corresponds to the number of characters in</p>
<p>that string. For example, the third character in a wide character string is always</p>
<p>the third element, but in a multi-byte character string it could be one element</p>
<p>or two. The character could even begin after the second, third, or fourth byte,</p>
<p>depending upon whether there are Kanji or ASCII characters preceding it in</p>
<p>the string.</p>
<p>â¢</p>
<p>You can form a single wide character, such as</p>
<p>L'5'</p>
<p>, representing one multi-byte</p>
<p>character.</p>
<p>However, wide characters take up more space and, more importantly, they cannot</p>
<p>be manipulated by the large number of existing routines that were written for</p>
<p>traditional C character strings, requiring instead special wide character functions.</p>
<p>Amendment 1 to the ISO C standard, adopted in 1995 and incorporated into both</p>
<p>the ISO C++ standard and the ISO C99 standard, added many new functions to the</p>
<p>standard C library in order to provide support for wide characters. These new</p>
<p>functions, such as</p>
<p>wprintf()</p>
<p>and</p>
<p>wscanf()</p>
<p>, together with wide-character versions</p>
<p>of most of the functions in</p>
<p>string.h</p>
<p>and</p>
<p>ctype.h</p>
<p>, have been added to<b> libansi.a</b>.</p>
<p><b>Note</b></p>
<p>In addition to requiring the new functions, the standard also modifies the</p>
<p>behavior of</p>
<p>printf()</p>
<p>and</p>
<p>scanf()</p>
<p>and their derivatives to support</p>
<p>wide character strings and individual wide characters. The Green Hills</p>
<p>implementation does not provide these modifications in order to minimize</p>
<p>the impact of such changes on the size, speed, and stability of existing</p>
<p>applications.</p>
<p><b>Compiler Support for Multi-Byte Characters</b></p>
<p>The Green Hills Software C/C++ compilers deal with multibyte character sets in</p>
<p>two different places and reject them elsewhere. Multi-byte characters may appear</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>698</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>in comments and in character or string literals, but they may not appear in variable</p>
<p>names.</p>
<p>The compiler may not need to know everything about a multibyte character set in</p>
<p>order to parse comments or character and string literals which contain multi-byte</p>
<p>characters. The compiler<i> does</i> need to be able to detect the end of a string or</p>
<p>comment. Therefore, if the multibyte character set contains no values which have</p>
<p>bytes that match punctuation the compiler is looking for, such as</p>
<p>' \ &quot;</p>
<p>, the compiler</p>
<p>will be able to scan the comment or literal without requiring knowledge of the</p>
<p>multibyte character set.</p>
<p>Parsing of wide character literals, however, is more difficult. The compiler must</p>
<p>know the encoding of the multibyte character set in order to determine which bytes</p>
<p>make up each element of type</p>
<p>wchar_t</p>
<p>. For example,</p>
<p>L&quot;hello&quot;</p>
<p>will result in a</p>
<p>string of type</p>
<p>wchar_t[6]</p>
<p>, because each of the characters is ASCII (which the</p>
<p>compiler understands). If, however, the five bytes in the string literal were not</p>
<p>ASCII, the compiler must decide which bytes compose the first</p>
<p>wchar_t</p>
<p>element,</p>
<p>and so on.</p>
<p>Applications requiring an unsupported multibyte character set will not be able to</p>
<p>use wide character literals with the Green Hills Software C/C++ compilers. Instead,</p>
<p>all literals must be written as multi-byte strings and converted using functions such</p>
<p>as</p>
<p>mbstowcs()</p>
<p>. Furthermore, if the multibyte character set has bytes which match</p>
<p>certain ASCII punctuation characters, multi-byte string literals may not be used</p>
<p>either. In either case, it is possible to place multi-byte character strings in external</p>
<p>data files and load them into the application at run time. The application can still</p>
<p>make full use of the Green Hills C and C++ library routines to manipulate both</p>
<p>wide character strings and multi-byte strings even if the compiler cannot parse string</p>
<p>literals containing the multibyte character set.</p>
<p>The following list details the limitations to wide character support:</p>
<p>1.</p>
<p>When using</p>
<p>wscanf()</p>
<p>, the behavior of the</p>
<p>%[]</p>
<p>modifier is defined only for</p>
<p>characters in the range</p>
<p>0</p>
<p>to</p>
<p>0xffff</p>
<p>.</p>
<p>2.</p>
<p>Since the multibyte character sets that we support directly do not require state</p>
<p>information, our implementation ignores</p>
<p>mbstate_t</p>
<p>. Consequently support</p>
<p>for state-dependent encoding is not provided.</p>
<p>3.</p>
<p>Locale is ignored. All wide character conversion routines rely on</p>
<p>mbtowc()</p>
<p>and/or</p>
<p>wctomb()</p>
<p>, the behavior of these functions is set according to the<b> C/C++</b></p>
<p><i>699</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Compiler Support for Multi-Byte Characters</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>CompilerâSpecial TokensâHost and Target Character Encoding</b> option</p>
<p>(<b>-kanji=</b>). For more information about this option, see âHost and Target</p>
<p>Character Encodingâ on page 219.</p>
<p><b>Kanji Character Support</b></p>
<p>In this manual,<i> extended characters</i> refers to the Japanese Kanji, Hiragana, and</p>
<p>Katakana character sets and any other characters which are representable in your</p>
<p>chosen character encoding (such as UTF-8), but are not members of the basic</p>
<p>character set (C99, 5.2.1). To enable extended characters:</p>
<p>Set the<b> C/C++ CompilerâSpecial TokensâHost and Target Character</b></p>
<p><b>Encoding</b> option (<b>-kanji=</b>). For more information, see âHost and Target Character</p>
<p>Encodingâ on page 219.</p>
<p>The Green Hills C and C++ compilers provide support for extended characters in</p>
<p>comments, strings, and character constants. Their use in variable names or other</p>
<p>identifiers is not supported because of the conflicts it would cause with syntactic</p>
<p>rules requiring identifiers to begin with a letter or underscore.</p>
<p>If a source file uses extended characters, specify the appropriate character encoding,</p>
<p>or the source file might not be parsed correctly. For example, whereas the EUC</p>
<p>encoding of a multibyte character uses two bytes outside the normal ASCII range,</p>
<p>the Shift-JIS encoding allows normal ASCII characters in the second byte. The</p>
<p>compiler must know that Shift-JIS is being used, in order to parse a string literal</p>
<p>containing Shift-JIS characters where the second byte has the value</p>
<p>0x5C</p>
<p>(</p>
<p>\</p>
<p>) or</p>
<p>0x22</p>
<p>(</p>
<p>&quot;</p>
<p>).</p>
<p>At link time, the Green Hills driver selects a run-time library containing versions</p>
<p>of</p>
<p>wctomb()</p>
<p>and</p>
<p>mbtowc()</p>
<p>appropriate to the character encoding specified on the</p>
<p>command line. The EUC and Shift-JIS character encodings share a single</p>
<p>implementation.</p>
<p><b>Note</b></p>
<p>In Shift-JIS mode, half-width Katakana characters in the range</p>
<p>0xA1-0xDF</p>
<p>are not supported by the wide character functions in the</p>
<p>run-time library.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>700</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Compiler Limitations</b></p>
<p>The ISO C standard requires that a conforming compiler implementation accept</p>
<p>programs of a certain complexity and size. These requirements are listed in the</p>
<p>âTranslation limitsâ section of the ISO C standard and are expressed in terms of</p>
<p>acceptable limits. The Green Hills compiler meets these requirements. For</p>
<p>completeness, we list below all of the acceptable limits followed parenthetically</p>
<p>with the limits supported by the Green Hills compiler. The code (U) indicates the</p>
<p>compiler is theoretically unlimited, while the code (U &gt;<i> n</i>) indicates that the compiler</p>
<p>is both theoretically unlimited and tested to handle at least the value<i> n</i>.</p>
<p>â¢</p>
<p>127 nesting levels of compound statements, iteration control structures and</p>
<p>selection control structures (U &gt; 512)</p>
<p>â¢</p>
<p>63 nesting levels of conditional inclusion (U &gt; 500)</p>
<p>â¢</p>
<p>12 pointer, array, and function declarators (in any combination) modifying an</p>
<p>arithmetic, structure, union, or incomplete type in a declaration (U &gt; 64)</p>
<p>â¢</p>
<p>63 nesting levels of parenthesized declarators within a full declarator (U)</p>
<p>â¢</p>
<p>63 nesting levels of parenthesized expressions within a full expression (U &gt;</p>
<p>200)</p>
<p>â¢</p>
<p>63 significant initial characters in an internal identifier or a macro name (U)</p>
<p>â¢</p>
<p>31 significant characters in an external identifier (U)</p>
<p>â¢</p>
<p>4095 external identifiers in one translation unit (U &gt; 32767)</p>
<p>â¢</p>
<p>511 identifiers with block scope declared in one block (U &gt; 2048)</p>
<p>â¢</p>
<p>4095 macro identifiers simultaneously defined in 1 translation unit (U &gt; 16000)</p>
<p>â¢</p>
<p>127 parameters in one function declaration (U &gt; 30000)</p>
<p>â¢</p>
<p>127 arguments in one function call (U)</p>
<p>â¢</p>
<p>127 parameters in one macro definition (U &gt; 2700)</p>
<p>â¢</p>
<p>127 arguments in one macro call (U &gt; 2700)</p>
<p>â¢</p>
<p>4095 characters in a logical source line (U &gt; 64535)</p>
<p>â¢</p>
<p>4095 characters in a character string literal or wide string literal (after</p>
<p>concatenation) (U &gt; 16384)</p>
<p>â¢</p>
<p>65535 bytes in an object (in a hosted environment only)</p>
<p>â¢</p>
<p>15 nesting levels for</p>
<p>#include</p>
<p>files (U &gt; 256)</p>
<p><i>701</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Compiler Limitations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>1023</p>
<p>case</p>
<p>labels for a</p>
<p>switch</p>
<p>statement, excluding those for any nested</p>
<p>switch</p>
<p>statements (U &gt; 8000)</p>
<p>â¢</p>
<p>1023 members in a single structure or union (U &gt; 4096)</p>
<p>â¢</p>
<p>1023 enumeration constants in a single enumeration (U &gt; 32767)</p>
<p>â¢</p>
<p>63 levels of nested structure or union definitions in a single</p>
<p>struct</p>
<p>-declaration-list (U &gt; 1024)</p>
<p><b>Note</b></p>
<p>Under heavy optimization, limitations on host resources (such as CPU</p>
<p>time or memory) may lower the practical limit on some of these bounds.</p>
<p>Because of this,<b> -Omax</b> (and to a lesser extent other optimization</p>
<p>strategies) may not be appropriate for source files containing very large</p>
<p>functions or data structures.</p>
<p><b>C Implementation-Defined Features</b></p>
<p>The standard for the C programming language (<i>ISO/IEC 9899</i>) leaves certain details</p>
<p>of the language unspecified. Throughout the standard, various details are described</p>
<p>as âundefinedâ or âimplementation-definedâ. The following definitions are taken</p>
<p>from the standard for these and related terms:</p>
<p><b>Meaning</b></p>
<p><b>Term</b></p>
<p>Behavior, for a correct program construct and correct data, that</p>
<p>depends on the characteristics of the implementation and that</p>
<p>each implementation shall document.</p>
<p>implementation-defined</p>
<p>behavior</p>
<p>Behavior, upon use of a nonportable or erroneous program</p>
<p>construct, of erroneous data, or of indeterminately valued</p>
<p>objects, for which this International Standard imposes no</p>
<p>requirements. Permissible undefined behavior ranges from</p>
<p>ignoring the situation completely with unpredictable results, to</p>
<p>behaving during translation or program execution in a</p>
<p>documented manner characteristic of the environment (with or</p>
<p>without the issuance of a diagnostic message), to terminating</p>
<p>a translation or execution (with the issuance of a diagnostic</p>
<p>message).</p>
<p>undefined behavior</p>
<p>Behavior, for a correct program construct and correct data, for</p>
<p>which this International Standard explicitly imposes no</p>
<p>requirements.</p>
<p>unspecified behavior</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>702</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The standard requires that a conforming implementation provide documentation</p>
<p>which describes the behavior in each case where the standard uses the phrase</p>
<p>âimplementation-defined.â This chapter describes the behavior of the Green Hills</p>
<p>V850 and RH850 compiler in each such case. Features are listed according to the</p>
<p>sequence in which they appear in the 1999 version of the standard, with citations</p>
<p>referring to the appropriate section of the standard.</p>
<p><b>J.2 Undefined Behavior</b></p>
<p>When an expression having signed promoted type is left-shifted and either the value</p>
<p>of the expression is negative or the result of shifting would not be representable in</p>
<p>the promoted type, the result is equivalent to the following sequence:</p>
<p>1.</p>
<p>Converting the expression to an unsigned type with a size equal to the promoted</p>
<p>type.</p>
<p>2.</p>
<p>Performing an unsigned left shift by the specified amount.</p>
<p>3.</p>
<p>Converting the result of the unsigned left shift back to the signed promoted</p>
<p>type.</p>
<p>For more information, see section 6.5.7 of the ISO C99 standard.</p>
<p><b>J.3.1 Translation</b></p>
<p>Each non-empty sequence of whitespace characters, other than newline, is replaced</p>
<p>by one space character.</p>
<p>Diagnostic messages all have the form:</p>
<p>&quot;<i>filename</i>&quot;, line<i> nnn</i>:<i> content_of_message</i></p>
<p><i>offending_source_line</i></p>
<p>There are multiple classes of messages. For more information, see âVarying Message</p>
<p>Severityâ on page 259.</p>
<p>The compiler returns one (indicating failure) if any errors were reported, and zero</p>
<p>(indicating success) if there were no errors.</p>
<p>To suppress compiler warnings:</p>
<p><i>703</i></p>
<p><i>Green Hills Software</i></p>
<p><i>J.2 Undefined Behavior</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Set the<b> Compiler DiagnosticsâWarnings</b> option to<b> Suppress</b> (<b>-w</b>).</p>
<p><b>J.3.2 Environment</b></p>
<p>To select the encoding used in translation phase 1 (as well as the encoding used by</p>
<p>the standard library at run time), use the driver option<b> -kanji=</b>. For more information,</p>
<p>see âHost and Target Character Encodingâ on page 219.</p>
<p>No further processing occurs after program termination in a stand-alone environment.</p>
<p>In hosted execution environments, two arguments are passed to the function</p>
<p>main</p>
<p>:</p>
<p>int main(int argc, char *argv[]);</p>
<p>The argument</p>
<p>argc</p>
<p>is the number of valid elements in the</p>
<p>argv</p>
<p>array. The argument</p>
<p>argv</p>
<p>is a null-terminated array of command line words.</p>
<p>In a stand-alone environment, no arguments are passed to the function</p>
<p>main</p>
<p>.</p>
<p>main()</p>
<p>may be defined with any prototype, but the default startup code expects it</p>
<p>to be defined as</p>
<p>int main(int argc, char **argv, char **envp)</p>
<p>.</p>
<p>From the ISO C99 standard: &quot;the standard input and standard output streams are</p>
<p>fully buffered if and only if the stream can be determined not to refer to an interactive</p>
<p>device&quot; (section 7.19.3), and &quot;what constitutes an interactive device is</p>
<p>implementation-defined&quot; (section 5.1.2.3). In a hosted environment that supports</p>
<p>the</p>
<p>isatty()</p>
<p>system call, such as INTEGRITY, an interactive device is one for</p>
<p>which</p>
<p>isatty()</p>
<p>returns a non-zero value. In a stand-alone environment, no streams</p>
<p>are fully buffered until</p>
<p>setbuf()</p>
<p>or</p>
<p>setvbuf()</p>
<p>is called to change the buffering.</p>
<p>For more information, see âLess Buffered I/Oâ on page 823.</p>
<p>The set of signals is documented in<b> &lt;signals.h&gt;</b>. Signal values that correspond to</p>
<p>a computational exception are:</p>
<p>SIGFPE</p>
<p>,</p>
<p>SIGILL</p>
<p>,</p>
<p>SIGSEGV</p>
<p>,</p>
<p>SIGQUIT</p>
<p>,</p>
<p>SIGDRAP</p>
<p>,</p>
<p>SIGIOT</p>
<p>,</p>
<p>SIGABRT</p>
<p>,</p>
<p>SIGEMT</p>
<p>,</p>
<p>SIGBUS</p>
<p>, and</p>
<p>SIGSYS</p>
<p>.</p>
<p>The equivalent of</p>
<p>signal(sig, SIG_DFL)</p>
<p>is executed prior to the call of a signal</p>
<p>handler. Default handling is reset if a</p>
<p>SIGILL</p>
<p>signal is received by a handler specific</p>
<p>to the signal function.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>704</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The only limitation on environment names is that they may not contain the equals</p>
<p>character (</p>
<p>=</p>
<p>) which is used to separate the name from its value.</p>
<p>The method to alter the environment list obtained by a call to the</p>
<p>getenv</p>
<p>function</p>
<p>is to call the function</p>
<p>setenv(char *name, char *value)</p>
<p>. This will set the</p>
<p>environment variable named by the null-terminated string</p>
<p>name</p>
<p>to a copy of the</p>
<p>null-terminated string pointed to by</p>
<p>value</p>
<p>.</p>
<p>system()</p>
<p>is not supported on stand-alone targets.</p>
<p><b>J.3.3 Identifiers</b></p>
<p>Multibyte characters may not appear in identifiers, although universal character</p>
<p>names may.</p>
<p>There is no limit to the number of significant initial characters in an identifier.</p>
<p>Case is significant in an identifier with external linkage.</p>
<p><b>J.3.4 Characters</b></p>
<p>There are eight bits in a character in the execution character set.</p>
<p>The basic execution character set includes all possible single-byte characters and</p>
<p>the multibyte character set includes all possible 4-byte characters.</p>
<p>The escape sequence values are as follows.</p>
<p><b>Value</b></p>
<p><b>Sequence</b></p>
<p>7</p>
<p>\a</p>
<p>8</p>
<p>\b</p>
<p>12</p>
<p>\f</p>
<p>10</p>
<p>\n</p>
<p>13</p>
<p>\r</p>
<p>9</p>
<p>\t</p>
<p>11</p>
<p>\v</p>
<p>char</p>
<p>is an 8-bit arithmetic type with the usual properties.</p>
<p><i>705</i></p>
<p><i>Green Hills Software</i></p>
<p><i>J.3.3 Identifiers</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The character type</p>
<p>char</p>
<p>is</p>
<p>signed</p>
<p>by default. To control the signedness of</p>
<p>chars</p>
<p>manually, see âSignedness of Char Typeâ on page 213.</p>
<p>The source and execution character sets are identical and the mapping is direct.</p>
<p>An integer character constant may contain up to four characters. The value is</p>
<p>calculated as follows: the least significant byte of the integer is the ASCII code for</p>
<p>the rightmost character. The next byte of the integer is the ASCII code for the second</p>
<p>character from the right, and so on.</p>
<p>A wide character constant that contains more than one multi-byte character has the</p>
<p>same integer value as a wide character constant consisting only of the rightmost</p>
<p>multi-byte character.</p>
<p>The C locale is used to convert multi-byte characters into corresponding wide</p>
<p>characters (codes) for a wide character constant. The C locale is documented in</p>
<p><i>X3J11/90-013</i> under section 7.4.1.1 and in the ISO C99 standard under section</p>
<p>7.11.1.1. Only the C locale is implemented.</p>
<p>Any byte</p>
<p>B</p>
<p>which does not begin a valid multi-byte character is treated as a</p>
<p>single-byte multibyte sequence mapping to the value</p>
<p>(unsigned char)B</p>
<p>.</p>
<p><b>J.3.5 Integers</b></p>
<p>The table below shows the storage and range of various variable types:</p>
<p><b>Range</b></p>
<p><b>Size</b></p>
<p><b>(bits)</b></p>
<p><b>Designation</b></p>
<p>If</p>
<p>char</p>
<p>is signed,</p>
<p>-128..127</p>
<p>If</p>
<p>char</p>
<p>is unsigned,</p>
<p>0..255</p>
<p>For information about the signedness of</p>
<p>char</p>
<p>, see</p>
<p>âSignedness of Char Typeâ on page 213.</p>
<p>8</p>
<p>char</p>
<p>-128..127</p>
<p>8</p>
<p>signed char</p>
<p>0..255</p>
<p>8</p>
<p>unsigned char</p>
<p>-32768..32767</p>
<p>16</p>
<p>short</p>
<p>0..65535</p>
<p>16</p>
<p>unsigned short</p>
<p>-2147483648..2147483647</p>
<p>32</p>
<p>int</p>
<p>0..4294967295</p>
<p>32</p>
<p>unsigned int</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>706</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Range</b></p>
<p><b>Size</b></p>
<p><b>(bits)</b></p>
<p><b>Designation</b></p>
<p>-2147483648..2147483647</p>
<p>or</p>
<p>-9223372036854775808..9223372036854775807</p>
<p>32 or</p>
<p>64</p>
<p>long</p>
<p>0..4294967295</p>
<p>or</p>
<p>0..18446744073709551615</p>
<p>32 or</p>
<p>64</p>
<p>unsigned long</p>
<p>-9223372036854775808..9223372036854775807</p>
<p>64</p>
<p>long long</p>
<p>0..18446744073709551615</p>
<p>64</p>
<p>unsigned long long</p>
<p>Conversion of an unsigned integer to a signed integer of equal length does not</p>
<p>modify the bit pattern of the number. Signed integers are represented in two's</p>
<p>complement. Therefore, such a conversion on a number with the high order bit set</p>
<p>produces a negative number equal to</p>
<p><i>original_value</i> - 2</p>
<p><i>n</i></p>
<p>, where<i> n</i> is the</p>
<p>number of bits.</p>
<p>Conversion of an unsigned integer to a signed integer of an unequal length is</p>
<p>equivalent to converting the unsigned integer to an unsigned integer of an equivalent</p>
<p>size to the signed type, then performing an unsigned to signed conversion in</p>
<p>accordance with the previous paragraph.</p>
<p>Extended integer types are not supported on stand-alone targets.</p>
<p>Truncation occurs when an integer is converted to a shorter signed integer.</p>
<p>The result of bitwise operations on signed integers is a signed integer whose two's</p>
<p>complement representation is the result of applying the bitwise operation on the</p>
<p>two's complement representation of the arguments.</p>
<p>The sign of the remainder of integer division will have the same sign as the dividend,</p>
<p>if the remainder is not zero.</p>
<p>The right shift of a negative-value signed integral type produces a signed integral</p>
<p>value, arithmetically shifted to the right.</p>
<p><b>J.3.6 Floating-Point</b></p>
<p>The standard library's floating-point routines are intended to be sufficiently accurate</p>
<p>for normal use, but make no guarantees about worst-case accuracy in terms of ULP.</p>
<p><i>707</i></p>
<p><i>Green Hills Software</i></p>
<p><i>J.3.6 Floating-Point</i></p>
<h1 style="page-break-before:always; "></h1>
<p>FLT_ROUNDS</p>
<p>has no implementation-defined values.</p>
<p>FLT_EVAL_METHOD</p>
<p>has no implementation-defined values.</p>
<p>The direction of truncation when an integral number is converted to a floating-point</p>
<p>number that cannot exactly represent the original value is to the nearest representable</p>
<p>value. In other words, the value is rounded.</p>
<p>The direction of truncation or rounding when a floating-point number is converted</p>
<p>to a narrower floating-point number is to the nearest representable value.</p>
<p>The</p>
<p>FP_CONTRACT #pragma</p>
<p>directive is recognized in C99 mode but has no effect</p>
<p>on code generation. The compiler may contract floating-point expressions when</p>
<p>optimizing for speed or size.</p>
<p>The</p>
<p>FENV_ACCESS #pragma</p>
<p>directive is recognized in C99 mode but not obeyed.</p>
<p>There are no implementation-defined floating-point exceptions, rounding modes,</p>
<p>environments, or classifications.</p>
<p>The storage requirements and the ranges of the floating-point types are shown</p>
<p>below:</p>
<p><b>Range</b></p>
<p><b>Size</b></p>
<p><b>(bits)</b></p>
<p><b>Designation</b></p>
<p>1.1754943635e-38</p>
<p>to</p>
<p>3.4028235e+38</p>
<p>32</p>
<p>float</p>
<p>2.2250738585072015e-308</p>
<p>to</p>
<p>1.7976931348623158e+308</p>
<p>64</p>
<p>double</p>
<p>2.2250738585072015e-308</p>
<p>to</p>
<p>1.7976931348623158e+308</p>
<p>64</p>
<p>long double</p>
<p><b>J.3.7 Arrays and Pointers</b></p>
<p>Casting a pointer to an integer type or vice versa has no effect on the bit pattern of</p>
<p>the value. Converting to a smaller type truncates bits, and converting to a larger</p>
<p>type sign-extends or zero-extends, depending upon the setting of</p>
<p><b>--signed_pointers</b>/<b>--unsigned_pointers</b> in the case of pointer-to-integer conversion.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>708</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Pointer subtraction yields a result of type</p>
<p>ptrdiff_t</p>
<p>, which is a signed version</p>
<p>of</p>
<p>size_t</p>
<p>and has the same size as a pointer.</p>
<p><b>J.3.8 Hints</b></p>
<p>The register storage-class specifier is essentially ignored when making decisions</p>
<p>about register allocation.</p>
<p>Functions declared as</p>
<p>inline</p>
<p>are generally inlined. When optimizing for size, less</p>
<p>inlining is performed. You can disable most inlining with the<b> âno_inlining</b> option.</p>
<p><b>J.3.9 Structures, Unions, Enumerations and Bit-fields</b></p>
<p>For information about controlling the signedness of bitfields, see âSignedness of</p>
<p>Bitfieldsâ on page 689.</p>
<p>Members of structures are padded and aligned as described in âV850 and RH850</p>
<p>Characteristicsâ on page 26. All structure members except bitfields begin on a byte</p>
<p>boundary. A structure is aligned according to the strictest alignment of any of its</p>
<p>members. An array member is aligned according to the alignment requirement of</p>
<p>its elements. Padding is performed when necessary to ensure that a member or</p>
<p>bitfield begins on its required alignment. There is never any padding before the first</p>
<p>member or bitfield, but there is padding after the last member or bitfield if it is</p>
<p>needed to ensure that the size of the structure is a multiple of its alignment.</p>
<p>Bitfields may be declared with any standard integer base type (including</p>
<p>signed</p>
<p>long long</p>
<p>and</p>
<p>unsigned long long</p>
<p>if supported). They may also be declared</p>
<p>with</p>
<p>_Bool</p>
<p>or</p>
<p>enum</p>
<p>base types. When a bitfield is used in an integral context, its</p>
<p>value is converted to a standard integer type in the following way. All standard</p>
<p>integer types with rank greater than or equal to</p>
<p>int</p>
<p>are ordered from least to greatest</p>
<p>rank with signed types preceding unsigned types of the same rank. The value is</p>
<p>then converted to the first type in this ordering that can represent all of the values</p>
<p>of the original bitfield type. For example, on a target where the</p>
<p>long</p>
<p>type has the</p>
<p>same number of bits as the</p>
<p>int</p>
<p>type and the</p>
<p>long long</p>
<p>type is supported, a bitfield</p>
<p>value would be promoted as follows. If an</p>
<p>int</p>
<p>can represent all values of the original</p>
<p>type, the value is converted to an</p>
<p>int</p>
<p>; otherwise, if an</p>
<p>unsigned int</p>
<p>can represent</p>
<p>all values of the original type, the value is converted to an</p>
<p>unsigned int</p>
<p>;</p>
<p>otherwise, if a</p>
<p>long long</p>
<p>can represent all values of the original type, the value</p>
<p><i>709</i></p>
<p><i>Green Hills Software</i></p>
<p><i>J.3.8 Hints</i></p>
<h1 style="page-break-before:always; "></h1>
<p>is converted to a</p>
<p>long long</p>
<p>; otherwise, it is converted to an</p>
<p>unsigned long</p>
<p>long</p>
<p>.</p>
<p>A non-packed bitfield must be wholly contained within a storage unit meeting the</p>
<p>size and alignment requirements of its declared base type. Padding is inserted</p>
<p>between bitfields as required to satisfy this constraint. For example:</p>
<p>struct {</p>
<p>int</p>
<p>a:20;</p>
<p>int</p>
<p>b:20;</p>
<p>long long c:20;</p>
<p>};</p>
<p>On a target with 32-bit</p>
<p>ints</p>
<p>with 32-bit alignment, there will be 12 bits of padding</p>
<p>between</p>
<p>a</p>
<p>and</p>
<p>b</p>
<p>since</p>
<p>b</p>
<p>cannot cross a 32-bit aligned boundary. On a target with</p>
<p>64-bit</p>
<p>long longs</p>
<p>with 64-bit alignment, there will also be 12 bits of padding</p>
<p>between</p>
<p>b</p>
<p>and</p>
<p>c</p>
<p>since</p>
<p>c</p>
<p>cannot cross a 64-bit aligned boundary. On a target with</p>
<p>64-bit</p>
<p>long longs</p>
<p>with 32-bit alignment, there will be no padding between</p>
<p>b</p>
<p>and</p>
<p>c</p>
<p>since a</p>
<p>long long</p>
<p>can cross one 32-bit aligned boundary; however, if</p>
<p>c</p>
<p>were</p>
<p>declared to contain more than 44 bits, there would then be 12 bits of padding between</p>
<p>b</p>
<p>and</p>
<p>c</p>
<p>since a 32-bit aligned</p>
<p>long long</p>
<p>cannot cross two 32-bit aligned</p>
<p>boundaries.</p>
<p>As long as the above constraint is met, multiple bitfields, even those of different</p>
<p>base types, may occupy the same storage unit. Within a particular storage unit,</p>
<p>bitfields are allocated in increasing memory address order. This means on a</p>
<p>big-endian target the first bitfield will occupy the most significant bits of the storage</p>
<p>unit, and on a little-endian target the first bitfield will occupy the least significant</p>
<p>bits. For example:</p>
<p>struct {</p>
<p>int</p>
<p>a:10;</p>
<p>char</p>
<p>b:4;</p>
<p>short c:5;</p>
<p>};</p>
<p>Assuming that</p>
<p>ints</p>
<p>are 32 bits,</p>
<p>shorts</p>
<p>are 16 bits,</p>
<p>chars</p>
<p>are 8 bits, and the</p>
<p>alignment of each type matches its size, there will be no padding between</p>
<p>a</p>
<p>and</p>
<p>b</p>
<p>,</p>
<p>but there will be 2 bits of padding between</p>
<p>b</p>
<p>and</p>
<p>c</p>
<p>. All three fields will occupy one</p>
<p>4-byte storage unit, with</p>
<p>a</p>
<p>occupying the first byte,</p>
<p>a</p>
<p>and</p>
<p>b</p>
<p>sharing the second byte,</p>
<p>and</p>
<p>c</p>
<p>occupying the third byte.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>710</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For information about controlling the size and type of enumerations, see âEnumerated</p>
<p>Typesâ on page 692.</p>
<p><b>J.3.10 Qualifiers</b></p>
<p>A volatile access occurs when a volatile object's value is either read or modified.</p>
<p>If the volatile object is in memory, the compiler generates load and store instructions</p>
<p>for each access. The compiler might still optimize away an access to an automatic</p>
<p>(local) variable. As required by the standard, though, on return from</p>
<p>setjmp</p>
<p>, an</p>
<p>automatic volatile variable has the value it had as of the corresponding call to</p>
<p>longjmp</p>
<p>.</p>
<p><b>J.3.11 Preprocessing Directives</b></p>
<p>No</p>
<p>#pragma</p>
<p>directives allow header names.</p>
<p>Header names are passed through to the operating system unchanged. For example,</p>
<p>#include &quot;dir\x30&quot;</p>
<p>refers to a file named<b> dir\x30</b>, not to a file named<b> dir0</b>.</p>
<p>The value of a single character constant in a constant expression that controls</p>
<p>conditional inclusion matches the value of the same character constant in the</p>
<p>execution character set. Such a character constant can have a negative value.</p>
<p>If the file is included using the form</p>
<p>#include &quot;<i>file</i>&quot;</p>
<p>, the directory containing</p>
<p>the file in which the</p>
<p>#include</p>
<p>directive occurs is searched first. If the directory</p>
<p>does not contain the file, or if the file is included using the form</p>
<p>#include &lt;<i>file</i>&gt;</p>
<p>,</p>
<p>a list of user-specified directories is searched. For information about specifying</p>
<p>include directories, see âUsing Your Own Header Files and Librariesâ on page 76.</p>
<p>A header name must correspond to a single preprocessing token. There is no pasting</p>
<p>of adjacent string literals.</p>
<p>There is no nesting limit for</p>
<p>#include</p>
<p>processing.</p>
<p>The</p>
<p>#</p>
<p>operator does not escape the backslash in</p>
<p>\u</p>
<p>when it stringizes a universal</p>
<p>character name.</p>
<p>For a list of the recognized</p>
<p>#pragma</p>
<p>directives, see âPragma Directivesâ on page 795.</p>
<p>The</p>
<p>__DATE__</p>
<p>and</p>
<p>__TIME__</p>
<p>macros always have a time available.</p>
<p><i>711</i></p>
<p><i>Green Hills Software</i></p>
<p><i>J.3.10 Qualifiers</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>J.3.12 Library Functions</b></p>
<p>The contents of the Green Hills libraries are documented in âGreen Hills Standard</p>
<p>C Library Functionsâ on page 832.</p>
<p>Given the following file<b> test.c</b>:</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;assert.h&gt;</p>
<p>int main()</p>
<p>{</p>
<p>assert(1==2);</p>
<p>return 0;</p>
<p>}</p>
<p>the program would print the following to</p>
<p>stderr</p>
<p>and then call</p>
<p>abort()</p>
<p>.</p>
<p>test.c, line 6: Assertion failed: &quot;1==2&quot;</p>
<p>The floating-point status flags stored by</p>
<p>fegetexceptflag()</p>
<p>are documented in</p>
<p><b>&lt;fenv.h&gt;</b>.</p>
<p>feraiseexcept()</p>
<p>does not raise any exceptions that were not explicitly requested.</p>
<p>No strings other than</p>
<p>&quot;&quot;</p>
<p>and</p>
<p>&quot;C&quot;</p>
<p>may be passed as the second argument to</p>
<p>setlocale()</p>
<p>.</p>
<p>float_t</p>
<p>and</p>
<p>double_t</p>
<p>are defined as</p>
<p>float</p>
<p>and</p>
<p>double</p>
<p>, respectively, when</p>
<p>FLT_EVAL_METHOD</p>
<p>is less than zero.</p>
<p>In the case of a domain error, mathematics functions return an appropriate value,</p>
<p>usually a positive or negative zero, NaN, or infinity.</p>
<p>Only the functions</p>
<p>exp()</p>
<p>,</p>
<p>pow()</p>
<p>, and</p>
<p>tan()</p>
<p>detect underflow and set</p>
<p>errno</p>
<p>to</p>
<p>ERANGE</p>
<p>.</p>
<p>When</p>
<p>fmod()</p>
<p>has a second argument of zero, a domain error occurs and zero is</p>
<p>returned.</p>
<p>When a remainder function has a second argument of zero, a domain error occurs</p>
<p>and the first argument is returned.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>712</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The base-2 logarithm of the modulus used by</p>
<p>remquo</p>
<p>functions is the size of</p>
<p>int</p>
<p>in bits (32).</p>
<p>When a</p>
<p>remquo</p>
<p>function has a second argument of zero, a domain error occurs and</p>
<p>the first argument is returned.</p>
<p>Signal handling does not happen on stand-alone targets.</p>
<p>NULL</p>
<p>expands to</p>
<p>((void*)0)</p>
<p>for the C language. For C++, the</p>
<p>NULL</p>
<p>macro expands</p>
<p>to either</p>
<p>0</p>
<p>or</p>
<p>0L</p>
<p>.</p>
<p>The last line of a text stream does not require a terminating newline character.</p>
<p>Space characters written out to a text stream immediately before a newline character</p>
<p>appear when the stream is read back.</p>
<p>No null characters are appended to data written to a binary stream.</p>
<p>The file position indicator of an append mode stream is initially positioned at the</p>
<p>end of the file.</p>
<p>A write on a text stream causes the associated file to be truncated beyond that point.</p>
<p>Unbuffered, fully buffered, and line buffered modes are all provided in hosted</p>
<p>environments. Embedded environments provide a limited form of buffering which</p>
<p>is essentially unbuffered, but which provides the benefits of buffering within</p>
<p>operations such as</p>
<p>fwrite()</p>
<p>and</p>
<p>printf()</p>
<p>.</p>
<p>A zero length file can exist.</p>
<p>The rules for composing a valid filename differ between systems.</p>
<p>The same file can be opened multiple times.</p>
<p>To select the encoding used in the encoding of files, use the driver option<b> -kanji=</b></p>
<p>(see âHost and Target Character Encodingâ on page 219).</p>
<p>Removing an open file has unpredictable results. In most cases the application</p>
<p>program will only have access to a portion of the file as it was before it was deleted.</p>
<p>Once the application exits, the file will cease to exist entirely even if the application</p>
<p>was writing to the file.</p>
<p><i>713</i></p>
<p><i>Green Hills Software</i></p>
<p><i>J.3.12 Library Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The effect of renaming a file to a name of a file which already exists varies between</p>
<p>systems. On some systems it is undetected and the old file is lost. On others, the</p>
<p>rename fails and all files remain unchanged.</p>
<p>An open temporary file is not removed if the program terminates abnormally.</p>
<p>The semantics of</p>
<p>freopen()</p>
<p>depend on the file system, but generally any file can</p>
<p>be reopened with any mode.</p>
<p>Any NaN is printed as</p>
<p>nan</p>
<p>. Infinity is printed as</p>
<p>inf</p>
<p>(for positive infinity) or</p>
<p>-inf</p>
<p>(for negative infinity).</p>
<p>The</p>
<p>%p</p>
<p>format descriptor in</p>
<p>printf()</p>
<p>behaves exactly as</p>
<p>%lx</p>
<p>.</p>
<p>If the</p>
<p>-</p>
<p>is neither the first character nor the last character in the scan list for</p>
<p>%[</p>
<p>conversion in the</p>
<p>fscanf</p>
<p>function, all characters in the range beginning with the</p>
<p>character preceding the</p>
<p>-</p>
<p>up to and including the character following the</p>
<p>-</p>
<p>are</p>
<p>added to the scan set. If the character following the</p>
<p>-</p>
<p>lexically precedes the character</p>
<p>before the</p>
<p>-</p>
<p>, then the</p>
<p>-</p>
<p>and the character following it are ignored.</p>
<p>The</p>
<p>%p</p>
<p>format descriptor in</p>
<p>scanf()</p>
<p>behaves exactly as</p>
<p>%lx</p>
<p>.</p>
<p>The functions</p>
<p>fgetpos()</p>
<p>and</p>
<p>ftell()</p>
<p>set</p>
<p>errno</p>
<p>to</p>
<p>EBADF</p>
<p>on failure.</p>
<p>When a string representing a NaN is converted by</p>
<p>strtod()</p>
<p>,</p>
<p>strtof()</p>
<p>,</p>
<p>strtold()</p>
<p>,</p>
<p>wcstod()</p>
<p>,</p>
<p>wcstof()</p>
<p>, or</p>
<p>wcstold()</p>
<p>any</p>
<p>n-char</p>
<p>or</p>
<p>n-wchar</p>
<p>sequence between parentheses is ignored.</p>
<p>The above functions do not set</p>
<p>errno</p>
<p>to</p>
<p>ERANGE</p>
<p>when underflow occurs.</p>
<p>The functions</p>
<p>calloc()</p>
<p>and</p>
<p>malloc()</p>
<p>return a valid pointer if the size requested</p>
<p>is zero. When you request a size of zero with the</p>
<p>realloc()</p>
<p>function, it returns</p>
<p>NULL</p>
<p>if you pass it a valid pointer, or a valid pointer if you pass it</p>
<p>NULL</p>
<p>.</p>
<p>When</p>
<p>abort()</p>
<p>is called, the buffers within the<b> stdio</b> library for open files are not</p>
<p>flushed. The files are closed and exist. Temporary files are not deleted.</p>
<p>The</p>
<p>abort()</p>
<p>function in the stand-alone library is equivalent to calling</p>
<p>raise(SIGABRT)</p>
<p>followed by</p>
<p>exit(EXIT_FAILURE)</p>
<p>. It does not call C++</p>
<p>destructors for global objects or functions registered with</p>
<p>atexit()</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>714</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The low-order eight bits of the argument passed to</p>
<p>exit()</p>
<p>are returned as the</p>
<p>status.</p>
<p>The</p>
<p>exit()</p>
<p>function in the stand-alone library is equivalent to calling the functions</p>
<p>registered by</p>
<p>atexit()</p>
<p>, followed by</p>
<p>_Exit(<i>status</i>)</p>
<p>.</p>
<p>system()</p>
<p>is provided by the operating system; it generally returns the result of the</p>
<p>executed command.</p>
<p>The era for the</p>
<p>time()</p>
<p>function's Local Specific Behavior is midnight, January 1,</p>
<p>1970 (GMT).</p>
<p>The replacement string for the</p>
<p>%Z</p>
<p>specifier to</p>
<p>strftime()</p>
<p>and</p>
<p>wcsftime()</p>
<p>is</p>
<p>one of</p>
<p>AST</p>
<p>,</p>
<p>EST</p>
<p>,</p>
<p>CST</p>
<p>,</p>
<p>MST</p>
<p>,</p>
<p>PST</p>
<p>,</p>
<p>AKT</p>
<p>,</p>
<p>HIT</p>
<p>,</p>
<p>MET</p>
<p>,</p>
<p>EET</p>
<p>,</p>
<p>WET</p>
<p>, or three space characters,</p>
<p>depending on the return value of</p>
<p>__gh_timezone()</p>
<p>.</p>
<p>fesetround()</p>
<p>and</p>
<p>fegetround()</p>
<p>are recognized but have no effect.</p>
<p>The macros specified in<b> &lt;float.h&gt;</b>,<b> &lt;limits.h&gt;</b>, and<b> &lt;stdint.h&gt;</b> are documented in</p>
<p>their respective header files.</p>
<p>The sizes of the basic types are specified in âJ.3.5 Integersâ on page 706. See also</p>
<p>âData Type Macrosâ on page 786.</p>
<p>For the layout of</p>
<p>struct</p>
<p>and</p>
<p>union</p>
<p>types, see âStructure Packingâ on page 28.</p>
<p>On a 32-bit target, the range of times representable in a value of type</p>
<p>time_t</p>
<p>is</p>
<p>from Dec 13 20:45:52 1901 (</p>
<p>-2147483648</p>
<p>or</p>
<p>0x80000000</p>
<p>) to Jan 19 03:14:07</p>
<p>2038 (</p>
<p>2147483647</p>
<p>or</p>
<p>0x7fffffff</p>
<p>). The precision is one second.</p>
<p>The following table explains the return values of the listed functions for certain</p>
<p>characters:</p>
<p><b>Characters for which non-zero value is returned</b></p>
<p><b>Function</b></p>
<p>'A'..'Z'</p>
<p>,</p>
<p>'a'..'z'</p>
<p>, and</p>
<p>'0'..'9'</p>
<p>isalnum()</p>
<p>'A'..'Z'</p>
<p>and</p>
<p>'a'..'z'</p>
<p>isalpha()</p>
<p>0..31</p>
<p>and</p>
<p>127</p>
<p>iscntrl()</p>
<p>'a'..'z'</p>
<p>islower()</p>
<p>32..126</p>
<p>isprint()</p>
<p>'A'..'Z'</p>
<p>isupper()</p>
<p><i>715</i></p>
<p><i>Green Hills Software</i></p>
<p><i>J.3.12 Library Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>J.4 Locale-Specific Behavior</b></p>
<p>The characters in the execution set in addition to those required by the C standard</p>
<p>are listed in âJ.3.4 Charactersâ on page 705.</p>
<p>There are no shift states in the encoding of multi-byte characters.</p>
<p>The direction of printing is left to right.</p>
<p>The decimal point character is a period (</p>
<p>.</p>
<p>).</p>
<p>The printing characters are those in the range</p>
<p>0x20</p>
<p>to</p>
<p>0x7E</p>
<p>, inclusive.</p>
<p>The control characters are those in the range</p>
<p>0x00</p>
<p>to</p>
<p>0x1F</p>
<p>, inclusive, and the single</p>
<p>character</p>
<p>0x7F</p>
<p>.</p>
<p>isalpha()</p>
<p>,</p>
<p>isupper()</p>
<p>,</p>
<p>islower()</p>
<p>, and</p>
<p>isdigit()</p>
<p>return the expected values.</p>
<p>isblank()</p>
<p>returns true for</p>
<p>0x09</p>
<p>and</p>
<p>0x20</p>
<p>.</p>
<p>isspace()</p>
<p>returns true for</p>
<p>0x09</p>
<p>,</p>
<p>0x0a</p>
<p>,</p>
<p>0x0b</p>
<p>,</p>
<p>0x0c</p>
<p>,</p>
<p>0x0d</p>
<p>, and</p>
<p>0x20</p>
<p>.</p>
<p>ispunct()</p>
<p>returns true for any printing</p>
<p>character not covered by the other functions.</p>
<p>iswfoo(wc)</p>
<p>returns the same value</p>
<p>as</p>
<p>isfoo((char)wc)</p>
<p>.</p>
<p>Only the C locale is implemented. The C locale is documented in<i> X3J11/90-013</i></p>
<p>under section 7.4.1.1 and in the ISO C99 standard under section 7.11.1.1.</p>
<p>For a detailed description of the C locale's values related to</p>
<p>strftime()</p>
<p>, see the</p>
<p>ISO C99 standard section 7.23.3.4, paragraph 7.</p>
<p>The program is run in the local time zone and Daylight Savings Time.</p>
<p>No non-standard sequences are supported by the numeric conversion functions.</p>
<p>The collation sequence of the execution character set is the natural numerical order.</p>
<p>There is little formatting style to the string returned by</p>
<p>strerror()</p>
<p>. The first</p>
<p>character is always capitalized and the string does not end with a period.</p>
<p>The function</p>
<p>perror()</p>
<p>prints a message in this format:</p>
<p><i>argument</i>:<i> contents_of_message</i></p>
<p>where<i> argument</i> is the parameter passed to</p>
<p>perror</p>
<p>and<i> contents_of_message</i> is a</p>
<p>predefined message associated with the current value of</p>
<p>errno</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>716</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The strings returned by</p>
<p>strerror</p>
<p>for the various values of</p>
<p>errno</p>
<p>are listed below:</p>
<p>18:</p>
<p>&quot;Cross-device link&quot;</p>
<p>00:</p>
<p>&quot;Error 0 (no error)&quot;</p>
<p>19:</p>
<p>&quot;No such device&quot;</p>
<p>01:</p>
<p>&quot;Not owner&quot;</p>
<p>20:</p>
<p>&quot;Not a directory&quot;</p>
<p>02:</p>
<p>&quot;No such file or directory&quot;</p>
<p>21:</p>
<p>&quot;Is a directory&quot;</p>
<p>03:</p>
<p>&quot;No such process&quot;</p>
<p>22:</p>
<p>&quot;Invalid argument&quot;</p>
<p>04:</p>
<p>&quot;Interrupted system call&quot;</p>
<p>23:</p>
<p>&quot;File table overflow&quot;</p>
<p>05:</p>
<p>&quot;I/O error&quot;</p>
<p>24:</p>
<p>&quot;Too many open files&quot;</p>
<p>06:</p>
<p>&quot;No such device or address&quot;</p>
<p>25:</p>
<p>&quot;Not a typewriter&quot;</p>
<p>07:</p>
<p>&quot;Arg list too long&quot;</p>
<p>26:</p>
<p>&quot;Text file busy&quot;</p>
<p>08:</p>
<p>&quot;Exec format error&quot;</p>
<p>27:</p>
<p>&quot;File too large&quot;</p>
<p>09:</p>
<p>&quot;Bad file number&quot;</p>
<p>28:</p>
<p>&quot;No space left on device&quot;</p>
<p>10:</p>
<p>&quot;No children&quot;</p>
<p>29:</p>
<p>&quot;Illegal seek&quot;</p>
<p>11:</p>
<p>&quot;No more processes&quot;</p>
<p>30:</p>
<p>&quot;Read-only file system&quot;</p>
<p>12:</p>
<p>&quot;Not enough core&quot;</p>
<p>31:</p>
<p>&quot;Too many links&quot;</p>
<p>13:</p>
<p>&quot;Permission denied&quot;</p>
<p>32:</p>
<p>&quot;Broken pipe&quot;</p>
<p>14:</p>
<p>&quot;Bad address&quot;</p>
<p>33:</p>
<p>&quot;Argument too large&quot;</p>
<p>15:</p>
<p>&quot;Block device required&quot;</p>
<p>34:</p>
<p>&quot;Result too large&quot;</p>
<p>16:</p>
<p>&quot;Mount device busy&quot;</p>
<p>35:</p>
<p>&quot;Non standard error&quot;</p>
<p>17:</p>
<p>&quot;File exists&quot;</p>
<p>The standard library's</p>
<p>towctrans()</p>
<p>provides only what is required by the Standard.</p>
<p>towupper(wc)</p>
<p>returns</p>
<p>(unsigned char)toupper((char)wc)</p>
<p>, and</p>
<p>towlower(wc)</p>
<p>returns</p>
<p>(unsigned char)tolower((char)wc)</p>
<p>.</p>
<p>Only the classifications required by the Standard are supported by</p>
<p>iswctype()</p>
<p>.</p>
<p><b>Character Testing and Case Mapping</b></p>
<p>The execution character set in its natural sequence is the ASCII character set.</p>
<p>07 bel</p>
<p>06 ack</p>
<p>05 enq</p>
<p>04 eot</p>
<p>03 etx</p>
<p>02 stx</p>
<p>01 soh</p>
<p>00 nul</p>
<p>0F si</p>
<p>0E so</p>
<p>0D cr</p>
<p>0C np</p>
<p>0B vt</p>
<p>0A nl</p>
<p>09 ht</p>
<p>08 bs</p>
<p>17 etb</p>
<p>16 syn</p>
<p>15 nak</p>
<p>14 dc4</p>
<p>13 dc3</p>
<p>12 dc2</p>
<p>11 dc1</p>
<p>10 dle</p>
<p>1f us</p>
<p>1e rs</p>
<p>1d gs</p>
<p>1c fs</p>
<p>1b esc</p>
<p>1a sub</p>
<p>19 em</p>
<p>18 can</p>
<p><i>717</i></p>
<p><i>Green Hills Software</i></p>
<p><i>J.4 Locale-Specific Behavior</i></p>
<h1 style="page-break-before:always; "></h1>
<p>27 '</p>
<p>26 &amp;</p>
<p>25 %</p>
<p>24 $</p>
<p>23 #</p>
<p>22 &quot;</p>
<p>21 !</p>
<p>20 sp</p>
<p>2F /</p>
<p>2E .</p>
<p>2D -</p>
<p>2C ,</p>
<p>2B +</p>
<p>2A *</p>
<p>29 )</p>
<p>28 (</p>
<p>37 7</p>
<p>36 6</p>
<p>35 5</p>
<p>34 4</p>
<p>33 3</p>
<p>32 2</p>
<p>31 1</p>
<p>30 0</p>
<p>3F ?</p>
<p>3E &gt;</p>
<p>3D =</p>
<p>3C &lt;</p>
<p>3B ;</p>
<p>3A :</p>
<p>39 9</p>
<p>38 8</p>
<p>47 G</p>
<p>46 F</p>
<p>45 E</p>
<p>44 D</p>
<p>43 C</p>
<p>42 B</p>
<p>41 A</p>
<p>40 @</p>
<p>4F O</p>
<p>4E N</p>
<p>4D M</p>
<p>4C L</p>
<p>4B K</p>
<p>4A J</p>
<p>49 I</p>
<p>48 H</p>
<p>57 W</p>
<p>56 V</p>
<p>55 U</p>
<p>54 T</p>
<p>53 S</p>
<p>52 R</p>
<p>51 Q</p>
<p>50 P</p>
<p>5F _</p>
<p>5E ^</p>
<p>5D ]</p>
<p>5C \</p>
<p>5B [</p>
<p>5A Z</p>
<p>59 Y</p>
<p>58 X</p>
<p>67 g</p>
<p>66 f</p>
<p>65 e</p>
<p>64 d</p>
<p>63 c</p>
<p>62 b</p>
<p>61 a</p>
<p>60 `</p>
<p>6F o</p>
<p>6E n</p>
<p>6D m</p>
<p>6C l</p>
<p>6B k</p>
<p>6A j</p>
<p>69 i</p>
<p>68 h</p>
<p>77 w</p>
<p>76 v</p>
<p>75 u</p>
<p>74 t</p>
<p>73 s</p>
<p>72 r</p>
<p>71 q</p>
<p>70 p</p>
<p>7F del</p>
<p>7E ~</p>
<p>7D }</p>
<p>7C |</p>
<p>7B {</p>
<p>7A z</p>
<p>79 y</p>
<p>78 x</p>
<p>The</p>
<p>strftime()</p>
<p>function converts</p>
<p>%c</p>
<p>,</p>
<p>%x</p>
<p>, and</p>
<p>%X</p>
<p>as follows:</p>
<p>&quot;%a %b %d %H:%M:%S %Y&quot;</p>
<p>is equivalent to</p>
<p>&quot;%c&quot;</p>
<p>&quot;%a %b %d, %Y&quot;</p>
<p>is equivalent to</p>
<p>&quot;%x&quot;</p>
<p>&quot;%H:%M:%S&quot;</p>
<p>is equivalent to</p>
<p>&quot;%X&quot;</p>
<p><b>Additional Implementation Information</b></p>
<p>Defining a static function with the reserved name of a standard library function</p>
<p>results in undefined behavior. For more information, see the C99 standard, section</p>
<p>7.1.3, paragraph 2.</p>
<p>The</p>
<p>strtof()</p>
<p>,</p>
<p>strtod()</p>
<p>, and</p>
<p>strtold()</p>
<p>functions return the smallest non-zero</p>
<p>value with the same sign as the correct value. They then set</p>
<p>errno</p>
<p>to</p>
<p>ERANGE</p>
<p>.</p>
<p><b>Attributes</b></p>
<p>The Green Hills compiler supports the</p>
<p>__attribute__</p>
<p>keyword, which can be</p>
<p>used to annotate program entities with pertinent information that is not handled by</p>
<p>Standard C or C++. The syntax for</p>
<p>__attribute__</p>
<p>is the same as that supported</p>
<p>by the GNU compiler, but some GNU attributes are not supported by Green Hills</p>
<p>compilers and some Green Hills attributes are not supported by the GNU compiler.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>718</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If an attribute name is not listed in this section, it is not supported by Green Hills,</p>
<p>even if it is recognized by the compiler.</p>
<p>alias</p>
<p>Annotating the declaration of a function<i> foo</i> with</p>
<p>__attribute__((alias(&quot;<i>bar</i>&quot;)))</p>
<p>causes the compiler to refer to<i> foo</i> by</p>
<p>the name<i> bar</i> in the generated assembly or object file.</p>
<p>Aliases containing special symbols such as</p>
<p>.</p>
<p>and</p>
<p>$</p>
<p>might not be handled</p>
<p>correctly. Aliases that are treated as multiple tokens by the assembler, such as</p>
<p>bar+1</p>
<p>, are not escaped.</p>
<p>aligned</p>
<p>Annotating the definition of a function or variable with</p>
<p>__attribute__((aligned(<i>x</i>)))</p>
<p>causes the compiler to force the start of</p>
<p>that entity onto an<i> x</i>-byte boundary. In the case of local automatic variables,<i> x</i></p>
<p>must not exceed the stack alignment enforced by the current calling convention</p>
<p>(usually 4, 8, or 16 bytes).</p>
<p>Annotating a type definition with</p>
<p>__attribute__((aligned(<i>x</i>)))</p>
<p>causes</p>
<p>the compiler to align every variable and field of that type to an<i> x</i>-byte boundary.</p>
<p>For example:</p>
<p>typedef int IntVector[16] __attribute__((aligned(8)));</p>
<p>struct S {</p>
<p>int i;</p>
<p>IntVector iv; // will be preceded by 4 bytes of padding</p>
<p>};</p>
<p>void foo() {</p>
<p>static IntVector ivs; // 8-byte-aligned</p>
<p>IntVector iva; // 8-byte-aligned if allowed by calling convention</p>
<p>}</p>
<p>always_inline</p>
<p>Annotating a function with</p>
<p>__attribute__((always_inline))</p>
<p>causes the</p>
<p>compiler to inline calls to the function if it is able to do so, regardless of the</p>
<p>function's size and complexity. Note that this does not guarantee that all calls</p>
<p>to the function will be inlined. For example, the compiler will not inline calls</p>
<p>to the function if it is called recursively or declared as weak. Inlining may also</p>
<p>be impacted by<b> --one_instantiation_per_object</b> (see âOne Instantiation Per</p>
<p>Objectâ on page 228). Related diagnostics are 2021, 2022, and 2023. For more</p>
<p>information about controlling inlining, see âInlining Optimizationsâ on page 324.</p>
<p><i>719</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Attributes</i></p>
<h1 style="page-break-before:always; "></h1>
<p>at</p>
<p>Annotating a field definition with</p>
<p>__attribute__((at(<i>x</i>)))</p>
<p>causes the</p>
<p>compiler to issue diagnostic 1947 if the field does not indeed start at offset<i> x</i> (in</p>
<p>bytes) from the beginning of the current struct type. For example:</p>
<p>struct S {</p>
<p>union {</p>
<p>float f;</p>
<p>long l;</p>
<p>} u;</p>
<p>struct S *next __attribute__((at(4)));</p>
<p>// will compile silently in the case that u is 4 bytes long</p>
<p>// and next does not need to be preceded by any padding bytes,</p>
<p>// but will produce an error if long is 8 bytes</p>
<p>// or if pointers require 8-byte alignment</p>
<p>};</p>
<p>const</p>
<p>Annotating a function prototype with</p>
<p>__attribute__((const))</p>
<p>tells the</p>
<p>compiler that the function is</p>
<p>const</p>
<p>âa distinct concept from being a</p>
<p>const</p>
<p>member function. The</p>
<p>const</p>
<p>attribute is similar to the</p>
<p>pure</p>
<p>attribute, but it</p>
<p>may allow for further optimization and it imposes additional restrictions on</p>
<p>functions. Specifically, functions annotated with the</p>
<p>const</p>
<p>attribute may not</p>
<p>read from global memory, either by reading a global variable or by dereferencing</p>
<p>a pointer argument.</p>
<p>common</p>
<p>,</p>
<p>nocommon</p>
<p>Annotating the definition of an uninitialized global variable with</p>
<p>__attribute__((common))</p>
<p>forces it into commons, even when</p>
<p><b>--no_commons</b> is in effect. Annotating the definition with</p>
<p>__attribute__((nocommon))</p>
<p>forces it to be defined as a non-common</p>
<p>symbol, even when<b> --commons</b> is in effect. For more information about common</p>
<p>symbols, see the<b> C/C++ CompilerâC/C++ Data AllocationâAllocation of</b></p>
<p><b>Uninitialized Global Variables</b> option in âC/C++ Data Allocationâ on page 216.</p>
<p>deprecated</p>
<p>Annotating an entity with</p>
<p>__attribute__((deprecated))</p>
<p>causes any future</p>
<p>use of that entity (for example, calling a deprecated function or declaring a</p>
<p>variable of a deprecated type) to issue a warning. Related diagnostics are 1215</p>
<p>and 1441.</p>
<p>entry_exit_history</p>
<p>Annotating a function with</p>
<p>__attribute__((entry_exit_history(1)))</p>
<p>causes the compiler to instrument the function for entry/exit history, regardless</p>
<p>of compiler options.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>720</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Annotating a function with</p>
<p>__attribute__((entry_exit_history(0)))</p>
<p>causes the compiler not to instrument the function for entry/exit history,</p>
<p>regardless of compiler options.</p>
<p>For more information, see âFunction Entry/Exit Historyâ on page 62.</p>
<p>externally_visible</p>
<p>Annotating a function or variable declaration with</p>
<p>__attribute__((externally_visible))</p>
<p>tells the compiler that there may</p>
<p>be unseen references to the symbol even when the code is compiled with</p>
<p><b>-Owholeprogram</b> (see âWholeprogram Optimizationsâ on page 341).</p>
<p>final</p>
<p>Annotating the declaration of a C++ virtual member function with</p>
<p>__attribute__((final))</p>
<p>tells the compiler that although this function might</p>
<p>override a virtual member function of a parent class, it will never be overridden</p>
<p>by any child of this class. This allows the compiler to optimize a virtual call into</p>
<p>a non-virtual call, in cases where the actual type of the object being invoked can</p>
<p>be deduced at compile time.</p>
<p>Annotating a class type definition with</p>
<p>__attribute__((final))</p>
<p>is</p>
<p>equivalent to annotating every virtual member function of that class with the</p>
<p>same attribute.</p>
<p>format</p>
<p>The</p>
<p>format</p>
<p>attribute annotates a function prototype for argument checking.</p>
<p>Green Hills implements argument checking for several different standard library</p>
<p>functions.</p>
<p>__attribute__((format(printf,<i>m</i>,<i>n</i>)))</p>
<p>means that this function behaves</p>
<p>like</p>
<p>printf()</p>
<p>; the<i> m</i>th argument is a format string and the (possibly empty)</p>
<p>set of arguments starting with the<i> n</i>th are the values to be matched with the</p>
<p>format specifiers in the format string. If<i> n</i> is zero, then no matching is performed,</p>
<p>but the format string is still checked to see if each individual specifier is valid.</p>
<p>The format string must conform to the ISO C99 specification for</p>
<p>printf()</p>
<p>;</p>
<p>for example,</p>
<p>%d</p>
<p>must expect an argument of type</p>
<p>int</p>
<p>. Related diagnostics are</p>
<p>181, 224, 225, 226, and 1932.</p>
<p>__attribute__((format(scanf,<i>m</i>,<i>n</i>)))</p>
<p>means that this function behaves</p>
<p>like</p>
<p>scanf()</p>
<p>; the<i> m</i>th argument is a format string and the (possibly empty) set</p>
<p>of arguments starting with the<i> n</i>th are the values to be matched with the format</p>
<p><i>721</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Attributes</i></p>
<h1 style="page-break-before:always; "></h1>
<p>specifiers in the format string. If<i> n</i> is zero, then no matching is performed, but</p>
<p>the format string is still checked to see if each individual specifier is valid.</p>
<p>The format string must conform to the ISO C99 specification for</p>
<p>scanf()</p>
<p>; for</p>
<p>example,</p>
<p>%d</p>
<p>must expect an argument of type</p>
<p>int *</p>
<p>. Related diagnostics are</p>
<p>181, 224, 225, 226, and 1932.</p>
<p>__attribute__((format(memset,<i>x</i>,<i>y</i>)))</p>
<p>means that this function takes</p>
<p>arguments similar to</p>
<p>memset()</p>
<p>; the<i> x</i>th argument is a pointer to an object or</p>
<p>array of objects, and the<i> y</i>th argument is a count of bytes. The compiler will</p>
<p>check that the<i> y</i>th argument is of the form</p>
<p><i>n</i>*sizeof(<i>e</i>)</p>
<p>where<i> n</i> is an arbitrary</p>
<p>expression and<i> e</i> has the same type as pointed to by the<i> x</i>th argument. Related</p>
<p>diagnostics are 1956, 1990, and 1991.</p>
<p>The compiler does not check whether the<i> x</i>th argument is writeable; the function</p>
<p>is not expected to behave like</p>
<p>memset()</p>
<p>in that way. For example:</p>
<p>// Build with --diag_warning=1956,1990,1991 to see the diagnostics.</p>
<p>void mem_zero(void *p, int n) __attribute__((format(memset,1,2)));</p>
<p>void *realloc(void *p, int n) __attribute__((format(memset,1,2)));</p>
<p>void f(int *a) {</p>
<p>mem_zero(a, 4); // produces diagnostic 1990</p>
<p>mem_zero(a, 4*sizeof(char)); // produces diagnostic 1991</p>
<p>a = realloc(a, 1); // produces diagnostics 1956 and 1990</p>
<p>}</p>
<p>__attribute__((format(memcpy,<i>x</i>,<i>y</i>,<i>z</i>)))</p>
<p>means that this function takes</p>
<p>arguments similar to</p>
<p>memcpy()</p>
<p>or</p>
<p>memcmp()</p>
<p>; the<i> x</i>th and<i> y</i>th arguments are</p>
<p>pointer to objects or arrays of objects, and the<i> z</i>th argument is a count of bytes.</p>
<p>The compiler will check that the<i> x</i>th and<i> y</i>th arguments are of the same type (or</p>
<p>that at least one of them is a pointer to void or a character type); the compiler</p>
<p>will also check that the<i> z</i>th argument is of the form</p>
<p><i>n</i>*sizeof(<i>e</i>)</p>
<p>where<i> n</i> is</p>
<p>an arbitrary expression and<i> e</i> has the same type as pointed to by the<i> x</i>th and<i> y</i>th</p>
<p>arguments.</p>
<p>The compiler does not check whether the<i> x</i>th argument is writeable; the function</p>
<p>is not expected to behave like</p>
<p>memcpy()</p>
<p>in that way.</p>
<p>format_arg</p>
<p>Annotating a function prototype with</p>
<p>__attribute__((format_arg(<i>m</i>)))</p>
<p>tells the compiler that the function might be used to preprocess a format string</p>
<p>for passing to a function that is similar to</p>
<p>printf()</p>
<p>. The compiler will allow</p>
<p>a call to this function anywhere that a format string argument would normally</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>722</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>be expected, as long as the<i> m</i>th argument to that call is itself (recursively) a valid</p>
<p>format string. For example:</p>
<p>// Build with -Wformat --diag_warning=181,1932 to see the diagnostics.</p>
<p>#include &lt;stdio.h&gt;</p>
<p>const char *bad(const char *x);</p>
<p>const char *good(const char *x) __attribute__((format_arg(1)));</p>
<p>void f() {</p>
<p>printf(bad(&quot;hello %d\n&quot;), 42); // produces diagnostic 1932</p>
<p>printf(bad(&quot;hello %s\n&quot;), 42); // produces diagnostic 1932</p>
<p>printf(good(&quot;hello %d\n&quot;), 42); // silently accepted</p>
<p>printf(good(&quot;hello %s\n&quot;), 42); // produces diagnostic 181</p>
<p>}</p>
<p>ghs_noprofile</p>
<p>Annotating a function with</p>
<p>__attribute__((ghs_noprofile))</p>
<p>indicates</p>
<p>that the function is not expected to be covered when a<b> -coverage=</b> option is</p>
<p>enabled. MULTI excludes this function and any code paths containing calls to</p>
<p>it from coverage calculations.</p>
<p>noinline</p>
<p>Annotating a function with</p>
<p>__attribute__((noinline))</p>
<p>tells the compiler</p>
<p>and linker not to consider the function for inlining. For more information about</p>
<p>controlling inlining, see âInlining Optimizationsâ on page 324.</p>
<p>nonnull</p>
<p>Annotating a function prototype with</p>
<p>__attribute__((nonnull(<i>m</i>)))</p>
<p>tells</p>
<p>the compiler that the<i> m</i>th argument should never be the constant</p>
<p>NULL</p>
<p>. The</p>
<p>compiler will produce diagnostic 1583 if</p>
<p>NULL</p>
<p>is ever passed in this argument</p>
<p>position.</p>
<p>noreturn</p>
<p>Annotating a function prototype with</p>
<p>__attribute__((noreturn))</p>
<p>tells</p>
<p>the compiler that this function never returns to its caller, and therefore any code</p>
<p>following the function call may be considered dead code and optimized away.</p>
<p>For example, this attribute can be used on the standard library functions</p>
<p>exit()</p>
<p>,</p>
<p>abort()</p>
<p>, and</p>
<p>longjmp()</p>
<p>.</p>
<p>nothrow</p>
<p>Annotating a C++ function prototype with</p>
<p>__attribute__((nothrow))</p>
<p>tells</p>
<p>the compiler that this function never throws an exception. This is different from</p>
<p>providing an empty throw-specification, because a throw-specification always</p>
<p>causes extra run-time code to be generated.</p>
<p>__attribute__((nothrow))</p>
<p>is</p>
<p>a lightweight way to tell the compiler that no exception-handling code need be</p>
<p><i>723</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Attributes</i></p>
<h1 style="page-break-before:always; "></h1>
<p>generated for this function. However, Green Hills does not guarantee that the</p>
<p>exception-handling code will actually be removed.</p>
<p>packed</p>
<p>Annotating a structure or structure field with</p>
<p>__attribute__((packed))</p>
<p>changes its packing alignment. When applied to a structure, this attribute has</p>
<p>an effect similar to</p>
<p>#pragma pack (1)</p>
<p>: all fields of the structure are reduced</p>
<p>to their minimum possible alignment (typically 1 byte). When applied to a</p>
<p>structure field, its packing alignment is reduced to the minimum possible</p>
<p>alignment (again, typically 1 byte). In this instance, the packing alignment of</p>
<p>other fields is left unchanged. For more information, see âStructure Packingâ</p>
<p>on page 28.</p>
<p>pure</p>
<p>Annotating a function prototype with</p>
<p>__attribute__((pure))</p>
<p>tells the</p>
<p>compiler that this function is<i> pure</i>: the state of the world is the same before and</p>
<p>after a call to this function. A pure function may read memory, throw a C++</p>
<p>exception, or even enter an infinite loop, but a pure function may not modify</p>
<p>global memory (for example, it may not write to a global variable, or write</p>
<p>through a pointer). Marking a function as pure may improve the compiler's</p>
<p>ability to perform alias analysis optimizations.</p>
<p>section</p>
<p>Annotating a function or variable definition with</p>
<p>__attribute__((section(&quot;<i>name</i>&quot;)))</p>
<p>causes the compiler to place that</p>
<p>function or variable in a user-defined section with the specified name. The name</p>
<p>must not be identical to a predefined section name such as</p>
<p>.text</p>
<p>or</p>
<p>.data</p>
<p>.</p>
<p>The effect is similar to that of</p>
<p>#pragma ghs section data=&quot;<i>name</i>&quot;</p>
<p>, except</p>
<p>that only a single variable or function is affected. For more information about</p>
<p>this directive, see âAssigning Data to Custom Program Sections in Câ</p>
<p>on page 84.</p>
<p>sentinel</p>
<p>Annotating a function prototype with</p>
<p>__attribute__((sentinel(<i>m</i>)))</p>
<p>tells</p>
<p>the compiler that this variadic function uses a sentinel value to find the end of</p>
<p>its variable argument list. The compiler will check that, in each call to this</p>
<p>function, the<i> m</i>th argument from the end of the argument list (where 0 represents</p>
<p>the last argument) is a constant null pointer. For example:</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#include &lt;stdarg.h&gt;</p>
<p>void print_result(int);</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>724</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>void __attribute__((sentinel(1))) for_each(int *p, ...)</p>
<p>{</p>
<p>typedef int (*FuncType)(int);</p>
<p>FuncType f;</p>
<p>int sum = *p;</p>
<p>va_list ap;</p>
<p>va_start(ap, p);</p>
<p>while ((p = va_arg(ap, int*)) != NULL)</p>
<p>sum += *p;</p>
<p>f = va_arg(ap, FuncType);</p>
<p>f(sum);</p>
<p>}</p>
<p>int a,b,c,d,e;</p>
<p>void f() {</p>
<p>for_each(&amp;a, &amp;b, &amp;c, NULL, print_result);</p>
<p>for_each(&amp;a, &amp;b, &amp;c, &amp;d, &amp;e, NULL, print_result);</p>
<p>for_each(&amp;a, &amp;b, &amp;c, NULL); // gives warning 1462</p>
<p>}</p>
<p>stackcheck</p>
<p>Allows you to enable stack checking on a per-function basis. To enable stack</p>
<p>checking for a function, use one of the following forms:</p>
<p>__attribute__((stackcheck))</p>
<p>__attribute__((stackcheck(1)))</p>
<p>If you are using the<b> -stack_check</b> option and want to disable stack checking for</p>
<p>a function, use:</p>
<p>__attribute__((stackcheck(0)))</p>
<p>strong_fptr</p>
<p>Annotating a function pointer</p>
<p>typedef</p>
<p>with</p>
<p>__attribute__((strong_fptr))</p>
<p>marks the type as a strong function pointer</p>
<p>and adds restrictions to how objects of that type may be used in order to enhance</p>
<p>static call graph analysis. For more information, see âThe gstack Utility Programâ</p>
<p>on page 600.</p>
<p>Legal operations for strong function pointers are:</p>
<p>â¢</p>
<p>assignment of a function name to a strong function pointer object (as long</p>
<p>as other C rules allow it)</p>
<p>â¢</p>
<p>assignment of a strong function pointer object to any object of the exact</p>
<p>same type</p>
<p>â¢</p>
<p>calls as with any other C function pointer</p>
<p><i>725</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Attributes</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>assignment of the return value of</p>
<p>malloc()</p>
<p>(or similar, such as</p>
<p>calloc()</p>
<p>)</p>
<p>to a type that points to a strong function pointer</p>
<p>For example:</p>
<p>typedef</p>
<p>int (*fptr_t)(void);</p>
<p>typedef __attribute__((strong_fptr)) int (*sfptr_t)(void);</p>
<p>fptr_t</p>
<p>fp1;</p>
<p>sfptr_t sfp1, sfp2;</p>
<p>sfptr_t *psfp;</p>
<p>int func(void);</p>
<p>sfp1 = func;</p>
<p>/* Legal - assign 'func' to a strong function pointer of</p>
<p>type 'sfptr_t' */</p>
<p>sfp2 = sfp1; /* Legal - assignment to an object of the same type */</p>
<p>(*sfp1)();</p>
<p>/* Legal - function call through the strong_fptr */</p>
<p>psfp = (sfptr_t*)malloc(sizeof(sfptr_t) * 10);</p>
<p>/* Legal - assignment of the return value of malloc to a pointer</p>
<p>to strong function pointer */</p>
<p>Operations that are not legal:</p>
<p>â¢</p>
<p>assignment of a strong function pointer value to an object that is not a strong</p>
<p>function pointer</p>
<p>â¢</p>
<p>assignment of a non-strong function pointer value that is not a function</p>
<p>name and not</p>
<p>NULL</p>
<p>to a strong function pointer object</p>
<p>â¢</p>
<p>assignment of a strong function pointer value to a strong function pointer</p>
<p>object of a different type</p>
<p>For example:</p>
<p>typedef __attribute__((strong_fptr)) int (*sfptr1_t)(void);</p>
<p>typedef __attribute__((strong_fptr)) int (*sfptr2_t)(void);</p>
<p>sfptr1_t sfp1;</p>
<p>sfptr2_t sfp2;</p>
<p>int</p>
<p>(*fp3)(void);</p>
<p>...</p>
<p>fp3</p>
<p>= sfp1;</p>
<p>/* Illegal - strong function pointer to non-strong */</p>
<p>sfp2 = fp3;</p>
<p>/* Illegal - non-strong function pointer to strong */</p>
<p>sfp1 = sfp2;</p>
<p>/* Illegal - different strong function pointer types */</p>
<p>Use of a strong function pointer type inside another type construct, such as a</p>
<p>struct, causes the containing type to take on properties similar to the above. For</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>726</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>example, it is illegal to cast a pointer to a struct to a different struct type if either</p>
<p>has a member that is a strong function pointer.</p>
<p>Annotating a struct or C++ class with this attribute creates a unique strong</p>
<p>function pointer type for each function pointer field of the structure, provided</p>
<p>that the field does not already have a strong function pointer type. For example:</p>
<p>typedef __attribute__((strong_fptr)) int (*sfptr_t)(void);</p>
<p>struct __attribute__((strong_fptr)) S {</p>
<p>/* strong function pointer types automatically created for fields</p>
<p>'op1', 'op2', and 'op3' */</p>
<p>void (*op1)(int, int);</p>
<p>void (*op2)(int);</p>
<p>int</p>
<p>(*op3)(void);</p>
<p>/* 'op4' already has a strong function pointer type */</p>
<p>sfptr_t op4;</p>
<p>/* non-function pointer fields are not affected */</p>
<p>int</p>
<p>i, j, k;</p>
<p>};</p>
<p>A struct or C++ class is considered to have strong function pointers if:</p>
<p>â¢</p>
<p>any of its direct fields are strong function pointers, or</p>
<p>â¢</p>
<p>any of its fields are another struct or C++ class that contains strong function</p>
<p>pointers, or</p>
<p>â¢</p>
<p>(for C++ classes) any of its base classes contain strong function pointers</p>
<p>Having a field that is a pointer to a strong function pointer or a struct or class</p>
<p>containing a strong function pointer does not cause a struct or C++ class to be</p>
<p>treated as having strong function pointers. The following are considered to have</p>
<p>strong function pointers:</p>
<p>typedef __attribute__((strong_fptr)) int (*sfptr_t)(void);</p>
<p>struct S1 {</p>
<p>sfptr_t fp;</p>
<p>/* directly contains a strong function pointer */</p>
<p>};</p>
<p>struct S2 {</p>
<p>struct S1 s1;</p>
<p>/* field is a struct with a strong function pointer */</p>
<p>};</p>
<p>struct __attribute__((strong_fptr)) S3 {</p>
<p>int (*myfp)(void); /* struct marks all function pointers as strong */</p>
<p>};</p>
<p><i>727</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Attributes</i></p>
<h1 style="page-break-before:always; "></h1>
<p>And in C++:</p>
<p>class Base {</p>
<p>sfptr_t fp;</p>
<p>};</p>
<p>class Derived : public Base {</p>
<p>/* base class contains strong function</p>
<p>pointer */</p>
<p>//...</p>
<p>};</p>
<p>However, the following are not considered to have a strong function pointer:</p>
<p>struct Z1 {</p>
<p>sfptr_t *pfp;</p>
<p>/* just a pointer to a strong function pointer */</p>
<p>};</p>
<p>struct Z2 {</p>
<p>struct S2 *ps2;</p>
<p>/* just a pointer to a struct with a strong</p>
<p>function pointer */</p>
<p>};</p>
<p>A struct or C++ class can be marked with</p>
<p>__attribute__((strong_fptr))</p>
<p>as long as:</p>
<p>â¢</p>
<p>no field members are a struct or class type that contain a function pointer</p>
<p>that is not strong</p>
<p>â¢</p>
<p>(for C++ classes) no base class contains a function pointer that is not strong</p>
<p>For example:</p>
<p>struct P1 {</p>
<p>int (*myfp)(void);</p>
<p>};</p>
<p>struct __attribute__((strong_fptr)) P2 {</p>
<p>struct P1 p1;</p>
<p>/* Illegal - P1 contains non-strong function pointer */</p>
<p>};</p>
<p>And in C++:</p>
<p>class Base {</p>
<p>int (*myfp)(void);</p>
<p>};</p>
<p>class __attribute__((strong_fptr)) Derived</p>
<p>: public Base {</p>
<p>/* Illegal - Base contains non-strong function pointer */</p>
<p>//...</p>
<p>};</p>
<p>The following operations are allowed on structs and C++ classes that contain a</p>
<p>strong function pointer:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>728</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>a struct pointer can be assigned to</p>
<p>void *</p>
<p>(and vice versa), but it is user</p>
<p>error to assign a struct pointer of one object to</p>
<p>void *</p>
<p>and then later cast</p>
<p>it to a different object. The compiler does not issue any errors for this illegal</p>
<p>case.</p>
<p>â¢</p>
<p>a pointer to the type of the first field of the struct can be assigned to the</p>
<p>struct pointer as long as there are no other fields with strong function</p>
<p>pointers.</p>
<p>For example:</p>
<p>typedef __attribute__((strong_fptr)) int (*sfptr_t)(void);</p>
<p>struct S1 {</p>
<p>sfptr_t fp;</p>
<p>};</p>
<p>struct S2 {</p>
<p>struct S1 s1;</p>
<p>};</p>
<p>void</p>
<p>*pv;</p>
<p>struct S1 *ps1;</p>
<p>struct S2 *ps2;</p>
<p>struct S3 *ps3;</p>
<p>...</p>
<p>pv = ps1;</p>
<p>/* Legal - assign struct pointer to 'void *' */</p>
<p>ps1 = pv;</p>
<p>/* Legal - assign 'void *' to struct pointer */</p>
<p>ps2 = (struct S2 *)ps1;</p>
<p>/* Legal - assign struct pointer to struct</p>
<p>whose first field has the same type */</p>
<p>ps3 = pv;</p>
<p>/* Illegal - assign 'void *' to different</p>
<p>struct type (no compiler error given) */</p>
<p>ps3 = (struct S3 *)ps1;</p>
<p>/* Illegal - assign struct pointer to different</p>
<p>struct type */</p>
<p>__attribute__((strong_fptr))</p>
<p>is not legal for unions.</p>
<p>The attribute may also be used with the syntax</p>
<p>__attribute__((strong_fptr(&quot;relax&quot;)))</p>
<p>to define a strong function</p>
<p>pointer type for which the type rules are relaxed. In addition to the operations</p>
<p>that are legal for the normal form of the attribute, the following operations are</p>
<p>allowed:</p>
<p>â¢</p>
<p>assignment of a relaxed strong function pointer value to an object that is</p>
<p>not itself a strong function pointer type and does not contain any strong</p>
<p>function pointer types</p>
<p><i>729</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Attributes</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>assignment of a value that is not itself a strong function pointer type and</p>
<p>does not contain any strong function pointer types to a relaxed strong</p>
<p>function pointer object</p>
<p>â¢</p>
<p>assignment of a strong function pointer value (with either form of type</p>
<p>rules) to a relaxed strong function pointer object</p>
<p>The relaxed form of the attribute is useful in circumstances where you cannot</p>
<p>change every value assigned to a strong function pointer object to use the same</p>
<p>type. Because operations involving types that are not strong function pointers</p>
<p>nullify the benefit of the attribute for<b> gstack</b>, we recommend that you use the</p>
<p>standard form over the relaxed form whenever possible.</p>
<p>If you declare an object (variable, parameter, field of a struct, return type, etc.)</p>
<p>to be of a</p>
<p>strong_fptr</p>
<p>type, you must use the same</p>
<p>strong_fptr</p>
<p>type in</p>
<p>all translation units where the object is declared. Otherwise, the results are</p>
<p>undefined.</p>
<p>transparent_union</p>
<p>Annotating the definition of a union type with</p>
<p>__attribute__((transparent_union))</p>
<p>marks that union type as</p>
<p><i>transparent</i>. In a function call where the formal parameter type is a transparent</p>
<p>union type and the actual argument type is the same type as one of the members</p>
<p>of that union, the compiler will silently generate code to accept the function call</p>
<p>with the natural semantics. For example:</p>
<p>#include &lt;stdio.h&gt;</p>
<p>union __attribute__((transparent_union)) U {</p>
<p>unsigned int ui;</p>
<p>float f;</p>
<p>};</p>
<p>unsigned int bit_representation(union U u) {</p>
<p>return u.ui;</p>
<p>}</p>
<p>int main() {</p>
<p>printf(&quot;%x&quot;, bit_representation(3.14f));</p>
<p>return 0;</p>
<p>}</p>
<p>__attribute__((transparent_union))</p>
<p>is not supported in C++ mode,</p>
<p>because it would interfere with function overload resolution.</p>
<p>unused</p>
<p>Annotating a function or variable definition with</p>
<p>__attribute__((unused))</p>
<p>tells the compiler that it is all right for this function or variable to have been</p>
<p>defined but not referenced in the current translation unit; that is, it suppresses</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>730</i></p>
<p><i>Chapter 12. Green Hills C</i></p>
<h1 style="page-break-before:always; "></h1>
<p>the warnings usually given at end of scope for unreferenced entities. Related</p>
<p>diagnostics are 177 and 826.</p>
<p>Annotating a type definition with</p>
<p>__attribute__((unused))</p>
<p>is equivalent</p>
<p>to annotating every variable of that type with the same attribute.</p>
<p>used</p>
<p>Annotating a function or variable definition with</p>
<p>__attribute__((used))</p>
<p>tells the compiler that this function or variable might be used in a hidden or</p>
<p>target-specific way; for example, it might be referenced from inline assembly</p>
<p>code. As with</p>
<p>__attribute__((unused))</p>
<p>, it suppresses the warnings usually</p>
<p>given at end of scope for unreferenced or unread variables. Related diagnostics</p>
<p>are 177, 550, and 826.</p>
<p>warn_unused_result</p>
<p>Annotating a function declaration with</p>
<p>__attribute__((warn_unused_result))</p>
<p>causes the compiler to issue a</p>
<p>warning whenever the function is called and the return value discarded. Related</p>
<p>diagnostics are 1611 and 1767. Diagnostic 1768 is given whenever any function</p>
<p>return value is discarded without an explicit cast to</p>
<p>void</p>
<p>.</p>
<p>weak</p>
<p>Annotating a function or variable declaration with</p>
<p>__attribute__((weak))</p>
<p>makes the declared symbol weak. For more information, see the documentation</p>
<p>about</p>
<p>#pragma weak<i> foo</i></p>
<p>in âPragma Directivesâ on page 795.</p>
<p><i>731</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Attributes</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 13</b></p>
<p><b>Green Hills C++</b></p>
<p><b>Contents</b></p>
<p>Specifying a C++ Language Dialect . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>734</p>
<p>Specifying C++ Libraries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>735</p>
<p>Standard C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>736</p>
<p>Embedded C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>739</p>
<p>Extended Embedded C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>741</p>
<p>Features Supported by Each C++ Dialect . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>741</p>
<p>Standard C++ with ARM Extensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>742</p>
<p>GNU C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>743</p>
<p>Template Instantiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>746</p>
<p>Multiple and Virtual Inheritance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>754</p>
<p>Namespace Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>756</p>
<p>Linkage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>758</p>
<p>Post Processing in C++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>759</p>
<p>The C++ decode Utility . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>760</p>
<p>C++ Implementation-Defined Features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>761</p>
<p>Deprecated C++ Headers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>766</p>
<h1 style="page-break-before:always; "></h1>
<p>This chapter describes the Green Hills implementation of C++, including aspects</p>
<p>of the language particular to our compilers.</p>
<p>The needs of C++ users vary widely, depending on a number of factors, including</p>
<p>the type of target application and environment, the foreign libraries used,</p>
<p>compatibility with other C++ compilers, and the trade-offs users make in regard to</p>
<p>the C++ feature set and library support they require. To meet such a diverse set of</p>
<p>needs, Green Hills Software supports a form of âscalableâ C++. You can specify</p>
<p>language and library levels to obtain everything from a small and efficient Embedded</p>
<p>C++ compiler and library, to full ISO Standard C++.</p>
<p><b>Specifying a C++ Language Dialect</b></p>
<p>To specify a C++ dialect:</p>
<p>Set the<b> C/C++ CompilerâC++ Language Dialect</b> option to one of the available</p>
<p>settings. For a list of driver options, see âC++ Language Dialectâ on page 185.</p>
<p>Several dialects are available, depending on which OS you are using for your project:</p>
<p>â¢</p>
<p>The<i> International Standard ISO/IEC 14882:2003</i> dialect (see âStandard C++â</p>
<p>on page 736).</p>
<p>â¢</p>
<p>The<i> Annotated C++ Reference Manual (ARM)</i> dialect (see âStandard C++ with</p>
<p>ARM Extensionsâ on page 742).</p>
<p>â¢</p>
<p>The GNU dialect (see âGNU C++â on page 743).</p>
<p>â¢</p>
<p>Embedded C++ (see âEmbedded C++â on page 739).</p>
<p>â¢</p>
<p>Extended Embedded C++ (see âExtended Embedded C++â on page 741).</p>
<p><b>Note</b></p>
<p>The Green Hills Tools do not support mixing C++ language dialects. Use</p>
<p>the same dialect when compiling and linking all C++ files in your project.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>734</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Specifying C++ Libraries</b></p>
<p>Depending on how you set<b> C/C++ CompilerâC++ Language Dialect</b> and<b> C/C++</b></p>
<p><b>CompilerâC++ Exception Handling</b>, the Green Hills Tools use the following</p>
<p>default for<b> C/C++ CompilerâC++ Libraries</b>:</p>
<p><b>Default C++ Libraries</b></p>
<p><b>C++ Exception Handling</b></p>
<p><b>C++ Language Dialect</b></p>
<p>C++ with exceptions</p>
<p><b>--stdle</b></p>
<p>On</p>
<p><b>--exceptions</b></p>
<p>Standard C++</p>
<p><b>--STD</b>,<b> --std</b>,<b> --arm</b>,<b> --g++</b></p>
<p>C++ without exceptions</p>
<p><b>--stdl</b></p>
<p>Off</p>
<p><b>--no_exceptions</b></p>
<p>EEC++ with exceptions</p>
<p><b>--eele</b></p>
<p>On</p>
<p><b>--exceptions</b></p>
<p>Extended Embedded C++</p>
<p><b>--ee</b></p>
<p>EEC++ without exceptions</p>
<p><b>--eel</b></p>
<p>Off</p>
<p><b>--no_exceptions</b></p>
<p>EC++ with exceptions</p>
<p><b>--ele</b></p>
<p>On</p>
<p><b>--exceptions</b></p>
<p>Embedded C++</p>
<p><b>--e</b></p>
<p>EC++ without exceptions</p>
<p><b>--el</b></p>
<p>Off</p>
<p><b>--no_exceptions</b></p>
<p>To link against a different set of Green Hills libraries, set the<b> C/C++</b></p>
<p><b>CompilerâC++ Libraries</b> option manually. You must specify an option that is</p>
<p>less full-featured than the default (and therefore lower in the table). The Green Hills</p>
<p>Tools do not support mixing C++ libraries. Use the same library when compiling</p>
<p>and linking all C++ files in your project.</p>
<p>For example, if you want to write code in C++ that uses exceptions while restricting</p>
<p>your use of library modules to those offered in EEC++, use the following options:</p>
<p>--std --exceptions --eele</p>
<p>The<b> C/C++ CompilerâC++ Libraries</b> option also sets the default</p>
<p>#include</p>
<p>paths so that the tools use the correct header files for the selected libraries.</p>
<p><i>735</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Specifying C++ Libraries</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>We recommend that you do not mix code that handles exceptions with</p>
<p>libraries that do not handle exceptions, or vice versa, as you may get</p>
<p>unexpected results when running your program.</p>
<p>If you do not want to link against any Green Hills standard libraries, see âLink in</p>
<p>Standard Librariesâ on page 314.</p>
<p><b>Standard C++</b></p>
<p>This dialect is defined by the<i> International Standard ISO/IEC 14882:2003</i> (except</p>
<p>as noted in this chapter). It also includes additional features and changes developed</p>
<p>after the standard. To specify use of this dialect:</p>
<p>Set the<b> C/C++ CompilerâC++ Language Dialect</b> option to either:</p>
<p>â¢</p>
<p><b>Standard C++ (Violations give Errors)</b> (<b>--STD</b> ), or</p>
<p>â¢</p>
<p><b>Standard C++ (Violations give Warnings)</b> (<b>--std</b> ) [default]</p>
<p>Some of the features in the standard are disabled by default. In order to obtain the</p>
<p>exact dialect specified by the standard, you need to set these additional options as</p>
<p>follows:</p>
<p>â¢</p>
<p>Set the<b> C/C++ CompilerâC++ Exception Handling</b> option to<b> On</b></p>
<p>(<b>--exceptions</b> ).</p>
<p>â¢</p>
<p>Set the<b> C/C++ CompilerâC++âTemplatesâRecognition of Exported</b></p>
<p><b>Templates</b> option to<b> On</b> (<b>--export</b></p>
<p>).</p>
<p>â¢</p>
<p>Set the<b> AdvancedâC/C++ Compiler OptionsâAdvanced C++</b></p>
<p><b>OptionsâDistinct C and C++ Functions</b> option to<b> On</b></p>
<p>(<b>--c_and_cpp_functions_are_distinct</b>).</p>
<p>â¢</p>
<p>Set the<b> C/C++ CompilerâC++âKeyword SupportâInstantiate Extern</b></p>
<p><b>Inline</b> option to<b> On</b> (<b>--instantiate_extern_inline</b>).</p>
<p>â¢</p>
<p>Set the<b> C/C++ CompilerâC++âTemplatesâImplicit Source File Inclusion</b></p>
<p>option to<b> Off</b> (<b>--no_implicit_include</b>). This setting is implied by<b> -export</b>.</p>
<p>By default, the<b> --STD</b> option enables<b> C/C++</b></p>
<p><b>CompilerâC++âTemplatesâDependent Name Processing</b> (<b>--dep_name</b> ) and</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>736</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>AdvancedâC/C++ Compiler OptionsâAdvanced C++ OptionsâDistinct C</b></p>
<p><b>and C++ Functions</b> (<b>--c_and_cpp_functions_are_distinct</b>). For more information</p>
<p>about<b> --dep_name</b>, see âNamespace Supportâ on page 756.</p>
<p><b>Extensions Accepted in Normal C++ Mode</b></p>
<p>The following extensions are accepted in all modes (except when strict ISO C</p>
<p>violations are diagnosed as errors):</p>
<p>â¢</p>
<p>A</p>
<p>friend</p>
<p>declaration for a class may omit the</p>
<p>class</p>
<p>keyword:</p>
<p>class B;</p>
<p>class A {</p>
<p>friend B;</p>
<p>// Should be &quot;friend class B&quot;</p>
<p>};</p>
<p>â¢</p>
<p>Constants of scalar type may be defined within classes:</p>
<p>class A {</p>
<p>const int size = 10;</p>
<p>int a[size];</p>
<p>};</p>
<p>â¢</p>
<p>In the declaration of a class member, a qualified name may be used:</p>
<p>struct A {</p>
<p>int A::f();</p>
<p>// Should be &quot;int f()&quot;</p>
<p>};</p>
<p>â¢</p>
<p>âAnonymous classesâ and âanonymous structuresâ are allowed as long as they</p>
<p>have no C++ features (e.g., no static data members or member functions and</p>
<p>no nonpublic members) and have no nested types other than other anonymous</p>
<p>classes, structures, or unions. For example:</p>
<p>struct A {</p>
<p>struct {</p>
<p>int i, j;</p>
<p>};</p>
<p>// Legal -- references to A::i and A::j</p>
<p>// are allowed</p>
<p>};</p>
<p><i>737</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Extensions Accepted in Normal C++ Mode</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>If you use the<b> --restrict</b> option, the type qualifier</p>
<p>restrict</p>
<p>is allowed for</p>
<p>reference and pointer-to-member types and for nonstatic member functions.</p>
<p>For more information about this option, see ârestrict Keyword Supportâ</p>
<p>on page 221.</p>
<p>â¢</p>
<p>Implicit type conversion between a pointer to an</p>
<p>extern &quot;C&quot;</p>
<p>function and a</p>
<p>pointer to an</p>
<p>extern &quot;C++&quot;</p>
<p>function is permitted. For example:</p>
<p>extern &quot;C&quot; void f();</p>
<p>// fâs type has</p>
<p>// extern &quot;C&quot; linkage</p>
<p>void (*pf)() = &amp;f;</p>
<p>// pf points to an</p>
<p>// extern &quot;C++&quot; function</p>
<p>// error unless implicit</p>
<p>// conversion is allowed</p>
<p>For more information, see âDistinct C and C++ Functionsâ on page 312.</p>
<p>â¢</p>
<p>In<b> --arm</b> mode, a</p>
<p>?</p>
<p>operator whose second and third operands are string literals</p>
<p>or wide string literals can be implicitly converted to</p>
<p>char *</p>
<p>or</p>
<p>wchar_t *</p>
<p>,</p>
<p>respectively. In C++, string literals are</p>
<p>const</p>
<p>. There is a deprecated implicit</p>
<p>conversion that allows conversion of a string literal to</p>
<p>char *</p>
<p>, dropping to</p>
<p>const</p>
<p>. That conversion, however, applies only to simple string literals.</p>
<p>Allowing it for the result of a</p>
<p>?</p>
<p>operation is an extension.</p>
<p>char *p = x ? &quot;abc&quot; : &quot;def&quot;;</p>
<p><b>Note</b></p>
<p>For more information about Standard C++, we recommend Stroustrup's</p>
<p><i>The C++ Programming Language</i>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>738</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Embedded C++</b></p>
<p>The Embedded C++ dialect (EC++) is intended as a stable, simple, and efficient</p>
<p>version of Standard C++, intended to produce an open, worldwide standard. EC++</p>
<p>is not a new language specification that competes with existing Standard C++; it is</p>
<p>a pure subset for the practical user of C++. The EC++ library is smaller and more</p>
<p>efficient than the Standard C++ library. For more information about EC++, visit</p>
<p>the Embedded C++ Web site [http://www.caravan.net/ec2plus/]. For a feature</p>
<p>comparison with Standard C++, see âFeatures Supported by Each C++ Dialectâ</p>
<p>on page 741.</p>
<p>To specify use of this dialect:</p>
<p>Set the<b> C/C++ CompilerâC++ Language Dialect</b> option to<b> Embedded C++</b></p>
<p>(<b>--e</b> ).</p>
<p><b>Differences Between Standard C++ and Embedded C++</b></p>
<p>In addition to the features and omissions mentioned in âFeatures Supported by Each</p>
<p>C++ Dialectâ on page 741, the following features behave differently in Embedded</p>
<p>C++ than in Standard C++.</p>
<p><b>std::string</b></p>
<p>In C++,</p>
<p>string</p>
<p>is a typedef for:</p>
<p>basic_string&lt;char, char_traits&lt;char&gt;, allocator&lt;char&gt; &gt;</p>
<p>In EC++, none of these template classes exist, and</p>
<p>string</p>
<p>is provided as a</p>
<p>non-template class. The EC++ library does not provide any wide character version</p>
<p>of string (there is no</p>
<p>wstring</p>
<p>).</p>
<p><b>Complex Numbers</b></p>
<p>In C++, the</p>
<p>&lt;complex&gt;</p>
<p>header defines a template class</p>
<p>complex&lt;T&gt;</p>
<p>with</p>
<p>specializations for</p>
<p>float</p>
<p>,</p>
<p>double</p>
<p>, and</p>
<p>long double</p>
<p>. In EC++, this template</p>
<p><i>739</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Embedded C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>class does not exist, and the</p>
<p>&lt;complex&gt;</p>
<p>header defines two non-template classes</p>
<p>float_complex</p>
<p>and</p>
<p>double_complex</p>
<p>, with all the same member functions as</p>
<p>the standard</p>
<p>complex&lt;float&gt;</p>
<p>and</p>
<p>complex&lt;double&gt;</p>
<p>, respectively. The EC++</p>
<p>library does not provide any equivalent to</p>
<p>complex&lt;long double&gt;</p>
<p>.</p>
<p><b>Streams and Buffers</b></p>
<p>In C++, the standard library provides a large number of âstreamâ and âbufferâ</p>
<p>classes â</p>
<p>filebuf</p>
<p>,</p>
<p>streambuf</p>
<p>,</p>
<p>stringbuf</p>
<p>,</p>
<p>istream</p>
<p>,</p>
<p>ostream</p>
<p>,</p>
<p>ifstream</p>
<p>,</p>
<p>and</p>
<p>ofstream</p>
<p>â each of which is implemented as a specialization of an underlying</p>
<p>template class named</p>
<p>basic_<i>class</i></p>
<p>. In EC++, none of these underlying template</p>
<p>classes exist, but the EC++ library provides non-template versions of the stream</p>
<p>classes with the same interfaces as the standard C++ versions. The EC++ library</p>
<p>does not provide any wide character streams or buffers (there is no</p>
<p>wistream</p>
<p>,</p>
<p>wstringbuf</p>
<p>, etc.).</p>
<p>The standard C++ classes</p>
<p>iostream</p>
<p>and</p>
<p>strstream</p>
<p>require multiple inheritance,</p>
<p>and therefore are not provided by EC++.</p>
<p>The only standard</p>
<p>iostream</p>
<p>objects provided by EC++ and EEC++ are</p>
<p>cin</p>
<p>and</p>
<p>cout</p>
<p>. The</p>
<p>cerr</p>
<p>and</p>
<p>clog</p>
<p>objects are omitted for simplicity, and the wide</p>
<p>iostream</p>
<p>objects</p>
<p>wcin</p>
<p>,</p>
<p>wcout</p>
<p>,</p>
<p>wcerr</p>
<p>, and</p>
<p>wclog</p>
<p>are omitted along with all of</p>
<p>the wide stream and buffer types.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>740</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Extended Embedded C++</b></p>
<p>Extended Embedded C++ is a hybrid of Standard C++ and Embedded C++, created</p>
<p>in a joint effort by Green Hills Software and P. J. Plauger. It is often referred to as</p>
<p>EEC++ or ESTL (Embedded C++ with the Standard Template Library). It is not</p>
<p>an official standard. For a feature comparison with Standard C++ and EC++, see</p>
<p>âFeatures Supported by Each C++ Dialectâ on page 741.</p>
<p>To specify use of this dialect:</p>
<p>Set the<b> C/C++ CompilerâC++ Language Dialect</b> option to<b> Extended Embedded</b></p>
<p><b>C++</b> (<b>--ee</b> ).</p>
<p><b>Features Supported by Each C++ Dialect</b></p>
<p>The following table compares the feature set of Standard C++, Extended Embedded</p>
<p>C++ (EEC++), and Embedded C++ (EC++). Features that are not listed in this table</p>
<p>can be individually controlled through Builder and driver options. For more</p>
<p>information about features marked with EC++, see âDifferences Between Standard</p>
<p>C++ and Embedded C++â on page 739.</p>
<p><b>EC++</b></p>
<p><b>EEC++</b></p>
<p><b>Standard</b></p>
<p><b>Feature</b></p>
<p>Optional</p>
<p>Optional</p>
<p>Optional</p>
<p>Exception support</p>
<p>EC++</p>
<p>EC++</p>
<p>C++</p>
<p>Complex numbers</p>
<p>EC++</p>
<p>EC++</p>
<p>C++</p>
<p>Streams and buffers</p>
<p>EC++</p>
<p>EC++</p>
<p>C++</p>
<p>string</p>
<p>Yes</p>
<p>Yes</p>
<p>Yes</p>
<p>wchar_t</p>
<p>Yes</p>
<p>Yes</p>
<p>Yes</p>
<p>cin</p>
<p>,</p>
<p>cout</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>Template support</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>Standard container classes</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>Namespace support</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>std::</p>
<p>namespace</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>bitset&lt;&gt;</p>
<p><i>741</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Extended Embedded C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>EC++</b></p>
<p><b>EEC++</b></p>
<p><b>Standard</b></p>
<p><b>Feature</b></p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>&lt;algorithm&gt;</p>
<p>,</p>
<p>&lt;functional&gt;</p>
<p>,</p>
<p>&lt;memory&gt;</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>mutable</p>
<p>keyword</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>static_cast&lt;&gt;</p>
<p>,</p>
<p>const_cast&lt;&gt;</p>
<p>,</p>
<p>reinterpret_cast&lt;&gt;</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>Multiple inheritance</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>dynamic_cast&lt;&gt;</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>&lt;locale&gt;</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>&lt;limits&gt;</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>wcin</p>
<p>,</p>
<p>wcout</p>
<p>, etc.</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>cerr</p>
<p>,</p>
<p>clog</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>iostream</p>
<p>,</p>
<p>strstream</p>
<p>No</p>
<p>No</p>
<p>Yes</p>
<p>&lt;typeinfo&gt;</p>
<p><b>Standard C++ with ARM Extensions</b></p>
<p>This dialect is ARM-compliant C++ as defined by<i> The Annotated C++ Reference</i></p>
<p><i>Manual</i> (ARM) by Ellis and Stroustrup (Addison-Wesley, 1990), including</p>
<p>templates, exceptions, and the anachronisms listed in Chapter 18 of that book. This</p>
<p>is essentially the same language defined by the language reference for Cfront version</p>
<p>3.0<i>x</i>, with the addition of exceptions.</p>
<p>To specify use of this dialect:</p>
<p>Set the<b> C/C++ CompilerâC++ Language Dialect</b> option to<b> Standard C++ with</b></p>
<p><b>ARM Extensions</b> (<b>--arm</b> ).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>742</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>GNU C++</b></p>
<p>This dialect closely emulates the C++ language supported by the GNU compiler.</p>
<p>To specify use of this dialect:</p>
<p>Set the<b> C/C++ CompilerâC++ Language Dialect</b> option to<b> GNU C++</b> (<b>--g++</b></p>
<p>).</p>
<p><b>GNU C++ Extensions</b></p>
<p>This dialect enables the extensions listed below, together with those in âGNU C/C++</p>
<p>Extensionsâ on page 673.</p>
<p>â¢</p>
<p>If an explicit instantiation is preceded by the keyword</p>
<p>extern</p>
<p>, no (explicit or</p>
<p>implicit) instantiation is created for the indicated specialization.</p>
<p>â¢</p>
<p>A special keyword</p>
<p>__null</p>
<p>expands to the same constant as the literal â</p>
<p>0</p>
<p>â, but</p>
<p>is expected to be used as a null pointer constant.</p>
<p>â¢</p>
<p>When dependent name processing is disabled, names from dependent base</p>
<p>classes are ignored only if another name would be found by the lookup.</p>
<p>const int n = 0;</p>
<p>template &lt;class T&gt; struct B {</p>
<p>static const int m = 1; static const int n = 2;</p>
<p>};</p>
<p>template &lt;class T&gt; struct D : B&lt;T&gt; {</p>
<p>int f() { return m + n; } // B::m + ::n in g++ mode</p>
<p>};</p>
<p>â¢</p>
<p>When doing name lookup in a base class, the injected class name of a template</p>
<p>class is ignored.</p>
<p>namespace N {</p>
<p>template &lt;class T&gt; struct A {};</p>
<p>}</p>
<p>struct A {</p>
<p>int i;</p>
<p>};</p>
<p><i>743</i></p>
<p><i>Green Hills Software</i></p>
<p><i>GNU C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>struct B : N::A&lt;int&gt; {</p>
<p>B() { A x; x.i = 1; } // g++ uses ::A, not N::A</p>
<p>};</p>
<p>â¢</p>
<p>The injected class name is found in certain contexts in which the constructor</p>
<p>should be found instead.</p>
<p>struct A {</p>
<p>A(int) {};</p>
<p>};</p>
<p>A::A a(1);</p>
<p>â¢</p>
<p>A difference in calling convention is ignored when redeclaring a typedef, even</p>
<p>when<b> --c_and_cpp_functions_are_distinct</b> is specified.</p>
<p>typedef void F();</p>
<p>extern &quot;C&quot; {</p>
<p>typedef void F(); // Accepted in GNU C++ mode (error otherwise)</p>
<p>}</p>
<p>â¢</p>
<p>The macro</p>
<p>__GNUG__</p>
<p>is defined identically to</p>
<p>__GNUC__</p>
<p>(i.e., the major version</p>
<p>number of the GNU compiler version that is being emulated).</p>
<p>â¢</p>
<p><b>GNU 3.3 ONLY</b> A friend declaration may refer to a member typedef.</p>
<p>class A {</p>
<p>class B {};</p>
<p>typedef B my_b;</p>
<p>friend class my_b;</p>
<p>};</p>
<p>â¢</p>
<p>An inherited type name can be used in a class definition and later redeclared</p>
<p>as a typedef.</p>
<p>struct A { typedef int I; };</p>
<p>struct B : A {</p>
<p>typedef I J;</p>
<p>// Refers to A::I</p>
<p>typedef double I; // Accepted in g++ mode</p>
<p>};</p>
<p>// (introduces B::I)</p>
<p>â¢</p>
<p>In a catch clause, an entity may be declared with the same name as the handler</p>
<p>parameter.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>744</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>try { }</p>
<p>catch(int e) {</p>
<p>char e;</p>
<p>}</p>
<p>â¢</p>
<p>A template argument list may appear following a constructor name in a</p>
<p>constructor definition that appears outside of the class definition:</p>
<p>template &lt;class T&gt; struct A {</p>
<p>A();</p>
<p>};</p>
<p>template &lt;class T&gt; A&lt;T&gt;::A&lt;T&gt;(){}</p>
<p>â¢</p>
<p><b>GNU 3.3 ONLY</b> A constructor need not provide an initializer for every</p>
<p>nonstatic const data member (but a warning is still issued if such an initializer</p>
<p>is missing).</p>
<p>struct S {</p>
<p>int const ic;</p>
<p>S() {} // Warning only in GNU C++ mode (error otherwise)</p>
<p>};</p>
<p>â¢</p>
<p>Exception specifications are ignored on function definitions when support for</p>
<p>exception handling is disabled (normally, they are only ignored on function</p>
<p>declarations that are not definitions).</p>
<p>â¢</p>
<p>A friend declaration in a class template may refer to an undeclared template.</p>
<p>template &lt;class T&gt; struct A {</p>
<p>friend void f&lt;&gt;(A&lt;T&gt;);</p>
<p>};</p>
<p>â¢</p>
<p>A function template default argument may be redeclared. A warning is issued</p>
<p>and the default from the initial declaration is used.</p>
<p>template&lt;class T&gt; void f(int i = 1);</p>
<p>template&lt;class T&gt; void f(int i = 2) {}</p>
<p>int main() {</p>
<p>f&lt;void&gt;();</p>
<p>}</p>
<p><i>745</i></p>
<p><i>Green Hills Software</i></p>
<p><i>GNU C++ Extensions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>A definition of a member function of a class template that appears outside of</p>
<p>the class may specify a default argument.</p>
<p>template &lt;class T&gt; struct A { void f(T); };</p>
<p>template &lt;class T&gt; void A&lt;T&gt;::f(T value = T()) {}</p>
<p><b>Template Instantiation</b></p>
<p>The C++ language includes the concept of templates. A template is a description</p>
<p>of a class or function that is a model for a family of related classes or functions. For</p>
<p>example, you can write a template for a</p>
<p>Stack</p>
<p>class, and then use a stack of integers,</p>
<p>a stack of floats, and a stack of some user-defined type. In the source, these might</p>
<p>be written</p>
<p>Stack&lt;int&gt;</p>
<p>,</p>
<p>Stack&lt;float&gt;</p>
<p>, and</p>
<p>Stack&lt;X&gt;</p>
<p>. From a single source</p>
<p>description of the template for a stack, the compiler can create instantiations of the</p>
<p>template for each of the types required.</p>
<p>The instantiations of template functions, member functions of template classes, and</p>
<p>static data members of template classes (hereafter referred to as<i> template entities</i>)</p>
<p>generally require special treatment by the compiler in order to ensure that only one</p>
<p>copy of each ends up in the program.</p>
<p>The Green Hills C++ compiler provides two methods of template instantiation,</p>
<p>which are described in the following sections.</p>
<p><b>Prelinker Template Instantiation</b></p>
<p>Prelinker instantiation, selected with the<b> --no_link_once_templates</b> option, is</p>
<p>disabled by default. To enable it:</p>
<p>Set the<b> C/C++ CompilerâC++âTemplatesâLink-Once Template</b></p>
<p><b>Instantiation</b> option to<b> Off</b> (<b>--no_link_once_templates</b> ). For more information</p>
<p>about this option, see âTemplatesâ on page 227.</p>
<p>The Green Hills C++ prelinker instantiation method works as follows:</p>
<p>1.</p>
<p>The first time the source files of a program are compiled, no template entities</p>
<p>are instantiated. However, template information files are generated and contain</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>746</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>information about entities that could have been instantiated in each compilation.</p>
<p>These template information files have a<b> .ti</b> suffix.</p>
<p>2.</p>
<p>When the object files are linked together, a program called the<i> prelinker</i> is</p>
<p>run. It examines the object files, looking for references and definitions of</p>
<p>template entities, and for the added information about entities that could be</p>
<p>instantiated.</p>
<p>3.</p>
<p>If the prelinker finds a reference to a template entity for which there is no</p>
<p>definition anywhere in the set of object files, it looks for a file that indicates</p>
<p>that it could instantiate that template entity. Upon finding such a file, the</p>
<p>prelinker assigns the instantiation to it. The set of instantiations assigned to a</p>
<p>given file is recorded in an associated instantiation request file (with a<b> .ii</b></p>
<p>suffix).</p>
<p>4.</p>
<p>The prelinker then executes the compiler again to recompile each file for which</p>
<p>the<b> .ii</b> file was changed. The original compilation options (saved in the<b> .ti</b> file)</p>
<p>are used for recompilation.</p>
<p>5.</p>
<p>When the compiler compiles a file, it reads the<b> .ii</b> file for that file and obeys</p>
<p>the instantiation requests therein. It produces a new object file containing the</p>
<p>requested template entities (and everything else already in the object file). The</p>
<p>compiler also receives a definition list file, which lists all the instantiations for</p>
<p>which definitions already exist in the set of object files. If during compilation</p>
<p>the compiler has the opportunity to instantiate a referenced entity that is not</p>
<p>on that list, it performs the instantiation. It passes back to the prelinker (in the</p>
<p>definition list file) a list of instantiations that it has âadoptedâ in this way, so</p>
<p>the prelinker can assign them to a file. This adoption process allows rapid</p>
<p>instantiation and assignment of instantiations referenced from new</p>
<p>instantiations, and reduces the need to recompile a given file more than once</p>
<p>during the prelinking process.</p>
<p>6.</p>
<p>The prelinker repeats steps 3-5 until there are no more instantiations to be</p>
<p>adjusted.</p>
<p>7.</p>
<p>The object files are linked together.</p>
<p>After the program has been linked correctly, the<b> .ii</b> files contain a complete set of</p>
<p>instantiation assignments. From then on, whenever source files are recompiled, the</p>
<p>compiler will consult the<b> .ii</b> files and do the indicated instantiations as it does the</p>
<p>normal compilations. That means that, except in cases where the set of required</p>
<p>instantiations changes, the prelink step from then on will find that all the necessary</p>
<p><i>747</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Prelinker Template Instantiation</i></p>
<h1 style="page-break-before:always; "></h1>
<p>instantiations are present in the object files and no adjustments will need to be made</p>
<p>to the instantiation assignments. This is true even if the entire program is recompiled.</p>
<p>If the programmer provides a specialization of a template entity somewhere in the</p>
<p>program, the specialization will be seen as a definition by the prelinker. Since that</p>
<p>definition satisfies whatever references there might be to that entity, the prelinker</p>
<p>will see no need to request an instantiation of the entity. If the programmer adds a</p>
<p>specialization to a program that has previously been compiled, the prelinker will</p>
<p>notice that too and remove the assignment of the instantiation from the proper<b> .ii</b></p>
<p>file.</p>
<p>The<b> .ii</b> files should not, in general, require any manual intervention. There are two</p>
<p>exceptions.</p>
<p>1.</p>
<p>If the following are true:</p>
<p>â¢</p>
<p>A definition is changed in such a way that some instantiation no longer</p>
<p>compiles (it gets errors), and</p>
<p>â¢</p>
<p>A specialization is added in another file, and</p>
<p>â¢</p>
<p>The first file is being recompiled before the specialization file and is</p>
<p>getting errors,</p>
<p>You must delete the<b> .ii</b> file for the file getting the errors to allow the prelinker</p>
<p>to regenerate it.</p>
<p>2.</p>
<p>If you use multiple major versions of the tools to build your project (for</p>
<p>example, MULTI 4 and MULTI 5), we recommend that you use multiple build</p>
<p>directories. If you do not use multiple build directories, you might get errors</p>
<p>when building your project in one release when<b> .ti</b> files reference configuration</p>
<p>options that only exist in the other release. If you get these errors, remove the</p>
<p>appropriate<b> .ti</b> and<b> .ii</b> files.</p>
<p>If the prelinker changes an instantiation assignment, it will issue a message such</p>
<p>as:</p>
<p>C++ prelinker: A&lt;int&gt;::f() assigned to file test.o</p>
<p>Instantiations are normally generated as part of the object file of the translation unit</p>
<p>in which the instantiations are performed. But when<i> one instantiation per object</i> is</p>
<p>used, each instantiation is placed in its own object file. This mode is useful when</p>
<p>building libraries that need to include copies of the instances referenced from the</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>748</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>library. If each instance is not placed in its own object file, it may be impossible to</p>
<p>link the library with another library containing some of the same instances.</p>
<p>To enable one instantiation per object:</p>
<p>Set the<b> C/C++ CompilerâC++âTemplatesâOne Instantiation Per Object</b></p>
<p>option to<b> On</b> (<b>--one_instantiation_per_object</b></p>
<p>). For more information about</p>
<p>this option, see âTemplatesâ on page 227.</p>
<p><b>Note</b></p>
<p>If you use one instantiation per object and you have a template that calls</p>
<p>a static function, you might not get debug information for that function.</p>
<p><b>Link-Once Template Instantiation</b></p>
<p>An alternative method of template instantiation is known as link-once template</p>
<p>instantiation. In this method, non-export templates that are used in a given source</p>
<p>file are always instantiated during compilation. Because a template can be used by</p>
<p>multiple source modules, some convention must be used to ensure that the definitions</p>
<p>of such templates in multiple object files does not result in multiply defined symbols</p>
<p>at link time. The templates are instantiated into specially named link-once sections</p>
<p>as if they had been declared with</p>
<p>__linkonce</p>
<p>(see âANSI C Extensionsâ</p>
<p>on page 663).</p>
<p>Link-once template instantiation is enabled by default. To explicitly disable it:</p>
<p>Set the<b> C/C++ CompilerâC++âTemplatesâLink-Once Template</b></p>
<p><b>Instantiation</b> option to<b> Off</b> (<b>--no_link_once_templates</b> ). For more information</p>
<p>about this option, see âTemplatesâ on page 227.</p>
<p>Because link-once template instantiation repeatedly compiles templates, link-once</p>
<p>template instantiation may result in longer compile times, although the initial build</p>
<p>of a project may be faster since prelink-time template instantiation will rebuild</p>
<p>objects during the initial prelink phase. Likewise, the size of intermediate object</p>
<p>files (but not the final executable) may be larger with link-once template</p>
<p>instantiation. Link-once template instantiation is often used in build environments</p>
<p>such as<b> clearmake</b>, where some aspect of prelink-time template instantiation is</p>
<p>undesirable, although the prelinker may still need to instantiate export templates.</p>
<p><i>749</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Link-Once Template Instantiation</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Instantiation Pragma Directives</b></p>
<p>Instantiation</p>
<p>#pragma</p>
<p>directives can be used to control the instantiation of specific</p>
<p>template entities or sets of template entities. This is sometimes used as an alternative</p>
<p>to Link-Once Template Instantiation in environments where minimizing the amount</p>
<p>of prelinking is desirable. There are three instantiation</p>
<p>#pragma</p>
<p>directives:</p>
<p>â¢</p>
<p>#pragma instantiate<i> fn</i></p>
<p>â Instructs the compiler to instantiate<i> fn</i>.</p>
<p>â¢</p>
<p>#pragma can_instantiate<i> fn</i></p>
<p>â Instructs the compiler to consider<i> fn</i></p>
<p>for instantiation. This</p>
<p>#pragma</p>
<p>is often used in conjunction with automatic</p>
<p>instantiation to indicate potential sites for instantiation if the template entity</p>
<p>turns out to be required.</p>
<p>â¢</p>
<p>#pragma do_not_instantiate<i> fn</i></p>
<p>â Instructs the compiler to not</p>
<p>instantiate<i> fn</i>. This</p>
<p>#pragma</p>
<p>is often used to suppress the instantiation of an</p>
<p>entity for which a specific definition will be supplied.</p>
<p>Each of the above instantiation</p>
<p>#pragma</p>
<p>directives takes an argument,<i> fn</i>, which</p>
<p>may be one of the following:</p>
<p>â¢</p>
<p>A template class name (e.g.,</p>
<p>A&lt;int&gt;</p>
<p>)</p>
<p>â¢</p>
<p>A template class declaration (e.g.,</p>
<p>class A&lt;int&gt;</p>
<p>)</p>
<p>â¢</p>
<p>A member function name (e.g.,</p>
<p>A&lt;int&gt;::f</p>
<p>)</p>
<p>â¢</p>
<p>A static data member name (e.g.,</p>
<p>A&lt;int&gt;::i</p>
<p>)</p>
<p>â¢</p>
<p>A static data declaration (e.g.,</p>
<p>int A&lt;int&gt;::i</p>
<p>)</p>
<p>â¢</p>
<p>A member function declaration (e.g.,</p>
<p>void A&lt;int&gt;::f(int, char)</p>
<p>)</p>
<p>â¢</p>
<p>A template function declaration (e.g.,</p>
<p>char* f(int, float)</p>
<p>)</p>
<p>A</p>
<p>#pragma</p>
<p>directive in which the argument is a template class name is equivalent</p>
<p>to repeating the directive for each member function and static data member declared</p>
<p>in the class. When instantiating an entire class a given member function or static</p>
<p>data member may be excluded using the</p>
<p>#pragma do_not_instantiate</p>
<p>directive.</p>
<p>For example:</p>
<p>#pragma instantiate A&lt;int&gt;</p>
<p>#pragma do_not_instantiate A&lt;int&gt;::f</p>
<p>The template definition of a template entity must be present in the compilation for</p>
<p>an instantiation to occur. If an instantiation is explicitly requested by use of the</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>750</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma instantiate</p>
<p>directive, and no template definition is available, or a</p>
<p>specific definition is provided, an error is issued.</p>
<p>template &lt;class T&gt; void f1(T);</p>
<p>// No body provided</p>
<p>template &lt;class T&gt; void g1(T);</p>
<p>// No body provided</p>
<p>void f1(int) {}</p>
<p>// Specific definition</p>
<p>void main()</p>
<p>{</p>
<p>int i;</p>
<p>double d;</p>
<p>f1(i);</p>
<p>f1(d);</p>
<p>g1(i);</p>
<p>g1(d);</p>
<p>}</p>
<p>#pragma instantiate void f1(int)</p>
<p>// error - specific</p>
<p>// definition</p>
<p>#pragma instantiate void g1(int)</p>
<p>// error - no body</p>
<p>// provided</p>
<p>f1(double)</p>
<p>and</p>
<p>g1(double)</p>
<p>will not be instantiated (because no bodies were</p>
<p>supplied) but no errors will be produced during the compilation (if no bodies are</p>
<p>supplied at link time, a linker error will be produced).</p>
<p>A member function name (for example,</p>
<p>A&lt;int&gt;::f</p>
<p>) can only be used as a</p>
<p>#pragma</p>
<p>argument if it refers to a single user-defined member function (that is, a function</p>
<p>that is not overloaded). Compiler-generated functions are not considered, so a name</p>
<p>may refer to a user-defined constructor even if a compiler-generated copy constructor</p>
<p>of the same name exists. Overloaded member functions can be instantiated by</p>
<p>providing the complete member function declaration. For example:</p>
<p>#pragma instantiate char* A&lt;int&gt;::f(int, char*)</p>
<p>The argument to an instantiation directive may not be a compiler-generated function,</p>
<p>an inline function, or a pure virtual function.</p>
<p><b>Implicit Inclusion</b></p>
<p><i>Implicit inclusion</i> permits the compiler to assume that if it needs a definition to</p>
<p>instantiate a template entity declared in a<b> .h</b> file it can implicitly include the</p>
<p>corresponding<b> .cc</b> file to get the source code for the definition. To enable this feature:</p>
<p><i>751</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Implicit Inclusion</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Set the<b> C/C++ CompilerâC++âTemplatesâImplicit Source File Inclusion</b></p>
<p>option to<b> On</b> (<b>--implicit_include</b> ).</p>
<p>For example, if a template entity</p>
<p>ABC::f</p>
<p>is declared in file<b> xyz.h</b>, and an</p>
<p>instantiation of</p>
<p>ABC::f</p>
<p>is required in a compilation but no definition of</p>
<p>ABC::f</p>
<p>appears in the source code processed by the compilation, the compiler searches for</p>
<p>an appropriately suffixed C++ source file whose base name is<b> xyz</b>; if the file is</p>
<p>found, the compiler processes it as if the file were included at the end of the main</p>
<p>source file.</p>
<p>To find the template definition file for a given template entity, the compiler needs</p>
<p>to know the full pathname of the file in which the template was declared and whether</p>
<p>the file was included using the system include syntax (e.g.,</p>
<p>#include &lt;file.h&gt;</p>
<p>).</p>
<p>This information is not available for preprocessed source code containing</p>
<p>#line</p>
<p>directives. Consequently, the compiler will not attempt implicit inclusion for source</p>
<p>code containing</p>
<p>#line</p>
<p>directives.</p>
<p>The following suffixes are searched for:</p>
<p>.c</p>
<p>,</p>
<p>.C</p>
<p>,</p>
<p>.cpp</p>
<p>,</p>
<p>.CPP</p>
<p>,</p>
<p>.cxx</p>
<p>,</p>
<p>.CXX</p>
<p>, and</p>
<p>.cc</p>
<p>.</p>
<p>Care should be taken when writing files that may be implicitly included. For instance,</p>
<p>if the file<b> xyz.cc</b> is implicitly included since it contains a definition of a template</p>
<p>declared in<b> xyz.h</b>, it is possible that more than one module will include it. In fact,</p>
<p>most likely any module that includes<b> xyz.h</b> will end up implicitly including<b> xyz.cc</b>.</p>
<p>In addition, if<b> xyz.cc</b> defines a global symbol (a non-template function or a variable),</p>
<p>every module which (implicitly) includes it will get that symbol definition. This</p>
<p>can lead to multiply defined symbol errors from the linker. This can be averted by</p>
<p>having only template definitions in files that can be implicitly included. An implicitly</p>
<p>included header file should be organized much the same way as any other header</p>
<p>file.</p>
<p>Since a file is automatically pulled in when the implicit inclusion is on, the compiler</p>
<p>driver or the builder do not need to separately compile it; just like a regular header</p>
<p>file does not need to be separately compiled.</p>
<p>If a source file is unexpectedly compiled via implicit inclusion, you may see strange</p>
<p>errors during compilation or linking. We recommend that you do not enable implicit</p>
<p>inclusion when you start new projects written in standard C++.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>752</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Exported Templates</b></p>
<p><b>Note</b></p>
<p>Exported templates are deprecated and will be removed in a future release.</p>
<p>Exported templates are templates declared with the keyword</p>
<p>export</p>
<p>, which is not</p>
<p>recognized by default. To enable this feature:</p>
<p>Set the<b> C/C++ CompilerâC++âTemplatesâRecognition of Exported</b></p>
<p><b>Templates</b> option to<b> On</b> (<b>--export</b></p>
<p>).</p>
<p><b>Note</b></p>
<p>This option requires and will automatically enable<b> C/C++</b></p>
<p><b>CompilerâC++âTemplatesâDependent Name Processing</b></p>
<p>(<b>--dep_name</b> ).</p>
<p>Exported templates and implicit inclusion (see âImplicit Inclusionâ</p>
<p>on page 751) are mutually exclusive. Enabling<b> C/C++</b></p>
<p><b>CompilerâC++âTemplatesâRecognition of Exported Templates</b></p>
<p>(<b>--export</b></p>
<p>) will automatically disable<b> C/C++</b></p>
<p><b>CompilerâC++âTemplatesâImplicit Source File Inclusion</b></p>
<p>(<b>--no_implicit_include</b> )</p>
<p>Exporting a class template is equivalent to exporting each of its static data members</p>
<p>and each of its non-inline member functions. An exported template is special because</p>
<p>its definition does not need to be present in a translation unit that uses that template.</p>
<p>In other words, the definition of an exported (non-class) template does not need to</p>
<p>be explicitly or implicitly included in a translation unit that instantiates that template.</p>
<p>For example, the following is a valid C++ program consisting of two separate</p>
<p>translation units:</p>
<p>// File 1:</p>
<p>#include &lt;stdio.h&gt;</p>
<p>static void trace() { printf(&quot;File 1\n&quot;); }</p>
<p>export template &lt;class T&gt; T const &amp; min(T const &amp;, T const &amp;);</p>
<p>int main() {</p>
<p>trace();</p>
<p><i>753</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Exported Templates</i></p>
<h1 style="page-break-before:always; "></h1>
<p>return min(2, 3);</p>
<p>}</p>
<p>// File 2:</p>
<p>#include &lt;stdio.h&gt;</p>
<p>static void trace() { printf(&quot;File 2\n&quot;); }</p>
<p>export template &lt;class T&gt; T const &amp; min(T const &amp;a,</p>
<p>T const &amp;b) {</p>
<p>trace();</p>
<p>return a &lt; b ? a : b;</p>
<p>}</p>
<p>Note that these two files are separate translation units: one is not included in the</p>
<p>other. That allows the two functions</p>
<p>trace()</p>
<p>to coexist (with internal linkage).</p>
<p><b>Note</b></p>
<p>We recommend that you do not use</p>
<p>export</p>
<p>templates; they have been</p>
<p>removed in the C++11 standard.</p>
<p><b>Multiple and Virtual Inheritance</b></p>
<p>When involving multiple and/or virtual inheritance, the Green Hills C++ compiler</p>
<p>has a limitation on the maximum byte offset of a base class within a derived class.</p>
<p>By default, this limit is either</p>
<p>2^32 - 1</p>
<p>, or the maximum value that fits in the</p>
<p>pointer type, whichever is lesser. However, with the deprecated</p>
<p><b>--no_large_vtbl_offsets</b> option, this limit is the maximum value that fits in the</p>
<p>unsigned short</p>
<p>type. If the offset of a base class within a derived class is larger</p>
<p>than the limit (as specified earlier in this paragraph), virtual function calls and RTTI</p>
<p>might not work properly. For example (assuming<b> --no_large_vtbl_offsets</b> is used):</p>
<p>class BIG_BASE {</p>
<p>public:</p>
<p>char c[70000];</p>
<p>virtual void foo();</p>
<p>};</p>
<p>class TWO_BASE {</p>
<p>public:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>754</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>int i;</p>
<p>virtual void bar();</p>
<p>};</p>
<p>// offset of TWO_BASE is sizeof(BIG_BASE), which doesn't fit</p>
<p>// into 'unsigned short' on most architectures - diagnostic</p>
<p>// is given</p>
<p>class DERIVED : public BIG_BASE, public TWO_BASE {</p>
<p>public:</p>
<p>// ...</p>
<p>};</p>
<p>In this type of situation, an error message is generated.</p>
<p>Where only single class inheritance is involved, the offset of a base class is always</p>
<p>0, so this limitation does not apply.</p>
<p>Because<b> --large_vtbl_offsets</b> is the default, this limitation will generally only come</p>
<p>up if you use the deprecated<b> --no_large_vtbl_offsets</b> option. For more information,</p>
<p>see âVirtual Function Table Offset Sizeâ on page 226.</p>
<p><i>755</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Multiple and Virtual Inheritance</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Namespace Support</b></p>
<p>Namespaces are enabled by default. To disable this feature:</p>
<p>Set the<b> C/C++ CompilerâC++âNamespacesâNamespace Support</b> option</p>
<p>to<b> Off</b> (<b>--no_namespaces</b> ).</p>
<p>When looking up names in a template instantiation, some names must be found in</p>
<p>the context of the template definition, while others can also be found in the context</p>
<p>of the template instantiation.</p>
<p>The Green Hills C++ compiler implements two different instantiation lookup</p>
<p>algorithms:</p>
<p>â¢</p>
<p>The algorithm mandated by the standard (âDependent Name Lookupâ</p>
<p>on page 756).</p>
<p>â¢</p>
<p>The algorithm that existed before the dependent name lookup was implemented</p>
<p>(âLookup Using the Referencing Contextâ on page 757).</p>
<p>To enable dependent name lookup:</p>
<p>Set the<b> C/C++ CompilerâC++âTemplatesâDependent Name Processing</b></p>
<p>option to<b> On</b> (<b>--dep_name</b> ).</p>
<p><b>Dependent Name Lookup</b></p>
<p>When using dependent name lookup, the Green Hills C++ compiler implements</p>
<p>the instantiation name lookup rules that are specified in the standard. This processing</p>
<p>requires that non-class prototype instantiations are performed, which requires that</p>
<p>the code be written using the<b> typename</b> and<b> template</b> keywords that are required</p>
<p>by the standard.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>756</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Lookup Using the Referencing Context</b></p>
<p>When you are not using dependent name lookup, the compiler uses a name lookup</p>
<p>algorithm that approximates the two-phase lookup rule of the standard. This is done</p>
<p>in such a way that is more compatible with existing code and legacy compilers.</p>
<p>When a name is looked up as part of a template instantiation but is not found in the</p>
<p>local context of the instantiation, the name is looked up in a synthesized instantiation</p>
<p>context that includes both names from the context of the template definition and</p>
<p>names from the context of the instantiation.</p>
<p>For example:</p>
<p>namespace N {</p>
<p>int g(int);</p>
<p>int x = 0;</p>
<p>template &lt;class T&gt; struct A {</p>
<p>T f(T t) {return g(t);}</p>
<p>T f() {return x;}</p>
<p>};</p>
<p>}</p>
<p>namespace M {</p>
<p>int x = 99;</p>
<p>double g(double);</p>
<p>N::A&lt;int&gt; ai;</p>
<p>int i = ai.f(0);</p>
<p>// N::A&lt;int&gt;::f(int) calls</p>
<p>// N::g(int)</p>
<p>int i2 = ai.f();</p>
<p>// N::A&lt;int&gt;::f() returns 0</p>
<p>//</p>
<p>(= N::x)</p>
<p>N::A&lt;double&gt; ad;</p>
<p>double d = ad.f(0); // N::A&lt;double&gt;::f(double)</p>
<p>// calls M::g(double)</p>
<p>double d2 = ad.f(); // N::A&lt;double&gt;::f() also</p>
<p>// returns 0 (= N::x)</p>
<p>}</p>
<p>The lookup of names in template instantiations does not conform to the rules in the</p>
<p>standard in the following respects:</p>
<p>â¢</p>
<p>Although only names from the template definition context are considered for</p>
<p>names that are not functions, the lookup is not limited to those names visible</p>
<p>at the point at which the template was defined.</p>
<p><i>757</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Lookup Using the Referencing Context</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Functions from the context in which the template was referenced are considered</p>
<p>for all function calls in the template. Functions from the referencing context</p>
<p>should only be visible for âdependentâ functions calls.</p>
<p><b>Argument Dependent Lookup</b></p>
<p>By default, the Green Hills C++ compiler performs argument-dependent (Koenig)</p>
<p>lookup, as specified by the standard. Functions made visible by using</p>
<p>argument-dependent lookup overload with those made visible by normal lookup.</p>
<p>Setting the<b> --g++</b> option can affect argument-dependent lookup in some cases. For</p>
<p>instance, normally Koenig lookup is suppressed when normal lookup of an</p>
<p>unqualified name finds a block-scope function declaration that is not a</p>
<p>using-declaration, but in GNU mode Koenig lookup will continue despite such a</p>
<p>declaration.</p>
<p>namespace M {</p>
<p>struct A {};</p>
<p>void g(A, double);</p>
<p>void h(A, double);</p>
<p>A operator+(A, double);</p>
<p>}</p>
<p>void g(M::A, int);</p>
<p>M::A operator+(M::A, int);</p>
<p>void f() {</p>
<p>void h(M::A, int);</p>
<p>M::A a1;</p>
<p>g(a1, 1.0); // calls M::g(M::A, double)</p>
<p>a1 + 1.0;</p>
<p>// calls M::operator+(M::A, double)</p>
<p>h(a1, 1.0); // calls h(M::A, int) unless --g++ is set,</p>
<p>// in which case M::h(M::A, double)</p>
<p>// is called</p>
<p>}</p>
<p><b>Linkage</b></p>
<p>C++ accepts the</p>
<p>extern &quot;<i>language</i>&quot;</p>
<p>storage class specifier in order to achieve</p>
<p>linkage between C++ and C. The full syntax is as follows:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>758</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>extern &quot;<i>language</i>&quot; {</p>
<p><i>declarations</i></p>
<p>}</p>
<p>or</p>
<p>extern &quot;<i>language</i>&quot;<i> declaration</i>;</p>
<p>where<i> language</i> may be</p>
<p>C</p>
<p>or</p>
<p>C++</p>
<p>.</p>
<p><b>Effect on Resulting Code</b></p>
<p><b>Language</b></p>
<p>C++ does not alter the procedure name as it usually would when confronted</p>
<p>with an overloaded function.</p>
<p>C</p>
<p>Uses C++ naming rules. Function names are always mangled according to</p>
<p>C++ linkage specifications. This is the default linkage.</p>
<p>C++</p>
<p>Note that the</p>
<p>extern &quot;<i>language</i>&quot;</p>
<p>directive only affects the external names of</p>
<p>functions so that the compiler will apply the appropriate function naming rules.</p>
<p>This directive does not modify the type or number of arguments of a function, or</p>
<p>its return type. Normal C++ type checking rules are not altered by this directive.</p>
<p>For more information about using C++ with C, see Chapter 17, âMixing Languages</p>
<p>and Writing Portable Codeâ on page 877.</p>
<p><b>Post Processing in C++</b></p>
<p>In C or C++,<i> global objects</i> (or</p>
<p>non-local static objects) are those objects which</p>
<p>are declared outside of the scope of any function and are available throughout the</p>
<p>entire program. C++ objects which are instances of a class type have mechanisms</p>
<p>for automatic construction/initialization and destruction/cleanup through the use of</p>
<p><i>constructors</i> and<i> destructors</i>. Constructors are functions which are automatically</p>
<p>called by the compiler when an object is created. Destructors are called when an</p>
<p>object is deleted. This implies some implementation-specific behavior for global</p>
<p>objects which may vary from C++ system to C++ system.</p>
<p>Global objects, such as those in libraries (e.g.</p>
<p>cin</p>
<p>,</p>
<p>cout</p>
<p>, and</p>
<p>cerr</p>
<p>) must be</p>
<p>constructed and initialized for the entire program. This means that the constructor</p>
<p>functions must be called as soon as the program begins. The compiler has no</p>
<p>knowledge of external global objects contained in other modules or libraries except</p>
<p>for an</p>
<p>extern</p>
<p>declaration. This is not enough information for the compiler to be</p>
<p><i>759</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Post Processing in C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>able to properly ensure that these calls are performed. The linker resolves the global</p>
<p>constructor and destructor information. The VxWorks environment is unique in</p>
<p>that the module load/unload functions invoke the global constructors/destructors,</p>
<p>or else the user executes them manually.</p>
<p>When using the<b> --munch</b> option, after an executable has been produced, the Green</p>
<p>Hills C++ compiler driver calls an<b> nm</b> utility (such as<b> gnm</b> ) to find all global</p>
<p>symbols. The output of the<b> nm</b> utility is sent to the post-link program<b> cxxmunch</b>.</p>
<p><b>cxxmunch</b> searches for all global constructor and destructor calls and generates a</p>
<p>C module that will execute these calls appropriately at program startup and exit.</p>
<p>The driver then invokes the compiler and assembler to produce another object</p>
<p>module. Following that, the linker is invoked to relink the new constructor/destructor</p>
<p>object with the original object modules and libraries. This produces the fully</p>
<p>processed C++ executable, which has all of the appropriate constructor and destructor</p>
<p>calls. The driver makes all of this processing completely transparent. However, if</p>
<p>you choose not to use the driver provided by Green Hills, you are responsible for</p>
<p>calling the post-link program after producing an executable; otherwise the program</p>
<p>may not run correctly.</p>
<p><b>The C++ decode Utility</b></p>
<p>The<b> decode</b> utility is provided with Green Hills C++. Its syntax is as follows:</p>
<p><b>decode</b> [-u]</p>
<p>This utility is a C++ name âdemanglerâ. It reads the input from</p>
<p>stdin</p>
<p>and writes</p>
<p>output to</p>
<p>stdout</p>
<p>. Anything that looks like mangled names in the input are</p>
<p>demangled. Everything else is passed through unchanged. This makes the program</p>
<p>suitable, for example, as a filter for the output of a linker; error messages in general</p>
<p>are passed through unaltered, but mangled names are demangled. For example:</p>
<p>ld: Undefined symbol</p>
<p>f__Fif</p>
<p>is changed to:</p>
<p>ld: Undefined symbol</p>
<p>f(int, float)</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>760</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The decode utility takes only a single option:<b> -u</b>. When used,<b> -u</b> specifies that</p>
<p>external names have an added leading underscore.</p>
<p><b>C++ Implementation-Defined Features</b></p>
<p>â¢</p>
<p><b>1.3.2: Diagnostic message</b> â For a complete list of the C++ compiler</p>
<p>diagnostic messages, see the<i> MULTI: Toolchain Error Messages</i> book (not</p>
<p>available in print).</p>
<p>â¢</p>
<p><b>1.3.5: Implementation-defined behavior</b> â Documentation is provided in</p>
<p>this section.</p>
<p>â¢</p>
<p><b>1.4: Implementation compliance</b> â The standard Green Hills distribution is</p>
<p>built around a hosted implementation with the standard set of available libraries.</p>
<p>â¢</p>
<p><b>1.7: The C++ memory model</b> â The size of a byte is 8 bits.</p>
<p>â¢</p>
<p><b>1.9: Program execution</b> â The minimum requirements are all fulfilled.</p>
<p>â¢</p>
<p><b>2.1: Phases of translation</b> â Mapping of file characters to the basic source</p>
<p>character set is performed via identity mapping. Non-empty sequences of</p>
<p>white-space characters (other than newline characters) are retained during</p>
<p>preprocessing. Sources of translation units containing definitions of templates</p>
<p>that are being instantiated are required to be available.</p>
<p>â¢</p>
<p><b>2.2: Character sets</b> â ASCII encoding is used for all characters.</p>
<p>â¢</p>
<p><b>2.8: Header names</b> â See âInstructing the Compiler to Search for Your</p>
<p>Headersâ on page 76.</p>
<p>â¢</p>
<p><b>2.13.2: Character literals</b> â The<b> C/C++ CompilerâSpecial TokensâHost</b></p>
<p><b>and Target Character Encoding</b> option enables recognition of multi-byte</p>
<p>character Kanji sequences. When this option is disabled, or when unrecognized</p>
<p>sequences are encountered, up to four chars are generated, initializing an</p>
<p>int</p>
<p>value, the least significant byte of which is initialized to the rightmost c-char</p>
<p>of the multi-byte character literal. If there are less than four c-chars, the most</p>
<p>significant bytes will be 0. Character literals outside of the</p>
<p>implementation-defined range are truncated to the [0,255] range. Universal</p>
<p>characters are truncated in the same way as</p>
<p>\xhhh</p>
<p>characters.</p>
<p>â¢</p>
<p><b>2.13.3: Floating literals</b> â Same as the C compiler (see âC</p>
<p>Implementation-Defined Featuresâ on page 702).</p>
<p><i>761</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C++ Implementation-Defined Features</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>2.13.4: String literals</b> â Duplicate string literals are merged by default. Enable</p>
<p>the<b> C/C++ CompilerâC/C++ Data AllocationâUniquely Allocate All</b></p>
<p><b>Strings</b> option to create a unique instance of every string.</p>
<p>â¢</p>
<p><b>3.6.1: Main function</b> â</p>
<p>main()</p>
<p>is required for stand-alone projects, and all</p>
<p>operating systems except for VxWorks. The following additional</p>
<p>main()</p>
<p>definitions are supported:</p>
<p>â</p>
<p>int main(int argc, char *argv[], char *env[])</p>
<p>(where</p>
<p>*env[]</p>
<p>is a null-terminated array of environment variables.)</p>
<p>â</p>
<p>A return type of</p>
<p>void</p>
<p>is also permitted with a warning.</p>
<p>The linkage of</p>
<p>main()</p>
<p>is external.</p>
<p>â¢</p>
<p><b>3.6.2: Initializations of non-local objects</b> â Dynamic initialization of objects</p>
<p>of namespace scope is performed by</p>
<p>_main()</p>
<p>, except for VxWorks projects</p>
<p>which use the</p>
<p>_ctors</p>
<p>array and for Native Linux targets which use the</p>
<p>.init_array</p>
<p>section. All static constructors within one compilation unit are</p>
<p>executed in the order in which their definition appears within the translation</p>
<p>unit. Constructors in different compilation units are executed in link-line order.</p>
<p>â¢</p>
<p><b>3.9: Types</b> â For data type sizes and alignments, see âV850 and RH850</p>
<p>Characteristicsâ on page 26.</p>
<p>â¢</p>
<p><b>3.9.1: Fundamental types</b> â</p>
<p>char</p>
<p>and</p>
<p>signed char</p>
<p>hold equivalent values</p>
<p>by default. For more information, see the<b> C/C++ CompilerâData</b></p>
<p><b>TypesâSignedness of Char Type</b> option.</p>
<p>float</p>
<p>and</p>
<p>double</p>
<p>are represented</p>
<p>in the IEEE format.</p>
<p>â¢</p>
<p><b>3.9.2: Compound types</b> â Pointers are represented as plain memory addresses</p>
<p>in the natural way for the target.</p>
<p>â¢</p>
<p><b>4.7: Integral conversions</b> â Unrepresentable values are truncated to a value</p>
<p>that fits into the destination type using modulo arithmetic.</p>
<p>â¢</p>
<p><b>4.8: Floating-point conversions</b> â Same as the C compiler (see âC</p>
<p>Implementation-Defined Featuresâ on page 702).</p>
<p>â¢</p>
<p><b>4.9: Floating-integral conversions</b> â Same as the C compiler (see âC</p>
<p>Implementation-Defined Featuresâ on page 702).</p>
<p>â¢</p>
<p><b>5.2.8: Type identification</b> â</p>
<p>typeid</p>
<p>expression results are only of static type</p>
<p>std::type_info</p>
<p>. No derived classes are provided.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>762</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>5.2.10: Reinterpret_cast</b> â Mapping remains the same. Mapping of pointers</p>
<p>to addresses and vice versa uses</p>
<p>int</p>
<p>or larger type.</p>
<p>â¢</p>
<p><b>5.3.3: Sizeof</b> â For information about the sizes of fundamental types, see</p>
<p>âV850 and RH850 Characteristicsâ on page 26.</p>
<p>â¢</p>
<p><b>5.6: Multiplicative operators</b> â Remainder from the division of a negative</p>
<p>and non-negative operand is the same sign as the first operand.</p>
<p>â¢</p>
<p><b>5.7: Additive operators</b> â</p>
<p>ptrdiff_t</p>
<p>is a typedef for</p>
<p>int</p>
<p>on 32-bit targets,</p>
<p>or</p>
<p>long long</p>
<p>on 64-bit targets.</p>
<p>â¢</p>
<p><b>5.8: Shift operators</b> â The result of</p>
<p>E1 &gt;&gt; E2</p>
<p>where</p>
<p>E1</p>
<p>has a signed type</p>
<p>and a negative value is negative.</p>
<p>â¢</p>
<p><b>7.1.5.2: Simple type specifiers</b> â Type</p>
<p>char</p>
<p>is</p>
<p>signed</p>
<p>by default. Bitfields</p>
<p>are</p>
<p>signed</p>
<p>by default.</p>
<p>â¢</p>
<p><b>7.2: Enumeration declarations</b> â Enumerations have a type of</p>
<p>int</p>
<p>, unless</p>
<p>the<b> C/C++ CompilerâData TypesâUse Smallest Type Possible for Enum</b></p>
<p>option is enabled.</p>
<p>â¢</p>
<p><b>7.4: The asm declaration</b> â</p>
<p>asm</p>
<p>declarations are unmodified by the compiler.</p>
<p>For more information, see Chapter 18, âEnhanced asm Macro Facility for C</p>
<p>and C++â on page 897.</p>
<p>â¢</p>
<p><b>7.5: Linkage specifications</b> â Routines declared with</p>
<p>extern &quot;C&quot;</p>
<p>will not</p>
<p>have name mangling performed on them. The default mode,</p>
<p>extern &quot;C++&quot;</p>
<p>,</p>
<p>performs name mangling. No other language linkages are supported. Mangling</p>
<p>of function names, type names, and static data member names is performed by</p>
<p>the C++ compiler.</p>
<p>â¢</p>
<p><b>8.5.3: References</b> â In the circumstances described, a temporary is generated,</p>
<p>rvalue</p>
<p>is copied into it, and the reference is bound to the temporary.</p>
<p>â¢</p>
<p><b>9.6: Bit-fields</b> â A bitfield is allocated at the current offset, unless it crosses</p>
<p>an offset which is a multiple of the size of the base type, in which case it is</p>
<p>padded up to the first multiple of the size of the base type. Plain bitfields are</p>
<p>unsigned unless<b> C/C++ CompilerâData TypesâSignedness of Bitfields</b> is</p>
<p>set to<b> Signed</b>.</p>
<p>â¢</p>
<p><b>12.2: Temporary objects</b> â Are generated for</p>
<p>f(X(2))</p>
<p>, but the result will</p>
<p>be stored directly into</p>
<p>b</p>
<p>.</p>
<p>â¢</p>
<p><b>14: Templates</b> â Only C and C++ linkages are supported.</p>
<p>â¢</p>
<p><b>14.7.1: Implicit instantiation</b> â Recursive instantiations are limited to 64.</p>
<p><i>763</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C++ Implementation-Defined Features</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>15.5.1: The terminate() function</b> â The stack is unwound before</p>
<p>terminate()</p>
<p>is called.</p>
<p>â¢</p>
<p><b>15.5.2: The unexpected() function</b> â Unless reset by user, will call</p>
<p>terminate()</p>
<p>.</p>
<p>â¢</p>
<p><b>16.1: Conditional inclusion</b> â Numeric values for character literals in</p>
<p>#if</p>
<p>and</p>
<p>#elif</p>
<p>controlling expressions is identical to</p>
<p>char</p>
<p>literals in regular</p>
<p>expressions.</p>
<p>â¢</p>
<p><b>16.2: Source file inclusion</b> â See âInstructing the Compiler to Search for</p>
<p>Your Headersâ on page 76.</p>
<p>â</p>
<p>#include &lt;<i>h-char-sequence</i>&gt;</p>
<p>â searches the system header</p>
<p>directories. All identifiers in<i> h-char-sequence</i> will be resolved.</p>
<p>â</p>
<p>#include &quot;<i>q-char-sequence</i>&quot;</p>
<p>â searches the current directory, and</p>
<p>then all include directories. Sequences in<i> q-char-sequence</i> will be treated</p>
<p>as a string literal, and will not be resolved.</p>
<p>â</p>
<p>Mapping between the sequence and the external source filename â is</p>
<p>performed through the identity function.</p>
<p>â</p>
<p>#include</p>
<p>preprocessor directives can be nested to arbitrary depth.</p>
<p>â¢</p>
<p><b>16.6: Pragma directive</b> â See âPragma Directivesâ on page 795.</p>
<p>â¢</p>
<p><b>16.8: Predefined macro names</b> â For a list of the required preprocessor</p>
<p>macros and their values, see âMacro Names Required by ANSI C and C++â</p>
<p>on page 780.</p>
<p>â¢</p>
<p><b>17.4.4.5: Reentrancy</b> â All subroutines are reentrant provided that the target</p>
<p>system has been configured with the appropriate lock routines in subdirectory</p>
<p><b>src/libsys</b>.</p>
<p>â¢</p>
<p><b>17.4.4.8: Restrictions on exception handling</b> â See the<i> Dinkum C++ Library</i></p>
<p><i>Reference</i> (included with your distribution, at<i><b> install_dir</i>/scxx/html/index.html</b>)</p>
<p>â¢</p>
<p><b>18.1: Types</b> â</p>
<p>NULL</p>
<p>is defined as</p>
<p>(0)</p>
<p>.</p>
<p>â¢</p>
<p><b>18.3: Start and termination</b> â</p>
<p>exit()</p>
<p>returns the value of argument</p>
<p>status</p>
<p>:</p>
<p>â</p>
<p>EXIT_SUCCESS</p>
<p>â has a value of</p>
<p>0</p>
<p>.</p>
<p>â</p>
<p>EXIT_FAILURE</p>
<p>â has a value of</p>
<p>1</p>
<p>.</p>
<p>â¢</p>
<p><b>18.4.2.1: Class bad_alloc</b> â</p>
<p>what()</p>
<p>returns an empty string.</p>
<p>â¢</p>
<p><b>18.5 to 18.6</b> â Various class definitions. See<i> Dinkum C++ Library Reference</i>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>764</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>20.1.5: Allocator requirements</b> â Match those in the standard. Certain</p>
<p>operations on containers and algorithms will behave differently if allocator</p>
<p>instances compare non-equal. Instances of</p>
<p>std::allocator</p>
<p>always compare</p>
<p>equal.</p>
<p>â¢</p>
<p><b>21.1.3.1: struct char_traits&lt;char&gt;</b> â Types</p>
<p>streampos</p>
<p>and</p>
<p>streamoff</p>
<p>are typedefs for</p>
<p>fpos&lt;mbstate_t&gt;</p>
<p>and</p>
<p>long</p>
<p>, respectively. Type</p>
<p>wstreampos</p>
<p>is a typedef for</p>
<p>streampos</p>
<p>.</p>
<p>â¢</p>
<p><b>22.2: Standard locale categories</b> â Various type definitions. See<i> Dinkum</i></p>
<p><i>C++ Library Reference</i>.</p>
<p>â¢</p>
<p><b>22.2.5.1.2: time_get virtual functions</b> â Two-digit year numbers are</p>
<p>supported. Numbers in the range [0,68] represent years 2000 to 2068. Numbers</p>
<p>in the range [69,136] represent years 1969 to 2036. See<i> Dinkum C++ Library</i></p>
<p><i>Reference</i>.</p>
<p>â¢</p>
<p><b>23.2 to 23.3</b> â Various type and class definitions. See<i> Dinkum C++ Library</i></p>
<p><i>Reference</i>.</p>
<p>â¢</p>
<p><b>26.2.8: complex transcendentals</b> â</p>
<p>pow(0,0)==(1,0)</p>
<p>â¢</p>
<p><b>26.3: Numeric arrays</b> â Various type and class definitions. See<i> Dinkum C++</i></p>
<p><i>Library Reference</i>.</p>
<p>â¢</p>
<p><b>27.1.2: Positioning Type Limitations</b> â In Green Hills standard libraries,</p>
<p>traits::pos_type</p>
<p>and</p>
<p>traits::off_type</p>
<p>are typedefs for</p>
<p>streampos</p>
<p>and</p>
<p>streamoff</p>
<p>respectively.</p>
<p>â¢</p>
<p><b>27.4.1: Types</b> â</p>
<p>streamoff</p>
<p>is a typedef for</p>
<p>long</p>
<p>.</p>
<p>â¢</p>
<p><b>27.4.2.4: ios_base static members</b> â The synchronization flag is ignored.</p>
<p>Streams are always synchronized.</p>
<p>â¢</p>
<p><b>27.4.4.3: basic_ios iostate flags functions</b> â On failure, the object to be</p>
<p>thrown is constructed with a string argument that is the first applicable of</p>
<p>ios_base::badbit set</p>
<p>,</p>
<p>ios_base::failbit set</p>
<p>, or</p>
<p>ios_base::eofbit set</p>
<p>.</p>
<p>â¢</p>
<p><b>27.7.1.3: Overridden virtual functions</b> â</p>
<p>basic_streambuf::setbuf()</p>
<p>has no effect.</p>
<p>â¢</p>
<p><b>27.8.1.4: Overridden virtual functions</b> â</p>
<p>basic_filebuf::setbuf()</p>
<p>with non-zero arguments invokes the C library function</p>
<p>setvbuf</p>
<p>with the</p>
<p>given arguments, scaled appropriately, and with a mode argument of</p>
<p>_IOFBF</p>
<p>.</p>
<p><i>765</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C++ Implementation-Defined Features</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>B: Implementation quantities</b> â In order to guard against infinite recursion,</p>
<p>the compiler places limits on the following quantities:</p>
<p>â</p>
<p>Nesting levels for</p>
<p>#include</p>
<p>files (10 recursive inclusions of the same</p>
<p>file; no general limit)</p>
<p>â</p>
<p>Recursively nested template instantiations (64).</p>
<p>Associated diagnostics include 3 and 456.</p>
<p>â¢</p>
<p><b>C.1.9.16.8: Predefined names</b> â</p>
<p>__STDC__</p>
<p>is defined as</p>
<p>0</p>
<p>.</p>
<p>â¢</p>
<p><b>C.2.2.3: Macro NULL</b> â Is defined as</p>
<p>(0)</p>
<p>.</p>
<p>â¢</p>
<p><b>D.6: Old iostreams members</b> â See 21.1.3.1 for</p>
<p>streampos</p>
<p>and</p>
<p>streamoff</p>
<p>typedefs.</p>
<p><b>Deprecated C++ Headers</b></p>
<p>The Green Hills C++ libraries provide all 51 of the headers specified by the</p>
<p><i>International Standard ISO/IEC 14882:2003</i>, as well as the common non-standard</p>
<p>headers</p>
<p>&lt;hash_map&gt;</p>
<p>,</p>
<p>&lt;hash_set&gt;</p>
<p>, and</p>
<p>&lt;slist&gt;</p>
<p>.</p>
<p>The following non-standard header files are provided only for the support of legacy</p>
<p>C++ code. These header files are deprecated, and may be removed in a future release:</p>
<p>&lt;fstream.h&gt;</p>
<p>&lt;iomanip.h&gt;</p>
<p>&lt;iostream.h&gt;</p>
<p>&lt;new.h&gt;</p>
<p>&lt;rope&gt;</p>
<p>&lt;stdiostream.h&gt;</p>
<p>&lt;stl.h&gt;</p>
<p>&lt;strstream.h&gt;</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>766</i></p>
<p><i>Chapter 13. Green Hills C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 14</b></p>
<p><b>Coding Standards</b></p>
<p><b>Contents</b></p>
<p>GHS Standard Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>768</p>
<p>MISRA C 1998 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>768</p>
<p>MISRA C 2004 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>771</p>
<p>Creating Your Own Coding Standards with Coding Standard Profiles . . . . .</p>
<p>774</p>
<h1 style="page-break-before:always; "></h1>
<p>Coding standards are sets of rules that enforce a stricter coding standard than C or</p>
<p>C++. The Green Hills tools ship with support for some widely-adopted standards</p>
<p>(such as MISRA), and provide a feature called<i> coding standard profiles</i> to help you</p>
<p>create your own. This chapter explains the standards that ship with the tools, how</p>
<p>to enable them, and how to create your own standards.</p>
<p><b>GHS Standard Mode</b></p>
<p>GHS Standard Mode is a collection of compiler warnings and errors that enforces</p>
<p>a stricter coding standard than regular C and C++. It was designed to aid you in</p>
<p>avoiding common pitfalls when designing complex programs. Green Hills uses this</p>
<p>standard internally, and has found it provides good protection against common</p>
<p>mistakes and bad coding style, without causing too many false positives. We</p>
<p>recommend that you use this standard unless you are required to use MISRA for</p>
<p>your project.</p>
<p>Several versions of the standard may be available, allowing you to use the latest</p>
<p>version or standardize on a previous one. The diagnostics enabled by this standard</p>
<p>are listed in Appendix A, âCoding Standard Profile Referenceâ on page 941.</p>
<p>The 2010 version of GHS Standard Mode is implemented through the</p>
<p><i><b>install_dir</i>/defaults/coding_standards/ghstd2010.csp</b> coding standard profile. To</p>
<p>use this profile:</p>
<p>Set the<b> Compiler DiagnosticsâCoding Standard Profile</b> option to</p>
<p>ghstd2010</p>
<p>(<b>--coding_standard=ghstd2010</b>), or use the<b> --ghstd=</b> option (see âGreen Hills</p>
<p>Standard Modeâ on page 255).</p>
<p><b>MISRA C 1998</b></p>
<p>The MISRA C 1998 Standard is a set of guidelines for the C programming language</p>
<p>created by the Motor Industry Software Reliability Association (MISRA). These</p>
<p>guidelines are designed to enforce good practices in the development of embedded</p>
<p>automotive systems. Complete details can be found in the<i> Guidelines For The Use</i></p>
<p><i>Of The C Language In Vehicle Based Software, Motor Industry Software Reliability</i></p>
<p><i>Association, April 1998</i> book. For more information, see the MISRA Web site</p>
<p>[http://www.misra.org.uk/].</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>768</i></p>
<p><i>Chapter 14. Coding Standards</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If the compiler is invoked with options enabling both MISRA 1998 rules and MISRA</p>
<p>2004 rules, the compiler does not directly enforce any MISRA 1998 rules. Rather,</p>
<p>the compiler enforces the MISRA 2004 equivalents (if they exist) for any enabled</p>
<p>MISRA 1998 rules.</p>
<p>There are 127 rules, classified into two categories, as follows:</p>
<p>â¢</p>
<p>93<i> required</i> rules (designated<b> [R]</b> below) â mandatory requirements placed</p>
<p>on the programmer that will, by default, generate an error if enabled and</p>
<p>breached.</p>
<p>â¢</p>
<p>34<i> advisory</i> rules (designated<b> [A]</b> below) â suggestions to the programmer</p>
<p>that will, by default, generate a warning if enabled and breached.</p>
<p>The MISRA rules are organized into 17 groups, each focusing on a particular C</p>
<p>language topic (for example: types, functions, expressions, the C preprocessor, etc).</p>
<p>Each group has an associated option below. For information about each group and</p>
<p>individual rules, see âMISRA C 1998â on page 204.</p>
<p>The Green Hills Tools provide options to control the severity of messages that alert</p>
<p>you to violations of the rules. Most of the messages are given at compile time,</p>
<p>although some are generated at run-time. Because run-time checking can adversely</p>
<p>affect code performance, the tools provide the<b> --no_misra_runtime</b> option to disable</p>
<p>it.</p>
<p>Some MISRA rules are enforced by disabling toolchain features such as recognition</p>
<p>of certain language extension keywords. A violation of one of MISRA rules results</p>
<p>in an error if the rule is enabled, regardless of the diagnostic severity specified for</p>
<p>that rule. These MISRA rules are not affected by</p>
<p>#pragma ghs startnomisra</p>
<p>or</p>
<p>#pragma ghs endnomisra</p>
<p>(see âGreen Hills Extension Pragma Directivesâ</p>
<p>on page 799).</p>
<p>Some MISRA rules change other command line controllable options as documented</p>
<p>in the following section. The MISRA rules override explicit settings of the other</p>
<p>command line options, even if these options appear later on the command line than</p>
<p>the MISRA option.</p>
<p><i>769</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 1998</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Enforcing MISRA C 1998 Rules</b></p>
<p>A single driver option allows you to enable any or all of the MISRA rules. It may</p>
<p>be used in any of the following forms (where<i> n</i> is a rule number from the list below):</p>
<p>â¢</p>
<p><b>--saferc=all</b> â Enables checking of all the rules</p>
<p>â¢</p>
<p><b>--saferc=none</b> â Disables checking of all the rules</p>
<p>â¢</p>
<p><b>--saferc=<i>n</i>[,<i>n1</i>â¦]</b> â Enables checking of a comma-separated list of rules</p>
<p>â¢</p>
<p><b>--saferc=<i>n</i>-<i>n1</b></i> â Enables checking of a range of rules</p>
<p>â¢</p>
<p><b>--saferc=all,-7</b> â Enables checking of all the rules except rule 7.</p>
<p>â¢</p>
<p><b>--saferc=7â10</b> â Enables checking of rules 7 though 10.</p>
<p>â¢</p>
<p><b>--saferc=7,10</b> â Enables checking of rules 7 and 10.</p>
<p><b>MISRA C 1998 Rules Enforced by the Linker</b></p>
<p>The following MISRA C 1998 rules are enforced (either wholly or partially) by the</p>
<p>linker. As such, their enforcement in the linker is not governed by the</p>
<p>#pragma</p>
<p>ghs startnomisra</p>
<p>directive.</p>
<p>â¢</p>
<p>Rule 11</p>
<p>â¢</p>
<p>Rule 22</p>
<p>â¢</p>
<p>Rule 23</p>
<p>â¢</p>
<p>Rule 25</p>
<p>â¢</p>
<p>Rule 70</p>
<p>â¢</p>
<p>Rule 118</p>
<p>â¢</p>
<p>Rule 121</p>
<p>â¢</p>
<p>Rule 122</p>
<p>â¢</p>
<p>Rule 123</p>
<p>â¢</p>
<p>Rule 124</p>
<p>â¢</p>
<p>Rule 125</p>
<p>â¢</p>
<p>Rule 126</p>
<p>â¢</p>
<p>Rule 127</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>770</i></p>
<p><i>Chapter 14. Coding Standards</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>MISRA C 2004</b></p>
<p>The MISRA C 2004 Standard was created by the Motor Industry Software Reliability</p>
<p>Association (MISRA). It is a set of guidelines for the C programming language that</p>
<p>is designed to enforce good practices in the development of embedded automotive</p>
<p>systems. You can find complete details in the<i> Guidelines For The Use Of The C</i></p>
<p><i>Language In Critical Systems, Motor Industry Software Reliability Association,</i></p>
<p><i>October 2004</i> book. For more information, see the MISRA Web site</p>
<p>[http://www.misra.org.uk/].</p>
<p>There are 141 rules, classified into two categories, as follows:</p>
<p>â¢</p>
<p>120<i> required</i> rules (designated<b> [R]</b> below) â mandatory requirements placed</p>
<p>on the programmer that will, by default, generate an error if enabled and</p>
<p>breached.</p>
<p>â¢</p>
<p>21<i> advisory</i> rules (designated<b> [A]</b> below) â suggestions to the programmer</p>
<p>that will, by default, generate a warning if enabled and breached.</p>
<p>The MISRA rules are organized into 21 groups, each focusing on a particular C</p>
<p>language topic (for example: types, functions, expressions, the C preprocessor, etc.).</p>
<p>For information about each group and individual rules, see âMISRA C 2004â</p>
<p>on page 187.</p>
<p><b>Enforcing MISRA C 2004 Rules</b></p>
<p>A single driver option allows you to enable any or all of the MISRA rules. It may</p>
<p>be used in any of the following forms (where<i> n</i> is a rule number):</p>
<p>â¢</p>
<p><b>--misra_2004=all</b> â Enables checking of all the rules.</p>
<p>â¢</p>
<p><b>--misra_2004=none</b> â Disables checking of all the rules.</p>
<p>â¢</p>
<p><b>--misra_2004=<i>n</i>[,<i>n1</i>â¦]</b> â Enables checking of a comma-separated list of</p>
<p>rules.</p>
<p>â¢</p>
<p><b>--misra_2004=<i>-n</i>[<i>,-n1...</i>]</b> â Disables checking of a comma-separated list of</p>
<p>rules.</p>
<p>â¢</p>
<p><b>--misra_2004=<i>n</i>-<i>n1</b></i> â Enables checking of rules<i> n</i> through<i> n1</i>.</p>
<p>â¢</p>
<p><b>--misra_2004=-<i>n</i>-<i>n1</b></i> â Disables checking of rules<i> n</i> through<i> n1</i>.</p>
<p><i>771</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 2004</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For a list of all supported MISRA C 2004 rules, see âMISRA C 2004â on page 187.</p>
<p>When the<b> --diag_*=</b> options and<b> --misra_2004=</b> options are both used in a single</p>
<p>project, both options are passed to the compiler and both are used.</p>
<p>The compiler first uses the<b> --misra_2004=</b> options to determine whether certain</p>
<p>MISRA behavior is enabled. If a MISRA rule is not enabled based on the</p>
<p><b>--misra_2004=</b> options, the compiler applies the<b> --diag_*=</b> options to determine</p>
<p>the severity of the message.</p>
<p>If a MISRA rule is enabled based on the<b> --misra_2004=</b> options, the compiler</p>
<p>follows MISRA-specific logic to determine if a message should be given, and then</p>
<p>usually applies the<b> --diag_*=</b> options to determine the severity and suppression of</p>
<p>the message. It is not always possible to change the severity of a MISRA rule using</p>
<p><b>--diag_*=</b>.</p>
<p>Coding standard profiles, such as Green Hills Standard Mode, are implemented</p>
<p>using the same mechanism as<b> --diag_*=</b> and therefore have a similar interaction</p>
<p>with<b> --misra_2004=</b>.</p>
<p>The following example demonstrates the use of these MISRA options:</p>
<p><b>Example 14.1. Using MISRA Builder and Driver Options</b></p>
<p><b>--misra_2004=all,-2.3</b> â Enables checking of all rules except rule 2.3.</p>
<p><b>--misra_2004=2.3-4.2</b> â Enables checking of rules 2.3 through 4.2.</p>
<p><b>--misra_2004=2.3,4.2</b> â Enables checking of rules 2.3 and 4.2.</p>
<p><b>--misra_2004=-2.3,-4.2</b> â Disables checking of rules 2.3 and 4.2.</p>
<p><b>MISRA C 2004 Rules Enforced by the Linker</b></p>
<p>The following MISRA C 2004 rules are enforced (either wholly or partially) by the</p>
<p>linker. As such, their enforcement in the linker is not governed by the</p>
<p>#pragma</p>
<p>ghs startnomisra</p>
<p>directive.</p>
<p>â¢</p>
<p>Rule 5.1</p>
<p>â¢</p>
<p>Rule 8.7</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>772</i></p>
<p><i>Chapter 14. Coding Standards</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Rule 8.9</p>
<p>â¢</p>
<p>Rule 8.10</p>
<p>â¢</p>
<p>Rule 16.2</p>
<p>â¢</p>
<p>Rule 20.4</p>
<p>â¢</p>
<p>Rule 20.7</p>
<p>â¢</p>
<p>Rule 20.8</p>
<p>â¢</p>
<p>Rule 20.9</p>
<p>â¢</p>
<p>Rule 20.10</p>
<p>â¢</p>
<p>Rule 20.11</p>
<p>â¢</p>
<p>Rule 20.12</p>
<p><b>MISRA C 2004 Implementation</b></p>
<p>The Green Hills tools provide options to control the severity of messages that alert</p>
<p>you to violations of MISRA C 2004 rules. Most of the messages are given at compile</p>
<p>time, although some are generated at run-time. Because run-time checking can</p>
<p>adversely affect code performance, an option is provided to disable it.</p>
<p>Most of the rules that generate messages at compile time are implemented though</p>
<p>compiler checks that are only enabled when the corresponding MISRA rule is</p>
<p>enabled. Some of the rules specify constraints that the compiler already has checks</p>
<p>for. In these cases, the severity of the diagnostic message will be elevated to the</p>
<p>severity specified for the corresponding MISRA rule if it exceeds the default severity</p>
<p>for that message.</p>
<p>In some cases a MISRA rule has been implemented using a number of distinct</p>
<p>compile time checks that each generate unique diagnostic messages when they are</p>
<p>violated. This means that one item that violates one MISRA rule might cause multiple</p>
<p>diagnostics to be issued if it violates more than one of the checks used to implement</p>
<p>the rule. The advantage of this approach is that by modifying the severity of or</p>
<p>suppressing individual diagnostic messages, the user can allow a deviation from a</p>
<p>portion of a MISRA rule without disabling the entire rule. For example, if you have</p>
<p><b>Rule 8.1</b> enabled but want to allow static functions to be defined without a separate</p>
<p>prototype declaration, you can specify<b> --diag_remark=1828</b> or</p>
<p><b>--diag_suppress=1828</b> to disable the portion of<b> Rule 8.1</b> that requires static function</p>
<p>definitions to have separate prototype declarations.</p>
<p><i>773</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 2004 Implementation</i></p>
<h1 style="page-break-before:always; "></h1>
<p>In the introduction to section 6.15, &quot;Switch statements,&quot; MISRA-C:2004 defines a</p>
<p>restricted switch statement syntax. Some of the syntax restrictions are enforced as</p>
<p>part of the rules contained in section 6.15. The remainder of the syntax restrictions</p>
<p>are enforced by the compiler by default if any of the rules from section 6.15,</p>
<p>15.1-15.5, are enabled. Because all of the rules in section 6.15 are required rules,</p>
<p>the diagnostic severity for the restricted switch statement syntax is set to the required</p>
<p>rule severity level by default. The compiler diagnostics issued for these syntax</p>
<p>restrictions include 1705, 1706, 1708, 1709, and 1821.</p>
<p>The compiler toolchain enforces some MISRA rules by disabling features or</p>
<p>changing logic that is not specific to MISRA rule checking. If you enable checking</p>
<p>for one of these rules, and your code violates that rule, you will receive an error</p>
<p>regardless of the specified MISRA diagnostic level. Because the compiler toolchain</p>
<p>does not issue the error due to the MISRA rule directly, the error message will not</p>
<p>contain a reference to that rule. These MISRA rules are not affected by</p>
<p>#pragma</p>
<p>ghs startnomisra</p>
<p>or</p>
<p>#pragma ghs endnomisra</p>
<p>(see âGreen Hills Extension</p>
<p>Pragma Directivesâ on page 799).</p>
<p>For example, you might enable checking for MISRA required rule 1.1, which enables</p>
<p>strict ANSI C by disabling recognition of certain non-standard keywords. Because</p>
<p>the compiler can no longer recognize those keywords, it cannot parse code that</p>
<p>violates the rule. As a result, the compiler will issue a non-discretionary error even</p>
<p>if you have used</p>
<p>--misra_req=silent</p>
<p>to downgrade and hide MISRA required</p>
<p>rule errors.</p>
<p>Some MISRA rules are enforced through preprocessor directives in the standard</p>
<p>headers provided by Green Hills and are only enforced when the standard headers</p>
<p>are used.</p>
<p>Some MISRA rules change other command line controllable options as documented</p>
<p>in the following section. The MISRA rules override explicit settings of the other</p>
<p>command line options, even if these options appear later on the command line than</p>
<p>the MISRA option.</p>
<p><b>Creating Your Own Coding Standards with Coding Standard</b></p>
<p><b>Profiles</b></p>
<p><i>Coding standard profiles</i> are a convenient way to specify your own coding standards.</p>
<p>You can use coding standard profiles to:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>774</i></p>
<p><i>Chapter 14. Coding Standards</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>print custom prefixes in front of diagnostics.</p>
<p>â¢</p>
<p>group diagnostics together under tags, which you can use in place of diagnostic</p>
<p>numbers for various options and</p>
<p>#pragma</p>
<p>directives.</p>
<p>â¢</p>
<p>easily distribute a single coding standard to several developers.</p>
<p>The following sections explain how to use the preset coding standard profiles that</p>
<p>ship with the Green Hills tools, as well as write your own.</p>
<p><b>Specifying a Coding Standard Profile</b></p>
<p>The Green Hills tools ship with preset coding standard profiles located in</p>
<p><i><b>install</i>/defaults/coding_standards</b>:</p>
<p>â¢</p>
<p><b>ghstd2010.csp</b> â see â GHS Standard Modeâ on page 942</p>
<p>â¢</p>
<p><b>misra1998.csp</b> â (provided as an example; does not fully implement MISRA</p>
<p>1998) see âMISRA C 1998â on page 945</p>
<p>You can also create your own (see âCoding Standard Profile Syntaxâ on page 776).</p>
<p>To specify a coding standard profile for use with your project:</p>
<p>Set the<b> Compiler DiagnosticsâCoding Standard Profile</b> (<b>--coding_standard=</b>)</p>
<p>option (see âCoding Standard Profileâ on page 255).</p>
<p>After specifying a coding standard profile, you can use the tags defined by that</p>
<p>profile in place of diagnostic numbers for options such as<b> --diag_warning</b> and</p>
<p><b>--diag_error</b>, and in</p>
<p>#pragma ghs nowarning</p>
<p>(see âVarying Message Severityâ</p>
<p>on page 259 and âGreen Hills Extension Pragma Directivesâ on page 799).</p>
<p><b>Note</b></p>
<p>The MISRA C 2004 standard is available through a set of driver options.</p>
<p>For more information, see âMISRA C 2004â on page 187.</p>
<p><i>775</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Specifying a Coding Standard Profile</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Coding Standard Profile Syntax</b></p>
<p>Coding standard profiles are text files. By convention, they have a<b> .csp</b> extension.</p>
<p>The file is divided into two sections:</p>
<p>1.</p>
<p><b>Tag Section</b> â Associates diagnostic messages with tags.</p>
<p>2.</p>
<p><b>Severity Section</b> â [optional] Associates tags with a default severity level.</p>
<p>Each line in the tag section has the following syntax:</p>
<p><i>diagnostic</i> &quot;<i>prefix</i>&quot;<i> tag</i> [<i>tag</i>]â¦</p>
<p>â¢</p>
<p><i>diagnostic</i> â A valid diagnostic number, or zero (in which case the line has</p>
<p>no effect). If the diagnostic number is out of range, the compiler issues a</p>
<p>warning and the line is ignored. For a list of diagnostic numbers, see<i> MULTI:</i></p>
<p><i>Toolchain Error Messages</i>.</p>
<p>â¢</p>
<p><i>prefix</i> â A string that prints before each diagnostic message of this type.</p>
<p>â¢</p>
<p><i>tag</i> [<i>tag</i>]â¦ â A whitespace-separated list of tags, terminated by the end of</p>
<p>the line or the start of a comment (</p>
<p>//</p>
<p>). Each tag must follow the rules for C</p>
<p>identifiers.</p>
<p>Each line in the severity section has the following syntax:</p>
<p><i>severity tag</i> [<i>tag</i>]â¦</p>
<p>â¢</p>
<p><i>severity</i> â Must be one of</p>
<p>diag_suppress</p>
<p>,</p>
<p>diag_remark</p>
<p>,</p>
<p>diag_warning</p>
<p>,</p>
<p>or</p>
<p>diag_error</p>
<p>.</p>
<p>â¢</p>
<p><i>tag</i> [<i>tag</i>]â¦ â A whitespace-separated list of tags specified in the tag section,</p>
<p>terminated by the end of the line or the start of a comment (</p>
<p>//</p>
<p>).</p>
<p>Comments begin with the sequence</p>
<p>//</p>
<p>and continue until the end of the line.</p>
<p>For example, if you have the following program<b> test.c</b>:</p>
<p>#define foo @</p>
<p>void bar();;</p>
<p>and the following coding standard profile<b> my_profile.csp</b>:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>776</i></p>
<p><i>Chapter 14. Coding Standards</i></p>
<h1 style="page-break-before:always; "></h1>
<p>// Extra semicolons are bad</p>
<p>7</p>
<p>&quot;My Standard 1.1&quot; my_tag my_tag_1_1</p>
<p>381 &quot;My Standard 1.2&quot; my_tag my_tag_1_2</p>
<p>7</p>
<p>&quot;&quot;</p>
<p>silent_tag</p>
<p>diag_warning my_tag</p>
<p>diag_suppress silent_tag</p>
<p>the program compiles cleanly without additional options:</p>
<p>&gt; ccv850 -c test.c</p>
<p>When you use the<b> --coding_standard</b> option to specify your standard, the compiler</p>
<p>uses the severity levels defined in the standard's severity section. If the same</p>
<p>diagnostic has multiple tags, the compiler uses the last-defined entry of the severity</p>
<p>section that specifies one of the tags, and uses the prefix defined for that tag. For</p>
<p>example, in<b> my_profile.csp</b>, the last-defined severity for diagnostic 7 is</p>
<p>diag_suppress silent_tag</p>
<p>, so it does not appear by default:</p>
<p>&gt; ccv850 -c test.c --coding_standard=my_profile.csp</p>
<p>&quot;test.c&quot;, line 2: warning #381-D: My Standard 1.2: extra &quot;;&quot; ignored</p>
<p>void bar();;</p>
<p>^</p>
<p>Specify a tag for the<b> --diag_suppress</b>,<b> --diag_remark</b>,<b> --diag_warning</b>, or</p>
<p><b>--diag_error</b> option to override the levels defined in the severity section:</p>
<p>&gt; ccv850 -c test.c --coding_standard=my_profile.csp --diag_warning=my_tag</p>
<p>&quot;test.c&quot;, line 2: warning #7-D: My Standard 1.1: unrecognized token</p>
<p>#define foo @</p>
<p>^</p>
<p>&quot;test.c&quot;, line 2: warning #381-D: My Standard 1.2: extra &quot;;&quot; ignored</p>
<p>void bar();;</p>
<p>^</p>
<p>If the compiler uses a tag for a diagnostic whose prefix is an empty string, no</p>
<p>additional characters are printed in standard error output:</p>
<p>&gt; ccv850 -c test.c --coding_standard=my_profile.csp --diag_warning=silent_tag</p>
<p>&quot;test.c&quot;, line 1: warning #7-D: unrecognized token</p>
<p>#define foo @</p>
<p>^</p>
<p>&quot;test.c&quot;, line 2: warning #381-D: My Standard 1.2: extra &quot;;&quot; ignored</p>
<p>void bar();;</p>
<p>^</p>
<p>If you pass a tag that does not exist in any specified profile, the compiler issues a</p>
<p>warning:</p>
<p>&gt; ccv850 -c test.c --coding_standard=my_profile.csp --diag_warning=bad_tag</p>
<p>Warning #1966-D: unused coding standard tag or malformed error number bad_tag</p>
<p><i>777</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Coding Standard Profile Syntax</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 15</b></p>
<p><b>Macros, Pragma Directives,</b></p>
<p><b>and Intrinsics</b></p>
<p><b>Contents</b></p>
<p>Predefined Macro Names . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>780</p>
<p>Pragma Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>795</p>
<p>Intrinsic Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>810</p>
<p>Static Assertions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>814</p>
<h1 style="page-break-before:always; "></h1>
<p><b>Predefined Macro Names</b></p>
<p>The preprocessor defines a number of macro names, depending on the compiler</p>
<p>and language you use and the builder and driver options you specify. To write code</p>
<p>that compiles differently depending on which macro names the preprocessor defines,</p>
<p>use the</p>
<p>#ifdef</p>
<p>preprocessor directive.</p>
<p>The following sections contain lists that cover all of the preprocessor predefined</p>
<p>macro names.</p>
<p><b>Macro Formats</b></p>
<p>The standards for C and C++ require that all compiler-predefined macros begin</p>
<p>with one or two underscore characters. Prior to the ANSI standard, some C</p>
<p>preprocessors defined macros without leading underscores (such as</p>
<p>ghs</p>
<p>or</p>
<p>unix</p>
<p>)</p>
<p>that could conflict with identifiers in your program.</p>
<p>Each Green Hills macro is defined with two leading underscores and two trailing</p>
<p>underscores in all language modes, unless stated otherwise.</p>
<p>Macros marked with an asterisk (</p>
<p>*</p>
<p>) are also defined by default without the two</p>
<p>trailing underscores.</p>
<p>When using C or C++ modes other than Strict ANSI C, you can instruct the</p>
<p>preprocessor to generate versions of macros marked with</p>
<p>*</p>
<p>that do not have a leading</p>
<p>or trailing underscore by enabling the<b> AdvancedâPreprocessor</b></p>
<p><b>OptionsâDefinition of Unsafe Symbols</b> (<b>--unsafe_predefines</b>) option.</p>
<p>All predefined macros have the value</p>
<p>1</p>
<p>, unless stated otherwise.</p>
<p><b>Macro Names Required by ANSI C and C++</b></p>
<p>The standards for C and C++ require the preprocessor to define certain macro names.</p>
<p>These macro names and their values are shown in the table below.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>780</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__cplusplus</p>
<p>The value of this macro is:</p>
<p>â¢</p>
<p>199711L</p>
<p>â in ANSI C++</p>
<p>â¢</p>
<p>1</p>
<p>â in other modes of C++ (EC++, EEC++, ARM, GNU)</p>
<p>â¢</p>
<p>Undefined in C</p>
<p>__DATE__</p>
<p>A string literal representing the date of the current compilation, which is 11 characters long,</p>
<p>and in the form:<i> mmm dd yyyy</i>. For example:</p>
<p>Apr 01 2001</p>
<p>__FILE__</p>
<p>A string literal representing the name of the current source file (for example,</p>
<p>file.c</p>
<p>). For the</p>
<p>base file,</p>
<p>__FILE__</p>
<p>includes the pathname. If the compiler reaches the file through an</p>
<p>#include</p>
<p>directive,</p>
<p>__FILE__</p>
<p>contains the pathname (if any) from the include path through which the</p>
<p>file was found. If the include path is relative, it is appended to the pathname of the base file.</p>
<p>__LINE__</p>
<p>An integer literal representing the line number in the current source file.</p>
<p>__STDC__</p>
<p>The value of this macro is:</p>
<p>â¢</p>
<p>0</p>
<p>â in C++ and ANSI C mode</p>
<p>â¢</p>
<p>1</p>
<p>â in Strict ANSI C mode and C99 mode</p>
<p>â¢</p>
<p>Undefined in K&amp;R C</p>
<p>__STDC_VERSION__</p>
<p>The value of this macro is:</p>
<p>â¢</p>
<p>199901L</p>
<p>â in C99 mode</p>
<p>â¢</p>
<p>199409L</p>
<p>â in ANSI C and GNU C</p>
<p>â¢</p>
<p>Undefined in C++ and K&amp;R C</p>
<p>__STDC_HOSTED__</p>
<p>The value of this macro is:</p>
<p>â¢</p>
<p>1</p>
<p>â in C++ and all modes of C other than K&amp;R C</p>
<p>â¢</p>
<p>Undefined in K&amp;R C</p>
<p><i>781</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Macro Names Required by ANSI C and C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__TIME__</p>
<p>A string literal representing the local time of the current compilation, which is 8 characters long,</p>
<p>and in the form:<i> hh:mm:ss</i>. For example:</p>
<p>&quot;11:46:51&quot;</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>782</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Language Identifier Macros</b></p>
<p>These macros identify the language used:</p>
<p><b>Primary Language Macros</b></p>
<p>*</p>
<p>__LANGUAGE_ASM__</p>
<p>Language is assembly.</p>
<p>*</p>
<p>__LANGUAGE_C__</p>
<p>Language is C.</p>
<p>*</p>
<p>__LANGUAGE_CXX__</p>
<p>Language is C++.</p>
<p><b>C Language Macros</b></p>
<p>__GNUC__</p>
<p>GNU C or C++ mode (<b>-gcc</b> or<b> --g++</b>).</p>
<p>__GNUC_GNU_INLINE__</p>
<p>GNU C or GNU C99 mode (<b>-gcc</b> or<b> -gnu99</b>) when GNU-style inlining is used.</p>
<p>__GNUC_STDC_INLINE__</p>
<p>GNU C or GNU C99 mode (<b>-gcc</b> or<b> -gnu99</b>) when GNU99-style inlining is used.</p>
<p>__Japanese_Automotive_C__</p>
<p>Japanese Automotive C (seeâJapanese Automotive C Extensionsâ on page 684).</p>
<p>__PROTOTYPES__</p>
<p>All modes of C except K&amp;R mode. All modes of C++.</p>
<p>__STRICT_ANSI__</p>
<p>Language is Strict ANSI C (<b>-ANSI</b>) or Strict C99 (<b>-C99</b>). Undefined in C++.</p>
<p><b>C++ Language Macros</b></p>
<p>__c_plusplus</p>
<p>Language is C++ (this is for backwards compatibility with some older C++ implementations).</p>
<p>When writing new code, use</p>
<p>__cplusplus</p>
<p>.</p>
<p><i>783</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Language Identifier Macros</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__embedded_cplusplus</p>
<p>Language is Embedded or Extended Embedded C++.</p>
<p>__EMBEDDED_CXX</p>
<p>Language is Embedded C++ (for example, option<b> --e</b>).</p>
<p>__EMBEDDED_CXX_HEADERS</p>
<p>The Embedded C++ header files and libraries are used (for example, options<b> --el</b> or<b> --ele</b>).</p>
<p>__EXTENDED_EMBEDDED_CXX</p>
<p>Language is Extended Embedded C++ (ESTL) (for example, option<b> --ee</b>).</p>
<p>__EXTENDED_EMBEDDED_CXX_HEADERS</p>
<p>The Extended Embedded C++ header files and libraries are used (for example, options<b> --eel</b> or</p>
<p><b>--eele</b>).</p>
<p>__STANDARD_CXX</p>
<p>Language is Standard C++.</p>
<p>__STANDARD_CXX_HEADERS</p>
<p>The Standard C++ header files and libraries are used (for example, options<b> --stdl</b> or<b> --stdle</b>).</p>
<p><b>Green Hills Toolchain Identification Macros</b></p>
<p>__EDG__</p>
<p>C or C++ compilers.</p>
<p>*</p>
<p>__ghs__</p>
<p>Any Green Hills Software compiler or preprocessor.</p>
<p>__ghs_asm</p>
<p>Indicates that the Green Hills assembler is in use.</p>
<p>__GHS_REVISION_DATE</p>
<p>The date of the compiler, represented as a string similar to</p>
<p>__DATE__</p>
<p>.</p>
<p>__GHS_REVISION_VALUE</p>
<p>Represents the date of the compiler build in the</p>
<p>time_t</p>
<p>format.</p>
<p>__GHS_VERSION_NUMBER</p>
<p>Represents the version of the toolchain as a six-digit decimal integer. For example,</p>
<p>in MULTI , Compiler 2012.0, this macro would be defined as</p>
<p>201200</p>
<p>.</p>
<p>__gnu_asm</p>
<p>Indicates that the GNU assembler is in use.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>784</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__unix_asm</p>
<p>Indicates that the UNIX assembler is in use.</p>
<p><b>V850 and RH850-Specific Predefined Macro Names</b></p>
<p>The following table lists predefined macros specific to the V850 and RH850</p>
<p>processor family. For a complete list of individual processor macros, see âV850</p>
<p>and RH850 Processor Variantsâ on page 53.</p>
<p>*</p>
<p>__V800__</p>
<p>Renesas V800 Series processor family.</p>
<p>*</p>
<p>__V800_ignore_callt_state_in_interrupts__</p>
<p>CTPSW</p>
<p>and</p>
<p>CTPC</p>
<p>registers are not saved by compiler-generated interrupt prologues.</p>
<p>*</p>
<p>__V800_no_callt__</p>
<p>callt</p>
<p>instructions are not generated.</p>
<p>*</p>
<p>__V800_r20has255__</p>
<p>Register</p>
<p>r20</p>
<p>always contains the value 255.</p>
<p>*</p>
<p>__V800_r21has65535__</p>
<p>Register</p>
<p>r21</p>
<p>always contains the value 65535.</p>
<p>*</p>
<p>__V800_registermode__=<i>n</i></p>
<p>Represents registers reserved for user.<i> n</i> is set to one of the following values:</p>
<p>â¢</p>
<p>22:</p>
<p>r15</p>
<p>â</p>
<p>r24</p>
<p>are reserved for user</p>
<p>â¢</p>
<p>26:</p>
<p>r17</p>
<p>â</p>
<p>r22</p>
<p>are reserved for user</p>
<p>â¢</p>
<p>32: No registers are reserved for user</p>
<p>*</p>
<p>__V800_reserve_r2__</p>
<p>Register</p>
<p>r2</p>
<p>is reserved for user.</p>
<p>*</p>
<p>__V850__</p>
<p>__V851__</p>
<p>Both of these symbols are defined for any</p>
<p>v850</p>
<p>family processor</p>
<p>__V850__</p>
<p>__V850e__</p>
<p>One of these symbols is defined depending on whether the processor belongs to</p>
<p>the</p>
<p>v850e</p>
<p>family.</p>
<p><i>785</i></p>
<p><i>Green Hills Software</i></p>
<p><i>V850 and RH850-Specific Predefined Macro Names</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>For a list of individual processor macros, see âV850 and RH850 Processor</p>
<p>Variantsâ on page 53.</p>
<p><b>Endianness Macros</b></p>
<p>One of these symbols is always defined to specify the endianness of the target</p>
<p>processor.</p>
<p>__BIG_ENDIAN__</p>
<p>Big Endian byte order.</p>
<p>__LITTLE_ENDIAN__</p>
<p>Little Endian byte order.</p>
<p><b>Data Type Macros</b></p>
<p>These macros specify the size and signedness of certain data types.</p>
<p><b>Sizes</b></p>
<p>__CHAR_BIT</p>
<p>Defined as the size of</p>
<p>char</p>
<p>in bits.</p>
<p>__FUNCPTR_BIT</p>
<p>Defined as the size of a function pointer in bits.</p>
<p>__INT_BIT</p>
<p>Defined as the size of</p>
<p>int</p>
<p>in bits.</p>
<p>__LONG_BIT</p>
<p>Specifies the size of</p>
<p>long</p>
<p>in bits.</p>
<p>__LLONG_BIT</p>
<p>Specifies the size of</p>
<p>long long</p>
<p>in bits. Defined only if the</p>
<p>long long</p>
<p>type is supported.</p>
<p>__PTR_BIT</p>
<p>Specifies the size of a pointer in bits.</p>
<p>__REG_BIT</p>
<p>Specifies the size of an integer register in bits.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>786</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__SHRT_BIT</p>
<p>Specifies the size of</p>
<p>short</p>
<p>in bits.</p>
<p>__WCHAR_BIT</p>
<p>Specifies the size of</p>
<p>wchar_t</p>
<p>in bits.</p>
<p><b>Signedness</b></p>
<p>__Field_Is_Signed__</p>
<p>__Field_Is_Unsigned__</p>
<p>Bitfields are signed or unsigned.</p>
<p>__Ptr_Is_Signed__</p>
<p>__Ptr_Is_Unsigned__</p>
<p>Pointers are signed or unsigned.</p>
<p>__Char_Is_Signed__</p>
<p>__SIGNED_CHARS__</p>
<p>__Char_Is_Unsigned__</p>
<p>__CHAR_UNSIGNED__</p>
<p>Type</p>
<p>char</p>
<p>is signed or unsigned.</p>
<p>__WChar_Is_Signed__</p>
<p>__WChar_Is_Unsigned__</p>
<p>Type</p>
<p>wchar_t</p>
<p>is signed or unsigned.</p>
<p><b>Floating-Point Macros</b></p>
<p>These macros specify the manner in which floating-point operations are performed.</p>
<p>*</p>
<p>__DOUBLE_HL__</p>
<p>Passed if the high word of a double comes at the lower address in memory. This</p>
<p>is usually the case for big endian targets, although certain targets behave</p>
<p>differently.</p>
<p>*</p>
<p>__IeeeFloat__</p>
<p>IEEE-754 floating-point format. This symbol is always defined.</p>
<p><i>787</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Floating-Point Macros</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Floating-Point Mode Macros</b></p>
<p>One of these symbols is always defined, unless full hardware floating point is</p>
<p>enabled.</p>
<p>*</p>
<p>__NoFloat__</p>
<p>No floating point mode.</p>
<p>*</p>
<p>__SoftwareDouble__</p>
<p>Double precision floating point uses integer instructions.</p>
<p>*</p>
<p>__SoftwareFloat__</p>
<p>All floating point is done with integer instructions.</p>
<p><b>MISRA Macros</b></p>
<p>These macros relate to the MISRA C variant.</p>
<p>__MISRA_<i>i</i></p>
<p>MISRA diagnostic levels.</p>
<p><i>i</i> is either 8 or 118â127. The macro is defined as one of the following:</p>
<p>â¢</p>
<p>0: Silent</p>
<p>â¢</p>
<p>1: Warn</p>
<p>â¢</p>
<p>2: Error</p>
<p>For more information about the MISRA rules, see âMISRA C 1998â on page 204.</p>
<p>__ONLY_STANDARD_KEYWORDS_IN_C</p>
<p>MISRA rule No. 1</p>
<p><b>Memory Model Macros</b></p>
<p>These macros relate to various different forms of memory model.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>788</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Position Independent Code and Data Macros</b></p>
<p>*</p>
<p>__ghs_pic</p>
<p>Position Independent Code (PIC) is enabled. This macro is defined as one of the</p>
<p>following:</p>
<p>â¢</p>
<p>1: Deprecated Green Hills behavior. In this mode, static or global initializers</p>
<p>to position-independent objects were not supported. The compiler will warn</p>
<p>for any unsupported position independent initializers.</p>
<p>â¢</p>
<p>2: Normal Green Hills behavior. Special start-up code is invoked to fix up</p>
<p>static or global initializers to position-independent objects.</p>
<p>*</p>
<p>__ghs_pid</p>
<p>Position Independent Data (PID) is enabled. This macro is defined as one of the</p>
<p>following:</p>
<p>â¢</p>
<p>1: Deprecated Green Hills behavior. In this mode, static or global initializers</p>
<p>to position-independent objects were not supported. The compiler will warn</p>
<p>for any unsupported position independent initializers.</p>
<p>â¢</p>
<p>2: Normal Green Hills behavior. Special start-up code is invoked to fix up</p>
<p>static or global initializers to position-independent objects.</p>
<p><b>Small Data Area Macros</b></p>
<p>*</p>
<p>__ghs_sda</p>
<p>Defined if Small Data Area optimization is supported. If this macro is not defined,</p>
<p>instances of</p>
<p>#pragma ghs startsda</p>
<p>will be ignored with a warning.</p>
<p>*</p>
<p>__ghs_sda_threshold</p>
<p>Defined as the size,<i> n</i>, of the SDA threshold (as specified by the<b> -sda=<i>n</b></i> option).</p>
<p><b>Tiny Data Area Macros</b></p>
<p>*</p>
<p>__ghs_tda</p>
<p>Defined if Tiny Data Area optimization is supported. If this macro is not defined,</p>
<p>instances of</p>
<p>#pragma ghs starttda</p>
<p>will be ignored with a warning.</p>
<p><i>789</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Memory Model Macros</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Zero Data Area Macros</b></p>
<p>*</p>
<p>__ghs_zda</p>
<p>Defined if Zero Data Area optimization is supported. If this macro is not defined,</p>
<p>instances of</p>
<p>#pragma ghs startzda</p>
<p>will be ignored with a warning.</p>
<p>*</p>
<p>__ghs_zda_threshold</p>
<p>Defined as the size,<i> n</i>, of the ZDA threshold (as specified by the<b> -zda=<i>n</b></i> driver</p>
<p>option).</p>
<p><b>Global Register Macros</b></p>
<p>__GlobalRegisters</p>
<p>Corresponds to the<b> -globalreg=<i>n</b></i> option, where<i> n</i> is a non-negative positive integer.</p>
<p><b>Global Variable Macros</b></p>
<p>*</p>
<p>__GHS_NOCOMMONS__</p>
<p>Uninitialized global variables in C do not exhibit</p>
<p>COMMON</p>
<p>variable behavior</p>
<p>(corresponds to the<b> --no_commons</b> driver option).</p>
<p>*</p>
<p>__GHS_NO_ZERO_COMMONS__</p>
<p>Uninitialized global variables that are allocated in the Zero Data Area by a</p>
<p>#pragma</p>
<p>directive or command line option do not exhibit the</p>
<p>COMMON</p>
<p>behavior</p>
<p>(corresponds to the<b> -no_zero_commons</b> driver option).</p>
<p><b>Alignment and Packing Macros</b></p>
<p>These macros specify the size of data alignment and packing.</p>
<p>__ghs_alignment</p>
<p>Alignment of the most-aligned type, which is either</p>
<p>double</p>
<p>,</p>
<p>long</p>
<p>, or</p>
<p>long long</p>
<p>.</p>
<p>Has a value of 1, 2, 4, or 8.</p>
<p>__ghs_max_pack_value</p>
<p>Represents the largest value that may be passed to</p>
<p>#pragma pack(<i>n</i>)</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>790</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__ghs_packing</p>
<p>Represents value specified with the<b> -pack=<i>n</b></i> option on the command line. Has a value of 1, 2,</p>
<p>4, or 8. If the macro name is not defined, the<b> -pack=</b> option was not specified on the command</p>
<p>line. This value is not changed by the</p>
<p>#pragma pack(<i>n</i>)</p>
<p>directive.</p>
<p><b>Current File and Function Macros</b></p>
<p>These macros identify the current file and function. See also</p>
<p>__FILE__</p>
<p>in âMacro</p>
<p>Names Required by ANSI C and C++â on page 780.</p>
<p>__BASE__</p>
<p>A string literal representing the name of the current source file, without the directory path.</p>
<p>__FULL_DIR__</p>
<p>A string literal representing the full pathname of the directory of the current source file.</p>
<p>__FULL_FILE__</p>
<p>A string literal representing the full pathname of the current source file.</p>
<p>__FUNCTION__</p>
<p>A string literal representing the current function name.</p>
<p>The compiler does not resolve this macro when you use the<b> -E</b> or<b> -P</b> options.</p>
<p>__PRETTY_FUNCTION__</p>
<p>In C++, a string literal representing the fully qualified function name (for example,</p>
<p>mynamespace::myclass::method</p>
<p>). Note that overloaded functions with different signatures</p>
<p>might have the same fully qualified name.</p>
<p>In C,</p>
<p>__PRETTY_FUNCTION__</p>
<p>behaves the same as</p>
<p>__FUNCTION__</p>
<p>.</p>
<p>The compiler does not resolve this macro when you use the<b> -E</b> or<b> -P</b> options.</p>
<p><b>Object Format Macros</b></p>
<p>These macros specify the object format.</p>
<p>*</p>
<p>__COFF__</p>
<p>Object file type is COFF.</p>
<p>*</p>
<p>__ELF__</p>
<p>Object file type is ELF.</p>
<p><i>791</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Current File and Function Macros</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Optimization Predefined Macro Names</b></p>
<p>These macros relate to the optimization strategy employed.</p>
<p>__GHS_Inline_Memory_Functions</p>
<p>Inlining of C Memory Functions (see âInlining of C Memory Functionsâ on page 333).</p>
<p>__GHS_Inline_String_Functions</p>
<p>Inlining of C String Functions is enabled (see âInlining of C String Functionsâ on page 333).</p>
<p>__GHS_Optimize_Inline</p>
<p>Two-pass inlining is enabled see âTwo-Pass Inlining (Intermodule Inlining)â on page 328).</p>
<p><b>C++ Macros</b></p>
<p>These macros relate to various features of C++.</p>
<p>__ARRAY_OPERATORS</p>
<p>Defined when array new and delete are enabled (that is,</p>
<p>operator new[]</p>
<p>and</p>
<p>operator</p>
<p>delete[]</p>
<p>).</p>
<p>_BOOL</p>
<p>Defined when</p>
<p>bool</p>
<p>is recognized as a basic type (for example, as with the option<b> --bool</b>).</p>
<p>__EDG_IMPLICIT_USING_STD</p>
<p>Defined when the standard namespace</p>
<p>std</p>
<p>is implicitly used (as with the option<b> --using_std</b>).</p>
<p>__EDG_RUNTIME_USES_NAMESPACES</p>
<p>Indicates that the C++ Run-time libraries use namespaces.</p>
<p>__EXCEPTION_HANDLING</p>
<p>__EXCEPTIONS</p>
<p>Indicates C++ compiler is running in a mode that allows exception handling.</p>
<p>__NAMESPACES</p>
<p>Indicates C++ namespaces are accepted.</p>
<p>__RTTI</p>
<p>Indicates Run-Time Type Identification code accepted.</p>
<p>_WCHAR_T</p>
<p>Defined if</p>
<p>wchar_t</p>
<p>is a keyword.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>792</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Operating System-Specific Macros</b></p>
<p>These macros identify the target operating system.</p>
<p><b>ThreadX Macros</b></p>
<p>__THREADX</p>
<p>ThreadX real-time operating system.</p>
<p>TX_ENABLE_EVENT_LOGGING</p>
<p>ThreadX event logging enabled.</p>
<p><b>Miscellaneous Macros</b></p>
<p>__COUNTER__</p>
<p>The value of the</p>
<p>__COUNTER__</p>
<p>macro increases by one each time it is expanded.</p>
<p>On the first expansion, its value is</p>
<p>0</p>
<p>.</p>
<p><b>Deprecated Macros</b></p>
<p>These macros are deprecated and may not be supported in future versions of MULTI.</p>
<p>__Char_Is_Signed__</p>
<p>Type</p>
<p>char</p>
<p>is</p>
<p>signed char.</p>
<p>__Char_Is_Unsigned__</p>
<p>Type</p>
<p>char</p>
<p>is</p>
<p>unsigned char.</p>
<p>__Int_Is_32</p>
<p>Type</p>
<p>int</p>
<p>is 4 bytes.</p>
<p>__Int_Is_64</p>
<p>Type</p>
<p>int</p>
<p>is 8 bytes. (The macro</p>
<p>__Int_Is_64</p>
<p>is an old style macro, kept for</p>
<p>backward compatibility. The new style macros (like</p>
<p>__INT_BIT=<i>n</i></p>
<p>) should be</p>
<p>used when possible.)</p>
<p>*</p>
<p>__msw</p>
<p>Any version of Microsoft Windows (deprecated).</p>
<p>__LL_BIT</p>
<p>Describes the size of</p>
<p>long long</p>
<p>in bits.</p>
<p><i>793</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Operating System-Specific Macros</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__LL_Is_64</p>
<p>Type</p>
<p>long long</p>
<p>is 8 bytes (when</p>
<p>long long</p>
<p>is an allowed type).</p>
<p>__Long_Is_32</p>
<p>Type</p>
<p>long</p>
<p>is 4 bytes.</p>
<p>__Long_Is_64</p>
<p>Type</p>
<p>long</p>
<p>is 8 bytes.</p>
<p>__Ptr_Is_32</p>
<p>Pointers are 4 bytes.</p>
<p>__Ptr_Is_64</p>
<p>Pointers are 8 bytes.</p>
<p>__Reg_Is_32</p>
<p>CPU has 32-bit registers.</p>
<p>__Reg_Is_64</p>
<p>CPU has 64-bit registers.</p>
<p>__WChar_Is_Int__</p>
<p>Type</p>
<p>wchar_t</p>
<p>are</p>
<p>int</p>
<p>or</p>
<p>unsigned int.</p>
<p>__WChar_Is_Long__</p>
<p>Type</p>
<p>wchar_t</p>
<p>are</p>
<p>long</p>
<p>or</p>
<p>unsigned long.</p>
<p>__WChar_Is_Short__</p>
<p>Type</p>
<p>wchar_t</p>
<p>is</p>
<p>short</p>
<p>or</p>
<p>unsigned short.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>794</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Pragma Directives</b></p>
<p>#pragma</p>
<p>directives allow individual compiler implementations to add special</p>
<p>features to C programs without changing the C language. Programs that use</p>
<p>#pragma</p>
<p>directives stay relatively portable, although they make use of features not available</p>
<p>in all ANSI C implementations.</p>
<p>According to the ANSI standard, the</p>
<p>#pragma</p>
<p>directives that are not recognized</p>
<p>by the compiler should be ignored. This requirement may help when porting code</p>
<p>between compilers because one compiler will recognize and process a certain</p>
<p>#pragma</p>
<p>directive, while a different compiler (which does not need or recognize</p>
<p>that</p>
<p>#pragma</p>
<p>directive) will, by default, generate a warning and ignore it.</p>
<p>If a</p>
<p>#pragma</p>
<p>directive which would ordinarily be recognized is misspelled, the</p>
<p>compiler will not recognize it and will, by default, generate a warning and ignore</p>
<p>it. You can increase the severity of these messages to errors, or suppress them, as</p>
<p>follows:</p>
<p>Set the<b> Compiler DiagnosticsâC/C++ MessagesâUnknown Pragma Directives</b></p>
<p>option to<b> Errors</b> (<b>--unknown_pragma_errors</b>) or<b> Silent</b></p>
<p>(<b>--unknown_pragma_silent</b>).</p>
<p>The majority of Green Hills proprietary</p>
<p>#pragma</p>
<p>directives begin with the keyword</p>
<p>ghs</p>
<p>to differentiate them from other implementations. The compiler considers any</p>
<p>#pragma</p>
<p>beginning with the</p>
<p>ghs</p>
<p>keyword to be recognized.</p>
<p>If the compiler recognizes a</p>
<p>#pragma</p>
<p>directive, it will perform some limited syntax</p>
<p>checking.</p>
<p>#pragma</p>
<p>directives that fail these checks will, by default, generate</p>
<p>warnings, and be ignored. You can increase the severity of these messages to errors,</p>
<p>or suppress them, as follows:</p>
<p>Set the<b> Compiler DiagnosticsâC/C++ MessagesâIncorrect Pragma Directives</b></p>
<p>option to<b> Errors</b> (<b>--incorrect_pragma_errors</b>) or<b> Silent</b></p>
<p>(<b>--incorrect_pragma_silent</b>).</p>
<p><i>795</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Pragma Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>General Pragma Directives</b></p>
<p>The general</p>
<p>#pragma</p>
<p>directives are listed in the following table:</p>
<p>#pragma alignfunc (<i>n</i>)</p>
<p>Instructs the compiler to make the next function<i> n</i>-byte aligned, where<i> n</i> is 1, 2, 4, 8, 16, 32,</p>
<p>64, or 128.</p>
<p>#pragma alignvar (<i>n</i>)</p>
<p>Instructs the compiler to make the next variable<i> n</i>-byte aligned, where<i> n</i> is a power of 2 and no</p>
<p>greater than 128.</p>
<p>If the next variable is a non-static local variable, this directive is only effective up to the stack</p>
<p>alignment maintained by the ABI.</p>
<p>#pragma asm</p>
<p>#pragma endasm</p>
<p>These directives mark the beginning and end of a section of code which is to be copied literally</p>
<p>to the assembly language output file. Any macros or preprocessing directives will be processed,</p>
<p>but no processing of comments will be performed. The construct</p>
<p>#pragma endasm</p>
<p>may not</p>
<p>contain any comments or</p>
<p>\</p>
<p>escapes, although it may contain spaces or tabs before and after the</p>
<p>#</p>
<p>character, as long as the total length of the line does not exceed 255 characters.</p>
<p>Note that this directive is not supported with C++ source code.</p>
<p>#pragma ident &quot;<i>string</i>&quot;</p>
<p>Inserts<i> string</i> into the output object file's</p>
<p>.comment</p>
<p>section.</p>
<p>#pragma inline<i> function-list</i></p>
<p>This</p>
<p>#pragma</p>
<p>is deprecated.</p>
<p>Instructs the compiler to consider each function in the comma-separated<i> function-list</i> as a</p>
<p>candidate for inlining.</p>
<p>Note that you cannot force the compiler to inline any function.</p>
<p>#pragma instantiate<i> fn</i></p>
<p>#pragma can_instantiate<i> fn</i></p>
<p>#pragma do_not_instantiate<i> fn</i></p>
<p>These directives can be used to control the instantiation of a template function,<i> fn</i>. For full</p>
<p>documentation, see âTemplate Instantiationâ on page 746.</p>
<p>#pragma intvect<i> intfunc integer_constant</i></p>
<p>Instructs the compiler to insert a jump to the function<i> intfunc</i> at the address specified by</p>
<p><i>integer_constant</i>.</p>
<p>For more information, see âInterrupt Routinesâ on page 122.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>796</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma once</p>
<p>If this</p>
<p>#pragma</p>
<p>is placed at the beginning of a header file, the compiler will only include the</p>
<p>file once, and will ignore subsequent</p>
<p>#include</p>
<p>statements that reference the file.</p>
<p>#pragma pack (<i>n</i>)</p>
<p>#pragma pack ()</p>
<p>#pragma pack (push {,<i> name</i>} {,<i> n</i>})</p>
<p>#pragma pack (pop {,<i> name</i>} {,<i> n</i>})</p>
<p><b>Note</b></p>
<p>Support for structure packing in C++ is limited. See the release notes for more</p>
<p>information.</p>
<p>Instructs the compiler to lay out subsequent</p>
<p>class</p>
<p>,</p>
<p>struct</p>
<p>, and</p>
<p>union</p>
<p>definitions in memory</p>
<p>with a maximum alignment of<i> n</i>, where<i> n</i> is a power of two and less than or equal to the value</p>
<p>of</p>
<p>__ghs_max_pack_value</p>
<p>.</p>
<p>The second format, where<i> n</i> is not specified, reverts the maximum alignment to the default</p>
<p>value, or that specified by the Builder or driver.</p>
<p>The third and fourth formats allow you to push and pop maximum alignment values, and to</p>
<p>specify a<i> name</i> for the pushed value, so that it can subsequently be popped back to by name.</p>
<p><b>Warning</b></p>
<p>When building applications for INTEGRITY, you must ensure that there is no</p>
<p>structure packing in effect when including an INTEGRITY or system header.</p>
<p>#pragma __printf_args</p>
<p>#pragma __scanf_args</p>
<p>These directives should be used immediately before a function declaration or definition.</p>
<p>If the function has a variable number of arguments and the last specified argument is of type</p>
<p>char *</p>
<p>, the function is treated as a variadic function like</p>
<p>printf</p>
<p>or</p>
<p>scanf</p>
<p>.</p>
<p>The compiler will expect that the last specified argument is a character string, with</p>
<p>printf</p>
<p>or</p>
<p>scanf</p>
<p>formatting sequences (such as</p>
<p>&quot;%s&quot;</p>
<p>), and will check the extra arguments to ensure that</p>
<p>the type and number match the type and number specified in the format string.</p>
<p>#pragma unknown_control_flow (<i>function-list</i>)</p>
<p>Instructs the compiler to anticipate an<i> unexpected flow</i> from each function in the comma-separated</p>
<p><i>function-list</i>. Such a function would be</p>
<p>setjmp</p>
<p>. This information is used in various optimizations.</p>
<p><i>797</i></p>
<p><i>Green Hills Software</i></p>
<p><i>General Pragma Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma weak<i> foo</i></p>
<p>Defines<i> foo</i> as a<i> weak symbol</i>. This</p>
<p>#pragma</p>
<p>may be used in either of the following ways:</p>
<p>â¢</p>
<p>If<i> foo</i> is declared as an external reference in<i> filename</i>:</p>
<p>#pragma weak foo</p>
<p>extern int foo;</p>
<p>and<i> foo</i> is not defined in any other file, then the address of<i> foo</i> is set to zero (or, in the case</p>
<p>of projects that use PIC or PID,</p>
<p>0</p>
<p>plus the adjustment for the</p>
<p>text</p>
<p>or</p>
<p>data</p>
<p>segment offset).</p>
<p>This will prevent an</p>
<p>undefined symbol</p>
<p>linker error.</p>
<p>â¢</p>
<p>If<i> foo</i> is defined in<i> filename</i>:</p>
<p>#pragma weak foo</p>
<p>int foo = 1;</p>
<p>and is linked with a non-weak definition of</p>
<p><i>foo</i></p>
<p>in another module, then that other definition</p>
<p>will have priority, and the definition in<i> filename</i> will be treated as if it were an external</p>
<p>reference. If all definitions are weak and there is more than one definition, it is undefined</p>
<p>which definition is used.</p>
<p>By default, the linker does not pull in object files from libraries to resolve undefined weak</p>
<p>symbols or to override weak definitions with stronger library definitions. To force the linker to</p>
<p>resolve undefined weak symbols, use the<b> -extractweak</b> linker option.</p>
<p>#pragma weak<i> foo</i> =<i> bar</i></p>
<p>This</p>
<p>#pragma</p>
<p>has the same effect as</p>
<p>#pragma weak<i> foo</i></p>
<p>, except that (subject to the same</p>
<p>conditions) the address of<i> foo</i> is set to the address of<i> bar</i>. It requires that<i> foo</i> is not defined in</p>
<p>the current module, although it could be an external reference.<i> bar</i> must be defined at the</p>
<p>outermost level of the current module.<i> bar</i> may not be a common symbol (see the<b> C/C++</b></p>
<p><b>CompilerâC/C++ Data AllocationâAllocation of Uninitialized Global Variables</b> option</p>
<p>in âC/C++ Data Allocationâ on page 216).</p>
<p>This</p>
<p>#pragma</p>
<p>may be used to provide a backwards-compatible alias to a symbol which has</p>
<p>been renamed in a new version of a program, as follows:</p>
<p>#pragma weak oldname=name</p>
<p>int name()</p>
<p>{</p>
<p>return 5;</p>
<p>}</p>
<p>If any old software depends on the existence of<i> oldname</i>, it will continue to work as if the</p>
<p>function is called<i> oldname</i>. If there are no longer any references to<i> oldname</i>, then the symbol</p>
<p>effectively disappears and can be reused.</p>
<p>When aliasing variables, behavior is undefined if you use more than one way to reference the</p>
<p>actual variable.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>798</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Green Hills Extension Pragma Directives</b></p>
<p>The Green Hills extension</p>
<p>#pragma</p>
<p>directives are listed in the following table:</p>
<p>#pragma ghs alias<i> newsym oldsym</i></p>
<p>Creates a new global symbol<i> newsym</i> with the same address as<i> oldsym</i>.<i> newsym</i> cannot be</p>
<p>defined in the current module or the behavior is undefined.<i> oldsym</i> must be defined at the</p>
<p>outermost level of the current module.<i> oldsym</i> cannot be a common symbol (see the<b> C/C++</b></p>
<p><b>CompilerâC/C++ Data AllocationâAllocation of Uninitialized Global Variables</b> option</p>
<p>in âC/C++ Data Allocationâ on page 216).</p>
<p>#pragma ghs alias<i> newsym oldsym</i></p>
<p>is similar to</p>
<p>#pragma weak<i> newsym=oldsym</i></p>
<p>except</p>
<p>that in the latter case,<i> newsym</i> is defined as a weak symbol.</p>
<p>When aliasing variables, behavior is undefined if you use more than one way to reference the</p>
<p>actual variable.</p>
<p>#pragma ghs callmode=near|far|default</p>
<p>#pragma ghs near</p>
<p>#pragma ghs far</p>
<p>These</p>
<p>#pragma</p>
<p>directives control the call mode used to call subsequent functions.</p>
<p>For more information about these directives, and other methods for controlling function call</p>
<p>modes, see âNear and Far Function Callsâ on page 93.</p>
<p><i>799</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Green Hills Extension Pragma Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma ghs check=(<i>check-list</i>)</p>
<p>Controls various run-time checks. Any run-time checks enabled either at the point of a function</p>
<p>declaration (the prototype or the first unprototyped use) or at the point of a function definition</p>
<p>will cause those run-time checks to be enabled for that function. Use the following words in the</p>
<p><i>check-list</i>.</p>
<p><b>Memory Checks</b>. These checks do not affect other checks:</p>
<p>â¢</p>
<p>defaultmemory</p>
<p>â<b> Revert</b> to the<b> check=memory</b> or<b> check=nomemory</b> option as specified</p>
<p>by the Builder or driver (see below)</p>
<p>â¢</p>
<p>memory</p>
<p>â<b> Memory Allocation (Intensive)</b> check</p>
<p><b>Note</b></p>
<p>This pragma only works properly if you also build with<b> -check=alloc</b>. See</p>
<p>âRun-Time Memory Checksâ on page 180.</p>
<p><b>Other Checks</b>. These checks do not affect memory checks:</p>
<p>â¢</p>
<p>all</p>
<p>â<b> All</b> checks</p>
<p>â¢</p>
<p>assignbound</p>
<p>â<b> Assignment Bounds</b> check</p>
<p>â¢</p>
<p>bounds</p>
<p>â<b> Array Bounds</b> check</p>
<p>â¢</p>
<p>default</p>
<p>â<b> Revert</b> to the checks specified by the Builder or driver (see below)</p>
<p>â¢</p>
<p>nilderef</p>
<p>â<b> Nil Pointer Dereference</b> check</p>
<p>â¢</p>
<p>none</p>
<p>â<b> No</b> checks</p>
<p>â¢</p>
<p>return</p>
<p>â<b> Return Without Value</b> check</p>
<p>â¢</p>
<p>switch</p>
<p>â<b> Case Label Bounds</b> check</p>
<p>â¢</p>
<p>watch</p>
<p>â<b> Write to Watchpoint</b> check</p>
<p>â¢</p>
<p>zerodivide</p>
<p>â<b> Divide by Zero</b> check</p>
<p>To turn off any of these checks, prepend</p>
<p>no</p>
<p>to the word. For example, to turn on all checks</p>
<p>except<b> Divide by Zero</b>, use the following directive:</p>
<p>#pragma ghs check=(all,nozerodivide)</p>
<p>For information about using run-time checks, see the<b> DebuggingâRun-Time Error Checks</b></p>
<p>option in âDebugging Optionsâ on page 176, and the documentation about viewing memory</p>
<p>allocation information in the<i> MULTI: Debugging</i> book.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>800</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma ghs extra_stack (<i>n</i>)</p>
<p>Specifies the extra stack usage of a particular function that is due to constructs such as Variable</p>
<p>Length Arrays (VLAs),</p>
<p>alloca()</p>
<p>calls, and inline assembly, whose stack usages are not</p>
<p>statically computed. This directive should appear immediately before the definition of the</p>
<p>function it describes, and is used to provide<b> gstack</b> with information that is necessary to accurately</p>
<p>compute the maximum stack usage for the program. For more information, see âAnnotating C</p>
<p>Functions for gstackâ on page 603.</p>
<p>#pragma ghs entry_exit_history=<i>option</i></p>
<p>#pragma ghs entry_exit_history push<i> option</i></p>
<p>#pragma ghs entry_exit_history pop</p>
<p>Enables or disables function entry/exit history on a function-by-function basis, where<i> option</i></p>
<p>has one of the following values:</p>
<p>â¢</p>
<p>on</p>
<p>instruments subsequent functions, regardless of compiler options</p>
<p>â¢</p>
<p>off</p>
<p>disables instrumentation of subsequent functions, regardless of compiler options</p>
<p>â¢</p>
<p>default</p>
<p>instruments subsequent functions based on the specified compiler options</p>
<p>The</p>
<p>push pop</p>
<p>versions of this directive allow you to push the option state onto a stack and pop</p>
<p>back to the previous option state. This behavior is useful for changing function entry/exit history</p>
<p>in header files where you probably do not want to modify the including files's state. For example:</p>
<p>#pragma ghs entry_exit_history=on</p>
<p>// The state is: (0) on</p>
<p>void foo1() { } // Function entry/exit on</p>
<p>#pragma ghs entry_exit_history push off</p>
<p>// The state is: (0) on (1) off</p>
<p>void foo2() { } // Function entry/exit off</p>
<p>#pragma ghs entry_exit_history=default</p>
<p>// The state is: (0) on (1) default</p>
<p>void foo3() { } // Function entry/exit state based on compiler options</p>
<p>#pragma ghs entry_exit_history pop</p>
<p>// The state is: (0) on</p>
<p>void foo4() { } // Function entry/exit on</p>
<p>For more information, see âFunction Entry/Exit Historyâ on page 62.</p>
<p><i>801</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Green Hills Extension Pragma Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma ghs function [exporttda] tdata=&quot;<i>section-name</i>&quot;</p>
<p>#pragma ghs function tda=default</p>
<p>#pragma ghs function</p>
<p>Re-allocates data that would ordinarily be placed in a TDA section to the user-defined</p>
<p><i>section-name</i>.</p>
<p>The optional</p>
<p>exporttda</p>
<p>parameter, marks any appropriate functions as</p>
<p>exporttda</p>
<p>.</p>
<p>The second and third forms revert allocation to the TDA section.</p>
<p>#pragma ghs inlineprologue</p>
<p>#pragma ghs noinlineprologue</p>
<p>These directives control the inlining of function prologue and epilogue code.</p>
<p>#pragma ghs inlineprologue</p>
<p>tells the compiler to inline the prologue and epilogue methods.</p>
<p>This is useful when the prologue or epilogue routines are not callable.</p>
<p>#pragma ghs noinlineprologue</p>
<p>lifts this restriction from the compiler and selects the</p>
<p>most efficient method, given the optimization settings and the registers that must be saved.</p>
<p>This behavior can also be controlled with the<b> AdvancedâTarget OptionsâFunction Prologues</b></p>
<p>Builder option and associated driver option (see âTarget Optionsâ on page 270).</p>
<p>#pragma ghs interrupt[(enabled|nonreentrant|FE)]</p>
<p>Instructs the compiler to make the encompassing function, or the next function if in the file</p>
<p>scope, an interrupt handling function.</p>
<p>The optional parameter</p>
<p>enabled</p>
<p>instructs the compiler to enable interrupts in the interrupt</p>
<p>handler's prologue.</p>
<p>The optional parameter</p>
<p>nonreentrant</p>
<p>instructs the compiler to assume the interrupt handler</p>
<p>cannot be interrupted, resulting in a smaller and faster interrupt handler.</p>
<p>The optional parameter</p>
<p>FE</p>
<p>instructs the compiler to generate code for an FE-level interrupt</p>
<p>handler. This is only available when targeting the V850E2R or newer processors.</p>
<p>It is possible to specify multiple optional parameters by separating them with commas. For</p>
<p>example:</p>
<p>#pragma ghs interrupt(nonreentrant,FE)</p>
<p>#pragma ghs io<i> identifier addr</i></p>
<p>Instructs the compiler to make any subsequent declaration of a variable with the name<i> identifier</i></p>
<p>a special I/O-variable, corresponding to IO port<i> addr</i>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>802</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma ghs max_instances (<i>n</i>)</p>
<p>Specifies the maximum number of instances of a function that can exist on the stack at a given</p>
<p>time. This directive should appear immediately before the definition of the function it describes,</p>
<p>and is used to provide<b> gstack</b> with an upper bound on possible recursions so it can accurately</p>
<p>compute the maximum stack usage for the program. For more information, see âAnnotating</p>
<p>Recursive Functionsâ on page 610.</p>
<p>#pragma ghs max_stack (<i>n</i>)</p>
<p>Specifies the maximum stack usage for a function that is defined inside a</p>
<p>#pragma asm</p>
<p>block</p>
<p>within a C file. A declaration for the function should be added outside the block, and this directive</p>
<p>should come immediately before the declaration. This directive is used to provide<b> gstack</b> with</p>
<p>information that is necessary to accurately compute the maximum stack usage for the program.</p>
<p>For more information, see âAnnotating Assembly Functions for gstackâ on page 602.</p>
<p>#pragma ghs nofloat interrupt</p>
<p>Instructs the compiler to prevent the encompassing function or, if in file scope, the next function</p>
<p>(which must be separately identified as an interrupt function) from saving and restoring</p>
<p>floating-point registers. This pragma has no effect if the function prologue is not inline.</p>
<p>#pragma ghs noprologue</p>
<p>Instructs the compiler to omit register save and restore code. That is, all registers are treated as</p>
<p>temporary, caller-save registers.</p>
<p>In addition, a return instruction is not generated.</p>
<p>#pragma ghs nowarning<i> n</i></p>
<p>#pragma ghs endnowarning</p>
<p>Temporarily suppress diagnostic number<i> n</i>. (An error tag or coding standard profile tag may be</p>
<p>given in place of the diagnostic number.) You may use multiple and/or nested</p>
<p>#pragma ghs</p>
<p>nowarning</p>
<p>directives, but each should have a matching</p>
<p>#pragma ghs endnowarning</p>
<p>.</p>
<p>The complete set of error numbers and error tags is also listed in the<i> MULTI: Toolchain Error</i></p>
<p><i>Messages</i> book (not available in print). For more information about coding standard profiles,</p>
<p>see Chapter 14, âCoding Standardsâ on page 767.</p>
<p>To display error and warning numbers with diagnostic messages, enable the<b> Compiler</b></p>
<p><b>DiagnosticsâC/C++ MessagesâVarying Message SeverityâDisplay Error Message</b></p>
<p><b>Numbers</b> option (<b>--display_error_number</b>).</p>
<p><b>Note:</b> The location where</p>
<p>#pragma ghs nowarning</p>
<p>must be is dependent on the</p>
<p>implementation of the warning in question, and is not always at the position where the warning</p>
<p>is shown in the diagnostic output.</p>
<p><i>803</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Green Hills Extension Pragma Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma ghs O<i>string</i></p>
<p>#pragma ghs ZO</p>
<p>#pragma ghs O<i>string</i></p>
<p>turns on optimizations, while</p>
<p>#pragma ghs ZO</p>
<p>turns them off. (This</p>
<p>includes many of the optimizations implied by command line options.) The optional<i> string</i> can</p>
<p>contain any or all of the following letters:</p>
<p>â¢</p>
<p>L</p>
<p>âLoop optimizations</p>
<p>â¢</p>
<p>M</p>
<p>â Memory optimizations</p>
<p>â¢</p>
<p>S</p>
<p>â Small (but Slow) optimizations</p>
<p>Although the possible values of<i> string</i> are similar to several optimization-related command line</p>
<p>options, their effects may be different.</p>
<p><b>Note</b></p>
<p>You can enable optimizations by omitting<i> string</i> from the directive.</p>
<p>For information about Builder and driver optimization options, see âOptimization Optionsâ</p>
<p>on page 165. For descriptions of many of our optimizations, see Chapter 4, âOptimizing Your</p>
<p>Programsâ on page 323.</p>
<p>#pragma ghs reference<i> sym</i></p>
<p>Creates a reference to symbol<i> sym</i>, which can force the symbol to be pulled in from a library.</p>
<p>It can also be used to prevent an unused function called<i> sym</i> from being deleted by the âDeletion</p>
<p>of Unused Functionsâ optimization.</p>
<p>#pragma ghs revertoptions</p>
<p>Disables all options set via</p>
<p>#pragma ghs</p>
<p>directives and returns to the defaults specified by the</p>
<p>Builder or driver.</p>
<p>#pragma ghs rh850 trace_loads=<i>option</i></p>
<p>Enable or disables load address logging on a function-by-function basis, where<i> option</i> has one</p>
<p>of the following values:</p>
<p>â¢</p>
<p>on</p>
<p>instruments subsequent functions, regardless of compiler options</p>
<p>â¢</p>
<p>off</p>
<p>disables instrumentation of subsequent functions, regardless of compiler options</p>
<p>For example:</p>
<p>#pragma ghs rh850 trace_loads=on</p>
<p>int foo1(int *p) { return *p; } // Load is logged</p>
<p>#pragma ghs rh850 trace_loads=off</p>
<p>int foo2(int *p) { return *p; } // Load is not logged</p>
<p>For more information, see âLogging Load Addressesâ on page 50.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>804</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma ghs safeasm</p>
<p>#pragma ghs optasm</p>
<p>These directives mark the next hand-written assembly language entity (for example,</p>
<p>#pragma</p>
<p>asm</p>
<p>,</p>
<p>asm</p>
<p>macro, etc.) as âsafeâ for linker optimization analysis. Normally, hand-written assembly</p>
<p>entities disqualify a module for linker optimization. If the entity is preceded by either of these</p>
<p>directives, that entity does not disqualify the module for linker optimization. In order for a</p>
<p>module to be considered âsafeâ, each assembly entity must be marked with one of these pragma</p>
<p>directives.</p>
<p>#pragma ghs optasm</p>
<p>marks the entity as safe and allows optimizations to occur within the</p>
<p>entity.</p>
<p>#pragma ghs safeasm</p>
<p>marks the entity as safe for some optimizations, but unsafe for others.</p>
<p>If you want the final executable to contain the exact assembly code you have written, do not</p>
<p>use this</p>
<p>#pragma</p>
<p>directive.</p>
<p>Only use these directives to mark assembly that does not contain any âunsafeâ code. Unsafe</p>
<p>code includes, but is not limited to, branches and control flow structures not normally generated</p>
<p>by the compiler, and any code that violates the standard calling convention.</p>
<p>#pragma ghs section<i> secttype</i>=&quot;<i>sectname</i>&quot;</p>
<p>Instructs the compiler to allocate to<i> sectname</i> code or data that would normally be allocated to</p>
<p><i>secttype</i>.<i> sectname</i> must not contain spaces, quotes, parentheses, or wildcards. For more</p>
<p>information, see âCustom Program Sectionsâ on page 83.</p>
<p>#pragma ghs start<i>data-type</i></p>
<p>#pragma ghs end<i>data-type</i></p>
<p>These directives mark the beginning and end of a section of code in which all data should be</p>
<p>allocated to a particular type of data section, where<i> data-type</i> is one of the following:</p>
<p>â¢</p>
<p>data</p>
<p>â normal data sections.</p>
<p>â¢</p>
<p>sda</p>
<p>â<i> small data area</i> sections (see âSpecial Data Area Optimizationsâ on page 96).</p>
<p>â¢</p>
<p>tda</p>
<p>â<i> tiny data area</i> sections (see âV850 Tiny Data Area (TDA) Optimizationâ</p>
<p>on page 107).</p>
<p>â¢</p>
<p>zda</p>
<p>â<i> zero data area</i> sections (see âSpecial Data Area Optimizationsâ on page 96).</p>
<p>These directives will force the compiler to re-allocate data items to special data areas even if</p>
<p>the<b> TargetâText and Data PlacementâSpecial Data Area</b> or<b> TargetâText and Data</b></p>
<p><b>PlacementâV850 Tiny Data Area</b> option has not been enabled. The directives will also</p>
<p>override any threshold which has been set with these options in order to control the maximum</p>
<p>size of data items which can be allocated to a special data area.</p>
<p>You cannot nest these directives; each</p>
<p>#pragma ghs start<i>data-type</i></p>
<p>must be completed</p>
<p>by a matching</p>
<p>#pragma ghs end<i>data-type</i></p>
<p>before another can be used.</p>
<p><i>805</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Green Hills Extension Pragma Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma ghs start_externally_visible</p>
<p>#pragma ghs end_externally_visible</p>
<p>These directives mark the beginning and end of a section of code where all symbols should be</p>
<p>treated by optimizations as externally visible. Any functions or variables defined in this section</p>
<p>will be considered visible outside of the source during Wholeprogram Optimizations. You can</p>
<p>similarly specify that symbols are externally visible using the<b> -external=</b> and<b> -external_file=</b></p>
<p>options, or by using the</p>
<p>externally_visible</p>
<p>GNU attribute. For more information about</p>
<p>the use of this</p>
<p>#pragma</p>
<p>, see âWholeprogram Optimizationsâ on page 341.</p>
<p>#pragma ghs startnocoverage</p>
<p>#pragma ghs endnocoverage</p>
<p>These directives mark the beginning and end of a section of code such that any function defined</p>
<p>in this section will not be instrumented to collect block coverage information.</p>
<p>If block coverage is enabled for this file, functions within this directive will still be displayed</p>
<p>as uncovered within MULTI.</p>
<p>For more information about coverage profiling, see âEnabling Instrumented Coverage or</p>
<p>Performance Profilingâ on page 64.</p>
<p>#pragma ghs startnoinline</p>
<p>#pragma ghs endnoinline</p>
<p>These directives mark the beginning and end of a section of code such that any function defined</p>
<p>in this section will not be considered for inlining. Even inlined C++ member functions or</p>
<p>functions marked with the keywords</p>
<p>__inline</p>
<p>or</p>
<p>inline</p>
<p>will not be inlined.</p>
<p>For more information about controlling inlining, see âInlining Optimizationsâ on page 324.</p>
<p>#pragma ghs startnomisra</p>
<p>#pragma ghs endnomisra</p>
<p>These directives mark the beginning and end of a section of code in which the compiler does</p>
<p>not perform MISRA checking. Note that these directives only prevent the compiler from</p>
<p>performing MISRA checking; they do not prevent MISRA checking in other parts of the toolchain</p>
<p>(see âMISRA C 1998 Rules Enforced by the Linkerâ on page 770, and see âMISRA C 2004</p>
<p>Rules Enforced by the Linkerâ on page 772).</p>
<p>These directives do not disable the run-time checking that is done for certain MISRA rules (for</p>
<p>a list of such rules, see âMISRA C - Run-Time Checksâ on page 204).</p>
<p>For more information, see âMISRA C 2004â on page 187.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>806</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma ghs startnostrongfptr</p>
<p>#pragma ghs endnostrongfptr</p>
<p>These directives mark the beginning and end of a section of code in which the compiler does</p>
<p>not analyze conversions to and from</p>
<p>strong_fptr</p>
<p>types. When using these directives, you</p>
<p>must make sure the call graph properly reflects the behavior of the code in order for<b> gstack</b> to</p>
<p>produce correct results.</p>
<p>For more information, see âWorking With Recursive Clustersâ on page 605.</p>
<p>#pragma ghs static_call<i> routine</i></p>
<p>Specifies that the encompassing function (or the next function to be defined, if used in the file</p>
<p>scope), calls<i> routine</i>. If the caller is defined inside a</p>
<p>#pragma asm</p>
<p>block within a C file, a</p>
<p>declaration for the function should be provided and the directive should be specified immediately</p>
<p>before the declaration.</p>
<p>Specify</p>
<p>0</p>
<p>instead of<i> routine</i> to indicate that no additional calls are made.</p>
<p>This directive provides<b> gstack</b> with information that is necessary to accurately compute the</p>
<p>maximum stack usage for the program. For more information, see âAnnotating C Functions for</p>
<p>gstackâ on page 603 and âAnnotating Assembly Functions for gstackâ on page 602.</p>
<p>#pragma ghs struct_min_alignment(<i>n</i>)</p>
<p>#pragma ghs struct_min_alignment()</p>
<p>Instructs the compiler to lay out subsequent</p>
<p>class</p>
<p>,</p>
<p>struct</p>
<p>, and</p>
<p>union</p>
<p>definitions in memory</p>
<p>with a minimum alignment of<i> n</i> bytes.</p>
<p>The second format, where<i> n</i> is not specified, reverts the minimum alignment to the default value</p>
<p>of 1.</p>
<p>The</p>
<p>#pragma</p>
<p>should not be active before including headers, as the structures referenced by the</p>
<p>header need to be consistent between the module including the header and any other modules</p>
<p>on which the header depends.</p>
<p>The<b> C/C++ CompilerâAlignment and PackingâPacking (Maximum Structure Alignment)</b></p>
<p>(</p>
<p>-pack=<i>n</i>)</p>
<p>and</p>
<p>#pragma pack(<i>n</i>)</p>
<p>directive override this pragma directive.</p>
<p><b>Conditional Pragma Directives</b></p>
<p>This feature is deprecated and may be removed in future versions of MULTI.</p>
<p>Any of the Green Hills extension</p>
<p>#pragma</p>
<p>directives can be made conditional upon</p>
<p>whether you are generating debugging information or are optimizing your executable.</p>
<p>To make a directive conditional, use the syntax:</p>
<p>#pragma ghs [<i>condition</i>]<i> pragma-name</i></p>
<p><i>807</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Green Hills Extension Pragma Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>where the optional<i> condition</i> parameter is one of:</p>
<p>â¢</p>
<p>ifdebug</p>
<p>â Enable the</p>
<p>#pragma</p>
<p>only if debugging information is being</p>
<p>generated (see<b> DebuggingâDebugging Level</b> in âDebugging Optionsâ</p>
<p>on page 176).</p>
<p>â¢</p>
<p>ifnodebug</p>
<p>â Enable the</p>
<p>#pragma</p>
<p>only if debugging information is not being</p>
<p>generated.</p>
<p>â¢</p>
<p>ifoptimize</p>
<p>â Enable the</p>
<p>#pragma</p>
<p>only if optimizations are enabled (see</p>
<p><b>OptimizationâOptimization Strategy</b> in âOptimization Optionsâ on page 165).</p>
<p>â¢</p>
<p>ifnooptimize</p>
<p>â Enable the</p>
<p>#pragma</p>
<p>only if optimizations are not enabled.</p>
<p>For example, to enable the<b> Assignment Bounds</b> and<b> Unallocated Memory</b> run-time</p>
<p>checks only if optimizations are not enabled, enter</p>
<p>#pragma ghs</p>
<p>check=(<i>check-list</i>)</p>
<p>as follows:</p>
<p>#pragma ghs ifnooptimize check=(assign,memory)</p>
<p><b>_Pragma Operator</b></p>
<p>The</p>
<p>_Pragma</p>
<p>preprocessing operator from C99 can be used in all language modes.</p>
<p>It is useful in cases when the effect of a directive is desired within a macro.</p>
<p>For example, the following can be used to define a macro</p>
<p>DECL_ALIGN_BUF</p>
<p>:</p>
<p>#define PRAGMA(x) _Pragma(#x)</p>
<p>#define ALIGNVAR(align) PRAGMA( alignvar(align) )</p>
<p>#define CHANGE_SEC(sec, name) PRAGMA( ghs section sec = name )</p>
<p>/* Define a buffer in section &quot;sect&quot; with the given name, size, and</p>
<p>* alignment</p>
<p>*/</p>
<p>#define DECL_ALIGN_BUF(name, size, align, sect) \</p>
<p>ALIGNVAR(align)</p>
<p>\</p>
<p>CHANGE_SEC(bss, sect)</p>
<p>\</p>
<p>char name[size];</p>
<p>\</p>
<p>CHANGE_SEC(bss, default)</p>
<p>The macro can be invoked as:</p>
<p>DECL_ALIGN_BUF(mybuf, 80, 8, &quot;.mybss&quot;)</p>
<p>This macro invocation has the effect of:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>808</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma alignvar(8)</p>
<p>#pragma ghs section bss=&quot;.mybss&quot;</p>
<p>char mybuf[80];</p>
<p>#pragma ghs section bss=default</p>
<p><i>809</i></p>
<p><i>Green Hills Software</i></p>
<p><i>_Pragma Operator</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Intrinsic Functions</b></p>
<p>Intrinsic functions perform certain tasks which are difficult or inefficient to write</p>
<p>in a high-level language.</p>
<p>Intrinsics are only available on processors that support the underlying instructions.</p>
<p>Consult your processor's reference manual to determine which instructions are</p>
<p>available.</p>
<p>The name of a C or C++ intrinsic function begins with two underscores (</p>
<p>__</p>
<p>). It</p>
<p>usually generates optimized inline code, often using special instructions that do not</p>
<p>correspond to standard C and C++ operations.</p>
<p>Prototypes for the functions can be found in<i><b> install_dir</i>/include/v800/v800_ghs.h</b>,</p>
<p>and can be included as follows:</p>
<p>#include &lt;v800_ghs.h&gt;</p>
<p>void *__builtin_return_address(unsigned int<i> level</i>);</p>
<p>Returns the return address of the current function. The<i> level</i> argument must be set to</p>
<p>0</p>
<p>. This</p>
<p>function cannot be used in interrupt procedures.</p>
<p>unsigned int __STSR(unsigned int, unsigned int);</p>
<p>(Only on the RH850 and later</p>
<p>processors)</p>
<p>void __LDSR(unsigned int, unsigned int, unsigned int);</p>
<p>(Only on the RH850</p>
<p>and later processors)</p>
<p>unsigned int __STSR(unsigned int);</p>
<p>(Only for processors pre-dating the RH850)</p>
<p>void __LDSR(unsigned int, unsigned int);</p>
<p>(Only for processors pre-dating the</p>
<p>RH850)</p>
<p>The</p>
<p>__STSR()</p>
<p>function returns the current value of the system register corresponding to the</p>
<p>number specified by its argument, which must be a constant immediate. On the RH850 and later</p>
<p>processors it also takes a second argument which specifies the register group number, which</p>
<p>must be a constant immediate.</p>
<p>The</p>
<p>__LDSR()</p>
<p>function takes a 32-bit integer argument (as its last argument) and stores it into</p>
<p>the system register corresponding to the number specified by its first argument, which must be</p>
<p>a constant immediate. On the RH850 and later processors it also takes an additional second</p>
<p>argument which specifies the register group number, which must be a constant immediate.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>810</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>int __CAXI(int *, int, int);</p>
<p>The</p>
<p>__CAXI()</p>
<p>function maps to the V850E2R and later's</p>
<p>CAXI</p>
<p>instruction, which performs a</p>
<p>compare and exchange for interlock. 32-bits of data are loaded from the memory pointed to by</p>
<p>the first argument to the function, and is compared to the 32-bits of data provided in the second</p>
<p>argument. If the two values are equal, the third argument is stored back to the memory pointed</p>
<p>to by the first argument. Regardless of the result of the compare, the original contents of the</p>
<p>memory pointed to by the first argument are returned. This intrinsic does not provide a way to</p>
<p>determine the outcome of the comparison.</p>
<p><b>Exception Intrinsics</b></p>
<p>void __DI(void);</p>
<p>void __EI(void);</p>
<p>These functions disable and enable interrupts and can bracket a critical section of code that must</p>
<p>not be interrupted.</p>
<p>void __RIR(unsigned int<i> key</i>);</p>
<p>Takes a<i> key</i> previously returned by</p>
<p>__DIR()</p>
<p>or</p>
<p>__EIR()</p>
<p>and restores interrupts to the state</p>
<p>represented by that key.</p>
<p>This function, together with</p>
<p>__DIR()</p>
<p>and</p>
<p>__EIR()</p>
<p>can be used to safely enable or disable</p>
<p>interrupts and later restore them to their original state when that state is not known at compile</p>
<p>time.</p>
<p>unsigned int __DIR(void);</p>
<p>unsigned int __EIR(void);</p>
<p>Like</p>
<p>__DI()</p>
<p>and</p>
<p>__EI()</p>
<p>, these functions disable and enable interrupts. In addition, they return</p>
<p>an</p>
<p>unsigned int</p>
<p>key that represents the state of interrupts prior to their operation. For more</p>
<p>information, see the documentation for</p>
<p>__DI()</p>
<p>and</p>
<p>__EI()</p>
<p>.</p>
<p>unsigned int __GETSR(void);</p>
<p>void __SETSR(unsigned int<i> val</i>);</p>
<p>The</p>
<p>__GETSR</p>
<p>function returns the current value of the<i> Program Status Word</i> (</p>
<p>PSW</p>
<p>).</p>
<p>The</p>
<p>__SETSR</p>
<p>function takes a 32-bit integer argument and stores it into this register.</p>
<p>If you are using a V850E2R or later, take caution when using these intrinsics because they do</p>
<p>not ensure that BSEL is set to any particular system register bank.</p>
<p><i>811</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Exception Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Arithmetic Operation Instructions</b></p>
<p>unsigned int __MULUH(unsigned int a, unsigned int b);</p>
<p>signed int __MULSH(signed int a, signed int b);</p>
<p>The</p>
<p>__MULUH(<i>a</i>,<i>b</i>)</p>
<p>function takes as arguments two 32-bit unsigned integers<i> a</i> and<i> b</i> and</p>
<p>returns the high 32-bit half of their 64-bit unsigned product.</p>
<p>The</p>
<p>__MULSH(<i>a</i>,<i>b</i>)</p>
<p>function takes as arguments two 32-bit signed integers<i> a</i> and<i> b</i> and returns</p>
<p>the high 32-bit half of their 64-bit signed product.</p>
<p>int __ADD_SAT(int a, int b);</p>
<p>int __SUB_SAT(int a, int b);</p>
<p>The</p>
<p>__ADD_SAT(<i>a</i>,<i>b</i>)</p>
<p>function takes as arguments two 32-bit integers<i> a</i> and<i> b</i> and returns the</p>
<p>sum (</p>
<p>a+b</p>
<p>), saturated as defined by the underlying microprocessor architecture.</p>
<p>The</p>
<p>__SUB_SAT(<i>a</i>,<i>b</i>)</p>
<p>function takes as arguments two 32-bit integers<i> a</i> and<i> b</i> and returns the</p>
<p>difference (</p>
<p>a-b</p>
<p>), saturated as defined by the underlying microprocessor architecture.</p>
<p>int __SCH0R(int);</p>
<p>int __SCH1R(int);</p>
<p>int __SCH0L(int);</p>
<p>int __SCH1L(int);</p>
<p>These functions return the position of the first zero (</p>
<p>__SCH0R()</p>
<p>,</p>
<p>__SCH0L()</p>
<p>) or one</p>
<p>(</p>
<p>__SCH1R()</p>
<p>,</p>
<p>__SCH1L()</p>
<p>) encountered in their 32-bit integer argument when searching from</p>
<p>either from right-to-left (</p>
<p>__SCH0R()</p>
<p>,</p>
<p>__SCH1R()</p>
<p>) or left-to-right (</p>
<p>__SCH0L()</p>
<p>,</p>
<p>__SCH1L()</p>
<p>)</p>
<p>respectively. If no such value is found, zero is returned. If the first bit examined matches, then</p>
<p>1 is returned, with 2 returned for the second bit, and so forth. These intrinsics are only available</p>
<p>with the V850E2 and later processors.</p>
<p>The following example demonstrates their use:</p>
<p>#include &quot;v800_ghs.h&quot;</p>
<p>int x;</p>
<p>void foo(void)</p>
<p>{</p>
<p>x = __SCH0L(0x80000000); /* returns 2 */</p>
<p>x = __SCH0L(0xFFFFFFFE); /* returns 32 */</p>
<p>x = __SCH1R(0x80000000); /* returns 32 */</p>
<p>x = __SCH1R(0xFFFFFFFE); /* returns 2 */</p>
<p>x = __SCH0R(0xFFFFFFFF); /* returns 0 */</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>812</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Memory Barrier Optimization Intrinsics</b></p>
<p>The following intrinsics require you to include<b> ghs_barrier.h</b>.</p>
<p>In the descriptions of the following intrinsics,<i> low-level operations</i> are defined as</p>
<p>assembly statements, intrinsics that access non-user register state, and intrinsics</p>
<p>that may affect loads or stores. While these intrinsics affect the ordering of</p>
<p>instructions, they do not introduce memory fence instructions into the instruction</p>
<p>stream.</p>
<p>void __memory_changed(void);</p>
<p>Adds a barrier that forces all loads, stores, and low-level operations sequenced before the barrier</p>
<p>to occur in instruction execution order before the barrier, and all loads, stores, and low-level</p>
<p>operations sequenced after the barrier to occur in instruction execution order after the barrier.</p>
<p>This intrinsic should be used in lieu of the other barriers.</p>
<p>The following intrinsics are implemented for compatibility with other toolchains.</p>
<p>We do not recommend using them.</p>
<p>void __force_stores(void);</p>
<p>Adds a barrier that forces all stores and low-level operations sequenced before the barrier to</p>
<p>occur in instruction execution order before the barrier, and all stores and low-level operations</p>
<p>sequenced after the barrier to occur in instruction execution order after the barrier.</p>
<p>void __schedule_barrier(void);</p>
<p>Adds a barrier over which the pipeline optimizer will not reschedule instructions. However,</p>
<p>other optimizations may schedule across the barrier, perhaps defeating the point of the barrier.</p>
<p><b>Built-In Intrinsics</b></p>
<p>The following intrinsics do not require a prototype or header file:</p>
<p>__builtin_constant_p(<i>arg</i>)</p>
<p>Evaluates to true if the argument is recognized by the compiler as representing a known constant</p>
<p>value.<i> arg</i> may be an integer or string constant; complex expressions may or may not be</p>
<p>considered constant, depending on optimization settings.</p>
<p>This intrinsic may help you optimize away unused cases when a known constant expression</p>
<p>can be handled differently depending on its value.</p>
<p>Unlike most other<b> gcc</b> syntax, it does not require you to pass the<b> -gcc</b> mode option.</p>
<p><i>813</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Memory Barrier Optimization Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__ghs_noprofile_func()</p>
<p>Acts like an empty function that is always inlined and has the</p>
<p>ghs_noprofile</p>
<p>attribute. This</p>
<p>intrinsic does not affect generated code, but causes MULTI to exclude code paths containing</p>
<p>calls to it from coverage calculations.</p>
<p><b>Floating Point Bit Manipulation Intrinsics</b></p>
<p>Prototypes for these intrinsics are included in<b> math.h</b>.</p>
<p>uint64_t __ghs_getdbits(double)</p>
<p>Returns the double-precision input value in a 64-bit integer. For example,</p>
<p>-0.0</p>
<p>will return</p>
<p>0x8000000000000000</p>
<p>.</p>
<p>double __ghs_setdbits(uint64_t)</p>
<p>Returns the double-precision value as encoded in the 64-bit input value. For example,</p>
<p>0x8000000000000000</p>
<p>will return</p>
<p>-0.0</p>
<p>.</p>
<p>uint32_t __ghs_getfbits(float)</p>
<p>Returns the single-precision value as encoded in the 32-bit integer. For example,</p>
<p>-0.0F</p>
<p>will</p>
<p>return</p>
<p>0x80000000</p>
<p>.</p>
<p>float __ghs_setfbits(uint32_t)</p>
<p>Returns the single-precision value as encoded in the 32-bit input value. For example,</p>
<p>0x80000000</p>
<p>will return</p>
<p>-0.0F</p>
<p>.</p>
<p><b>Static Assertions</b></p>
<p>Static assertions provide a mechanism to perform assertions that are evaluated and</p>
<p>reported at compile time rather than run time. Static assertions have no effect if</p>
<p>their tested condition evaluates to a non-zero value. If the condition evaluates to</p>
<p>zero, an error is displayed along with the string literal passed as the second argument.</p>
<p>The syntax for static assertions is:</p>
<p>_Static_assert(<i> condition</i>,<i> message</i> )</p>
<p>static_assert(<i> condition</i>,<i> message</i> )</p>
<p>where<i> condition</i> must be an integer constant expression that can be evaluated at</p>
<p>compile time, and<i> message</i> must be a string literal. For example:</p>
<p>static_assert(1==0, &quot;Assertion Failed&quot;);</p>
<p>_Static_assert(1==0, &quot;Assertion Failed&quot;);</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>814</i></p>
<p><i>Chapter 15. Macros, Pragma Directives, and Intrinsics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The</p>
<p>_Static_assert</p>
<p>keyword is recognized in both</p>
<p>C</p>
<p>and</p>
<p>C++</p>
<p>, but results in an</p>
<p>error in strict dialects (<b>-ANSI</b>,</p>
<p>-C99</p>
<p>, and</p>
<p>--STD</p>
<p>).</p>
<p>In C,</p>
<p>static_assert</p>
<p>is not a keyword, but there is a macro definition in<b> assert.h</b></p>
<p>that is preprocessed to</p>
<p>_Static_assert</p>
<p>in permissive C dialects. This macro is</p>
<p>not defined in strict C dialects.</p>
<p>In C++,</p>
<p>static_assert</p>
<p>is recognized as a keyword in permissive C++ dialects,</p>
<p>and can be used in the same way as</p>
<p>_Static_assert</p>
<p>. It is not a keyword in strict</p>
<p>C++ dialects.</p>
<p><i>815</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Static Assertions</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 16</b></p>
<p><b>Libraries and Header Files</b></p>
<p><b>Contents</b></p>
<p>The Green Hills Header Files and Standard Libraries . . . . . . . . . . . . . . . . . . .</p>
<p>819</p>
<p>Advanced Library Topics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>823</p>
<p>Green Hills Standard C Library Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>832</p>
<p>Customizing the Run-Time Environment Libraries and Object Modules . . .</p>
<p>863</p>
<h1 style="page-break-before:always; "></h1>
<p>This chapter describes the standard language libraries provided with the Green Hills</p>
<p>tools for V850 and RH850. Libraries are files which contain collections of object</p>
<p>files.</p>
<p>Green Hills provides libraries to implement language features, such as the Standard</p>
<p>C libraries, the C++ libraries, and various aspects of run-time support. These</p>
<p>libraries, and any libraries that you create, are linked into the program image by the</p>
<p>linker,<b> elxr</b>.</p>
<p>Header files provide declarations and macros that may be used while programming.</p>
<p>Many of the functions in the standard libraries are declared in header files. In C and</p>
<p>C++, header files are referenced in the source code by using a</p>
<p>#include</p>
<p>directive,</p>
<p>which is read by the compiler's preprocessor.</p>
<p>By convention, libraries have a<b> .a</b> extension, and are named in the form<b> lib<i>name</i>.a</b>.</p>
<p>C language header files generally have a<b> .h</b> extension, and C++ headers either have</p>
<p>a<b> .h</b> extension or no extension.</p>
<p>This chapter documents Green Hills libraries. For information about creating and</p>
<p>maintaining your own libraries, see Chapter 10, âThe ax Librarianâ on page 515.</p>
<p>For more information, see:</p>
<p>â¢</p>
<p>P. J. Plauger,<i> The Standard C Library</i> (describes the C89 library)</p>
<p>â¢</p>
<p>Harbison &amp; Steele,<i> C: A Reference Manual (5th Ed.)</i> (describes the C99 library)</p>
<p>â¢</p>
<p>B. Stroustrup,<i> The C++ Programming Language (3rd Ed.)</i></p>
<p>â¢</p>
<p>P. J. Plauger,<i> Dinkum C++ Library Reference</i> (included with your distribution,</p>
<p>at<i><b> install_dir</i>/scxx/html/index.html</b>)</p>
<p>â¢</p>
<p>P. J. Plauger,<i> Dinkum Abridged Library Reference</i> (for EC++ and EEC++;</p>
<p>included with your distribution, at<i><b> install_dir</i>/ecxx/html/index.html</b>).</p>
<p><b>Note</b></p>
<p>Your Green Hills compiler license permits you to make unlimited</p>
<p>distributions of programs linked with the Green Hills library object code</p>
<p>without charge. Distribution of Green Hills library source code or object</p>
<p>code is not permitted.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>818</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The Green Hills Header Files and Standard Libraries</b></p>
<p>Your Green Hills tools for V850 and RH850 provide a number of directories that</p>
<p>contain header files and standard libraries for the C and C++ languages, together</p>
<p>with a number of other low-level system libraries.</p>
<p><b>C and C++ Header File Directories</b></p>
<p>Depending upon the language you are compiling, the driver selects one or more of</p>
<p>the following directories for header files which are specified in</p>
<p>#include</p>
<p>preprocessor directives:</p>
<p>â¢</p>
<p><b>include/v800</b> â Contains header files for V850 and RH850 extensions for C</p>
<p>and C++.</p>
<p>â¢</p>
<p><b>ansi</b> â Contains Standard C library header files.</p>
<p>â¢</p>
<p><b>scxx</b> â Contains Standard C++ library header files.</p>
<p>â¢</p>
<p><b>eecxx</b> â Contains Extended Embedded C++ library header files.</p>
<p>â¢</p>
<p><b>ecxx</b> â Contains Embedded C++ library header files.</p>
<p><b>C and C++ Header Files</b></p>
<p>Some of the files in the<b> ansi</b> header file directory are for internal use only. These</p>
<p>internal header files should not be included in your code directly, because future</p>
<p>releases may eliminate, reorganize, or rename them. If you include any of them</p>
<p>directly, a fatal error explains which header file should be included in your code</p>
<p>instead:</p>
<p>Please include &lt;string.h&gt; instead of ghs_str.h</p>
<p>Please include &lt;string.h&gt; instead of ghs_mem.h</p>
<p>Please include &lt;stddef.h&gt; instead of ghs_null.h</p>
<p>Please include &lt;stdarg.h&gt; instead of ghs_valist.h</p>
<p>Please include &lt;stddef.h&gt; instead of ghs_wchar.h</p>
<p>In the header file directories for C++ (<b>scxx</b>,<b> eecxx</b>, and<b> ecxx</b>), files that begin with</p>
<p>x</p>
<p>or</p>
<p>y</p>
<p>are internal header files that should not be included in your code directly.</p>
<p><i>819</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The Green Hills Header Files and Standard Libraries</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Library Directories</b></p>
<p>Depending upon the target architecture that you specify and whether or not you are</p>
<p>using INTEGRITY, the driver selects one of the several directories (inside</p>
<p><i><b>install_dir</i>/lib</b>) for libraries to resolve references. Each directory contains a library</p>
<p>set optimized for use with a specific type of target CPU in the V850 and RH850</p>
<p>processor family.</p>
<p><b>Libraries</b></p>
<p>Each library directory contains a version of the libraries listed in this section, built</p>
<p>for the particular target architecture. Library names may contain one or more suffixes</p>
<p>that begin with an underscore (</p>
<p>_</p>
<p>), depending on the options you pass to the driver:</p>
<p>â¢</p>
<p>All C++ libraries have the suffix</p>
<p>_xvtbl</p>
<p>when<b> --large_vtbl_offsets</b> is used.</p>
<p>â¢</p>
<p>The Standard C++ library and</p>
<p>wchar_t</p>
<p>libraries have the suffix</p>
<p>_u16</p>
<p>or</p>
<p>_s32</p>
<p>depending on the setting of<b> -wchar_u16</b> or<b> -wchar_s32</b> (except on</p>
<p>INTEGRITY).</p>
<p>â¢</p>
<p>The Standard C++ library,<b> libmath</b>, and<b> libind</b> have a floating-point suffix</p>
<p>depending on the floating-point mode:</p>
<p>Hardware floating point</p>
<p>_fp</p>
<p><b>-fhard</b></p>
<p>Software floating point</p>
<p>_sf</p>
<p><b>-fsoft</b></p>
<p>Hardware single, software double</p>
<p>_sd</p>
<p><b>-fsingle</b></p>
<p>Hardware single used for all floating point types</p>
<p>_sngl</p>
<p><b>-floatsingle</b></p>
<p>C++ libraries are searched before the C libraries if there is a C++ source file on the</p>
<p>driver command line, if you use the C++ driver (<b>cxv850</b>), or if you specify</p>
<p><b>-language=cxx</b> (see also âSpecifying C++ Librariesâ on page 735). They are searched</p>
<p>in the following order:</p>
<p>â¢</p>
<p>One of the following C++ libraries is used, depending on selected options:</p>
<p>â</p>
<p><b>libscnoe</b> â Standard C++ Library without exceptions.</p>
<p>â</p>
<p><b>libsce</b> â Standard C++ Library with exceptions.</p>
<p>â</p>
<p><b>libeecnoe</b> â Extended embedded C++ Library without exceptions.</p>
<p>â</p>
<p><b>libeece</b> â Extended embedded C++ Library with exceptions.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>820</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â</p>
<p><b>libecnoe</b> â Embedded C++ Library without exceptions. This library is a</p>
<p>subset of<b> libeecnoe</b>.</p>
<p>â</p>
<p><b>libece</b> â Embedded C++ Library with exceptions.</p>
<p>â¢</p>
<p>One of the following run-time support libraries is used, depending on selected</p>
<p>options:</p>
<p>â</p>
<p><b>libsedgnoe</b> â Run-time support for standard C++, without exceptions.</p>
<p>â</p>
<p><b>libsedge</b> â Run-time support for standard C++, with exceptions.</p>
<p>â</p>
<p><b>libedgnoe</b> â Run-time support for embedded C++ and extended embedded</p>
<p>C++, without exceptions.</p>
<p>â</p>
<p><b>libedge</b> â Run-time support for embedded C++ and extended embedded</p>
<p>C++, with exceptions.</p>
<p>Standard C Libraries are searched in the following order (unless you pass the</p>
<p><b>-nostdlib</b> driver option):</p>
<p>â¢</p>
<p><b>libwchar</b>* â Standard C library functions that use</p>
<p>wchar_t</p>
<p>.</p>
<p>â¢</p>
<p><b>libnoflt</b> â Provides versions of</p>
<p>printf</p>
<p>,</p>
<p>scanf</p>
<p>, and other functions, which</p>
<p>exclude floating point support, and so are smaller than those in<b> libansi</b>. This</p>
<p>library is only used if the deprecated<b> -nofloatio</b> driver option is specified.</p>
<p>â¢</p>
<p><b>libfmalloc</b> â Provides versions of</p>
<p>malloc</p>
<p>,</p>
<p>realloc</p>
<p>, and</p>
<p>free</p>
<p>that are</p>
<p>optimized for small blocks. This library is searched before<b> libansi</b>, and is used</p>
<p>unless the<b> -no_fast_malloc</b> driver option is specified. For more information,</p>
<p>see âUse Small Block Mallocâ on page 150.</p>
<p>â¢</p>
<p><b>libdbmem</b> â Provides a version of</p>
<p>malloc</p>
<p>with memory-checking. This</p>
<p>library is selected when you pass either the<b> -check=alloc</b> or<b> -check=memory</b></p>
<p>driver options. This library is searched in place of<b> libfmalloc</b>.</p>
<p>â¢</p>
<p><b>libansi</b> â Standard C library. This is the primary C library.</p>
<p>â¢</p>
<p><b>libutf8</b>,<b> lib8bit</b>,<b> libwc</b>â Low-level C library functions that recognize</p>
<p>wchar_t</p>
<p>encodings. Only one of these libraries is used, depending on the value of the</p>
<p><b>-kanji=</b> option:</p>
<p>â</p>
<p><b>-kanji=utf8</b> â<b> libutf8</b></p>
<p>â</p>
<p><b>-kanji=none</b> â<b> lib8bit</b></p>
<p>â</p>
<p>otherwise â<b> libwc</b>*</p>
<p>This library is searched after<b> libansi</b>.</p>
<p><i>821</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Libraries</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>libmath</b> â Standard Math library. This library is searched after<b> libutf8</b>,<b> lib8bit</b>,</p>
<p>or<b> libwc</b>.</p>
<p>* On INTEGRITY,<b> libwchar</b> is contained in<b> libansi</b> and<b> libwc</b> is contained in</p>
<p><b>libind</b>.</p>
<p>Low-level System Libraries are searched in the following order (unless you pass</p>
<p>the<b> -nostdlib</b> driver option):</p>
<p>â¢</p>
<p><b>libind</b> â Language-independent library, containing support routines for features</p>
<p>such as software floating point, run-time error checking, C99 complex numbers,</p>
<p>and some general purpose routines of the ANSI C library.</p>
<p>â¢</p>
<p><b>libstartup</b> â Run-time environment startup routines. The source code for the</p>
<p>modules in this library is provided in the<b> src/libstartup</b> directory (see</p>
<p>âLow-Level Startup Library libstartup.aâ on page 867).</p>
<p>â¢</p>
<p><b>libsys</b> â Run-time environment system routines. The source code for the</p>
<p>modules in this library is provided in the<b> src/libsys</b> directory (see âLow-Level</p>
<p>System Library libsys.aâ on page 868).</p>
<p>â¢</p>
<p><b>libarch</b> â Target-specific run-time support. Any file produced by the Green</p>
<p>Hills Compiler may depend on symbols in this library.</p>
<p><b>Note</b></p>
<p>Some functions in low-level system libraries are for use only by the</p>
<p>compiler or linker, and may not follow standard calling conventions. The</p>
<p>compiler and linker take this into account when generating or modifying</p>
<p>calls to these functions.</p>
<p>Other Libraries:</p>
<p>â¢</p>
<p><b>libmulti</b> â Supports procedure calls from the MULTI Debugger command</p>
<p>line. This library is selected when you pass the<b> -G</b> driver option.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>822</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Advanced Library Topics</b></p>
<p><b>Less Buffered I/O</b></p>
<p>The Green Hills ANSI C library includes a<i> Standard I/O Package</i> (â<b>stdio</b>â), which</p>
<p>provides formatted I/O using</p>
<p>printf()</p>
<p>and</p>
<p>scanf</p>
<p>, character I/O using</p>
<p>getc()</p>
<p>and</p>
<p>putc()</p>
<p>, and other features.</p>
<p>If I/O is completely<i> unbuffered</i>, every character read or written requires a system</p>
<p>call. This unbuffered I/O is slow, but it ensures that I/O is not delayed until the</p>
<p>buffer is full or lost by being left in a buffer if the application exits abnormally.</p>
<p>As a consequence, in traditional implementations, most I/O performed in<b> stdio</b> is</p>
<p><i>fully buffered</i>. This improves performance by increasing the average number of</p>
<p>characters written per system call, but requires additional space for the code to</p>
<p>manage the buffers, as well as for the buffers themselves. Often, several kilobytes</p>
<p>of code are added to the application, because the<b> stdio</b> package invokes</p>
<p>malloc()</p>
<p>and other routines to manage the buffering.</p>
<p>In order to provide a reasonable compromise between fully buffered and unbuffered</p>
<p>I/O, the Green Hills C library defaults to a<i> less buffered I/O</i> mode. Rather than</p>
<p>allocate a buffer for each file via</p>
<p>malloc()</p>
<p>(which is used as long as the file is</p>
<p>open), buffering is performed within</p>
<p>fprintf()</p>
<p>,</p>
<p>fwrite()</p>
<p>,</p>
<p>fputs()</p>
<p>,</p>
<p>puts()</p>
<p>,</p>
<p>printf()</p>
<p>,</p>
<p>vprints()</p>
<p>,</p>
<p>vfprintf()</p>
<p>, and their wide character forms. Because</p>
<p>of this approach, none of the I/O functions call</p>
<p>malloc()</p>
<p>, possibly reducing the</p>
<p>size of the overall program by a few kilobytes.</p>
<p>During a single call, any characters written to one of these functions are buffered</p>
<p>in a buffer on the stack. One function call often requires only one output system</p>
<p>call. After the function completes, all characters are written to the file. No characters</p>
<p>are left in a buffer after the function call, eliminating both the risk of output loss</p>
<p>and the need to flush buffers when a file is closed or the program exits. No input</p>
<p>routines other than</p>
<p>fread()</p>
<p>are buffered by the less buffered I/O method. Files</p>
<p>are not closed upon program termination, except as noted below.</p>
<p>You can enable full buffering of any file by calling either</p>
<p>setbuf()</p>
<p>with a buffer</p>
<p>of at least</p>
<p>BUFSIZ</p>
<p>bytes or</p>
<p>setvbuf()</p>
<p>with a buffer of at least<i> n</i> bytes, where<i> n</i></p>
<p>is the fourth parameter to</p>
<p>setvbuf()</p>
<p>. For example:</p>
<p><i>823</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Advanced Library Topics</i></p>
<h1 style="page-break-before:always; "></h1>
<p>char buffer[BUFSIZ];</p>
<p>setbuf(f, buffer);</p>
<p>char buffer[8196];</p>
<p>setvbuf(f, buffer, _IOFBF, sizeof(buffer));</p>
<p>In this case, characters are only written to the file when the buffer is full or when</p>
<p>fflush()</p>
<p>or</p>
<p>fclose()</p>
<p>is called. Upon normal termination of the program, if</p>
<p>setbuf()</p>
<p>or</p>
<p>setvbuf()</p>
<p>has been called at any time, all open files will be flushed</p>
<p>and then closed.</p>
<p>You can enable line buffering by calling</p>
<p>setvbuf()</p>
<p>with</p>
<p>_IOLBF</p>
<p>as the third</p>
<p>parameter. Line buffering is the same as full buffering with the exception that</p>
<p>fflush()</p>
<p>is called at the end of</p>
<p>fputs()</p>
<p>and all forms of</p>
<p>printf()</p>
<p>. For example:</p>
<p>char buffer[256];</p>
<p>setvbuf(f, buffer, _IOLBF, sizeof(buffer));</p>
<p>If the second parameter to</p>
<p>setvbuf()</p>
<p>is</p>
<p>NULL</p>
<p>, all buffering is disabled and the</p>
<p>third and fourth parameters are ignored.</p>
<p>All files are processed in exactly the same manner, whether they are opened by</p>
<p>default (<b>stdin</b>,<b> stdout</b>, and<b> stderr</b>) or by</p>
<p>fopen()</p>
<p>.</p>
<p><b>Buffering of C++ I/O Streams</b></p>
<p>The C++ I/O streams are implemented on top of the C<b> stdio</b> files. When you use</p>
<p>C++ I/O streams, the constructors for these streams enable full buffering for files,</p>
<p>and line buffering for</p>
<p>stdout</p>
<p>and</p>
<p>stderr</p>
<p>.</p>
<p>To disable this buffering, call</p>
<p>pubsetbuf()</p>
<p>,</p>
<p>setbuf()</p>
<p>, or</p>
<p>setvbuf()</p>
<p>before</p>
<p>outputting anything onto either of the I/O streams. For example:</p>
<p>cout.rdbuf()-&gt;pubsetbuf(0, 0);</p>
<p>or</p>
<p>setbuf(stdout, NULL);</p>
<p>If you call one of these functions after outputting anything onto an I/O stream,</p>
<p>buffering will remain unchanged, in accordance with the C specification for</p>
<p>setvbuf()</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>824</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>64-bit Integer Arguments and printf</b></p>
<p>The type</p>
<p>long long</p>
<p>was an extension to ANSI C which has become official in</p>
<p>the ISO C99 standard. Since this type is larger than either</p>
<p>int</p>
<p>or</p>
<p>long</p>
<p>, it requires</p>
<p>special handling in the</p>
<p>printf</p>
<p>and</p>
<p>scanf</p>
<p>routines.</p>
<p>As in earlier versions of</p>
<p>printf</p>
<p>and</p>
<p>scanf</p>
<p>, a single '</p>
<p>l</p>
<p>'</p>
<p>modifier indicates an</p>
<p>argument of type</p>
<p>long</p>
<p>. For example:</p>
<p>printf(&quot;large number: %ld&quot;, 0x7fffffffL);</p>
<p>However, when the '</p>
<p>l</p>
<p>'</p>
<p>modifier is repeated, an argument of type</p>
<p>long long</p>
<p>is</p>
<p>indicated. For example:</p>
<p>printf(&quot;very large number: %lld&quot;, 0x7fffffffffffffffLL);</p>
<p>For backwards compatibility with older implementations,</p>
<p>printf</p>
<p>and</p>
<p>scanf</p>
<p>also</p>
<p>allow the '</p>
<p>L</p>
<p>'</p>
<p>modifier to indicate an argument of type</p>
<p>long long</p>
<p>, but this is</p>
<p>non-standard and is not recommended.</p>
<p><b>Memory Allocation and malloc()</b></p>
<p>malloc()</p>
<p>,</p>
<p>calloc()</p>
<p>,</p>
<p>free()</p>
<p>, and the C++</p>
<p>new</p>
<p>and</p>
<p>delete</p>
<p>operators are all</p>
<p>examples of dynamic memory allocation. Source code for the Green Hills</p>
<p>implementation of dynamic memory allocation is not provided. Allocation requests</p>
<p>are limited to</p>
<p>LONG_MAX - 127</p>
<p>bytes; larger requests may fail, even if there is</p>
<p>enough available memory.</p>
<p>Before debugging memory allocation issues, ensure that your implementation of</p>
<p><b>ind_heap.c</b> is appropriate for your system. Then, check that your code does not do</p>
<p>any of the following:</p>
<p>â¢</p>
<p>write before the beginning or after the end of a piece of dynamic memory</p>
<p>â¢</p>
<p>access memory that has been deallocated by calling</p>
<p>free()</p>
<p>or the C++</p>
<p>delete</p>
<p>operator</p>
<p>â¢</p>
<p>deallocate memory more than once</p>
<p>â¢</p>
<p>deallocate memory that was not dynamically allocated (global, static, or local</p>
<p>memory).</p>
<p><i>825</i></p>
<p><i>Green Hills Software</i></p>
<p><i>64-bit Integer Arguments and printf</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For help debugging dynamic memory allocation issues, see âEnabling Run-Time</p>
<p>Memory Checkingâ on page 71 and Chapter 5, âThe DoubleCheck Source Analysis</p>
<p>Toolâ on page 365.</p>
<p><b>Using Thread-Safe Library Functions</b></p>
<p>A<i> thread-safe</i> or<i> reentrant</i> function executes correctly in a multithreaded</p>
<p>environment, even if the function is called by multiple threads concurrently or if it</p>
<p>is interrupted or suspended and then resumed. A<i> thread</i> is a single task running in</p>
<p>a multitasking environment in which several tasks share the same memory space.</p>
<p>Some Green Hills library functions are not inherently thread-safe. The libraries</p>
<p>provide four mechanisms for an application to achieve thread-safe behavior. The</p>
<p>following sections describe the four mechanisms and, where necessary, explain</p>
<p>how to port them to a multithreaded environment.</p>
<p>â¢</p>
<p>âUsing a Lock to Ensure Critical Code Is Thread-Safeâ on page 827</p>
<p>â¢</p>
<p>âUsing File Locks to Ensure I/O Is Thread-Safeâ on page 828</p>
<p>â¢</p>
<p>âAllocating Space in Each Thread for Static Dataâ on page 829</p>
<p>â¢</p>
<p>âUsing Alternate Thread-Safe Library Functionsâ on page 831</p>
<p>In some cases, the library provides more than one way to achieve thread-safe</p>
<p>behavior. For example, you can make calls to</p>
<p>strtok()</p>
<p>thread-safe either by</p>
<p>allocating space in each thread for the static data it uses, or by changing the code</p>
<p>to use the inherently thread-safe</p>
<p>strtok_r()</p>
<p>function. The appropriate choice is</p>
<p>left up to you.</p>
<p>For applications that require maximum I/O performance, Green Hills provides</p>
<p>versions of some I/O library functions that are not thread-safe. These functions have</p>
<p>names ending in</p>
<p>_unlocked</p>
<p>, such as</p>
<p>putc_unlocked()</p>
<p>and</p>
<p>getc_unlocked()</p>
<p>.</p>
<p>Applications using these functions must guarantee that no two threads concurrently</p>
<p>access the same file.</p>
<p>Porting to a new multithreaded environment involves customizing the following</p>
<p>functions, located in<b> src/libsys/ind_lock.c</b>,<b> src/libsys/ind_errn.c</b>, and</p>
<p><b>src/libsys/ind_thrd.c</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>826</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>void __ghsLock(void);</p>
<p>Acquires global lock. Blocks until the lock becomes available.</p>
<p>void __ghsUnlock(void);</p>
<p>Releases global lock.</p>
<p>void __gh_lock_init(void);</p>
<p>Initializes the global lock data structure before it is used.</p>
<p>void __ghs_flock_file(void *<i>addr</i>);</p>
<p>Acquires per-file lock<i><b> addr</b></i>. Blocks until the lock becomes available.</p>
<p>void __ghs_funlock_file(void *<i>addr</i>);</p>
<p>Releases per-file lock<i><b> addr</b></i>.</p>
<p>int __ghs_ftrylock_file(void *<i>addr</i>);</p>
<p>Attempts to acquire per-file lock<i><b> addr</b></i>. Returns</p>
<p>0</p>
<p>on success and nonzero if the lock could not</p>
<p>be acquired. May return</p>
<p>-1</p>
<p>if this behavior cannot be implemented. This function must not</p>
<p>block.</p>
<p>void __ghs_flock_create(void **<i>addr</i>);</p>
<p>void __ghs_flock_destroy(void *<i>addr</i>);</p>
<p>Initializes and cleans up per-file lock data structure. The</p>
<p>__ghs_flock_create()</p>
<p>implementation may store a pointer in</p>
<p><i>addr</i></p>
<p>. That pointer is passed to the other per-file lock</p>
<p>calls.</p>
<p>void *__ghs_GetThreadLocalStorageItem(int<i> specifier</i>);</p>
<p>Retrieves pointer to specified per-thread data item. May return</p>
<p>NULL</p>
<p>if the data item is not</p>
<p>allocated for each thread.</p>
<p>For information about the default implementation of per-thread storage and locks</p>
<p>in Green Hills supported operating systems, see the appropriate RTOS User's Guide</p>
<p>(<i>INTEGRITY Libraries and Utilities User's Guide</i> or<i> u-velOSity User's Guide</i>).</p>
<p><b>Using a Lock to Ensure Critical Code Is Thread-Safe</b></p>
<p>Code that accesses resources such as global data structures, hardware devices, or</p>
<p>memory shared between two or more threads is<i> critical code</i>. These shared resources</p>
<p>may become corrupted when two or more threads write to the same data structures</p>
<p>simultaneously, or when one thread reads data while another thread is writing to</p>
<p>that same data.</p>
<p><i>827</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Using Thread-Safe Library Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>To make critical code thread-safe, you must implement a global, recursive lock</p>
<p>mechanism that allows a function to completely execute critical code before that</p>
<p>code is accessed by another thread. Green Hills library functions call</p>
<p>__ghsLock()</p>
<p>before critical code and</p>
<p>__ghsUnlock()</p>
<p>after critical code. The</p>
<p>__ghsLock()</p>
<p>function must acquire the global lock or block the calling thread if any other thread</p>
<p>has already acquired the global lock. The</p>
<p>__ghsUnlock()</p>
<p>function releases the</p>
<p>global lock. These functions operate recursively. If</p>
<p>__ghsLock()</p>
<p>is called<i> n</i> times,</p>
<p>the lock is released only after</p>
<p>__ghsUnlock()</p>
<p>is called<i> n</i> times.</p>
<p><b>Using File Locks to Ensure I/O Is Thread-Safe</b></p>
<p>You can also implement recursive locking for file I/O to ensure thread safety. If</p>
<p>multiple threads are performing I/O on the same file concurrently, the file may</p>
<p>become corrupted. This section discusses three possible implementations of file</p>
<p>locking, from the simplest to the most flexible.</p>
<p>The simplest file lock implementation uses the global lock by having</p>
<p>__ghs_flock_file()</p>
<p>call</p>
<p>__ghsLock()</p>
<p>and</p>
<p>__ghs_funlock_file()</p>
<p>call</p>
<p>__ghsUnlock()</p>
<p>. However, this implementation may cause slow performance if</p>
<p>one thread holds the global lock until it completes relatively slow I/O while other</p>
<p>threads are attempting to use library functions that contain critical sections.</p>
<p>Another file lock implementation choice is to use a separate global lock for I/O.</p>
<p>This avoids locking the entire library during I/O. However, performance concerns</p>
<p>could still arise if other threads are attempting to perform I/O and must wait for the</p>
<p>single global I/O lock.</p>
<p>The most flexible file lock implementation choice is to create a separate lock for</p>
<p>each file. To implement a lock for each file, have</p>
<p>__ghs_flock_create()</p>
<p>initialize a lock, and use the argument to store a pointer to the lock data structure.</p>
<p>The</p>
<p>__ghs_flock_file()</p>
<p>and</p>
<p>__ghs_funlock_file()</p>
<p>functions have the</p>
<p>pointer passed to them, so they can locate the specific lock for each file. Finally,</p>
<p>the</p>
<p>__ghs_flock_destroy()</p>
<p>function should clean up and deallocate the lock.</p>
<p><b>C++ Stream Locking</b></p>
<p>On INTEGRITY, u-velOSity, and stand-alone configurations that have provided</p>
<p>their own definition of</p>
<p>__ghsLock()</p>
<p>, the</p>
<p>std::basic_streambuf</p>
<p>class</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>828</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>implements locking by acquiring the C library lock with</p>
<p>__ghsLock()</p>
<p>. Because</p>
<p>the C library lock must always be the last lock acquired, you must not acquire</p>
<p>additional locks while</p>
<p>std::basic_streambuf</p>
<p>is locked; otherwise, deadlock</p>
<p>may occur. This also applies to classes that are derived from</p>
<p>std::basic_streambuf</p>
<p>but that do not override the</p>
<p>_Lock()</p>
<p>and</p>
<p>_Unlock()</p>
<p>members (for example,</p>
<p>std::basic_stringbuf</p>
<p>).</p>
<p>Therefore, if your program acquires additional locks while</p>
<p>std::basic_streambuf</p>
<p>is locked (for example, during stream operations), you</p>
<p>must instead use (and provide) your own subclass of</p>
<p>std::basic_streambuf</p>
<p>that overrides its</p>
<p>_Lock()</p>
<p>and</p>
<p>_Unlock()</p>
<p>members so that they use a different</p>
<p>lock.</p>
<p><b>Allocating Space in Each Thread for Static Data</b></p>
<p>This section describes how you can make certain library functions thread-safe by</p>
<p>allocating separate copies of the data structures they use in each thread. The data</p>
<p>structures are then referred to as<i> per-thread data</i> or<i> thread local storage</i>.</p>
<p>The additional space needed to make all such library functions completely thread-safe</p>
<p>is several hundred bytes per thread. Therefore, the decision of which, if any, of</p>
<p>these data structures are allocated for each thread is left to the implementation. In</p>
<p>many cases, a more practical solution would be to use alternate library functions</p>
<p>that are thread-safe. For more information, see âUsing Alternate Thread-Safe Library</p>
<p>Functionsâ on page 831.</p>
<p>An implementation could allow some library functions to operate on global data.</p>
<p>It could either restrict all such function calls to a single thread or allow the</p>
<p>application to synchronize access by using a mutual exclusion mechanism around</p>
<p>the function call and the use of the return value. For example, if two threads wanted</p>
<p>to call</p>
<p>asctime()</p>
<p>, the function call and the use of the return value could be</p>
<p>protected by first calling</p>
<p>__ghsLock()</p>
<p>and afterwards calling</p>
<p>__ghsUnlock()</p>
<p>.</p>
<p>The function</p>
<p>__ghs_GetThreadLocalStorageItem()</p>
<p>in<b> src/libsys/ind_thrd.c</b></p>
<p>returns a pointer to the specified per-thread data item, or</p>
<p>NULL</p>
<p>. Returning</p>
<p>NULL</p>
<p>causes the library to use a single, global data item. The default implementation for</p>
<p>stand-alone programs returns</p>
<p>NULL</p>
<p>for all but one such request.</p>
<p><i>829</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Using Thread-Safe Library Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If you implement a per-thread</p>
<p>errno</p>
<p>in</p>
<p>__ghs_GetThreadLocalStorageItem()</p>
<p>,</p>
<p>you must define the preprocessor symbol</p>
<p>USE_THREAD_LOCAL_ERRNO</p>
<p>in</p>
<p><b>src/libsys/ind_errn.c</b>.</p>
<p>The data item pointers</p>
<p>__ghs_GetThreadLocalStorageItem()</p>
<p>can return are</p>
<p>as follows:</p>
<p><b>Example Data Item Declaration</b></p>
<p><b>Specifier (Value)</b></p>
<p>char asctime_buff[30]</p>
<p>__ghs_TLS_asctime_buff</p>
<p>(</p>
<p>0</p>
<p>)</p>
<p>char tmpnam_space[L_tmpnam]</p>
<p>__ghs_TLS_tmpnam_space</p>
<p>(</p>
<p>1</p>
<p>)</p>
<p>char *strtok_saved_pos</p>
<p>__ghs_TLS_strtok_saved_pos</p>
<p>(</p>
<p>2</p>
<p>)</p>
<p>int errno</p>
<p>__ghs_TLS_Errno</p>
<p>(</p>
<p>3</p>
<p>)</p>
<p>struct tm gmtime_temp</p>
<p>__ghs_TLS_gmtime_temp</p>
<p>(</p>
<p>4</p>
<p>)</p>
<p>void *__eh_globals</p>
<p>__ghs_TLS___eh_globals</p>
<p>(</p>
<p>5</p>
<p>)</p>
<p>SignalHandler</p>
<p>SignalHandlers[_SIGMAX]</p>
<p>__ghs_TLS_SignalHandlers</p>
<p>(</p>
<p>6</p>
<p>)</p>
<p>Upgrading Earlier GetThreadLocalStorage() Implementations</p>
<p>In versions of MULTI prior to 4.2.3, the function</p>
<p>GetThreadLocalStorage()</p>
<p>,</p>
<p>declared in<b> ind_thrd.h</b>, was used to retrieve thread-specific or global library data</p>
<p>structures. If you previously customized</p>
<p>GetThreadLocalStorage()</p>
<p>for your</p>
<p>environment, the simplest way to upgrade is to add the following implementation</p>
<p>of</p>
<p>__ghs_GetThreadLocalStorageItem()</p>
<p>.</p>
<p>enum __ghs_ThreadLocalStorage_specifier</p>
<p>{</p>
<p>__ghs_TLS_asctime_buff,</p>
<p>__ghs_TLS_tmpnam_space,</p>
<p>__ghs_TLS_strtok_saved_pos,</p>
<p>__ghs_TLS_Errno,</p>
<p>__ghs_TLS_gmtime_temp,</p>
<p>__ghs_TLS___eh_globals,</p>
<p>__ghs_TLS_SignalHandlers</p>
<p>};</p>
<p>void *__ghs_GetThreadLocalStorageItem(int specifier)</p>
<p>{</p>
<p>ThreadLocalStorage *tls = GetThreadLocalStorage();</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>830</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>if(!tls)</p>
<p>return (void *)0;</p>
<p>switch (specifier)</p>
<p>{</p>
<p>case (int)__ghs_TLS_Errno:</p>
<p>return (void *)&amp;tls-&gt;Errno;</p>
<p>case (int)__ghs_TLS_SignalHandlers</p>
<p>return (void *)&amp;tls-&gt;SignalHandlers;</p>
<p>case (int)__ghs_TLS_asctime_buff:</p>
<p>return (void *)&amp;tls-&gt;asctime_buff;</p>
<p>case (int)__ghs_TLS_tmpnam_space:</p>
<p>return (void *)&amp;tls-&gt;tmpnam_space;</p>
<p>case (int)__ghs_TLS_strtok_saved_pos:</p>
<p>return (void *)&amp;tls-&gt;strtok_saved_pos;</p>
<p>case (int)__ghs_TLS_gmtime_temp:</p>
<p>return (void *)&amp;tls-&gt;gmtime_temp;</p>
<p>case (int)__ghs_TLS___eh_globals:</p>
<p>return (void *)&amp;tls-&gt;__eh_globals;</p>
<p>}</p>
<p>return (void *)0;</p>
<p>}</p>
<p><b>Using Alternate Thread-Safe Library Functions</b></p>
<p>Green Hills provides alternatives for some library functions that are not inherently</p>
<p>thread-safe. These alternate, thread-safe functions have names ending in</p>
<p>_r</p>
<p>, such</p>
<p>as</p>
<p>asctime_r()</p>
<p>and</p>
<p>rand_r()</p>
<p>. For example, you can use</p>
<p>rand_r()</p>
<p>to replace</p>
<p>calls to</p>
<p>srand()</p>
<p>and</p>
<p>rand()</p>
<p>.</p>
<p><b>Customizing Thread-Safe Library Functions</b></p>
<p>Green Hills provides source code for some low-level functions in the<b> src/libsys</b> and</p>
<p><b>src/libstartup</b> directories, so you can customize them for your particular</p>
<p>environment. When modified, these functions must remain thread-safe so that</p>
<p>functions in the Green Hills libraries that call them also remain thread-safe. For a</p>
<p>list of these functions, see the following section.</p>
<p><i>831</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Customizing Thread-Safe Library Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Green Hills Standard C Library Functions</b></p>
<p>The functions documented in the ISO C99 Standard are contained in the libraries</p>
<p>listed in âLibrariesâ on page 820. You can find lists of these functions, as well as</p>
<p>thread-safety information, in the following sections:</p>
<p>â¢</p>
<p>âStandard C Functions in libansi.aâ on page 833</p>
<p>â¢</p>
<p>âWide Character Functionsâ on page 847</p>
<p>â¢</p>
<p>âlibmath.a Functionsâ on page 848</p>
<p>â¢</p>
<p>âlibind.a Functionsâ on page 861</p>
<p>â¢</p>
<p>âlibstartup.a Functionsâ on page 861</p>
<p>Some standard function names are converted into special names by the linker based</p>
<p>on options. For more information, see âStandard Function Names Converted by the</p>
<p>Linkerâ on page 861.</p>
<p>The following code letters identify the level of thread-safety of the library functions</p>
<p>listed in the remainder of this chapter.</p>
<p><b>Thread Safety</b></p>
<p><b>Code</b></p>
<p>Safe to call from all INTEGRITY contexts, and completely thread-safe.</p>
<p>K</p>
<p>Safe to call from all INTEGRITY contexts, except when using floating-point arguments.</p>
<p>Completely thread-safe.</p>
<p>K*</p>
<p>Completely thread-safe.</p>
<p>Y</p>
<p>Partially thread-safe. You must implement a lock for complete thread safety.</p>
<p>P</p>
<p>Performs I/O or modifies I/O data structures. This is a special case of a partially</p>
<p>thread-safe function.</p>
<p>I</p>
<p>Achieves thread safety by per-thread storage, so long as per-thread storage is</p>
<p>implemented. See the preceding discussion on âAllocating Space in Each Thread for</p>
<p>Static Dataâ on page 829</p>
<p>T</p>
<p>Writes to the global variable</p>
<p>errno</p>
<p>. Achieves thread safety by per-thread storage of</p>
<p>errno</p>
<p>.</p>
<p>E</p>
<p>Not thread-safe.</p>
<p>N</p>
<p><b>Note</b></p>
<p>Under INTEGRITY, all functions marked with a</p>
<p>Y</p>
<p>,</p>
<p>P</p>
<p>,</p>
<p>I</p>
<p>,</p>
<p>T</p>
<p>, or</p>
<p>E</p>
<p>are</p>
<p>completely thread-safe. These functions are safe to call from within a</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>832</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Task, however, they may not be safe to call from an interrupt context</p>
<p>unless they are also marked with a</p>
<p>K</p>
<p>.</p>
<p>Under u-velOSity, the thread-safety of functions marked with a</p>
<p>P</p>
<p>,</p>
<p>I</p>
<p>,</p>
<p>T</p>
<p>,</p>
<p>or</p>
<p>E</p>
<p>depends on the kernel libraries you are using. Please refer to the</p>
<p><i>u-velOSity User's Guide</i> for more information.</p>
<p><b>Standard C Functions in libansi.a</b></p>
<p>This section lists functions available in<b> libwchar_s32.a</b>,<b> libwchar_u16.a</b>,<b> libansi.a</b>,</p>
<p>and the low-level functions in<b> libsys.a</b> on which these standard functions depend.</p>
<p>The information is laid out in two tables:</p>
<p>â¢</p>
<p>âlibansi.a Standard C Functions and Dependenciesâ on page 833</p>
<p>â¢</p>
<p>âlibsys.a Function Implementationâ on page 846</p>
<p>Depending on the operating system you are running on your target, and whether or</p>
<p>not you are connecting to your target through a MULTI debug server, you may</p>
<p>need to implement environment-specific behavior for the low-level functions in</p>
<p><b>libsys.a</b>. The<b> libsys.a</b> function implementation table describes how the Green Hills</p>
<p>tools implement these functions by default.</p>
<p><b>libansi.a Standard C Functions and Dependencies</b></p>
<p>This table lists functions in<b> libansi.a</b>. The low-level functions in<b> libsys.a</b> on which</p>
<p>each standard function depends are listed in the<b> Dependency</b> column. For</p>
<p>information about whether or not you need to implement environment-specific</p>
<p>behavior for a<b> libsys.a</b> function, see âlibsys.a Function Implementationâ on page 846</p>
<p>and âLow-Level System Library libsys.aâ on page 868.</p>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>raise()</p>
<p>abort(void);</p>
<p>void</p>
<p>K</p>
<p>abs(int x);</p>
<p>int</p>
<p>T</p>
<p>__gh_timezone()</p>
<p>*asctime(const struct tm *timeptr);</p>
<p>char</p>
<p>Y</p>
<p>__gh_timezone()</p>
<p>*asctime_r(const struct tm *timeptr,</p>
<p>char *buffer);</p>
<p>char</p>
<p><i>833</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Standard C Functions in libansi.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>IE</p>
<p>raise() write()</p>
<p>_assert(const char *problem, const</p>
<p>char *filename, int line);</p>
<p>int</p>
<p>IE</p>
<p>raise() write()</p>
<p>assert(int value);</p>
<p>void</p>
<p>P</p>
<p>atexit(void (*func)(void));</p>
<p>int</p>
<p>E</p>
<p>atoi(const char *nptr);</p>
<p>int</p>
<p>E</p>
<p>atol(const char *nptr);</p>
<p>long</p>
<p>E</p>
<p>atoll(const char *nptr);</p>
<p>long</p>
<p>long</p>
<p>K</p>
<p>bcmp(const void *b1, const void *b2,</p>
<p>size_t length);</p>
<p>int</p>
<p>K</p>
<p>bcopy(const void *from, void *to,</p>
<p>size_t n);</p>
<p>void</p>
<p>K</p>
<p>*bsearch(const void *key, const void</p>
<p>*base, size_t nmemb, size_t size, int</p>
<p>(*compar)(const void *, const void</p>
<p>*));</p>
<p>void</p>
<p>Y</p>
<p>btowc(int c);</p>
<p>wint_t</p>
<p>K</p>
<p>bzero(void *pt, size_t n);</p>
<p>void</p>
<p>P</p>
<p>sbrk()</p>
<p>*calloc(size_t nmemb, size_t size);</p>
<p>void</p>
<p>P</p>
<p>sbrk()</p>
<p>cfree(void *item);</p>
<p>void</p>
<p>I</p>
<p>clearerr(FILE *stream);</p>
<p>void</p>
<p>Y</p>
<p>times()</p>
<p>clock(void);</p>
<p>clock_t</p>
<p>T</p>
<p>__gh_timezone()</p>
<p>localtime()</p>
<p>*ctime(const time_t *timer);</p>
<p>char</p>
<p>Y</p>
<p>__gh_timezone()</p>
<p>localtime()</p>
<p>*ctime_r(const time_t *timer, char</p>
<p>*buffer);</p>
<p>char</p>
<p>K</p>
<p>div(int numer, int denom);</p>
<p>div_t</p>
<p>IE</p>
<p>write()</p>
<p>eprintf(const char *format, ...);</p>
<p>This function is deprecated and will be removed</p>
<p>in a future release.</p>
<p>int</p>
<p>P</p>
<p>_Exit()</p>
<p>exit(int status);</p>
<p>void</p>
<p>IE</p>
<p>close() write()</p>
<p>fclose(FILE *stream);</p>
<p>int</p>
<p>IE</p>
<p>write() close()</p>
<p>*fdopen(int fno, const char *mode);</p>
<p>FILE</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>834</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>feof(FILE *stream);</p>
<p>int</p>
<p>Y</p>
<p>ferror(FILE *stream);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>fflush(FILE *stream);</p>
<p>int</p>
<p>K</p>
<p>ffs(int i);</p>
<p>int</p>
<p>IE</p>
<p>read()</p>
<p>fgetc(FILE *stream);</p>
<p>int</p>
<p>IE</p>
<p>lseek()</p>
<p>fgetpos(FILE *restrict stream, fpos_t</p>
<p>*restrict pos);</p>
<p>int</p>
<p>IE</p>
<p>read()</p>
<p>*fgets(char *restrict str, int n,</p>
<p>FILE *restrict stream);</p>
<p>char</p>
<p>IE</p>
<p>read()</p>
<p>fgetwc(FILE *stream);</p>
<p>wint_t</p>
<p>NE</p>
<p>read()</p>
<p>fgetwc_unlocked(FILE *stream);</p>
<p>wint_t</p>
<p>IE</p>
<p>read()</p>
<p>*fgetws(wchar_t *restrict s, int n,</p>
<p>FILE *restrict stream);</p>
<p>wchar_t</p>
<p>IE</p>
<p>read()</p>
<p>_filbuf(FILE *file);</p>
<p>int</p>
<p>Y</p>
<p>fileno(FILE *stream)</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>_flsbuf(int ch, FILE *file);</p>
<p>int</p>
<p>IE</p>
<p>close() open() write()</p>
<p>*fopen(const char *restrict filename,</p>
<p>const char *restrict mode);</p>
<p>FILE</p>
<p>IE</p>
<p>write()</p>
<p>fprintf(FILE *restrict stream, const</p>
<p>char *restrict format, ...);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>fputc(int c, FILE *stream);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>fputs(const char *restrict s, FILE</p>
<p>*restrict stream);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>fputwc(wchar_t c, FILE *stream);</p>
<p>wint_t</p>
<p>NE</p>
<p>write()</p>
<p>fputwc_unlocked(wchar_t c, FILE</p>
<p>*stream);</p>
<p>wint_t</p>
<p>IE</p>
<p>write()</p>
<p>fputws(const wchar_t restrict *s,</p>
<p>FILE *restrict stream);</p>
<p>int</p>
<p>IE</p>
<p>read()</p>
<p>fread(void restrict *ptr, size_t</p>
<p>size, size_t nmemb, FILE *restrict</p>
<p>stream);</p>
<p>size_t</p>
<p>P</p>
<p>sbrk()</p>
<p>free(void *ptr);</p>
<p>void</p>
<p><i>835</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Standard C Functions in libansi.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>IE</p>
<p>close() open() write()</p>
<p>*freopen(const char *restrict</p>
<p>filename, const char *restrict mode,</p>
<p>FILE *restrict stream);</p>
<p>FILE</p>
<p>IE</p>
<p>close() lseek() read()</p>
<p>sbrk() write()</p>
<p>fscanf(FILE *restrict stream, const</p>
<p>char *restrict format, ...);</p>
<p>int</p>
<p>IE</p>
<p>lseek() write()</p>
<p>fseek(FILE *stream, long offset, int</p>
<p>whence);</p>
<p>int</p>
<p>IE</p>
<p>lseek() write()</p>
<p>fseeko(FILE *stream, off_t offset,</p>
<p>int whence);</p>
<p>int</p>
<p>IE</p>
<p>lseek() write()</p>
<p>fsetpos(FILE *stream, const fpos_t</p>
<p>*pos);</p>
<p>int</p>
<p>IE</p>
<p>lseek()</p>
<p>ftell(FILE *stream);</p>
<p>long</p>
<p>IE</p>
<p>lseek()</p>
<p>ftello(FILE *stream);</p>
<p>off_t</p>
<p>N</p>
<p>fwide(FILE *stream, int mode);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>fwprintf(FILE *restrict stream, const</p>
<p>wchar_t *restrict format, ...);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>fwrite(const void *restrict ptr,</p>
<p>size_t size, size_t nmemb, FILE</p>
<p>*stream);</p>
<p>size_t</p>
<p>IE</p>
<p>fwscanf(FILE *restrict stream, const</p>
<p>wchar_t *restrict format, ...);</p>
<p>int</p>
<p>IE</p>
<p>read()</p>
<p>getc(FILE *stream);</p>
<p>int</p>
<p>NE</p>
<p>read()</p>
<p>getc_unlocked(FILE *stream);</p>
<p>int</p>
<p>IE</p>
<p>read()</p>
<p>getchar(void);</p>
<p>int</p>
<p>NE</p>
<p>read()</p>
<p>getchar_unlocked(void);</p>
<p>int</p>
<p>P</p>
<p>environ</p>
<p>*getenv(const char *name);</p>
<p>char</p>
<p>IE</p>
<p>read()</p>
<p>*gets(char *s);</p>
<p>char</p>
<p>IE</p>
<p>read()</p>
<p>getw(FILE *stream);</p>
<p>This function is deprecated and will be removed</p>
<p>in a future release.</p>
<p>int</p>
<p>IE</p>
<p>read()</p>
<p>getwchar(void);</p>
<p>wint_t</p>
<p>Y</p>
<p>imaxabs(intmax_t);</p>
<p>intmax_t</p>
<p>Y</p>
<p>imaxdiv(intmax_t, intmax_t);</p>
<p>imaxdiv_t</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>836</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>K</p>
<p>*index(const char *str, int ch);</p>
<p>char</p>
<p>K</p>
<p>isalnum(int c);</p>
<p>int</p>
<p>K</p>
<p>isalpha(int c);</p>
<p>int</p>
<p>K</p>
<p>isblank(int c);</p>
<p>int</p>
<p>K</p>
<p>iscntrl(int c);</p>
<p>int</p>
<p>K</p>
<p>isdigit(int c);</p>
<p>int</p>
<p>K</p>
<p>isgraph(int c);</p>
<p>int</p>
<p>K</p>
<p>islower(int c);</p>
<p>int</p>
<p>K</p>
<p>isprint(int c);</p>
<p>int</p>
<p>K</p>
<p>ispunct(int c);</p>
<p>int</p>
<p>K</p>
<p>isspace(int c);</p>
<p>int</p>
<p>K</p>
<p>isupper(int c);</p>
<p>int</p>
<p>K</p>
<p>iswalnum(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswalpha(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswblank(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswcntrl(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswctype(wint_t wc, wctype_t desc);</p>
<p>int</p>
<p>K</p>
<p>iswdigit(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswgraph(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswlower(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswprint(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswpunct(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswspace(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswupper(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>iswxdigit(wint_t wc);</p>
<p>int</p>
<p>K</p>
<p>isxdigit(int c);</p>
<p>int</p>
<p>K</p>
<p>labs(long j);</p>
<p>long</p>
<p>K</p>
<p>ldiv(long numer, long denom);</p>
<p>ldiv_t</p>
<p>K</p>
<p>llabs(long long j);</p>
<p>long</p>
<p>long</p>
<p><i>837</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Standard C Functions in libansi.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>K</p>
<p>lldiv(long long numer, long long</p>
<p>denom);</p>
<p>lldiv_t</p>
<p>Y</p>
<p>*localeconv(void);</p>
<p>struct</p>
<p>lconv</p>
<p>P</p>
<p>sbrk()</p>
<p>*malloc(size_t size);</p>
<p>void</p>
<p>Y</p>
<p>mblen(const char *s, size_t n);</p>
<p>int</p>
<p>E</p>
<p>mbrlen(const char *restrict s, size_t</p>
<p>n, mbstate_t *restrict ps);</p>
<p>size_t</p>
<p>E</p>
<p>mbrtowc(wchar_t *restrict pwc, const</p>
<p>char *restrict s, size_t n, mbstate_t</p>
<p>*restrict ps);</p>
<p>size_t</p>
<p>Y</p>
<p>mbsinit(const mbstate_t *ps);</p>
<p>int</p>
<p>Y</p>
<p>mbsrtowcs(wchar_t *restrict dst,</p>
<p>const char **restrict src, size_t</p>
<p>len, mbstate_t *restrict ps);</p>
<p>size_t</p>
<p>Y</p>
<p>mbstowcs( wchar_t *restrict pwcs,</p>
<p>const char *restrict s, size_t n);</p>
<p>size_t</p>
<p>K</p>
<p>*memchr(const void *s, int c, size_t</p>
<p>n);</p>
<p>void</p>
<p>K</p>
<p>memcmp(const void *s1, const void</p>
<p>*s2, size_t n);</p>
<p>int</p>
<p>K</p>
<p>*memrchr(const void *s, int c, size_t</p>
<p>n);</p>
<p>void</p>
<p>P</p>
<p>getpid()</p>
<p>*mktemp(char *str);</p>
<p>char</p>
<p>Y</p>
<p>__gh_timezone()</p>
<p>localtime()</p>
<p>localtime_r()</p>
<p>mktime(struct tm *timeptr);</p>
<p>time_t</p>
<p>IE</p>
<p>write()</p>
<p>perror(const char *s);</p>
<p>void</p>
<p>IE</p>
<p>lseek() write()</p>
<p>printf(const char restrict *format,</p>
<p>...);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>putc(int c, FILE *stream);</p>
<p>int</p>
<p>NE</p>
<p>write()</p>
<p>putc_unlocked(int c, FILE *stream);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>putchar(int c);</p>
<p>int</p>
<p>NE</p>
<p>write()</p>
<p>putchar_unlocked(int c);</p>
<p>int</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>838</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>PE</p>
<p>putenv(const char *c);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>puts(const char *s);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>putw(int w, FILE *stream);</p>
<p>This function is deprecated and will be removed</p>
<p>in a future release.</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>putwc(wchar_t wc, FILE *stream);</p>
<p>wint_t</p>
<p>IE</p>
<p>write()</p>
<p>putwchar(wchar_t wc);</p>
<p>wint_t</p>
<p>K</p>
<p>qsort(void *base, size_t nmemb,</p>
<p>size_t size, int (*compar)(const void</p>
<p>*, const void *));</p>
<p>void</p>
<p>P</p>
<p>rand(void);</p>
<p>int</p>
<p>K</p>
<p>rand_r(unsigned int seedSent[1]);</p>
<p>int</p>
<p>K</p>
<p>rand_r2(long seed[2])</p>
<p>int</p>
<p>P</p>
<p>sbrk()</p>
<p>*realloc(void *ptr, size_t size);</p>
<p>void</p>
<p>Y</p>
<p>unlink()</p>
<p>remove(const char *filename);</p>
<p>int</p>
<p>IE</p>
<p>lseek() write()</p>
<p>rewind(FILE *stream);</p>
<p>void</p>
<p>K</p>
<p>*rindex(const char *str, int ch);</p>
<p>char</p>
<p>IE</p>
<p>close() read() sbrk()</p>
<p>write()</p>
<p>scanf(const char *restrict format,</p>
<p>...);</p>
<p>int</p>
<p>IE</p>
<p>close() write()</p>
<p>setbuf(FILE *restrict stream, char</p>
<p>*restrict buf);</p>
<p>void</p>
<p>PE</p>
<p>setenv(const char *envname, const</p>
<p>char *envval, int overwrite);</p>
<p>int</p>
<p>N</p>
<p>setlinebuf(FILE *stream);</p>
<p>int</p>
<p>Y</p>
<p>*setlocale(int category, const char</p>
<p>*locale);</p>
<p>char</p>
<p>IE</p>
<p>close() write()</p>
<p>setvbuf(FILE *restrict stream, char</p>
<p>*restrict buf, int mode, size_t</p>
<p>size);</p>
<p>int</p>
<p>K*</p>
<p>snprintf(char *restrict s, size_t n,</p>
<p>const char *restrict format, ...);</p>
<p>int</p>
<p>K*</p>
<p>sprintf(char * restrict s, const char</p>
<p>*restrict format, ...);</p>
<p>int</p>
<p><i>839</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Standard C Functions in libansi.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>N</p>
<p>srand(unsigned int seed);</p>
<p>void</p>
<p>K*</p>
<p>sscanf(const char *restrict s, const</p>
<p>char *restrict format, ...);</p>
<p>int</p>
<p>K</p>
<p>strcasecmp(const char *s1, const char</p>
<p>*s2);</p>
<p>Ignore the difference between uppercase and</p>
<p>lowercase</p>
<p>int</p>
<p>K</p>
<p>*strcat(char *restrict s1, const char</p>
<p>*restrict s2);</p>
<p>char</p>
<p>K</p>
<p>*strchr(const char *s, int c);</p>
<p>char</p>
<p>K</p>
<p>strcmp(const char *s1, const char</p>
<p>*s2);</p>
<p>int</p>
<p>K</p>
<p>strcoll(const char *s1, const char</p>
<p>*s2);</p>
<p>int</p>
<p>K</p>
<p>*strcpy(char *restrict s1, const char</p>
<p>*restrict s2);</p>
<p>char</p>
<p>K</p>
<p>strcspn(const char *s1, const char</p>
<p>*s2);</p>
<p>size_t</p>
<p>P</p>
<p>*strdup(const char *s);</p>
<p>char</p>
<p>K</p>
<p>*strerror(int errnum);</p>
<p>char</p>
<p>Y</p>
<p>__gh_timezone()</p>
<p>strftime(char *restrict s, size_t</p>
<p>maxsize, const char *restrict format,</p>
<p>const struct tm *restrict timeptr);</p>
<p>size_t</p>
<p>K</p>
<p>strlen(const char *s);</p>
<p>size_t</p>
<p>K</p>
<p>strncasecmp(const char *s1, const</p>
<p>char *s2, size_t n);</p>
<p>Ignore the difference between uppercase and</p>
<p>lowercase</p>
<p>int</p>
<p>K</p>
<p>*strncat(char *restrict s1, const</p>
<p>char *restrict s2, size_t n);</p>
<p>char</p>
<p>K</p>
<p>strncmp(const char *s1, const char</p>
<p>*s2, size_t n);</p>
<p>int</p>
<p>K</p>
<p>*strncpy(char *restrict s1, const</p>
<p>char *restrict s2, size_t n);</p>
<p>char</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>840</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>P</p>
<p>sbrk()</p>
<p>*strndup(const char *s, size_t n);</p>
<p>char</p>
<p>K</p>
<p>strnlen(const char *s, size_t n);</p>
<p>size_t</p>
<p>K</p>
<p>*strpbrk(const char *s1, const char</p>
<p>*s2);</p>
<p>char</p>
<p>K</p>
<p>*strrchr(const char *s, int c);</p>
<p>char</p>
<p>P</p>
<p>sbrk()</p>
<p>*strsave(char *str);</p>
<p>char</p>
<p>K</p>
<p>strspn(const char *s1, const char</p>
<p>*s2);</p>
<p>size_t</p>
<p>K</p>
<p>*strstr(const char *s1, const char</p>
<p>*s2);</p>
<p>char</p>
<p>E</p>
<p>strtoimax(const char * restrict nptr,</p>
<p>char **restrict endptr int base);</p>
<p>intmax_t</p>
<p>T</p>
<p>*strtok(char *restrict s1, const char</p>
<p>*restrict s2);</p>
<p>char</p>
<p>K</p>
<p>*strtok_r(char *s1, const char *s2,</p>
<p>char **ppLast);</p>
<p>char</p>
<p>E</p>
<p>strtoll(const char * restrict nptr,</p>
<p>char **restrict endptr, int base);</p>
<p>long</p>
<p>long</p>
<p>E</p>
<p>strtol(const char *restrict nptr,</p>
<p>char **restrict endptr, int base);</p>
<p>long</p>
<p>E</p>
<p>strtoul(const char *restrict nptr,</p>
<p>char **restrict endptr, int base);</p>
<p>unsigned</p>
<p>long</p>
<p>E</p>
<p>strtoull(const char * restrict nptr,</p>
<p>char **restrict endptr, int base);</p>
<p>unsigned</p>
<p>long</p>
<p>long</p>
<p>E</p>
<p>strtoumax(const char * restrict nptr,</p>
<p>char **restrict endptr, int base);</p>
<p>uintmax_t</p>
<p>K</p>
<p>strxfrm(char *restrict s1, const char</p>
<p>*restrict s2, size_t n);</p>
<p>size_t</p>
<p>K</p>
<p>swab(char *from, char *to, int</p>
<p>nbytes);</p>
<p>void</p>
<p>Y</p>
<p>swprintf(wchar_t *restrict s, size_t</p>
<p>n, const wchar_t *restrict format,</p>
<p>...);</p>
<p>int</p>
<p><i>841</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Standard C Functions in libansi.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>swscanf(const wchar_t *restrict s,</p>
<p>const wchar_t *restrict format, ...);</p>
<p>int</p>
<p>IE</p>
<p>close() open() unlink()</p>
<p>write()</p>
<p>*tmpfile(void);</p>
<p>FILE</p>
<p>TPE</p>
<p>access()</p>
<p>*tmpnam(char *s);</p>
<p>char</p>
<p>PE</p>
<p>access()</p>
<p>*tmpnam_r(char *s);</p>
<p>char</p>
<p>K</p>
<p>tolower(int c);</p>
<p>int</p>
<p>K</p>
<p>toupper(int c);</p>
<p>int</p>
<p>Y</p>
<p>towctrans(wint_t wc, wctrans_t desc);</p>
<p>wint_t</p>
<p>Y</p>
<p>towlower(wint_t wc);</p>
<p>wint_t</p>
<p>Y</p>
<p>towupper(wint_t wc);</p>
<p>wint_t</p>
<p>IE</p>
<p>close() sbrk() write()</p>
<p>ungetc(int c, FILE *stream);</p>
<p>int</p>
<p>IE</p>
<p>close() sbrk() write()</p>
<p>ungetwc(wint_t wc, FILE *stream);</p>
<p>wint_t</p>
<p>NE</p>
<p>close() sbrk() write()</p>
<p>ungetwc_unlocked(wint_t wc, FILE</p>
<p>*stream);</p>
<p>wint_t</p>
<p>P</p>
<p>unsetenv(const char* envname);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>vfprintf(FILE *restrict stream, const</p>
<p>char *restrict format, va_list arg);</p>
<p>int</p>
<p>IE</p>
<p>close() read() sbrk()</p>
<p>write()</p>
<p>vfscanf(FILE *restrict stream, const</p>
<p>char *restrict format, va_list arg);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>vfwprintf(FILE *restrict stream,</p>
<p>const wchar_t *restrict format,</p>
<p>va_list arg);</p>
<p>int</p>
<p>IE</p>
<p>close() read() sbrk()</p>
<p>write()</p>
<p>vfwscanf(FILE *restrict stream, const</p>
<p>wchar_t *restrict format, va_list</p>
<p>arg);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>vprintf(const char *restrict format,</p>
<p>va_list arg);</p>
<p>int</p>
<p>IE</p>
<p>close() read() sbrk()</p>
<p>write()</p>
<p>vscanf(const char *restrict format,</p>
<p>va_list arg);</p>
<p>int</p>
<p>K*</p>
<p>vsnprintf(char *restrict s, size_t</p>
<p>n, const char *restrict format,</p>
<p>va_list arg);</p>
<p>int</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>842</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>K*</p>
<p>vsprintf(char *restrict s, const char</p>
<p>*restrict format, va_list arg);</p>
<p>int</p>
<p>K*</p>
<p>vsscanf(const char *restrict s, const</p>
<p>char *restrict format, va_list arg);</p>
<p>int</p>
<p>Y</p>
<p>vswprintf(wchar_t *restrict s,</p>
<p>size_t, const wchar_t *restrict</p>
<p>format, va_list arg);</p>
<p>int</p>
<p>P</p>
<p>vswscanf(const wchar_t *restrict s,</p>
<p>const wchar_t *restrict format,</p>
<p>va_list arg);</p>
<p>int</p>
<p>IE</p>
<p>write()</p>
<p>vwprintf(const wchar_t *restrict</p>
<p>format, va_list arg);</p>
<p>int</p>
<p>IE</p>
<p>close() read() sbrk()</p>
<p>write()</p>
<p>vwscanf(const wchar_t *restrict</p>
<p>format, va_list arg);</p>
<p>int</p>
<p>Y</p>
<p>wcrtomb(char *restrict s, wchar_t wc,</p>
<p>mbstate_t *restrict ps);</p>
<p>size_t</p>
<p>Y</p>
<p>*wcscat(wchar_t *restrict s1, const</p>
<p>wchar_t *restrict s2);</p>
<p>wchar_t</p>
<p>Y</p>
<p>*wcschr(const wchar_t *s, wchar_t</p>
<p>wc);</p>
<p>wchar_t</p>
<p>Y</p>
<p>wcscmp(const wchar_t *s1, const</p>
<p>wchar_t *s2);</p>
<p>int</p>
<p>Y</p>
<p>wcscoll(const wchar_t *s1, const</p>
<p>wchar_t *s2);</p>
<p>int</p>
<p>Y</p>
<p>*wcscpy(wchar_t *restrict s1, const</p>
<p>wchar_t *restrict s2);</p>
<p>wchar_t</p>
<p>Y</p>
<p>wcscspn(const wchar_t *s1, const</p>
<p>wchar_t *s2);</p>
<p>size_t</p>
<p>Y</p>
<p>__gh_timezone()</p>
<p>wcsftime(wchar_t *restrict s, size_t</p>
<p>maxsize, const wchar_t *restrict</p>
<p>format, const struct tm *restrict</p>
<p>timeptr);</p>
<p>size_t</p>
<p>Y</p>
<p>wcslen(const wchar_t *s);</p>
<p>size_t</p>
<p>Y</p>
<p>*wcsncat(wchar_t *restrict s1, const</p>
<p>wchar_t *restrict s2, size_t n);</p>
<p>wchar_t</p>
<p><i>843</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Standard C Functions in libansi.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>wcsncmp(const wchar_t *restrict s1,</p>
<p>const wchar_t *restrict s2, size_t</p>
<p>n);</p>
<p>int</p>
<p>Y</p>
<p>*wcsncpy(wchar_t *restrict s1, const</p>
<p>wchar_t *restrict s2, size_t n);</p>
<p>wchar_t</p>
<p>Y</p>
<p>*wcspbrk(const wchar_t *s1, const</p>
<p>wchar_t *s2);</p>
<p>wchar_t</p>
<p>Y</p>
<p>*wcsrchr(const wchar_t *s, wchar_t</p>
<p>wc);</p>
<p>wchar_t</p>
<p>Y</p>
<p>wcsrtombs(char *restrict dst, const</p>
<p>wchar_t **restrict src, size_t len,</p>
<p>mbstate_t *restrict ps);</p>
<p>size_t</p>
<p>Y</p>
<p>wcsspn(const wchar_t *s1, const</p>
<p>wchar_t *s2);</p>
<p>size_t</p>
<p>Y</p>
<p>*wcsstr(const wchar_t *s1, const</p>
<p>wchar_t *s2);</p>
<p>wchar_t</p>
<p>Y</p>
<p>wcstoimax(const wchar_t *restrict</p>
<p>nptr, wchar_t **restrict endptr, int</p>
<p>base);</p>
<p>intmax_t</p>
<p>Y</p>
<p>*wcstok(wchar_t *restrict s1, const</p>
<p>wchar_t *restrict s2, wchar_t</p>
<p>**restrict ptr);</p>
<p>wchar_t</p>
<p>Y</p>
<p>wcstol(const wchar_t *restrict nptr,</p>
<p>wchar_t **restrict endptr, int base);</p>
<p>long</p>
<p>Y</p>
<p>wcstoll(const wchar_t *restrict nptr,</p>
<p>wchar_t **restrict endptr, int base);</p>
<p>long</p>
<p>long</p>
<p>Y</p>
<p>wcstombs(char * restrict s, const</p>
<p>wchar_t *restrict pwcs, size_t n);</p>
<p>size_t</p>
<p>Y</p>
<p>wcstoul(const wchar_t *restrict nptr,</p>
<p>wchar_t **restrict endptr, int base);</p>
<p>unsigned</p>
<p>long</p>
<p>Y</p>
<p>wcstoull(const wchar_t *restrict</p>
<p>nptr, wchar_t **restrict endptr, int</p>
<p>base);</p>
<p>unsigned</p>
<p>long</p>
<p>long</p>
<p>Y</p>
<p>wcstoumax(const wchar_t *restrict</p>
<p>nptr, wchar_t **restrict endptr, int</p>
<p>base);</p>
<p>uintmax_t</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>844</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Dependency</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>wcsxfrm(wchar_t *restrict s1, const</p>
<p>wchar_t *restrict s2, size_t n);</p>
<p>size_t</p>
<p>Y</p>
<p>wctob(wint_t wc);</p>
<p>int</p>
<p>Y</p>
<p>wctrans(const char *property);</p>
<p>wctrans_t</p>
<p>Y</p>
<p>wctype(const char *property);</p>
<p>wctype_t</p>
<p>Y</p>
<p>*wmemchr(const wchar_t *s, wchar_t</p>
<p>wc, size_t n);</p>
<p>wchar_t</p>
<p>Y</p>
<p>wmemcmp(wchar_t *restrict s1, const</p>
<p>wchar_t *restrict s2, size_t n);</p>
<p>int</p>
<p>Y</p>
<p>*wmemcpy(wchar_t *restrict s1, const</p>
<p>wchar_t *restrict s2, size_t n);</p>
<p>wchar_t</p>
<p>Y</p>
<p>*wmemmove(wchar_t *s1, const wchar_t</p>
<p>*s2, size_t n);</p>
<p>wchar_t</p>
<p>Y</p>
<p>*wmemset(wchar_t *s, wchar_t c,</p>
<p>size_t n);</p>
<p>wchar_t</p>
<p>IE</p>
<p>write()</p>
<p>wprintf(const wchar_t *restrict</p>
<p>format, ...);</p>
<p>int</p>
<p>IE</p>
<p>close() read() sbrk()</p>
<p>write()</p>
<p>wscanf(const wchar_t *restrict</p>
<p>format, ...);</p>
<p>int</p>
<p><b>Note</b></p>
<p>Memory allocated in</p>
<p>putenv()</p>
<p>is never freed.</p>
<p>unsetenv()</p>
<p>does not</p>
<p>free any memory when it removes an entry from the environment.</p>
<p><i>845</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Standard C Functions in libansi.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>libsys.a Function Implementation</b></p>
<p>This table lists the<b> libsys.a</b> low-level functions on which some<b> libansi.a</b> functions</p>
<p>depend, and how the Green Hills tools implement each low-level function by default.</p>
<p>If the default behavior is not adequate for your environment, you might need to</p>
<p>re-implement the function.</p>
<p>Functions that Green Hills libraries implement as MULTI system calls communicate</p>
<p>with your host machine. It is unlikely that you will need to change these functions</p>
<p>when you connect to your target through MULTI. If you intend to continue using</p>
<p>these functions without connecting to your target through MULTI, such as in a final</p>
<p>product, you must re-implement these functions to suit your needs.</p>
<p><b>Implementation</b></p>
<p><b>Module</b></p>
<p><b>Function</b></p>
<p>MULTI system call</p>
<p><b>ind_stat.c</b></p>
<p>access()</p>
<p>MULTI system call</p>
<p><b>ind_io.c</b></p>
<p>close()</p>
<p>MULTI system call</p>
<p><b>ind_io.c</b></p>
<p>creat()</p>
<p>MULTI system call</p>
<p><b>ind_exit.c</b></p>
<p>_Exit()</p>
<p>Returns</p>
<p>17</p>
<p><b>ind_gpid.c</b></p>
<p>getpid()</p>
<p>8 hours West of UTC/GMT</p>
<p><b>ind_tmzn.c</b></p>
<p>__gh_timezone()</p>
<p>US daylight savings rules</p>
<p><b>ind_tmzn.c</b></p>
<p>localtime()</p>
<p>US daylight savings rules</p>
<p><b>ind_tmzn.c</b></p>
<p>localtime_r()</p>
<p>MULTI system call</p>
<p><b>ind_io.c</b></p>
<p>lseek()</p>
<p>MULTI system call</p>
<p><b>ind_io.c</b></p>
<p>open()</p>
<p>ISO C99 compliant</p>
<p><b>ind_sgnl.c</b></p>
<p>raise()</p>
<p>MULTI system call</p>
<p><b>ind_io.c</b></p>
<p>read()</p>
<p>Allocates from</p>
<p>.heap</p>
<p><b>ind_heap.c</b></p>
<p>sbrk()</p>
<p>MULTI system call</p>
<p><b>ind_time.c</b></p>
<p>time()</p>
<p>MULTI system call</p>
<p><b>ind_io.c</b></p>
<p>unlink()</p>
<p>MULTI system call</p>
<p><b>ind_io.c</b></p>
<p>write()</p>
<p>You may also need to change</p>
<p>char **environ</p>
<p>, an object in<b> ind_crt1.c</b> that is</p>
<p>implemented using MULTI argument passing by default.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>846</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Wide Character Functions</b></p>
<p>The following pair of functions depend on the character encoding selected at link</p>
<p>time (see âHost and Target Character Encodingâ on page 219 and âKanji Character</p>
<p>Supportâ on page 700). Separate implementations are found in the libraries</p>
<p><b>libutf8_s32.a</b>,<b> libutf8_u16.a</b>,<b> lib8bit_s32.a</b>,<b> lib8bit_u16.a</b>,<b> libwc_s32.a</b>, and</p>
<p><b>libwc_u16.a</b>.</p>
<p><b>Thread</b></p>
<p><b>Safety</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>mbtowc(wchar_t * restrict pwc, const char</p>
<p>*restrict s, size_t n);</p>
<p>int</p>
<p>Y</p>
<p>wctomb(char *s, wchar_t wchar);</p>
<p>int</p>
<p><i>847</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Wide Character Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>libmath.a Functions</b></p>
<p>The following tables list functions in<b> libmath.a</b>, and are organized by the header</p>
<p>file in which they are declared.</p>
<p><b>Functions from math.h in libmath.a</b></p>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>__fpclassifyd(double x);</p>
<p>int</p>
<p>Y</p>
<p>__fpclassifyf(float x);</p>
<p>int</p>
<p>Y</p>
<p>__fpclassifyl(long double x);</p>
<p>int</p>
<p>Y</p>
<p>__isfinited(double x);</p>
<p>int</p>
<p>Y</p>
<p>__isfinitef(float x);</p>
<p>int</p>
<p>Y</p>
<p>__isfinitel(long double x);</p>
<p>int</p>
<p>Y</p>
<p>__isinfd(double x);</p>
<p>int</p>
<p>Y</p>
<p>__isinff(float x);</p>
<p>int</p>
<p>Y</p>
<p>__isinfl(long double x);</p>
<p>int</p>
<p>Y</p>
<p>__isnand(double x);</p>
<p>int</p>
<p>Y</p>
<p>__isnanf(float x);</p>
<p>int</p>
<p>Y</p>
<p>__isnanl(long double x);</p>
<p>int</p>
<p>Y</p>
<p>__isnormald(double x);</p>
<p>int</p>
<p>Y</p>
<p>__isnormalf(float x);</p>
<p>int</p>
<p>Y</p>
<p>__isnormall(long double x);</p>
<p>int</p>
<p>Y</p>
<p>__signbitd(double x);</p>
<p>int</p>
<p>Y</p>
<p>__signbitf(float x);</p>
<p>int</p>
<p>Y</p>
<p>__signbitl(long double x);</p>
<p>int</p>
<p>E</p>
<p>acos(double x);</p>
<p>double</p>
<p>E</p>
<p>acosf(float x);</p>
<p>float</p>
<p>E</p>
<p>acosl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>acosh(double x);</p>
<p>double</p>
<p>E</p>
<p>acoshf(float x);</p>
<p>float</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>848</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>E</p>
<p>acoshl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>asin(double x);</p>
<p>double</p>
<p>E</p>
<p>asinf(float x);</p>
<p>float</p>
<p>E</p>
<p>asinl(long double x);</p>
<p>long double</p>
<p>Y</p>
<p>asinh(double x);</p>
<p>double</p>
<p>Y</p>
<p>asinhf(float x);</p>
<p>float</p>
<p>Y</p>
<p>asinhl(long double x);</p>
<p>long double</p>
<p>Y</p>
<p>atan(double x);</p>
<p>double</p>
<p>Y</p>
<p>atanf(float x);</p>
<p>float</p>
<p>Y</p>
<p>atanl(long double x);</p>
<p>long double</p>
<p>Y</p>
<p>atan2(double y, double x);</p>
<p>double</p>
<p>Y</p>
<p>atan2f(float y, float x);</p>
<p>float</p>
<p>Y</p>
<p>atan2l(long double y, long double x);</p>
<p>long double</p>
<p>E</p>
<p>atanh(double x);</p>
<p>double</p>
<p>E</p>
<p>atanhf(float x);</p>
<p>float</p>
<p>E</p>
<p>atanhl(long double x);</p>
<p>long double</p>
<p>Y</p>
<p>cbrt(double x);</p>
<p>double</p>
<p>Y</p>
<p>cbrtf(float x);</p>
<p>float</p>
<p>Y</p>
<p>cbrtl(long double x);</p>
<p>long double</p>
<p>Y</p>
<p>ceil(double x);</p>
<p>double</p>
<p>Y</p>
<p>ceilf(float x);</p>
<p>float</p>
<p>Y</p>
<p>ceill(long double x);</p>
<p>long double</p>
<p>Y</p>
<p>copysign(double x, double y);</p>
<p>double</p>
<p>Y</p>
<p>copysignf(float x, float y);</p>
<p>float</p>
<p>Y</p>
<p>copysignl(long double x, long double y);</p>
<p>long double</p>
<p>Y</p>
<p>cos(double x);</p>
<p>double</p>
<p>Y</p>
<p>cosf(float x);</p>
<p>float</p>
<p>Y</p>
<p>cosl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>cosh(double x);</p>
<p>double</p>
<p><i>849</i></p>
<p><i>Green Hills Software</i></p>
<p><i>libmath.a Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>E</p>
<p>coshf(float x);</p>
<p>float</p>
<p>E</p>
<p>coshl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>erf(double x);</p>
<p>double</p>
<p>E</p>
<p>erff(float x);</p>
<p>float</p>
<p>E</p>
<p>erfl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>erfc(double x);</p>
<p>double</p>
<p>E</p>
<p>erfcf(float x);</p>
<p>float</p>
<p>E</p>
<p>erfcl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>exp(double x);</p>
<p>double</p>
<p>E</p>
<p>expf(float x);</p>
<p>float</p>
<p>E</p>
<p>expl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>exp2(double x);</p>
<p>double</p>
<p>E</p>
<p>exp2f(float x);</p>
<p>float</p>
<p>E</p>
<p>exp2l(long double x);</p>
<p>long double</p>
<p>E</p>
<p>expm1(double x);</p>
<p>double</p>
<p>E</p>
<p>expm1f(float x);</p>
<p>float</p>
<p>E</p>
<p>expm1l(long double x);</p>
<p>long double</p>
<p>Y</p>
<p>fabs(double x);</p>
<p>double</p>
<p>Y</p>
<p>fabsf(float x);</p>
<p>float</p>
<p>Y</p>
<p>fabsl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>fdim(double x, double y);</p>
<p>double</p>
<p>E</p>
<p>fdimf(float x, float y);</p>
<p>float</p>
<p>E</p>
<p>fdiml(long double x, long double y);</p>
<p>long double</p>
<p>Y</p>
<p>floor(double x);</p>
<p>double</p>
<p>Y</p>
<p>floorf(float x);</p>
<p>float</p>
<p>Y</p>
<p>floorl(long double x);</p>
<p>long double</p>
<p>Y</p>
<p>fma(double x, double y, double z);</p>
<p>double</p>
<p>Y</p>
<p>fmaf(float x, float y, float z);</p>
<p>float</p>
<p>Y</p>
<p>fmal(long double x, long double y, long double</p>
<p>z);</p>
<p>long double</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>850</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>fmax(double x, double y);</p>
<p>double</p>
<p>Y</p>
<p>fmaxf(float x, float y);</p>
<p>float</p>
<p>Y</p>
<p>fmaxl(long double x, long double y);</p>
<p>long double</p>
<p>Y</p>
<p>fmin(double x, double y);</p>
<p>double</p>
<p>Y</p>
<p>fminf(float x, float y);</p>
<p>float</p>
<p>Y</p>
<p>fminl(long double x, long double y);</p>
<p>long double</p>
<p>E</p>
<p>fmod(double x, double y);</p>
<p>double</p>
<p>E</p>
<p>fmodf(float x, float y);</p>
<p>float</p>
<p>E</p>
<p>fmodl(long double x, long double y);</p>
<p>long double</p>
<p>Y</p>
<p>frexp(double value, int *exp);</p>
<p>double</p>
<p>Y</p>
<p>frexpf(float value, int *exp);</p>
<p>float</p>
<p>Y</p>
<p>frexpl(long double value, int *exp);</p>
<p>long double</p>
<p>E</p>
<p>gamma(double x);</p>
<p>double</p>
<p>E</p>
<p>hypot(double x, double y);</p>
<p>double</p>
<p>E</p>
<p>hypotf(float x, float y);</p>
<p>float</p>
<p>E</p>
<p>hypotl(long double x, long double y);</p>
<p>long double</p>
<p>Y</p>
<p>ilogb(double x);</p>
<p>int</p>
<p>Y</p>
<p>ilogbf(float x);</p>
<p>int</p>
<p>Y</p>
<p>ilogbl(long double x);</p>
<p>int</p>
<p>Y</p>
<p>isfinite(double x);</p>
<p>int</p>
<p>Y</p>
<p>isinf(double x);</p>
<p>int</p>
<p>Y</p>
<p>isnan(double x);</p>
<p>int</p>
<p>Y</p>
<p>isnormal(double x);</p>
<p>int</p>
<p>Y</p>
<p>j0(double x);</p>
<p>double</p>
<p>Y</p>
<p>j1(double x);</p>
<p>double</p>
<p>Y</p>
<p>jn(int n, double x);</p>
<p>double</p>
<p>E</p>
<p>ldexp(double x, int exp);</p>
<p>double</p>
<p>E</p>
<p>ldexpf(float x, int exp);</p>
<p>float</p>
<p>E</p>
<p>ldexpl(long double x, int exp);</p>
<p>long double</p>
<p><i>851</i></p>
<p><i>Green Hills Software</i></p>
<p><i>libmath.a Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>E</p>
<p>lgamma(double x);</p>
<p>double</p>
<p>E</p>
<p>lgammaf(float x);</p>
<p>float</p>
<p>E</p>
<p>lgammal(long double x);</p>
<p>long double</p>
<p>E</p>
<p>log(double x);</p>
<p>double</p>
<p>E</p>
<p>logf(float x);</p>
<p>float</p>
<p>E</p>
<p>logl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>log10(double x);</p>
<p>double</p>
<p>E</p>
<p>log10f(float x);</p>
<p>float</p>
<p>E</p>
<p>log10l(long double x);</p>
<p>long double</p>
<p>E</p>
<p>log1p(double x);</p>
<p>double</p>
<p>E</p>
<p>log1pf(float x);</p>
<p>float</p>
<p>E</p>
<p>log1pl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>log2(double x);</p>
<p>double</p>
<p>E</p>
<p>log2f(float x);</p>
<p>float</p>
<p>E</p>
<p>log2l(long double x);</p>
<p>long double</p>
<p>E</p>
<p>logb(double x);</p>
<p>double</p>
<p>E</p>
<p>logbf(float x);</p>
<p>float</p>
<p>E</p>
<p>logbl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>lrint(double x);</p>
<p>long</p>
<p>E</p>
<p>lrintf(float x);</p>
<p>long</p>
<p>E</p>
<p>lrintl(long double x);</p>
<p>long</p>
<p>E</p>
<p>llrint(double x);</p>
<p>long long</p>
<p>E</p>
<p>llrintf(float x);</p>
<p>long long</p>
<p>E</p>
<p>llrintl(long double x);</p>
<p>long long</p>
<p>E</p>
<p>lround(double x);</p>
<p>long</p>
<p>E</p>
<p>lroundf(float x);</p>
<p>long</p>
<p>E</p>
<p>lroundl(long double x);</p>
<p>long</p>
<p>E</p>
<p>llround(double x);</p>
<p>long long</p>
<p>E</p>
<p>llroundf(float x);</p>
<p>long long</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>852</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>E</p>
<p>llroundl(long double x);</p>
<p>long long</p>
<p>Y</p>
<p>modf(double value, double *iptr);</p>
<p>double</p>
<p>Y</p>
<p>modff(float value, float *iptr);</p>
<p>float</p>
<p>Y</p>
<p>modfl(long double value, long double *iptr);</p>
<p>long double</p>
<p>Y</p>
<p>nan(const char *tagp);</p>
<p>double</p>
<p>Y</p>
<p>nanf(const char *tagp);</p>
<p>float</p>
<p>Y</p>
<p>nanl(const char *tagp);</p>
<p>long double</p>
<p>Y</p>
<p>nearbyint(double x);</p>
<p>double</p>
<p>Y</p>
<p>nearbyintf(float x);</p>
<p>float</p>
<p>Y</p>
<p>nearbyintl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>nextafter(double x, double y);</p>
<p>double</p>
<p>E</p>
<p>nextafterf(float x, float y);</p>
<p>float</p>
<p>E</p>
<p>nextafterl(long double x, long double y);</p>
<p>long double</p>
<p>E</p>
<p>nexttoward(double x, long double y);</p>
<p>double</p>
<p>E</p>
<p>nexttowardf(float x, long double y);</p>
<p>float</p>
<p>E</p>
<p>nexttowardl(long double x, long double y);</p>
<p>long double</p>
<p>E</p>
<p>pow(double x, double y);</p>
<p>double</p>
<p>E</p>
<p>powf(float x, float y);</p>
<p>float</p>
<p>E</p>
<p>powl(long double x, long double y);</p>
<p>long double</p>
<p>E</p>
<p>remainder(double x, double y);</p>
<p>double</p>
<p>E</p>
<p>remainderf(float x, float y);</p>
<p>float</p>
<p>E</p>
<p>remainderl(long double x, long double y);</p>
<p>long double</p>
<p>E</p>
<p>remquo(double x, double y, int *quo);</p>
<p>double</p>
<p>E</p>
<p>remquof(float x, float y, int *quo);</p>
<p>float</p>
<p>E</p>
<p>remquol(long double x, long double y,int *quo);</p>
<p>long double</p>
<p>Y</p>
<p>rint(double x);</p>
<p>double</p>
<p>Y</p>
<p>rintf(float x);</p>
<p>float</p>
<p>Y</p>
<p>rintl(long double x);</p>
<p>long double</p>
<p>Y</p>
<p>round(double x);</p>
<p>double</p>
<p><i>853</i></p>
<p><i>Green Hills Software</i></p>
<p><i>libmath.a Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>roundf(float x);</p>
<p>float</p>
<p>Y</p>
<p>roundl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>scalbn(double x, int n);</p>
<p>double</p>
<p>E</p>
<p>scalbnf(float x, int n);</p>
<p>float</p>
<p>E</p>
<p>scalbnl(long double x, int n);</p>
<p>long double</p>
<p>E</p>
<p>scalbln(double x, long int n);</p>
<p>double</p>
<p>E</p>
<p>scalblnf(float x, long int n);</p>
<p>float</p>
<p>E</p>
<p>scalblnl(long double x, long int n);</p>
<p>long double</p>
<p>Y</p>
<p>signbit(double);</p>
<p>int</p>
<p>Y</p>
<p>sin(double x);</p>
<p>double</p>
<p>Y</p>
<p>sinf(float x);</p>
<p>float</p>
<p>Y</p>
<p>sinl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>sinh(double x);</p>
<p>double</p>
<p>E</p>
<p>sinhf(float x);</p>
<p>float</p>
<p>E</p>
<p>sinhl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>sqrt(double x);</p>
<p>double</p>
<p>E</p>
<p>sqrtf(float x);</p>
<p>float</p>
<p>E</p>
<p>sqrtl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>tan(double x);</p>
<p>double</p>
<p>E</p>
<p>tanf(float x);</p>
<p>float</p>
<p>E</p>
<p>tanl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>tanh(double x);</p>
<p>double</p>
<p>E</p>
<p>tanhf(float x);</p>
<p>float</p>
<p>E</p>
<p>tanhl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>tgamma(double x);</p>
<p>double</p>
<p>E</p>
<p>tgammaf(float x);</p>
<p>float</p>
<p>E</p>
<p>tgammal(long double x);</p>
<p>long double</p>
<p>Y</p>
<p>trunc(double x);</p>
<p>double</p>
<p>Y</p>
<p>truncf(float x);</p>
<p>float</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>854</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>truncl(long double x);</p>
<p>long double</p>
<p>E</p>
<p>y0(double x);</p>
<p>double</p>
<p>E</p>
<p>y1(double x);</p>
<p>double</p>
<p>E</p>
<p>yn(int n, double x);</p>
<p>double</p>
<p><b>Functions from fenv.h in libmath.a</b></p>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>feclearexcept(int excepts);</p>
<p>int</p>
<p>Y</p>
<p>fegetenv(fenv_t *envp);</p>
<p>int</p>
<p>Y</p>
<p>fegetexceptflag(fexcept_t *flagp, int excepts);</p>
<p>int</p>
<p>Y</p>
<p>fegetround(void);</p>
<p>int</p>
<p>Y</p>
<p>feholdexcept(fenv_t *envp);</p>
<p>int</p>
<p>Y</p>
<p>feraiseexcept(int excepts);</p>
<p>int</p>
<p>Y</p>
<p>fesetenv(const fenv_t *envp);</p>
<p>int</p>
<p>Y</p>
<p>fesetexceptflag(const fexcept_t *flagp, int</p>
<p>excepts);</p>
<p>int</p>
<p>Y</p>
<p>fesetround(int round);</p>
<p>int</p>
<p>Y</p>
<p>fetestexcept(int excepts);</p>
<p>int</p>
<p>Y</p>
<p>feupdateenv(const fenv_t *envp);</p>
<p>int</p>
<p><b>Functions from complex.h in libmath.a</b></p>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>E</p>
<p>cabs(double complex z);</p>
<p>double</p>
<p>E</p>
<p>cabsf(float complex z);</p>
<p>float</p>
<p>E</p>
<p>cabsl(long double complex z);</p>
<p>long double</p>
<p>E</p>
<p>cacos(double complex z);</p>
<p>double</p>
<p>complex</p>
<p><i>855</i></p>
<p><i>Green Hills Software</i></p>
<p><i>libmath.a Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>E</p>
<p>cacosf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>cacosl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>cacosh(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>cacoshf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>cacoshl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>casin(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>casinf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>casinl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>casinh(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>casinhf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>casinhl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>carg(double complex z);</p>
<p>double</p>
<p>E</p>
<p>cargf(float complex z);</p>
<p>float</p>
<p>E</p>
<p>cargl(long double complex z);</p>
<p>long double</p>
<p>E</p>
<p>catan(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>catanf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>catanl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>catanh(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>catanhf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>catanhl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>ccos(double complex z);</p>
<p>double</p>
<p>complex</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>856</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>E</p>
<p>ccosf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>ccosl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>ccosh(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>ccoshf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>ccoshl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>cexp(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>cexpf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>cexpl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>cimag(double complex z);</p>
<p>double</p>
<p>E</p>
<p>cimagf(float complex z);</p>
<p>float</p>
<p>E</p>
<p>cimagl(long double complex z);</p>
<p>long double</p>
<p>E</p>
<p>clog(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>clogf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>clogl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>conj(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>conjf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>conjl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>cpow(double complex x, double complex y);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>cpowf(float complex x, float complex y);</p>
<p>float complex</p>
<p>E</p>
<p>cpowl(long double complex x, long double complex</p>
<p>y);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>cproj(double complex z);</p>
<p>double</p>
<p>complex</p>
<p><i>857</i></p>
<p><i>Green Hills Software</i></p>
<p><i>libmath.a Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>E</p>
<p>cprojf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>cprojl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>creal(double complex z);</p>
<p>double</p>
<p>E</p>
<p>crealf(float complex z);</p>
<p>float</p>
<p>E</p>
<p>creall(long double complex z);</p>
<p>long double</p>
<p>E</p>
<p>csin(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>csinf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>csinl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>csinh(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>csinhf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>csinhl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>csqrt(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>csqrtf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>csqrtl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>ctan(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>ctanf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>ctanl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p>E</p>
<p>ctanh(double complex z);</p>
<p>double</p>
<p>complex</p>
<p>E</p>
<p>ctanhf(float complex z);</p>
<p>float complex</p>
<p>E</p>
<p>ctanhl(long double complex z);</p>
<p>long double</p>
<p>complex</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>858</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Functions from stdlib.h in libmath.a</b></p>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>E</p>
<p>atof(const char *nptr);</p>
<p>double</p>
<p>E</p>
<p>strtod(const char *restrict nptr, char **restrict</p>
<p>endptr);</p>
<p>double</p>
<p>E</p>
<p>strtof(const char *restrict nptr, char **restrict</p>
<p>endptr);</p>
<p>float</p>
<p>E</p>
<p>strtold(const char *restrict nptr, char</p>
<p>**restrict endptr);</p>
<p>long double</p>
<p><b>Functions from wchar.h in libmath.a</b></p>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>E</p>
<p>wcstod(const wchar_t *restrict nptr, wchar_t</p>
<p>**restrict endptr);</p>
<p>double</p>
<p>E</p>
<p>wcstold(const wchar_t *restrict nptr, wchar_t</p>
<p>**restrict endptr);</p>
<p>long double</p>
<p>wcstof(const wchar_t *restrict nptr, wchar_t</p>
<p>**restrict endptr);</p>
<p>float</p>
<p>Additional information about wide character functions is provided in âWide</p>
<p>Character Functionsâ on page 847.</p>
<p><b>Functions from setjmp.h in libmath.a</b></p>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>longjmp(jmp_buf env, int val);</p>
<p>void</p>
<p>Y</p>
<p>setjmp(jmp_buf env);</p>
<p>int</p>
<p><i>859</i></p>
<p><i>Green Hills Software</i></p>
<p><i>libmath.a Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Functions from time.h in libmath.a</b></p>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>difftime(time_t time1, time_t time0);</p>
<p>double</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>860</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>libind.a Functions</b></p>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>Y</p>
<p>_rnerr(int num, int linenum, char *str, void</p>
<p>*ptr, void **trace, int depth, size_t len);</p>
<p>void</p>
<p>Y</p>
<p>_rnerr2(int num, int linenum, char *str);</p>
<p>void</p>
<p>K</p>
<p>*memmove(void *s1, const void *s2, size_t n);</p>
<p>void</p>
<p><b>Note</b></p>
<p>The functions</p>
<p>_rnerr()</p>
<p>and</p>
<p>_rnerr2()</p>
<p>are used in run-time error</p>
<p>checking. For more information about run-time error checking, see</p>
<p>âRun-Time Error Checksâ on page 178.</p>
<p><b>libstartup.a Functions</b></p>
<p>The following table lists the standard C library functions in<b> libstartup.a</b>.</p>
<p><b>Thread</b></p>
<p><b>safety</b></p>
<p><b>Function</b></p>
<p>YK</p>
<p>*memcpy(void * restrict d, const void * restrict</p>
<p>s, size_t n);</p>
<p>void</p>
<p>YK</p>
<p>*memset(void *s, int c, size_t n);</p>
<p>void</p>
<p><b>Standard Function Names Converted by the Linker</b></p>
<p>Some Standard C library functions are stored in two formats. The linker looks for</p>
<p>calls to these functions using the standard names and converts those into calls to</p>
<p>either of the special names, based on the settings of certain options. Always refer</p>
<p>to the standard name; the linker is responsible for associating it with a special one.</p>
<p>These functions are:</p>
<p>â¢</p>
<p>wchar_t *</p>
<p>conversion functions (<b>-wchar_u16</b>):</p>
<p>â</p>
<p>__ghs_wchar_u16_wcstod</p>
<p>â</p>
<p>__ghs_wchar_u16_wcstof</p>
<p>â</p>
<p>__ghs_wchar_u16_wcstold</p>
<p><i>861</i></p>
<p><i>Green Hills Software</i></p>
<p><i>libind.a Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>wchar_t *</p>
<p>conversion functions (<b>-wchar_s32</b>):</p>
<p>â</p>
<p>__ghs_wchar_s32_wcstod</p>
<p>â</p>
<p>__ghs_wchar_s32_wcstof</p>
<p>â</p>
<p>__ghs_wchar_s32_wcstold</p>
<p>â¢</p>
<p>time_t</p>
<p>functions (<b>-time64</b>):</p>
<p>â</p>
<p>__ghs_time64_difftime</p>
<p>â</p>
<p>__ghs_time64_gmtime</p>
<p>â</p>
<p>__ghs_time64_gmtime_r</p>
<p>â</p>
<p>__ghs_time64_localtime</p>
<p>â</p>
<p>__ghs_time64_localtime_r</p>
<p>â</p>
<p>__ghs_time64_mktime</p>
<p>â</p>
<p>__ghs_time64_time</p>
<p>â</p>
<p>__ghs_time64_times</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>862</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Customizing the Run-Time Environment Libraries and Object</b></p>
<p><b>Modules</b></p>
<p>The following sections contain information about the libraries and modules that</p>
<p>make up the Green Hills run-time environment, and explain how to create a project</p>
<p>that allows you to customize them.</p>
<p><b>Creating a Project with a Customizable Run-Time Environment</b></p>
<p>While the standard Green Hills run-time environment is sufficient for most users,</p>
<p>you may need to customize some of its underlying routines to suit your needs. To</p>
<p>create a project that allows you to customize the run-time environment:</p>
<p>1.</p>
<p>If you do not have an existing project, click the</p>
<p>button in the Project Manager</p>
<p>to open the<b> Project Wizard</b>, and select the appropriate settings until you reach</p>
<p>the<b> Link Options</b> screen.</p>
<p>If you have an existing project, right-click a program in that project and select</p>
<p><b>Configure</b>.</p>
<p>2.</p>
<p>On the screen that allows you to specify your<b> Program Layout</b>, select one or</p>
<p>more of the<b> Libraries</b> check boxes (see also the documentation about settings</p>
<p>for Stand-Alone programs in the<i> MULTI: Managing Projects and Configuring</i></p>
<p><i>the IDE</i> book). If you set your<b> Program Layout</b> to</p>
<p>Link to ROM and</p>
<p>Execute out of RAM</p>
<p>, some startup code runs out of ROM (see âAssigning</p>
<p>Program Sections to ROM and RAMâ on page 90).</p>
<p>The<b> Project Wizard</b> adds the following files your target resources project</p>
<p>(<b>tgt/resources.gpj</b>), depending on the check boxes you selected:</p>
<p>â¢</p>
<p><b>libstartup/startup.gpj</b> â A project that contains the following startup code:</p>
<p>â</p>
<p><b>crt0.800</b> â see âStartup Module crt0.oâ on page 865.</p>
<p>â</p>
<p><b>libstartup.gpj</b> â see âLow-Level Startup Library libstartup.aâ on page 867.</p>
<p>â¢</p>
<p><b>libsys/libsys.gpj</b> â see âLow-Level System Library libsys.aâ on page 868.</p>
<p>â¢</p>
<p><b>libboardinit/libboardinit.gpj</b> â see âBoard Initialization Library</p>
<p>libboardinit.aâ on page 873. This library is not available for all targets.</p>
<p><i>863</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Customizing the Run-Time Environment Libraries and Object Modules</i></p>
<h1 style="page-break-before:always; "></h1>
<p>You can customize the source to the startup modules as necessary and rebuild them.</p>
<p>Be careful when making any changes to the build options for these projects, because</p>
<p>some of them are required for proper operation. For example,<b> libstartup/startup.gpj</b></p>
<p>and<b> libsys/libsys.gpj</b> define the preprocessor symbol</p>
<p>EMBEDDED</p>
<p>when compiling.</p>
<p>This symbol is required for some modules in the libraries. For more information</p>
<p>about building and setting build options, see the documentation about the MULTI</p>
<p>Project Manager in the<i> MULTI: Managing Projects and Configuring the IDE</i> book.</p>
<p><b>Note</b></p>
<p>The interface to these modules might change between releases of the</p>
<p>product. If you customize your run-time environment and later upgrade</p>
<p>to a new release, you may need to propagate your customizations to the</p>
<p>run-time environment shipped with that new releases. You may not be</p>
<p>able to combine the run-time environment from a given release with other</p>
<p>libraries in a later release.</p>
<p><b>Working With Makefiles</b></p>
<p>If you are using makefiles to invoke the compiler driver and want to customize your</p>
<p>run-time environment:</p>
<p>1.</p>
<p>Create your project with the<b> Project Wizard</b> using the steps provided in</p>
<p>âCreating a Project with a Customizable Run-Time Environmentâ on page 863.</p>
<p>2.</p>
<p>Modify each run-time environment file as needed.</p>
<p>3.</p>
<p>Use your makefile to link with the modified files.</p>
<p><b>Optimizing Startup Code</b></p>
<p>If you want to build faster, smaller startup code with reduced functionality, define</p>
<p>the</p>
<p>MINIMAL_STARTUP</p>
<p>preprocessor symbol in the<b> libstartup/libstartup.gpj</b> and</p>
<p><b>libsys/libsys.gpj</b> projects. This startup code may be useful for very small and simple</p>
<p>test applications that run out of RAM. The following list contains some of the</p>
<p>features that are not supported in this library mode:</p>
<p>â¢</p>
<p>ROM to RAM copy</p>
<p>â¢</p>
<p>PIC</p>
<p>â¢</p>
<p>PID</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>864</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>multithreading</p>
<p>â¢</p>
<p>manual profiling</p>
<p>This library mode is provided as-is. It is intended for experienced users who</p>
<p>understand its limited feature set.</p>
<p><b>Startup Module crt0.o</b></p>
<p><b>crt0.o</b> is the default startup module linked with your program. The source code for</p>
<p><b>crt0.o</b> is contained in the project<b> libstartup/startup.gpj</b>, in the file<b> crt0.800</b>. This</p>
<p>file contains the</p>
<p>_start()</p>
<p>function, which is the default entry point for the program.</p>
<p>If you set your<b> Program Layout</b> to</p>
<p>Link to ROM and Execute out of RAM</p>
<p>,</p>
<p>the initialization code in this module is placed in and executes out of the</p>
<p>uncompressed</p>
<p>.ROM.boottext</p>
<p>section.</p>
<p><b>crt0.800</b></p>
<p><b>crt0.800</b> is a small target-specific assembly language file containing code to set up</p>
<p>a C program environment before calling into a C function. It executes as follows:</p>
<p>1.</p>
<p>On startup, the code uses a system call to determine whether a debug server</p>
<p>is controlling execution of the program (as opposed to the program running</p>
<p>stand-alone, without being connected to a debug server).</p>
<p>2.</p>
<p>If the system call is successful,<b> crt0.800</b> assumes that the debug server has</p>
<p>already performed some register initialization (such as the stack pointer).</p>
<p>If the system call is not successful,<b> crt0.800</b> initializes additional registers,</p>
<p>including the stack pointer. Consult the code to determine which other registers</p>
<p>are manipulated, because this varies across architectures.</p>
<p>3.</p>
<p>After the stack pointer is initialized,</p>
<p>_start()</p>
<p>calls a weak function</p>
<p>__ghs_board_memory_init()</p>
<p>, an entry point to low-level initializations</p>
<p>of the hardware system. An implementation is provided in<b> libstartup.a</b> that</p>
<p>performs initialization of RAM when RAM initialization is enabled (see</p>
<p>âRun-Time RAM Initialization and RAM Initialization Tableâ on page 512).</p>
<p>If RAM initialization is not enabled, or</p>
<p>__ghs_board_memory_init()</p>
<p>is</p>
<p>not implemented, the call to</p>
<p>__ghs_board_memory_init()</p>
<p>is skipped.</p>
<p><i>865</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Startup Module crt0.o</i></p>
<h1 style="page-break-before:always; "></h1>
<p>4.</p>
<p>After register initialization,</p>
<p>_start()</p>
<p>calls the function</p>
<p>__ghs_ind_crt0()</p>
<p>,</p>
<p>the target-independent startup routine located in<b> libstartup.a</b>.</p>
<p>Customizing crt0.800</p>
<p>If you create your own startup code, you must initialize fixed registers (defined by</p>
<p>your processor's ABI) to point to the correct memory regions. The register most</p>
<p>commonly requiring initialization is the stack pointer, because a valid stack is</p>
<p>generally required before a high-level language function can be called.</p>
<p>When initializing the stack pointer, the following information may be helpful:</p>
<p>â¢</p>
<p>The</p>
<p>.stack</p>
<p>section defined in your linker directives (<b>.ld</b>) file specifies the</p>
<p>location and size of the run-time stack.</p>
<p>For example, the following excerpt from a linker directives file specifies that</p>
<p>the stack starts on the first 16-byte aligned address following the</p>
<p>.heap</p>
<p>section</p>
<p>in memory. The stack is configured to be</p>
<p>0x80000</p>
<p>bytes:</p>
<p>.heap align(16) pad(0x100000) :</p>
<p>.stack align(16) pad(0x80000) :</p>
<p>â¢</p>
<p>__ghsbegin_stack</p>
<p>and</p>
<p>__ghsend_stack</p>
<p>specify the beginning and the</p>
<p>end of the</p>
<p>.stack</p>
<p>section. For more information about special symbols of this</p>
<p>format, see âBeginning, End, and Size of Section Symbolsâ on page 503.</p>
<p>â¢</p>
<p>The stack pointer should be initialized to the end of this section, because it</p>
<p>grows downward. To check if the stack is exhausted at run time, compare the</p>
<p>stack pointer to</p>
<p>__ghsbegin_stack</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>866</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Low-Level Startup Library libstartup.a</b></p>
<p>The<b> libstartup.a</b> library contains code that copies sections of a program's text and</p>
<p>initialized data from ROM to RAM. On PIC and/or PID systems, it also adjusts</p>
<p>initializers based on the location of these sections at run time. The code is contained</p>
<p>in<b> libstartup.gpj</b>.</p>
<p>If you set your<b> Program Layout</b> to</p>
<p>Link to ROM and Execute out of RAM</p>
<p>,</p>
<p>the initialization code in this library is placed in and executes out of the</p>
<p>uncompressed</p>
<p>.ROM.boottext</p>
<p>section.</p>
<p><b>ind_crt0.c</b></p>
<p>This module contains startup code in the function</p>
<p>__ghs_ind_crt0()</p>
<p>. This</p>
<p>function:</p>
<p>1.</p>
<p>clears uninitialized sections such as</p>
<p>.bss</p>
<p>.</p>
<p>2.</p>
<p>copies initialized sections from their locations in ROM to their final locations</p>
<p>in RAM, as specified in your linker directives file.</p>
<p>3.</p>
<p>decompresses compressed initialized sections from their locations in ROM</p>
<p>and copies them to their final location in RAM. For more information, see</p>
<p>âCopying a Section from ROM to RAM at Startupâ on page 495.</p>
<p>4.</p>
<p>relocates initialized pointers to any position independent object, if you are</p>
<p>using PIC and/or PID (see âRelocating Initialized Pointersâ on page 867).</p>
<p>5.</p>
<p>calls the library initialization routine</p>
<p>__ghs_ind_crt1()</p>
<p>in the</p>
<p>.text</p>
<p>section</p>
<p>through a function pointer. The application then executes code in the</p>
<p>.text</p>
<p>section. For more information, see âind_crt1.câ on page 869.</p>
<p>Relocating Initialized Pointers</p>
<p>If your program uses PIC and/or PID, the<b> ind_crt0.c</b> code relocates initialized</p>
<p>pointers to any position independent object. For example, consider the following</p>
<p>C code:</p>
<p>extern int foo();</p>
<p>int (*ptr)() = &amp;foo;</p>
<p><i>867</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Low-Level Startup Library libstartup.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p>This declares a global function pointer</p>
<p>ptr</p>
<p>that is initialized to the address of the</p>
<p>function</p>
<p>foo()</p>
<p>. Because the location of</p>
<p>foo()</p>
<p>is not known at link time, the</p>
<p>compiler emits data that describes each such relocated initialization in the program.</p>
<p>For example, when compiling for PIC, the compiler generates data to inform</p>
<p><b>ind_crt0.c</b> that the initializer of the variable</p>
<p>ptr</p>
<p>requires a run-time modification</p>
<p>specifying the location of the program's code, as desired. After<b> ind_crt0.c</b> finishes,</p>
<p>all initialized pointers contain valid run-time addresses.</p>
<p><b>ind_mcpy.800, ind_mset.800</b></p>
<p>These modules contain the C run-time library functions</p>
<p>memcpy()</p>
<p>and</p>
<p>memset()</p>
<p>,</p>
<p>which are used during initialization to copy and clear data sections.</p>
<p><b>ind_reset.800</b></p>
<p>This module contains low-level initialization routines. You may need to modify it</p>
<p>for your target.</p>
<p><b>ind_uzip.c</b></p>
<p>This module contains code that decompresses program sections when copying them</p>
<p>from ROM to RAM. It is pulled in by the linker if any CROM sections are contained</p>
<p>in the program.</p>
<p><b>ind_initmem.800</b></p>
<p>This module contains the low-level initialization routine</p>
<p>__ghs_board_memory_init()</p>
<p>, which is used during startup to initialize RAM.</p>
<p>You may need to modify it for your target to perform other low-level initializations</p>
<p>for your hardware.</p>
<p><b>Low-Level System Library libsys.a</b></p>
<p>The<b> libsys.a</b> library contains code that performs run-time library initialization,</p>
<p>profiling, and system calls. The source code is contained in<i><b> install_dir</i>/src/libsys</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>868</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Several<b> libsys.a</b> I/O functions perform system calls on the host when you are</p>
<p>connected to your target with the MULTI Debugger. For more information, see</p>
<p>âlibsys.a Function Implementationâ on page 846.</p>
<p><b>ind_alloc.c</b></p>
<p>This module contains functions that allocate memory of the given type and alignment</p>
<p>from the heap. These functions call</p>
<p>sbrk()</p>
<p>(in<b> ind_heap.c</b>) to allocate the memory,</p>
<p>but also provide alignment guarantees.</p>
<p><b>ind_call.800, ind_dots.800</b></p>
<p>These modules implement low-level system call capability. The routine</p>
<p>__ghs_syscall()</p>
<p>is called by various system call routines, such as</p>
<p>open()</p>
<p>,</p>
<p>close()</p>
<p>,</p>
<p>read()</p>
<p>, and</p>
<p>write()</p>
<p>. The</p>
<p>__ghs_syscall()</p>
<p>routine transfers control</p>
<p>to the start address of the</p>
<p>.syscall</p>
<p>section.</p>
<p>Debug servers can set a breakpoint at the start of the</p>
<p>.syscall</p>
<p>section to emulate</p>
<p>system calls on the host. When the breakpoint is hit, the debug server knows that</p>
<p>a system call occurred. The arguments are retrieved and the system call is emulated</p>
<p>on the host.</p>
<p><b>ind_crt1.c</b></p>
<p>This module contains the first C function called by the standard libraries after</p>
<p>memory and static and global data have been initialized. It initializes the ANSI C</p>
<p>and other run-time libraries before jumping to the application entry point (</p>
<p>main</p>
<p>).</p>
<p><b>ind_errn.c</b></p>
<p>This module handles reads and writes to</p>
<p>errno</p>
<p>and can be customized to maintain</p>
<p>a per-thread</p>
<p>errno</p>
<p>value. See also<b> ind_thrd.c</b>.</p>
<p><i>869</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Low-Level System Library libsys.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>ind_gpid.c</b></p>
<p>This module returns the current process number. This is used in</p>
<p>mktemp()</p>
<p>to add</p>
<p>uniqueness to the generated filenames.</p>
<p><b>ind_lock.c</b></p>
<p>This module implements the global locking mechanism needed for thread-safe</p>
<p>libraries.</p>
<p><b>ind_manprf.c</b></p>
<p>This module contains code to perform stochastic target-based timing profiling when</p>
<p>enabled by the<b> -timer_profile</b> option (see âEnabling Sampled Profilingâ</p>
<p>on page 69).</p>
<p><b>ind_stackcheck.c</b></p>
<p>This module contains code to perform stack checking when enabled by the</p>
<p><b>-stack_check</b> option.</p>
<p><b>ind_thrd.c</b></p>
<p>This module implements the file-specific locking mechanism and optional per-thread</p>
<p>run-time library data structures. In addition, this module provides the following</p>
<p>functions to allow saving and restoring arbitrary state across</p>
<p>setjmp()</p>
<p>and</p>
<p>longjmp()</p>
<p>calls:</p>
<p>int __ghs_SaveSignalContext(jmp_buf jmpbuf)</p>
<p>void __ghs_RestoreSignalContext(jmp_buf jmpbuf)</p>
<p><b>ind_mcnt.800, ind_gcnt.800, ind_bcnt.c, ind_mprf.c, ind_gprf.c</b></p>
<p>These modules provide profiling support. The routine</p>
<p>__ghs_mcount()</p>
<p>is used</p>
<p>for call count profiling and</p>
<p>__ghs_gcount()</p>
<p>is used for call graph profiling. The</p>
<p>module<b> ind_bcnt.c</b> contains the profiling routine</p>
<p>__ghs_bcount()</p>
<p>, which handles</p>
<p>calls that are emitted by the compiler to implement code coverage analysis.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>870</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>ind_heap.c</b></p>
<p>This module contains the dynamic memory allocation routine</p>
<p>sbrk()</p>
<p>. The</p>
<p>.heap</p>
<p>section in the linker directives file specifies the location, size, alignment, and</p>
<p>initialization, if any, of the heap. For example:</p>
<p>.heap align(16) pad(0x100000) :</p>
<p>.stack align(16) pad(0x80000) :</p>
<p>This specifies that the heap starts on the first 16-byte aligned address following the</p>
<p>previous section in memory and is</p>
<p>0x100000</p>
<p>bytes in size. The</p>
<p>.stack</p>
<p>section</p>
<p>then follows the heap area. The</p>
<p>pad</p>
<p>directive instructs the linker that the heap is</p>
<p>uninitialized on startup. This enables you to place the run-time heap anywhere in</p>
<p>memory; the run-time library automatically allocates memory where you place this</p>
<p>section.</p>
<p>Specifying a size for the heap helps ensure that your program does not use more</p>
<p>heap memory than expected. Any attempt to allocate more memory than specified</p>
<p>in</p>
<p>.heap</p>
<p>causes</p>
<p>sbrk()</p>
<p>to fail and return</p>
<p>(void*)-1</p>
<p>.</p>
<p><b>ind_io.c</b></p>
<p>This module contains default implementations of system routines most likely needed</p>
<p>for a Linux/Solaris-like implementation, including:</p>
<p>int open(const char *filename, int flags, ...);</p>
<p>int creat(const char *filename, int prot);</p>
<p>int close(int fno);</p>
<p>long read(int fno, void *buf, long size);</p>
<p>long write(int fno, const void *buf, long size);</p>
<p>int unlink(const char *name);</p>
<p>These system calls enable the program to open, read, write, and close files.</p>
<p>The calls in<b> ind_io.c</b> perform these operations on the host using the system call</p>
<p>interface routine</p>
<p>__ghs_syscall()</p>
<p>, described in âind_call.800, ind_dots.800â</p>
<p>on page 869.</p>
<p><i>871</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Low-Level System Library libsys.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>ind_iob.c</b></p>
<p>This module contains the default file buffer,</p>
<p>_iob</p>
<p>, used by the C library's<b> stdio.h</b></p>
<p>interface. The user may want to modify this to reduce or increase the number of</p>
<p>files that may be opened through this interface. The user may also modify the default</p>
<p>buffering by modifying</p>
<p>__gh_iob_init().</p>
<p><b>ind_exit.c</b></p>
<p>This module contains the following routines:</p>
<p><b>Description</b></p>
<p><b>Routine</b></p>
<p>Registers functions that will be called by</p>
<p>_Exit()</p>
<p>(similar to</p>
<p>the C library</p>
<p>atexit()</p>
<p>).</p>
<p>__ghs_at_exit(struct</p>
<p>__GHS_AT_EXIT*)</p>
<p>Calls clean-up routines registered by the program via</p>
<p>__ghs_at_exit()</p>
<p>and allows the program to terminate cleanly</p>
<p>via the</p>
<p>__ghs_syscall(SYSCALL_EXIT, code)</p>
<p>system</p>
<p>call.</p>
<p>Clean-up routines registered by</p>
<p>atexit()</p>
<p>and C++ global</p>
<p>destructors are handled separately in</p>
<p>exit()</p>
<p>, which finishes</p>
<p>by calling</p>
<p>_Exit()</p>
<p>.</p>
<p>void _Exit(int)</p>
<p><b>Other Low-Level Functions</b></p>
<p>The following files contain a basic set of Linux/Solaris-like operating system</p>
<p>routines. Each routine is commented to show the function it performs and the values</p>
<p>it returns. These routines allow the linker to resolve an operating system's symbols,</p>
<p>referenced by the Green Hills run-time libraries.</p>
<p><b>Routine(s)</b></p>
<p><b>Source File</b></p>
<p>struct tm *gmtime(const time_t *timer);</p>
<p><b>ind_gmtm.c</b></p>
<p>struct tm *localtime(const time_t *timer);</p>
<p><b>ind_loctm.c</b></p>
<p>int rename(const char *old, const char *new);</p>
<p><b>ind_renm.c</b></p>
<p>int raise(int sig);</p>
<p>void (*signal(int sig, void (*func)(int)))(int);</p>
<p><b>ind_sgnl.c</b></p>
<p>int access(const char *name, int mode);</p>
<p><b>ind_stat.c</b></p>
<p>int system(const char *string);</p>
<p><b>ind_syst.c</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>872</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Routine(s)</b></p>
<p><b>Source File</b></p>
<p>time_t time(time_t *tptr);</p>
<p>int times (struct tms *buffer);</p>
<p><b>ind_time.c</b></p>
<p>void tzset(void);</p>
<p>int __gh_timezone(void);</p>
<p><b>ind_tmzn.c</b></p>
<p>int truncate(const char* path, long length);</p>
<p>This function is deprecated and may be removed in a future release.</p>
<p><b>ind_trnc.c</b></p>
<p><b>Board Initialization Library libboardinit.a</b></p>
<p>If you choose to customize the<b> Board Initialization</b> library in the<b> Project Wizard</b></p>
<p>(see âCreating a Project with a Customizable Run-Time Environmentâ on page 863),</p>
<p>it adds<b> libboardinit/libboardinit.gpj</b> to your Top Project. This project builds</p>
<p><b>libboardinit.a</b>, which varies by target and might contain some or all of the following</p>
<p>features.</p>
<p>â¢</p>
<p>ROM-based program support. This includes linker directives files and code to</p>
<p>initialize the memory, chip selects, TLBs, and caches to allow the program to</p>
<p>execute starting from reset.</p>
<p>â¢</p>
<p>Cache synchronization support. This consists of the routine</p>
<p>void</p>
<p>__ghs_board_cache_sync(void* s, size_t n)</p>
<p>, which is called after</p>
<p>each ROM-to-RAM copy of a section containing program text. This routine</p>
<p>flushes the data cache and invalidates the instruction cache contents starting</p>
<p>at address<i> s</i> and continuing for<i> n</i> bytes.</p>
<p>â¢</p>
<p>Serial port support. This might include routines to transmit and receive</p>
<p>characters, as well as optionally including an example of an interrupt service</p>
<p>routine to handle serial port interrupts.</p>
<p>â¢</p>
<p>I/O library overrides. This includes code to connect the C/C++ library's</p>
<p>stdin</p>
<p>input stream and</p>
<p>stdout</p>
<p>output stream to the serial port. This code defines</p>
<p>alternate versions of the</p>
<p>read()</p>
<p>and</p>
<p>write()</p>
<p>system routines that are</p>
<p>otherwise defined by<b> ind_io.c</b> in the low-level system library<b> libsys.a</b>.</p>
<p>â¢</p>
<p>Timer support. This consists of code that is called when target-based timer</p>
<p>profiling is enabled. For more information about this feature, see âEnabling</p>
<p>Sampled Profilingâ on page 69.</p>
<p><i>873</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Board Initialization Library libboardinit.a</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The memory initialization code can be placed either at the reset vector location or</p>
<p>in a routine</p>
<p>__ghs_board_memory_init</p>
<p>, which is called from the Startup Module</p>
<p><b>crt0.o</b> if it exists. After this routine returns, the memory defined by the linker</p>
<p>directives file must be accessible to the program. This routine should be written in</p>
<p>assembly because C code might inadvertently rely on stack memory being accessible.</p>
<p>The remaining device initialization code for the serial port, the interrupt controller,</p>
<p>the I/O library overrides, and the timer setup code is placed in the routine</p>
<p>__ghs_board_devices_init</p>
<p>.</p>
<p>__ghs_board_devices_init</p>
<p>can be written</p>
<p>in C because memory will be initialized, although not all of the C library is usable.</p>
<p>If the file<b> board_init.txt</b> was automatically included in your new project, it contains</p>
<p>further information about debugging stand-alone and other programs on your board.</p>
<p><b>Features that Depend on the Default Green Hills Startup Code</b></p>
<p>This section provides a partial list of features and options that depend on the Green</p>
<p>Hills startup code. If you customize this code, the following features might not work</p>
<p>as expected:</p>
<p><b>Startup Code Requirement</b></p>
<p><b>Feature</b></p>
<p>Processing in the Green Hills</p>
<p>_exit()</p>
<p>function.</p>
<p>atexit()</p>
<p>The Green Hills</p>
<p>exit()</p>
<p>function.</p>
<p>C++ destructors</p>
<p>Might require</p>
<p>__gh_lock_init()</p>
<p>to be called.</p>
<p>Multithreading</p>
<p>Might require base registers to be set up.</p>
<p>PIC and PID</p>
<p>__gh_iob_init()</p>
<p>must be called.</p>
<p>stdin</p>
<p>,</p>
<p>stdout</p>
<p>, and</p>
<p>stderr</p>
<p>The following options also depend on Green Hills startup code:</p>
<p><b>Startup Code Requirement</b></p>
<p><b>Option</b></p>
<p>The Green Hills</p>
<p>exit()</p>
<p>or</p>
<p>_exit()</p>
<p>functions dump profiling</p>
<p>data. To learn how to dump profiling data during a program's</p>
<p>execution, see the documentation about manually dumping</p>
<p>profiling data in the<i> MULTI: Debugging</i> book.</p>
<p><b>-a</b></p>
<p><b>-p</b></p>
<p><b>-pg</b></p>
<p>Certain variables (such as those declared with</p>
<p>register int</p>
<p>glob</p>
<p>) are initialized to the value</p>
<p>0</p>
<p>by startup code.</p>
<p><b>-globalreg</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>874</i></p>
<p><i>Chapter 16. Libraries and Header Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>This is not a complete list of features that depend on Green Hills startup</p>
<p>code. Because customizing this code may cause certain features to exhibit</p>
<p>unexpected behavior, do so only when necessary.</p>
<p><i>875</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Features that Depend on the Default Green Hills Startup Code</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 17</b></p>
<p><b>Mixing Languages and</b></p>
<p><b>Writing Portable Code</b></p>
<p><b>Contents</b></p>
<p>Mixing Languages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>878</p>
<p>Writing Portable Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>883</p>
<h1 style="page-break-before:always; "></h1>
<p><b>Mixing Languages</b></p>
<p>Green Hills compilers can combine C and C++ routines within the same executable</p>
<p>files, subject to certain constraints. This section provides some basic information</p>
<p>about using Green Hills compilers to create a mixed language executable and</p>
<p>describes how the compiler driver builds mixed language executables. Additional</p>
<p>language-specific details are provided in the subsequent sections.</p>
<p>All Green Hills compiler drivers are compatible with each other. This permits a C</p>
<p>driver to compile a C++ module, and a C++ driver to compile a C module. The</p>
<p>driver uses the input filename extension to determine the correct language, rather</p>
<p>than assuming that the name of the driver determines the source code language.</p>
<p>Though compatible during compilation, the various drivers differ during the link</p>
<p>phase. To link an application, the driver must determine all of the languages in use</p>
<p>in order to know which libraries to include. The driver assumes that every application</p>
<p>has modules written in C and assembly language, and that there is at least one</p>
<p>module written in the driver's default language. If the command line includes source</p>
<p>files written in other languages (as indicated by the file extension), then the driver</p>
<p>recognizes that those languages exist in the application as well.</p>
<p>Consequently, mixing any one language with C is easy because the driver always</p>
<p>assumes C is in use. To ensure the correct linkage when mixing a language with C,</p>
<p>use the driver for the language other than C for linking the application.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>878</i></p>
<p><i>Chapter 17. Mixing Languages and Writing Portable Code</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Initialization of Libraries</b></p>
<p>A multiple language application may need to perform input and output in more than</p>
<p>one language. With a little care to avoid conflicts between languages, this is fully</p>
<p>supported. If input and output will always be performed on different files by each</p>
<p>language, then the main program in a single language application automatically</p>
<p>handles the initialization and deinitialization of each language's run-time routines.</p>
<p>Therefore, if the application will only perform I/O in one language other than C,</p>
<p>then it is easy to write the main program for the application in that language. For</p>
<p>more complex requirements, write a main program in C to perform the initialization</p>
<p>and deinitialization of the library run-time routines. Examples of main programs in</p>
<p>C are given in the next section.</p>
<p><b>Examples of main() Programs</b></p>
<p>All language environments automatically perform initializations at the start of the</p>
<p>execution and cleanup at the termination. The initializations and cleanup vary</p>
<p>depending on the language. Examples of initializations and cleanup include command</p>
<p>line argument initialization, standard input/output configuration, and static object</p>
<p>creation/destruction. Since the C language initializations and cleanup differ from</p>
<p>that of the other languages, you must often insert code inside the</p>
<p>main()</p>
<p>function</p>
<p>to ensure proper configuration.</p>
<p><b>C main() Program for C++</b></p>
<p>If a program uses both C and C++, and the</p>
<p>main()</p>
<p>function is written in C, insert</p>
<p>a call to</p>
<p>_main()</p>
<p>as the first executing statement and a call to</p>
<p>exit(0)</p>
<p>as the last</p>
<p>executing statement (see example below). You must do this to ensure that static</p>
<p>constructors and destructors are properly configured. For more details on using C++</p>
<p>in C programs refer to âUsing C++ in C Programsâ on page 881.</p>
<p>void main(void)</p>
<p>{</p>
<p>_main();/* must be first executable line */</p>
<p>/* rest of main goes here */</p>
<p>exit(0);/* must be last executable line */</p>
<p>}</p>
<p><i>879</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Initialization of Libraries</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Performing I/O on a Single File in Multiple Languages</b></p>
<p>Some applications benefit from performing input and output on a single file or</p>
<p>device from more than one language; one example of this is pre-opened files. In C,</p>
<p>these are</p>
<p>stdin</p>
<p>,</p>
<p>stdout</p>
<p>, and</p>
<p>stderr</p>
<p>. In C++, they are the same as C or,</p>
<p>alternatively,</p>
<p>iostreams cin</p>
<p>,</p>
<p>cout</p>
<p>, or</p>
<p>cerr</p>
<p>may be used.</p>
<p>All languages have full access to these pre-opened files, and input and output can</p>
<p>easily be mixed between the languages on these files. However, for the best results,</p>
<p>a complete input or output operation is done in a single language. In C, any call to</p>
<p>a library function which performs input or output is a complete operation. If this</p>
<p>rule is followed, all data will be output correctly and in the intended sequence. The</p>
<p>C library routine</p>
<p>fflush()</p>
<p>flushes the buffer of the pre-opened files in all</p>
<p>languages. In addition, to flush one of C++</p>
<p>iostreams</p>
<p>, use the notation</p>
<p><i>file</i> &lt;&lt;</p>
<p>flush</p>
<p>. For example:</p>
<p>std::cout &lt;&lt; std::flush;</p>
<p>Performing input and output on a single file which is not preopened is more difficult.</p>
<p>It is possible to open the file once in each language and perform input and output</p>
<p>independently in each language. In many cases this would be unacceptable,</p>
<p>particularly when working with a device rather than a simple file.</p>
<p><b>C Routines and Header Files In C++</b></p>
<p>The C++ language allows much use of existing C code. Therefore, it is fairly</p>
<p>straightforward to call functions written in C from C++. The syntax of the two</p>
<p>languages is very similar and the use of header files has been continued in C++.</p>
<p>By default in C++, the names of functions are encoded or mangled, whereas in C,</p>
<p>the names of functions are unchanged. C++ provides the</p>
<p>extern</p>
<p>specifier to</p>
<p>identify non-C++ functions so their names will not be mangled. Therefore, this</p>
<p>specifier allows declarations for C functions to be included and then linked with</p>
<p>the compiled C object code.</p>
<p>To specify a C declaration:</p>
<p>â¢</p>
<p>Specify or declare functions individually. The following example specifies that</p>
<p>two functions with</p>
<p>extern &quot;C&quot;</p>
<p>linkage are to be declared.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>880</i></p>
<p><i>Chapter 17. Mixing Languages and Writing Portable Code</i></p>
<h1 style="page-break-before:always; "></h1>
<p>extern &quot;C&quot; {</p>
<p>int fclose(FILE *);</p>
<p>FILE *fopen(const char *, const char *);</p>
<p>}</p>
<p>We recommend that you do not use a function declaration with an empty</p>
<p>parameter list. This means different things in C and C++ (see âFunction</p>
<p>Prototyping in C vs. C++â on page 882). For compatibility in both languages,</p>
<p>specify the parameters, or use a parameter list consisting solely of the keyword</p>
<p>void</p>
<p>if there are no parameters. For example:</p>
<p>int func1(int a, short b, const int *c); /* GOOD */</p>
<p>void func2(void);</p>
<p>/* GOOD */</p>
<p>int func3();</p>
<p>/* BAD</p>
<p>*/</p>
<p>â¢</p>
<p>If code contains both C and C++, then the</p>
<p>extern</p>
<p>constructs can be placed</p>
<p>within</p>
<p>#ifdef __cplusplus</p>
<p>statements. This practice is common within</p>
<p>header files. For example,</p>
<p>#ifdef __cplusplus</p>
<p>extern &quot;C&quot; {</p>
<p>#endif</p>
<p>void assert(int);</p>
<p>void _assert(const char *,const int,const char *);</p>
<p>#ifdef __cplusplus</p>
<p>}</p>
<p>#endif</p>
<p><b>Using C++ in C Programs</b></p>
<p>To call C++ from C, declare an</p>
<p>extern &quot;C&quot;</p>
<p>interface for the C++ code. Otherwise,</p>
<p>the C code must manually perform some of the tasks that the C++ compiler performs</p>
<p>automatically. You must know the following internal mechanics and details of the</p>
<p>C++ implementation:</p>
<p>â¢</p>
<p>The C++ compiler encodes or mangles function and class member names. Any</p>
<p>C++ function or class members called from a C program must be referenced</p>
<p>by the encoded or mangled names.</p>
<p><i>881</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Using C++ in C Programs</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>The manner in which a C++ compiler handles member functions must be</p>
<p>known. All member functions (except static member functions) have the special</p>
<p>object member pointer</p>
<p>this</p>
<p>inserted automatically as the first argument in the</p>
<p>parameter list. A C programmer must manually add the argument</p>
<p>this</p>
<p>when</p>
<p>calling any member functions from C.</p>
<p>â¢</p>
<p>Handling constructors and destructors for static objects requires special</p>
<p>processing.</p>
<p>On most systems, the</p>
<p>main()</p>
<p>function has a special function</p>
<p>call to</p>
<p>_main()</p>
<p>inserted to ensure that all static constructor/destructor calls</p>
<p>are made properly. If</p>
<p>main()</p>
<p>is not in a C++ module, then the C programmer</p>
<p>must manually include calls to</p>
<p>_main()</p>
<p>in the C main module. The</p>
<p>_main()</p>
<p>code is contained in the C++ library and therefore must be linked into the final</p>
<p>executable.</p>
<p><b>Note</b></p>
<p>When using INTEGRITY and creating a C task,</p>
<p>_main</p>
<p>is called</p>
<p>before</p>
<p>main()</p>
<p>so that if</p>
<p>main()</p>
<p>is in C code but there are C++</p>
<p>static constructors, the call is still constructed.</p>
<p>â¢</p>
<p>Virtual functions are also handled automatically by a C++ compiler, but involve</p>
<p>additional coding to access or use them from a C environment.</p>
<p>We recommend that your C code always call into C++ code with</p>
<p>extern &quot;C&quot;</p>
<p>;</p>
<p>using any other method results in code that is not portable among compilers, or</p>
<p>even among releases of the same compiler.</p>
<p><b>Function Prototyping in C vs. C++</b></p>
<p>In ANSI C and C++, header files provide prototypes for library functions which</p>
<p>enforce a standard interface between the calling program and the called function.</p>
<p>Function prototyping requires that the function declaration include the function</p>
<p>return type and the number and type of the arguments. When a prototype is available</p>
<p>for a function, the compiler is able to perform argument checking and coercion on</p>
<p>calls to that function. If a prototype is not available for a function when it is called,</p>
<p>ANSI C will behave like K&amp;R C. The return type of the function is assumed to be</p>
<p>int</p>
<p>, and actual arguments will be promoted to</p>
<p>int</p>
<p>,</p>
<p>long</p>
<p>, or</p>
<p>double</p>
<p>types, or</p>
<p>pointers as appropriate. In C++, however, it is an error to call a function which has</p>
<p>not been declared with a prototype.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>882</i></p>
<p><i>Chapter 17. Mixing Languages and Writing Portable Code</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Another important difference between ANSI C and C++ is that a non-prototype</p>
<p>declaration of a function, such as:</p>
<p>char *function_name();</p>
<p>has no effect on the number and type of the arguments in ANSI C. In C++ it is</p>
<p>understood as:</p>
<p>char *function_name(void)</p>
<p>which means that the function has no arguments at all. If the function declaration</p>
<p>occurs within the scope of an</p>
<p>extern &quot;C&quot;</p>
<p>declaration, the function has non-C++</p>
<p>linkage, and therefore cannot be overloaded. This means that if a traditional K&amp;R</p>
<p>style declaration of a function appears in a header file, and the</p>
<p>#include</p>
<p>directive</p>
<p>which accesses that header file is enclosed in</p>
<p>extern &quot;C&quot; { }</p>
<p>, then it will be</p>
<p>impossible to redeclare that function with arguments.</p>
<p><b>Writing Portable Code</b></p>
<p>Many compiler vendors have implemented the C and C++ languages for a wide</p>
<p>variety of system architectures. One important reason for this is that these languages</p>
<p>greatly simplify the task of building and maintaining software for multiple platforms.</p>
<p>However, not all features of C and C++ accommodate this goal. In fact, both</p>
<p>languages intentionally provide features that perform differently on different systems.</p>
<p>For a program to be truly portable, the programmer must avoid these non-portable</p>
<p>features of the C and C++ languages. This chapter discusses some of the non-portable</p>
<p>assumptions that can cause programs to fail and how to avoid portability problems</p>
<p>with Green Hills C/C++ compilers.</p>
<p>The C/C++ language specifications define programs in such a way that portable</p>
<p>programs will always work with all appropriate language compilers, including any</p>
<p>Green Hills C/C++ compiler. However, difficulties arise when programmers make</p>
<p>non-portable assumptions about the machine or compiler that they are using. As a</p>
<p>result, a program may appear to compile and operate correctly when compiled with</p>
<p>one vendor's compiler, but not with a Green Hills compiler.</p>
<p>Certain differences between compilers are specific to the individual compiler vendor.</p>
<p>In addition, many more differences are particular to the processor and the operating</p>
<p>system being used. To avoid these differences when porting between different</p>
<p>system architectures, portable code should be consistently written.</p>
<p><i>883</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Writing Portable Code</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Compatibility Between Green Hills Compilers</b></p>
<p>All Green Hills C/C++ compilers follow the same interpretation of the C/C++</p>
<p>languages as described in this manual; however, some Green Hills C or C++</p>
<p>compilers do not include certain features or options.</p>
<p>For information about compatibility with Green Hills compilers for other languages,</p>
<p>see âMixing Languagesâ on page 878.</p>
<p><b>Word Size Differences</b></p>
<p>Green Hills compilers support machines with 32-bit and 64-bit word size. Porting</p>
<p>C/C++ programs between machines of different word sizes requires particular care</p>
<p>because word size may affect most primary data types.</p>
<p>Some machines are<i> byte addressable</i> , meaning that their addresses refer to 8-bit</p>
<p>bytes. Typically, byte addressable machines operate on 8, 16, 32, 64, and 128-bit</p>
<p>quantities. Other machines are<i> word addressable</i>, meaning that their addresses refer</p>
<p>to words of a standard size varying from 16 to 64 bits. Word addressable machines</p>
<p>typically operate on multiples of the word size.</p>
<p>A program that operates on a machine of one word size may not operate on a machine</p>
<p>of a different word size. Thus, word size incompatibility problems may arise if two</p>
<p>different machines have different word sizes, or if one machine is word addressable</p>
<p>and the other is byte addressable. The word size affects the range of numbers</p>
<p>implemented by integer data types, as well as the precision and range of single and</p>
<p>double precision floating-point data types.</p>
<p>The most common word size problems are integer and floating-point underflows,</p>
<p>overflows, and loss of precision. The layout of bit aligned data structures will vary</p>
<p>with the word size, so overlaying structures in memory makes programs difficult</p>
<p>to port to another compiler. Address arithmetic done in integer variables is often</p>
<p>not portable.</p>
<p><b>Range of Representable Values</b></p>
<p>The size of each basic numeric type controls the range of values which may be</p>
<p>represented by that type. The header files<b> &lt;limits.h&gt;</b> and<b> &lt;float.h&gt;</b> provide defined</p>
<p>symbols which represent the minimum and maximum values for all numeric data</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>884</i></p>
<p><i>Chapter 17. Mixing Languages and Writing Portable Code</i></p>
<h1 style="page-break-before:always; "></h1>
<p>types in C/C++. A portable program should use these symbols and never depend</p>
<p>on the use of values outside the allowed range.</p>
<p>If arithmetic operations cause overflow, underflow, or loss of precision, the program</p>
<p>may not detect the error or may behave differently on different systems.</p>
<p><b>Relative Sizes of Data Types</b></p>
<p>Both C and C++ place very weak requirements on the relative size of the basic</p>
<p>types, though programs in either language commonly assume otherwise. For</p>
<p>example, both languages only require that</p>
<p>short</p>
<p>be no larger than</p>
<p>int</p>
<p>and that</p>
<p>int</p>
<p>be no larger than</p>
<p>long</p>
<p>. It would be legal for</p>
<p>short</p>
<p>,</p>
<p>int</p>
<p>, and</p>
<p>long</p>
<p>to all be</p>
<p>the same size or for them all to be different. For instance, with some 32-bit Green</p>
<p>Hills C/C++ compilers,</p>
<p>short</p>
<p>is 16 bits and both</p>
<p>int</p>
<p>and</p>
<p>long</p>
<p>are 32 bits. The</p>
<p>assumption that</p>
<p>int</p>
<p>is twice as large as</p>
<p>short</p>
<p>, but the same size as</p>
<p>long</p>
<p>is</p>
<p>non-portable, because, with 64-bit Green Hills C/C++ compilers,</p>
<p>short</p>
<p>is 16 bits,</p>
<p>and</p>
<p>int</p>
<p>and</p>
<p>long</p>
<p>are either 32 or 64 bits.</p>
<p>Another common non-portable assumption is that pointers are the same size as</p>
<p>int</p>
<p>or</p>
<p>long</p>
<p>. Neither is guaranteed. With most 32-bit Green Hills C/C++ compilers,</p>
<p>pointers are 32 bits. With 64-bit Green Hills C/C++ compilers, pointers may be</p>
<p>either 32 or 64 bits, independent of the size of</p>
<p>int</p>
<p>or</p>
<p>long</p>
<p>. Use the</p>
<p>uintptr_t</p>
<p>and</p>
<p>intptr_t</p>
<p>types provided by<b> stdint.h</b> as portable integer types large enough</p>
<p>to represent any data pointer, but not function pointers.</p>
<p>In both languages, all integer constants have type</p>
<p>int</p>
<p>unless marked with a type</p>
<p>suffix. In certain cases, the use of a plain integer constant instead of a long integer</p>
<p>constant may be non-portable.</p>
<p><b>Endianness Problems</b></p>
<p>Programs that overlay characters and integers in memory or that use character</p>
<p>pointers to integer variables and vice versa are often not portable between machines</p>
<p>with different byte ordering.</p>
<p>Programs that declare a single variable with different integer types in different</p>
<p>modules may fail when ported to a machine with a different byte order.</p>
<p><i>885</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Endianness Problems</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Alignment Requirements</b></p>
<p>Some systems will not load or store a two byte object unless that object is on an</p>
<p>even address. Other systems have a similar requirement for four or eight byte objects.</p>
<p>Others may allow certain accesses, but require more time to perform them. Therefore,</p>
<p>alignment of data is both a matter of correctness and of time efficiency. Although</p>
<p>increased alignment may improve performance, it also consumes space, due to</p>
<p>padding inserted to achieve alignment.</p>
<p>The alignment requirements on each system are chosen both to satisfy the restrictions</p>
<p>of the hardware and to achieve a reasonable balance between performance and</p>
<p>space. The alignment rules are often not configurable and they differ for each system.</p>
<p>Thus, programs that make assumptions about the relative position of data objects</p>
<p>in memory or elements within classes, structures, or arrays are not portableâeven</p>
<p>among the Green Hills C++ compilers.</p>
<p>The C/C++ languages impose the following restrictions on size and alignment:</p>
<p>â¢</p>
<p>The alignment of a structure, union, class, or array is equal to or greater than</p>
<p>the maximum alignment requirement of any of its members.</p>
<p>â¢</p>
<p>The size of a structure, union, class, or array is always a multiple of the</p>
<p>maximum alignment requirement of any of its members.</p>
<p>â¢</p>
<p>The offset of any member of a structure, union, class, or array is always a</p>
<p>multiple of its alignment requirement.</p>
<p>â¢</p>
<p>All dynamic memory allocation routines provided with the compiler will return</p>
<p>a pointer aligned to the maximum alignment for any object on that machine.</p>
<p>All Green Hills C/C++ compilers also satisfy these principles:</p>
<p>â¢</p>
<p>The stack is maintained on an alignment suitable for any object.</p>
<p>â¢</p>
<p>Parameters and local variables are allocated on the stack according to their</p>
<p>alignment requirement.</p>
<p>â¢</p>
<p>Local variables are arranged on the stack to avoid unnecessary padding due to</p>
<p>alignment.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>886</i></p>
<p><i>Chapter 17. Mixing Languages and Writing Portable Code</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Structures, Unions, Classes, and Bitfields</b></p>
<p>The preceding issues of size, byte order, and alignment all affect the allocation of</p>
<p>data in memory. In particular, compound data structures such as unions, structures,</p>
<p>classes, bitfields, and arrays are very much affected by these issues.</p>
<p><b>Unions</b></p>
<p>A union allows the same memory location to be accessed as more than one type.</p>
<p>This is inherently non-portable. Suppose a union consists of an integer and an array</p>
<p>of four characters. Whether the first element of the array is the most or least</p>
<p>significant part of the integer depends on byte order. It is not even certain that the</p>
<p>integer and the array of characters have the same size.</p>
<p>These problems increase when a program combines integer, floating-point, and</p>
<p>pointer fields, and are even more severe when unions consist of structures or bitfields.</p>
<p><b>Structures and Classes</b></p>
<p>Green Hills C/C++ compilers always allocate fields in a structure or class in the</p>
<p>order in which the program declares them.</p>
<p>The exact offset of each field from the base of the structure/class depends on the</p>
<p>size and alignment of the field itself and of those which precede it. The offset of</p>
<p>the first field is always</p>
<p>0</p>
<p>in C, but not necessarily in C++ (for instance with multiple</p>
<p>inheritance). Also, padding is inserted as necessary to satisfy the alignment</p>
<p>requirement of each subsequent field, and may also be added at the end of the</p>
<p>structure/class to make its overall size a multiple of its alignment.</p>
<p>Any program is non-portable if it assumes the offset of a field within a class/structure</p>
<p>or if it assumes that certain fields in two different classes/structures always have</p>
<p>the same offset.</p>
<p><b>Bitfields</b></p>
<p>The allocation of bitfields in a structure is dependent upon alignment rules.</p>
<p>Additionally, the exact layout of bits within a bitfield varies between systems and</p>
<p>cannot be assumed by a portable program.</p>
<p><i>887</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Structures, Unions, Classes, and Bitfields</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Assumptions About Function Calling Conventions</b></p>
<p>Early implementations of C used a very straightforward approach to function calls.</p>
<p>All parameters were pushed on the stack from right to left. All integral types smaller</p>
<p>than</p>
<p>int</p>
<p>were promoted to</p>
<p>int</p>
<p>and</p>
<p>float</p>
<p>was promoted to</p>
<p>double</p>
<p>. Given this</p>
<p>implementation, it was possible to write functions in C which handled variable</p>
<p>parameters, even before the<b> &lt;stdarg.h&gt;</b> facilities. But such functions are</p>
<p>non-portable and depend on an intimate knowledge of the calling conventions.</p>
<p>Many modern C/C++ compilers pass some parameters in registers and may not</p>
<p>evaluate parameters from right to left. Integer and floating-point variables, not to</p>
<p>mention structures, may have different rules. One non-portable assumption is that</p>
<p>a</p>
<p>double</p>
<p>may be passed to a function which expects two integers. Not only does</p>
<p>this assume a relationship between the size of the two types and a certain ordering</p>
<p>of bytes and words, but it assumes that doubles and integers follow all of the same</p>
<p>rules. Both of these assumptions are erroneous.</p>
<p>A much more common assumption is that pointer and integers may be interchanged</p>
<p>when passing parameters. Neither C nor C++ guarantee that a pointer will be</p>
<p>assigned to an integer and back without loss of informationâeven if the pointer</p>
<p>and the integer are the same size. The only safe way to write a function that can</p>
<p>correctly accept either pointer or integer parameters is to use the<b> &lt;stdarg.h&gt;</b></p>
<p>facilities.</p>
<p>Even among integral types, a program may assume that</p>
<p>int</p>
<p>and</p>
<p>long</p>
<p>are</p>
<p>interchangeable. A C program can invoke<b> printf</b> using the<b> %d</b> operator to refer to</p>
<p>a</p>
<p>long</p>
<p>parameter; however, this program will fail when ported to a system where</p>
<p>long</p>
<p>is larger than</p>
<p>int</p>
<p>. The correct way is to use<b> %ld</b> for</p>
<p>long</p>
<p>parameters.</p>
<p>The same portability problems exist with respect to function return values. A function</p>
<p>which returns an</p>
<p>int</p>
<p>should never be used to return a pointer or</p>
<p>long</p>
<p>or</p>
<p>floating-point value, even though it may work reliably on a particular system. A</p>
<p>common mistake is to omit a declaration of a function that returns a pointer, and</p>
<p>then place a cast around the invocation of that function. The cast cannot fix the</p>
<p>error; it only prevents the compiler from reporting it.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>888</i></p>
<p><i>Chapter 17. Mixing Languages and Writing Portable Code</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Pointer Issues</b></p>
<p>Nearly all machines supported by Green Hills compilers are byte addressable, but</p>
<p>neither C nor C++ require this. On some machines, a pointer to an</p>
<p>int</p>
<p>and a pointer</p>
<p>to a</p>
<p>char</p>
<p>are not interchangeable. ANSI C requires that void pointers handle all</p>
<p>pointer types, but the void pointer must be cast or assigned to its original type before</p>
<p>being used. Similarly, C does not require that function pointers and data pointers</p>
<p>be interchangeable, but some C programs incorrectly make this assumption.</p>
<p>C supports portable pointer arithmetic, provided it is used correctly. In ANSI C,</p>
<p>the difference of two pointers is only defined for cases where both pointers refer to</p>
<p>two elements within the same array object. Even so, in some unusual cases the</p>
<p>difference may be outside the range of</p>
<p>ptrdiff_t</p>
<p>(which is either</p>
<p>int</p>
<p>or</p>
<p>long</p>
<p>).</p>
<p>Subtraction or comparison of pointers to two separate objects may give non-portable</p>
<p>results due to differences in memory layout or because pointers are signed on one</p>
<p>system and unsigned on another.</p>
<p>Pointer arithmetic should always be done directly on the pointers when possible.</p>
<p>If you need an integer type, use</p>
<p>uintptr_t</p>
<p>or</p>
<p>intptr_t</p>
<p>.</p>
<p><b>NULL Pointer</b></p>
<p>In all Green Hills C/C++ compilers, and most C compilers in general, the</p>
<p>NULL</p>
<p>pointer has the value</p>
<p>0</p>
<p>. But there are still two portability issues. One issue is that</p>
<p>some older programs depend upon the contents of memory location</p>
<p>0</p>
<p>being</p>
<p>0</p>
<p>. This</p>
<p>is now a well recognized programming error and some modern machines purposely</p>
<p>give a memory fault for any attempt to read or write to location</p>
<p>0</p>
<p>.</p>
<p>A more subtle problem is the size of</p>
<p>NULL</p>
<p>. On a machine where pointers are larger</p>
<p>than</p>
<p>int</p>
<p>, it is incorrect to use the constant 0 as a</p>
<p>NULL</p>
<p>pointer, because</p>
<p>0</p>
<p>is of type</p>
<p>int</p>
<p>, which is smaller than a pointer. This matters when passing</p>
<p>NULL</p>
<p>to a function</p>
<p>that takes variable parameters or is not declared with a prototype.</p>
<p><b>Character Set Dependencies</b></p>
<p>Not all computer systems use the same characters. Although all computer systems</p>
<p>recognize letters, digits, and the standard punctuation characters, considerable</p>
<p>variation exists among the less commonly used characters. Therefore, programs</p>
<p>which use the less common characters may not be portable.</p>
<p><i>889</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Pointer Issues</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Green Hills compilers use the ASCII character set and the ASCII collating sequence.</p>
<p>Some language implementations use a different<i> collating sequence</i> , such as</p>
<p>EBCDIC. Programs which manipulate character data, especially string sorting</p>
<p>algorithms, may be dependent on a particular character collating sequence (the order</p>
<p>in which characters are defined by the implementation). If one character appears</p>
<p>before a second character in the collating sequence, then the first character will be</p>
<p>considered smaller than the second character when they are compared. In the ASCII</p>
<p>collating sequence, the lowercase letters</p>
<p>'a'</p>
<p>to</p>
<p>'z'</p>
<p>appear as the contiguous integer</p>
<p>values 97 to 122 (decimal). In other collating sequences, such as EBCDIC, the</p>
<p>lowercase letters are not contiguous.</p>
<p>To make character and string sorting programs portable, dependencies on the</p>
<p>character collating sequence should be avoided. If a program is designed to operate</p>
<p>with a collating sequence other than ASCII, it may be necessary to modify string</p>
<p>and character comparison code in order to operate with ASCII.</p>
<p><b>Floating Point Range and Accuracy</b></p>
<p>The range, precision, accuracy, and base of floating-point arithmetic can vary widely</p>
<p>between machines. This can lead to many portability problems that can only be</p>
<p>addressed numerically. Green Hills compilers use the standard IEEE floating-point</p>
<p>representation.</p>
<p><b>Operating System Dependencies</b></p>
<p>The file and I/O device naming conventions vary greatly among computer systems.</p>
<p>Thus, programs that access operating system resources (such as files) by their system</p>
<p>names are often not portable. In order to write portable programs, the use of explicit</p>
<p>filenames in the program should be minimized. Preferably, these names can be input</p>
<p>to the program when the program is run.</p>
<p>If a program contains explicit filenames it may be necessary to change them to</p>
<p>names acceptable to the target system. Refer to your target operating system</p>
<p>documentation for a description of legal filenames for that environment.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>890</i></p>
<p><i>Chapter 17. Mixing Languages and Writing Portable Code</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Assembly Language Interfaces</b></p>
<p>Programs which use embedded assembly code or interface to external assembly</p>
<p>will require all of the assembly code to be rewritten when the program is transported</p>
<p>to a new machine.</p>
<p><b>Evaluation Order</b></p>
<p>None of the language specifications fully describe the order in which the various</p>
<p>components of an expression or statement must be evaluated. Additionally, the</p>
<p>language specifications disallow computations whose results depend upon which</p>
<p>permitted evaluation order is used. Many illegal programs have gone undetected</p>
<p>because they have only been compiled with one compiler. Because the evaluation</p>
<p>order may differ between compilers, some illegal programs may not operate as</p>
<p>expected when compiled with a Green Hills compiler.</p>
<p>Some language implementations may evaluate the arguments to a function from</p>
<p>right to left, others from left to right.</p>
<p>Green Hills compilers may execute expressions with side effects (such as subroutine,</p>
<p>procedure, or function calls) in a different order than other compilers. When a</p>
<p>variable is modified as a side effect of an expression, and its value is also used at</p>
<p>another point in the expression, it is not specified whether the value used at either</p>
<p>point in the expression is the value before or after modification. Different values</p>
<p>for the same variable could potentially be used at different places in the expression,</p>
<p>depending on the evaluation order observed by the compiler.</p>
<p>Green Hills compilers may also execute operators with side effects (such as</p>
<p>++</p>
<p>,</p>
<p>--</p>
<p>,</p>
<p>or</p>
<p>+=</p>
<p>) in a different order from that of other compilers.</p>
<p><b>Machine-Specific Arithmetic</b></p>
<p>Certain arithmetic operators in C/C++ are intended to generate the most efficient</p>
<p>corresponding operation on the target machine. If all input values are within the</p>
<p>expected range, the results are portable. Out of range values may give different</p>
<p>results on different systems.</p>
<p><i>891</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Assembly Language Interfaces</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Shift</b></p>
<p>The shift operators in C/C++ possess machine-specific arithmetic characteristics.</p>
<p>If the right-hand operand is negative or is greater than or equal to the number of</p>
<p>bits in the promoted left-hand operand, the behavior is undefined and the results</p>
<p>vary among compilers and hardware, and depending on whether the right hand</p>
<p>operand is constant.</p>
<p>If the left-hand operand of a right shift is signed, C/C++ does not require the compiler</p>
<p>to propagate the sign bit. While all Green Hills compilers propagate the sign bit, a</p>
<p>conforming compiler is allowed to propagate zeros into the high bits.</p>
<p><b>Division</b></p>
<p>Division always satisfies the following rule:</p>
<p>(a / b) * b + a % b == a</p>
<p>When either</p>
<p>a</p>
<p>or</p>
<p>b</p>
<p>is negative, a C89 or C++ compiler is allowed to round</p>
<p>a / b</p>
<p>either toward zero or toward negative infinity. In C99, a compiler must always</p>
<p>round toward zero. Green Hills always rounds toward zero, but a non-GHS compiler</p>
<p>may round toward negative infinity.</p>
<p><b>Illegal Assumptions About Compiler Optimizations</b></p>
<p>Some programs illegally depend on the exact code generated by a particular compiler.</p>
<p>Such programs are particularly difficult to port to an advanced optimizing compiler</p>
<p>because the optimizer makes major changes in the code in order to reduce the</p>
<p>program's size and increase the program's speed. This section describes some of</p>
<p>the most common illegal assumptions made about code generation. The optimizations</p>
<p>referenced in this chapter are described in greater detail in Chapter 4, âOptimizing</p>
<p>Your Programsâ on page 323.</p>
<p><b>Implied Register Usage</b></p>
<p>Some programs rely on the exact register allocation scheme used by the compiler.</p>
<p>Such programs are illegal and will require modification before they can be</p>
<p>transported.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>892</i></p>
<p><i>Chapter 17. Mixing Languages and Writing Portable Code</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For example, C/C++ programs that rely on register variables being allocated</p>
<p>sequentially to pass hidden parameters will not work. Hidden returns (i.e., using</p>
<p>return</p>
<p>and expecting to return the value of the last evaluated expression) will not</p>
<p>work either.</p>
<p><b>Memory Allocation Assumptions</b></p>
<p>Green Hills compilers allocate memory in a different manner than that of typical</p>
<p>compilers. To ensure portability, programs compiled with a Green Hills compiler</p>
<p>must not make assumptions regarding the order or allocation of variables in memory</p>
<p>except where the language standard specifies it. If a program depends on the illegal</p>
<p>memory allocation peculiarities of a particular compiler, it may experience portability</p>
<p>problems. Note the following:</p>
<p>â¢</p>
<p>Green Hills compilers do not necessarily allocate variables in the order of</p>
<p>declaration.</p>
<p>â¢</p>
<p>Green Hills compilers may not allocate unused variables.</p>
<p><b>Memory Optimization Restrictions</b></p>
<p>This section is very important when the system code or application uses shared</p>
<p>memory or signals.</p>
<p>Using the<b> AdvancedâOptimization OptionsâMemory Optimization</b> option</p>
<p>(<b>-OM</b> ) enables the compiler to assume that memory locations do not change</p>
<p>asynchronously with respect to the running program (see âMemory Optimizationâ</p>
<p>on page 359). In particular, when the compiler reads or writes to some memory</p>
<p>location, it assumes that the same value remains there several instructions later. To</p>
<p>avoid the (potentially high) speed penalties involved in re-reading memory, the</p>
<p>compiler searches a register for a copy of the value to use instead.</p>
<p>If the</p>
<p>volatile</p>
<p>keyword is not used correctly, this option may cause problems for</p>
<p>many parts of operating systems, device drivers, memory mapped I/O locations,</p>
<p>shared memory environments, multiple process environments, and interrupt-driven</p>
<p>routines, and when Linux/Solaris style signals are enabled.</p>
<p>An example of the potential problems involved with memory optimizations is that</p>
<p>many Linux/Solaris device drivers need to use memory locations which are really</p>
<p><i>893</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Memory Optimization Restrictions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>I/O registers that can change at any time. A typical example of a loop waiting for</p>
<p>a device register to change is:</p>
<p>while (!(*TSRADDR &amp; (1 &lt;&lt; TXSBIT)));</p>
<p>If memory optimizations are enabled while compiling this loop, the compiler may</p>
<p>generate code that reads the value pointed to by</p>
<p>TSRADDR</p>
<p>only once. If the</p>
<p><b>AdvancedâOptimization OptionsâOptimize All Appropriate Loops</b> option</p>
<p>(<b>-OL</b> ) is also enabled, it is almost certain that this will be the case. When this</p>
<p>happens, the loop executes either once or forever (depending on the value of the</p>
<p>bit when it is first tested) and will be rendered either ineffective or fatal. Depending</p>
<p>on the situation, the compiler may detect such loops and generate code that operates</p>
<p>correctly even with<b> AdvancedâOptimization OptionsâMemory Optimization</b></p>
<p>option (<b>-OM</b> ) enabled. However, if the loop body were to test more than one bit</p>
<p>at the same address, the compiler may distort the loop in an attempt to read memory</p>
<p>as few times as possible.</p>
<p>The compiler assumes that the</p>
<p>volatile</p>
<p>type qualifier is used when it is available.</p>
<p>This means that any<b> OptimizationâOptimization Strategy</b> implies</p>
<p><b>AdvancedâOptimization OptionsâMemory Optimization</b> in C++ or in the</p>
<p>ANSI modes of C. If circumstances prevent the use of</p>
<p>volatile</p>
<p>, you should</p>
<p>disable the<b> AdvancedâOptimization OptionsâMemory Optimization</b> option</p>
<p>(<b>-Onomemory</b> ). Note that this will leave the other general optimizations enabled</p>
<p>(see âOptimization Optionsâ on page 165).</p>
<p><b>Problems with Source-Level Debuggers</b></p>
<p><b>Variable Allocation</b></p>
<p>When a variable is allocated to a register it will always reside in that register.</p>
<p>However, because other variables may share the register, it may not always contain</p>
<p>the current value of the variable. This may cause a source-level debugger to give</p>
<p>incorrect results. If a variable is looked at outside the range of its use, the compiler</p>
<p>may have temporarily allocated that register for some other purpose. The best</p>
<p>strategy is to check results just after they are assigned, or when the current value is</p>
<p>going to be used later. Near the end of a function, most of the local variables will</p>
<p>no longer be in use, so it is more likely that the register has been re-allocated.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>894</i></p>
<p><i>Chapter 17. Mixing Languages and Writing Portable Code</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Optimizations May Interfere with Debugging Ability</b></p>
<p>Some optimizations may interfere with the Debugger's ability to look into a running</p>
<p>program and provide meaningful information. Green Hills provides several</p>
<p>optimization strategies so that you can choose the best balance between debugging</p>
<p>ability and optimization for each stage of your project. For more information, see</p>
<p>âOptimization Strategyâ on page 165.</p>
<p><b>Problems with Compiler Memory Size</b></p>
<p>The compiler primarily uses memory for the program, static data structures, global</p>
<p>declarations, parse trees, and generated machine code. Global declarations consist</p>
<p>of the global constant, type, variable, and function declarations. Memory usage</p>
<p>increases when a compilation includes large numbers of declarations. Even unused</p>
<p>global declarations must be stored throughout the compilation. If memory size</p>
<p>problems exist, reduce the size of the<b> include</b> files by including only the necessary</p>
<p>declarations.</p>
<p>Basic blocks also require memory. Every possible branch creates a new block.</p>
<p>Memory usage may increase on machine-generated programs with very large</p>
<p>switch</p>
<p>statements or with a very large number of small</p>
<p>if</p>
<p>statements.</p>
<p>The C and C++ compilers store the entire program into a parse tree before proceeding</p>
<p>with optimization and code generation. The optimizer modifies the parse tree and</p>
<p>then passes it on to the code generator. The code generator produces an internal</p>
<p>representation of the machine code to be output for the function. Another</p>
<p>optimization phase is then called to modify this machine code. Finally, the optimized</p>
<p>machine code for the function is output. After the machine code is output, the</p>
<p>memory being used for the parse tree, optimization, and machine code generation</p>
<p>is released for use in processing the next function.</p>
<p>Usually, the size and complexity of the largest function in the program determine</p>
<p>the maximum memory usage for parse trees and machine code. If memory size</p>
<p>problems exist, turn off the optimizer and reduce the size or complexity of the</p>
<p>relevant functions.</p>
<p><i>895</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Problems with Compiler Memory Size</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 18</b></p>
<p><b>Enhanced asm Macro Facility</b></p>
<p><b>for C and C++</b></p>
<p><b>Contents</b></p>
<p>Definition of Terms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>899</p>
<p>Using and Defining the asm Macro Facility . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>899</p>
<p>Using asm Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>901</p>
<p>V850 and RH850 asm Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>905</p>
<p>Guidelines for Writing asm Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>907</p>
<h1 style="page-break-before:always; "></h1>
<p>Although having the ability to write portable code is an advantage of using the C</p>
<p>language, sometimes it is necessary to introduce machine-specific assembly language</p>
<p>instructions into C code. This need arises most often within operating system code</p>
<p>that must deal with hardware registers that would otherwise be inaccessible from</p>
<p>C. You can use the</p>
<p>asm</p>
<p>facility to include this assembly code.</p>
<p>In earlier versions of C, the</p>
<p>asm</p>
<p>facility included a line that looked like a call to the</p>
<p>function</p>
<p>asm</p>
<p>that took one argument, a string:</p>
<p>asm(&quot;<i>assembly instruction here</i>&quot;);</p>
<p>Unfortunately, this technique has shortcomings when the assembly instruction needs</p>
<p>to reference C language operands. The user has to guess the register or stack location</p>
<p>into which the compiler would put the operand and encode that location into the</p>
<p>instruction. If the compiler's allocation scheme changes or, more likely, if the C</p>
<p>code surrounding</p>
<p>asm()</p>
<p>changes, the correct location for the operand in</p>
<p>asm()</p>
<p>also changes. The user has to be aware that the C code would affect</p>
<p>asm()</p>
<p>and</p>
<p>change it accordingly.</p>
<p>In addition,</p>
<p>asm()</p>
<p>statements that contain labels or other unique identifiers might</p>
<p>cause errors if you enable certain optimizations. You may need to use temporary</p>
<p>labels to prevent these errors (See âLabelsâ on page 408 for more information).</p>
<p>The new facility presented here is compatible with old code, since it retains the old</p>
<p>capability. In addition, you can define</p>
<p>asm</p>
<p>macros that describe how machine</p>
<p>instructions should be generated when their operands take particular forms that the</p>
<p>compiler recognizes, such as register or stack variables.</p>
<p>Although this enhanced</p>
<p>asm</p>
<p>facility is easier to use than before, the user is still</p>
<p>strongly discouraged from using it for routine applications, because those</p>
<p>applications will not be portable to different machines. The</p>
<p>asm</p>
<p>facility helps</p>
<p>implement operating systems in a clean way.</p>
<p>Optimizations may work incorrectly on C programs that use the</p>
<p>asm</p>
<p>macro facility,</p>
<p>leading to compile-time or run-time errors. This is more likely when the</p>
<p>asm</p>
<p>macros</p>
<p>contain instructions or labels that are unlike those that the C compiler generates.</p>
<p>No compiler warning or error messages will be issued. Furthermore, the user may</p>
<p>need to rewrite</p>
<p>asm</p>
<p>code in the future, in order to maximize its benefits as new</p>
<p>optimization technology is introduced into the compilation system.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>898</i></p>
<p><i>Chapter 18. Enhanced asm Macro Facility for C and C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Wherever possible, consider using intrinsic functions instead of</p>
<p>asm</p>
<p>macros.</p>
<p>Asm</p>
<p>macros act as an optimization barrier to the compiler, since the compiler is unable</p>
<p>to interpret the actions or understand the instructions in the</p>
<p>asm</p>
<p>macro. Intrinsic</p>
<p>functions, on the other hand, are understood by the compiler, so the compiler need</p>
<p>not make worst-case assumptions about the behavior of the instructions. Intrinsic</p>
<p>functions are also easier to use since the compiler takes care of loading and storing</p>
<p>the operands automatically, as necessary.</p>
<p><b>Definition of Terms</b></p>
<p>The following terms are used when describing the</p>
<p>asm</p>
<p>macro facility.</p>
<p><b>Definition</b></p>
<p><b>Term</b></p>
<p>The mechanism by which programs use the enhanced</p>
<p>asm</p>
<p>facility.</p>
<p>An</p>
<p>asm</p>
<p>macro has a definition and uses. The definition includes a set</p>
<p>of pattern/body pairs. Each pattern describes the storage modes that</p>
<p>the actual arguments must match for the</p>
<p>asm</p>
<p>macro body to be</p>
<p>expanded. The uses resemble C function calls.</p>
<p>asm</p>
<p>macro</p>
<p>The compiler's idea of where the argument can be found at run time.</p>
<p>Examples are âin a registerâ or âin memory.â</p>
<p>storage mode</p>
<p>Specifies the modes for each of the arguments of an</p>
<p>asm</p>
<p>macro. When</p>
<p>the modes in the pattern all match those of the use, the corresponding</p>
<p>body is expanded.</p>
<p>pattern</p>
<p>The portion of code that will be expanded by the compiler when the</p>
<p>corresponding pattern matches. The body may contain references to</p>
<p>the formal parameters, in which case the compiler substitutes the</p>
<p>assembly language location for the corresponding parameter.</p>
<p>asm</p>
<p>macro body</p>
<p><b>Using and Defining the asm Macro Facility</b></p>
<p>The following is a general example intended to demonstrate how to define and use</p>
<p>an</p>
<p>asm</p>
<p>macro. For an example specific to V850 and RH850, see âV850 and RH850</p>
<p>asm Macrosâ on page 905.</p>
<p>Suppose your machine has an instruction that takes one operand, which must be in</p>
<p>a register. It may be convenient to have a function that produces inline code to use</p>
<p>this instruction, and works with register variables or constants.</p>
<p>This example consists of two parts: the definition of the</p>
<p>asm</p>
<p>macro and its use.</p>
<p><i>899</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Definition of Terms</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Pseudo-Code Definition</b></p>
<p>Define an</p>
<p>asm</p>
<p>macro, called</p>
<p>ASM</p>
<p>:</p>
<p>asm void ASM(newpri)</p>
<p>{</p>
<p>%reg newpri</p>
<p><i>asm_instruction</i> newpri</p>
<p>%con newpri</p>
<p><i>asm_move</i> newpri,<i> temp_register</i></p>
<p><i>asm_instruction temp_register</i></p>
<p>}</p>
<p>The lines that begin with</p>
<p>%</p>
<p>are patterns. If the arguments at the time the macro is</p>
<p>called match the storage modes in a pattern, the code that follows the pattern line</p>
<p>will expand.</p>
<p><b>Use</b></p>
<p>The table below shows the (assembly) code that the compiler will generate with</p>
<p>two different uses of the assembly instruction. It uses the following introductory</p>
<p>code (along with the above definition):</p>
<p>void f()</p>
<p>{</p>
<p>register int i = 3;</p>
<p>ASM(i);</p>
<p>ASM(3);</p>
<p>}</p>
<p><b>Generates</b></p>
<p><b>Matches</b></p>
<p><b>Code</b></p>
<p><i>asm_instruction register_i_is_in</i></p>
<p>% reg</p>
<p>ASM(i);</p>
<p><i>asm_move</i> newpri -&gt;<i> temp_register</i></p>
<p><i>asm_instruction temp_register</i></p>
<p>% con</p>
<p>ASM(3);</p>
<p>The first use of</p>
<p>ASM</p>
<p>has a register variable as its argument (assuming that</p>
<p>i</p>
<p>actually</p>
<p>gets allocated to a register). This argument has a storage mode that matches</p>
<p>reg</p>
<p>,</p>
<p>the storage mode in the first pattern. Therefore, the compiler expands the first code</p>
<p>body.</p>
<p>newpri</p>
<p>, the formal parameter in the definition, has been replaced in the</p>
<p>expanded code by the compiler's idea of the assembly-time name for the variable</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>900</i></p>
<p><i>Chapter 18. Enhanced asm Macro Facility for C and C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>i</p>
<p>(<i>register_i_is_in</i>). Similarly, the second use of</p>
<p>ASM</p>
<p>has a constant as its argument,</p>
<p>which leads to the compiler's choosing the second pattern. Here again</p>
<p>newpri</p>
<p>has</p>
<p>been replaced by the assembly-time form for the constant</p>
<p>3</p>
<p>.</p>
<p><b>Using asm Macros</b></p>
<p>You can use the enhanced</p>
<p>asm</p>
<p>facility to define</p>
<p>asm</p>
<p>macros.</p>
<p>asm</p>
<p>macros are</p>
<p>constructs that behave syntactically like static C functions. Each</p>
<p>asm</p>
<p>macro has</p>
<p>one definition and zero or more uses per source file. You must put the macro's</p>
<p>definition in the file that uses the macro (or include the definition with</p>
<p>#include</p>
<p>).</p>
<p>You can define the same</p>
<p>asm</p>
<p>macro multiple times (and differently) in several files.</p>
<p>The</p>
<p>asm</p>
<p>macro definition declares a return type for the macro code, specifies patterns</p>
<p>for the formal parameters, and provides bodies of code to expand when the patterns</p>
<p>match. When the compiler encounters an</p>
<p>asm</p>
<p>macro call, it replaces each use of a</p>
<p>formal parameter with an assembly language location as it expands the code body.</p>
<p>This constitutes an important difference between C functions and</p>
<p>asm</p>
<p>macros. In</p>
<p>some cases, an</p>
<p>asm</p>
<p>macro can change the values of its arguments, whereas a C</p>
<p>function can only change a copy of its arguments.</p>
<p>If you pass any of the following as an argument to an</p>
<p>asm</p>
<p>macro, the macro can</p>
<p>read and modify that argument directly:</p>
<p>â¢</p>
<p>Structures contained in registers.</p>
<p>â¢</p>
<p>Scalar variables that the compiler would not promote if passed to a function</p>
<p>without a prototype.</p>
<p>For all other types of arguments, the compiler creates a temporary variable and</p>
<p>passes that variable to the</p>
<p>asm</p>
<p>macro instead. Whenever the compiler uses a</p>
<p>temporary variable, modifying the value directly within the</p>
<p>asm</p>
<p>macro body does</p>
<p>not affect the value of the original argument. These temporary variables are eligible</p>
<p>for register allocation and are allocated to registers if the register allocator has</p>
<p>sufficient physical registers available to it:</p>
<p>â¢</p>
<p>Function names</p>
<p>â¢</p>
<p>Structures contained in memory</p>
<p>â¢</p>
<p>Structure and array elements</p>
<p>â¢</p>
<p>Compound expressions</p>
<p><i>901</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Using asm Macros</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Addresses</p>
<p>â¢</p>
<p>Scalar variables that the compiler would promote if passed to a function without</p>
<p>a prototype</p>
<p><b>Note</b></p>
<p>The compiler promotes the type of the scalar variable as if you were</p>
<p>passing it to a function without a prototype in C. The compiler does</p>
<p>this whether or not you specify the</p>
<p>asm</p>
<p>macro's parameter list in a</p>
<p>prototype form. This means that the compiler promotes variables of</p>
<p>type</p>
<p>unsigned char</p>
<p>,</p>
<p>signed char</p>
<p>,</p>
<p>signed short</p>
<p>,</p>
<p>unsigned</p>
<p>short</p>
<p>, and</p>
<p>float</p>
<p>, and then passes them to the macro through</p>
<p>temporary variables.</p>
<p>Calls to</p>
<p>asm</p>
<p>macros look exactly like normal C function calls. You can use them</p>
<p>in expressions and they can return values. The arguments to an</p>
<p>asm</p>
<p>macro can be</p>
<p>arbitrary expressions, except that they must not contain uses of the same or other</p>
<p>asm</p>
<p>macros. Return values are passed according to the target-specific calling</p>
<p>convention.</p>
<p>The following pseudo-code shows how passing addresses works:</p>
<p>asm void make10(addr)</p>
<p>{</p>
<p>%reg addr</p>
<p><i>asm_move</i> 10 -&gt;<i> temp_register</i></p>
<p><i>asm_store temp_register</i> -&gt; *addr</p>
<p>%nearmem addr</p>
<p><i>asm_load</i> addr -&gt;<i> temp_register_1</i></p>
<p><i>asm_move</i> 10 -&gt;<i> temp_register_2</i></p>
<p><i>asm_store temp_register_2</i> -&gt; *<i>temp_register_1</i></p>
<p>%error</p>
<p>}</p>
<p>void func()</p>
<p>{</p>
<p>int i, array[10];</p>
<p>make10(&amp;i);</p>
<p>make10(array);</p>
<p>make10(&amp;array[3]);</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>902</i></p>
<p><i>Chapter 18. Enhanced asm Macro Facility for C and C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Definition</b></p>
<p>The syntactic classes<i> type_specifier</i>,<i> identifier</i>, and<i> parameter_list</i> are presented in</p>
<p>the style used in C-language compilers. A syntactic description enclosed in square</p>
<p>brackets (</p>
<p>[ ]</p>
<p>) is optional, unless the right bracket is followed by</p>
<p>*</p>
<p>, which means</p>
<p>âzero or more repetitions.â For example:</p>
<p>asm [<i>type_specifier</i>]<i>identifier</i> ([<i>parameter_list</i>])</p>
<p>{</p>
<p>[<i>storage_mode_specification_line</i></p>
<p><i>asm_body</i>] *</p>
<p>}</p>
<p>An</p>
<p>asm</p>
<p>macro consists of the keyword</p>
<p>asm</p>
<p>followed by what looks like a C function</p>
<p>declaration. Inside the macro body there are zero or more pairs of</p>
<p><i>storage_mode_specification_lines</i> (patterns) and corresponding<i> asm_bodies</i>. If the</p>
<p><i>type_specifier</i> is other than</p>
<p>void</p>
<p>, the</p>
<p>asm</p>
<p>macro should return a value of the declared</p>
<p>type.</p>
<p><b>storage_mode_specification_line</b></p>
<p>% [<i>storage_mode</i> [<i>identifier</i> [,<i> identifier</i>]* ] ]*</p>
<p>A<i> storage_mode_specification_line</i> consists of a single line (no continuation with</p>
<p>the backslash character (</p>
<p>\</p>
<p>) is permitted) that begins with a percent sign (</p>
<p>%</p>
<p>) and</p>
<p>contains the names (<i>identifiers</i>) and<i> storage modes</i> of the formal parameters. Modes</p>
<p>for all formal parameters must be given in each<i> storage_mode_specification_line</i></p>
<p>(except for error). The percent sign (</p>
<p>%</p>
<p>) must be the first character on a line (including</p>
<p>whitespace). If an</p>
<p>asm</p>
<p>macro has no<i> parameter_list</i>, the</p>
<p><i>storage_mode_specification_line</i> may be omitted.</p>
<p><b>Storage Modes</b></p>
<p>These are the storage modes that the compiler recognizes in</p>
<p>asm</p>
<p>macros:</p>
<p><b>Description</b></p>
<p><b>Storage</b></p>
<p><b>mode</b></p>
<p>A compile-time constant.</p>
<p>con</p>
<p><i>903</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Definition</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Description</b></p>
<p><b>Storage</b></p>
<p><b>mode</b></p>
<p>Generates a compiler error. You can use this mode to flag errors at compile time</p>
<p>if no appropriate pattern exists for a set of actual arguments.</p>
<p>error</p>
<p>A location on the stack that is too far away to be accessed in a single instruction.</p>
<p>farsprel</p>
<p>A compiler-generated unique label. The<i> identifier(s)</i> that are specified as being of</p>
<p>mode</p>
<p>lab</p>
<p>do not appear as formal parameters in the</p>
<p>asm</p>
<p>macro definition, unlike</p>
<p>the preceding modes. Such identifiers will be expanded to be unique.</p>
<p>Example:</p>
<p>asm void check_for_bit_set(r)</p>
<p>{</p>
<p>%reg r %lab endlab</p>
<p>b_if_not_bit_set r, endlab</p>
<p>software_trap</p>
<p>endlab:</p>
<p>%error</p>
<p>}</p>
<p>void check_status(int i, int j)</p>
<p>{</p>
<p>/* Using the macro twice would cause the &quot;endlab&quot; label to be</p>
<p>* defined twice if it was not specified as unique with %lab */</p>
<p>check_for_bit_set(i);</p>
<p>check_for_bit_set(j);</p>
<p>}</p>
<p>lab</p>
<p>Matches any allowed machine addressing mode, with the exception of</p>
<p>reg</p>
<p>and</p>
<p>con</p>
<p>.</p>
<p>mem</p>
<p>A location in memory that cannot be accessed with a single load instruction. This</p>
<p>may need to be broken up into multiple instructions, and the steps for doing this</p>
<p>may depend on the compilation mode.</p>
<p>farmem</p>
<p>A location in memory that can be accessed with a single load instruction (such as</p>
<p>nearby stack variables or variables in a Small Data Area).</p>
<p>nearmem</p>
<p>A</p>
<p>treg</p>
<p>or</p>
<p>ureg</p>
<p>.</p>
<p>reg</p>
<p>A compiler-selected temporary register.</p>
<p>treg</p>
<p>A C register variable that the compiler has allocated in a machine register.</p>
<p>ureg</p>
<p><b>asm Body</b></p>
<p>The</p>
<p>asm</p>
<p>body represents the (presumed) assembly code that the compiler will</p>
<p>generate when the modes of all of the formal parameters match the associated</p>
<p>pattern. Syntactically, the</p>
<p>asm</p>
<p>body consists of the text between two pattern lines</p>
<p>that begin with a percent sign (</p>
<p>%</p>
<p>) or between the last pattern line and the right curly</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>904</i></p>
<p><i>Chapter 18. Enhanced asm Macro Facility for C and C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>brace (</p>
<p>}</p>
<p>) that ends the</p>
<p>asm</p>
<p>macro. C-language comment lines are not recognized</p>
<p>as such in the</p>
<p>asm</p>
<p>body. Instead, they are simply considered part of the text to be</p>
<p>expanded.</p>
<p>Formal parameter names may appear in any context in the</p>
<p>asm</p>
<p>body, delimited by</p>
<p>non-alphanumeric characters. For each instance of a formal parameter in the</p>
<p>asm</p>
<p>body the compiler substitutes the appropriate assembly language operand syntax</p>
<p>that will access the actual argument at run time. As an example, if one of the actual</p>
<p>arguments to an</p>
<p>asm</p>
<p>macro is</p>
<p>x</p>
<p>, an automatic variable, a string like</p>
<p>4(%fp)</p>
<p>would</p>
<p>be substituted for occurrences of the corresponding formal parameter. An important</p>
<p>consequence of this macro substitution behavior is that</p>
<p>asm</p>
<p>macros can change the</p>
<p>value of their arguments. This differs from standard C semantics.</p>
<p>For</p>
<p>lab</p>
<p>parameters, a unique label is chosen for each new expansion.</p>
<p>If an</p>
<p>asm</p>
<p>macro is declared to return a value, it must be coded to return a value of</p>
<p>the proper type in the machine register that is appropriate for the implementation.</p>
<p>An implementation restriction requires that no line in the</p>
<p>asm</p>
<p>body may start with</p>
<p>a percent sign (</p>
<p>%</p>
<p>).</p>
<p>The V850 and RH850 compiler also supports the following primitive in the body</p>
<p>of an</p>
<p>asm</p>
<p>statement:</p>
<p>%SPOFF(<i>m</i>)</p>
<p>If<i> m</i> is of the</p>
<p>farsprel</p>
<p>storage class, this expands to an integer containing its offset</p>
<p>from the stack pointer. For example:</p>
<p>%farsprel m</p>
<p>addi r3, sp, hi1(%SPOFF(m))</p>
<p>ld.w lo(%SPOFF(m)) [r3], r3</p>
<p><b>V850 and RH850 asm Macros</b></p>
<p>The following is an example of how to use</p>
<p>asm</p>
<p>macros for the V850 architecture.</p>
<p>This example shows an operand multiplied by the value 10.</p>
<p>For this example, it is assumed that constants can be loaded in a single</p>
<p>mov</p>
<p>instruction; if this is not the case, the</p>
<p>hi()</p>
<p>/</p>
<p>lo()</p>
<p>pairs must be used for the entire</p>
<p>construct. Alternatively, users can refrain from passing constants, and the</p>
<p>%error</p>
<p><i>905</i></p>
<p><i>Green Hills Software</i></p>
<p><i>V850 and RH850 asm Macros</i></p>
<h1 style="page-break-before:always; "></h1>
<p>directive can be used to check for non-conformance. Notice that</p>
<p>%farsprel</p>
<p>must</p>
<p>be handled before</p>
<p>%farmem</p>
<p>, since</p>
<p>%farmem</p>
<p>is a superset of</p>
<p>%farsprel</p>
<p>.</p>
<p>On the V850, any of the argument registers may be used as temporary (scratch)</p>
<p>registers in an</p>
<p>asm</p>
<p>macro.</p>
<p>r10</p>
<p>is the return register, so the return value is placed</p>
<p>there.</p>
<p>C preprocessor directives may not be used within an</p>
<p>asm</p>
<p>macro.</p>
<p>Also note that the number of possible cases for an</p>
<p>asm</p>
<p>macro goes up exponentially</p>
<p>with the number of general arguments.</p>
<p>asm</p>
<p>macros are designed to be used in</p>
<p>specific cases where the desired usage patterns are well understood.</p>
<p>asm int mult10(a) {</p>
<p>%reg a</p>
<p>mov a, r10</p>
<p>mulh 10, r10</p>
<p>%con a</p>
<p>mov a, r10</p>
<p>mulh 10, r10</p>
<p>%farsprel a</p>
<p>movhi hi(%SPOFF(a)), sp, r6</p>
<p>ld.w lo(%SPOFF(a))[r6], r10</p>
<p>mulh 10, r10</p>
<p>%nearmem a</p>
<p>ld.w a, r10</p>
<p>mulh 10, r10</p>
<p>%farmem a</p>
<p>movhi hi(a), r0, r6</p>
<p>ld.w lo(a)[r6], r10</p>
<p>mulh 10, r10</p>
<p>%error</p>
<p>}</p>
<p>int mem_var = 3;</p>
<p>void foo(int *proc) {</p>
<p>}</p>
<p>int main(void) {</p>
<p>int stack_var = 4;</p>
<p>int local_var = 5;</p>
<p>foo(&amp;stack_var); /* force stack_var on the stack */</p>
<p>if ((mult10(mem_var) != 30) ||</p>
<p>(mult10(stack_var) != 40) ||</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>906</i></p>
<p><i>Chapter 18. Enhanced asm Macro Facility for C and C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p>(mult10(local_var) != 50))</p>
<p>printf(&quot;Asm macro error in %s\n&quot;, __FILE__);</p>
<p>return 0;</p>
<p>}</p>
<p><b>Guidelines for Writing asm Macros</b></p>
<p>Here are some guidelines for writing</p>
<p>asm</p>
<p>macros.</p>
<p>â¢</p>
<p>Use intrinsic functions preferentially over</p>
<p>asm</p>
<p>macros. Intrinsic functions do</p>
<p>not inhibit optimizations the same way that</p>
<p>asm</p>
<p>macros may, and they are</p>
<p>easier to use.</p>
<p>â¢</p>
<p>Know the implementation. You must be familiar with the C compiler and</p>
<p>assembly language with which you are working. You can consult the</p>
<p>Application Binary Interface for your machine for the details of function calling</p>
<p>and register usage conventions.</p>
<p>â¢</p>
<p>Observe register conventions. An</p>
<p>asm</p>
<p>macro can alter temporary registers at</p>
<p>will, but the permanent registers should not be written to directly, as the</p>
<p>arguments to</p>
<p>asm</p>
<p>macros might be allocated to permanent registers. However,</p>
<p>you may write to any formal parameter, regardless of whether the compiler</p>
<p>automatically allocated it to a register. You must know in which register or</p>
<p>registers the compiler returns function results.</p>
<p>â¢</p>
<p>Handle return values.</p>
<p>asm</p>
<p>macros may âreturnâ values. That means they behave</p>
<p>as if they were actually functions that had been called via the usual function</p>
<p>call mechanism.</p>
<p>asm</p>
<p>macros must therefore mimic C's behavior in that respect,</p>
<p>returning values in the same way as normal C functions. Float and double</p>
<p>results sometimes get returned in different registers from integer results. On</p>
<p>some machine architectures, C functions return pointers in different registers</p>
<p>from those used for scalars. Finally, structures may be returned in a variety of</p>
<p>implementation-dependent ways.</p>
<p>â¢</p>
<p>Cover all cases. The</p>
<p>asm</p>
<p>macro patterns should cover all combinations of</p>
<p>storage modes of the parameters. The minimal set that covers all cases is</p>
<p>reg</p>
<p>,</p>
<p>con</p>
<p>, and</p>
<p>mem</p>
<p>. The compiler attempts to match patterns in the order of their</p>
<p>appearance in the</p>
<p>asm</p>
<p>macro definition. If the compiler encounters a storage</p>
<p>mode of</p>
<p>error</p>
<p>while attempting to find a matching pattern, it generates a</p>
<p>compile-time error for that particular</p>
<p>asm</p>
<p>macro call.</p>
<p><i>907</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Guidelines for Writing asm Macros</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>Beware of argument handling.</p>
<p>asm</p>
<p>macro arguments are used for macro</p>
<p>substitution. Thus, unlike normal C functions,</p>
<p>asm</p>
<p>macros can alter the</p>
<p>underlying values to which their arguments refer. Altering argument values</p>
<p>makes it impossible to substitute an equivalent C function call for the</p>
<p>asm</p>
<p>macro call.</p>
<p>â¢</p>
<p>asm</p>
<p>macros are inherently non-portable and implementation-dependent.</p>
<p>Although they make it easier to introduce assembly code reliably into C code,</p>
<p>the process cannot be made foolproof. You will always need to verify correct</p>
<p>behavior by inspection and testing.</p>
<p>â¢</p>
<p>Debuggers will generally have difficulty with</p>
<p>asm</p>
<p>macros. You cannot set</p>
<p>source-level breakpoints in the</p>
<p>asm</p>
<p>body.</p>
<p>â¢</p>
<p>Make sure that storage mode specification lines begin with</p>
<p>%</p>
<p>in the first column.</p>
<p>There must not be any whitespace before this character.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>908</i></p>
<p><i>Chapter 18. Enhanced asm Macro Facility for C and C++</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 19</b></p>
<p><b>GNU Extended Assembly</b></p>
<p><b>Contents</b></p>
<p>Extended GNU Support . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>910</p>
<h1 style="page-break-before:always; "></h1>
<p>GNU extended</p>
<p>asm</p>
<p>is supported through the option<b> --gnu_asm</b>.</p>
<p>Please see the online manual GCC Inline Assembly HowTo</p>
<p>[http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html] for generic</p>
<p>information concerning basic and extended assembly syntax.</p>
<p>The Green Hills compilers support most common use cases, but not all use cases</p>
<p>and constraints allowed by GNU are supported. We recommend the use of intrinsic</p>
<p>functions over the use of GNU extended</p>
<p>asm</p>
<p>statements.</p>
<p><b>Extended GNU Support</b></p>
<p>The list of target-independent format strings supported by the compiler is:</p>
<p>â¢</p>
<p>&quot;%%&quot;</p>
<p>: Outputs a single</p>
<p>'%'</p>
<p>into the assembly.</p>
<p>â¢</p>
<p>&quot;%=&quot;</p>
<p>: Outputs a number that is unique to this instantiation of the</p>
<p>asm</p>
<p>statement,</p>
<p>which is useful when creating and referring to local labels.</p>
<p>The list of target-independent constraints supported by the compiler is:</p>
<p>â¢</p>
<p>'r'</p>
<p>: Any integer register.</p>
<p>â¢</p>
<p>'f'</p>
<p>: Any float register.</p>
<p>â¢</p>
<p>'m'</p>
<p>: Any memory location.</p>
<p>â¢</p>
<p>'i'</p>
<p>: Any immediate integer (including symbolic references).</p>
<p>â¢</p>
<p>'0'</p>
<p>: Matching 0th constraint.</p>
<p>â¢</p>
<p>'1'</p>
<p>: Matching 1st constraint.</p>
<p>â¢</p>
<p>'2'</p>
<p>: Matching 2nd constraint.</p>
<p>â¢</p>
<p>'3'</p>
<p>: Matching 3rd constraint.</p>
<p>â¢</p>
<p>'4'</p>
<p>: Matching 4th constraint.</p>
<p>â¢</p>
<p>'5'</p>
<p>: Matching 5th constraint.</p>
<p>â¢</p>
<p>'6'</p>
<p>: Matching 6th constraint.</p>
<p>â¢</p>
<p>'7'</p>
<p>: Matching 7th constraint.</p>
<p>â¢</p>
<p>'8'</p>
<p>: Matching 8th constraint.</p>
<p>â¢</p>
<p>'9'</p>
<p>: Matching 9th constraint.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>910</i></p>
<p><i>Chapter 19. GNU Extended Assembly</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Besides the constraints, the constraint modifiers provide finer control over the effect</p>
<p>of the constraints. The list of available constraint modifiers is:</p>
<p>â¢</p>
<p>'='</p>
<p>: The operand is written.</p>
<p>â¢</p>
<p>'+'</p>
<p>: The operand is both read and written.</p>
<p>â¢</p>
<p>'&amp;'</p>
<p>: The operand is an early clobber operand, which is modified before the</p>
<p>instruction is finished using the input operands.</p>
<p>Within assembly text, operands are referred to by number (for example,</p>
<p>%0</p>
<p>and</p>
<p>%1</p>
<p>). The following modifiers may be added before the number to change the output</p>
<p>format of the operand:</p>
<p>â¢</p>
<p>'H'</p>
<p>: The most significant register of a 64-bit operand allocated to two 32-bit</p>
<p>registers.</p>
<p>â¢</p>
<p>'L'</p>
<p>: The least significant register of a 64-bit operand allocated to two 32-bit</p>
<p>registers.</p>
<p><b>V850 and RH850 Extended GNU Support</b></p>
<p>In addition to the target-independent constraints, a new constraint has been defined</p>
<p>for V850 and RH850:</p>
<p>â¢</p>
<p>'R'</p>
<p>: Register pair.</p>
<p><i>911</i></p>
<p><i>Green Hills Software</i></p>
<p><i>V850 and RH850 Extended GNU Support</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Chapter 20</b></p>
<p><b>The ELF File Format</b></p>
<p><b>Contents</b></p>
<p>Formats of Relocatable and Executable Files . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>914</p>
<p>32-Bit ELF Data Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>915</p>
<p>ELF Headers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>916</p>
<p>ELF Identification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>919</p>
<p>ELF Sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>921</p>
<p>Symbol</p>
<p>Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>930</p>
<p>String Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>933</p>
<p>Program Headers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>934</p>
<h1 style="page-break-before:always; "></h1>
<p>This chapter explains the formats of ELF (Executable and Linking Format) files.</p>
<p>Sections of this chapter have been reproduced with permission from UNIX System</p>
<p>Laboratories, Inc. For more information about ELF files, see<i> System V Application</i></p>
<p><i>Binary Interface</i>, 1993, UNIX System Laboratories, Inc., published by Prentice-Hall,</p>
<p>Inc.</p>
<p>This chapter deals only with the 32-bit ELF format. Programs and object files built</p>
<p>for 64-bit targets use the 64-bit ELF format, which is similar to the 32-bit format,</p>
<p>but uses larger fields to store some values. For information about the 64-bit ELF</p>
<p>format, see the Wikipedia reference page</p>
<p>[http://en.wikipedia.org/wiki/Executable_and_Linkable_Format].</p>
<p><b>Formats of Relocatable and Executable Files</b></p>
<p>ELF object files are the standard output of the compiler, assembler, and linker. An</p>
<p>ELF file can be either of the following:</p>
<p>â¢</p>
<p>a<i> relocatable object file</i> â which contains program code and data and is suitable</p>
<p>for linking with other object files.</p>
<p>â¢</p>
<p>an<i> executable file</i> â which contains a program suitable for execution.</p>
<p>The following diagram shows the differences in format between these kinds of ELF</p>
<p>files:</p>
<p><b>Executable file</b></p>
<p><b>Relocatable file</b></p>
<p>ELF Header</p>
<p>ELF Header</p>
<p>Program Header Table</p>
<p>Program Header Table</p>
<p>(<i>optional</i>)</p>
<p>Segment 1</p>
<p>Section 1</p>
<p>. . .</p>
<p>Segment 2</p>
<p>Section<i> n</i></p>
<p>. . .</p>
<p>. . .</p>
<p>. . .</p>
<p>Section Header Table</p>
<p>(<i>optional</i>)</p>
<p>Section Header Table</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>914</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Both forms of ELF file begin with an<i> ELF Header</i>, which serves as the table of</p>
<p>contents. All other data and tables in the file may appear in any order.</p>
<p>An executable file must have a<i> Program Header Table</i>, which tells the system how</p>
<p>to load the program. This component is optional in a relocatable file.</p>
<p>A relocatable file requires a<i> Section Header Table</i>, containing information about</p>
<p>its<i> sections</i> in order to be subsequently linked. Each section has an entry in the table,</p>
<p>giving information such as the section's name and size. Sections form the majority</p>
<p>of the relocatable object file, and comprise such information as instructions, data,</p>
<p>symbol table, and relocation information.</p>
<p><b>32-Bit ELF Data Types</b></p>
<p>The ELF file format supports 32-bit architectures with 8-bit bytes. It must be</p>
<p>modified for 64-bit architectures. ELF files represent some control data with a</p>
<p>machine-independent format to identify object files and interpret their contents.</p>
<p>Part of an ELF file uses the encoding of the target processor, regardless of the</p>
<p>machine on which the file was created:</p>
<p><b>Purpose</b></p>
<p><b>Alignment</b></p>
<p><b>Size</b></p>
<p><b>Type name</b></p>
<p>Unsigned program address</p>
<p>4</p>
<p>4</p>
<p>Elf32_Addr</p>
<p>Unsigned medium integer</p>
<p>2</p>
<p>2</p>
<p>Elf32_Half</p>
<p>Unsigned file offset</p>
<p>4</p>
<p>4</p>
<p>Elf32_Off</p>
<p>Signed large integer</p>
<p>4</p>
<p>4</p>
<p>Elf32_Sword</p>
<p>Unsigned large integer</p>
<p>4</p>
<p>4</p>
<p>Elf32_Word</p>
<p>Unsigned small integer</p>
<p>1</p>
<p>1</p>
<p>unsigned char</p>
<p>All data structures that the ELF file format defines follow the usual size and</p>
<p>alignment guidelines for the relevant class. If necessary, data structures contain</p>
<p>explicit padding to ensure 4-byte alignment for 4-byte objects in order to force</p>
<p>structure sizes to a multiple of 4. Data also have suitable alignment from the</p>
<p>beginning of the file. For example, a structure containing</p>
<p>Elf32_Addr</p>
<p>will be</p>
<p>aligned on a 4-byte boundary within the file.</p>
<p>For portability, ELF data structures use no bitfields.</p>
<p><i>915</i></p>
<p><i>Green Hills Software</i></p>
<p><i>32-Bit ELF Data Types</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>ELF Headers</b></p>
<p>Some ELF file control structures can grow because the ELF header contains their</p>
<p>actual sizes. If the ELF file format changes, a program may encounter control</p>
<p>structures that are larger or smaller than expected. An ELF header is set by the</p>
<p>following C structure declaration:</p>
<p>#define EI_NIDENT 16</p>
<p>typedef struct {</p>
<p>unsigned char e_ident[EI_NIDENT];</p>
<p>Elf32_Half</p>
<p>e_type;</p>
<p>Elf32_Half</p>
<p>e_machine;</p>
<p>Elf32_Word</p>
<p>e_version;</p>
<p>Elf32_Addr</p>
<p>e_entry;</p>
<p>Elf32_Off</p>
<p>e_phoff;</p>
<p>Elf32_Off</p>
<p>e_shoff;</p>
<p>Elf32_Word</p>
<p>e_flags;</p>
<p>Elf32_Half</p>
<p>e_ehsize;</p>
<p>Elf32_Half</p>
<p>e_phentsize;</p>
<p>Elf32_Half</p>
<p>e_phnum;</p>
<p>Elf32_Half</p>
<p>e_shentsize;</p>
<p>Elf32_Half</p>
<p>e_shnum;</p>
<p>Elf32_Half</p>
<p>e_shstrndx;</p>
<p>} Elf32_Ehdr;</p>
<p>The fields of</p>
<p>struct Elf32_Ehdr</p>
<p>are as follows.</p>
<p>e_ident</p>
<p>Identifies the file as an ELF file and provides machine-independent data to decode the contents.</p>
<p>For more information, see âELF Identificationâ on page 919.</p>
<p>e_type</p>
<p>Identifies the ELF file type. Permitted values are as follows:</p>
<p>â¢</p>
<p>0</p>
<p>(</p>
<p>ET_NONE</p>
<p>): No file type</p>
<p>â¢</p>
<p>1</p>
<p>(</p>
<p>ET_REL</p>
<p>): Relocatable file</p>
<p>â¢</p>
<p>2</p>
<p>(</p>
<p>ET_EXEC</p>
<p>): Executable file</p>
<p>â¢</p>
<p>0xFF00</p>
<p>(</p>
<p>ET_LOPROC</p>
<p>): Begin processor-specific range</p>
<p>â¢</p>
<p>0xFFFF</p>
<p>(</p>
<p>ET_HIPROC</p>
<p>): End processor-specific range</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>916</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p>e_machine</p>
<p>Specifies the target architecture for an individual file. Permitted values are as follows:</p>
<p>â¢</p>
<p>0</p>
<p>(</p>
<p>EM_NONE</p>
<p>): Invalid machine</p>
<p>â¢</p>
<p>2</p>
<p>(</p>
<p>EM_SPARC</p>
<p>): Sun SPARC</p>
<p>â¢</p>
<p>3</p>
<p>(</p>
<p>EM_386</p>
<p>): Intel 80386</p>
<p>â¢</p>
<p>4</p>
<p>(</p>
<p>EM_68K</p>
<p>): Freescale 68000</p>
<p>â¢</p>
<p>6</p>
<p>(</p>
<p>EM_486</p>
<p>): Intel 80486</p>
<p>â¢</p>
<p>8</p>
<p>(</p>
<p>EM_MIPS</p>
<p>): MIPS</p>
<p>â¢</p>
<p>19</p>
<p>(</p>
<p>EM_960</p>
<p>): Intel i960</p>
<p>â¢</p>
<p>20</p>
<p>(</p>
<p>EM_PPC</p>
<p>): Power Architecture</p>
<p>â¢</p>
<p>21</p>
<p>(</p>
<p>EM_PPC64</p>
<p>): Power Architecture 64-bit mode</p>
<p>â¢</p>
<p>36</p>
<p>(</p>
<p>EM_V800</p>
<p>): Renesas V800 series</p>
<p>â¢</p>
<p>37</p>
<p>(</p>
<p>EM_FR20</p>
<p>): Fujitsu FR</p>
<p>â¢</p>
<p>39</p>
<p>(</p>
<p>EM_MCORE</p>
<p>): Freescale MCore</p>
<p>â¢</p>
<p>40</p>
<p>(</p>
<p>EM_ARM</p>
<p>): ARM</p>
<p>â¢</p>
<p>42</p>
<p>(</p>
<p>EM_SH</p>
<p>): Hitachi SH</p>
<p>â¢</p>
<p>44</p>
<p>(</p>
<p>EM_TRICORE</p>
<p>): Infineon TriCore</p>
<p>â¢</p>
<p>52</p>
<p>(</p>
<p>EM_COLDFIRE</p>
<p>): Freescale ColdFire</p>
<p>â¢</p>
<p>58</p>
<p>(</p>
<p>EM_STARCORE</p>
<p>): Freescale StarCore</p>
<p>â¢</p>
<p>78</p>
<p>(</p>
<p>EM_FIREPATH</p>
<p>): Broadcom FirePath</p>
<p>â¢</p>
<p>88</p>
<p>(</p>
<p>EM_M32R</p>
<p>): Renesas M32R</p>
<p>â¢</p>
<p>106</p>
<p>(</p>
<p>EM_BLACKFIN</p>
<p>): ADI Blackfin</p>
<p>e_version</p>
<p>Identifies the ELF file version. Permitted values are as follows:</p>
<p>â¢</p>
<p>0</p>
<p>(</p>
<p>EV_NONE</p>
<p>): Invalid version</p>
<p>â¢</p>
<p>1</p>
<p>(</p>
<p>EV_CURRENT</p>
<p>): Current version</p>
<p>The value</p>
<p>1</p>
<p>(one) signifies the original file format; extensions will create new versions with</p>
<p>higher numbers.</p>
<p>e_entry</p>
<p>Specifies the virtual address to which the system first transfers control upon starting the process.</p>
<p>If the file has no associated entry point, this field contains the value zero.</p>
<p><i>917</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ELF Headers</i></p>
<h1 style="page-break-before:always; "></h1>
<p>e_phoff</p>
<p>Specifies the program header table's file offset in bytes. If the file has no program header table,</p>
<p>this field contains the value zero.</p>
<p>e_shoff</p>
<p>Specifies the section header table's file offset in bytes. If the file has no section header table,</p>
<p>this field contains the value zero.</p>
<p>e_flags</p>
<p>Specifies processor-specific flags associated with the file. Flag names take the form</p>
<p>EF<i>_machine_flag</i></p>
<p>.</p>
<p>â¢</p>
<p>0x20000000</p>
<p>(</p>
<p>EF_V800_850</p>
<p>): V850 processor</p>
<p>â¢</p>
<p>0x10000000</p>
<p>(</p>
<p>EF_V800_850E</p>
<p>): V850E processor</p>
<p>â¢</p>
<p>0x04000000</p>
<p>(</p>
<p>EF_V800_850F</p>
<p>): V850E1F processor</p>
<p>â¢</p>
<p>0x02000000</p>
<p>(</p>
<p>EF_V800_850E2</p>
<p>): V850E2 processor</p>
<p>â¢</p>
<p>0x00000800</p>
<p>(</p>
<p>EF_V800_850E_16</p>
<p>): V850E2 processor</p>
<p>e_ehsize</p>
<p>Specifies the ELF header size in bytes.</p>
<p>e_phentsize</p>
<p>Specifies the size in bytes of one entry in the file's program header table; all entries are the same</p>
<p>size.</p>
<p>e_phnum</p>
<p>Specifies the number of entries in the program header table. The product of</p>
<p>e_phentsize</p>
<p>and</p>
<p>e_phnum</p>
<p>specifies the table's size in bytes. If a file has no program header table,</p>
<p>e_phnum</p>
<p>contains the value zero.</p>
<p>e_shentsize</p>
<p>Specifies the section header's size in bytes. A section header is one entry in the section header</p>
<p>table; all entries are the same size.</p>
<p>e_shnum</p>
<p>Specifies the number of entries in the section header table. The product of</p>
<p>e_shentsize</p>
<p>and</p>
<p>e_shnum</p>
<p>specifies the section header table's size in bytes. If a file has no section header table,</p>
<p>this field contains the value zero.</p>
<p>e_shstrndx</p>
<p>Specifies the index of the section containing the string table used for section names. By</p>
<p>convention, this is the section</p>
<p>.shstrtab</p>
<p>. If the file has no section name string table, this field</p>
<p>contains the value</p>
<p>SHN_UNDEF</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>918</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>ELF Identification</b></p>
<p>ELF provides a file framework to support multiple processors, multiple data</p>
<p>encodings, and multiple classes of machines. To support this file family, the initial</p>
<p>bytes of the file specify how to interpret the file, independent of the processor on</p>
<p>which the inquiry is made and independent of the file's remaining contents.</p>
<p>The initial bytes of an ELF header correspond to the</p>
<p>e_ident</p>
<p>member. The</p>
<p>identification indexes are tabulated below:</p>
<p><b>Meaning</b></p>
<p><b>Value</b></p>
<p><b>Index name</b></p>
<p>File identification</p>
<p>0</p>
<p>to</p>
<p>3</p>
<p>EI_MAG0</p>
<p>to</p>
<p>EI_MAG3</p>
<p>File class</p>
<p>4</p>
<p>EI_CLASS</p>
<p>Data encoding</p>
<p>5</p>
<p>EI_DATA</p>
<p>File version</p>
<p>6</p>
<p>EI_VERSION</p>
<p>Start of padding bytes</p>
<p>7</p>
<p>EI_PAD</p>
<p>Size of</p>
<p>e_ident[]</p>
<p>16</p>
<p>EI_NIDENT</p>
<p>These indexes access bytes that contain the following values:</p>
<p>EI_MAG0</p>
<p>to</p>
<p>EI_MAG3</p>
<p>A file's first 4 bytes identify the file as ELF as follows:</p>
<p>â¢</p>
<p>e_ident[EI_MAG0]</p>
<p>:</p>
<p>0x7F</p>
<p>(</p>
<p>ELFMAG0</p>
<p>)</p>
<p>â¢</p>
<p>e_ident[EI_MAG1]</p>
<p>:</p>
<p>'E'</p>
<p>(</p>
<p>ELFMAG1</p>
<p>)</p>
<p>â¢</p>
<p>e_ident[EI_MAG2]</p>
<p>:</p>
<p>'L'</p>
<p>(</p>
<p>ELFMAG2</p>
<p>)</p>
<p>â¢</p>
<p>e_ident[EI_MAG3]</p>
<p>:</p>
<p>'F'</p>
<p>(</p>
<p>ELFMAG3</p>
<p>)</p>
<p><i>919</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ELF Identification</i></p>
<h1 style="page-break-before:always; "></h1>
<p>EI_CLASS</p>
<p>This byte identifies the file's class, or capacity. The file format is portable among machines of</p>
<p>various sizes; it does not impose the size of the largest machine on the smallest. Permitted values</p>
<p>are as follows:</p>
<p>â¢</p>
<p>0</p>
<p>(</p>
<p>ELFCLASSNONE</p>
<p>): Invalid class</p>
<p>â¢</p>
<p>1</p>
<p>(</p>
<p>ELFCLASS32</p>
<p>): 32-bit objects. Supports machines with files and virtual address spaces</p>
<p>up to 4 Gigabytes. It uses the basic types defined above.</p>
<p>â¢</p>
<p>2</p>
<p>(</p>
<p>ELFCLASS64</p>
<p>): 64-bit objects. Reserved for 64-bit architectures. Its appearance here</p>
<p>shows how the file format may change, but the 64-bit format is otherwise unspecified.</p>
<p>Other classes are defined as necessary, with different basic types and sizes for file data.</p>
<p>EI_DATA</p>
<p>This byte specifies the data encoding of the processor-specific data in the file. Permitted values</p>
<p>are as follows:</p>
<p>â¢</p>
<p>0</p>
<p>(</p>
<p>ELFDATANONE</p>
<p>): Invalid data encoding</p>
<p>â¢</p>
<p>1</p>
<p>(</p>
<p>ELFDATA2LSB</p>
<p>): Specifies 2's complement values, with the least significant byte</p>
<p>occupying the lowest address.</p>
<p>â¢</p>
<p>2</p>
<p>(</p>
<p>ELFDATA2MSB</p>
<p>): Specifies 2's complement values, with the most significant byte</p>
<p>occupying the lowest address.</p>
<p>Other values are reserved and are assigned to new encodings as necessary.</p>
<p>EI_VERSION</p>
<p>This byte specifies the ELF header version number. Currently, this value must be</p>
<p>EV_CURRENT</p>
<p>,</p>
<p>as explained above for</p>
<p>e_version</p>
<p>.</p>
<p>EI_PAD</p>
<p>This value marks the beginning of the unused bytes in</p>
<p>e_ident</p>
<p>. These bytes are reserved and</p>
<p>set to zero; programs that read ELF files should ignore them. The value of</p>
<p>EI_PAD</p>
<p>changes if</p>
<p>currently unused bytes are given meanings.</p>
<p>EI_NIDENT</p>
<p>This value specifies the size of</p>
<p>e_ident[]</p>
<p>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>920</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>ELF Sections</b></p>
<p><b>Section Headers</b></p>
<p>You can use an ELF file's section header table to locate all the file's sections. The</p>
<p>section header table is an array of Elf32_Shdr structures. A section header table</p>
<p>index is a subscript into this array. The ELF header</p>
<p>e_shoff</p>
<p>specifies the byte</p>
<p>offset from the beginning of the file to the section header table;</p>
<p>e_shnum</p>
<p>tells how</p>
<p>many entries the section header table contains; and</p>
<p>e_shentsize</p>
<p>specifies the size</p>
<p>in bytes of each entry.</p>
<p>Sections contain all information in a file except the ELF header, the program header</p>
<p>table, and the section header table. Sections satisfy several conditions:</p>
<p>â¢</p>
<p>Every section in an ELF file has exactly one section header describing it. Section</p>
<p>headers may exist that do not have an associated section.</p>
<p>â¢</p>
<p>Each section occupies one contiguous (possibly empty) sequence of bytes</p>
<p>within a file.</p>
<p>â¢</p>
<p>Sections in a file may not overlap. No byte in a file resides in more than one</p>
<p>section.</p>
<p>â¢</p>
<p>An ELF file may have inactive space. The various headers and the sections</p>
<p>might not account for every byte in a file. The contents of the inactive space</p>
<p>are unspecified.</p>
<p>A section header has the following structure:</p>
<p>typedef struct {</p>
<p>Elf32_Word sh_name;</p>
<p>Elf32_Word sh_type;</p>
<p>Elf32_Word sh_flags;</p>
<p>Elf32_Addr sh_addr;</p>
<p>Elf32_Off</p>
<p>sh_offset;</p>
<p>Elf32_Word sh_size;</p>
<p>Elf32_Word sh_link;</p>
<p>Elf32_Word sh_info;</p>
<p>Elf32_Word sh_addralign;</p>
<p>Elf32_Word sh_entsize;</p>
<p>} Elf32_Shdr;</p>
<p><i>921</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ELF Sections</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The fields of struct Elf32_Shdr are as follows.</p>
<p>sh_name</p>
<p>Specifies the name of the section. Its value is an index into the section header string table section</p>
<p>and specifies the location of a null-terminated string.</p>
<p>sh_type</p>
<p>Specifies the section's contents and semantics. For more information, see âSection Attribute</p>
<p>Flagsâ on page 924.</p>
<p>sh_flags</p>
<p>Specifies 1-bit flags that describe miscellaneous attributes of the section.</p>
<p>sh_addr</p>
<p>Specifies the address at which the section's first byte should reside if the section appears in the</p>
<p>memory image of a process. Otherwise, this field contains zero.</p>
<p>sh_offset</p>
<p>Specifies the byte offset from the beginning of the file to the first byte in the section.</p>
<p>sh_size</p>
<p>Specifies the section's size in bytes. Unless the section type is</p>
<p>SHT_NOBITS</p>
<p>, the section occupies</p>
<p>sh_size</p>
<p>bytes in the file. A section of type</p>
<p>SHT_NOBITS</p>
<p>may have a non-zero size, but it</p>
<p>occupies no space in the file.</p>
<p>sh_link</p>
<p>Contains a section header table index link, whose interpretation depends on the section type.</p>
<p>sh_info</p>
<p>Contains extra information, whose interpretation depends on the section type.</p>
<p>sh_addralign</p>
<p>Some sections have address alignment constraints. For example, if a section contains a</p>
<p>doubleword, the system may need to ensure doubleword alignment for the entire section. That</p>
<p>is, the value of</p>
<p>sh_addr</p>
<p>must be equal to</p>
<p>0</p>
<p>(zero), modulo the value of</p>
<p>sh_addralign</p>
<p>.</p>
<p>Currently, only</p>
<p>0</p>
<p>(zero) and positive integral powers of two are allowed. The values</p>
<p>0</p>
<p>(zero)</p>
<p>and</p>
<p>1</p>
<p>(one) mean the section has no alignment constraints.</p>
<p>sh_entsize</p>
<p>Some sections contain a table of fixed-size entries, such as a symbol table. For such sections,</p>
<p>this field specifies the size in bytes of each entry. This structure contains zero if the section does</p>
<p>not contain a table of fixed-sized entries.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>922</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Special Section Indexes</b></p>
<p>Symbol table entries index the section table through the</p>
<p>st_shndx</p>
<p>field. See</p>
<p>âSymbol Tablesâ on page 930.</p>
<p><b>Meaning</b></p>
<p><b>Value</b></p>
<p><b>Name</b></p>
<p>A meaningless section. A symbol âdefinedâ relative</p>
<p>to this section is an undefined symbol.</p>
<p>0</p>
<p>SHN_UNDEF</p>
<p>Common, or</p>
<p>.bss</p>
<p>, symbols are allocated space in</p>
<p>this section.</p>
<p>-14</p>
<p>SHN_COMMON</p>
<p>Contents of the section are absolute values; they are</p>
<p>not affected by relocation.</p>
<p>-15</p>
<p>SHN_ABS</p>
<p>Not available for all processors. Similar to</p>
<p>SHN_COMMON</p>
<p>, but for a limited number of small</p>
<p>variables allocated to SDA.</p>
<p>-256</p>
<p>SHN_GHS_SMALLCOMMON</p>
<p>Not available for all processors. Similar to</p>
<p>SHN_COMMON</p>
<p>, but for a limited number of small</p>
<p>variables allocated to ZDA.</p>
<p>-255</p>
<p>SHN_GHS_ZERO_COMMON</p>
<p>Not available for all processors. Similar to</p>
<p>SHN_COMMON</p>
<p>, but for a limited number of small</p>
<p>variables allocated to TDA.</p>
<p>-254</p>
<p>SHN_GHS_TINYCOMMON</p>
<p><b>Note</b></p>
<p>Although index</p>
<p>0</p>
<p>is reserved as an undefined value, the section header</p>
<p>table does contain an entry for it.</p>
<p><b>Section Types</b></p>
<p>A section header's</p>
<p>sh_type</p>
<p>specifies the section's semantics as follows:</p>
<p><b>Meaning</b></p>
<p><b>Value</b></p>
<p><b>Name</b></p>
<p>Marks the section header as inactive. It does not have an</p>
<p>associated section. Other members of the section header have</p>
<p>undefined values.</p>
<p>0</p>
<p>SHT_NULL</p>
<p>Contains information defined by the program that created</p>
<p>the ELF file, whose format and meaning are determined</p>
<p>solely by the program.</p>
<p>1</p>
<p>SHT_PROGBITS</p>
<p><i>923</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Section Headers</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Meaning</b></p>
<p><b>Value</b></p>
<p><b>Name</b></p>
<p>Contains a symbol table. An object file may have only one</p>
<p>section of this type, but this restriction may be relaxed in the</p>
<p>future. The table provides symbols for link editing, though</p>
<p>it may also be used for dynamic linking. As a complete</p>
<p>symbol table, it may contain many symbols unnecessary for</p>
<p>dynamic linking.</p>
<p>2</p>
<p>SHT_SYMTAB</p>
<p>Contains a string table. A file may have multiple string table</p>
<p>sections.</p>
<p>3</p>
<p>SHT_STRTAB</p>
<p>Contains relocation entries with explicit</p>
<p>addends</p>
<p>, such as</p>
<p>type</p>
<p>Elf32_Rela</p>
<p>for the 32-bit class of ELF files. A file</p>
<p>may have multiple relocation sections.</p>
<p>4</p>
<p>SHT_RELA</p>
<p>Contains notes that flag this ELF file indicating certain</p>
<p>properties.</p>
<p>7</p>
<p>SHT_NOTE</p>
<p>Occupies no space in the file but otherwise resembles</p>
<p>SHT_PROGBITS</p>
<p>.</p>
<p>8</p>
<p>SHT_NOBITS</p>
<p>Contains relocation entries without explicit</p>
<p>addends</p>
<p>, such</p>
<p>as type</p>
<p>Elf32_Rel</p>
<p>for the 32-bit class of ELF files. A file</p>
<p>may have multiple relocation sections.</p>
<p>9</p>
<p>SHT_REL</p>
<p><b>Section Attribute Flags</b></p>
<p>A section header's</p>
<p>sh_flags</p>
<p>field contains 1-bit flags that describe the section's</p>
<p>attributes.</p>
<p><b>Meaning</b></p>
<p><b>Value</b></p>
<p><b>Name</b></p>
<p>Contains data that should be writable during process</p>
<p>execution.</p>
<p>0x1</p>
<p>SHF_WRITE</p>
<p>Occupies memory during process execution. Some control</p>
<p>sections do not reside in the memory image of the final</p>
<p>application; this attribute is off for those sections.</p>
<p>0x2</p>
<p>SHF_ALLOC</p>
<p>Contains execution machine instructions.</p>
<p>0x4</p>
<p>SHF_EXECINSTR</p>
<p>Has an absolute, non-relocatable address.</p>
<p>0x400</p>
<p>SHF_GHS_ABS</p>
<p>Two structures in the section header,</p>
<p>sh_link</p>
<p>and</p>
<p>sh_info</p>
<p>, contain special</p>
<p>information, depending on section type as follows:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>924</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>sh_info</b></p>
<p><b>sh_link</b></p>
<p><b>sh_type</b></p>
<p>The section header index of the</p>
<p>section to which the relocation</p>
<p>applies.</p>
<p>The section header index of the</p>
<p>associated symbol table.</p>
<p>SHT_REL</p>
<p>SHT_RELA</p>
<p>One greater than the symbol table</p>
<p>index of the last local symbol</p>
<p>(binding</p>
<p>STB_LOCAL</p>
<p>).</p>
<p>The section header index of the</p>
<p>associated string table.</p>
<p>SHT_SYMTAB</p>
<p>0</p>
<p>SHN_UNDEF</p>
<p><i>other</i></p>
<p><b>Section Names</b></p>
<p>Section names beginning with a period (</p>
<p>.</p>
<p>) are not meant for general use by</p>
<p>application programs, although application programs may use these sections if their</p>
<p>existing meanings are satisfactory. Application programs may use names without</p>
<p>the leading period to avoid conflicts with predefined section names.</p>
<p><b>Frequently Used Sections</b></p>
<p>Some sections contain program and control information. Sections in the following</p>
<p>list have predefined meanings, with the indicated types and attributes.</p>
<p>.bss</p>
<p>Contains uninitialized data that contributes to the program's memory image. The system initializes</p>
<p>the data with zeros when the program begins to run.</p>
<p>Type:</p>
<p>SHT_NOBITS</p>
<p>Attributes:</p>
<p>SHF_ALLOC | SHF_WRITE</p>
<p>.data</p>
<p>Contains initialized data that contributes to the program's memory image.</p>
<p>Type:</p>
<p>SHT_PROGBITS</p>
<p>Attributes:</p>
<p>SHF_ALLOC | SHF_WRITE</p>
<p><i>925</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Section Headers</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.linfix</p>
<p>When using Code Factoring or fixing âout of range relocationsâ inline, the assembly becomes</p>
<p>out of sync with the debugging information. The linker notes the changes to the program that</p>
<p>require updates to the debugging information in the</p>
<p>.linfix</p>
<p>section. MULTI merges the</p>
<p>information in the</p>
<p>.dla</p>
<p>file and the</p>
<p>.linfix</p>
<p>section when debugging the program.</p>
<p>The</p>
<p>.linfix</p>
<p>section is not downloaded to the target.</p>
<p>Type:</p>
<p>SHT_PROGBITS</p>
<p>Attributes: None</p>
<p>.rel<i>name</i></p>
<p>.rela<i>name</i></p>
<p>These sections contain relocation information. Conventionally,<i> name</i> is supplied by the section</p>
<p>to which the relocations apply. A relocation section for</p>
<p>.text</p>
<p>has the name</p>
<p>.rel.text</p>
<p>or</p>
<p>.rela.text</p>
<p>.</p>
<p>Types:</p>
<p>SHT_REL</p>
<p>and</p>
<p>SHT_RELA</p>
<p>Attributes: none</p>
<p>.rodata</p>
<p>Read-only data area. Similar to the</p>
<p>.data</p>
<p>section, but composed of constant data.</p>
<p>Type:</p>
<p>SHT_PROGBITS</p>
<p>Attributes:</p>
<p>SHF_ALLOC</p>
<p>.shstrtab</p>
<p>Contains section names.</p>
<p>Type:</p>
<p>SHT_STRTAB</p>
<p>Attributes: None</p>
<p>.strtab</p>
<p>Contains strings, most commonly the strings that represent the names associated with symbol</p>
<p>table entries.</p>
<p>Type:</p>
<p>SHT_STRTAB</p>
<p>Attributes: none</p>
<p>.symtab</p>
<p>Contains a symbol table.</p>
<p>Type:</p>
<p>SHT_SYMTAB</p>
<p>Attributes: none</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>926</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.text</p>
<p>Contains the âtextâ, or executable instructions, of a program.</p>
<p>Type:</p>
<p>SHT_PROGBITS</p>
<p>Attributes:</p>
<p>SHF_ALLOC | SHF_EXECINSTR</p>
<p>Some sections are specific to Green Hills ELF; these are listed in the following</p>
<p>table. Target processors may support some or all of these sections.</p>
<p>.syscall</p>
<p>A program code section to support the Green Hills system call mechanism.</p>
<p>Type:</p>
<p>SHT_PROGBITS</p>
<p>Attributes:</p>
<p>SHF_EXECINSTR | SHF_ALLOC</p>
<p>.secinfo</p>
<p>A table, created by the linker, that describes actions to be taken on sections as they are loaded</p>
<p>for program execution (sections to be cleared, copied from ROM to RAM, and so on).</p>
<p>Type:</p>
<p>SHT_PROGBITS</p>
<p>Attributes:</p>
<p>SHF_ALLOC</p>
<p>.fixaddr</p>
<p>.fixtype</p>
<p>Tables created by the compiler for position independent code (PIC) and position independent</p>
<p>data (PID) static pointer adjustments to be made when the program is loaded for execution.</p>
<p>Type:</p>
<p>SHT_PROGBITS</p>
<p>Attributes:</p>
<p>SHF_ALLOC</p>
<p>.sdabase</p>
<p>If not in PID mode, the run-time system initializes the Small Data Area (SDA) base register to</p>
<p>be the address of this section (</p>
<p>.sdabase</p>
<p>).</p>
<p>Type:</p>
<p>SHT_NULL</p>
<p>Attributes:</p>
<p>SHF_ALLOC</p>
<p><i>927</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Section Headers</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.sdata</p>
<p>Initialized Small Data Area</p>
<p>.zdata</p>
<p>Initialized Zero Data Area.</p>
<p>Similar to the</p>
<p>.data</p>
<p>section, but of limited size and more efficiently addressed.</p>
<p>Type:</p>
<p>SHT_PROGBITS</p>
<p>Attributes:</p>
<p>SHF_ALLOC | SHF_WRITE</p>
<p>.sbss</p>
<p>Uninitialized Small Data Area.</p>
<p>.zbss</p>
<p>Uninitialized Zero Data Area.</p>
<p>Similar to the</p>
<p>.bss</p>
<p>section, but of limited size and more efficiently addressed.</p>
<p>Type:</p>
<p>SHT_PROGBITS</p>
<p>Attributes:</p>
<p>SHF_ALLOC | SHF_WRITE</p>
<p>.heap</p>
<p>Section describing the area of memory for dynamic allocations through</p>
<p>malloc</p>
<p>and related</p>
<p>functions.</p>
<p>Type:</p>
<p>SHT_NOBITS</p>
<p>Attributes:</p>
<p>SHF_ALLOC | SHF_WRITE</p>
<p>.stack</p>
<p>Section describing the area of memory that the program stack will occupy.</p>
<p>Type:</p>
<p>SHT_NOBITS</p>
<p>Attributes:</p>
<p>SHF_ALLOC | SHF_WRITE</p>
<p><b>Relocation Types</b></p>
<p>Relocation entries contain this information. There are two forms of relocation entries,</p>
<p>corresponding to</p>
<p>SHT_REL</p>
<p>and</p>
<p>SHT_RELA</p>
<p>sections. Relocations can have offsets</p>
<p>called</p>
<p>addends</p>
<p>from the symbols being referenced by the</p>
<p>ELF32_R_SYM()</p>
<p>information in</p>
<p>r_info</p>
<p>. In</p>
<p>SHT_REL</p>
<p>, the</p>
<p>addends</p>
<p>are encoded in the instruction</p>
<p>or data fields of the location referenced by the</p>
<p>r_offset</p>
<p>field. In</p>
<p>SHT_RELA</p>
<p>, each</p>
<p>relocation entry contains a dedicated</p>
<p>r_addend</p>
<p>field. The</p>
<p>SHT_RELA</p>
<p>format is</p>
<p>preferred because it simplifies the interpretation of relocations, as well as allows</p>
<p>offsets that are greater than the fields can contain.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>928</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example 20.1. A Relocation Entry Corresponding to SHT_REL</b></p>
<p>typedef struct {</p>
<p>Elf32_Addr r_offset;</p>
<p>Elf32_Word r_info;</p>
<p>} Elf32_Rel;</p>
<p><b>Example 20.2. A Relocation Entry Corresponding to SHT_RELA</b></p>
<p>typedef struct {</p>
<p>Elf32_Addr r_offset;</p>
<p>Elf32_Word r_info;</p>
<p>Elf32_Sword r_addend;</p>
<p>} Elf32_Rela;</p>
<p>r_offset</p>
<p>Specifies the location at which to apply the relocation action. For a relocatable file, the value</p>
<p>is the byte offset from the beginning of the section to the storage unit affected by the relocation.</p>
<p>For an executable file or a shared object, the value of which is the virtual address of the storage</p>
<p>unit affected by the relocation.</p>
<p>r_info</p>
<p>Specifies both the symbol table index with respect to which the relocation must be made and</p>
<p>the type of relocation to apply information for a process's program image. For example, a call</p>
<p>instruction's relocation entry contains the symbol table index of the function being called. You</p>
<p>may find the following macros helpful when reading from or writing to the</p>
<p>r_info</p>
<p>field:</p>
<p>#define ELF32_R_SYM(i)</p>
<p>((i) &gt;&gt; 8)</p>
<p>#define ELF32_R_TYPE(i)</p>
<p>((unsigned char) (i))</p>
<p>#define ELF32_R_INFO(s,t) (((s)&lt;&lt;8) + (unsigned char) (t))</p>
<p>r_addend</p>
<p>Specifies a constant value used to compute the final value to be stored into the relocatable field.</p>
<p>A relocation section references two other sections: a symbol table and a section to</p>
<p>modify. The section header's</p>
<p>sh_link</p>
<p>and</p>
<p>sh_info</p>
<p>specify these sections.</p>
<p><i>929</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Section Headers</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Symbol Tables</b></p>
<p>The symbol table of an ELF file contains information to locate and relocate a</p>
<p>program's symbolic definitions and references. A symbol table index is a subscript</p>
<p>into this array. Index</p>
<p>0</p>
<p>(zero) both designates the first entry in the table and serves</p>
<p>as the undefined symbol index. The contents of the initial entry are specified below.</p>
<p>A symbol table entry has the following format:</p>
<p>typedef struct {</p>
<p>Elf32_Word</p>
<p>st_name;</p>
<p>Elf32_Addr</p>
<p>st_value;</p>
<p>Elf32_Word</p>
<p>st_size;</p>
<p>unsigned char st_info;</p>
<p>unsigned char st_other;</p>
<p>Elf32_Half</p>
<p>st_shndx;</p>
<p>} Elf32_Sym;</p>
<p>where:</p>
<p>st_name</p>
<p>Contains an index into the file's symbol string table. The string table contains the character</p>
<p>representations of the symbol names. If this field is non-zero, then it represents a string table</p>
<p>index that specifies the symbol name. Otherwise, the symbol table entry has no name.</p>
<p>st_value</p>
<p>Specifies the associated symbol's value. Depending on the context, this may be an absolute</p>
<p>value, an address, and so on.</p>
<p>st_size</p>
<p>Many symbols have associated sizes. For example, a data object's size is the number of bytes</p>
<p>contained in the object. This field is zero if the symbol has no size or an unknown size.</p>
<p>st_info</p>
<p>Specifies the symbol's binding attributes and type, as explained in the symbol binding and</p>
<p>symbol type sections below. The values and meanings are defined below:</p>
<p>#define ELF32_ST_BIND(i)</p>
<p>((i)&gt;&gt;4)</p>
<p>#define ELF32_ST_TYPE(i)</p>
<p>((i)&amp;0xf)</p>
<p>#define ELF32_ST_INFO(b,t)</p>
<p>(((b)&lt;&lt;4)+((t)&amp;0xf))</p>
<p>st_other</p>
<p>Contains the value zero and has no defined meaning.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>930</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p>st_shndx</p>
<p>Every symbol table entry is âdefinedâ in relation to some section; this field contains the relevant</p>
<p>section header table index. Some section indexes indicate special meanings. For more information,</p>
<p>see âSpecial Section Indexesâ on page 923.</p>
<p><b>Symbol Binding</b></p>
<p>A symbol's binding determines the linkage visibility and behavior.</p>
<p><b>Attributes</b></p>
<p><b>Value</b></p>
<p><b>Name</b></p>
<p>Local symbols are not visible outside the object file containing their</p>
<p>definition. Local symbols of the same name may exist in multiple</p>
<p>files without interfering with each other.</p>
<p>0</p>
<p>STB_LOCAL</p>
<p>Global symbols are visible to all object files being combined. One</p>
<p>file's definition of a global symbol will satisfy another file's</p>
<p>undefined reference to the same global symbol.</p>
<p>1</p>
<p>STB_GLOBAL</p>
<p>Weak symbols resemble global symbols, but their definitions have</p>
<p>lower precedence.</p>
<p>2</p>
<p>STB_WEAK</p>
<p>Values in this inclusive range (from</p>
<p>STB_LOPROC</p>
<p>to</p>
<p>STB_HIPROC</p>
<p>)</p>
<p>are reserved for processor-specific semantics. If meanings are</p>
<p>specified, the processor supplement explains them.</p>
<p>13</p>
<p>STB_LOPROC</p>
<p>15</p>
<p>STB_HIPROC</p>
<p><b>Symbol Type</b></p>
<p>A symbol's type provides a general classification for the associated entity.</p>
<p><b>Attributes</b></p>
<p><b>Value</b></p>
<p><b>Name</b></p>
<p>The symbol's type is not specified.</p>
<p>0</p>
<p>STT_NOTYPE</p>
<p>The symbol is associated with a data object, such as a variable,</p>
<p>array, and so on.</p>
<p>1</p>
<p>STT_OBJECT</p>
<p>The symbol is associated with a function or other executable.</p>
<p>2</p>
<p>STT_FUNC</p>
<p>The symbol is associated with a section. Symbol table entries of</p>
<p>this type exist primarily for relocation and normally have</p>
<p>STB_LOCAL</p>
<p>binding.</p>
<p>3</p>
<p>STT_SECTION</p>
<p>By convention, this symbol names the source file associated with</p>
<p>the object file. For this symbol, the binding is</p>
<p>STB_LOCAL</p>
<p>and the</p>
<p>section index is</p>
<p>SHN_ABS</p>
<p>. All</p>
<p>STT_FILE</p>
<p>symbols precede any</p>
<p>other</p>
<p>STB_LOCAL</p>
<p>symbols.</p>
<p>4</p>
<p>STT_FILE</p>
<p><i>931</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Symbol Binding</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Attributes</b></p>
<p><b>Value</b></p>
<p><b>Name</b></p>
<p>Values in this inclusive range (from</p>
<p>STT_LOPROC</p>
<p>to</p>
<p>STT_HIPROC</p>
<p>)</p>
<p>are reserved for processor-specific semantics. If meanings are</p>
<p>specified, the processor supplement explains them.</p>
<p>13</p>
<p>STT_LOPROC</p>
<p>15</p>
<p>STT_HIPROC</p>
<p><b>Symbol Values</b></p>
<p>Symbol table entries for different ELF file types have slightly different interpretations</p>
<p>for the</p>
<p>st_value</p>
<p>member:</p>
<p>â¢</p>
<p>In relocatable files,</p>
<p>st_value</p>
<p>contains alignment constraints for a symbol</p>
<p>whose section index is</p>
<p>SHN_COMMON.</p>
<p>â¢</p>
<p>In relocatable files,</p>
<p>st_value</p>
<p>contains a section offset for a defined symbol.</p>
<p>That is,</p>
<p>st_value</p>
<p>is an offset from the beginning of the section that</p>
<p>st_shndx</p>
<p>identifies.</p>
<p>â¢</p>
<p>In executable files,</p>
<p>st_value</p>
<p>contains a virtual address. To make these symbols</p>
<p>more useful for the dynamic linker, the section offset (file interpretation) gives</p>
<p>way to a virtual address (memory interpretation) for which the section number</p>
<p>is irrelevant.</p>
<p>Although the symbol table values have similar meanings for different file types,</p>
<p>the information allows efficient access by the appropriate programs.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>932</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>String Tables</b></p>
<p>String table sections contain null-terminated character sequences or strings. These</p>
<p>strings are used to represent symbol and section names. An empty string table</p>
<p>section is permitted; its section header's</p>
<p>sh_size</p>
<p>contains zero. Non-zero indexes</p>
<p>are invalid for an empty string table. If the string table is not empty, you can</p>
<p>reference a string as an index into the string table section. The first byte, which is</p>
<p>index</p>
<p>0</p>
<p>(zero), contains a null character. Likewise, a string table's last byte contains</p>
<p>a null character to ensure null termination for all strings. A string whose index is</p>
<p>0</p>
<p>(zero) specifies either no name or a null name, depending on the context.</p>
<p>A section header's</p>
<p>sh_name</p>
<p>contains an index into the section header string table</p>
<p>(See the</p>
<p>e_shstrndx</p>
<p>field in âELF Headersâ on page 916). The following figures</p>
<p>show a string table with 25 bytes and the strings associated with various indexes:</p>
<p><b>+9</b></p>
<p><b>+8</b></p>
<p><b>+7</b></p>
<p><b>+6</b></p>
<p><b>+5</b></p>
<p><b>+4</b></p>
<p><b>+3</b></p>
<p><b>+2</b></p>
<p><b>+1</b></p>
<p><b>+0</b></p>
<p><b>Index</b></p>
<p>r</p>
<p>a</p>
<p>V</p>
<p>\0</p>
<p>.</p>
<p>e</p>
<p>m</p>
<p>a</p>
<p>n</p>
<p>\0</p>
<p>0</p>
<p>e</p>
<p>l</p>
<p>b</p>
<p>a</p>
<p>\0</p>
<p>e</p>
<p>l</p>
<p>b</p>
<p>a</p>
<p>i</p>
<p>10</p>
<p>\0</p>
<p>x</p>
<p>x</p>
<p>\0</p>
<p>\0</p>
<p>20</p>
<p>The string table indexes are:</p>
<p><b>String</b></p>
<p><b>Index</b></p>
<p><i>none</i></p>
<p>0</p>
<p>name.</p>
<p>1</p>
<p>Variable</p>
<p>7</p>
<p>able</p>
<p>11</p>
<p>able</p>
<p>16</p>
<p><i>null string</i></p>
<p>24</p>
<p>A string table index may refer to any byte in the section. A string may appear more</p>
<p>than once; references to substrings may exist, and a single string may be referenced</p>
<p>multiple times. Strings that are not referenced are also allowed.</p>
<p><i>933</i></p>
<p><i>Green Hills Software</i></p>
<p><i>String Tables</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Program Headers</b></p>
<p>An ELF executable file's program header table is an array of structures, each</p>
<p>describing a segment or other information the system needs to prepare the program</p>
<p>for execution. A file segment contains one or more sections. Program headers are</p>
<p>defined only for executable files. A file specifies its own program header size with</p>
<p>the ELF header's</p>
<p>e_phentsize</p>
<p>and</p>
<p>e_phnum</p>
<p>.</p>
<p>typedef struct {</p>
<p>Elf32_Word p_type;</p>
<p>Elf32_Off</p>
<p>p_offset;</p>
<p>Elf32_Addr p_vaddr;</p>
<p>Elf32_Addr p_paddr;</p>
<p>Elf32_Word p_filesz;</p>
<p>Elf32_Word p_memsz;</p>
<p>Elf32_Word p_flags;</p>
<p>Elf32_Word p_align;</p>
<p>} Elf32_Phdr;</p>
<p>p_type</p>
<p>The kind of segment this array element describes and how to interpret the array element's</p>
<p>information. For more information, see âProgram Typesâ on page 935.</p>
<p>p_offset</p>
<p>Offset from the beginning of the file at which the first byte of the segment resides.</p>
<p>p_vaddr</p>
<p>Address at which the first byte of the segment resides in memory.</p>
<p>p_paddr</p>
<p>For targets where physical addressing is relevant, this field gives the segment's physical address.</p>
<p>For other targets this field is unused and is set to zero by the linker.</p>
<p>p_filesz</p>
<p>Number of bytes in the file image of the segment; it may be zero.</p>
<p>p_memsz</p>
<p>Number of bytes in the memory image of the segment; it may be zero.</p>
<p>p_flags</p>
<p>Flags relevant to the segment. For more information, see âProgram Attribute Flagsâ on page 936.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>934</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p>p_align</p>
<p>Loadable process segments must have congruent values for</p>
<p>p_vaddr</p>
<p>and</p>
<p>p_offset</p>
<p>, modulo</p>
<p>the page size. This field specifies the value to which the segments are aligned in memory and</p>
<p>in the file. Values</p>
<p>0</p>
<p>and</p>
<p>1</p>
<p>mean no alignment is required. Otherwise,</p>
<p>p_align</p>
<p>should be a</p>
<p>positive, integral power of</p>
<p>2</p>
<p>, and</p>
<p>p_vaddr</p>
<p>should equal</p>
<p>p_offset</p>
<p>, modulo</p>
<p>p_align</p>
<p>.</p>
<p><b>Program Types</b></p>
<p>A program header's</p>
<p>p_type</p>
<p>specifies the program's semantics as follows:</p>
<p><b>Meaning</b></p>
<p><b>Value</b></p>
<p><b>Name</b></p>
<p>The array element is unused; other member values are</p>
<p>undefined. This type lets the program header table have</p>
<p>ignored entries.</p>
<p>0</p>
<p>PT_NULL</p>
<p>The array element specifies a loadable segment, described by</p>
<p>p_filesz</p>
<p>and</p>
<p>p_memsz</p>
<p>. The bytes from the file are mapped</p>
<p>to the beginning of the memory segment. If the segment's</p>
<p>memory size (</p>
<p>p_memsz</p>
<p>) is larger than the file size</p>
<p>(</p>
<p>p_filesz</p>
<p>), and</p>
<p>p_filesz</p>
<p>is non-zero, the âextraâ bytes</p>
<p>are defined to hold the value 0 and to follow the segment's</p>
<p>initialized area. The file size may not be larger than the</p>
<p>memory size. Loadable segment entries in the program header</p>
<p>table appear in ascending order, sorted on the</p>
<p>p_vaddr</p>
<p>member.</p>
<p>1</p>
<p>PT_LOAD</p>
<p>The array element specifies dynamic linking information.</p>
<p>2</p>
<p>PT_DYNAMIC</p>
<p>The array element specifies the location and size of a</p>
<p>null-terminated pathname to invoke as an interpreter. This</p>
<p>segment type is meaningful only for executable files (though</p>
<p>it may occur for shared objects); it may not occur more than</p>
<p>once in a file. If it is present, it must precede any loadable</p>
<p>segment entry.</p>
<p>3</p>
<p>PT_INTERP</p>
<p>The array element specifies the location and size of auxiliary</p>
<p>information.</p>
<p>4</p>
<p>PT_NOTE</p>
<p>This segment type is reserved but has unspecified semantics.</p>
<p>5</p>
<p>PT_SHLIB</p>
<p><i>935</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Program Types</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Meaning</b></p>
<p><b>Value</b></p>
<p><b>Name</b></p>
<p>The array element, if present, specifies the location and size</p>
<p>of the program header table itself, both in the file and in the</p>
<p>memory image of the program. This segment type may not</p>
<p>occur more than once in a file. Moreover, it may occur only</p>
<p>if the program header table is part of the memory image of</p>
<p>the program. If it is present, it must precede any loadable</p>
<p>segment entry.</p>
<p>6</p>
<p>PT_PHDR</p>
<p>Reserved for processor-specific semantics.</p>
<p>0x70000000</p>
<p>to</p>
<p>0x7fffffff</p>
<p>PT_LOPROC</p>
<p>to</p>
<p>PT_HIPROC</p>
<p><b>Program Attribute Flags</b></p>
<p>A program to be loaded by the system must have at least one loadable segment</p>
<p>(although this is not required by the file format). When the system creates loadable</p>
<p>segment memory images, it gives access permissions as specified in the</p>
<p>p_flags</p>
<p>member. All bits included in the</p>
<p>PF_MASKPROC</p>
<p>mask are reserved for</p>
<p>processor-specific semantics.</p>
<p><b>Meaning</b></p>
<p><b>Value</b></p>
<p><b>Name</b></p>
<p>Execute</p>
<p>0x1</p>
<p>PF_X</p>
<p>Write</p>
<p>0x2</p>
<p>PF_W</p>
<p>Read</p>
<p>0x4</p>
<p>PF_R</p>
<p>Unspecified</p>
<p>0xf0000000</p>
<p>PF_MASKPROC</p>
<p>If a permission bit is</p>
<p>0</p>
<p>, that type of access is denied. Actual memory permissions</p>
<p>depend on the memory management unit, which may vary from one system to</p>
<p>another. Although all flag combinations are valid, the system may grant more access</p>
<p>than requested. However, a segment will never have write permission unless it is</p>
<p>specified explicitly. The following table shows both the exact flag interpretation</p>
<p>and the allowable flag interpretation.</p>
<p><b>Allowable</b></p>
<p><b>Exact</b></p>
<p><b>Value</b></p>
<p><b>Flag</b></p>
<p>All access denied</p>
<p>All access denied</p>
<p>0</p>
<p>(none)</p>
<p>Read, execute</p>
<p>Execute only</p>
<p>1</p>
<p>PF_X</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>936</i></p>
<p><i>Chapter 20. The ELF File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Allowable</b></p>
<p><b>Exact</b></p>
<p><b>Value</b></p>
<p><b>Flag</b></p>
<p>Read, write, execute</p>
<p>Write only</p>
<p>2</p>
<p>PF_W</p>
<p>Read, write, execute</p>
<p>Write, execute</p>
<p>3</p>
<p>PF_W+PF_X</p>
<p>Read, execute</p>
<p>Read only</p>
<p>4</p>
<p>PF_R</p>
<p>Read, execute</p>
<p>Read, execute</p>
<p>5</p>
<p>PF_R+PF_X</p>
<p>Read, write, execute</p>
<p>Read, write</p>
<p>6</p>
<p>PF_R+PF_W</p>
<p>Read, write, execute</p>
<p>Read, write, execute</p>
<p>7</p>
<p>PF_R+PF_W+PF_X</p>
<p>For example, typical text segments have read and execute - but not write -</p>
<p>permissions. Data segments normally have read, write, and execute permissions.</p>
<p><i>937</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Program Attribute Flags</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Part IV</b></p>
<p><b>Appendices</b></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Appendix A</b></p>
<p><b>Coding Standard Profile</b></p>
<p><b>Reference</b></p>
<p><b>Contents</b></p>
<p>GHS Standard Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>942</p>
<p>MISRA C 1998 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>945</p>
<h1 style="page-break-before:always; "></h1>
<p>This appendix describes the preset coding standard profiles that ship with the Green</p>
<p>Hills Tools. The tables in this appendix display:</p>
<p>â¢</p>
<p>each implemented rule</p>
<p>â¢</p>
<p>the diagnostics associated with that rule</p>
<p>â¢</p>
<p>tags associated with that rule</p>
<p>If the standard provides different levels of implementation (such as ârequiredâ and</p>
<p>âadvisoryâ), additional columns provide a tag name for and associate rules with</p>
<p>each level.</p>
<p>For more information about using coding standard profiles, see Chapter 14, âCoding</p>
<p>Standardsâ on page 767.</p>
<p><b>GHS Standard Mode</b></p>
<p>The entire set of diagnostics is controlled by the tag</p>
<p>ghstd_all</p>
<p>.</p>
<p><b>Declarations, Definitions, and Initialization</b></p>
<p><b>Tags</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>77 260</p>
<p>837</p>
<p>938</p>
<p>Function definitions and declarations must have explicit return types.</p>
<p>117</p>
<p>940</p>
<p>The type of each returned expression must match the return type of</p>
<p>the enclosing function.</p>
<p>223</p>
<p>1547</p>
<p>1791</p>
<p>Function prototypes are required.</p>
<p>1844</p>
<p>Function parameters and return types in declarations must match the</p>
<p>function prototype.</p>
<p>1731</p>
<p>Functions must be declared at file scope. Defining a function inside</p>
<p>another function is not permitted.</p>
<p>1728</p>
<p>Functions with no parameters must be declared with the void</p>
<p>parameter type.</p>
<p>1797</p>
<p>Multiple definitions of an external identifier are not permitted (no</p>
<p>commons).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>942</i></p>
<p><i>Appendix A. Coding Standard Profile Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Tags</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>172</p>
<p>Declaring an object or function in the same file as both static and</p>
<p>extern is not permitted.</p>
<p>619</p>
<p>620</p>
<p>Non-standard unnamed fields and bitfields are not permitted.</p>
<p>108</p>
<p>One-bit signed bitfields are not permitted.</p>
<p>1927</p>
<p>Bitfields of unspecified signedness must be strictly narrower than</p>
<p>their underlying types.</p>
<p>549</p>
<p>Automatic variables must be set before they are used.</p>
<p>991</p>
<p>1162</p>
<p>1736</p>
<p>Initializers must have explicit braces.</p>
<p>1908</p>
<p>String initializers that discard the final '\0'</p>
<p>are not permitted.</p>
<p>460</p>
<p>1721</p>
<p>Shadowing an identifier with another identifier in a narrower scope</p>
<p>is not permitted.</p>
<p>66</p>
<p>Enumeration values must be in the range of &quot;signed int&quot;.</p>
<p>1912</p>
<p>1913</p>
<p>Variables declared &quot;register&quot; should have appropriate types.</p>
<p><b>Expressions and Control Flow</b></p>
<p><b>Tags</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>1725</p>
<p>Side effects in the operand of the sizeof operator are not permitted.</p>
<p>1931</p>
<p>The sizeof operator's operand must be a type, a variable, or a</p>
<p>dereferenced pointer expression.</p>
<p>63</p>
<p>Shifting a value by a negative number or by more than the size of</p>
<p>its actual type is not permitted.</p>
<p>1702</p>
<p>Unary minus on unsigned expressions is not permitted.</p>
<p>187</p>
<p>Assignments in controlling expressions are not permitted.</p>
<p>1704</p>
<p>Testing floating-point values for exact equality or inequality is not</p>
<p>permitted.</p>
<p>1750</p>
<p>Floating-point loop counters are not permitted.</p>
<p>174</p>
<p>All non-null statements must have at least one side effect.</p>
<p>1910</p>
<p>Top-level expressions must not contain useless code.</p>
<p>1963</p>
<p>Each label must be followed by a statement.</p>
<p><i>943</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Expressions and Control Flow</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Tags</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>1711</p>
<p>1838</p>
<p>Falling through a case clause in a switch statement is not permitted.</p>
<p>1712</p>
<p>1837</p>
<p>Each switch statement must contain a final default case.</p>
<p>1713</p>
<p>Each switch statement must contain at least one case.</p>
<p>237</p>
<p>The controlling expression of a switch statement must not be</p>
<p>constant.</p>
<p>1733</p>
<p>The controlling expression of a switch statement must not be</p>
<p>effectively Boolean.</p>
<p>1892</p>
<p>Relational operators must be correctly parenthesized.</p>
<p>1056</p>
<p>1780</p>
<p>The address of an automatic variable must not escape its scope.</p>
<p>1915</p>
<p>Casts to or from pointers to incomplete class types are not permitted.</p>
<p>1937</p>
<p>Boolean expressions and non-booleans should not be compared for</p>
<p>equality.</p>
<p>69</p>
<p>Implicit integer conversions should not result in truncation.</p>
<p><b>Preprocessing Directives</b></p>
<p><b>Tags</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>9</p>
<p>Nested comments are not permitted.</p>
<p>11</p>
<p>Unrecognized preprocessing directives are not permitted.</p>
<p>1732</p>
<p>Use of #define or #undef within a block is not permitted.</p>
<p><b>Character Set Portability</b></p>
<p><b>Tags</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>1747</p>
<p>Nonstandard or multi-byte characters are not permitted in #include</p>
<p>directives.</p>
<p>192</p>
<p>Non-standard escape sequences are not permitted.</p>
<p>1967</p>
<p>Trigraphs are not permitted in line splices, character constants, or</p>
<p>string literals.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>944</i></p>
<p><i>Appendix A. Coding Standard Profile Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Standard Libraries</b></p>
<p><b>Tags</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>181</p>
<p>224</p>
<p>225</p>
<p>226</p>
<p>printf and scanf calls must have an argument of the correct type for</p>
<p>each format specifier.</p>
<p>1932</p>
<p>printf and scanf format strings must be string literals, not variables</p>
<p>which might be tainted by user input.</p>
<p>1906</p>
<p>Use of setjmp and longjmp is not permitted.</p>
<p>1907</p>
<p>Use of atof, atoi, or atol is not permitted.</p>
<p>1899</p>
<p>1900</p>
<p>Use of gets or scanf(&quot;%s&quot;) is not permitted.</p>
<p><b>MISRA C 1998</b></p>
<p>This coding standard is provided as an example implementation of MISRA C 1998.</p>
<p>It is not a full implementation. In addition to the tags listed in the tables below, the</p>
<p>entire set of diagnostics is controlled by the tag</p>
<p>m98_all</p>
<p>.</p>
<p><b>Others</b></p>
<p><b>m98_adv</b></p>
<p><b>m98_req</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>m98_1</p>
<p>X</p>
<p>1546</p>
<p>667</p>
<p>All code shall conform to ISO 9899 standard</p>
<p>C, with no extensions permitted.</p>
<p>1</p>
<p>m98_3</p>
<p>X</p>
<p>1749</p>
<p>1839</p>
<p>Assembly language functions should contain</p>
<p>only assembly language.</p>
<p>3</p>
<p>m98_5</p>
<p>X</p>
<p>192</p>
<p>1823</p>
<p>Only those characters defined in the ISO C</p>
<p>standard shall be used.</p>
<p>5</p>
<p>m98_7</p>
<p>X</p>
<p>1695</p>
<p>Trigraphs shall not be used.</p>
<p>7</p>
<p>m98_8</p>
<p>X</p>
<p>1720</p>
<p>1823</p>
<p>Multibyte characters and wide string literals</p>
<p>shall not be used.</p>
<p>8</p>
<p>m98_9</p>
<p>X</p>
<p>9</p>
<p>Comments shall not be nested.</p>
<p>9</p>
<p>m98_10</p>
<p>X</p>
<p>1771</p>
<p>Sections of code should not be commented</p>
<p>out.</p>
<p>10</p>
<p>m98_12</p>
<p>X</p>
<p>1723</p>
<p>No identifier in one namespace shall match</p>
<p>an identifier in another.</p>
<p>12</p>
<p>m98_13</p>
<p>X</p>
<p>1698</p>
<p>The basic types should not be used.</p>
<p>13</p>
<p><i>945</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Standard Libraries</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Others</b></p>
<p><b>m98_adv</b></p>
<p><b>m98_req</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>m98_14</p>
<p>X</p>
<p>1699</p>
<p>The type char shall always be declared as</p>
<p>unsigned char or signed char.</p>
<p>14</p>
<p>m98_16</p>
<p>X</p>
<p>1820</p>
<p>The underlying bit representations of floats</p>
<p>shall not be used in any way.</p>
<p>16</p>
<p>m98_17</p>
<p>X</p>
<p>1722</p>
<p>1841</p>
<p>typedef names shall not be reused.</p>
<p>17</p>
<p>m98_18</p>
<p>X</p>
<p>1775</p>
<p>Numeric constants should be suffixed to</p>
<p>indicate type.</p>
<p>18</p>
<p>m98_19</p>
<p>X</p>
<p>1718</p>
<p>Octal constants (other than zero) shall not be</p>
<p>used.</p>
<p>19</p>
<p>m98_20</p>
<p>X</p>
<p>223</p>
<p>All object and function identifiers shall be</p>
<p>declared before use.</p>
<p>20</p>
<p>m98_21</p>
<p>X</p>
<p>460</p>
<p>1721</p>
<p>Identifiers in an inner scope shall not hide</p>
<p>identifiers in outer scopes.</p>
<p>21</p>
<p>m98_24</p>
<p>X</p>
<p>172</p>
<p>Identifiers shall not simultaneously have</p>
<p>internal and external linkage.</p>
<p>24</p>
<p>m98_25</p>
<p>X</p>
<p>1797</p>
<p>An identifier with external linkage shall have</p>
<p>exactly one definition.</p>
<p>25</p>
<p>m98_26</p>
<p>X</p>
<p>147</p>
<p>If objects or functions are declared more than</p>
<p>once...</p>
<p>26</p>
<p>m98_28</p>
<p>X</p>
<p>1696</p>
<p>The register storage class should not be used.</p>
<p>28</p>
<p>m98_29</p>
<p>X</p>
<p>188</p>
<p>469</p>
<p>1842</p>
<p>The use of a tag shall agree with its</p>
<p>declaration.</p>
<p>29</p>
<p>m98_30</p>
<p>X</p>
<p>549</p>
<p>All automatic variables shall have been</p>
<p>assigned a value before use.</p>
<p>30</p>
<p>m98_31</p>
<p>X</p>
<p>146</p>
<p>991</p>
<p>1162</p>
<p>Braces shall be used to indicate structure in</p>
<p>array and struct initializers.</p>
<p>31</p>
<p>m98_32</p>
<p>X</p>
<p>1726</p>
<p>In an enumerator list, the '='</p>
<p>construct shall</p>
<p>not be used other than ...</p>
<p>32</p>
<p>m98_33</p>
<p>X</p>
<p>1724</p>
<p>The right hand operand of &amp;&amp; or || shall not</p>
<p>contain side effects.</p>
<p>33</p>
<p>m98_34</p>
<p>X</p>
<p>1729</p>
<p>The operands of &amp;&amp; or || shall be primary</p>
<p>expressions.</p>
<p>34</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>946</i></p>
<p><i>Appendix A. Coding Standard Profile Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Others</b></p>
<p><b>m98_adv</b></p>
<p><b>m98_req</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>m98_35</p>
<p>X</p>
<p>1738</p>
<p>Assignment operators shall not be used in</p>
<p>expressions which return bool.</p>
<p>35</p>
<p>m98_36</p>
<p>X</p>
<p>1853</p>
<p>1854</p>
<p>Logical operators should not be confused</p>
<p>with bitwise operators.</p>
<p>36</p>
<p>m98_37</p>
<p>X</p>
<p>1730</p>
<p>Bitwise operations shall not be performed</p>
<p>on signed integer types.</p>
<p>37</p>
<p>m98_38</p>
<p>X</p>
<p>62 63</p>
<p>The right hand operand of a shift shall lie</p>
<p>between zero and width-1.</p>
<p>38</p>
<p>m98_39</p>
<p>X</p>
<p>1702</p>
<p>The unary minus operator shall not be</p>
<p>applied to an unsigned expression.</p>
<p>39</p>
<p>m98_40</p>
<p>X</p>
<p>1725</p>
<p>The sizeof operator should not be used on</p>
<p>expressions with side effects.</p>
<p>40</p>
<p>m98_42</p>
<p>X</p>
<p>1719</p>
<p>The comma operator shall not be used,</p>
<p>except in for loop headers.</p>
<p>42</p>
<p>m98_43</p>
<p>X</p>
<p>1739</p>
<p>1863</p>
<p>1864</p>
<p>1865</p>
<p>1866</p>
<p>1867</p>
<p>1868</p>
<p>1869</p>
<p>1870</p>
<p>Implicit conversions which may result in a</p>
<p>loss of information ...</p>
<p>43</p>
<p>m98_44</p>
<p>X</p>
<p>1740</p>
<p>Redundant explicit casts should not be used.</p>
<p>44</p>
<p>m98_45</p>
<p>X</p>
<p>1703</p>
<p>Type casting from any type to or from</p>
<p>pointers shall not be used.</p>
<p>45</p>
<p>m98_47</p>
<p>X</p>
<p>1737</p>
<p>No dependence should be placed on C's</p>
<p>operator precedence rules.</p>
<p>47</p>
<p>m98_48</p>
<p>X</p>
<p>1751</p>
<p>Mixed precision arithmetic should use</p>
<p>explicit casting.</p>
<p>48</p>
<p>m98_49</p>
<p>X</p>
<p>1855</p>
<p>1881</p>
<p>Tests of a value against zero should be made</p>
<p>explicit.</p>
<p>49</p>
<p>m98_50</p>
<p>X</p>
<p>1704</p>
<p>Floating point variables shall not be tested</p>
<p>for exact equality.</p>
<p>50</p>
<p>m98_51</p>
<p>X</p>
<p>1735</p>
<p>Evaluation of constant unsigned integer</p>
<p>expressions should not wrap around.</p>
<p>51</p>
<p>m98_52</p>
<p>X</p>
<p>111</p>
<p>There shall be no unreachable code.</p>
<p>52</p>
<p><i>947</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 1998</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Others</b></p>
<p><b>m98_adv</b></p>
<p><b>m98_req</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>m98_53</p>
<p>X</p>
<p>174</p>
<p>All non-null statements shall have a</p>
<p>side-effect.</p>
<p>53</p>
<p>m98_54</p>
<p>X</p>
<p>1746</p>
<p>A null statement shall only occur on a line</p>
<p>by itself.</p>
<p>54</p>
<p>m98_55</p>
<p>X</p>
<p>1708</p>
<p>Labels should not be used, except in switch</p>
<p>statements.</p>
<p>55</p>
<p>m98_56</p>
<p>X</p>
<p>1705</p>
<p>The goto statement shall not be used.</p>
<p>56</p>
<p>m98_57</p>
<p>X</p>
<p>1706</p>
<p>The continue statement shall not be used.</p>
<p>57</p>
<p>m98_58</p>
<p>X</p>
<p>1707</p>
<p>The break statement shall not be used (except</p>
<p>in a switch statement).</p>
<p>58</p>
<p>m98_59</p>
<p>X</p>
<p>1709</p>
<p>1826</p>
<p>The body of an if, while, do, or for shall</p>
<p>always be enclosed in braces.</p>
<p>59</p>
<p>m98_60</p>
<p>X</p>
<p>1710</p>
<p>All if, else if constructs should contain a final</p>
<p>else clause.</p>
<p>60</p>
<p>m98_61</p>
<p>,</p>
<p>m98_switch</p>
<p>X</p>
<p>1711</p>
<p>1884</p>
<p>Every non-empty case clause in a switch</p>
<p>statement shall have a break.</p>
<p>61</p>
<p>m98_62</p>
<p>,</p>
<p>m98_switch</p>
<p>X</p>
<p>1712</p>
<p>1837</p>
<p>All switch statements should contain a final</p>
<p>default clause.</p>
<p>62</p>
<p>m98_63</p>
<p>,</p>
<p>m98_switch</p>
<p>X</p>
<p>1733</p>
<p>1944</p>
<p>A switch expression should not represent a</p>
<p>Boolean value.</p>
<p>63</p>
<p>m98_64</p>
<p>,</p>
<p>m98_switch</p>
<p>X</p>
<p>1713</p>
<p>Every switch statement shall have at least</p>
<p>one case.</p>
<p>64</p>
<p>m98_65</p>
<p>X</p>
<p>1750</p>
<p>Floating point variables shall not be used as</p>
<p>loop counters.</p>
<p>65</p>
<p>m98_68</p>
<p>X</p>
<p>1731</p>
<p>Functions shall always be declared at file</p>
<p>scope.</p>
<p>68</p>
<p>m98_69</p>
<p>X</p>
<p>1697</p>
<p>Functions with variable numbers of</p>
<p>arguments shall not be used.</p>
<p>69</p>
<p>m98_71</p>
<p>X</p>
<p>1547</p>
<p>1791</p>
<p>1800</p>
<p>1828</p>
<p>Functions shall always have visible prototype</p>
<p>declarations.</p>
<p>71</p>
<p>m98_72</p>
<p>X</p>
<p>1844</p>
<p>The type given in the declaration and</p>
<p>definition shall be identical.</p>
<p>72</p>
<p>m98_73</p>
<p>X</p>
<p>1727</p>
<p>Identifiers shall either be given for all the</p>
<p>parameters, or for none.</p>
<p>73</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>948</i></p>
<p><i>Appendix A. Coding Standard Profile Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Others</b></p>
<p><b>m98_adv</b></p>
<p><b>m98_req</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>m98_74</p>
<p>X</p>
<p>1745</p>
<p>If identifiers are given, then those in the</p>
<p>definition shall be identical.</p>
<p>74</p>
<p>m98_75</p>
<p>X</p>
<p>77 260</p>
<p>837</p>
<p>938</p>
<p>Every function shall have an explicit return</p>
<p>type.</p>
<p>75</p>
<p>m98_76</p>
<p>X</p>
<p>1728</p>
<p>Functions with no parameters shall be</p>
<p>declared with parameter type void.</p>
<p>76</p>
<p>m98_78</p>
<p>X</p>
<p>140</p>
<p>165</p>
<p>The number of parameters passed shall match</p>
<p>the function prototype.</p>
<p>78</p>
<p>m98_82</p>
<p>X</p>
<p>1734</p>
<p>A function should have a single point of exit.</p>
<p>82</p>
<p>m98_83</p>
<p>X</p>
<p>117</p>
<p>940</p>
<p>Each return shall have an expression; it shall</p>
<p>match the return type.</p>
<p>83</p>
<p>m98_85</p>
<p>X</p>
<p>1774</p>
<p>Functions called with no parameters should</p>
<p>have empty parentheses.</p>
<p>85</p>
<p>m98_87</p>
<p>X</p>
<p>1748</p>
<p>#include statements shall only be preceded</p>
<p>by other directives or comments.</p>
<p>87</p>
<p>m98_88</p>
<p>X</p>
<p>1747</p>
<p>Non-standard characters shall not occur in</p>
<p>header file names.</p>
<p>88</p>
<p>m98_90</p>
<p>X</p>
<p>1776</p>
<p>1859</p>
<p>1860</p>
<p>1886</p>
<p>C macros shall only be used for ...</p>
<p>90</p>
<p>m98_91</p>
<p>X</p>
<p>1732</p>
<p>Macros shall not be #define'd and #undef'd</p>
<p>within a block.</p>
<p>91</p>
<p>m98_92</p>
<p>X</p>
<p>1715</p>
<p>#undef should not be used.</p>
<p>92</p>
<p>m98_93</p>
<p>X</p>
<p>1862</p>
<p>A function should be used in preference to</p>
<p>a function-like macro.</p>
<p>93</p>
<p>m98_94</p>
<p>X</p>
<p>54 76</p>
<p>A function-like macro shall not be 'called'</p>
<p>without its arguments.</p>
<p>94</p>
<p>m98_95</p>
<p>X</p>
<p>10</p>
<p>Arguments to a macro shall not contain</p>
<p>preprocessing directives.</p>
<p>95</p>
<p>m98_96</p>
<p>X</p>
<p>1743</p>
<p>1829</p>
<p>The whole definition, and each parameter,</p>
<p>shall be enclosed in parentheses.</p>
<p>96</p>
<p>m98_97</p>
<p>X</p>
<p>193</p>
<p>Identifiers in preprocessor directives should</p>
<p>be defined before use.</p>
<p>97</p>
<p><i>949</i></p>
<p><i>Green Hills Software</i></p>
<p><i>MISRA C 1998</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Others</b></p>
<p><b>m98_adv</b></p>
<p><b>m98_req</b></p>
<p><b>Diag.</b></p>
<p><b>Rule</b></p>
<p>m98_98</p>
<p>X</p>
<p>1716</p>
<p>There shall be at most one # or ## operator</p>
<p>in a single macro definition.</p>
<p>98</p>
<p>m98_100</p>
<p>X</p>
<p>1831</p>
<p>1902</p>
<p>The defined preprocessor operator shall only</p>
<p>be used in standard forms.</p>
<p>100</p>
<p>m98_101</p>
<p>X</p>
<p>1752</p>
<p>Pointer arithmetic should not be used.</p>
<p>101</p>
<p>m98_102</p>
<p>X</p>
<p>1741</p>
<p>No more than 2 levels of pointer indirection</p>
<p>should be used.</p>
<p>102</p>
<p>m98_103</p>
<p>X</p>
<p>1961</p>
<p>Relational operators shall not be applied to</p>
<p>pointer types except ...</p>
<p>103</p>
<p>m98_104</p>
<p>X</p>
<p>1777</p>
<p>Non-constant pointers to functions shall not</p>
<p>be used.</p>
<p>104</p>
<p>m98_105</p>
<p>X</p>
<p>1778</p>
<p>All the functions pointed to by a function</p>
<p>pointer shall have the same type.</p>
<p>105</p>
<p>m98_106</p>
<p>X</p>
<p>1056</p>
<p>1780</p>
<p>The address of an object shall not be assigned</p>
<p>to an outer-scoped object.</p>
<p>106</p>
<p>m98_110</p>
<p>X</p>
<p>1819</p>
<p>1827</p>
<p>Unions shall not be used to access the</p>
<p>sub-parts of larger data types.</p>
<p>110</p>
<p>m98_111</p>
<p>X</p>
<p>230</p>
<p>1717</p>
<p>Bit fields shall only be defined of type</p>
<p>unsigned int or signed int.</p>
<p>111</p>
<p>m98_112</p>
<p>X</p>
<p>108</p>
<p>Bit fields of type signed int shall be at least</p>
<p>2 bits long.</p>
<p>112</p>
<p>m98_113</p>
<p>X</p>
<p>1742</p>
<p>All the members of a structure (or union)</p>
<p>shall be named.</p>
<p>113</p>
<p>m98_114</p>
<p>X</p>
<p>45 46</p>
<p>1861</p>
<p>1885</p>
<p>1888</p>
<p>Reserved words and function names shall</p>
<p>not be redefined or undefined.</p>
<p>114</p>
<p>m98_122</p>
<p>X</p>
<p>1906</p>
<p>The setjmp macro and the longjmp function</p>
<p>shall not be used.</p>
<p>122</p>
<p>m98_125</p>
<p>X</p>
<p>1907</p>
<p>The library functions atof, atoi and atol from</p>
<p>&lt;stdlib.h&gt; shall not be used.</p>
<p>125</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>950</i></p>
<p><i>Appendix A. Coding Standard Profile Reference</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Appendix B</b></p>
<p><b>GNU Options</b></p>
<h1 style="page-break-before:always; "></h1>
<p>The builder currently accepts the following legacy GNU option names as aliases</p>
<p>for official Green Hills options. These option aliases are deprecated. We recommend</p>
<p>that you use the official Green Hills Software options.</p>
<p><b>Official Green Hills Option</b></p>
<p><b>Legacy GNU Option</b></p>
<p><b>-#</b></p>
<p><b>-###</b></p>
<p><b>--commons</b></p>
<p><b>-fcommon</b></p>
<p><b>--exceptions</b></p>
<p><b>-fexceptions</b></p>
<p><b>-Opeephole</b></p>
<p><b>-fpeephole</b></p>
<p><b>-Opipeline</b></p>
<p><b>-fschedule-insns</b></p>
<p><b>--short_enum</b></p>
<p><b>-fshort-enums</b></p>
<p><b>-ansi_alias</b></p>
<p><b>-fstrict-aliasing</b></p>
<p><b>-syntax</b></p>
<p><b>-fsyntax-only</b></p>
<p><b>-Ounroll</b></p>
<p><b>-funroll-loops</b></p>
<p><b>-OM</b></p>
<p><b>-fvolatile</b></p>
<p><b>--no_commons</b></p>
<p><b>-fno-common</b></p>
<p><b>--no_exceptions</b></p>
<p><b>-fno-exceptions</b></p>
<p><b>-Onopeephole</b></p>
<p><b>-fno-peephole</b></p>
<p><b>-Onopipeline</b></p>
<p><b>-fno-schedule-insns</b></p>
<p><b>--no_short_enum</b></p>
<p><b>-fno-short-enums</b></p>
<p><b>-no_ansi_alias</b></p>
<p><b>-fno-strict-aliasing</b></p>
<p><b>-Onomemory</b></p>
<p><b>-fno-volatile</b></p>
<p><b>-Onounroll</b></p>
<p><b>-fno-unroll-loops</b></p>
<p><b>-no_reserve_r2</b></p>
<p><b>-mapp-regs</b></p>
<p><b>-cpu=</b></p>
<p><b>-march=</b></p>
<p><b>-bigswitch</b></p>
<p><b>-mbigswitch</b></p>
<p><b>-cpu=</b></p>
<p><b>-mcpu</b></p>
<p><b>-mdisable-callt</b></p>
<p><b>-farcalls</b></p>
<p><b>-mlong-calls</b></p>
<p><b>-reserve_r2</b></p>
<p><b>-mno-app-regs</b></p>
<p><b>-nobigswitch</b></p>
<p><b>-mnobigswitch</b></p>
<p><b>-mno-disable-callt</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>952</i></p>
<p><i>Appendix B. GNU Options</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>-nofarcalls</b></p>
<p><b>-mno-long-calls</b></p>
<p><b>-sda=</b></p>
<p><b>-msda=</b></p>
<p><b>-sda=0</b></p>
<p><b>-msdata=none</b></p>
<p><b>-cpu=v850</b></p>
<p><b>-mv850</b></p>
<p><b>-cpu=v850e</b></p>
<p><b>-mv850e</b></p>
<p><b>-zda=</b></p>
<p><b>-mzda=</b></p>
<p>See the second note below.</p>
<p><b>-Wall</b></p>
<p><b>Note</b></p>
<p>Of the options listed in the previous table, only<b> -mlong-calls</b> and</p>
<p><b>-mno-long-calls</b> are recognized by the Builder. The remaining options</p>
<p>are recognized only by the driver.</p>
<p><b>Note</b></p>
<p>The<b> -Wall</b> option enables several warnings which are off by default. This</p>
<p>option does not have an equivalent supported option and is deprecated.</p>
<p>We recommend<b> --ghstd</b> as a more complete solution for detecting issues</p>
<p>in source code. Otherwise, these separate options may be used to turn on</p>
<p>some warnings which are controlled by<b> -Wall</b>:<b> -Wunknown-pragmas</b>,</p>
<p><b>-Wimplicit-int</b>,<b> -Wshadow</b>,<b> -Wtrigraphs</b>,<b> -Wundef</b>.</p>
<p><i>953</i></p>
<p><i>Green Hills Software</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Appendix C</b></p>
<p><b>Green Hills Project File</b></p>
<p><b>Format</b></p>
<p><b>Contents</b></p>
<p>Green Hills Project File Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>956</p>
<p>Top Project Directives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>961</p>
<p>Conditional Control Statements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>965</p>
<p>Macro Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>969</p>
<p>File Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>970</p>
<h1 style="page-break-before:always; "></h1>
<p>Green Hills project (<b>.gpj</b>) files support several advanced methods for specifying</p>
<p>the files and options to use when building your project with the MULTI Project</p>
<p>Manager or command line build utility. This appendix describes the file format and</p>
<p>covers advanced features that you can use only by manually editing project files.</p>
<p><b>Green Hills Project File Syntax</b></p>
<p>Green Hills project (<b>.gpj</b>) files have three sections:</p>
<p>â¢</p>
<p>Header section â Specifies the project file's type and optionally contains macro</p>
<p>definitions. For Top Project files, also specifies project-wide directives.</p>
<p>â¢</p>
<p>Options section â Specifies options that apply to the project and all of its</p>
<p>children.</p>
<p>â¢</p>
<p>Children section â Specifies files included by the project, their types, and</p>
<p>options that apply to each respective file.</p>
<p>In any of these sections:</p>
<p>â¢</p>
<p>You can add comments anywhere after the first line of a project file with the</p>
<p>hash symbol ('</p>
<p>#</p>
<p>'). Comments continue to the end of the line.</p>
<p>â¢</p>
<p>You can use the value of a macro or an imported environment variable by</p>
<p>prefixing a dollar sign ('</p>
<p>$</p>
<p>'). For example, to use the value of the macro</p>
<p>my_library</p>
<p>as part of the<b> -l</b> option, type the following:</p>
<p>-l$my_library</p>
<p><b>Note</b></p>
<p>Macros can be defined in project files (described below), build</p>
<p>configuration (<b>.gpc</b>) files (see âBuild Configuration Quick Startâ</p>
<p>on page 974), and customization (<b>.bod</b>) files (see âPreprocessor Directivesâ</p>
<p>on page 1002). Macros defined in customization files but not in project</p>
<p>files will be inherited by project files. Macros defined in configuration</p>
<p>files are only used when performing an applicable build.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>956</i></p>
<p><i>Appendix C. Green Hills Project File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The Header Section</b></p>
<p>The header is the first section in a project file. The first line in a project file (and</p>
<p>therefore the first line of the header) must be</p>
<p>#!gbuild</p>
<p>. The last line in the header</p>
<p>is the project type, enclosed in brackets ('</p>
<p>[]</p>
<p>'). For a list of types, see the Project</p>
<p>Files (<b>.gpj</b>) list in âFile Typesâ on page 970.</p>
<p><i>957</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The Header Section</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For example, a header for a simple program project might look like this:</p>
<p>#!gbuild</p>
<p># My Hello World Program</p>
<p>[Program]</p>
<p>The header section may also contain macro definitions in the following format:</p>
<p>macro<i> macro_name</i>=<i>value</i></p>
<p>There must not be any spaces between</p>
<p><i>macro_name</i></p>
<p>,</p>
<p>=</p>
<p>, and</p>
<p><i>value</i></p>
<p>. For example:</p>
<p>#!gbuild</p>
<p># Macros for the project</p>
<p>macro DIR=my_project_directory</p>
<p>macro DEBUG=1</p>
<p>[Program]</p>
<p>If you override the value of a macro in a child project, the new value applies only</p>
<p>to uses of the macro in the child and its descendants. For example, if you use a</p>
<p>macro to specify an option in a project, that exact option setting is inherited by</p>
<p>children even if the children override the macro.</p>
<p><b>Top Project Headers</b></p>
<p>In addition to the required and optional lines documented above, Top Project headers</p>
<p>must specify the</p>
<p>primaryTarget</p>
<p>Top Project directive, and may specify other</p>
<p>Top Project directives. For example:</p>
<p>#!gbuild</p>
<p># My Top Project</p>
<p># Macros go here (optional)</p>
<p># Group 1 directives go here (optional)</p>
<p>primaryTarget=v800_standalone.tgt</p>
<p>[Project]</p>
<p>For information about Top Project directives, see âTop Project Directivesâ</p>
<p>on page 961.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>958</i></p>
<p><i>Appendix C. Green Hills Project File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>The Project Options Section</b></p>
<p>The project options section lists options that apply to the project you are editing</p>
<p>and all of its children. Each line must be indented by at least one whitespace</p>
<p>character. You can put multiple options on the same line, separated by white spaces.</p>
<p>If the option value contains spaces, enclose it in double quotes (</p>
<p>&quot;&quot;</p>
<p>). You may need</p>
<p>to escape backslashes inside quoted strings. The following example shows options</p>
<p>for a simple Top Project:</p>
<p>#!gbuild</p>
<p># Header section</p>
<p>primaryTarget=v800_standalone.tgt</p>
<p>[Project]</p>
<p># Options section</p>
<p>-bsp generic</p>
<p># Use the generic BSP</p>
<p>-G</p>
<p># Generate debug information</p>
<p>-object_dir=&quot;my objs&quot;</p>
<p># Put object files in ./my objs</p>
<p>-DDEBUG -DNOISY</p>
<p># Two preprocessor defines</p>
<p>The project options section ends at the first occurrence of a line that is not a comment</p>
<p>or indented by whitespace.</p>
<p><b>The Children Section</b></p>
<p>The children section lists all files that are children of the project you are editing.</p>
<p>The filenames are not indented, and may use full or relative paths. If you use a</p>
<p>relative path, the Builder tries to resolve the file relative to the current project file's</p>
<p>directory, and then relative to each directory specified by applicable</p>
<p>:sourceDir</p>
<p>options (see âSource Directories Relative to This Fileâ on page 163). If the filename</p>
<p>contains spaces, enclose it in double quotes (</p>
<p>&quot;&quot;</p>
<p>). You may need to escape</p>
<p>backslashes inside quoted strings.</p>
<p><b>Tip</b></p>
<p>If you plan to open your project on hosts that run different operating</p>
<p>systems, always use forward slashes (</p>
<p>/</p>
<p>) when specifying paths or</p>
<p>filenames.</p>
<p>Each line that specifies a child file must specify the file's type in brackets ('</p>
<p>[]</p>
<p>'),</p>
<p>unless it is the default type for that file's extension. For a list of defaults, see âFile</p>
<p><i>959</i></p>
<p><i>Green Hills Software</i></p>
<p><i>The Project Options Section</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Typesâ on page 970. If you do not specify a type and there is no default, it is treated</p>
<p>as a text (<b>.txt</b>) file and is not processed during a build.</p>
<p>For example:</p>
<p># Children section</p>
<p>src_hello/hello.gpj</p>
<p>[Program] # Override default [Subproject]</p>
<p>tgt/resources.gpj</p>
<p>[Project] # Override default [Subproject]</p>
<p>docs/readme_one.txt</p>
<p># Extension sets type to [Text]</p>
<p>docs/readme_two.odd</p>
<p># No default, treated as [Text]</p>
<p>The type you specify for any child project must match the type in that project's</p>
<p>header. For example, if your Top Project includes a child program:</p>
<p>#!gbuild</p>
<p># My Top Project default.gpj</p>
<p>primaryTarget=v800_standalone.tgt</p>
<p>[Project]</p>
<p>src_hello/hello.gpj</p>
<p>[Program] # The child program</p>
<p>The child must have</p>
<p>[Program]</p>
<p>as the file type in its header:</p>
<p>#!gbuild</p>
<p># My Program src_hello/hello.gpj</p>
<p>[Program]</p>
<p># The type specified in the parent</p>
<p>Any indented, non-commented lines immediately following a child entry are treated</p>
<p>as a child options section, which lists options that apply to that child and all of its</p>
<p>children. These options do not apply to the project file you are editing or any of the</p>
<p>child's siblings. Child option sections have the same syntax as the project options</p>
<p>section. For example, if you used the following project file,<b> foo.o</b> would be placed</p>
<p>in<b> objs\special</b>, while<b> hello.o</b> would be placed in<b> objs\hello</b>:</p>
<p>#!gbuild</p>
<p>[Program]</p>
<p># Options Section</p>
<p>-object_dir=objs/hello</p>
<p># Children Section</p>
<p>foo.c</p>
<p># Child options for foo.c</p>
<p>-object_dir=objs/special</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>960</i></p>
<p><i>Appendix C. Green Hills Project File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p>hello.c</p>
<p>tgt/standalone_ram.ld</p>
<p><b>Top Project Directives</b></p>
<p><i>Top Project directives</i> are directives that specify settings for your entire project.</p>
<p>Unless otherwise stated, you can only use them in your Top Project. There are two</p>
<p>groups of these directives:</p>
<p>â¢</p>
<p>Group 1 directives</p>
<p>â¢</p>
<p>Group 2 directives</p>
<p>All group 1 directives must appear before group 2 directives, and all Top Project</p>
<p>directives must appear before the project type line (usually</p>
<p>[Project]</p>
<p>). To add a</p>
<p>Top Project directive:</p>
<p>1.</p>
<p>Edit your Top Project. Type the directive above the line that reads</p>
<p>[Project]</p>
<p>,</p>
<p>remembering that group 1 directives must appear before group 2 directives.</p>
<p>2.</p>
<p>Save and close the file.</p>
<p>3.</p>
<p>Reload the project in the Project Manager.</p>
<p>The following tables list available directives.</p>
<p><b>Group 1 Directives</b></p>
<p>All of these directives are optional.</p>
<p><b>defaultBuildOptions=<i></b> option</i> ...</p>
<p>Takes a space-separated list of<b> gbuild</b> options and applies them to this project and any</p>
<p>subprojects, as if you had passed them on the command line. For example, if you add the line:</p>
<p>defaultBuildOptions=-all</p>
<p>to your Top Project, every file is rebuilt each time you build your project.</p>
<p>For a list of options you can use with this directive, see âThe gbuild Utility Programâ on page 547.</p>
<p><i>961</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Top Project Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>defineConfig</b>(<i>descriptive_name short_name build_configuration_file</i>.gpc)</p>
<p>Defines a project build configuration. Project build configurations allow you to easily build a</p>
<p>single project in different ways. For example, you might want a debug configuration:</p>
<p>defineConfig(Debug dbg debug.gpc)</p>
<p>which sets options that configure your project for maximum debugging ability, and a release</p>
<p>configuration:</p>
<p>defineConfig(Release rel release.gpc)</p>
<p>which sets options that optimize your project for speed and size.</p>
<p>The configuration's</p>
<p><i>descriptive_name</i></p>
<p>should be easy to read and understand. It appears in</p>
<p>a drop-down list that lets you choose between build configurations in the Project Manager.</p>
<p>The</p>
<p><i>short_name</i></p>
<p>should be easy to type. It is used in conditional control statements to indicate</p>
<p>options that only take effect, or files that are only included, when building the</p>
<p><i>short_name</i></p>
<p>configuration. For more information, see âConditional Control Statementsâ on page 965, and</p>
<p>see the description of<b> config</b> in âValid Conditionsâ on page 966.</p>
<p>The pre-defined macro</p>
<p>__CURRCFG</p>
<p>resolves to the short name of the active build configuration.</p>
<p><i>build_configuration_file</i>.gpc</p>
<p>is the path to a file containing options and macros that</p>
<p>only take effect when you build the project in the</p>
<p><i>descriptive_name</i></p>
<p>configuration (see âBuild</p>
<p>Configuration Filesâ on page 964). These options and macros supplement the options and macros</p>
<p>defined elsewhere in your project hierarchy; they do not replace them. The path is resolved</p>
<p>relative to the location of the Top Project file.</p>
<p>If you do not want to use a build configuration file to define configuration-specific settings,</p>
<p>specify</p>
<p>&quot;&quot;</p>
<p>instead of specifying a path to a file.</p>
<p>By default, the first build configuration that you specify is the one that is used when you build</p>
<p>your project via the<b> gbuild</b> command line utility.</p>
<p><b>Note</b></p>
<p>The<b> defineConfig</b> project directive is only supported in MULTI 7 or newer and</p>
<p>Compiler 2015.1 or newer. Using<b> defineConfig</b> will cause a<b> .gpj</b> file to be</p>
<p>incompatible with earlier versions of the Green Hills toolchain and IDE.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>962</i></p>
<p><i>Appendix C. Green Hills Project File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>externalDepends=<i></b> path_to_external_Top_Project</i></p>
<p>Causes<b> gbuild</b> to search the Top Project specified by</p>
<p><i>path_to_external_Top_Project</i></p>
<p>when determining how to build dependencies. This is useful if programs within your Top Project</p>
<p>depend on libraries or objects built by another<b> .gpj</b> project tree.</p>
<p>When you build a program,<b> gbuild</b> locates the Top Project specified by</p>
<p>externalDepends</p>
<p>and automatically builds the dependencies if they are not current. For more information, see</p>
<p>âImplicit Dependency Analysisâ on page 555.</p>
<p>To specify that a particular build configuration of another Top Project should be used when</p>
<p>building dependencies, enclose that configuration's</p>
<p><i>descriptive_name</i></p>
<p>or</p>
<p><i>short_name</i></p>
<p>in</p>
<p>square brackets after giving the location of the Top Project. For example:</p>
<p>externalDepends=${__BSP_DIR}/default.gpj</p>
<p>[Debug]</p>
<p>For more information, see the description of</p>
<p>defineConfig</p>
<p>above.</p>
<p><b>Tip</b></p>
<p>The</p>
<p>externalDepends</p>
<p>directive may be specified in a Top Project file or in a</p>
<p>build configuration file (see âBuild Configuration Filesâ on page 964). Specifying</p>
<p>it in a build configuration file is useful if dependencies are only present in one</p>
<p>configuration of the project, or if both the project with the dependency and the</p>
<p>linked project can be built in multiple configurations. For example, you might want</p>
<p>to link from one</p>
<p>Debug</p>
<p>configuration to another</p>
<p>Debug</p>
<p>configuration, and from</p>
<p>one</p>
<p>Release</p>
<p>configuration to another</p>
<p>Release</p>
<p>configuration.</p>
<p><i>963</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Group 1 Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>gbuildDir=<i></b> directory</i></p>
<p>Specifies a relative or absolute path to the Compiler installation directory that the MULTI Project</p>
<p>Manager uses to build this project. Relative pathnames are resolved relative to the location of</p>
<p>the Top Project file.</p>
<p>This directive is useful if you want to build a particular project using a different version of the</p>
<p>Compiler than the one that the MULTI IDE is linked with. For example, if you recently upgraded</p>
<p>and linked MULTI to a newer Compiler, but you still want to build a particular project with</p>
<p>your old Compiler, you can use this directive. Overriding the Compiler installation directory in</p>
<p>this way only changes the tools used to build the project; it does not override any other MULTI</p>
<p>IDE functionality that uses the Compiler installation. For example, the Help Viewer does not</p>
<p>display manuals from the specified Compiler installation directory; it displays manuals from</p>
<p>the linked Compiler installation directory.</p>
<p>Using the MULTI IDE to debug programs that are built with this directive is only supported if:</p>
<p>1.</p>
<p>The specified Compiler installation directory contains a version of the Compiler that is</p>
<p>compatible with the version of the MULTI IDE used.</p>
<p>2.</p>
<p>Both the specified Compiler installation directory and the Compiler installation directory</p>
<p>that is linked with the MULTI IDE support the target specified for the project.</p>
<p>This directive only affects projects built from the Project Manager; it is ignored by the<b> gbuild</b></p>
<p>utility program.</p>
<p><b>import<i></b> variable_name</i></p>
<p>Imports the environment variable named<i> variable_name</i> from the local environment.</p>
<p><b>macro<i></b> macro_name</i>=<i>value</i></p>
<p>Defines a new macro with the given name and value. There must not be any spaces between</p>
<p><i>macro_name</i>,</p>
<p>=</p>
<p>, and<i> value</i>.</p>
<p><b>Build Configuration Files</b></p>
<p>Build configuration files specified as part of a</p>
<p>defineConfig</p>
<p>directive (see âGroup</p>
<p>1 Directivesâ on page 961) should be formatted as follows:</p>
<p>#!gbuild</p>
<p># Macros for the project build configuration go here (optional)</p>
<p># externalDepends for the project build configuration go here (optional)</p>
<p>[Build Configuration]</p>
<p># Options for the project build configuration go here</p>
<p>The first line (</p>
<p>#!gbuild</p>
<p>) and the file type (</p>
<p>[Build Configuration]</p>
<p>) are</p>
<p>required.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>964</i></p>
<p><i>Appendix C. Green Hills Project File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Macro definitions and</p>
<p>externalDepends</p>
<p>directives are optional. Macro definitions</p>
<p>follow the same format used in project file headers. For more information, see âThe</p>
<p>Header Sectionâ on page 957.</p>
<p>Each line containing an option must begin with a whitespace. Option lines may use</p>
<p>macros.</p>
<p><b>Group 2 Directives</b></p>
<p><b>customization=<i></b> customization_file</i></p>
<p>This optional directive specifies a customization (<b>.bod</b>) file for your project. You can use this</p>
<p>directive multiple times.</p>
<p>For more information about customization files, see Appendix E, âCustomization Filesâ</p>
<p>on page 983.</p>
<p><b>primaryTarget=<i></b> target_file</i></p>
<p>This required directive specifies the target file for your project. This is one of the<b> .tgt</b> files</p>
<p>included in the MULTI distribution that contains all of the target-specific settings necessary to</p>
<p>compile code for your target.</p>
<p><b>Conditional Control Statements</b></p>
<p>Conditional control statements reside in the project file and are used to indicate to</p>
<p>the Builder the portion of the project tree and options used in the build process.</p>
<p>These control statements are especially useful when one portion of the project tree</p>
<p>is built in multiple ways (for example, multiple targets). Each statement is evaluated</p>
<p>during the build using information from the current file in the project tree and all</p>
<p>of its parents. If the statement evaluates to true, the option or file is included in the</p>
<p>build. If the statement evaluates to false, the option or file is silently skipped.</p>
<p>Some rules for using conditional control statements are:</p>
<p>â¢</p>
<p>You can only specify these statements by manually editing the<b> .gpj</b> files.</p>
<p>â¢</p>
<p>Conditional control statements can be used with options or filenames. The</p>
<p>syntax is</p>
<p>{<i>condition</i>}</p>
<p>before the option or filename. For example:</p>
<p>{VERSION&gt;5} ver5.c</p>
<p>{isdefined(DEBUG)} -DDEBUG</p>
<p><i>965</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Group 2 Directives</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>You can specify more than one conditional control statement. All statements</p>
<p>must evaluate to true for the file to be included in the build. For example:</p>
<p>{optional}{isdefined(SUPPORTS_DSP)} dsp_subsystem.gpj</p>
<p><b>Note</b></p>
<p>Conditional control statements applied to options must have a whitespace</p>
<p>before them in order to function properly.</p>
<p><b>Valid Conditions</b></p>
<p>The following are valid conditions for conditional control statements:</p>
<p><b>command=<i>command_name</b></i></p>
<p>The option or file is included when building the project if the current file is processed using the</p>
<p>specified command.</p>
<p><i>command_name</i> must be the same as the</p>
<p>command</p>
<p>property specified in the</p>
<p>FileType</p>
<p>section</p>
<p>of the<b> .bod</b> file (see âComponents of Customization Filesâ on page 984).</p>
<p><b>comment</b></p>
<p>The file is never included when building the project, and is disabled in the Project Manager.</p>
<p><b>comment</b> applies to source or project files, but not options.</p>
<p><b>config(<i>short_name</i>)</b></p>
<p>The option or file is included when you build the project in the configuration indicated by</p>
<p><i>short_name</i></p>
<p>, which is one of the names defined for the build configuration in the Top Project</p>
<p>file. For more information, see âThe Header Sectionâ on page 957.</p>
<p><b>filetype=<i>filetype</b></i></p>
<p>The option is included when building the project if the current file is of the specified type.</p>
<p><i>filetype</i> must match the</p>
<p>name</p>
<p>property specified in the</p>
<p>FileType</p>
<p>section of the<b> .bod</b> file (see</p>
<p>âFile Type Definitionsâ on page 985).</p>
<p><b>filetype=<i>filetype</b></i> is only useful for options that are inherited by multiple types.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>966</i></p>
<p><i>Appendix C. Green Hills Project File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><i><b>expression</b></i></p>
<p>The option or file is included when building the project if the expression evaluates to</p>
<p>true</p>
<p>. The</p>
<p>expression can include macros, unsigned integers, the following functions, standard Boolean</p>
<p>operators, and standard comparison operators. If you pass a string to one of the following</p>
<p>functions and that string begins with a numerical digit, you must put quotes (</p>
<p>&quot;</p>
<p>) around the string.</p>
<p>The following are accepted functions:</p>
<p>â¢</p>
<p>isdefined(<i>macro_name</i>)</p>
<p>â Evaluates to</p>
<p>true</p>
<p>if</p>
<p><i>macro_name</i></p>
<p>is currently defined,</p>
<p>and</p>
<p>false</p>
<p>otherwise.</p>
<p>â¢</p>
<p>isundefined(<i>macro_name</i>)</p>
<p>â Evaluates to</p>
<p>true</p>
<p>if</p>
<p><i>macro_name</i></p>
<p>is not currently</p>
<p>defined, and</p>
<p>false</p>
<p>otherwise.</p>
<p>â¢</p>
<p>istarget(<i>target_name</i>)</p>
<p>â Evaluates to</p>
<p>true</p>
<p>if</p>
<p><i>target_name</i></p>
<p>is equal to the name</p>
<p>of the project target, and</p>
<p>false</p>
<p>otherwise. The string</p>
<p><i>target_name</i></p>
<p>corresponds to the</p>
<p>base name of the<b> .tgt</b> file defined as the</p>
<p>primaryTarget</p>
<p>in your Top Project. The</p>
<p>comparison is case-insensitive, and<i> target_name</i> must not include the<b> .tgt</b> extension when</p>
<p>used in this conditional expression. For example, if the target is<b> v800_standalone.tgt</b>, then</p>
<p>istarget(&quot;v800_standalone&quot;)</p>
<p>will evaluate to</p>
<p>true</p>
<p>.</p>
<p>â¢</p>
<p>streq(<i>macro_name</i>,<i> string</i>, ...)</p>
<p>â Evaluates to</p>
<p>true</p>
<p>if the string value of</p>
<p><i>macro_name</i></p>
<p>is equal to that of one or more of the provided<i> string</i> arguments, and</p>
<p>false</p>
<p>otherwise. The comparison is case-sensitive.</p>
<p>â¢</p>
<p>strprefix(<i>macro_name</i>,<i> string</i>, ...)</p>
<p>â Evaluates to</p>
<p>true</p>
<p>if one or more of the</p>
<p>provided<i> string</i> arguments are a prefix of the string value of<i> macro_name</i>, and</p>
<p>false</p>
<p>otherwise. The comparison is case-sensitive.</p>
<p><b>Note:</b> Macros used in a macro expression must be valid C identifiers.</p>
<p>The following are accepted operators:</p>
<p>â¢</p>
<p>Standard Boolean operators â</p>
<p>!</p>
<p>,</p>
<p>&amp;&amp;</p>
<p>, and</p>
<p>||</p>
<p>â¢</p>
<p>Standard comparison operators â</p>
<p>&gt;=</p>
<p>,</p>
<p>&lt;=</p>
<p>,</p>
<p>&gt;</p>
<p>,</p>
<p>&lt;</p>
<p>,</p>
<p>==</p>
<p>and</p>
<p>!=</p>
<p>For example:</p>
<p>{ isdefined(DEBUG_LEVEL) &amp;&amp; DEBUG_LEVEL &gt; 0 } -G</p>
<p><b>nobuild</b></p>
<p>The file is never included when building the project, but is still included in the Project Manager.</p>
<p><b>nobuild</b> applies to source or project files, but not options.</p>
<p><i>967</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Valid Conditions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>optgroup=<i>option_group</b></i></p>
<p>The option or file is included if the command used to process the current file supports the</p>
<p>specified option group. If you have two different tools that support the same option string, but</p>
<p>the behavior of the option is different for each program, you should consider using this option</p>
<p>in your Project file.</p>
<p>For example, if you have a Green Hills Compiler and a custom IDL compiler that both support</p>
<p>the<b> -r</b> option, and you want to pass this option to every file compiled by the IDL compiler, you</p>
<p>might add the following line to your Top Project:</p>
<p>{optgroup=MyIDLCompilerOptions} -r</p>
<p>For more information about option groups and configuration files, see âComponents of</p>
<p>Customization Filesâ on page 984.</p>
<p><b>optional</b></p>
<p>When applied to a file, the current file is only included when building the project if the file</p>
<p>exists.</p>
<p>When applied to an option, the option is only included when building the project if the option</p>
<p>is supported by the current target.</p>
<p><b>pass=</b> [COMPILE] [LINK] [DEPEND] [FIRSTPASS] [ALL]</p>
<p>Causes the controlled option to only be used during the specified processing pass.<b> pass=</b> only</p>
<p>applies to options.</p>
<p><b>rebuild</b></p>
<p>Causes the current file to be rebuilt every time the project is built.<b> rebuild</b> only applies to source</p>
<p>files (not<b> .gpj</b> files or options).</p>
<p><b>Special Conditions for Select One Projects</b></p>
<p>The following are special conditions for conditional control statements. They can</p>
<p>only be applied to<i> Select One<b></i> .gpj</b> files. These control statements do not selectively</p>
<p>include or exclude the project that they are applied to. Instead, they control the</p>
<p>printing of warning and errors when processing Select One project files.</p>
<p><b>selectone_optional</b></p>
<p>If an assembly file corresponding to the current target or a C file is not specified, the project is</p>
<p>silently ignored. This behavior is similar to the effect of the<b> {optional}</b> condition when applied</p>
<p>to files.</p>
<p><b>selectone_required</b></p>
<p>If an assembly file corresponding to the current target or a C file is not specified, an error is</p>
<p>generated, which stops the build.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>968</i></p>
<p><i>Appendix C. Green Hills Project File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Macro Functions</b></p>
<p>Macro functions allow you to define a macro that does not have a static value.</p>
<p>Instead, the value is determined by evaluating a function. You can place them</p>
<p>wherever you could place a standard macro. To place a macro function, use the</p>
<p>following syntax:</p>
<p>${macro_function}</p>
<p>Macro functions can contain references to standard macros. The available macro</p>
<p>functions are:</p>
<p>%expand_path(<i>relative_path</i>)</p>
<p>Expands<i> relative path</i> to an absolute path.<i> relative_path</i> is resolved relative to the directory that</p>
<p>contains the Top Project. For example:</p>
<p>macro SCRIPTS=${%expand_path(../scripts)}</p>
<p>%option_value(<i>option_name</i>)</p>
<p>Given a name of an option, this function returns the option's set value. This function only supports</p>
<p>options that take string arguments.</p>
<p><i>option_name</i> must match the</p>
<p>name</p>
<p>parameter of the option as defined in the<b> .bod</b> file, and must</p>
<p>include the dash or other punctuation that normally accompanies the option name (for example,</p>
<p>-os_dir</p>
<p>). Do not quote the option name.</p>
<p>This function searches the entire set of options that apply to the build item in which it is used.</p>
<p>If the specified option is not set, or if the option does not take a string argument, this function</p>
<p>returns an empty string and issues a warning.</p>
<p>For example:</p>
<p>-DTHE_OS_DIR=${%option_value(-os_dir)}</p>
<p>For more information about macros, see the documentation about setting build</p>
<p>macros in the<i> MULTI: Managing Projects and Configuring the IDE</i> book.</p>
<p><i>969</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Macro Functions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>File Types</b></p>
<p>You may encounter the following types in your project files:</p>
<p>â¢</p>
<p>Project Files (<b>.gpj</b>):</p>
<p>â</p>
<p>Auto Include</p>
<p>â Pulls into a project the contents, or subset of the</p>
<p>contents, of a specific directory. This file type cannot specify any children,</p>
<p>and must contain the<b> :autoInclude</b> option. While this file behaves similarly</p>
<p>to a project file, it has the<b> .auto</b> extension. For more information about</p>
<p>Auto Include</p>
<p>, see the documentation about auto include in the<i> MULTI:</i></p>
<p><i>Managing Projects and Configuring the IDE</i> book.</p>
<p>â</p>
<p>Library</p>
<p>â A project file to output a compiled library.</p>
<p>â</p>
<p>Merged Library</p>
<p>â A project file that allows you to combine multiple</p>
<p>high-level source files, assembly files, libraries and objects into a single</p>
<p>library file.<b> Relocatable Object</b> files are not supported. For more</p>
<p>information, see âCreating a Library from the Compiler Driverâ</p>
<p>on page 516.</p>
<p>â</p>
<p>Program</p>
<p>â A project file to output an executable.</p>
<p>â</p>
<p>Project</p>
<p>â General project file. These general purpose containers can</p>
<p>also be used to group</p>
<p>Programs</p>
<p>and</p>
<p>Libraries</p>
<p>.</p>
<p>â</p>
<p>Reference</p>
<p>â A file type that allows you to import a project subtree</p>
<p>anywhere in the build hierarchy without forcing it to inherit the options</p>
<p>of the project that it is included in. A</p>
<p>Reference</p>
<p>project file must begin</p>
<p>with the</p>
<p>[Reference]</p>
<p>tag, include a single<b> :reference</b> option (see</p>
<p>âReferenceâ on page 286), and must not have any children. When you build</p>
<p>your project, the subtree is considered a child of the</p>
<p>Reference</p>
<p>project,</p>
<p>but it does not inherit the</p>
<p>Reference</p>
<p>project's options or those of its</p>
<p>parents.</p>
<p>â</p>
<p>Relocatable Object</p>
<p>â A project file to output a relocatable object</p>
<p>containing the compiled code from one or more source files.</p>
<p>â</p>
<p>Select One</p>
<p>â A project file that contains multiple source files, only</p>
<p>one that is used in the build. These projects are used for</p>
<p>multiple-architecture hierarchies (see the documentation about building</p>
<p>platform specific programs from the same source files in the<i> MULTI:</i></p>
<p><i>Managing Projects and Configuring the IDE</i> book).</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>970</i></p>
<p><i>Appendix C. Green Hills Project File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â</p>
<p>Shared Object</p>
<p>â A project file to output a shared library. These projects</p>
<p>are only available for some target operating systems.</p>
<p>â</p>
<p>Singleton Library</p>
<p>â A project file to output a library containing a</p>
<p>single object file. The library is forced into the final executable.</p>
<p>â</p>
<p>Subproject</p>
<p>â A project file to group files within a project, but which</p>
<p>does not output anything itself.</p>
<p>Subprojects</p>
<p>differ from</p>
<p>Projects</p>
<p>in</p>
<p>that files contained within them are included in the link of their parent</p>
<p>project. This is the default file type for files with a<b> .gpj</b> extension.</p>
<p>â</p>
<p>INTEGRITY Application</p>
<p>â A project file that contains one or more</p>
<p>virtual AddressSpaces. It outputs an image for dynamic download, or it</p>
<p>outputs a stand-alone executable with a kernel, depending on options.</p>
<p>â¢</p>
<p>Source and Object Files:</p>
<p>â</p>
<p>Assembly</p>
<p>(<b>.s</b>,<b> .asm</b>,<b> .<i>target</b></i>) â Assembly language source files. For the</p>
<p>value of</p>
<p><i>target</i></p>
<p>, see âRecognized Input File Typesâ on page 7.</p>
<p>â</p>
<p>C</p>
<p>(<b>.c</b>) â C source files.</p>
<p>â</p>
<p>C++</p>
<p>(<b>.cc</b>,<b> .cpp</b>,<b> .cxx</b>,<b> .c++</b>,<b> .C</b>,<b> .CXX</b>,<b> .CPP</b>) â C++ source files.</p>
<p>â</p>
<p>Header</p>
<p>(<b>.h</b>,<b> .hh</b>,<b> .H</b>,<b> .h++</b>,<b> .hxx</b>,<b> .hpp</b>) â C and C++ header files.</p>
<p>â</p>
<p>Linker Raw File</p>
<p>â A file containing raw data that the linker imports</p>
<p>into the final program.</p>
<p>â</p>
<p>Object</p>
<p>(<b>.o</b>) â Object files.</p>
<p>â</p>
<p>Prebuilt Library</p>
<p>(<b>.a</b>) â Library file of object modules. These are</p>
<p>usually used to specify binary libraries when there is no source available.</p>
<p>â¢</p>
<p>Target Resource Files:</p>
<p>â</p>
<p>Board Setup</p>
<p>(<b>.mbs</b>,<b> .dbs</b>) â Setup script file for initializing your target</p>
<p>board.</p>
<p>â</p>
<p>Linker Directives</p>
<p>(<b>.ld</b>,<b> .lnk</b>) â Linker directives file that contains a</p>
<p>memory map for the target board and a section map for the program. For</p>
<p>more information about the file format, see âConfiguring the Linker with</p>
<p>Linker Directives Filesâ on page 475.</p>
<p>â</p>
<p>Target Connections</p>
<p>(<b>.con</b>) â Target configuration information for</p>
<p>connecting through a debug server (see the documentation about connecting</p>
<p>to your target in the<i> MULTI: Debugging</i> book).</p>
<p>â</p>
<p>Script</p>
<p>(<b>.rc</b>,<b> .irc</b>,<b> .prc</b>) â MULTI command scripts.</p>
<p><i>971</i></p>
<p><i>Green Hills Software</i></p>
<p><i>File Types</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>INTEGRITY files:</p>
<p>â</p>
<p>BSP Description</p>
<p>(<b>.bsp</b>)</p>
<p>â Target-specific description file used by the<b> Integrate</b> utility.</p>
<p>â</p>
<p>Integrate file</p>
<p>(<b>.int</b>) â Configuration file for specifying the existence</p>
<p>of and relationships between various kernel objects.</p>
<p>â¢</p>
<p>Build Configuration Files (<b>.gpc</b>):</p>
<p>â</p>
<p>Build Configuration</p>
<p>â An options file that only takes effect when</p>
<p>you build your project in a particular configuration.</p>
<p>â¢</p>
<p>Documentation:</p>
<p>â</p>
<p>Portable Document Format</p>
<p>(<b>.pdf</b>) â Adobe PDF files.</p>
<p>â</p>
<p>Text</p>
<p>(<b>.txt</b>) â Generic text files. This type is used by default for</p>
<p>unclassified file extensions.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>972</i></p>
<p><i>Appendix C. Green Hills Project File Format</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Appendix D</b></p>
<p><b>Porting an Existing Project</b></p>
<p><b>to Use Build Configurations</b></p>
<p><b>Contents</b></p>
<p>Build Configuration Quick Start . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>974</p>
<p>Setting Configuration-Specific Files and Options Outside of Build</p>
<p>Configuration Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>975</p>
<p>Defining Unique Output Directories for Build Configurations . . . . . . . . . . . .</p>
<p>976</p>
<h1 style="page-break-before:always; "></h1>
<p>Project build configurations allow you to easily build a single project in two or</p>
<p>more different ways. For example, you can define a debug configuration and a</p>
<p>release configuration with different build options set and/or different project macros</p>
<p>defined for each.</p>
<p>Build configurations are defined in the header of the Top Project file.</p>
<p>Configuration-specific options and macros are specified in build configuration files</p>
<p>(<b>.gpc</b>).</p>
<p><b>Build Configuration Quick Start</b></p>
<p>Follow these steps to set up different configurations of your project:</p>
<p>1.</p>
<p>Determine which project-wide options and macros you want to set in each</p>
<p>configuration. Any options and macros that you do not want to be shared by</p>
<p>all configurations should be specified in a build configuration file (<b>.gpc</b>). These</p>
<p>options and macros affect the entire project, but only when it is built in the</p>
<p>configuration to which the<b> .gpc</b> file applies. For example, setting the<b> -Odebug</b></p>
<p>option in<b> debug.gpc</b> affects the entire project when it is built in the debug</p>
<p>configuration.</p>
<p>2.</p>
<p>Use a text editor to create your build configuration files. Format them as</p>
<p>specified in âBuild Configuration Filesâ on page 964.</p>
<p>3.</p>
<p>Make sure that the options you want to uniquely define for a configuration are</p>
<p>set only in the appropriate build configuration file, not in a project file, which</p>
<p>applies to all configurations. This is important to keep in mind when porting</p>
<p>projects because you may have set options in a build configuration file that</p>
<p>were already set in a project file. In this case, remove the options from the</p>
<p>project file.</p>
<p>4.</p>
<p>Define each of your configurations in the header of your project's Top Project</p>
<p>file. To do so, add a<b> defineConfig</b> line for each configuration. For example:</p>
<p>defineConfig(Debug</p>
<p>dbg debug.gpc)</p>
<p>defineConfig(Release rel release.gpc)</p>
<p>For more information about the<b> defineConfig</b> directive, see âGroup 1</p>
<p>Directivesâ on page 961. For information about where in the header to specify</p>
<p><b>defineConfig</b>âa group 1 directiveâsee âTop Project Headersâ on page 958.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>974</i></p>
<p><i>Appendix D. Porting an Existing Project to Use Build Configurations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>5.</p>
<p>Open your project in the Project Manager, select each configuration and build</p>
<p>it.</p>
<p>Alternatively, build from the command line by running<b> gbuild</b> with the<b> -cfg</b></p>
<p>option to specify the configuration you want to build. For example:</p>
<p>gbuild -cfg=rel</p>
<p>If you do not specify a configuration, the first one defined in your project is</p>
<p>built.</p>
<p><b>Setting Configuration-Specific Files and Options Outside of Build</b></p>
<p><b>Configuration Files</b></p>
<p>In addition to setting configuration-specific options and macros in your build</p>
<p>configuration files, you can also indicate that any option or file in a project file</p>
<p>applies only to one or more configurations.</p>
<p>You can specify that an option is configuration specific when you set it via the</p>
<p>Project Manager's option editing dialog. The Project Manager automatically inserts</p>
<p>a conditional control statement for the option in the designated project file, indicating</p>
<p>that the option should only take effect when you build the specified configuration.</p>
<p>If you want to bypass the GUI, open the project file in a text editor and manually</p>
<p>insert the conditional control statement, formatting it as described in âConditional</p>
<p>Control Statementsâ on page 965. Use the<b> config</b> condition (see âValid Conditionsâ</p>
<p>on page 966). For example:</p>
<p>{config(dbg)} -Odebug</p>
<p>{config(rel)} -Osize</p>
<p>To indicate that a file is configuration specific, you must use a text editor and</p>
<p>manually insert the conditional control statement in the project file. Again, use the</p>
<p><b>config</b> condition. For example:</p>
<p>{config(dbg)} debug_hooks.c</p>
<p>{config(rel)} hand_optimized_algorithm.asm</p>
<p><i>975</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Setting Configuration-Specific Files and Options Outside of Build Configuration Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Defining Unique Output Directories for Build Configurations</b></p>
<p>For most projects, it is easiest to start with all configurations building into the output</p>
<p>location used by the project before build configurations were introduced. However,</p>
<p>sharing one output location for all build configurations has a major drawback: each</p>
<p>time you want to switch to a different configuration, you need to rebuild the entire</p>
<p>project. Rebuilding is required to ensure the entire project is built according to the</p>
<p>newly chosen build configuration.</p>
<p>To eliminate this requirement, use a unique output location for each configuration.</p>
<p>To do so, you must update:</p>
<p>â¢</p>
<p>All output directories set in your project.</p>
<p>â¢</p>
<p>Any input directory paths that rely on any of those output directories.</p>
<p><b>Updating Output Directories</b></p>
<p>To set output locations based on the configuration, you will need to do one of the</p>
<p>following:</p>
<p>â¢</p>
<p>Specify the necessary output location settings in each build configuration file</p>
<p>(<b>*.gpc</b>).</p>
<p>â¢</p>
<p>Use configuration-specific macros in output location settings throughout your</p>
<p>project files.</p>
<p>The first option usually only makes sense for small projects. If your project already</p>
<p>sets output locations in multiple places, you should use the second option.</p>
<p>The best way to set up a unique output location for each configuration is to include</p>
<p>the name of the configuration in the name of the output directory. You can then use</p>
<p>the</p>
<p>__CURRCFG</p>
<p>macro, which resolves to the short name of the active build</p>
<p>configuration, when setting output locations in your files. For example, you could</p>
<p>specify the following options in your Top Project:</p>
<p>:outputDir=${__CURRCFG}/work</p>
<p>-object_dir=${__CURRCFG}/work</p>
<p>:binDir=${__CURRCFG}/bin</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>976</i></p>
<p><i>Appendix D. Porting an Existing Project to Use Build Configurations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>This would result in an output directory structure like the following:</p>
<p>dbg/</p>
<p>work</p>
<p>bin</p>
<p>rel/</p>
<p>work</p>
<p>bin</p>
<p>Output locations are commonly specified using one or more of the following options:</p>
<p>â¢</p>
<p><b>-object_dir</b></p>
<p>â¢</p>
<p><b>:outputDir</b></p>
<p>â¢</p>
<p><b>:outputDirRelative</b></p>
<p>â¢</p>
<p><b>:binDir</b></p>
<p>â¢</p>
<p><b>:binDirRelative</b></p>
<p>In addition to updating the commonly used output directory options listed above,</p>
<p>update any option in your project that specifies the path to an output location (for</p>
<p>example,<b> -srec=c:\<i>path</i>\<i>to</i>\prog.srec</b>). You do not need to update options that only</p>
<p>specify a filename (for example,<b> -srec=prog.srec</b>).</p>
<p><b>Tip</b></p>
<p>Once you change the output location specified in your project, the Builder</p>
<p>does not remember the old output location. As a result, you should do a</p>
<p>clean build<i> before</i> changing the output location; otherwise, you will need</p>
<p>to manually remove files from the old location(s).</p>
<p><b>Updating Input Directories</b></p>
<p>In addition to setting output locations, you must also update any project settings</p>
<p>that use files from those locations. Most commonly, this means updating your library</p>
<p>include paths (<b>-L</b>) to reference the new output locations.</p>
<p>For example, if your Top Project includes:</p>
<p>-L.</p>
<p><i>977</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Updating Input Directories</i></p>
<h1 style="page-break-before:always; "></h1>
<p>update it to something like:</p>
<p>-L${__CURRCFG}/bin</p>
<p><b>Handling Custom File Types</b></p>
<p>Files built using a custom processing tool defined in a customization (<b>.bod</b>) file</p>
<p>may need special attention when you modify output directories.</p>
<p>If you are specifying the output location in the processing tool's command definition,</p>
<p>use the</p>
<p>$OUTPUTDIR</p>
<p>variable in the command definition, and the Builder will</p>
<p>substitute the correct output location for you based on the settings in the project.</p>
<p>This allows you to specify an output directory to the tool without needing to set a</p>
<p>tool-specific option in your project file.</p>
<p>In addition to updating the output locations for custom processing tools, you may</p>
<p>also need to update the project settings that look for these files. Common options</p>
<p>that may need updating include:</p>
<p>â¢</p>
<p><b>-I</b></p>
<p>â¢</p>
<p><b>:sourceDir</b></p>
<p>â¢</p>
<p><b>:sourceDirNonRelative</b></p>
<p>For example, if your project uses a tool to convert data files into source code, and</p>
<p>that source code's location is specified with:</p>
<p>-Igenerated</p>
<p>update it to something like:</p>
<p>-I${__CURRCFG}/generated</p>
<p><b>Verifying Correctness</b></p>
<p>To verify that each configuration of your project is built into a unique output location,</p>
<p>follow these steps:</p>
<p>1.</p>
<p>Ensure that your project's output directories are empty.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>978</i></p>
<p><i>Appendix D. Porting an Existing Project to Use Build Configurations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>2.</p>
<p>Build the first configuration of your project. Does it build successfully? Did</p>
<p>it build into the location you expected?</p>
<p>3.</p>
<p>If you answered yes to both questions, build the next configuration of your</p>
<p>project using the<b> -strict_config</b> option to<b> gbuild</b>. For example:</p>
<p>gbuild -cfg=rel -strict_config</p>
<p>The<b> -strict_config</b> option forces a build error if output from the second build</p>
<p>will overwrite previously built output.</p>
<p>Did the entire project build, with no errors, into a new location? Was it the</p>
<p>location you expected?</p>
<p>If you defined three or more configurations, repeat step 3 as necessary.</p>
<p>We recommend that you always build with the<b> -strict_config</b> option. To make a</p>
<p>project act as if you passed this option on the command line with every build, add</p>
<p>the<b> defaultBuildOptions</b> directive to the header of your Top Project:</p>
<p>defaultBuildOptions=-strict_config</p>
<p><b>defaultBuildOptions</b> is a group 1 directive. For information about where in the</p>
<p>header to specify group 1 directives, see âTop Project Headersâ on page 958.</p>
<p><b>Helpful Tricks</b></p>
<p>â¢</p>
<p>If the build output for a single configuration contains more than one</p>
<p>subdirectory, we recommend:</p>
<p>Creating a macro in your Top Project for your output base location. Be sure to</p>
<p>specify the root directory of a relative path using the</p>
<p>%expand_path()</p>
<p>function. For example:</p>
<p>macro OUTPUT_BASE=${%expand_path(.)}/${__CURRCFG}</p>
<p>or:</p>
<p>macro OUTPUT_BASE=${%expand_path(.)}/output/${__CURRCFG}</p>
<p><i>979</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Helpful Tricks</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Then, everywhere you need to specify an output subdirectory, use the macro:</p>
<p>-object_dir=${OUTPUT_BASE}/subdir</p>
<p>â¢</p>
<p>You can view commands the Builder executes as it builds. This may be useful</p>
<p>for determining exactly how various tools are being run. To view Builder</p>
<p>commands, do one of the following:</p>
<p>â</p>
<p>From the Project Manager, select<b> Build</b> â<b> Advanced Build</b>, and select</p>
<p><b>Show tool commands</b>.</p>
<p>â</p>
<p>From the command line, run<b> gbuild</b> with the<b> -commands</b> option.</p>
<p><b>Additional Options to Check</b></p>
<p>The options that most commonly need to be updated are identified in the preceding</p>
<p>sections. However, any option that allows you to specify a path may need to be</p>
<p>updated when you start using a unique output directory for each build configuration.</p>
<p>The following list identifies less common directory options and options that may,</p>
<p>but do not commonly, include path information in their arguments. This list is not</p>
<p>exhaustive.</p>
<p>Output:</p>
<p>â¢</p>
<p><b>-headerfiledir</b></p>
<p>â¢</p>
<p><b>--instantiation_dir</b></p>
<p>â¢</p>
<p><b>-list_dir</b></p>
<p>â¢</p>
<p><b>-double_check.report</b></p>
<p>â¢</p>
<p><b>-hex</b></p>
<p>â¢</p>
<p><b>-list</b></p>
<p>â¢</p>
<p><b>-memory</b></p>
<p>â¢</p>
<p><b>-o</b></p>
<p>â¢</p>
<p><b>-srec</b></p>
<p>Input:</p>
<p>â¢</p>
<p><b>-includefiledir</b></p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>980</i></p>
<p><i>Appendix D. Porting an Existing Project to Use Build Configurations</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><b>-startfile_dir</b></p>
<p>â¢</p>
<p><b>-directive_dir</b></p>
<p><i>981</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Additional Options to Check</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Appendix E</b></p>
<p><b>Customization Files</b></p>
<p><b>Contents</b></p>
<p>Components of Customization Files . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>984</p>
<p>Extended Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>989</p>
<p>Customization File Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>995</p>
<h1 style="page-break-before:always; "></h1>
<p><b>Components of Customization Files</b></p>
<p>Customization files, or<b> .bod</b> files, are used to customize your build environment</p>
<p>by defining acceptable input file types and how to build them. Customization files</p>
<p>contain three types of definitions:</p>
<p>â¢</p>
<p>FileTypes</p>
<p>â Definitions of types of files that can be built or included in</p>
<p>project files.</p>
<p>â¢</p>
<p>Commands</p>
<p>â Definitions of the commands used to build or edit the various</p>
<p>file types.</p>
<p>â¢</p>
<p>CommandOptions</p>
<p>â Definitions of the options supported by the commands</p>
<p>defined in the</p>
<p>Commands</p>
<p>section. These definitions are broken into option</p>
<p>groups, where each group represents the options supported by one or more</p>
<p>commands.</p>
<p>The following sections describe the purpose of each type of definition and its syntax</p>
<p>by using the custom file type demo project available from the Project Manager. For</p>
<p>information about creating a project including this example, see the documentation</p>
<p>about creating a project in the<i> MULTI: Managing Projects and Configuring the</i></p>
<p><i>IDE</i> book.</p>
<p><b>Note</b></p>
<p>If you are writing a customization file for use with both Windows and</p>
<p>Linux/Solaris hosts, we recommend that you use forward slashes (</p>
<p>/</p>
<p>)</p>
<p>when specifying any pathnames.</p>
<p><b>Note</b></p>
<p>The Green Hills tools use<b> .bod</b> files to define the file types, commands,</p>
<p>and options available by default. These<b> .bod</b> files are a useful resource</p>
<p>as you create your own customization file. The<b> .bod</b> files can be found</p>
<p>in the<b> defaults/bld_rules</b> subdirectory of your MULTI installation. The</p>
<p>file<b> ghs_filetypes.bod</b> contains file type and command definitions. The</p>
<p>files<b> ghs_*_options.bod</b> contain the command option definitions. Use</p>
<p>these files for reference only; do not modify them.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>984</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Customization File Definitions</b></p>
<p>The following section will provide you with definitions used in<b> .bod</b> files, as well</p>
<p>as examples for creating a customized file.</p>
<p><b>File Type Definitions</b></p>
<p>The</p>
<p>FileTypes</p>
<p>section of a customization file defines additional types of files that</p>
<p>can be built as part of your project. The definitions in this section provide the Green</p>
<p>Hills tools with information about how to identify and process these files.</p>
<p>FileTypes {</p>
<p># FileTypes defines our custom types and how to</p>
<p># fill in the command arguments</p>
<p>BinInput {</p>
<p># Here we've created a new custom type called &quot;Binary Input&quot;</p>
<p>name=&quot;Binary Input&quot;</p>
<p># This is the default file type for files with the .bin extension.</p>
<p>extensions={&quot;bin&quot;}</p>
<p># It outputs .c files (used for -clean).</p>
<p>outputExtension=&quot;c&quot;</p>
<p># It outputs source files instead of object files.</p>
<p>outputType=&quot;SourceFile&quot;</p>
<p># Do not perform grep operations on this input.</p>
<p>grepable=false</p>
<p># Use the matching command from the Commands section below.</p>
<p>command=&quot;GHS Binary Converter&quot;</p>
<p># Specifies the exact command line using</p>
<p># variables to substitute for context-sensitive elements.</p>
<p>commandLine=&quot;$COMMAND $OPTIONS $INPUTFILE -o $OUTPUTFILE&quot;</p>
<p># What to show in the progress/details windows.</p>
<p>progress=&quot;Converting&quot;</p>
<p># What to show in the right click menu.</p>
<p>action=&quot;&amp;Convert&quot;</p>
<p>color=&quot;#500050&quot; # Color for files of this type.</p>
<p># Pass this file onto the link line (see below).</p>
<p>findLinkLine=true</p>
<p># Run during the first pass on multi-pass builds.</p>
<p>promoteToFirstPass=true</p>
<p>}</p>
<p># The following two lines describe how to pass this file</p>
<p># on the link line.</p>
<p># Here we're passing this as an extra_file, which adds a</p>
<p># reference to the file into the debug info</p>
<p># (so that you can &quot;e&quot; to the .bin file).</p>
<p>Program.linkableTypes += {&quot;Binary Input&quot;}</p>
<p>Program.linkSpecifiers += {&quot;Binary Input;-extra_file=$(INPUTFILE)&quot;}</p>
<p>}</p>
<p><i>985</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Customization File Definitions</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Each file type definition is contained within curly braces, can have an optional</p>
<p>identifier (</p>
<p>BinInput</p>
<p>in the preceding example), and contains numerous properties.</p>
<p>The only required property is</p>
<p>name</p>
<p>, which is a string used to identify the type in</p>
<p>the Project Manager. There are also a few other properties that are necessary for</p>
<p>the build tools to automatically recognize and build the custom file type.</p>
<p>You can add the</p>
<p>extensions</p>
<p>property, which is a list of file extensions that are</p>
<p>automatically associated with the custom file type you are defining. Add the</p>
<p>command</p>
<p>,</p>
<p>commandLine</p>
<p>and</p>
<p>outputType</p>
<p>properties to specify how to build the</p>
<p>custom file type. See âCustomization File Syntaxâ on page 995 for additional details</p>
<p>about these and other properties.</p>
<p>If your custom input file is used during a build, you can add that file to the debugging</p>
<p>information generated for the final executable. By adding the file to the debugging</p>
<p>information, you can access it through the MULTI Debugger by using the<b> e filename</b></p>
<p>command.</p>
<p>The preceding example demonstrates this through the use of two lines that append</p>
<p>values to the</p>
<p>Program.linkSpecifiers</p>
<p>and</p>
<p>Program.linkableTypes</p>
<p>properties. These lines modify properties of the</p>
<p>Program</p>
<p>file type, which is a</p>
<p>standard file type defined in<b> ghs_filetypes.bod</b>.</p>
<p><b>Note</b></p>
<p>Program.linkSpecifiers</p>
<p>and</p>
<p>Program.linkableTypes</p>
<p>are not</p>
<p>included in the curly braces surrounding the rest of the Binary Input file</p>
<p>type definition.</p>
<p>â¢</p>
<p>Program.linkableTypes</p>
<p>â Lists the names of file types that are</p>
<p>included on the linker command line when building the parent</p>
<p>Program. When modifying this property, use</p>
<p>+=</p>
<p>, or you will</p>
<p>overwrite the default types.</p>
<p>â¢</p>
<p>Program.linkSpecifiers</p>
<p>â Lists the file type names and the</p>
<p>corresponding option to include on the linker command line when</p>
<p>building the parent program. When modifying this property, use</p>
<p>+=</p>
<p>,</p>
<p>or you will overwrite the default link specifiers.</p>
<p>The<b> -extra_file</b> option indicates that the</p>
<p>INPUTFILE</p>
<p>in the previous</p>
<p>example should be added to the debugging information and not to</p>
<p>the linked executable. If you add a</p>
<p>FileType</p>
<p>value to the</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>986</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>linkableTypes</p>
<p>property but not to the</p>
<p>linkSpecifiers</p>
<p>property,</p>
<p>the output file is added to the linked executable.</p>
<p><b>Command Definitions</b></p>
<p>The</p>
<p>Commands</p>
<p>section of a customization file defines programs or commands</p>
<p>required to build or edit custom file types. The definitions specify where the</p>
<p>programs are found and which groups of options are supported.</p>
<p>Commands {</p>
<p>#Commands contains a list of custom commands and how to locate them</p>
<p>GHS_Binary_Converter {</p>
<p># name of the command referred to in FileType</p>
<p>name=&quot;GHS Binary Converter&quot;</p>
<p># GHS_TOOLS_DIR is a macro specifying the location of &quot;gbuild&quot;</p>
<p>exec=&quot;${GHS_TOOLS_DIR}/gbin2c&quot;</p>
<p># option sets used by this command</p>
<p>options={&quot;SpecialOptions&quot;,&quot;GBCOptions&quot;}</p>
<p>}</p>
<p>}</p>
<p>Each command definition is contained within curly braces, can have an optional</p>
<p>identifier (in this example,</p>
<p>GHS_Binary_Converter</p>
<p>), and contains several required</p>
<p>properties. The required properties are:</p>
<p>â¢</p>
<p>exec</p>
<p>â The name of the program to run. If it contains spaces, the Builder</p>
<p>treats the entire string as the program name (it does not parse the string into</p>
<p>arguments). If the program name is specified without a directory, the builder</p>
<p>searches for the program in the directories of the</p>
<p>PATH</p>
<p>environment variable.</p>
<p>â¢</p>
<p>name</p>
<p>â A string used to identify the command in</p>
<p>FileType</p>
<p>definitions.</p>
<p>â¢</p>
<p>options</p>
<p>â A list of option groups supported by this command. All commands</p>
<p>must list</p>
<p>SpecialOptions</p>
<p>because this option group is supported by the</p>
<p>Builder rather than the executed command.</p>
<p>For more information about other command definition properties, see âCustomization</p>
<p>File Syntaxâ on page 995.</p>
<p><i>987</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Customization File Definitions</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>CommandOption Definitions</b></p>
<p>The</p>
<p>CommandOptions</p>
<p>section of a customization file defines groups of command</p>
<p>line options supported by the custom commands. Most commands should have their</p>
<p>own option group.</p>
<p>CommandOptions {</p>
<p>GBCOptions { # -- Option Set Name --</p>
<p># options for the GHS Binary Converter (referred to in the</p>
<p># Commands section)</p>
<p>SizeOpt {</p>
<p># Size option for determining whether to output lengths</p>
<p>{</p>
<p>name=&quot;-size&quot;</p>
<p>#exact name of the option passed</p>
<p>value=0</p>
<p>#a unique identifier</p>
<p>enumLabel=&quot;On&quot; #text to show when selecting this option</p>
<p>}</p>
<p>{</p>
<p>#Fake options can be added so that a real option can be disabled</p>
<p>#lower in the hierarchy even though the tool has no such option.</p>
<p>#When the command is invoked, no option will be passed.</p>
<p>name=&quot;-no_size&quot;</p>
<p>#option name (stored in .gpj files)</p>
<p>value=1</p>
<p>#unique value for this option</p>
<p>enumLabel=&quot;Off&quot;</p>
<p>#text to show when selecting this option</p>
<p>flags={&quot;FAKEOPTION&quot;} #don't pass anything on the command line</p>
<p>}</p>
<p>delimiter=&quot;NoArg&quot;</p>
<p>#this is a stand-alone option (no arguments)</p>
<p>merge=&quot;Replace&quot;</p>
<p>#each occurance in the hierarchy</p>
<p>#replaces those above it</p>
<p>optionType=&quot;Enum&quot;</p>
<p>#this is an enumerated value option</p>
<p>guiLabel=&quot;Output the length of each array&quot;</p>
<p>#Text to display in the options dialog</p>
<p>guiCategory=&quot;Binary Converter&quot;</p>
<p>#Category to add this option into</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>Each option group is contained within curly braces, must have an identifier</p>
<p>(</p>
<p>GBCOptions</p>
<p>in the example), and includes one or more option definitions. An</p>
<p>option definition is also contained within curly braces, can have an identifier</p>
<p>(</p>
<p>SizeOpt</p>
<p>in the example), and specifies properties used by the Builder when</p>
<p>constructing command lines.</p>
<p>All option definitions must have at least one</p>
<p>name</p>
<p>, a</p>
<p>delimiter</p>
<p>, a</p>
<p>merge</p>
<p>rule,</p>
<p>and a</p>
<p>optionType</p>
<p>. The</p>
<p>name</p>
<p>of the option is the exact string to pass to the</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>988</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>command. For options that take a parameter, the</p>
<p>name</p>
<p>is the prefix (for example,</p>
<p><b>âoption=<i>param</b></i> has the name â-optionâ). The</p>
<p>delimiter</p>
<p>specifies the connector</p>
<p>between the option and the parameter (âEqualâ for<b> -option=<i>param</b></i>). The</p>
<p>merge</p>
<p>rule specifies how multiple instances of the option, on different or the same levels</p>
<p>of the hierarchy, are handled. The</p>
<p>optionType</p>
<p>determines which merge rules are</p>
<p>available.</p>
<p>An option definition will contain more than one</p>
<p>name</p>
<p>if the option has more than</p>
<p>one valid spelling, or if it has a fixed set of choices instead of a free-form parameter.</p>
<p>In either of these scenarios, create a sub-definition by adding curly braces around</p>
<p>each name and its corresponding value. Options with the same</p>
<p>value</p>
<p>setting are</p>
<p>all considered synonyms. The first option listed is treated as the canonical spelling</p>
<p>and is used when the option is set from the Project Manager. For more information,</p>
<p>see âCustomization File Syntaxâ on page 995.</p>
<p>If you have two different tools that support the same option string, but the behavior</p>
<p>of the option is different for each program, you may need to use the<b> optgroup</b></p>
<p>conditional control statement in your Project file. For more information, see</p>
<p>âConditional Control Statementsâ on page 965.</p>
<p><b>Extended Examples</b></p>
<p>The following sections provide additional reference examples to use when creating</p>
<p>customization files.</p>
<p><b>Example E.1. Using Scripts to Process Input Files</b></p>
<p>The subsequent example demonstrates how to use Perl scripts to convert input files</p>
<p>into source code. This example defines a single command for the Perl interpreter,</p>
<p>which is used to run scripts for three different custom file types.</p>
<p>%define scriptdir c:/scripts</p>
<p>Commands {</p>
<p>{</p>
<p>name=&quot;Perl Script&quot;</p>
<p>exec=&quot;perl&quot;</p>
<p>options={&quot;SpecialOptions&quot;}</p>
<p>}</p>
<p><i>989</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Extended Examples</i></p>
<h1 style="page-break-before:always; "></h1>
<p>}</p>
<p>FileTypes {</p>
<p>{</p>
<p>name=&quot;Prtcl&quot;</p>
<p>extensions={&quot;prtcl&quot;}</p>
<p>outputType=&quot;SourceFile&quot;</p>
<p>grepable=true</p>
<p>extraFiles+={&quot;$(OUTPUTDIR)/$(OUTPUTNAMEBASE)_gen.c&quot;}</p>
<p>extraFiles+={&quot;$(OUTPUTDIR)/$(OUTPUTNAMEBASE)_gen.h&quot;}</p>
<p>extraFiles+={&quot;$(OUTPUTDIR)/$(OUTPUTNAMEBASE)_log_gen.c&quot;}</p>
<p>extraFiles+={&quot;$(OUTPUTDIR)/$(OUTPUTNAMEBASE)_log_gen.h&quot;}</p>
<p>command=&quot;Perl Script&quot;</p>
<p>commandLine=&quot;$COMMAND ${scriptdir}/pb_protocol.pl \</p>
<p>$INPUTFILE $(OUTPUTDIR)/$(OUTPUTNAMEBASE)_gen.c \</p>
<p>$(OUTPUTDIR)/$(OUTPUTNAMEBASE)_gen.h&quot;</p>
<p>progress=&quot;Processing&quot;</p>
<p>action=&quot;&amp;Process&quot;</p>
<p>color=&quot;#500050&quot;</p>
<p>findLinkLine=false</p>
<p>promoteToFirstPass=true</p>
<p>}</p>
<p>{</p>
<p>name=&quot;PBCommands&quot;</p>
<p>outputType=&quot;SourceFile&quot;</p>
<p>grepable=true</p>
<p>extraFiles={&quot;docs_gen.txt&quot;}</p>
<p>command=&quot;Perl Script&quot;</p>
<p>commandLine=&quot;$COMMAND ../../src/probe/pb_ti_cmds.pl \</p>
<p>--html='$(OUTPUTDIR)' $INPUTFILE&quot;</p>
<p>progress=&quot;Processing&quot;</p>
<p>action=&quot;&amp;Process&quot;</p>
<p>color=&quot;#500050&quot;</p>
<p>findLinkLine=false</p>
<p>promoteToFirstPass=true</p>
<p>}</p>
<p>{</p>
<p>name=&quot;PerlScript&quot;</p>
<p>outputType=&quot;SourceFile&quot;</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>990</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>grepable=true</p>
<p>command=&quot;Perl Script&quot;</p>
<p>commandLine=&quot;$COMMAND $INPUTFILE $OPTIONS&quot;</p>
<p>progress=&quot;Running&quot;</p>
<p>action=&quot;&amp;Run&quot;</p>
<p>color=&quot;#500050&quot;</p>
<p>findLinkLine=false</p>
<p>}</p>
<p>}</p>
<p><b>Example E.2. Converting Images for Linking</b></p>
<p>The following example demonstrates how to convert graphical images into a form</p>
<p>that can be linked into a project, group the converted images together, and then link</p>
<p>them in to the final executable.</p>
<p>There are three file types in this example:</p>
<p>â¢</p>
<p><b>Resource</b> â The images.</p>
<p>â¢</p>
<p><b>ResourceBundle</b> â A collection of images and other bundles.</p>
<p>â¢</p>
<p><b>NestedBundle</b> â A collection of images that must be included in a resource</p>
<p>bundle.</p>
<p>These files are processed by two commands. Because different options are available</p>
<p>for the various bundle types, there are three command definitions.</p>
<p>%if ! defined (SDK_BIN_DIR)</p>
<p>% define SDK_BIN_DIR __DIR__</p>
<p>%endif</p>
<p>CommandOptions {</p>
<p>ResourceConverterOptions {</p>
<p>ResourceID {</p>
<p>name=&quot;id&quot;</p>
<p>merge=&quot;Replace&quot;</p>
<p>delimiter=&quot;Equal&quot;</p>
<p>optionType=&quot;String&quot;</p>
<p>guiLabel=&quot;Set Resource ID&quot;</p>
<p>guiCategory=&quot;Resource Converter&quot;</p>
<p>pass={&quot;All&quot;}</p>
<p>commonLevel=101</p>
<p>}</p>
<p><i>991</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Extended Examples</i></p>
<h1 style="page-break-before:always; "></h1>
<p>ResourceName {</p>
<p>name=&quot;name&quot;</p>
<p>merge=&quot;Replace&quot;</p>
<p>delimiter=&quot;Equal&quot;</p>
<p>optionType=&quot;String&quot;</p>
<p>guiLabel=&quot;Set the resource&quot;</p>
<p>guiCategory=&quot;Resource Converter&quot;</p>
<p>pass={&quot;All&quot;}</p>
<p>commonLevel=101</p>
<p>}</p>
<p>OutputFormat {</p>
<p>{</p>
<p>name=&quot;type=default&quot; # option name (stored in .gpj files)</p>
<p>value=0</p>
<p>delimiter=&quot;NoArg&quot;</p>
<p>enumLabel=&quot;Default type to that in bitmap file&quot;</p>
<p>flags={&quot;FAKEOPTION&quot;} # don't pass on command line</p>
<p>}</p>
<p>{</p>
<p>name=&quot;type=BITMAP_TYPE_16BPP_565&quot;</p>
<p>value=1</p>
<p>enumLabel=&quot;BITMAP_TYPE_16BPP_565&quot;</p>
<p>}</p>
<p>{</p>
<p>name=&quot;type=BITMAP_TYPE_1BPP_VERTICAL&quot;</p>
<p>value=2</p>
<p>enumLabel=&quot;BITMAP_TYPE_1BPP_VERTICAL&quot;</p>
<p>}</p>
<p>{</p>
<p>name=&quot;type=BITMAP_TYPE_1BPP_IDEAL&quot;</p>
<p>value=3</p>
<p>enumLabel=&quot;BITMAP_TYPE_1BPP_IDEAL&quot;</p>
<p>}</p>
<p>delimiter=&quot;NoArg&quot;</p>
<p>merge=&quot;Replace&quot;</p>
<p>optionType=&quot;Enum&quot;</p>
<p>guiLabel=&quot;Set the bitmap output type&quot;</p>
<p>guiCategory=&quot;Resource Converter&quot;</p>
<p>commonLevel=101</p>
<p>}</p>
<p>}</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>992</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>NestedBundlerOptions {</p>
<p>NestedLocation {</p>
<p>name=&quot;-i&quot;</p>
<p>merge=&quot;Replace&quot;</p>
<p>delimiter=&quot;space&quot;</p>
<p>optionType=&quot;String&quot;</p>
<p>guiLabel=&quot;Set Resource ID&quot;</p>
<p>guiCategory=&quot;Resource Bundler&quot;</p>
<p>pass={&quot;All&quot;}</p>
<p>commonLevel=101</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>Commands {</p>
<p>{</p>
<p>name=&quot;Resource Converter&quot;</p>
<p>exec=&quot;${SDK_BIN_DIR}\\imgconvert.exe&quot;</p>
<p>options={&quot;SpecialOptions&quot;,&quot;ResourceConverterOptions&quot;}</p>
<p>}</p>
<p>{</p>
<p>name=&quot;resource_bundler&quot;</p>
<p>exec=&quot;${SDK_BIN_DIR}\\resourcebundler.exe&quot;</p>
<p>options={&quot;SpecialOptions&quot;}</p>
<p>}</p>
<p>{</p>
<p>name=&quot;nested_bundler&quot;</p>
<p>exec=&quot;${SDK_BIN_DIR}\\resourcebundler.exe&quot;</p>
<p>options={&quot;SpecialOptions&quot;,&quot;NestedBundlerOptions&quot;}</p>
<p>}</p>
<p>}</p>
<p>FileTypes {</p>
<p>Resource_Bundle {</p>
<p>name=&quot;Resource Bundle&quot;</p>
<p>outputExtension=&quot;rsc&quot;</p>
<p>command=&quot;resource_bundler&quot;</p>
<p>outputType=&quot;Program&quot;</p>
<p>commandLine=&quot;$COMMAND -f $OBJECTS -o $OUTPUTFILE $OPTIONS&quot;</p>
<p>progress=&quot;Bundling&quot;</p>
<p>action=&quot;&amp;Build&quot;</p>
<p>color=&quot;#c00000&quot;</p>
<p><i>993</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Extended Examples</i></p>
<h1 style="page-break-before:always; "></h1>
<p># Nested Bundles can be linked to make Resource Bundles.</p>
<p>linkableTypes += {&quot;Nested Bundle&quot;}</p>
<p># Indicates that there's also a header file which is output.</p>
<p>extraFiles={&quot;$(OUTPUTDIR)\\$(OUTPUTNAMEBASE).h&quot;}</p>
<p>}</p>
<p>Nested_Bundle {</p>
<p>name=&quot;Nested Bundle&quot;</p>
<p>outputExtension=&quot;robj&quot;</p>
<p>command=&quot;nested_bundler&quot;</p>
<p>outputType=&quot;Program&quot;</p>
<p>commandLine=&quot;$COMMAND -f $OBJECTS -o $OUTPUTFILE $OPTIONS&quot;</p>
<p>progress=&quot;Bundling&quot;</p>
<p>action=&quot;&amp;Build&quot;</p>
<p>color=&quot;#c00000&quot;</p>
<p># Nested Bundles can be linked to make Nested Bundles.</p>
<p>linkableTypes += {&quot;Nested Bundle&quot;}</p>
<p>}</p>
<p># These two 'Program.' lines below include the resource bundle</p>
<p># into an executable program if you have a build structure like</p>
<p># the following:</p>
<p>#</p>
<p>default.gpj</p>
<p>#</p>
<p>my_program.gpj</p>
<p>[Program]</p>
<p>#</p>
<p>my_resources.gpj [Resource Bundle]</p>
<p>#</p>
<p>my_code.gpj</p>
<p>[Subproject]</p>
<p># Without these lines, the Resource Bundle will not</p>
<p># be linked in to the final executable image.</p>
<p>#</p>
<p>Program.linkSpecifiers += {&quot;Resource Bundle; \</p>
<p>#</p>
<p>-extra_file=$(OUTPUTFILE)&quot;}</p>
<p>#</p>
<p>Program.linkableTypes += {&quot;Resource Bundle&quot;}</p>
<p>{</p>
<p>name=&quot;Resource&quot;</p>
<p>extensions={&quot;bmp&quot;,&quot;jpg&quot;,&quot;jpeg&quot;,&quot;png&quot;,&quot;tiff&quot;}</p>
<p>command=&quot;Resource Converter&quot;</p>
<p>outputExtension=&quot;robj&quot;</p>
<p>outputType=&quot;ObjectFile&quot;</p>
<p>commandLine=&quot;$COMMAND $INPUTFILE output=$OUTPUTFILE \</p>
<p>$OPTIONS&quot;</p>
<p>progress=&quot;Converting&quot;</p>
<p>action=&quot;&amp;Convert&quot;</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>994</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>grepable=false</p>
<p>color=&quot;#006000&quot;</p>
<p>}</p>
<p>}</p>
<p><b>Customization File Syntax</b></p>
<p>The following sections provide more details about the syntax of the customization</p>
<p>files.</p>
<p><b>FileType Syntax</b></p>
<p>Commonly used</p>
<p>FileType</p>
<p>properties include:</p>
<p>â¢</p>
<p>action</p>
<p>â A text string displayed in the Project Manager's context menus that</p>
<p>represents the process of building this file type. For example, the action for the</p>
<p>compiler is<b> Compile</b>.</p>
<p>â¢</p>
<p>color</p>
<p>â The hexadecimal representation of the color to use when displaying</p>
<p>files of this type in the Project Manager.</p>
<p>â¢</p>
<p>command</p>
<p>â The name of the command used to build files of this type. The</p>
<p>name of the command must match the</p>
<p>name</p>
<p>property of a definition in the</p>
<p>Commands</p>
<p>section.</p>
<p>â¢</p>
<p>commandLine</p>
<p>â The exact command line used to build files of this type.</p>
<p>Numerous variables are available for context-sensitive values. For more</p>
<p>information see âContext Sensitive Variablesâ on page 997.</p>
<p>â¢</p>
<p>extensions</p>
<p>â A list of filename extensions to automatically associate with</p>
<p>this file type (see âFile Typesâ on page 970).</p>
<p>If more than one file type is defined to use the same filename extension, only</p>
<p>the last file type defined is automatically associated with that extension.</p>
<p>The</p>
<p>extensions</p>
<p>property is optional. If you do not have</p>
<p>extensions</p>
<p>, you</p>
<p>must explicitly mention the</p>
<p>FileType</p>
<p>in the<b> .gpj</b> file for each file of that type</p>
<p>so that the builder can recognize the</p>
<p>FileType</p>
<p>.</p>
<p>â¢</p>
<p>extraFiles</p>
<p>â A list of additional output files that should be removed when</p>
<p>cleaning output files. Numerous variables are available for context-sensitive</p>
<p>values. For more information see âContext Sensitive Variablesâ on page 997.</p>
<p><i>995</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Customization File Syntax</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>findLinkLine</p>
<p>â Specifies whether this file should be included in the</p>
<p>command line when linking its parent executable. If this is</p>
<p>true</p>
<p>, directs the</p>
<p>Builder to look for a parent executable that explicitly accepts this type as a</p>
<p>linkableType</p>
<p>. This property overrides the default behavior based on the</p>
<p>outputType</p>
<p>. The default value of this property is</p>
<p>false</p>
<p>.</p>
<p>â¢</p>
<p>graphicalEditor</p>
<p>â The</p>
<p>name</p>
<p>of the command used to edit files of this</p>
<p>type. The name must match the name property of a definition in the</p>
<p>Commands</p>
<p>section. This property is useful if you want to edit the file with a tool other than</p>
<p>the MULTI Editor.</p>
<p>â¢</p>
<p>graphicalEditorCommand</p>
<p>â The exact command line used to edit files of</p>
<p>this type. Numerous variables are available for context-sensitive values. For</p>
<p>more information see âContext Sensitive Variablesâ on page 997.</p>
<p>â¢</p>
<p>grepable</p>
<p>â Specifies whether or not this file can be searched. By default,</p>
<p>all files can be searched.</p>
<p>â¢</p>
<p>linkableTypes</p>
<p>â A list of file type names that are included on the linker</p>
<p>command line when linking this file. This property only applies if this file is</p>
<p>linked.</p>
<p>â¢</p>
<p>linkSpecifiers</p>
<p>â A list of file type names and the option to include on</p>
<p>the linker command line when linking this file. This property only applies if</p>
<p>this file is linked.</p>
<p>â¢</p>
<p>name</p>
<p>â A string used to identify the file type in the Project Manager. This</p>
<p>property is required.</p>
<p>â¢</p>
<p>outputExtension</p>
<p>â The filename extension on the primary output file</p>
<p>generated by files of this type. The Builder uses this information to determine</p>
<p>if the file must be built. It also uses this information when cleaning output files</p>
<p>(<b>-clean</b>).</p>
<p>â¢</p>
<p>outputType</p>
<p>â The class of output file generated by building files of this</p>
<p>type. The following list provides all values for</p>
<p>outputType</p>
<p>, and explains what</p>
<p>each value indicates to the Builder:</p>
<p>â</p>
<p>ObjectFile</p>
<p>â Building this file produces an object file that is linked</p>
<p>into its build parent by default.</p>
<p>â</p>
<p>SourceFile</p>
<p>â Building this file produces a source file that should not</p>
<p>be linked into the parent by default.</p>
<p>â</p>
<p>Program</p>
<p>â This file is a container that takes linkable children as input.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>996</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â</p>
<p>Library</p>
<p>â This file is an archive that may be incrementally linked. It</p>
<p>takes linkable children as input. A file type with this class should define</p>
<p>a</p>
<p>LibraryLinkInfo</p>
<p>property subgroup with the following entries,</p>
<p>formatted in the same way as the</p>
<p>commandLine</p>
<p>property:</p>
<p>â </p>
<p>update</p>
<p>â The command line used to update a file in the library.</p>
<p>â </p>
<p>addReplace</p>
<p>â The command line used to add a new file to the</p>
<p>library or replace one that is already there.</p>
<p>â </p>
<p>delete</p>
<p>â The command line used to remove a file from the library.</p>
<p>â</p>
<p>PassToLinker</p>
<p>â This file is not built, but by default is linked as-is into</p>
<p>its build parent.</p>
<p>â</p>
<p>SelectOne</p>
<p>â Only one of this file's children is built, based on the value</p>
<p>of<b> :select</b> options that are set.</p>
<p>â</p>
<p>Subproject</p>
<p>â This file type is a container, but the file itself is not built.</p>
<p>Children may still be linked into this file's build parent.</p>
<p>â</p>
<p>None</p>
<p>â This file is not built and is not linked into its parent.</p>
<p>â¢</p>
<p>preExec, postExec</p>
<p>â Specifies a command line to run before or after</p>
<p>processing all files of this type. If you are running a parallel build, this command</p>
<p>triggers a choke point.</p>
<p>â¢</p>
<p>preExecSafe, postExecSafe</p>
<p>â Specifies a command line to run before</p>
<p>or after processing all files of this type. If you are running a parallel build, this</p>
<p>command does not trigger a choke point.</p>
<p>â¢</p>
<p>progress</p>
<p>â The string prefix shown in progress messages when building</p>
<p>files of this type.</p>
<p>â¢</p>
<p>promoteToFirstPass</p>
<p>â Specifies whether processing this file should occur</p>
<p>during the first pass of a multi-pass build. Set this property to<b> true</b> for file types</p>
<p>that generate source code that are built into your project.</p>
<p><b>Context Sensitive Variables</b></p>
<p>When defining some of the properties in the</p>
<p>FileTypes</p>
<p>section, you might need</p>
<p>to specify information that depends on the specific file being processed. Because</p>
<p>the file type definition is generic, you can use the following variables as placeholders</p>
<p>for the context-specific information.</p>
<p>The syntax for using these variables is:</p>
<p><i>997</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Context Sensitive Variables</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p><i>$VARIABLE</i></p>
<p>â¢</p>
<p><i>$(VARIABLE)</i></p>
<p>â This format is required if the variable name contains an</p>
<p>underscore.</p>
<p>To specify a dollar sign in a property value, use</p>
<p>$$</p>
<p>. The supported variables are:</p>
<p>COMMAND</p>
<p>The executable from the</p>
<p>Commands</p>
<p>definition that matches the</p>
<p>command</p>
<p>property of the</p>
<p>FileType</p>
<p>. Resolves to an absolute path if the</p>
<p>runInDirectory</p>
<p>flag is set.</p>
<p>DISKFILE</p>
<p>Full path to the file being processed.</p>
<p>EDITOR</p>
<p>Executable of the graphical editor defined by the</p>
<p>FileType</p>
<p>of the file being processed.</p>
<p>FILENAME</p>
<p>The name of the file being processed. Does not include path information.</p>
<p>FILENAMEBASE</p>
<p>Base name with no suffix of the file being processed.</p>
<p>FILENAMELIBBASE</p>
<p>The base name of a library. Same as</p>
<p>FILENAMEBASE</p>
<p>except that it strips away the</p>
<p>lib</p>
<p>prefix</p>
<p>if present.</p>
<p>FILETYPEOPTIONS</p>
<p>List of file types included in the current module. This is used by the driver to determine when</p>
<p>a module requires C or C++ libraries.</p>
<p>INPUTFILE</p>
<p>The name of the input file being processed, including path information relative to the Top Project</p>
<p>directory. For commands with multiple passes, this variable also includes a list of output files</p>
<p>from the first pass when used with the second pass.</p>
<p>INPUTDIR</p>
<p>Relative path to the directory containing the input file.</p>
<p>ITEMID</p>
<p>Unique ID number for the file being processed. This number is not guaranteed to be the same</p>
<p>across builds.</p>
<p>KEEPOBJECTS</p>
<p>List of all objects in an archive that should remain in the archive after processing.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>998</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>MAKE_DEPEND_OPTIONS</p>
<p>Arguments specified in the</p>
<p>makeDepends</p>
<p>section of the</p>
<p>COMMAND</p>
<p>definition used for generating</p>
<p>dependency information for the file being processed.</p>
<p>OBJECTS</p>
<p>List of all the objects to be linked together for this file.</p>
<p>OBJECTBASE</p>
<p>Base name with no suffix of the last object file in the list. This is a special case for single file</p>
<p>libraries.</p>
<p>OBJECTSUFFIX</p>
<p>Suffix for the object files.</p>
<p>OPTIONS</p>
<p>A space-separated string containing all of the options set on this file, including inherited options.</p>
<p>OUTPUTDIR</p>
<p>Relative path to the output directory.</p>
<p>OUTPUTFILE</p>
<p>Relative path to the primary file output by processing the current file (that is, the object file for</p>
<p>a source file). If the file requires two-pass processing, the extension on the</p>
<p>OUTPUTFILE</p>
<p>is</p>
<p>different for the two passes.</p>
<p>OUTPUTNAMEBASE</p>
<p>Base name with no suffix of the output name for the file being processed.</p>
<p>PARENTID</p>
<p>Unique ID number for the parent of the file being processed. If there is no parent, the value is</p>
<p>zero. This number is not guaranteed to be the same across builds.</p>
<p>RUNDIR</p>
<p>The directory the command is run in. This is the same as the directory containing the Top Project</p>
<p>except for commands with the</p>
<p>runInDirectory</p>
<p>flag set.</p>
<p>SECOND_PASS_OPTION</p>
<p>Same as the</p>
<p>secondPassOption</p>
<p>from the</p>
<p>FileType</p>
<p>definition. Used for tools that operate</p>
<p>using multiple passes to indicate the current pass.</p>
<p>TOPPROJECT</p>
<p>Full path of the Top Project.</p>
<p>SIBLINGS</p>
<p>Full paths of all files of the</p>
<p>siblingType</p>
<p>, which are descendents of the parent of the file being</p>
<p>processed.</p>
<p><i>999</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Context Sensitive Variables</i></p>
<h1 style="page-break-before:always; "></h1>
<p>SIBLINGS<i>[type]</i></p>
<p>Like</p>
<p>SIBLINGS</p>
<p>, but uses the specified type instead of the</p>
<p>siblingType</p>
<p>parameter.</p>
<p><b>Command Syntax</b></p>
<p>Commonly used</p>
<p>Command</p>
<p>syntax includes:</p>
<p>â¢</p>
<p>exec</p>
<p>â The name of the program to run. If it contains spaces, the Builder</p>
<p>treats the entire string as the program name (it does not parse the string into</p>
<p>arguments). If the program name is specified without a directory, the builder</p>
<p>searches for the program in the directories of the</p>
<p>PATH</p>
<p>environment variable.</p>
<p>Required.</p>
<p>â¢</p>
<p>name</p>
<p>â A string used to identify the command in</p>
<p>FileType</p>
<p>definitions.</p>
<p>Required.</p>
<p>â¢</p>
<p>options</p>
<p>â A list of option groups supported by this command. All commands</p>
<p>should support</p>
<p>SpecialOptions</p>
<p>. Required.</p>
<p>â¢</p>
<p>specialOptions</p>
<p>âFlags supported by the program that can be used for</p>
<p>integration with advanced features in the Builder. Two commonly used special</p>
<p>properties are:</p>
<p>â</p>
<p>runInDirectory</p>
<p>â Specifies whether the command should be run with</p>
<p>the current working directory set to the directory containing the input file.</p>
<p>By default, the command is run with the working directory set to the</p>
<p>directory containing the Top Project.</p>
<p>â</p>
<p>showCommands</p>
<p>â Specifies the flag used to generate verbose output.</p>
<p><b>CommandOption Syntax</b></p>
<p>The following values are available for</p>
<p>CommandOption</p>
<p>property definitions:</p>
<p>â¢</p>
<p>commonLevel</p>
<p>â Specifies how visible the option is in the Project Manager:</p>
<p>â</p>
<p>1 - 100</p>
<p>â A basic option.</p>
<p>â</p>
<p>101 - 1000</p>
<p>â An intermediate option.</p>
<p>â</p>
<p>&gt;1000</p>
<p>â [default] An advanced option.</p>
<p>â¢</p>
<p>delimiter</p>
<p>â Specifies the connector between the option and any parameter</p>
<p>it may take:</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1000</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â</p>
<p>Equal</p>
<p>â Is in the form<b> -<i>option</i>=<i>value</b></i>.</p>
<p>â</p>
<p>NoArg</p>
<p>â [default] Is in the form<b> -<i>option</b></i>.</p>
<p>â</p>
<p>Space</p>
<p>â Is in the form<b> -<i>option value</b></i>.</p>
<p>â</p>
<p>Touching</p>
<p>â Is in the form<b> -<i>optionvalue</b></i>.</p>
<p>â¢</p>
<p>merge</p>
<p>â Specifies how multiple settings of the option are defined in the same</p>
<p>or different files:</p>
<p>â</p>
<p>Concat</p>
<p>â Appends a value to the end of a list.</p>
<p>â</p>
<p>None</p>
<p>â [default] The value is not inherited.</p>
<p>â</p>
<p>Preconcat</p>
<p>â Prepends a value to the beginning of a list.</p>
<p>â</p>
<p>Replace</p>
<p>â Replaces the previous value with the new one.</p>
<p>â¢</p>
<p>name</p>
<p>â The exact string or prefix to pass on the command line. This string</p>
<p>must not contain spaces. Required.</p>
<p>â¢</p>
<p>optionType</p>
<p>â Specifies the type of option:</p>
<p>â</p>
<p>Enum</p>
<p>â An on/off switch, and permits a</p>
<p>merge</p>
<p>type of</p>
<p>Replace</p>
<p>.</p>
<p>â</p>
<p>EnumList</p>
<p>â A group of on/off switches, and permits a</p>
<p>merge</p>
<p>type of</p>
<p>Concat</p>
<p>.</p>
<p>â</p>
<p>List</p>
<p>â [default] Accepts a comma-separated list of values and permits</p>
<p>a</p>
<p>merge</p>
<p>type of</p>
<p>Concat</p>
<p>or</p>
<p>Preconcat</p>
<p>.</p>
<p>â</p>
<p>String</p>
<p>â Accepts a single value and permits a</p>
<p>merge</p>
<p>type of</p>
<p>Replace</p>
<p>.</p>
<p>â¢</p>
<p>pass</p>
<p>â Specifies which parts of the toolchain the option is passed to:</p>
<p>â</p>
<p>All</p>
<p>â [default] All tools (most common).</p>
<p>â</p>
<p>Compile</p>
<p>â Compiler only.</p>
<p>â</p>
<p>Depends</p>
<p>â Preprocessor dependencies resolution only.</p>
<p>â</p>
<p>Link</p>
<p>â Linker only.</p>
<p>â</p>
<p>None</p>
<p>â None of the tools.</p>
<p>â¢</p>
<p>value</p>
<p>â A numerical identifier for this option setting. If you have two</p>
<p>sub-definitions with different spellings but the same meaning, specify the same</p>
<p>numerical identifier for their</p>
<p>value</p>
<p>fields. If they have different meanings,</p>
<p>use different numerical identifiers for each</p>
<p>value</p>
<p>field.</p>
<p><i>1001</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Context Sensitive Variables</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Preprocessor Directives</b></p>
<p>Like C and C++ source files, the customization files are processed by a preprocessor</p>
<p>before they are loaded by the Builder. The preprocessor supports numerous standard</p>
<p>directives you can use to conditionally include or disable portions of your</p>
<p>customization file:</p>
<p>%define</p>
<p>Defines a macro.</p>
<p>%echo</p>
<p>%info</p>
<p>Outputs a message.</p>
<p>%elif</p>
<p>%elsif</p>
<p>%elseif</p>
<p>%else</p>
<p>%endif</p>
<p>%if</p>
<p>Conditional inclusion directives.</p>
<p>%elif</p>
<p>and</p>
<p>%elsif</p>
<p>are equivalent to</p>
<p>%elseif</p>
<p>.</p>
<p>%error</p>
<p>Outputs an error message.</p>
<p>%ifdef</p>
<p>Shorthand for</p>
<p>%if defined</p>
<p>.</p>
<p>%include</p>
<p>Includes another file.</p>
<p>%warning</p>
<p>Outputs a warning message.</p>
<p><b>Preprocessor Functions</b></p>
<p>In addition to the preprocessor directives listed in the preceding section, you can</p>
<p>use several preprocessor functions in your customization file. These functions are</p>
<p>typically used in combination with the</p>
<p>%if</p>
<p>directive.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1002</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p>â¢</p>
<p>defined(<i>MACRO_NAME</i>)</p>
<p>â Evaluates to true if the macro is defined. For</p>
<p>example:</p>
<p>%if defined(FOO)</p>
<p>â¢</p>
<p>file_exists(<i>FULL_PATH</i>)</p>
<p>â Evaluates to true if the file or directory</p>
<p>specified exists. For example:</p>
<p>%if file_exists(â${__DIR__}/myfileâ)</p>
<p>â¢</p>
<p>streq(<i>STRING1,STRING2</i>)</p>
<p>â Evaluates to true if the strings are equal. For</p>
<p>example:</p>
<p>%if streq(&quot;${__MULTI_HOST__}&quot;, &quot;linux86&quot;)</p>
<p><b>Predefined Macros</b></p>
<p>You can use the following macros in any customization file:</p>
<p>â¢</p>
<p>__DIR__</p>
<p>â Directory of the file you are editing.</p>
<p>â¢</p>
<p>__MULTI_HOST__</p>
<p>â The host machine's operating system.</p>
<p>â¢</p>
<p>__TOOLS_DIR__</p>
<p>â The MULTI Compiler installation directory.</p>
<p>The syntax for using one of these macros is</p>
<p>${MACRO}</p>
<p>. See Example E.3. Including</p>
<p>Additional .bod files on page 1003 for an example.</p>
<p><b>Example E.3. Including Additional .bod files</b></p>
<p>The following example demonstrates how to use preprocessor directives, functions,</p>
<p>and macros to include additional, optional<b> .bod</b> files.</p>
<p># Include kernel build types configuration file</p>
<p>%if file_exists(&quot;${__DIR__}/../kernel/kernel.bod&quot;)</p>
<p>%include &quot;${__DIR__}/../kernel/kernel.bod&quot;</p>
<p>%endif</p>
<p># Include build type configuration file for examples</p>
<p>%include &quot;${__DIR__}/../examples/copyfile.bod&quot;</p>
<p># Include build type configuration file for validations</p>
<p><i>1003</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Context Sensitive Variables</i></p>
<h1 style="page-break-before:always; "></h1>
<p>%if file_exists(&quot;${__DIR__}/../rtos_val/validations.bod&quot;)</p>
<p>%include &quot;${__DIR__}/../rtos_val/validations.bod&quot;</p>
<p>%endif</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1004</i></p>
<p><i>Appendix E. Customization Files</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Appendix F</b></p>
<p><b>The MULTI Eclipse Plug-in</b></p>
<p><b>Contents</b></p>
<p>Prerequisites to Installing MULTI for Eclipse . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>1007</p>
<p>Installing MULTI for Eclipse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>1008</p>
<p>Creating a Green Hills Project from Within Eclipse . . . . . . . . . . . . . . . . . . . .</p>
<p>1009</p>
<p>Changing Compiler Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>1013</p>
<p>Building and Running Your Project . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>1014</p>
<p>Debugging Your Project with the MULTI Debugger . . . . . . . . . . . . . . . . . . .</p>
<p>1016</p>
<h1 style="page-break-before:always; "></h1>
<p>The MULTI for Eclipse plug-in integrates the MULTI Debugger and Green Hills</p>
<p>compilers with the Eclipse environment. You can use this plug-in to create, build,</p>
<p>and run a Green Hills project; you can then debug the project using the MULTI</p>
<p>Debugger. MULTI for Eclipse is ideal for using the same environment to develop</p>
<p>both Java and C/C++ applications.</p>
<p>MULTI for Eclipse uses GNU Make to build projects. By default, Eclipse builds</p>
<p>your project by automatically generating a makefile. However, you can easily disable</p>
<p>this feature if you prefer the flexibility of writing your own makefile. When you</p>
<p>build the project using MULTI for Eclipse, the Eclipse C/C++ Development Tools</p>
<p>(CDT) use Green Hills compilers.</p>
<p>When you debug a project using MULTI for Eclipse, the Eclipse platform launches</p>
<p>the MULTI Debugger, which interfaces with Green Hills simulators and embedded</p>
<p>targets. With simple configuration management, the Debugger can support unlimited</p>
<p>concurrent target connections, allowing you to debug complex heterogeneous</p>
<p>systems. The MULTI Debugger also enables superior source code browsing and</p>
<p>contains built-in support for advanced instruction and data trace. If you use</p>
<p>TimeMachine, this trace data gives you the ability to step through, run through, or</p>
<p>hit breakpoints you encountered earlier in program execution. For more information</p>
<p>about TimeMachine, see the documentation about analyzing trace data with the</p>
<p>TimeMachine tool suite in the<i> MULTI: Debugging</i> book.</p>
<p>While MULTI for Eclipse provides the convenience of automatically generated</p>
<p>makefiles or the flexibility to set up your own makefiles, as well as the ability to</p>
<p>develop Java and C/C++ applications in the same environment, it does not provide</p>
<p>features that are available from the MULTI Project Manager. The following list</p>
<p>outlines aspects of the MULTI Project Manager that you might find helpful. The</p>
<p>Project Manager:</p>
<p>â¢</p>
<p>Provides a<b> Project Wizard</b> that allows you to populate your project with</p>
<p>example source code.</p>
<p>â¢</p>
<p>Can build multiple executables per build using nested projects. This can be</p>
<p>very helpful if you are building a Monolith INTEGRITY project or a Dynamic</p>
<p>Download INTEGRITY project with multiple AddressSpaces.</p>
<p>â¢</p>
<p>Provides a powerful command line interface, enabling advanced automated</p>
<p>builds.</p>
<p>â¢</p>
<p>Contains online help for every build option.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1006</i></p>
<p><i>Appendix F. The MULTI Eclipse Plug-in</i></p>
<h1 style="page-break-before:always; "></h1>
<p>For more information about the MULTI Project Manager, see the documentation</p>
<p>about the MULTI Project Manager in the<i> MULTI: Managing Projects and</i></p>
<p><i>Configuring the IDE</i> book.</p>
<p>The following sections explain how to install MULTI for Eclipse, how to perform</p>
<p>basic tasks within the Eclipse environment, and how to access MULTI components</p>
<p>from within Eclipse. For information about Eclipse itself, see the documentation</p>
<p>available on the Eclipse Web site [http://www.eclipse.org].</p>
<p><b>Prerequisites to Installing MULTI for Eclipse</b></p>
<p>Before you install MULTI for Eclipse, ensure that you have installed the following</p>
<p>software:</p>
<p>â¢</p>
<p>MULTI IDE and Green Hills compiler installations â The MULTI IDE and</p>
<p>Compiler installation directories must also be in your PATH environment</p>
<p>variable. To ensure MULTI is in your PATH, open a new shell and type</p>
<p>multi</p>
<p>.</p>
<p>If the MULTI Launcher starts up, the IDE is in your PATH. To ensure that the</p>
<p>compiler is in your PATH, type</p>
<p>gdump</p>
<p>in the shell. If<b> gdump</b> runs, the compiler</p>
<p>is also in your PATH.</p>
<p>â¢</p>
<p>Eclipse and CDT installations. The supported versions are:</p>
<p>â</p>
<p>Eclipse 3.6.x with CDT 7.0.x</p>
<p>â</p>
<p>Eclipse 3.7.x with CDT 8.0.x</p>
<p>â</p>
<p>Eclipse 4.2.x with CDT 8.1.x</p>
<p>â</p>
<p>Eclipse 4.3.x with CDT 8.2.x</p>
<p>You can download Eclipse and CDT from the Eclipse Web site</p>
<p>[http://www.eclipse.org/cdt].</p>
<p>â¢</p>
<p>GNU Make â The regular Make (MKS Make, for example) is insufficient.</p>
<p>To install GNU Make on Windows, it is easiest to install either Cygwin, which</p>
<p>you can download from the Cygwin Web site [http://www.cygwin.com], or</p>
<p>MinGW and MSYS, which you can download from the MinGW Web site</p>
<p>[http://www.mingw.org]. Your version of GNU Make must support</p>
<p>DOS/Windows-style paths (such as<b> c:\path\to\file.txt</b>). GNU Make 3.80 or</p>
<p>earlier should work.</p>
<p><i>1007</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Prerequisites to Installing MULTI for Eclipse</i></p>
<h1 style="page-break-before:always; "></h1>
<p>The bin directory for whichever you install must also be in your PATH</p>
<p>environment variable. To ensure that the directory containing GNU Make is</p>
<p>in your PATH, open a new shell and type</p>
<p>make --version</p>
<p>. If the shell prints</p>
<p>a GNU Make version message with a Free Software Foundation copyright</p>
<p>notice, the appropriate directory is in your PATH.</p>
<p>â¢</p>
<p>Java SE 5 or 6 â You can download Java from Oracle's Java web site</p>
<p>[http://www.java.com]. Java SE 5 works with Eclipse 3.6. We recommend</p>
<p>Java SE 6 for Eclipse 3.7.</p>
<p><b>Note</b></p>
<p>The instructions in the following sections were written for Eclipse 3.6</p>
<p>and CDT 7.0. They should also apply to newer versions.</p>
<p><b>Installing MULTI for Eclipse</b></p>
<p>To install MULTI for Eclipse, follow these steps:</p>
<p>1.</p>
<p>Open Eclipse, and select<b> Help</b> â<b> Install New Software</b>.</p>
<p>2.</p>
<p>In the<b> Install</b> dialog that appears, click<b> Add</b>.</p>
<p>3.</p>
<p>In the<b> Add Repository</b> dialog that appears, click<b> Local</b>.</p>
<p>4.</p>
<p>Navigate to the<b> eclipse</b> directory located in your MULTI compiler installation.</p>
<p>5.</p>
<p>In the<b> Name</b> box, enter</p>
<p>MULTI for Eclipse</p>
<p>. Click<b> OK</b>.</p>
<p>6.</p>
<p>In the<b> Name/Version</b> list, expand the<b> Green Hills MULTI for Eclipse</b> item.</p>
<p>Select<b> Green Hills MULTI for Eclipse (<i>target_architecture</i>)<i> version_number</b></i>,</p>
<p>where<i> target_architecture</i> is your target architecture and<i> version_number</i> is</p>
<p>the latest version number in the list. If you have MULTI licenses for more</p>
<p>than one architecture, you can select all the targets you are licensed for. Click</p>
<p><b>Next</b>.</p>
<p>7.</p>
<p>If you accept the terms of the feature license, select<b> I accept the terms in the</b></p>
<p><b>license agreement</b>.</p>
<p>8.</p>
<p>Click<b> Finish</b>.</p>
<p>9.</p>
<p>In the<b> Security Warning</b> window that appears, click<b> OK</b>.</p>
<p>10. In the<b> Software Updates</b> dialog box that appears, click<b> Restart Now</b> to restart</p>
<p>Eclipse.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1008</i></p>
<p><i>Appendix F. The MULTI Eclipse Plug-in</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Creating a Green Hills Project from Within Eclipse</b></p>
<p>You can create a Green Hills project from within Eclipse. To create a project:</p>
<p>1.</p>
<p>In Eclipse, select<b> File</b> â<b> New</b> â<b> Project</b>.</p>
<p>2.</p>
<p>In the<b> Wizards</b> pane of the<b> New Project</b> wizard, select a C or C++ project.</p>
<p>Click<b> Next</b>.</p>
<p>3.</p>
<p>In the<b> Project name</b> text field, enter a name for your project. To save your</p>
<p>project in a directory other than the default, clear the<b> Use default location</b></p>
<p>check box and specify a directory.</p>
<p>4.</p>
<p>In the<b> Project types</b> pane, select the appropriate Green Hills project type.</p>
<p>Click<b> Next</b>.</p>
<p>5.</p>
<p>In the<b> Configurations</b> pane, select<b> Debug</b>,<b> Release</b>, or both.</p>
<p>â¢</p>
<p><b>Debug</b> â Disables optimization.</p>
<p>â¢</p>
<p><b>Release</b> â Enables optimization.</p>
<p>If you select both configurations,<b> Debug</b> is set by default. You can change the</p>
<p>configuration later. For information, see âChanging Compiler Optionsâ</p>
<p>on page 1013.</p>
<p>6.</p>
<p>If you want to use an automatically generated makefile (the default), click</p>
<p><b>Finish</b>.</p>
<p><i>1009</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Creating a Green Hills Project from Within Eclipse</i></p>
<h1 style="page-break-before:always; "></h1>
<p>If you want to use a custom makefile:</p>
<p>a.</p>
<p>Click the<b> Advanced settings</b> button.</p>
<p>b.</p>
<p>Select<b> C/C++ Build</b> on the left.</p>
<p>c.</p>
<p>Clear the check box<b> Generate Makefiles automatically</b>.</p>
<p>d.</p>
<p>Set other options as appropriate to control how Eclipse interacts with</p>
<p>your makefile. For information about settings, see the documentation for</p>
<p>CDT available from the Eclipse Web site [http://www.eclipse.org].</p>
<p>e.</p>
<p>Click<b> OK</b> and then<b> Finish</b>.</p>
<p>Your project should appear in the<b> Project Explorer</b> view.</p>
<p><b>Creating an INTEGRITY Project</b></p>
<p>To create an INTEGRITY project, follow the preceding instructions that outline</p>
<p>how to create a Green Hills project.</p>
<p>In addition to the preceding steps, you must specify a BSP and operating system</p>
<p>installation directory and create an Integrate configuration file. To specify the BSP</p>
<p>and OS directory:</p>
<p>1.</p>
<p>In the<b> Project Explorer</b> view, right-click the top-level project and select</p>
<p><b>Properties</b>.</p>
<p>2.</p>
<p>On the left side of the<b> Properties</b> window that appears, expand<b> C/C++ Build</b></p>
<p>and select<b> Settings</b>.</p>
<p>3.</p>
<p>In the hierarchy present on the<b> Tool Settings</b> tab, select<b> Target</b>. On the right</p>
<p>side of the window, in the<b> Board Support Package</b> drop-down box, select</p>
<p>the appropriate board.</p>
<p>You must set the BSP a total of three times, once for each top-level heading</p>
<p>(<b>Compiler</b>,<b> Linker</b>, and<b> Integrate</b>) that appears in the hierarchy on the left.</p>
<p>4.</p>
<p>In the hierarchy present on the<b> Tool Settings</b> tab, expand<b> Target</b>, and then</p>
<p>select<b> Operating System</b>. On the right side of the window, in the<b> OS Directory</b></p>
<p>text field, specify your operating system installation directory.</p>
<p>You must specify the OS directory a total of three times, once for each top-level</p>
<p>heading (<b>Compiler</b>,<b> Linker</b>, and<b> Integrate</b>) that appears in the hierarchy on</p>
<p>the left.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1010</i></p>
<p><i>Appendix F. The MULTI Eclipse Plug-in</i></p>
<h1 style="page-break-before:always; "></h1>
<p>5.</p>
<p>If your INTEGRITY installation includes the<b> intex</b> executable in the directory</p>
<p><b>rtos/multi/bin/<i>hosttype</b></i>, you must add that directory to your PATH. In the</p>
<p>hierarchy present on the<b> Tool Settings</b> tab, under<b> GHS Integrate</b>, select</p>
<p><b>Integrate Options</b>. On the right side of the window, in the<b> Tools Directory</b></p>
<p>box, specify your MULTI Compiler installation directory.</p>
<p><b>Note</b></p>
<p>On Windows, if you use a<b> Browse</b> button in the<b> C/C++ Build</b> section of</p>
<p>the<b> Properties</b> window, the resulting path contains backslashes. Because</p>
<p>these backslashes cause Eclipse to generate an invalid makefile, you must</p>
<p>change them to forward slashes.</p>
<p>If you created an INTEGRITY project, you must also create an Integrate</p>
<p>configuration file. To create an Integrate configuration file:</p>
<p>1.</p>
<p>in the<b> Project Explorer</b> view, right-click your INTEGRITY project and select</p>
<p><b>New</b> â<b> File</b>.</p>
<p>2.</p>
<p>In the<b> File name</b> text field, enter a name for your configuration file. Append</p>
<p><b>.int</b> to the end of the filename. Click<b> Finish</b>.</p>
<p>Your Integrate configuration file should appear under your INTEGRITY project in</p>
<p>the<b> Project Explorer</b> view. If you need to change Integrate options, right-click the</p>
<p>project name (not the Integrate file) and select<b> Properties</b>.</p>
<p>To add content to your new source file, double-click the filename in the<b> Project</b></p>
<p><b>Explorer</b> view. Enter content in the main view.</p>
<p>If you created a KernelSpace project, the</p>
<p>Filename</p>
<p>keyword in the Kernel section</p>
<p>is always</p>
<p>default</p>
<p>, regardless of what you named your INTEGRITY project. The</p>
<p>following example displays the most minimal Integrate configuration file possible</p>
<p>for a KernelSpace project.</p>
<p>Kernel</p>
<p>Filename</p>
<p>default</p>
<p>EndKernel</p>
<p>For an INTEGRITY KernelSpace project, you must also include the<b> global_table.c</b></p>
<p>source file in your project. To do so, either:</p>
<p><i>1011</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Creating an INTEGRITY Project</i></p>
<h1 style="page-break-before:always; "></h1>
<p>1.</p>
<p>Copy the standard example<b> global_table.c</b> located in the<b> kernel</b> directory of</p>
<p>your INTEGRITY installation.</p>
<p>2.</p>
<p>Paste this copy into your project.</p>
<p>Or:</p>
<p>1.</p>
<p>Right-click your INTEGRITY project and select<b> New</b> â<b> File</b>.</p>
<p>2.</p>
<p>Click the<b> Advanced</b> button.</p>
<p>3.</p>
<p>Select the check box<b> Link to file in the file system</b>.</p>
<p>4.</p>
<p>Click the<b> Browse</b> button to navigate to the<b> global_table.c</b> file located in the</p>
<p><b>kernel</b> directory of your INTEGRITY installation. Select this file and click</p>
<p><b>Open</b>.</p>
<p>5.</p>
<p>Click<b> Finish</b>.</p>
<p>If you created a Dynamic Download project, the</p>
<p>Filename</p>
<p>keyword in the Kernel</p>
<p>section is always</p>
<p>DynamicDownload</p>
<p>, regardless of what you named your</p>
<p>INTEGRITY project.</p>
<p>An Integrate configuration file may contain any number of AddressSpace sections.</p>
<p>The AddressSpace section requires the</p>
<p>Filename</p>
<p>keyword. Follow</p>
<p>Filename</p>
<p>with the name of the file that contains the AddressSpace executable. The name of</p>
<p>this file is always</p>
<p>default.as</p>
<p>, regardless of what you named your INTEGRITY</p>
<p>project. You can see how two</p>
<p>Filename</p>
<p>keywords are specified in the following</p>
<p>example, which displays the most minimal Integrate configuration file possible for</p>
<p>a Dynamic Download project.</p>
<p>Kernel</p>
<p>Filename</p>
<p>DynamicDownload</p>
<p>EndKernel</p>
<p>AddressSpace</p>
<p>Filename</p>
<p>default.as</p>
<p>Language</p>
<p>C</p>
<p>Library</p>
<p>libINTEGRITY.so</p>
<p>Library</p>
<p>libc.so</p>
<p>EndAddressSpace</p>
<p><b>Note</b></p>
<p>Eclipse's automatically generated makefiles allow only one AddressSpace</p>
<p>per Dynamic Download project. (The MULTI IDE's Project Manager</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1012</i></p>
<p><i>Appendix F. The MULTI Eclipse Plug-in</i></p>
<h1 style="page-break-before:always; "></h1>
<p>allows more advanced configuration options for INTEGRITY users.) If</p>
<p>you need more than one AddressSpace in a Dynamic Download project</p>
<p>built from within Eclipse, you must use a custom makefile. For</p>
<p>information about using custom makefiles, see âCreating a Green Hills</p>
<p>Project from Within Eclipseâ on page 1009.</p>
<p>For more information about how to format an Integrate configuration file, see the</p>
<p><i>Integrate User's Guide</i>.</p>
<p><b>Adding a Source File to Your Project</b></p>
<p>MULTI for Eclipse supports C, C++, linker scripts, and assembly source files. For</p>
<p>C++ projects, you can add C, C++, and assembly source files. For C projects, you</p>
<p>can add C and assembly files. You may also add a single linker script to any project.</p>
<p>To add a source file to your project:</p>
<p>1.</p>
<p>Ensure that your project is selected in the<b> Project Explorer</b> view and select</p>
<p><b>File</b> â<b> New</b> â<b> Source File</b>.</p>
<p>2.</p>
<p>In the<b> Source File</b> text field, enter a name for your source file. Be sure to</p>
<p>include the<b> .c</b> file extension for C source files, the<b> .cpp</b> file extension for C++</p>
<p>source files,<b> .s</b> file extension for assembly source files, and the<b> .ld</b> file extension</p>
<p>for linker scripts. Click<b> Finish</b>.</p>
<p>Your source file should appear under your project in the<b> Project Explorer</b> view.</p>
<p>To add content to your new source file, double-click the filename in the<b> Project</b></p>
<p><b>Explorer</b> view. Enter content in the main view.</p>
<p>For information about importing an existing file into your project, see the Eclipse</p>
<p>documentation.</p>
<p><b>Changing Compiler Options</b></p>
<p>If you are using an automatically generated makefile, you can change the compiler</p>
<p>and linker options that appear in the<b> C/C++ Build</b> â<b> Settings</b> section of the</p>
<p><b>Properties</b> window. You can either change these options on an option-by-option</p>
<p>basis or by configuration. To change your options on an option-by-option basis:</p>
<p>1.</p>
<p>To change options for the entire project â In the<b> Project Explorer</b> view,</p>
<p>right-click your project name and select<b> Properties</b>.</p>
<p><i>1013</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Adding a Source File to Your Project</i></p>
<h1 style="page-break-before:always; "></h1>
<p>To change options for a single file â In the<b> Project Explorer</b> view, right-click</p>
<p>your source file's filename and select<b> Properties</b>.</p>
<p>2.</p>
<p>On the left side of the<b> Properties</b> window that appears, expand<b> C/C++ Build</b></p>
<p>and select<b> Settings</b>.</p>
<p>3.</p>
<p>Click through all the levels of the hierarchy on the<b> Tool Settings</b> tab. Options</p>
<p>you can set appear to the right. For information about these options, see</p>
<p>Chapter 3, âBuilder and Driver Optionsâ on page 127.</p>
<p><b>Note</b></p>
<p>On Windows, if you use a<b> Browse</b> button in the<b> C/C++ Build</b></p>
<p>section of the<b> Properties</b> window, the resulting path contains</p>
<p>backslashes. Because backslashes here cause Eclipse to generate an</p>
<p>invalid makefile, you must change the backslashes to forward</p>
<p>slashes.</p>
<p><b>Tip</b></p>
<p>To revert a file's options to the project's settings, right-click the file and</p>
<p>select<b> Resource Configurations</b> â<b> Reset to Default</b>. Select the files</p>
<p>you want to revert and click<b> OK</b>.</p>
<p>You can also change your project's configuration, which is its combination of option</p>
<p>settings. The preset configurations are<b> Debug</b> and<b> Release</b> (see âCreating a Green</p>
<p>Hills Project from Within Eclipseâ on page 1009), but you can create and save your</p>
<p>own configuration as well. To do so, click the<b> Manage configurations</b> button in</p>
<p>the<b> C/C++ Build</b> section of the<b> Properties</b> window. For more information, see the</p>
<p>documentation available on the Eclipse Web site [http://www.eclipse.org].</p>
<p><b>Building and Running Your Project</b></p>
<p>You must build your project before you can run it. To build your project, select</p>
<p><b>Project</b> â<b> Build Project</b>. You can see the output of your build in the<b> Console</b></p>
<p>view. The output includes relevant compile and make errors.</p>
<p>To run your project, follow these steps:</p>
<p>1.</p>
<p>Ensure that your project is selected in the<b> Project Explorer</b> view, and select</p>
<p><b>Run</b> â<b> Run Configurations</b>.</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1014</i></p>
<p><i>Appendix F. The MULTI Eclipse Plug-in</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Note</b></p>
<p>Use of the Eclipse<b> Run Configurations</b> dialog is not supported for</p>
<p>Dynamic Download INTEGRITY applications. Dynamic Download</p>
<p>INTEGRITY applications should be downloaded from within</p>
<p>MULTI. For instructions, see the documentation about loading a</p>
<p>run-mode program in the<i> MULTI: Debugging</i> book.</p>
<p>2.</p>
<p>The<b> Run Configurations</b> dialog appears. In the pane located on the left side</p>
<p>of the dialog, double-click<b> GHS Local C/C++ Launch</b> for a new configuration</p>
<p>of your project. Your project's name is selected automatically. Run</p>
<p>configurations that you create in this dialog are saved for future use.</p>
<p>Under the<b> Main</b> tab, the<b> Project</b> text field should now contain the name of</p>
<p>your project.</p>
<p>3.</p>
<p>Click<b> Search Project</b>. In the<b> Program Selection</b> dialog box that appears,</p>
<p>ensure that the binary that is selected is the one you want to run. (If you have</p>
<p>never successfully built your project, no binary is present.) Click<b> OK</b>.</p>
<p>4.</p>
<p>In the<b> Connect to a target</b> text field, specify:</p>
<p>â¢</p>
<p>A setup script filename if applicable (Note that if you enter the path to a</p>
<p>setup script, you must use forward slashes, not backslashes. For example,</p>
<p>on Windows, you might enter the path</p>
<p>C:/GHS/<i>install_dir</i>/target/<i>architecture</i>/<i>bsp</i>/<i>script</i>.mbs</p>
<p>.)</p>
<p>â¢</p>
<p>The name of your debug server</p>
<p>â¢</p>
<p>The arguments required to start your debug server</p>
<p>Enter this information as you would if you had entered the<b> connect</b> command</p>
<p>in the MULTI command pane. You do not have to type<b> connect</b> in this field;</p>
<p>only enter the relevant arguments. See the description of the<b> connect</b> command</p>
<p>in the documentation about target connection commands in the<i> MULTI:</i></p>
<p><i>Debugging Command Reference</i> book.</p>
<p>For an example showing how to connect with a setup script, see</p>
<p>Example F.1. Connecting with a Setup Script on page 1016.</p>
<p>5.</p>
<p>Click<b> Apply</b> and then<b> Run</b>.</p>
<p>You can see the output of your project in the<b> Console</b> view.</p>
<p><i>1015</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Building and Running Your Project</i></p>
<h1 style="page-break-before:always; "></h1>
<p><b>Example F.1. Connecting with a Setup Script</b></p>
<p>Suppose you want to run your program on a target that requires a setup script. You</p>
<p>are connected to your target with a Green Hills Probe, and your target's IP address</p>
<p>is 192.168.100.55. To create, specify, and run a board setup script, you might do</p>
<p>the following:</p>
<p>1.</p>
<p>In the<b> Project Explorer</b> view, right-click your project and select<b> New</b> â<b> File</b>.</p>
<p>2.</p>
<p>In the<b> File name</b> text field, enter</p>
<p>script.mbs</p>
<p>and click<b> Finish</b>. Write a setup</p>
<p>script within this file or copy one of the<b> .mbs</b> setup scripts provided in the</p>
<p><b>target</b> directory of your MULTI installation.</p>
<p>3.</p>
<p>See âBuilding and Running Your Projectâ on page 1014 and follow steps 1-4</p>
<p>for running your project.</p>
<p>For step 4, enter arguments to the<b> connect</b> command. For example:</p>
<p>setup=script.mbs mpserv 192.168.100.55</p>
<p>where:</p>
<p>â¢</p>
<p>setup=script.mbs</p>
<p>specifies the name of the file that contains your</p>
<p>setup script.</p>
<p>â¢</p>
<p>mpserv</p>
<p>is the name of the debug server in use.</p>
<p>â¢</p>
<p>192.168.100.55</p>
<p>is the IP address of your target. This is a required</p>
<p><i>argument</i></p>
<p>for the<b> mpserv</b> debug server.</p>
<p>4.</p>
<p>Click<b> Apply</b> and then<b> Run</b>.</p>
<p><b>Debugging Your Project with the MULTI Debugger</b></p>
<p>You must build your project before you can debug it. For information, see âBuilding</p>
<p>and Running Your Projectâ on page 1014. To debug your project with the MULTI</p>
<p>Debugger:</p>
<p>1.</p>
<p>Ensure that your project is selected in the<b> Project Explorer</b> view and select</p>
<p><b>Run</b> â<b> Debug Configurations</b>.</p>
<p>2.</p>
<p>The<b> Debug Configurations</b> dialog appears. In the pane located on the left</p>
<p>side of the dialog, double-click<b> GHS Local C/C++ Launch</b> for a new</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1016</i></p>
<p><i>Appendix F. The MULTI Eclipse Plug-in</i></p>
<h1 style="page-break-before:always; "></h1>
<p>configuration of your project, or select a saved configuration. Run</p>
<p>configurations that you create in this dialog are saved for future use.</p>
<p>Under the<b> Main</b> tab, the<b> Project</b> text field should now contain the name of</p>
<p>your project.</p>
<p>3.</p>
<p>Click<b> Search Project</b>. In the<b> Program Selection</b> dialog box that appears,</p>
<p>ensure that the binary that is selected is the one you want to run. (If you have</p>
<p>never successfully built your project, no binary is present.) Click<b> OK</b>.</p>
<p>4.</p>
<p>In the<b> Connect to a target</b> text field, specify:</p>
<p>â¢</p>
<p>A setup script filename if applicable (Note that if you enter the path to a</p>
<p>setup script, you must use forward slashes, not backslashes. For example,</p>
<p>on Windows, you might enter the path</p>
<p>C:/GHS/<i>install_dir</i>/target/<i>architecture</i>/<i>bsp</i>/<i>script</i>.mbs</p>
<p>.)</p>
<p>â¢</p>
<p>The name of your debug server</p>
<p>â¢</p>
<p>The arguments required to start your debug server</p>
<p>Enter this information as you would if you had entered the<b> connect</b> command</p>
<p>in the MULTI command pane. You do not have to type<b> connect</b> in this field;</p>
<p>only enter the relevant arguments. See the description of the<b> connect</b> command</p>
<p>in the documentation about target connection commands in the<i> MULTI:</i></p>
<p><i>Debugging Command Reference</i> book.</p>
<p>For an example showing how to connect with a setup script, see</p>
<p>Example F.1. Connecting with a Setup Script on page 1016.</p>
<p>5.</p>
<p>Click<b> Apply</b> and then<b> Debug</b>.</p>
<p>The MULTI Debugger opens and automatically connects to your target. Debug</p>
<p>your project as usual.</p>
<p><i>1017</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Debugging Your Project with the MULTI Debugger</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Appendix G</b></p>
<p><b>Third-Party DES Copyright</b></p>
<p><b>Information</b></p>
<h1 style="page-break-before:always; "></h1>
<p>Copyright (C) 1995-1997 Eric Young (eay@cryptsoft.com)</p>
<p>All rights reserved.</p>
<p>This package is an DES implementation written by Eric Young (eay@cryptsoft.com).</p>
<p>The implementation was written so as to conform with MIT's libdes.</p>
<p>This library is free for commercial and non-commercial use as long as the following</p>
<p>conditions are aheared to. The following conditions apply to all code found in this</p>
<p>distribution.</p>
<p>Copyright remains Eric Young's, and as such any Copyright notices in the code are</p>
<p>not to be removed. If this package is used in a product, Eric Young should be given</p>
<p>attribution as the author of that the SSL library. This can be in the form of a textual</p>
<p>message at program startup or in documentation (online or textual) provided with</p>
<p>the package.</p>
<p>Redistribution and use in source and binary forms, with or without modification,</p>
<p>are permitted provided that the following conditions are met:</p>
<p>1.</p>
<p>Redistributions of source code must retain the copyright notice, this list of</p>
<p>conditions and the following disclaimer.</p>
<p>2.</p>
<p>Redistributions in binary form must reproduce the above copyright notice, this</p>
<p>list of conditions and the following disclaimer in the documentation and/or</p>
<p>other materials provided with the distribution.</p>
<p>3.</p>
<p>All advertising materials mentioning features or use of this software must</p>
<p>display the following acknowledgement:</p>
<p>This product includes software developed by Eric Young (eay@cryptsoft.com)</p>
<p>THIS SOFTWARE IS PROVIDED BY ERIC YOUNG &quot;AS IS&quot; AND ANY</p>
<p>EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED</p>
<p>TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS</p>
<p>FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL</p>
<p>THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,</p>
<p>INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</p>
<p>DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</p>
<p>SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</p>
<p>OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</p>
<p>THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</p>
<p>OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1020</i></p>
<p><i>Appendix G. Third-Party DES Copyright Information</i></p>
<h1 style="page-break-before:always; "></h1>
<p>WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</p>
<p>POSSIBILITY OF SUCH DAMAGE.</p>
<p>The license and distribution terms for any publically available version or derivative</p>
<p>of this code cannot be changed. i.e. this code cannot simply be copied and put under</p>
<p>another distrubution license [including the GNU Public License.]</p>
<p>The reason behind this being stated in this direct manner is past experience in code</p>
<p>simply being copied and the attribution removed from it and then being distributed</p>
<p>as part of other packages. This implementation was a non-trivial and unpaid effort.</p>
<p><i>1021</i></p>
<p><i>Green Hills Software</i></p>
<h1 style="page-break-before:always; "></h1>
<h1 style="page-break-before:always; "></h1>
<p><b>Index</b></p>
<p><b>Symbols</b></p>
<p>'Select One'</p>
<p>Project Extension List Builder option, 285</p>
<p>* (pointer) data type</p>
<p>signedness, 214</p>
<p>*_reserved memory area, 480</p>
<p>-gnu99 Inline Semantics Builder option, 309</p>
<p>-Olimit= Without Debug Information Builder option, 298</p>
<p>23-bit SDA (V850E2V3 and later) Builder option, 105, 138</p>
<p>23-bit ZDA (V850E2V3 and later) Builder option, 105, 139</p>
<p>64-bit integer arguments, 825</p>
<p>-64bit_load_store driver option, 157</p>
<p>.800 file extension, 8</p>
<p>.850 file extension, 8</p>
<p>? operator, 738</p>
<p>@filename assembler option, 397</p>
<p>@filename driver option, 15</p>
<p><b>A</b></p>
<p>-A driver option, 247</p>
<p>-a driver option, 302</p>
<p>.a file extension, 8, 516, 971</p>
<p>abort(), C implementation, 714</p>
<p>ABS linker section attribute, 490</p>
<p>absolute assembler expression, 407</p>
<p>absolute linker expression function, 488</p>
<p>Accept GNU __asm__ statements Builder option, 310</p>
<p>-act_like=2012.1 driver option, 160</p>
<p>-act_like=2012.5 driver option, 161</p>
<p>-act_like=2013.1 driver option, 161</p>
<p>-act_like=2013.5 driver option, 161</p>
<p>-act_like=2014.1 driver option, 161</p>
<p>-act_like=2015.1 driver option, 161</p>
<p>-act_like=5.0 driver option, 160</p>
<p>-act_like=5.2 driver option, 160</p>
<p>-act_like=latest driver option, 161</p>
<p>Add Extra File to Debug Info Builder option, 301</p>
<p>add instruction, macro expansion for, 450</p>
<p>__ADD_SAT() intrinsic function, 812</p>
<p>addi instruction, macro expansion for, 453</p>
<p>Additional Assembler Options Builder option, 233, 394</p>
<p>Additional Linker Options (among object files) Builder</p>
<p>option, 241</p>
<p>Additional Linker Options (before start file) Builder option,</p>
<p>240, 471</p>
<p>Additional Linker Options (beginning of link line) Builder</p>
<p>option, 239</p>
<p>Additional Output Files Builder option, 285</p>
<p>Additional SDA Base Registers (common) Builder option,</p>
<p>271</p>
<p>Additional SDA Base Registers Builder option, 106, 270</p>
<p>Additional System Library Builder option, 158</p>
<p>-additional_sda_common driver option, 271</p>
<p>-additional_sda_reg driver option, 106, 270</p>
<p>addr linker expression function, 488</p>
<p>addressing modes</p>
<p>for RH850 assembler, 445</p>
<p>for V850 assembler, 443</p>
<p>for V850E assembler, 444</p>
<p>for V850E2 assembler, 444</p>
<p>for V850E2R assembler, 445</p>
<p>for V850E2V3 assembler, 445</p>
<p>adf instructions, macro expansions for, 456</p>
<p>.ael output file type, 13</p>
<p>alias analysis</p>
<p>interprocedural optimizations, 338</p>
<p>library function, 339</p>
<p>read-based, 338</p>
<p>write-based, 338</p>
<p>alias GNU attribute, 719</p>
<p>.align assembler directive, 412</p>
<p>align linker expression function, 488</p>
<p>ALIGN linker section attribute, 490</p>
<p>Aligned Data Sections Builder option, 145</p>
<p>aligned GNU attribute, 719</p>
<p>alignment</p>
<p>bitfields, 690</p>
<p>packing (see structure packing)</p>
<p>requirements, 886</p>
<p>type double, 790</p>
<p>alignof linker expression function, 488</p>
<p>-allabsolute linker option, 471</p>
<p>-alloc_shared_mem driver option, 267</p>
<p>Allocate Pointers to the EP Register Builder option, 152</p>
<p>-allocate_ep driver option, 152</p>
<p>Allocation of Uninitialized Global Variables Builder option,</p>
<p>217, 720, 798, 799</p>
<p>Allow 1-bit accesses to single-bit volatile fields with any</p>
<p>base type Builder option, 153</p>
<p>Allow any use of 1-bit instructions CLR1 SET1 TST1</p>
<p>Builder option, 153</p>
<h1 style="page-break-before:always; "></h1>
<p>Allow C++ Style Slash Comments in C Builder option, 186</p>
<p>Allow Common Variables in ZDA Builder option, 140</p>
<p>-allow_1bit_volatile_any_basetype driver option, 153</p>
<p>-allow_bad_relocations linker option, 471</p>
<p>-allow_cxx_duplicates driver option, 317</p>
<p>--allow_different_section_types driver option, 315</p>
<p>-allow_linkonce_duplicates driver option, 317</p>
<p>-allow_overlap driver option, 266</p>
<p>Alternate Assembler Directory Builder option, 289</p>
<p>Alternate Compiler Directory Builder option, 288</p>
<p>Alternate Compression Table Builder option, 320</p>
<p>Alternate Header Name Builder option, 320</p>
<p>Alternate Library Directory Builder option, 288</p>
<p>Alternate Linker Directory Builder option, 289</p>
<p>alternate program start address</p>
<p>specifying, 122</p>
<p>Alternate Source Name Builder option, 320</p>
<p>Alternative Tokens Builder option, 218</p>
<p>--alternative_tokens driver option, 218</p>
<p>always_inline GNU attribute, 719</p>
<p>and instruction, macro expansion for, 452</p>
<p>andi instruction, macro expansion for, 453</p>
<p>Annotated C++ Reference Manual, The (ARM), 742</p>
<p>annotated examples</p>
<p>images for linking, converting, 991</p>
<p>ANSI Aliasing Rules Builder option, 187</p>
<p>ANSI C</p>
<p>extensions, 663</p>
<p>limitations, 689</p>
<p>required macro names, 780</p>
<p>specifying, 663</p>
<p>-ANSI driver option, 184, 662, 669, 685</p>
<p>-ansi driver option, 184, 662, 663, 684</p>
<p>ansi header file directory, 819</p>
<p>-ansi_alias driver option, 187</p>
<p>--any_output_suffix driver option, 277</p>
<p>-any_p_align linker option, 472</p>
<p>Append Comment Section with Link-Time Information</p>
<p>Builder option, 237</p>
<p>Append Default Extension to Output Filename Builder</p>
<p>option, 280</p>
<p>-append linker option, 472</p>
<p>Append String to Every Section Name Builder option, 309</p>
<p>:appendExtension Builder option, 280</p>
<p>-archive driver option, 11, 12, 516</p>
<p>archiver (see librarian)</p>
<p>archives (see libraries)</p>
<p>argument field, 401</p>
<p>arguments</p>
<p>evaluation of, 35</p>
<p>register usage, 36</p>
<p>stack offsets for, 36</p>
<p>arithmetic</p>
<p>machine specific, 891</p>
<p>pointer, 889</p>
<p>ARM compliant C++, 742</p>
<p>--arm driver option, 185, 742</p>
<p>__ARRAY_OPERATORS, 792</p>
<p>arrays</p>
<p>new and delete, predefined macro, 792</p>
<p>-asm driver option, 233, 394</p>
<p>asm facility, 898</p>
<p>asm body, 904</p>
<p>asm macro, 899</p>
<p>con, 903</p>
<p>error, 904</p>
<p>examples, 899</p>
<p>farmem, 904</p>
<p>farsprel, 904</p>
<p>lab, 904</p>
<p>macro body, 899</p>
<p>mem, 904</p>
<p>nearmem, 904</p>
<p>pattern, 899</p>
<p>reg, 904</p>
<p>storage mode, 899</p>
<p>treg, 903, 904</p>
<p>ureg, 904</p>
<p>using asm macros, 901</p>
<p>writing asm macros, 907</p>
<p>.asm file extension, 8, 971</p>
<p>__asm keyword (see asm statements)</p>
<p>asm keyword (see asm statements)</p>
<p>asm statements</p>
<p>overview, 695</p>
<p>#pragma directive for, 796</p>
<p>Asm Statements Builder option, 257, 684, 696</p>
<p>-asm_diag_error driver option, 261</p>
<p>-asm_diag_suppress driver option, 261</p>
<p>-asm_diag_warning driver option, 261</p>
<p>--asm_errors driver option, 257, 696</p>
<p>--asm_silent driver option, 257, 684, 696</p>
<p>--asm_warnings driver option, 257, 696</p>
<p>-asm3g driver option, 234</p>
<p>-asmcmd driver option, 234, 394</p>
<p>assembler, 394</p>
<p>assignment statements, 402</p>
<p>command line options for, 396</p>
<p>escape sequences, 400</p>
<p>expressions, 402</p>
<p>for V850, 434</p>
<p>introduction to, xxxi</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1024</i></p>
<p><i>Allow C++ Style Slash Comments in C Builder option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>invoking with the driver, 79</p>
<p>listings, 423</p>
<p>passing options to through compiler driver, 394</p>
<p>running with compiler driver, 394</p>
<p>syntax, 398</p>
<p>Assembler Command File Builder option, 234, 394</p>
<p>assembler directives</p>
<p>.align, 412</p>
<p>.assert, 428</p>
<p>.byte, 414</p>
<p>.comm, 424</p>
<p>.data, 421</p>
<p>.double, 414</p>
<p>.dsect, 424</p>
<p>.eject, 423</p>
<p>.else, 413</p>
<p>.elseif, 413</p>
<p>.end, 424</p>
<p>.endif, 413</p>
<p>.endm, 418</p>
<p>.endo ident, 426</p>
<p>.endr, 420</p>
<p>.equ, 402</p>
<p>.exitm, 419</p>
<p>.file, 426</p>
<p>.fsize, 426</p>
<p>.gen, 423</p>
<p>.ghsnote, 511</p>
<p>.globl, 424</p>
<p>.hword, 414</p>
<p>.ident, 428</p>
<p>.if, 413</p>
<p>.include, 416</p>
<p>.inspect, 424</p>
<p>.lcomm, 424</p>
<p>.list, 423</p>
<p>.lsbss, 424</p>
<p>.macro, 419</p>
<p>.maxinstances, 426</p>
<p>.maxstack, 426</p>
<p>.need, 428</p>
<p>.nodebug, 426</p>
<p>.nogen, 423</p>
<p>.nolist, 423</p>
<p>.note, 421</p>
<p>.nowarning, 423</p>
<p>.offset, 414</p>
<p>.org, 421</p>
<p>.previous, 421</p>
<p>.rept, 420</p>
<p>.rh850_flags, 429</p>
<p>.sbss, 425</p>
<p>.sbttl, 423</p>
<p>.scall, 427</p>
<p>.section, 422</p>
<p>.set, 402, 425</p>
<p>.single, 414</p>
<p>.size, 427</p>
<p>.space, 414</p>
<p>.str, 414</p>
<p>.strz, 414</p>
<p>.subtitle, 423</p>
<p>.text, 422</p>
<p>.title, 423</p>
<p>.type, 427</p>
<p>.warning, 423</p>
<p>.weak, 425</p>
<p>.word, 415</p>
<p>.zbss, 425</p>
<p>assembler options</p>
<p>@filename, 397</p>
<p>-bit_inst_error, 396</p>
<p>-cpu, 396</p>
<p>-cpu=cpu, 397</p>
<p>-fpu30, 396</p>
<p>-help, 397</p>
<p>-I, 397</p>
<p>-list, 397</p>
<p>-noexpandbranch, 396</p>
<p>-nofpu, 396</p>
<p>-nofpu_double, 396</p>
<p>-nofpu30, 396</p>
<p>-nomacro, 396</p>
<p>-norh850_simd, 396</p>
<p>-noshortbranches, 396</p>
<p>-o, 397</p>
<p>-rh850_fpsimd=full, 397</p>
<p>-rh850_fpsimd=half, 397</p>
<p>-rh850_fpsimd=none, 397</p>
<p>-rh850_simd, 396</p>
<p>-source, 397</p>
<p>-V, 397</p>
<p>-w,</p>
<p>Assembler Warnings Builder option, 313</p>
<p>--assembler_warnings driver option, 313</p>
<p>Assembly Files to Pre-Include Builder option, 306</p>
<p>assembly language, 398</p>
<p>and multiple TDA optimization, 116</p>
<p>assignment statements, 402</p>
<p>bitfield manipulation for V850, 468</p>
<p>comments, 401</p>
<p>constants for, 398</p>
<p><i>1025</i></p>
<p><i>Green Hills Software</i></p>
<p><i>assembler (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>continuation lines, 401</p>
<p>escape sequences for, 400</p>
<p>example for V850, 458, 460, 462, 463, 464, 465, 467, </p>
<p>468</p>
<p>expression types, 407</p>
<p>expressions, 402</p>
<p>guidelines for V850, 457</p>
<p>identifiers for, 398</p>
<p>interface, 891</p>
<p>interleaving with source code, 233</p>
<p>labels, 408</p>
<p>line terminators, 401</p>
<p>macro expansions for V850, 449</p>
<p>operator precedence, 403</p>
<p>operators, 402</p>
<p>source statement syntax, 400</p>
<p>type combinations, 407</p>
<p>.assert assembler directive, 428</p>
<p>assert(), C implementation, 712</p>
<p>assertions, static, 814</p>
<p>assignment statements, assembler, 402</p>
<p>at GNU attribute, 720</p>
<p>AT linker section attribute, 490</p>
<p>__attribute__ keyword, 718</p>
<p>attributes</p>
<p>ghs_noprofile, 723</p>
<p>auto Type Keyword Support Builder option, 223</p>
<p>-auto_large_archive driver option, 316</p>
<p>-auto_large_archive librarian option, 521</p>
<p>--auto_type driver option, 223</p>
<p>:autoInclude driver option, 287</p>
<p>Automatic Register Allocation Builder option, 292, 363</p>
<p>automatic register allocation optimization, 363</p>
<p>automatic two-pass inlining, 329</p>
<p>Automatically allocate shared memory for the cores and</p>
<p>shared object Builder option, 267</p>
<p>-autoregister driver option, 293</p>
<p>AUTOSAR and OSEK operating system awareness, 644</p>
<p>ax (see librarian)</p>
<p><b>B</b></p>
<p>base register</p>
<p>for TDA, 108, 109</p>
<p>__BASE__, 791</p>
<p>bcond instruction, macro expansion for, 455</p>
<p>__BIG_ENDIAN__, 786</p>
<p>__bigendian keyword, 687</p>
<p>-bigswitch driver option, 272</p>
<p>binary code generation, xxxi, 274</p>
<p>Binary Code Generation Builder option, 274</p>
<p>binary files, importing, 238</p>
<p>binary memory image</p>
<p>generating, 236, 574</p>
<p>binary operators, 402</p>
<p>Binary Output Directory Relative to This File Builder option,</p>
<p>278</p>
<p>Binary Output Directory Relative to Top-Level Project</p>
<p>Builder option, 278</p>
<p>:binDir Builder option, 278</p>
<p>:binDirRelative Builder option, 278</p>
<p>-bit_inst_error assembler option, 396</p>
<p>bitfield manipulation for V850, 468</p>
<p>bitfields, 688, 887</p>
<p>alignment and size, 690</p>
<p>code efficiency, 690</p>
<p>portability, 887</p>
<p>signedness of, 214, 689</p>
<p>.bmon output file type, 13</p>
<p>.bod files (see customization files (.bod))</p>
<p>_BOOL, 792</p>
<p>bool data type, 792</p>
<p>--bool driver option, 221, 792</p>
<p>Bool Type Support Builder option, 221</p>
<p>Brief Error Message Mode Builder option, 256</p>
<p>--brief_diagnostics driver option, 256</p>
<p>.bsp</p>
<p>file extension, 972</p>
<p>-bsp driver option, 52</p>
<p>.bss program section, 82, 925</p>
<p>buffering</p>
<p>C++ I/O streams, 824</p>
<p>build configurations, project, 962</p>
<p>Builder options</p>
<p>'Select One'</p>
<p>Project Extension List, 285</p>
<p>-gnu99 Inline Semantics, 309</p>
<p>-Olimit= Without Debug Information, 298</p>
<p>23-bit SDA (V850E2V3 and later), 105, 138</p>
<p>23-bit ZDA (V850E2V3 and later), 105, 139</p>
<p>Accept GNU __asm__ statements, 310</p>
<p>Add Extra File to Debug Info, 301</p>
<p>Additional Assembler Options, 233, 394</p>
<p>Additional Linker Options (among object files), 241</p>
<p>Additional Linker Options (before start file), 240, 471</p>
<p>Additional Linker Options (beginning of link line), 239</p>
<p>Additional Output Files, 285</p>
<p>Additional SDA Base Registers, 106, 270</p>
<p>Additional SDA Base Registers (common), 271</p>
<p>Additional System Library, 158</p>
<p>Aligned Data Sections, 145</p>
<p>Allocate Pointers to the EP Register, 152</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1026</i></p>
<p><i>assembly language (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Allocation of Uninitialized Global Variables, 217, 720, </p>
<p>798, 799</p>
<p>Allow 1-bit accesses to single-bit volatile fields with any</p>
<p>base type, 153</p>
<p>Allow any use of 1-bit instructions CLR1 SET1 TST1,</p>
<p>153</p>
<p>Allow C++ Style Slash Comments in C, 186</p>
<p>Allow Common Variables in ZDA, 140</p>
<p>Alternate Assembler Directory, 289</p>
<p>Alternate Compiler Directory, 288</p>
<p>Alternate Compression Table, 320</p>
<p>Alternate Header Name, 320</p>
<p>Alternate Library Directory, 288</p>
<p>Alternate Linker Directory, 289</p>
<p>Alternate Source Name, 320</p>
<p>Alternative Tokens, 218</p>
<p>ANSI Aliasing Rules, 187</p>
<p>Append Comment Section with Link-Time Information,</p>
<p>237</p>
<p>Append Default Extension to Output Filename, 280</p>
<p>Append String to Every Section Name, 309</p>
<p>:appendExtension, 280</p>
<p>Asm Statements, 257, 684, 696</p>
<p>Assembler Command File, 234, 394</p>
<p>Assembler Warnings, 313</p>
<p>Assembly Files to Pre-Include, 306</p>
<p>auto Type Keyword Support, 223</p>
<p>Automatic Register Allocation, 292, 363</p>
<p>Automatically allocate shared memory for the cores and</p>
<p>shared object, 267</p>
<p>Binary Code Generation, 274</p>
<p>Binary Output Directory Relative to This File, 278</p>
<p>Binary Output Directory Relative to Top-Level Project,</p>
<p>278</p>
<p>:binDir, 278</p>
<p>:binDirRelative, 278</p>
<p>Bool Type Support, 221</p>
<p>Brief Error Message Mode, 256</p>
<p>C Include Directories, 307</p>
<p>C Japanese Automotive Extensions, 185, 684, 685</p>
<p>C Language Dialect, 184, 662, 663, 669, 670, 677, 679, </p>
<p>684, 685, 687, 689, 697</p>
<p>C++ Exception Handling, 186, 735, 736</p>
<p>C++ Inlining Level, 308</p>
<p>C++ Language Dialect, 185, 186, 734, 735, 736, 739, </p>
<p>741, 742, 743</p>
<p>C++ Libraries, 186, 735</p>
<p>C++ Linking Method, 312</p>
<p>C++ Standard Include Directories, 307</p>
<p>C/C++ Minimum/Maximum Optimization, 294, 359</p>
<p>Change Assembler, 319</p>
<p>Check for Stack Smashing Attacks, 143</p>
<p>Check incompatible RH850 ABI flags (RH850 only), 158</p>
<p>Checksum, 126, 251</p>
<p>Code Factoring, 243, 509</p>
<p>Coding Standard Profile, 255, 768, 775</p>
<p>Commands to Execute After Associated Command, 283</p>
<p>Commands to Execute After Associated Command (via</p>
<p>Shell), 284</p>
<p>Commands to Execute Before Associated Command, 280</p>
<p>Commands to Execute Before Associated Command (via</p>
<p>Shell), 281</p>
<p>Common Subexpression Elimination, 293, 356</p>
<p>Consistent code without debug information, 298</p>
<p>Constant Propagation, 293, 358</p>
<p>Convert C Memset to Memclr, 291</p>
<p>Convert DWARF Files to MULTI (.dbo) Format, 305</p>
<p>Convert Stabs Files to MULTI (.dbo) Format, 305</p>
<p>Create S-Record File Image, 159</p>
<p>Cross-Reference Information, 303</p>
<p>Data Bus Width, 131</p>
<p>Dbo File Version, 319</p>
<p>Debug Information (.dbo) Tracing Diagnostics, 319</p>
<p>Debugging Information, 304</p>
<p>Debugging Level, 55, 57, 176, 290, 305, 808</p>
<p>Deferral of Function Template Parsing, 231</p>
<p>Define Linker Constant, 246</p>
<p>Define Preprocessor Symbol, 182</p>
<p>Definition of Standard Symbols, 306</p>
<p>Definition of Unsafe Symbols, 306, 780</p>
<p>Deletion of Unused Functions, 80, 243</p>
<p>Demangling of Names in Linker Messages, 311</p>
<p>Dependencies Relative to Source Directory, 278</p>
<p>Dependencies Relative to This File, 278</p>
<p>Dependencies Relative to Top-Level Project, 279</p>
<p>Dependent Name Processing, 229, 230, 736, 753, 756</p>
<p>:depends, 278</p>
<p>:dependsNonRelative, 279</p>
<p>:dependsRelative, 278</p>
<p>Display End-of-Function Symbols in Map File, 250</p>
<p>Display Error Message Numbers, 260, 261, 803</p>
<p>Display Error Message Paths, 256</p>
<p>Display includes Preprocessor Directives Listing, 182</p>
<p>Display Local Symbols in Map File, 250</p>
<p>Display Unused Functions in Map File, 249</p>
<p>Display Version Information, 254</p>
<p>Distinct C and C++ Functions, 312, 736, 737</p>
<p>Do not allow types double or long double, 273</p>
<p>DoubleCheck Config File, 264</p>
<p>DoubleCheck Errors to Ignore, 264</p>
<p>DoubleCheck Level, 263</p>
<p>DoubleCheck Output that Stops Builds, 264</p>
<p><i>1027</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Builder options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>DoubleCheck Report File, 263</p>
<p>Duplicate Whitelist, 243</p>
<p>EAGLE Logging, 177</p>
<p>EAGLE Mute Signal, 297</p>
<p>EAGLE Record Signal, 296</p>
<p>EAGLE Strip Signal, 297</p>
<p>EDG Front End Options, 319</p>
<p>Emulate Behaviors of a Specific Compiler Version, 160, </p>
<p>181</p>
<p>Emulated GNU Version, 309</p>
<p>Enable SIMD instructions (RH850 and later), 155</p>
<p>End Files, 244</p>
<p>Epilogues and Prologues via callt, 40, 151</p>
<p>Epilogues and Prologues via prepare and dispose, 40, 152</p>
<p>Error on Duplicate Symbols in an Archive, 316</p>
<p>Event Logging, 159</p>
<p>Executable Stripping, 236</p>
<p>Explode Jumps, 292</p>
<p>Export All Symbols From Library, 247</p>
<p>Extend Variable Liveness, 299</p>
<p>Extract Whole Archive, 241</p>
<p>:extraOutputFile, 285</p>
<p>Far Calls, 94, 95, 141</p>
<p>far function calls, 94</p>
<p>Files Listing External Symbols, 170</p>
<p>Files to Pre-Include, 305</p>
<p>Floating Point Associativity, 134</p>
<p>Floating-Point Functions, 134</p>
<p>Floating-Point Mode, 132</p>
<p>Floating-Point Precise Signed Zero, 135</p>
<p>Floating-Point Precise Signed Zero Compare, 135</p>
<p>Floating-Point SIMD mode (RH850 and later), 157</p>
<p>Follow Section, 315</p>
<p>Force All Symbols From Library, 246</p>
<p>Force Frame Pointer, 181, 300</p>
<p>Force the save/restore of R4/R5 in ISR prologue/epilogue,</p>
<p>155</p>
<p>Force the save/restore of the EIIC register in ISR</p>
<p>prologue/epilogue, 156</p>
<p>Force Undefined Symbol, 246</p>
<p>Full Breakdots, 298</p>
<p>Function Entry/Exit Logging, 176</p>
<p>Function Prologues, 271, 802</p>
<p>Functions Without Prototypes, 257, 259</p>
<p>Gcores Common Link Options, 266</p>
<p>GCores Cores Import Symbols From Other Cores, 266</p>
<p>GCores Cpu, 267</p>
<p>GCores Disable Error Messages Concerning Overlapping</p>
<p>Sections, 266</p>
<p>GCores Driver, 266</p>
<p>Gcores Exported Absolutes Only, 267</p>
<p>GCores Generate Additional Output, 268</p>
<p>Gcores Output Filename, 265</p>
<p>Gcores Shared Modules Import Symbols From Cores,</p>
<p>265</p>
<p>Generate a backwards-compatible (MULTI 5.1.x and</p>
<p>earlier) call table in the linker, 150</p>
<p>Generate Additional Output, 13, 236</p>
<p>Generate Function Entry/Exit Instrumentation, 296</p>
<p>Generate Function Entry/Exit Instrumentation with</p>
<p>Arguments, 296</p>
<p>Generate MULTI and Native Information, 304</p>
<p>Generate Target-Walkable Stack, 37, 38, 297</p>
<p>Global Registers, 92, 106, 142</p>
<p>GNU Compatibility Optimizations, 295</p>
<p>Green Hills Standard Mode, 255</p>
<p>Guiding Declarations of Template Functions, 227</p>
<p>Host and Target Character Encoding, 219, 700, 761</p>
<p>HTML File Compression, 320</p>
<p>Identifier Blacklist, 318</p>
<p>Identifier Definition, 311</p>
<p>Identifier Support, 311</p>
<p>Implicit Int Return Type, 258</p>
<p>Implicit Source File Inclusion, 228, 230, 736, 752, 753</p>
<p>Implicit Use of 'std'</p>
<p>Namespace, 220</p>
<p>Import libraries into shared module, 267</p>
<p>Import Symbols, 247</p>
<p>Include Directories, 76, 77, 161</p>
<p>Incorrect Pragma Directives, 258, 795</p>
<p>Individual Function Sections for Default Text Section,</p>
<p>148</p>
<p>Individual Function Sections for Renamed Text Sections,</p>
<p>148</p>
<p>Individual Function Sections for User-Defined Text</p>
<p>Sections, 149</p>
<p>Individual Variable Sections for Default Data Sections,</p>
<p>146</p>
<p>Individual Variable Sections for Renamed Data Sections,</p>
<p>146</p>
<p>Individual Variable Sections for User-Defined Data</p>
<p>Sections, 147</p>
<p>Initialize RAM at Startup, 271</p>
<p>Inline C Memory Functions, 290, 333</p>
<p>Inline C String Functions, 291</p>
<p>Inline Constant Math Functions, 290, 337</p>
<p>Inline Larger Functions, 169, 331, 332</p>
<p>Inline Specific Functions, 175, 329, 331, 332</p>
<p>Inline Tiny Functions, 290</p>
<p>Input Languages, 276</p>
<p>Instantiate Extern Inline, 222, 736</p>
<p>Instrument loads with software trace instructions, 153</p>
<p>Interleaved Source and Assembly, 233</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1028</i></p>
<p><i>Builder options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Intermediate Output Directory Relative to This File, 277</p>
<p>Intermediate Output Directory Relative to Top-Level</p>
<p>Project, 164</p>
<p>Intermodule Inlining, 167, 329, 330, 331, 332</p>
<p>Interprocedural Optimizations, 168, 338, 341, 344, 345, </p>
<p>346</p>
<p>IP Alias Lib Functions, 174, 339</p>
<p>IP Alias Reads, 174, 338</p>
<p>IP Alias Writes, 174, 339</p>
<p>IP Constant Globals, 172, 343</p>
<p>IP Constant Propagation, 172, 342</p>
<p>IP Constant Returns, 173, 339</p>
<p>IP Delete Functions, 171, 344</p>
<p>IP Delete Globals, 171, 344</p>
<p>IP Limit Inlining, 173</p>
<p>IP Localize Globals, 172, 344</p>
<p>IP One-Site Inlining, 171, 342</p>
<p>IP Remove Parameters, 173, 343</p>
<p>IP Remove Returns, 173, 343</p>
<p>IP Small Inlining, 172, 339</p>
<p>Keep GCores Temporary Files, 267</p>
<p>Libraries, 79, 162</p>
<p>Library Directories, 79, 162</p>
<p>Line Wrap Messages, 256</p>
<p>Link in Minimum Libraries, 314</p>
<p>Link in Standard Libraries, 314</p>
<p>Link Mode, 314</p>
<p>Link-Once Template Instantiation, 227, 746, 749</p>
<p>Link-Time Global Variable Type Checking, 251</p>
<p>Link-Time Global Variable Type Qualifiers, 252</p>
<p>Link-Time Ignore Debug References, 244</p>
<p>Linker Command File, 241</p>
<p>Linker Directive Files with Non-standard Extensions, 238</p>
<p>Linker Directives Directory, 313</p>
<p>Linker Optimizations, 167, 243</p>
<p>Linker Warnings, 237</p>
<p>Linker-Based Far Call Patching, 94, 142</p>
<p>Linker-Based Move Shortening, 140</p>
<p>Linker-Based SDA23/ZDA23 Shortening (V850E2V3</p>
<p>and later), 105, 139</p>
<p>Linking Sections with Different Types, 315</p>
<p>Long Long Support, 214</p>
<p>longjmp() Does Not Restore Local Vars, 310</p>
<p>Loop Optimize Specific Functions, 175, 347, 348, 350</p>
<p>Loop Unrolling, 292, 347, 351</p>
<p>Map File Cross-Referencing, 249</p>
<p>Map File Generation, 248</p>
<p>Map File Page Length, 248</p>
<p>Map File Retention, 248</p>
<p>Map File Sorting, 249</p>
<p>Maximize Optimizations, 169</p>
<p>Maximum Number of Errors to Display, 253</p>
<p>Memory Optimization, 294, 359, 360, 687, 893, 894</p>
<p>Misaligned Memory Access, 216</p>
<p>MISRA C - Advisory Rules Level, 203</p>
<p>MISRA C - Required Rules Level, 203</p>
<p>MISRA C - Run-Time Checks, 204</p>
<p>MISRA C 1998 Rules - Character Set, 205</p>
<p>MISRA C 1998 Rules - Comments, 205</p>
<p>MISRA C 1998 Rules - Constants, 206</p>
<p>MISRA C 1998 Rules - Control Flow, 209</p>
<p>MISRA C 1998 Rules - Conversions, 208</p>
<p>MISRA C 1998 Rules - Declarations and Definitions, 207</p>
<p>MISRA C 1998 Rules - Environment, 204</p>
<p>MISRA C 1998 Rules - Expressions, 208</p>
<p>MISRA C 1998 Rules - Functions, 209</p>
<p>MISRA C 1998 Rules - Identifiers, 206</p>
<p>MISRA C 1998 Rules - Initialization, 207</p>
<p>MISRA C 1998 Rules - Operators, 207</p>
<p>MISRA C 1998 Rules - Pointers and Arrays, 211</p>
<p>MISRA C 1998 Rules - Preprocessor, 210</p>
<p>MISRA C 1998 Rules - Standard Library, 212</p>
<p>MISRA C 1998 Rules - Structs and Unions, 212</p>
<p>MISRA C 1998 Rules - Types, 206</p>
<p>MISRA C 2004 Rules - 1 Environment, 187</p>
<p>MISRA C 2004 Rules - 10 Arithmetic Type Conversions,</p>
<p>193</p>
<p>MISRA C 2004 Rules - 11 Pointer Type Conversions,</p>
<p>193</p>
<p>MISRA C 2004 Rules - 12 Expressions, 194</p>
<p>MISRA C 2004 Rules - 13 Control Statement Expressions,</p>
<p>195</p>
<p>MISRA C 2004 Rules - 14 Control Flow, 196</p>
<p>MISRA C 2004 Rules - 15 Switch Statements, 197</p>
<p>MISRA C 2004 Rules - 16 Functions, 198</p>
<p>MISRA C 2004 Rules - 17 Pointers and Arrays, 199</p>
<p>MISRA C 2004 Rules - 18 Structs and Unions, 199</p>
<p>MISRA C 2004 Rules - 19 Preprocessing Directives, 200</p>
<p>MISRA C 2004 Rules - 2 Language Extensions, 188</p>
<p>MISRA C 2004 Rules - 20 Standard Libraries, 202</p>
<p>MISRA C 2004 Rules - 21 Run-time Failures, 203</p>
<p>MISRA C 2004 Rules - 3 Documentation, 188</p>
<p>MISRA C 2004 Rules - 4 Character Sets, 189</p>
<p>MISRA C 2004 Rules - 5 Identifiers, 189</p>
<p>MISRA C 2004 Rules - 6 Types, 190</p>
<p>MISRA C 2004 Rules - 7 Constants, 191</p>
<p>MISRA C 2004 Rules - 8 Declarations and Definitions,</p>
<p>191</p>
<p>MISRA C 2004 Rules - 9 Initialization, 192</p>
<p>Multicore Configuration File, 302</p>
<p>Multicore Core Count, 303</p>
<p>Multiply-Defined Symbols, 245</p>
<p><i>1029</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Builder options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Namespace Support, 220, 756</p>
<p>NaN Compares as Unordered, 134</p>
<p>New-Style Cast Support, 223</p>
<p>:nodepends, 279</p>
<p>Non-Standard Output Suffix, 277</p>
<p>:noSelfDepend, 279</p>
<p>Object File Output Directory, 160, 229</p>
<p>One Instantiation Per Object, 228, 229, 749</p>
<p>Optimization Strategy, 165, 170, 175, 289, 290, 324, 336, </p>
<p>347, 352, 353, 356, 357, 358, 359, 360, 361, 362, </p>
<p>687, 808, 894</p>
<p>Optimize Accesses to Adjacent Bitfields, 153</p>
<p>Optimize All Appropriate Loops, 294, 347, 348, 350, 894</p>
<p>Optimize Specific Functions for Size, 175</p>
<p>Optimize Specific Functions for Speed, 174</p>
<p>Options to Apply to Project, 287</p>
<p>OS Directory, 159</p>
<p>Output Archives in 64-Bit Format, 316</p>
<p>Output File Size Analysis, 250</p>
<p>Output File Type, 235</p>
<p>Output Filename, 122, 163</p>
<p>Output Filename for Generic Types, 279</p>
<p>:outputDir, 164</p>
<p>:outputDirRelative, 277</p>
<p>:outputName, 279</p>
<p>Packing (Maximum Structure Alignment), 30, 31, 215, </p>
<p>807</p>
<p>Parse Templates in Generic Form, 230</p>
<p>Pass Through Arguments, 286</p>
<p>:passThrough, 286</p>
<p>Pattern of Files to Pull Into Project, 287</p>
<p>Peephole Optimization, 294, 352</p>
<p>Perform a syncp before branching in interrupt vectors</p>
<p>created with #pragma intvect, 156</p>
<p>Physical Address Offset From Virtual Address, 315</p>
<p>Pipeline and Peephole Scope, 168, 352, 353</p>
<p>Pipeline Instruction Scheduling, 295, 353</p>
<p>Place all read-only SDA items in ZDA instead, 140</p>
<p>Placement of Class Constructor Call to New, 224</p>
<p>Placement of Zero-Initialized Data, 142</p>
<p>Position Independent Code, 117, 141</p>
<p>Position Independent Data, 106, 119, 141</p>
<p>:postexec, 283</p>
<p>:postexecSafe, 284</p>
<p>:postexecShell, 284</p>
<p>:postexecShellSafe, 285</p>
<p>:preexec, 281</p>
<p>:preexecSafe, 281</p>
<p>:preexecShell, 282</p>
<p>:preexecShellSafe, 282</p>
<p>Prelink File to Create Template Instances, 230</p>
<p>Prepend String to Every Section Name, 309</p>
<p>Preprocess Assembly Files, 232, 394</p>
<p>Preprocess Linker Directives Files, 237</p>
<p>Preprocess Special Assembly Files, 233</p>
<p>printf and scanf Argument Type Checking, 258</p>
<p>Profiling - Block Coverage, 177</p>
<p>Profiling - Call Count, 66, 301</p>
<p>Profiling - Legacy Coverage, 302</p>
<p>Profiling - Target-Based Timing, 70, 178</p>
<p>Quit Building if Warnings are Generated, 254</p>
<p>RAM Initialization Value, 271</p>
<p>Range-Based For Loop Support, 221</p>
<p>Raw Import Files, 238</p>
<p>Recognition of Exported Templates, 230, 736, 753</p>
<p>Redirect Error Output to File, 254</p>
<p>Redirect Error Output to Overwriting File, 317</p>
<p>Reference, 286</p>
<p>Register Allocation by Coloring, 292, 362</p>
<p>Register Description File, 129</p>
<p>Register Mode, 33, 106, 130</p>
<p>Register r2, 34, 129</p>
<p>Register r5, 129</p>
<p>Remarks, 253</p>
<p>Rename Section, 145</p>
<p>Report an Error When Multiple Libraries on a Link Line</p>
<p>Contain a Definition of the Same Symbol, 242</p>
<p>Require 4-byte alignment on offsets of word-sized</p>
<p>load/store instructions, 156</p>
<p>restrict Keyword Support, 221</p>
<p>Retain Comments During Preprocessing, 306</p>
<p>Retain Symbols for Unused Statics, 218</p>
<p>ROM SDA, 130</p>
<p>Run-Time Error Checks, 70, 178, 800</p>
<p>Run-Time Memory Checks, 72, 74, 180, 300</p>
<p>Run-Time Type Information Support, 225</p>
<p>Safe Commands to Execute After Associated Command,</p>
<p>284</p>
<p>Safe Commands to Execute After Associated Command</p>
<p>(via Shell), 285</p>
<p>Safe Commands to Execute Before Associated Command,</p>
<p>281</p>
<p>Safe Commands to Execute Before Associated Command</p>
<p>(via Shell), 282</p>
<p>Save CTPSW and CTPC registers in Interrupt Routines,</p>
<p>40, 151</p>
<p>Scan source files to augment native debug info, 300</p>
<p>Search for DBA, 299</p>
<p>Search Path for .dbo Files, 299</p>
<p>Section Overlap Checking, 251</p>
<p>:select, 285</p>
<p>Self-Dependency, 279</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1030</i></p>
<p><i>Builder options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Set Assembler Message to Error, 261</p>
<p>Set Assembler Message to Silent, 261</p>
<p>Set Assembler Message to Warning, 261</p>
<p>Set Linker Message to Error, 262</p>
<p>Set Linker Message to Silent, 262</p>
<p>Set Linker Message to Warning, 262</p>
<p>Set Maximum DBO Not Found Warnings, 301</p>
<p>Set Message to Error, 260</p>
<p>Set Message to Remark, 260</p>
<p>Set Message to Silent, 260</p>
<p>Set Message to Warning, 260</p>
<p>Set Register r20 to the Value 255, 130</p>
<p>Set Register r21 to the Value 65535, 131</p>
<p>Shadow Declarations, 259</p>
<p>Signedness of Bitfields, 213, 684, 689, 763</p>
<p>Signedness of Char Type, 213, 684, 762</p>
<p>Signedness of Pointers, 214</p>
<p>Simplify C Print Functions, 291</p>
<p>Size of time_t, 215</p>
<p>Small Data Area File, 99, 137</p>
<p>Source Directories Relative to This File, 163</p>
<p>Source Directories Relative to Top-Level Project, 277</p>
<p>Source Listing Generation, 79, 232, 233</p>
<p>Source Listing Generation Output Directory, 232</p>
<p>Source Root, 161</p>
<p>:sourceDir, 163</p>
<p>:sourceDirNonRelative, 277</p>
<p>Special Data Area, 98, 136, 805</p>
<p>Stack Limit Checking, 143</p>
<p>Standard Include Directories, 307</p>
<p>Start Address Symbol, 122, 236, 475</p>
<p>Start File Directory, 245</p>
<p>Start Files, 244</p>
<p>Support __noinline Keyword for Templates, 222, 336</p>
<p>Support floating point types in scanf, 313</p>
<p>Support for C Type Information in Assembly, 234</p>
<p>Support for Constructors/Destructors, 223</p>
<p>Support for Implicit Extern C Type Conversion, 312</p>
<p>Support for Implicit Typenames, 228</p>
<p>Support for Old-Style Specializations, 227, 228</p>
<p>Support for Very Large Switch Statements, 272</p>
<p>Support Variable Length Arrays, 218</p>
<p>Suppress Dependencies, 279</p>
<p>Switch Tables, 272</p>
<p>Symbol Blacklist, 318</p>
<p>Symbols Referenced Externally, 170</p>
<p>System Include Directories, 307</p>
<p>Tail Calls, 293, 357</p>
<p>Target Processor, 270</p>
<p>Template Instantiation Output Directory, 229</p>
<p>Temporary Assembly Output, 276</p>
<p>Temporary Output, 275</p>
<p>Temporary Output Directory, 275</p>
<p>Temporary Preprocessor Output, 276</p>
<p>Treat Doubles as Singles, 133</p>
<p>Treatment of RTTI as const, 225</p>
<p>Treatment of Virtual Tables as 'const', 226</p>
<p>Trigraphs, 259</p>
<p>Undefine Preprocessor Symbol, 182</p>
<p>Undefined Preprocessor Symbols, 259</p>
<p>Undefined Symbols, 245</p>
<p>Uniquely Allocate All Strings, 217, 762</p>
<p>Unknown Pragma Directives, 257, 795</p>
<p>Unroll Larger Loops, 169, 351</p>
<p>Use 64-bit Load/Store instructions (RH850 and later),</p>
<p>156</p>
<p>Use 64-bit Toolchain Components, 289</p>
<p>Use divq Instruction for Divide (V850E2R and later), 154</p>
<p>Use Floating-Point in stdio Routines, 136</p>
<p>Use FPU 3.0 instructions (RH850 and later), 155</p>
<p>Use pushsp and popsp instructions, 152</p>
<p>Use recipf.s/recipf.d for 1/x, 154</p>
<p>Use Small Block Malloc, 150</p>
<p>Use Smallest Type Possible for Enum, 28, 214, 684, 692, </p>
<p>763</p>
<p>V850 Tiny Data Area, 110, 138, 152, 805</p>
<p>Virtual Function Definition, 225</p>
<p>Virtual Function Table Offset Size, 226</p>
<p>Wait for Debug Translation Before Exiting, 301</p>
<p>Warn for all floating point types, 273</p>
<p>Warn for types double or long double, 273</p>
<p>Warnings, 253, 704</p>
<p>WChar Size, 309</p>
<p>When Rejecting Duplicate Symbols in An Archive,</p>
<p>Certain Symbols Generated by the C++ Front End</p>
<p>in COMMON Sections Are Ignored, 317</p>
<p>When Rejecting Duplicate Symbols in An Archive,</p>
<p>Symbols in .ghs.linkonce Sections Are Ignored, 317</p>
<p>When Rejecting Duplicate Symbols, Allow Certain</p>
<p>Symbols Added by the compiler, 242</p>
<p>When Rejecting Duplicate Symbols, Allow Symbols in</p>
<p>.ghs.linkonce sections, 242</p>
<p>Write Version Info To .comment section, 254</p>
<p>X-Switches, 319</p>
<p>Zero Data Area File, 99, 137</p>
<p>building and debugging, different hosts for, 58</p>
<p>built-in functions (see intrinsics)</p>
<p>__builtin_constant_p() intrinsic function, 813</p>
<p>__builtin_return_address() intrinsic function, 810</p>
<p>byte addressable, 884, 889</p>
<p>.byte assembler directive, 414</p>
<p>byte boundary for stack, 35</p>
<p><i>1031</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Builder options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>byte order (see endianness)</p>
<p>__bytereversed keyword, 686</p>
<p><b>C</b></p>
<p>C (see C language)</p>
<p>implementation-defined features</p>
<p>abort(), 714</p>
<p>arrays, 708</p>
<p>assert(), 712</p>
<p>bit-fields, 709</p>
<p>calloc(), 714</p>
<p>character set, execution, 717</p>
<p>characters, 705</p>
<p>environment, 704</p>
<p>errno(), 716</p>
<p>exit(), 714</p>
<p>files, 714</p>
<p>floating-point, 707</p>
<p>getenv(), 704</p>
<p>identifiers, 705</p>
<p>#include directive, 711</p>
<p>integers, 706</p>
<p>isalnum(), 715</p>
<p>isalpha(), 715</p>
<p>iscntrl(), 715</p>
<p>islower(), 715</p>
<p>isprint(), 715</p>
<p>isupper(), 715</p>
<p>locale, 716</p>
<p>malloc(), 714</p>
<p>NULL, 712</p>
<p>overview, 702</p>
<p>pointers, 708</p>
<p>registers, 709</p>
<p>signals, 704</p>
<p>sterror(), 716</p>
<p>streams, 714</p>
<p>strftime(), 717</p>
<p>structures, 709</p>
<p>tmpfile(), 714</p>
<p>translation, 703</p>
<p>underflow detection, 712</p>
<p>unions, 709</p>
<p>volatile accesses, 711</p>
<p>undefined behavior</p>
<p>expressions, 703</p>
<p>-c driver option, 10, 12</p>
<p>-C driver option, 246, 306</p>
<p>.c file extension, 8, 971</p>
<p>.C file extension, 8, 971</p>
<p>-c HTML compiler option, 320</p>
<p>-C HTML compiler options, 320</p>
<p>C Include Directories Builder option, 307</p>
<p>C Japanese Automotive Extensions Builder option, 185, 684, </p>
<p>685</p>
<p>C language</p>
<p>allocation of fields, 27</p>
<p>and memory-mapped I/O, 125</p>
<p>ANSI dialect, 663, 689 (see ANSI C)</p>
<p>asm statements, 695</p>
<p>__bigendian keyword, 687</p>
<p>bitfields, 688, 689, 690</p>
<p>building an executable, 6</p>
<p>__bytereversed keyword, 686</p>
<p>compiler driver, 5</p>
<p>compiler limitations, 701</p>
<p>const keyword, 688</p>
<p>enum data type, 692</p>
<p>extended characters, 697</p>
<p>GNU dialect, 670, 673</p>
<p>Green Hills implementation of, 662</p>
<p>ISO C99 compliance, 677</p>
<p>Japanese Automotive C, 684</p>
<p>K &amp; R dialect, 679, 680</p>
<p>Kernighan &amp; Ritchie conformance, 184</p>
<p>__littleendian keyword, 687</p>
<p>MISRA C, 684</p>
<p>MISRA C 1998, 204, 768</p>
<p>MISRA C 2004, 771</p>
<p>__packed keyword, 687</p>
<p>preprocessing, 697</p>
<p>reentrant functions in run-time libraries, 826</p>
<p>run-time libraries, 818</p>
<p>sequence related undefined behavior checking, 685</p>
<p>specifying a dialect of, 662</p>
<p>standard libraries, 818</p>
<p>&lt;stdarg.h&gt;, 694</p>
<p>Strict ANSI dialect, 669</p>
<p>struct data type, 688</p>
<p>type qualifiers, 686</p>
<p>union data type, 688</p>
<p>&lt;varargs.h&gt;, 693</p>
<p>variable arguments, 692</p>
<p>volatile keyword, 687</p>
<p>C Language Dialect Builder option, 184, 662, 663, 669, 670, </p>
<p>677, 679, 684, 685, 687, 689, 697</p>
<p>C++ (see C++ language)</p>
<p>C++ Exception Handling Builder option, 186, 735, 736</p>
<p>C++ Inlining Level Builder option, 308</p>
<p>C++ language</p>
<p>alignment and size limitations, 886</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1032</i></p>
<p><i>byte order</i></p>
<h1 style="page-break-before:always; "></h1>
<p>allocation of fields, 27</p>
<p>ARM compliant, 742</p>
<p>building an executable, 6</p>
<p>C main(), with, 879</p>
<p>compiler driver, 5</p>
<p>data types, 885</p>
<p>decode utility, 760</p>
<p>Embedded dialect, 739</p>
<p>Extended Embedded dialect, 741</p>
<p>extensions, 737</p>
<p>GNU dialect, 743</p>
<p>implementation-defined features, 761</p>
<p>in C programs, 881</p>
<p>inlining, 335</p>
<p>International Standard, 736</p>
<p>linkage, 758</p>
<p>namespaces, 756</p>
<p>post processing, 759</p>
<p>predefined macros for, 783</p>
<p>required macro names, 780</p>
<p>specifying a dialect of, 734</p>
<p>Standard, 736</p>
<p>(see also Standard C++)</p>
<p>standard libraries, 818</p>
<p>templates, 227, 228, 229, 230, 746, 747, 748, 750, 751, </p>
<p>753</p>
<p>C++ Language Dialect Builder option, 185, 186, 734, 735, </p>
<p>736, 739, 741, 742, 743</p>
<p>C++ Libraries Builder option, 186, 735</p>
<p>C++ library, specifying, 735</p>
<p>C++ Linking Method Builder option, 312</p>
<p>C++ Programming Language, The, 738</p>
<p>C++ Standard Include Directories Builder option, 307</p>
<p>--c_and_cpp_functions_are_distinct driver option, 312</p>
<p>-c_include_directory driver option, 307</p>
<p>__c_plusplus, 783</p>
<p>C/C++ minimum/maximum optimization, 359</p>
<p>C/C++ Minimum/Maximum Optimization Builder option,</p>
<p>294, 359</p>
<p>-C99 driver option, 184, 662</p>
<p>-c99 driver option, 184, 662</p>
<p>call graph profiling</p>
<p>debugging information, 67</p>
<p>calling conventions, xxx, 35</p>
<p>for multiple TDA optimization, 112</p>
<p>calloc(), C implementation, 714</p>
<p>-callt driver option, 151</p>
<p>__CAXI() intrinsic, 811</p>
<p>.cc file extension, 8, 971</p>
<p>ccrh850, 5</p>
<p>ccv850, 5</p>
<p>cerr, 880</p>
<p>Change Assembler Builder option, 319</p>
<p>char data type</p>
<p>signedness, 213, 787, 793</p>
<p>size, 786</p>
<p>variable arguments, 692</p>
<p>__CHAR_BIT, 786</p>
<p>__Char_Is_Signed__, 787, 793</p>
<p>__Char_Is_Unsigned__, 787, 793</p>
<p>__CHAR_UNSIGNED__, 787</p>
<p>character constants, 399</p>
<p>character set dependencies, 889</p>
<p>-check driver option, 180, 181</p>
<p>Check for Stack Smashing Attacks Builder option, 143</p>
<p>Check incompatible RH850 ABI flags (RH850 only) Builder</p>
<p>option, 158</p>
<p>-check_rh850_abi_flags driver option, 158</p>
<p>-check=all driver option, 179</p>
<p>-check=alloc driver option, 72, 180</p>
<p>-check=assignbound driver option, 179</p>
<p>-check=bounds driver option, 179</p>
<p>-check=memory driver option, 72, 180</p>
<p>-check=nilderef driver option, 180</p>
<p>-check=nomemory driver option, 181</p>
<p>-check=none driver option, 179</p>
<p>-check=switch driver option, 180</p>
<p>-check=watch driver option, 180</p>
<p>-check=zerodivide driver option, 180</p>
<p>Checksum Builder option, 126, 251</p>
<p>-checksum driver option, 251</p>
<p>cin, 880</p>
<p>classes, 887</p>
<p>anonymous, 737</p>
<p>portability, 887</p>
<p>template, 746</p>
<p>CLEAR</p>
<p>linker section attribute, 491</p>
<p>clr1 instruction, macro expansion for, 449</p>
<p>cmov instructions, macro expansions for, 456</p>
<p>cmp instruction, macro expansion for, 451</p>
<p>Code Factoring Builder option, 243, 509</p>
<p>code factoring optimization</p>
<p>controlling the scope of, 509</p>
<p>incremental linking, 510</p>
<p>invoking, 509</p>
<p>overview, 509</p>
<p>partial, 510</p>
<p>-codefactor driver option, 244, 509</p>
<p>Coding Standard Profile Builder option, 255, 768, 775</p>
<p>coding standard profiles</p>
<p>creating, 776</p>
<p><i>1033</i></p>
<p><i>Green Hills Software</i></p>
<p><i>C++ language (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>introduction, 774</p>
<p>specifying, 775</p>
<p>syntax, 776</p>
<p>--coding_standard driver option, 255</p>
<p>__COFF__, 791</p>
<p>collating sequence, 890</p>
<p>.comm assembler directive, 424</p>
<p>COMMAND context sensitive variable, customization file,</p>
<p>998</p>
<p>command line</p>
<p>for assembler, 396</p>
<p>for gdump utility, 409</p>
<p>command line function calls, 62</p>
<p>command line options, gpatch, 586</p>
<p>command line utilities (see utility programs)</p>
<p>command=command_name .gpj conditional control</p>
<p>statement, 966</p>
<p>commands</p>
<p>sourceroot, 58</p>
<p>Commands to Execute After Associated Command (via</p>
<p>Shell) Builder option, 284</p>
<p>Commands to Execute After Associated Command Builder</p>
<p>option, 283</p>
<p>Commands to Execute Before Associated Command (via</p>
<p>Shell) Builder option, 281</p>
<p>Commands to Execute Before Associated Command Builder</p>
<p>option, 280</p>
<p>comment .gpj conditional control statement, 966</p>
<p>comments, in assembler source, 401</p>
<p>Common Subexpression Elimination Builder option, 293, </p>
<p>356</p>
<p>common subexpression elimination optimization, 356</p>
<p>--commons driver option, 217</p>
<p>compiler driver, 4</p>
<p>(see also driver options)</p>
<p>building a C executable with, 6</p>
<p>building a C++ executable with, 6</p>
<p>controlling the assembler with, 79</p>
<p>controlling the linker with, 80</p>
<p>creating libraries with, 11</p>
<p>file extensions recognized by, 7</p>
<p>for C source files, 5</p>
<p>for C++ source files, 5</p>
<p>generating assembly files with, 10</p>
<p>generating debugging information with, 55</p>
<p>generating object files with, 10</p>
<p>input file types, 7</p>
<p>introduction to, xxx</p>
<p>linker directives files, passing to, 9</p>
<p>optimization (see optimizations)</p>
<p>optimizing your code with, 165</p>
<p>output file types, 10</p>
<p>passing multiple files to, 8</p>
<p>renaming output of, 122</p>
<p>running assembler with, 394</p>
<p>setting optimization options for, 165</p>
<p>specifying a target for, 52</p>
<p>syntax, 5</p>
<p>updating libraries with, 11</p>
<p>using a driver options file with, 15</p>
<p>using files with, 5</p>
<p>using options with, 5</p>
<p>compiler drivers</p>
<p>ccv850, 5</p>
<p>cxv850, 5</p>
<p>.con file extension, 971</p>
<p>conditional assembly directives, 413</p>
<p>conditional control statements</p>
<p>optgroup=option_group, 968</p>
<p>conditional control statements, for .gpj files, 965, 966, 968</p>
<p>config .gpj conditional control statement, 966</p>
<p>configurations, project build, 962</p>
<p>Consistent code without debug information Builder option,</p>
<p>298</p>
<p>-consistentcode driver option, 298</p>
<p>const GNU attribute, 720</p>
<p>const keyword, 680, 688</p>
<p>constant data in ROM, 498</p>
<p>constant folding optimization, 364</p>
<p>Constant Propagation Builder option, 293, 358</p>
<p>constant propagation optimization, 358</p>
<p>constant returns, propagation of</p>
<p>interprocedural optimizations, 339</p>
<p>constants, in assembler, 398</p>
<p>constructors, 759, 879, 882</p>
<p>continuation lines, in assembler, 401</p>
<p>conventions</p>
<p>typographical, xxvii</p>
<p>Convert C Memset to Memclr Builder option, 291</p>
<p>Convert DWARF Files to MULTI (.dbo) Format Builder</p>
<p>option, 305</p>
<p>Convert Stabs Files to MULTI (.dbo) Format Builder option,</p>
<p>305</p>
<p>converting debugging information (see translating, debugging</p>
<p>information)</p>
<p>copyright banner, generating, 254</p>
<p>__COUNTER__, 793</p>
<p>cout, 880</p>
<p>-coverage=count driver option, 177</p>
<p>-coverage=count64 driver option, 177</p>
<p>-coverage=flag driver option, 177</p>
<p>-coverage=none driver option, 177</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1034</i></p>
<p><i>coding standard profiles (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__cplusplus, 781</p>
<p>.cpp file extension, 8, 971</p>
<p>-cpu assembler option, 396, 397</p>
<p>-cpu driver option, 53</p>
<p>-cpu option, 33</p>
<p>for -registermode=32, 33</p>
<p>-cpu=cpu driver option, 52, 270</p>
<p>CRC, 126, 251, 537</p>
<p>Create S-Record File Image Builder option, 159</p>
<p>CROM linker section attribute, 492, 495</p>
<p>cross compilers, xxx</p>
<p>Cross-Reference Information Builder option, 303</p>
<p>crt0.800, 865</p>
<p>crt0.o startup module, 499, 865</p>
<p>customization files (.bod), 984</p>
<p>CommandOptions</p>
<p>definitions, 988</p>
<p>syntax, 1000</p>
<p>Commands</p>
<p>definitions, 987</p>
<p>syntax, 1000</p>
<p>components, 984</p>
<p>context sensitive variables</p>
<p>COMMAND, 998</p>
<p>DISKFILE, 998</p>
<p>EDITOR, 998</p>
<p>FILENAME, 998</p>
<p>FILENAMEBASE, 998</p>
<p>FILENAMELIBBASE, 998</p>
<p>FILETYPEOPTIONS, 998</p>
<p>INPUTDIR, 998</p>
<p>INPUTFILE, 998</p>
<p>ITEMID, 998</p>
<p>KEEPOBJECTS, 998</p>
<p>MAKE_DEPEND_OPTIONS, 999</p>
<p>OBJECTBASE, 999</p>
<p>OBJECTS, 999</p>
<p>OBJECTSUFFIX, 999</p>
<p>OPTIONS, 999</p>
<p>OUTPUTDIR, 999</p>
<p>OUTPUTFILE, 999</p>
<p>OUTPUTNAMEBASE, 999</p>
<p>PARENTID, 999</p>
<p>RUNDIR, 999</p>
<p>SECOND_PASS_OPTION, 999</p>
<p>SIBLINGS, 999</p>
<p>SIBLINGS[type], 1000</p>
<p>syntax, 997</p>
<p>TOPPROJECT, 999</p>
<p>examples, 989</p>
<p>FileTypes</p>
<p>definitions, 985</p>
<p>syntax, 995</p>
<p>including additional, 1003</p>
<p>predefined macro syntax, 1003</p>
<p>preprocessor directives</p>
<p>%define, 1002</p>
<p>%echo, 1002</p>
<p>%elif, 1002</p>
<p>%else, 1002</p>
<p>%elseif, 1002</p>
<p>%elsif, 1002</p>
<p>%endif, 1002</p>
<p>%error, 1002</p>
<p>%if, 1002</p>
<p>%ifdef, 1002</p>
<p>%include, 1002</p>
<p>%info, 1002</p>
<p>syntax, 1002</p>
<p>%warning, 1002</p>
<p>preprocessor function syntax, 1002</p>
<p>customization Top Project directive, 965</p>
<p>customizing</p>
<p>run-time environment, 121</p>
<p>cxrh850, 5</p>
<p>cxv850, 5</p>
<p>.cxx file extension, 8, 971</p>
<p><b>D</b></p>
<p>-D driver option, 182</p>
<p>-d librarian command, 518</p>
<p>.d output file type, 13, 23</p>
<p>.data assembler directive, 421</p>
<p>Data Bus Width Builder option, 131</p>
<p>data initialization assembler directives, 414</p>
<p>.data program section, 82, 925</p>
<p>data structures</p>
<p>thread-specific library, 829</p>
<p>data types</p>
<p>size, 885</p>
<p>void, 680</p>
<p>-data_bus_width=24 driver option, 131</p>
<p>-data_bus_width=26 driver option, 131</p>
<p>-data_bus_width=29 driver option, 131</p>
<p>-data_bus_width=32 driver option, 131</p>
<p>__DATE__, 680, 781</p>
<p>.dba output file type, 13</p>
<p>-dbg_source_root driver option, 161</p>
<p>Dbo File Version Builder option, 319</p>
<p>.dbo output file type, 13</p>
<p>-dbo_trace driver option, 319</p>
<p><i>1035</i></p>
<p><i>Green Hills Software</i></p>
<p><i>__cplusplus</i></p>
<h1 style="page-break-before:always; "></h1>
<p>--dbo_version driver option, 319</p>
<p>-dbopath driver option, 299</p>
<p>dead code elimination optimization, 360</p>
<p>Debug Information (.dbo) Tracing Diagnostics Builder</p>
<p>option, 319</p>
<p>Debug Translator</p>
<p>remapping host paths, 58</p>
<p>source scanning feature, 59</p>
<p>translating debugging information, 57, 58</p>
<p>debugger</p>
<p>displaying memory-mapped I/O, 125</p>
<p>PIC and, 118</p>
<p>PID and, 120</p>
<p>debugging</p>
<p>GNU-compiled applications, 57, 61</p>
<p>host, different than building host, 58</p>
<p>memory allocation errors, 71</p>
<p>programs compiled with third-party tools, 57, 58, 59, 61</p>
<p>limitations, 60</p>
<p>source level, 894</p>
<p>symbolic, 426</p>
<p>debugging information</p>
<p>call graph profiling, 67</p>
<p>controlling level of, 304</p>
<p>files containing, 56</p>
<p>generated by third-party tools, 57, 58, 61</p>
<p>limitations to, 60</p>
<p>generating, 55</p>
<p>generating DWARF, 304</p>
<p>maintaining, 55</p>
<p>obtaining profiling, 63</p>
<p>target-based timing profiling, 69</p>
<p>Debugging Information Builder option, 304</p>
<p>Debugging Level</p>
<p>MULTI, 62</p>
<p>Debugging Level Builder option, 55, 57, 176, 290, 305, 808</p>
<p>decode utility, 760</p>
<p>defaultBuildOptions Top Project directive, 961</p>
<p>DEFAULTS linker directive, 477</p>
<p>--defer_parse_function_templates driver option, 231</p>
<p>Deferral of Function Template Parsing Builder option, 231</p>
<p>Define Linker Constant Builder option, 246</p>
<p>%define preprocessor directive, customization file, 1002</p>
<p>Define Preprocessor Symbol Builder option, 182</p>
<p>defineConfig Top Project directive, 962</p>
<p>#defined(id), 680</p>
<p>Definition of Standard Symbols Builder option, 306</p>
<p>Definition of Unsafe Symbols Builder option, 306, 780</p>
<p>delete</p>
<p>array, predefined macro, 792</p>
<p>-delete driver option, 243</p>
<p>deleting</p>
<p>unused functions, 507</p>
<p>Deletion of Unused Functions Builder option, 80, 243</p>
<p>demangler, 760</p>
<p>Demangling of Names in Linker Messages Builder option,</p>
<p>311</p>
<p>.dep output file type, 13, 23</p>
<p>--dep_name driver option, 230, 736, 753, 756</p>
<p>dependencies on other Top Projects, 963</p>
<p>Dependencies Relative to Source Directory Builder option,</p>
<p>278</p>
<p>Dependencies Relative to This File Builder option, 278</p>
<p>Dependencies Relative to Top-Level Project Builder option,</p>
<p>279</p>
<p>dependency information, generating, 22</p>
<p>Dependent Name Processing Builder option, 229, 230, 736, </p>
<p>753, 756</p>
<p>:depends Builder option, 278</p>
<p>:dependsNonRelative Builder option, 279</p>
<p>:dependsRelative Builder option, 278</p>
<p>deprecated GNU attribute, 720</p>
<p>derefed DoubleCheck property type, 371</p>
<p>destructors, 759, 879, 882</p>
<p>__DI() intrinsic function, 811</p>
<p>--diag_error driver option, 260</p>
<p>--diag_remark driver option, 260</p>
<p>--diag_suppress driver option, 260</p>
<p>--diag_warning driver option, 260</p>
<p>__DIR() intrinsic function, 811</p>
<p>-directive_dir driver option, 313</p>
<p>directories</p>
<p>library, 819</p>
<p>--disable_ctors_dtors driver option, 224</p>
<p>--disable_noinline driver option, 222, 336</p>
<p>-discard_zero_initializers driver option, 142</p>
<p>DISKFILE context sensitive variable, customization file,</p>
<p>998</p>
<p>Display End-of-Function Symbols in Map File Builder</p>
<p>option, 250</p>
<p>Display Error Message Numbers Builder option, 260, 261, </p>
<p>803</p>
<p>Display Error Message Paths Builder option, 256</p>
<p>Display includes Preprocessor Directives Listing Builder</p>
<p>option, 182</p>
<p>Display Local Symbols in Map File Builder option, 250</p>
<p>Display Unused Functions in Map File Builder option, 249</p>
<p>Display Version Information Builder option, 254</p>
<p>--display_error_number driver option, 261, 803</p>
<p>-display_toc librarian option, 521</p>
<p>Distinct C and C++ Functions Builder option, 312, 736, 737</p>
<p>division</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1036</i></p>
<p><i>--dbo_version driver option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>operators, 892</p>
<p>-divq driver option, 154</p>
<p>.dla output file type, 13</p>
<p>.dlo output file type, 13</p>
<p>.dnm output file type, 13</p>
<p>Do not allow types double or long double Builder option,</p>
<p>273</p>
<p>-do_not_wait_for_dblink driver option, 301</p>
<p>document set, xxvi</p>
<p>-dotciscxx driver option, 8</p>
<p>.double assembler directive, 414</p>
<p>double floating-point</p>
<p>in registers, 33</p>
<p>double floating-point values</p>
<p>in registers, 33</p>
<p>-double_check.config= driver option, 264</p>
<p>-double_check.ignore= driver option, 264</p>
<p>-double_check.level=high driver option, 263, 367</p>
<p>-double_check.level=low driver option, 263, 367</p>
<p>-double_check.level=medium driver option, 263, 367</p>
<p>-double_check.level=none driver option, 263, 367</p>
<p>-double_check.report= driver option, 263, 373</p>
<p>-double_check.stop_build=errors driver option, 264, 375</p>
<p>-double_check.stop_build=off driver option, 264, 375</p>
<p>-double_check.stop_build=warnings driver option, 264, 375</p>
<p>__DOUBLE_HL, 787</p>
<p>DoubleCheck</p>
<p>controlling output, 374</p>
<p>custom functions, using, 368</p>
<p>error and warning messages, 375, 377</p>
<p>function properties, specifying</p>
<p>with #pragma directives, 370</p>
<p>with configuration files, 369</p>
<p>overview, 366</p>
<p>property types</p>
<p>derefed, 371</p>
<p>frees, 371</p>
<p>malloc_size, 371</p>
<p>malloced, 371</p>
<p>needs_null_check, 370</p>
<p>no_return, 372</p>
<p>no_return_when_non_zero, 372</p>
<p>no_return_when_zero, 372</p>
<p>uninit, 373</p>
<p>unsaved, 372</p>
<p>specifying report files, 368</p>
<p>using, 367</p>
<p>viewing reports, 373</p>
<p>DoubleCheck Config File Builder option, 264</p>
<p>DoubleCheck Errors to Ignore Builder option, 264</p>
<p>DoubleCheck Level Builder option, 263</p>
<p>DoubleCheck Output that Stops Builds Builder option, 264</p>
<p>DoubleCheck Report File Builder option, 263</p>
<p>doubles</p>
<p>in registers, 33</p>
<p>-# driver option, 15</p>
<p>driver options</p>
<p>-#, 15</p>
<p>-64bit_load_store, 157</p>
<p>@filename, 15</p>
<p>-A, 247</p>
<p>-a, 302</p>
<p>-act_like=2012.1, 160</p>
<p>-act_like=2012.5, 161</p>
<p>-act_like=2013.1, 161</p>
<p>-act_like=2013.5, 161</p>
<p>-act_like=2014.1, 161</p>
<p>-act_like=2015.1, 161</p>
<p>-act_like=5.0, 160</p>
<p>-act_like=5.2, 160</p>
<p>-act_like=latest, 161</p>
<p>-additional_sda_common, 271</p>
<p>-additional_sda_reg, 106, 270</p>
<p>-alloc_shared_mem, 267</p>
<p>-allocate_ep, 152</p>
<p>-allow_1bit_volatile_any_basetype, 153</p>
<p>-allow_cxx_duplicates, 317</p>
<p>--allow_different_section_types, 315</p>
<p>-allow_linkonce_duplicates, 317</p>
<p>-allow_overlap, 266</p>
<p>--alternative_tokens, 218</p>
<p>-ANSI, 184, 662, 669, 685</p>
<p>-ansi, 184, 662, 663, 684</p>
<p>-ansi_alias, 187</p>
<p>--any_output_suffix, 277</p>
<p>-archive, 11, 12, 516</p>
<p>--arm, 185, 742</p>
<p>-asm, 233, 394</p>
<p>-asm_diag_error, 261</p>
<p>-asm_diag_suppress, 261</p>
<p>-asm_diag_warning, 261</p>
<p>--asm_errors, 257, 696</p>
<p>--asm_silent, 257, 684, 696</p>
<p>--asm_warnings, 257, 696</p>
<p>-asm3g, 234</p>
<p>-asmcmd, 234, 394</p>
<p>--assembler_warnings, 313</p>
<p>-auto_large_archive, 316</p>
<p>--auto_type, 223</p>
<p>:autoInclude, 287</p>
<p>-autoregister, 293</p>
<p>-bigswitch, 272</p>
<p><i>1037</i></p>
<p><i>Green Hills Software</i></p>
<p><i>division (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>--bool, 221, 792</p>
<p>--brief_diagnostics, 256</p>
<p>-bsp, 52</p>
<p>-c, 10, 12</p>
<p>-C, 246, 306</p>
<p>--c_and_cpp_functions_are_distinct, 312</p>
<p>-c_include_directory, 307</p>
<p>-C99, 184, 662</p>
<p>-c99, 184, 662</p>
<p>-callt, 151</p>
<p>-check, 180, 181</p>
<p>-check_rh850_abi_flags, 158</p>
<p>-check=all, 179</p>
<p>-check=alloc, 72, 180</p>
<p>-check=assignbound, 179</p>
<p>-check=bounds, 179</p>
<p>-check=memory, 72, 180</p>
<p>-check=nilderef, 180</p>
<p>-check=nomemory, 181</p>
<p>-check=none, 179</p>
<p>-check=switch, 180</p>
<p>-check=watch, 180</p>
<p>-check=zerodivide, 180</p>
<p>-checksum, 251</p>
<p>-codefactor, 244, 509</p>
<p>--coding_standard, 255</p>
<p>--commons, 217</p>
<p>-consistentcode, 298</p>
<p>-coverage=count, 177</p>
<p>-coverage=count64, 177</p>
<p>-coverage=flag, 177</p>
<p>-coverage=none, 177</p>
<p>-cpu, 53</p>
<p>-cpu=cpu, 52, 270</p>
<p>-D, 182</p>
<p>-data_bus_width=24, 131</p>
<p>-data_bus_width=26, 131</p>
<p>-data_bus_width=29, 131</p>
<p>-data_bus_width=32, 131</p>
<p>-dbg_source_root, 161</p>
<p>-dbo_trace, 319</p>
<p>--dbo_version, 319</p>
<p>-dbopath, 299</p>
<p>--defer_parse_function_templates, 231</p>
<p>-delete, 243</p>
<p>--dep_name, 230, 736, 753, 756</p>
<p>--diag_error, 260</p>
<p>--diag_remark, 260</p>
<p>--diag_suppress, 260</p>
<p>--diag_warning, 260</p>
<p>-directive_dir, 313</p>
<p>--disable_ctors_dtors, 224</p>
<p>--disable_noinline, 222, 336</p>
<p>-discard_zero_initializers, 142</p>
<p>--display_error_number, 261, 803</p>
<p>-divq, 154</p>
<p>-do_not_wait_for_dblink, 301</p>
<p>-dotciscxx, 8</p>
<p>-double_check.config=, 264</p>
<p>-double_check.ignore=, 264</p>
<p>-double_check.level=high, 263, 367</p>
<p>-double_check.level=low, 263, 367</p>
<p>-double_check.level=medium, 263, 367</p>
<p>-double_check.level=none, 263, 367</p>
<p>-double_check.report=, 263, 373</p>
<p>-double_check.stop_build=errors, 264, 375</p>
<p>-double_check.stop_build=off, 264, 375</p>
<p>-double_check.stop_build=warnings, 264, 375</p>
<p>-dual_debug|-dwarf2, 304</p>
<p>-duplicate_whitelist, 243</p>
<p>-dwarf_to_dbo, 305</p>
<p>--e, 185, 739, 784</p>
<p>-E, 12, 697</p>
<p>--ee, 185, 741</p>
<p>--eel, 186, 784, 820</p>
<p>--eele, 186, 784, 820</p>
<p>--el, 186, 784, 821</p>
<p>--ele, 186, 784, 821</p>
<p>-elxr_diag_error, 262</p>
<p>-elxr_diag_suppress, 262</p>
<p>-elxr_diag_warning, 262</p>
<p>--enable_ctors_dtors, 223</p>
<p>-enable_eagle_log, 177</p>
<p>--enable_noinline, 222, 336</p>
<p>-endfile, 244</p>
<p>-entry|-e, 237</p>
<p>-errmax, 253</p>
<p>-error_basename, 256</p>
<p>-event_logging, 159</p>
<p>--exceptions, 186, 736</p>
<p>--export, 230, 736, 753</p>
<p>-exportall, 247</p>
<p>-extend_liveness, 299</p>
<p>-external, 170</p>
<p>-external_file, 170</p>
<p>-extra_file=filename, 301</p>
<p>-extractall, 246</p>
<p>-farcallpatch, 142</p>
<p>-farcalls, 94, 141</p>
<p>--fast, 175</p>
<p>-fast_malloc, 150</p>
<p>-ffunctions, 134</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1038</i></p>
<p><i>driver options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-fgnu89-inline, 309</p>
<p>-fhard, 132</p>
<p>-filetype.suffix, 8</p>
<p>-float_associativity, 134</p>
<p>-float_scanf, 313</p>
<p>-floatio, 136</p>
<p>-floatsingle, 133</p>
<p>-fNaN_cmp_unordered, 134</p>
<p>-fno-gnu89-inline, 309</p>
<p>-fno_NaN_cmp_unordered, 134</p>
<p>-fnodouble, 273</p>
<p>-fnofunctions, 135</p>
<p>-fnone, 132</p>
<p>-fnonodouble, 273</p>
<p>-follow_section, 315</p>
<p>--force_vtbl, 226</p>
<p>-fpu=fpu20, 155</p>
<p>-fpu=fpu30, 155</p>
<p>-fsingle, 133</p>
<p>-fsoft, 133</p>
<p>-full_breakdots, 298</p>
<p>-full_debug_info, 304</p>
<p>-G, 55, 57, 62, 176, 822</p>
<p>-g, 176</p>
<p>--g++, 185, 743</p>
<p>-ga, 300</p>
<p>-gcc, 184, 662, 670</p>
<p>-gen_entry_exit_arg_history, 296</p>
<p>-gen_entry_exit_history, 296</p>
<p>-ghsmc_core_count, 303</p>
<p>-ghsmc_file, 302</p>
<p>--ghstd=2010, 255</p>
<p>--ghstd=last, 255</p>
<p>--ghstd=none, 255</p>
<p>-glimits, 298</p>
<p>-globalcheck_qualifiers, 252</p>
<p>-globalcheck=full, 251</p>
<p>-globalcheck=none, 252</p>
<p>-globalcheck=normal, 252</p>
<p>-globalreg, 92, 106, 142, 790</p>
<p>--gnu_asm, 310</p>
<p>--gnu_version=30300, 309</p>
<p>--gnu_version=40300, 309</p>
<p>-gnu99, 184, 662</p>
<p>-gs, 176</p>
<p>-gsize, 250</p>
<p>-gtws, 37, 38, 297</p>
<p>--guiding_decls, 227</p>
<p>-H, 22, 183</p>
<p>-help, 15</p>
<p>-hex, 236</p>
<p>-host64, 289</p>
<p>--hybrid_one_instantiation_per_object, 229</p>
<p>-I, 76, 161</p>
<p>-I-, 77</p>
<p>-ident, 311</p>
<p>-identifier_blacklist_file, 318</p>
<p>-identoutput, 311</p>
<p>-ignore_callt_state_in_interrupts, 40, 151</p>
<p>-ignore_debug_references, 244</p>
<p>--implicit_extern_c_type_conversion, 312</p>
<p>--implicit_include, 228, 752</p>
<p>--implicit_typename, 228</p>
<p>-include, 305</p>
<p>--incorrect_pragma_errors, 258, 795</p>
<p>--incorrect_pragma_silent, 258, 795</p>
<p>--incorrect_pragma_warnings, 258</p>
<p>-individual_attribute_data_sections, 147</p>
<p>-individual_attribute_function_sections, 149</p>
<p>-individual_data_sections, 146</p>
<p>-individual_function_sections, 148</p>
<p>-individual_pragma_data_sections, 147</p>
<p>-individual_pragma_function_sections, 149</p>
<p>-init_ram_at_startup, 271</p>
<p>-inline_prologue, 272</p>
<p>--inline_tiny_functions, 290</p>
<p>--inlining, 308</p>
<p>--inlining_unless_debug, 308</p>
<p>--instantiate_extern_inline, 222</p>
<p>--instantiation_dir, 229</p>
<p>-japanese_automotive_c, 185, 684, 685</p>
<p>-k+r, 184, 662, 679</p>
<p>-kanji, 220</p>
<p>--keep_static_symbols, 218</p>
<p>-keepasmfiles, 276</p>
<p>-keepcppfiles, 276</p>
<p>-keepmap, 248</p>
<p>-keeptempfiles, 275</p>
<p>-L, 79, 162</p>
<p>-l, 79, 162</p>
<p>-language, 8, 276, 820</p>
<p>-large_archive, 316</p>
<p>-large_sda, 138</p>
<p>--large_vtbl_offsets, 226</p>
<p>-large_zda, 139</p>
<p>-link_allow_duplicate_ghs_syms, 242</p>
<p>-link_allow_duplicate_linkonce_syms, 242</p>
<p>--link_filter, 311</p>
<p>--link_once_templates, 227, 749</p>
<p>--link_output_mode_linksafe, 315</p>
<p>--link_output_mode_reuse, 314</p>
<p>--link_output_mode_safe, 315</p>
<p><i>1039</i></p>
<p><i>Green Hills Software</i></p>
<p><i>driver options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>--link_output_mode_unlink, 315</p>
<p>-link_reject_duplicate_lib_syms, 242</p>
<p>--linker_link, 312</p>
<p>-linker_warnings, 237</p>
<p>-list, 79, 232</p>
<p>-list_dir, 232</p>
<p>-lmulti, 62</p>
<p>-lnk, 240</p>
<p>-lnk0, 239</p>
<p>-lnkcmd, 241</p>
<p>-locals_unchanged_by_longjmp, 310</p>
<p>-locatedprogram, 235</p>
<p>--long_long, 214</p>
<p>-Ma, 249</p>
<p>-Man|-Mna, 249</p>
<p>-map, 248</p>
<p>-map_eofn_symbols, 250</p>
<p>-maplines, 248</p>
<p>--max_inlining, 308</p>
<p>--max_inlining_unless_debug, 308</p>
<p>-MD, 23</p>
<p>-memory, 236</p>
<p>-merge_archive, 12, 516</p>
<p>-MF, 23</p>
<p>-minlib, 314</p>
<p>-misalign_pack, 216</p>
<p>--misra_2004=1.1, 187</p>
<p>--misra_2004=1.2, 188</p>
<p>--misra_2004=1.3, 188</p>
<p>--misra_2004=1.4, 188</p>
<p>--misra_2004=1.5, 188</p>
<p>--misra_2004=10.1, 193</p>
<p>--misra_2004=10.2, 193</p>
<p>--misra_2004=10.3, 193</p>
<p>--misra_2004=10.4, 193</p>
<p>--misra_2004=10.5, 193</p>
<p>--misra_2004=10.6, 193</p>
<p>--misra_2004=11.1, 193</p>
<p>--misra_2004=11.2, 194</p>
<p>--misra_2004=11.3, 194</p>
<p>--misra_2004=11.4, 194</p>
<p>--misra_2004=11.5, 194</p>
<p>--misra_2004=12.1, 194</p>
<p>--misra_2004=12.10, 195</p>
<p>--misra_2004=12.11, 195</p>
<p>--misra_2004=12.12, 195</p>
<p>--misra_2004=12.13, 195</p>
<p>--misra_2004=12.2, 194</p>
<p>--misra_2004=12.3, 194</p>
<p>--misra_2004=12.4, 194</p>
<p>--misra_2004=12.5, 194</p>
<p>--misra_2004=12.6, 194</p>
<p>--misra_2004=12.7, 195</p>
<p>--misra_2004=12.8, 195</p>
<p>--misra_2004=12.9, 195</p>
<p>--misra_2004=13.1, 195</p>
<p>--misra_2004=13.2, 196</p>
<p>--misra_2004=13.3, 196</p>
<p>--misra_2004=13.4, 196</p>
<p>--misra_2004=13.5, 196</p>
<p>--misra_2004=13.6, 196</p>
<p>--misra_2004=13.7, 196</p>
<p>--misra_2004=14.1, 196</p>
<p>--misra_2004=14.10, 197</p>
<p>--misra_2004=14.2, 196</p>
<p>--misra_2004=14.3, 196</p>
<p>--misra_2004=14.4, 196</p>
<p>--misra_2004=14.5, 197</p>
<p>--misra_2004=14.6, 197</p>
<p>--misra_2004=14.7, 197</p>
<p>--misra_2004=14.8, 197</p>
<p>--misra_2004=14.9, 197</p>
<p>--misra_2004=15.1, 197</p>
<p>--misra_2004=15.2, 197</p>
<p>--misra_2004=15.3, 197</p>
<p>--misra_2004=15.4, 198</p>
<p>--misra_2004=15.5, 198</p>
<p>--misra_2004=16.1, 198</p>
<p>--misra_2004=16.10, 199</p>
<p>--misra_2004=16.2, 198</p>
<p>--misra_2004=16.3, 198</p>
<p>--misra_2004=16.4, 198</p>
<p>--misra_2004=16.5, 198</p>
<p>--misra_2004=16.6, 198</p>
<p>--misra_2004=16.7, 198</p>
<p>--misra_2004=16.8, 199</p>
<p>--misra_2004=16.9, 199</p>
<p>--misra_2004=17.1, 199</p>
<p>--misra_2004=17.2, 199</p>
<p>--misra_2004=17.3, 199</p>
<p>--misra_2004=17.4, 199</p>
<p>--misra_2004=17.5, 199</p>
<p>--misra_2004=17.6, 199</p>
<p>--misra_2004=18.1, 199</p>
<p>--misra_2004=18.2, 200</p>
<p>--misra_2004=18.3, 200</p>
<p>--misra_2004=18.4, 200</p>
<p>--misra_2004=19.1, 200</p>
<p>--misra_2004=19.10, 201</p>
<p>--misra_2004=19.11, 201</p>
<p>--misra_2004=19.12, 201</p>
<p>--misra_2004=19.13, 201</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1040</i></p>
<p><i>driver options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>--misra_2004=19.14, 201</p>
<p>--misra_2004=19.15, 201</p>
<p>--misra_2004=19.16, 201</p>
<p>--misra_2004=19.17, 202</p>
<p>--misra_2004=19.2, 200</p>
<p>--misra_2004=19.3, 200</p>
<p>--misra_2004=19.4, 200</p>
<p>--misra_2004=19.5, 200</p>
<p>--misra_2004=19.6, 200</p>
<p>--misra_2004=19.7, 200</p>
<p>--misra_2004=19.8, 201</p>
<p>--misra_2004=19.9, 201</p>
<p>--misra_2004=2.1, 188</p>
<p>--misra_2004=2.2, 188</p>
<p>--misra_2004=2.3, 188</p>
<p>--misra_2004=2.4, 188</p>
<p>--misra_2004=20.1, 202</p>
<p>--misra_2004=20.10, 202</p>
<p>--misra_2004=20.11, 203</p>
<p>--misra_2004=20.12, 203</p>
<p>--misra_2004=20.2, 202</p>
<p>--misra_2004=20.3, 202</p>
<p>--misra_2004=20.4, 202</p>
<p>--misra_2004=20.5, 202</p>
<p>--misra_2004=20.6, 202</p>
<p>--misra_2004=20.7, 202</p>
<p>--misra_2004=20.8, 202</p>
<p>--misra_2004=20.9, 202</p>
<p>--misra_2004=21.1, 203</p>
<p>--misra_2004=3.1, 188</p>
<p>--misra_2004=3.2, 189</p>
<p>--misra_2004=3.3, 189</p>
<p>--misra_2004=3.4, 189</p>
<p>--misra_2004=3.5, 189</p>
<p>--misra_2004=3.6, 189</p>
<p>--misra_2004=4.1, 189</p>
<p>--misra_2004=4.2, 189</p>
<p>--misra_2004=5.1, 189</p>
<p>--misra_2004=5.2, 189</p>
<p>--misra_2004=5.3, 190</p>
<p>--misra_2004=5.4, 190</p>
<p>--misra_2004=5.5, 190</p>
<p>--misra_2004=5.6, 190</p>
<p>--misra_2004=5.7, 190</p>
<p>--misra_2004=6.1, 190</p>
<p>--misra_2004=6.2, 190</p>
<p>--misra_2004=6.3, 190</p>
<p>--misra_2004=6.4, 190</p>
<p>--misra_2004=6.5, 191</p>
<p>--misra_2004=7.1, 191</p>
<p>--misra_2004=8.1, 191</p>
<p>--misra_2004=8.10, 192</p>
<p>--misra_2004=8.11, 192</p>
<p>--misra_2004=8.12, 192</p>
<p>--misra_2004=8.2, 191</p>
<p>--misra_2004=8.3, 191</p>
<p>--misra_2004=8.4, 191</p>
<p>--misra_2004=8.5, 191</p>
<p>--misra_2004=8.6, 191</p>
<p>--misra_2004=8.7, 192</p>
<p>--misra_2004=8.8, 192</p>
<p>--misra_2004=8.9, 192</p>
<p>--misra_2004=9.1, 192</p>
<p>--misra_2004=9.2, 192</p>
<p>--misra_2004=9.3, 192</p>
<p>--misra_adv=error, 203</p>
<p>--misra_adv=silent, 203</p>
<p>--misra_adv=warn, 203</p>
<p>--misra_req=error, 203</p>
<p>--misra_req=silent, 203</p>
<p>--misra_req=warn, 203</p>
<p>--misra_runtime, 204</p>
<p>-Ml, 250</p>
<p>-MMD, 23</p>
<p>-Mn, 249</p>
<p>-mtda, 110, 138</p>
<p>-Mu, 249</p>
<p>-multiple, 245</p>
<p>--munch, 312</p>
<p>-mute_eagle_signal, 297</p>
<p>-mute_entry_exit_history, 176</p>
<p>-Mx, 249</p>
<p>--namespaces, 220</p>
<p>-new_assembler, 319</p>
<p>--new_inside_of_constructor, 224</p>
<p>--new_outside_of_constructor, 224</p>
<p>--new_style_casts, 223</p>
<p>-no_64bit_load_store, 157</p>
<p>--no_additional_output, 236</p>
<p>-no_additional_sda_common, 271</p>
<p>-no_alloc_shared_mem, 267</p>
<p>-no_allocate_ep, 152</p>
<p>-no_allow_1bit_volatile_any_basetype, 153</p>
<p>-no_allow_cxx_duplicates, 317</p>
<p>--no_allow_different_section_types, 315</p>
<p>-no_allow_linkonce_duplicates, 317</p>
<p>-no_allow_overlap, 266</p>
<p>--no_alternative_tokens, 218</p>
<p>-no_ansi_alias, 187</p>
<p>--no_any_output_suffix, 277</p>
<p>--no_assembler_warnings, 313</p>
<p>--no_auto_type, 223</p>
<p><i>1041</i></p>
<p><i>Green Hills Software</i></p>
<p><i>driver options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>--no_bool, 221</p>
<p>--no_brief_diagnostics, 256</p>
<p>--no_c_and_cpp_functions_are_distinct, 312</p>
<p>-no_callt, 40, 151</p>
<p>-no_check_rh850_abi_flags, 158</p>
<p>-no_codefactor, 244</p>
<p>--no_comments, 307</p>
<p>--no_commons, 82, 87, 89, 217</p>
<p>--no_coverage_analysis, 302</p>
<p>--no_debug, 176</p>
<p>--no_defer_parse_function_templates, 231</p>
<p>-no_delete, 243</p>
<p>--no_dep_name, 230</p>
<p>-no_discard_zero_initializers, 142</p>
<p>--no_display_error_number, 261</p>
<p>-no_divq, 154</p>
<p>-no_dual_debug, 304</p>
<p>-no_dwarf2dbo, 305</p>
<p>-no_error_basename, 256</p>
<p>-no_event_logging, 159</p>
<p>--no_exceptions, 186</p>
<p>--no_export, 230</p>
<p>-no_extend_liveness, 299</p>
<p>-no_fast_malloc, 150</p>
<p>-no_float_associativity, 134</p>
<p>-no_float_scanf, 313</p>
<p>-no_full_breakdots, 298</p>
<p>-no_full_debug_info, 304</p>
<p>-no_gen_entry_exit_arg_history, 296</p>
<p>-no_gen_entry_exit_history, 296</p>
<p>-no_globalcheck_qualifiers, 252</p>
<p>--no_gnu_asm, 310</p>
<p>-no_gsize, 250</p>
<p>--no_guiding_decls, 227</p>
<p>-no_host64, 289</p>
<p>-no_ignore_callt_state_in_interrupts, 151</p>
<p>-no_ignore_debug_references, 244</p>
<p>--no_implicit_extern_c_type_conversion, 312</p>
<p>--no_implicit_include, 228, 753</p>
<p>--no_implicit_typename, 228</p>
<p>-no_individual_attribute_data_sections, 147</p>
<p>-no_individual_attribute_function_sections, 149</p>
<p>-no_individual_data_sections, 146</p>
<p>-no_individual_function_sections, 148</p>
<p>-no_individual_pragma_data_sections, 147</p>
<p>-no_individual_pragma_function_sections, 149</p>
<p>-no_init_ram_at_startup, 271</p>
<p>-no_inline_prologue, 272</p>
<p>--no_inline_tiny_functions, 290</p>
<p>--no_inlining, 308</p>
<p>--no_instantiate_extern_inline, 223</p>
<p>-no_japanese_automotive_c, 185</p>
<p>--no_keep_static_symbols, 218</p>
<p>-no_large_archive, 316</p>
<p>-no_large_sda, 139</p>
<p>--no_large_vtbl_offsets, 226</p>
<p>-no_large_zda, 139</p>
<p>-no_link_allow_duplicate_ghs_syms, 242</p>
<p>-no_link_allow_duplicate_linkonce_syms, 242</p>
<p>--no_link_filter, 311</p>
<p>--no_link_once_templates, 227, 746</p>
<p>-no_link_reject_duplicate_lib_syms, 242</p>
<p>-no_linker_warnings, 237</p>
<p>-no_list, 232</p>
<p>-no_locals_unchanged_by_longjmp, 310</p>
<p>--no_long_long, 214</p>
<p>-no_map_eofn_symbols, 250</p>
<p>-no_misalign_pack, 216</p>
<p>--no_misra_runtime, 204</p>
<p>-no_multiple, 245</p>
<p>--no_namespaces, 220, 756</p>
<p>--no_new_style_casts, 223</p>
<p>--no_old_specializations, 228</p>
<p>--no_one_instantiation_per_object, 229</p>
<p>--no_parse_templates, 230</p>
<p>-no_precise_signed_zero, 135</p>
<p>-no_precise_signed_zero_compare, 135</p>
<p>-no_prepare_dispose, 152</p>
<p>-no_preprocess_assembly_files, 232</p>
<p>--no_preprocess_linker_directive, 237</p>
<p>-no_preprocess_special_assembly_files, 233</p>
<p>-no_push_pop, 152</p>
<p>--no_quit_after_warnings, 254</p>
<p>--no_range_based_for, 221</p>
<p>--no_readonly_typeinfo, 225</p>
<p>--no_readonly_virtual_tables, 226</p>
<p>-no_recipf, 154</p>
<p>-no_reject_duplicates, 317</p>
<p>--no_remarks, 253</p>
<p>--no_restrict, 222</p>
<p>-no_rh850_1bit, 154</p>
<p>-no_rh850_4bytewordoffset, 156</p>
<p>-no_rh850_eint_erratum, 156</p>
<p>-no_rh850_simd, 155</p>
<p>-no_rh850_trace_loads, 153</p>
<p>-no_rosda, 130</p>
<p>-no_rosda_is_zda, 140</p>
<p>--no_rtti, 225</p>
<p>--no_scan_source, 300</p>
<p>-no_search_for_dba, 300</p>
<p>-no_shared_libs, 267</p>
<p>--no_short_enum, 214, 684</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1042</i></p>
<p><i>driver options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-no_shorten_loads, 139</p>
<p>-no_shorten_moves, 140</p>
<p>--no_slash_comment, 186</p>
<p>-no_smaller_bitops, 153</p>
<p>-no_split_data_sections_by_alignment, 145</p>
<p>-no_stabs2dbo, 305</p>
<p>-no_stack_check, 143</p>
<p>-no_stack_protector, 143</p>
<p>--no_switch_table, 272</p>
<p>-no_timer_profile, 178</p>
<p>--no_trace_includes, 183</p>
<p>-no_undefined, 245</p>
<p>--no_unique_strings, 217</p>
<p>--no_unsafe_predefines, 306</p>
<p>--no_using_std, 220</p>
<p>-no_v800_old_callt, 151</p>
<p>-no_v850_isr_save_eiic, 156</p>
<p>-no_v850_isr_save_r4r5, 155</p>
<p>--no_version, 254</p>
<p>-no_version_info, 254</p>
<p>--no_vla, 218</p>
<p>--no-whole-archive, 241</p>
<p>--no_wrap_diagnostics, 256</p>
<p>-no_zero_commons, 140</p>
<p>-noasm3g, 234</p>
<p>-noautoregister, 293, 363</p>
<p>-nobigswitch, 272</p>
<p>-nochecksum, 251</p>
<p>-noconsistentcode, 298</p>
<p>--nocpp, 312</p>
<p>-noentry, 237</p>
<p>-nofarcallpatch, 94, 142</p>
<p>-nofarcalls, 141</p>
<p>-nofloatio, 136</p>
<p>-nofloatsingle, 133</p>
<p>-noga, 300</p>
<p>-noglimits, 298</p>
<p>-nogtws, 297</p>
<p>-noidentoutput, 311</p>
<p>-nokeepasmfiles, 276</p>
<p>-nokeepcppfiles, 276</p>
<p>-nokeepmap, 248</p>
<p>-nokeeptempfiles, 275</p>
<p>-nomap, 248</p>
<p>-nominlib, 314</p>
<p>-noobj, 274</p>
<p>-nooverlap, 251</p>
<p>-nooverload, 292, 362</p>
<p>-nopasssource, 233</p>
<p>-nopic, 141</p>
<p>-nopid, 141</p>
<p>-nor20has255, 130</p>
<p>-nor21has65535, 131</p>
<p>-noreserve_r2, 129</p>
<p>-noreserve_r5, 129</p>
<p>-nostartfiles, 244</p>
<p>-nostddef, 306</p>
<p>-nostdinc, 307</p>
<p>-nostdlib, 314, 822</p>
<p>-nostrip, 236</p>
<p>-notda, 138, 152</p>
<p>-nothreshold, 137</p>
<p>-o, 11, 122, 163, 265</p>
<p>-O, 166</p>
<p>-OB, 169, 331</p>
<p>-obj, 274</p>
<p>-object_dir, 160</p>
<p>-Oconstprop, 293, 358</p>
<p>-Ocse, 293, 356</p>
<p>-Odebug, 165, 352</p>
<p>-Oexplodejumps, 292</p>
<p>-Ogeneral, 166, 352</p>
<p>-OI, 167, 175, 329</p>
<p>-Oinline_constant_math, 290, 337</p>
<p>-Ointerproc, 168, 338, 346</p>
<p>-Oip_analysis_only, 168</p>
<p>-Oipaliaslibfuncs, 174</p>
<p>-Oipaliasreads, 174</p>
<p>-Oipaliaswrites, 174</p>
<p>-Oipconstantreturns, 173</p>
<p>-Oipconstglobals, 172</p>
<p>-Oipconstprop, 172</p>
<p>-Oipdeletefunctions, 171</p>
<p>-Oipdeleteglobals, 171</p>
<p>-Oiplimitinlining, 173</p>
<p>-Oiplocalizeglobals, 172</p>
<p>-Oiponesiteinlining, 171, 342</p>
<p>-Oipremoveparams, 173</p>
<p>-Oipremovereturns, 173</p>
<p>-Oipsmallinlining, 172</p>
<p>-OL, 175, 294, 347, 894</p>
<p>-old_assembler, 319</p>
<p>--old_specializations, 228</p>
<p>-Olimit, 352, 353</p>
<p>-Olimit=peephole, 169</p>
<p>-Olimit=pipeline, 169</p>
<p>-Olink, 167</p>
<p>-OM, 294, 359, 687, 893, 894</p>
<p>-Omax, 169</p>
<p>-Omaxdebug, 165</p>
<p>-Omemclr, 291</p>
<p>-Omemfuncs, 290, 333</p>
<p><i>1043</i></p>
<p><i>Green Hills Software</i></p>
<p><i>driver options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-Ominmax, 294, 359</p>
<p>-Omoredebug, 165, 352</p>
<p>--one_instantiation_per_object, 749</p>
<p>-Ono_inline_constant_math, 290, 337</p>
<p>-Onobig, 169</p>
<p>-Onoconstprop, 293, 358</p>
<p>-Onocse, 293, 356</p>
<p>-Onoexplodejumps, 292</p>
<p>-Onoinline, 167, 329</p>
<p>-Onoipa, 168, 345</p>
<p>-Onoipaliaslibfuncs, 174, 339</p>
<p>-Onoipaliasreads, 174, 338</p>
<p>-Onoipaliaswrites, 174, 339</p>
<p>-Onoipconstantreturns, 173, 339</p>
<p>-Onoipconstglobals, 172, 343</p>
<p>-Onoipconstprop, 172, 342</p>
<p>-Onoipdeletefunctions, 171, 344</p>
<p>-Onoipdeleteglobals, 171, 344</p>
<p>-Onoiplimitinlining, 173</p>
<p>-Onoiplocalizeglobals, 172, 344</p>
<p>-Onoiponesiteinlining, 171, 342</p>
<p>-Onoipremoveparams, 173, 343</p>
<p>-Onoipremovereturns, 173, 343</p>
<p>-Onoipsmallinlining, 172, 339</p>
<p>-Onolink, 167</p>
<p>-Onoloop, 294, 347</p>
<p>-Onomax, 169</p>
<p>-Onomemclr, 291</p>
<p>-Onomemfuncs, 290, 333</p>
<p>-Onomemory, 294, 359, 894</p>
<p>-Onominmax, 294, 359</p>
<p>-Onone, 166</p>
<p>-Onopeephole, 295, 352</p>
<p>-Onopipeline, 295, 353</p>
<p>-Onoprintfuncs, 291</p>
<p>-Onostrfuncs, 291</p>
<p>-Onotailrecursion, 293, 357</p>
<p>-Onounroll, 292, 347, 351</p>
<p>-Onounrollbig, 169</p>
<p>-Opeep, 295, 352</p>
<p>-Opipeline, 295, 353</p>
<p>-Oprintfuncs, 291</p>
<p>--option, 319</p>
<p>:optionsFile, 288</p>
<p>-os_dir, 159</p>
<p>-Osize, 166, 336, 352</p>
<p>-Ospeed, 166, 352</p>
<p>-Ostrfuncs, 291</p>
<p>-Otailrecursion, 293, 357</p>
<p>-Ounroll, 292</p>
<p>-Ounrollbig, 169, 351</p>
<p>-overlap, 251</p>
<p>-overlap_warn, 251</p>
<p>-overload, 292</p>
<p>-Owholeprogram, 168, 341, 344, 346</p>
<p>-P, 12, 697</p>
<p>-p, 66, 302</p>
<p>-pack, 215</p>
<p>-paddr_offset, 315</p>
<p>--parse_templates, 230</p>
<p>-passsource, 233</p>
<p>-pg, 66, 302</p>
<p>-pic, 117, 141</p>
<p>-pid, 106, 119, 141</p>
<p>-pnone, 302</p>
<p>-precise_signed_zero, 135</p>
<p>-precise_signed_zero_compare, 136</p>
<p>--preinclude_asm, 306</p>
<p>-prelink_against, 231</p>
<p>-prepare_dispose, 40, 152</p>
<p>-preprocess_assembly_files, 232, 394</p>
<p>--preprocess_linker_directive, 237</p>
<p>--preprocess_linker_directive_full, 237</p>
<p>-preprocess_special_assembly_files, 233</p>
<p>--prototype_errors, 257</p>
<p>--prototype_silent, 257</p>
<p>--prototype_warnings, 257</p>
<p>-push_pop, 152</p>
<p>-Q, 12</p>
<p>-Qfinal, 22</p>
<p>-Qn, 237</p>
<p>-Qnormalize, 21</p>
<p>-quiet_auto_large_archive, 316</p>
<p>--quit_after_warnings, 254</p>
<p>-Qy, 237</p>
<p>-r20has255, 130</p>
<p>-r21has65535, 131</p>
<p>-ram_init_val, 271</p>
<p>--range_based_for, 221</p>
<p>-rawimport, 238</p>
<p>--readonly_typeinfo, 225</p>
<p>--readonly_virtual_tables, 226</p>
<p>-recipf, 154</p>
<p>-record_eagle_signal, 296</p>
<p>-record_entry_exit_history, 176</p>
<p>:reference, 286</p>
<p>--register_definition_file, 129</p>
<p>-registermode, 33</p>
<p>-registermode=22, 106, 130</p>
<p>-registermode=26, 106, 130</p>
<p>-registermode=32, 130</p>
<p>-reject_duplicates, 317</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1044</i></p>
<p><i>driver options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-relobj, 235</p>
<p>-relprog, 235</p>
<p>--remarks, 253</p>
<p>-reserve_r2, 34, 129</p>
<p>-reserve_r5, 129</p>
<p>--restrict, 221</p>
<p>-rh850_1bit, 154</p>
<p>-rh850_4bytewordoffset, 156</p>
<p>-rh850_eint_erratum, 156</p>
<p>-rh850_fpsimd=full, 157</p>
<p>-rh850_fpsimd=half, 157</p>
<p>-rh850_fpsimd=none, 157</p>
<p>-rh850_simd, 40, 155</p>
<p>-rh850_trace_loads, 153</p>
<p>-rosda, 130</p>
<p>-rosda_is_zda, 140</p>
<p>--rtti, 225</p>
<p>-S, 10, 12, 395</p>
<p>--saferc, 205, 206, 207, 208, 209, 210, 211, 212, 213</p>
<p>--scan_source, 300</p>
<p>-sda, 98, 136</p>
<p>-sda_file, 99, 137</p>
<p>-search_for_dba, 300</p>
<p>-section, 145</p>
<p>--section_prefix, 309</p>
<p>--section_suffix, 309</p>
<p>-shared_libs, 267</p>
<p>--short_enum, 28, 214, 692</p>
<p>-shorten_loads, 139</p>
<p>-shorten_moves, 140</p>
<p>--signed_chars, 213</p>
<p>--signed_fields, 213, 689</p>
<p>--signed_pointer, 214</p>
<p>-single_tda, 138</p>
<p>--slash_comment, 186</p>
<p>--small, 175</p>
<p>-smaller_bitops, 153</p>
<p>-split_data_sections_by_alignment, 86, 145</p>
<p>-srec, 159, 236</p>
<p>-stabs2dbo, 305</p>
<p>-stack_check, 143</p>
<p>-stack_protector, 143</p>
<p>--standard_vtbl, 226</p>
<p>-startfile_dir, 245</p>
<p>-startfiles, 244</p>
<p>--STD, 185, 736</p>
<p>--std, 185, 736</p>
<p>-std_cxx_include_directory, 307</p>
<p>-stderr, 254</p>
<p>-stderr_overwrite, 317</p>
<p>-stdinc, 307</p>
<p>--stdl, 186, 784</p>
<p>--stdle, 186, 784, 820</p>
<p>-stdlib, 314</p>
<p>-strict_overlap_check, 251</p>
<p>-strip, 236</p>
<p>-strip_eagle_log, 177</p>
<p>-strip_eagle_signal, 297</p>
<p>-strip_entry_exit_history, 176</p>
<p>--suppress_vtbl, 226</p>
<p>--switch_table, 272</p>
<p>-symbol_blacklist_file, 318</p>
<p>-syntax, 13</p>
<p>-sys_include_directory, 308</p>
<p>-syslib, 158</p>
<p>-T, 239</p>
<p>-time32, 215</p>
<p>-time64, 215</p>
<p>-timer_profile, 70, 178</p>
<p>-tmp, 275</p>
<p>-U, 182</p>
<p>-u, 246</p>
<p>-undefined, 245</p>
<p>--unique_strings, 217</p>
<p>--unknown_pragma_errors, 257, 795</p>
<p>--unknown_pragma_silent, 258, 795</p>
<p>--unknown_pragma_warnings, 258</p>
<p>--unsafe_predefines, 306, 780</p>
<p>--unsigned_chars, 213, 684</p>
<p>--unsigned_fields, 214, 684, 689</p>
<p>--unsigned_pointer, 214</p>
<p>--using_std, 220, 792</p>
<p>-v, 15</p>
<p>-V, 254</p>
<p>-v800_old_callt, 151</p>
<p>-v850_isr_save_eiic, 156</p>
<p>-v850_isr_save_r4r5, 155</p>
<p>-version_info, 254</p>
<p>--vla, 218</p>
<p>-w, 253, 704</p>
<p>-wait_for_dblink, 301</p>
<p>-warn_dbo_not_found_max, 301</p>
<p>--warnings, 253</p>
<p>-wchar_s32, 310</p>
<p>-wchar_u16, 310</p>
<p>-Wdouble, 273</p>
<p>-Wfloat, 273</p>
<p>-Wformat, 258</p>
<p>--whole-archive, 241</p>
<p>-Wimplicit-int, 258</p>
<p>-Wl,, 241</p>
<p>-Wno-format, 258</p>
<p><i>1045</i></p>
<p><i>Green Hills Software</i></p>
<p><i>driver options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-Wno-implicit-int, 258</p>
<p>-Wno-shadow, 259</p>
<p>-Wno-trigraphs, 259</p>
<p>-Wno-undef, 259</p>
<p>-Wnodouble, 273</p>
<p>-Wnofloat, 273</p>
<p>--wrap_diagnostics, 256</p>
<p>-Wshadow, 259</p>
<p>-Wtrigraphs, 259</p>
<p>-Wundef, 259</p>
<p>-X, 319</p>
<p>--xref=declare, 304</p>
<p>--xref=full, 304</p>
<p>--xref=global, 304</p>
<p>--xref=none, 304</p>
<p>-Y0,, 288</p>
<p>-Ya,, 289</p>
<p>-YL,, 288</p>
<p>-Yl,, 289</p>
<p>-zda, 98, 137</p>
<p>-zda_file, 99, 138</p>
<p>-zero_commons, 140</p>
<p>.dsect assembler directive, 424</p>
<p>-dual_debug|-dwarf2 driver option, 304</p>
<p>Duplicate Whitelist Builder option, 243</p>
<p>-duplicate_whitelist driver option, 243</p>
<p>DWARF debugging information</p>
<p>converting, 57, 58, 59</p>
<p>locating, 58</p>
<p>-dwarf_to_dbo driver option, 305</p>
<p>dwarf2dbo executable, 57, 58, 59</p>
<p>dynamic initialization, 759</p>
<p><b>E</b></p>
<p>--e driver option, 185, 739, 784</p>
<p>-E driver option, 12, 697</p>
<p>e_ehsize ELF header field, 918</p>
<p>e_entry ELF header field, 917</p>
<p>e_flags ELF header field, 918</p>
<p>e_ident ELF header field, 916</p>
<p>e_machine ELF header field, 917</p>
<p>e_phentsize ELF header field, 918, 934</p>
<p>e_phnum ELF header field, 918, 934</p>
<p>e_phoff ELF header field, 918</p>
<p>e_shentsize ELF header field, 918, 921</p>
<p>e_shnum ELF header field, 918, 921</p>
<p>e_shoff ELF header field, 918, 921</p>
<p>e_shstrndx ELF header field, 918, 933</p>
<p>e_type ELF header field, 916</p>
<p>e_version ELF header field, 917</p>
<p>EABI, V850 and RH850, 26</p>
<p>EAGLE Logging Builder option, 177</p>
<p>EAGLE Mute Signal Builder option, 297</p>
<p>EAGLE Record Signal Builder option, 296</p>
<p>EAGLE Strip Signal Builder option, 297</p>
<p>-earlyabsolute linker option, 472</p>
<p>ease850 (see assembler)</p>
<p>EC++ (see Embedded C++)</p>
<p>%echo preprocessor directive, customization file, 1002</p>
<p>Eclipse integration (see MULTI for Eclipse)</p>
<p>ecxx header file directory, 819</p>
<p>EDG Front End Options Builder option, 319</p>
<p>__EDG__, 784</p>
<p>__EDG_IMPLICIT_USING_STD, 792</p>
<p>__EDG_RUNTIME_USES_NAMESPACES, 792</p>
<p>EDITOR context sensitive variable, customization file, 998</p>
<p>--ee driver option, 185, 741, 784</p>
<p>EEC++ (see Extended Embedded C++)</p>
<p>eecxx header file directory, 819</p>
<p>--eel driver option, 186, 784, 820</p>
<p>--eele driver option, 186, 784, 820</p>
<p>__EI() intrinsic function, 811</p>
<p>EI_CLASS ELF identification index, 919, 920</p>
<p>EI_DATA ELF identification index, 919, 920</p>
<p>EI_MAGn ELF identification index, 919</p>
<p>EI_NIDENT ELF identification index, 919, 920</p>
<p>EI_PAD ELF identification index, 919, 920</p>
<p>EI_VERSION ELF identification index, 919, 920</p>
<p>__EIR() intrinsic function, 811</p>
<p>.eject assembler directive, 423</p>
<p>--el driver option, 186, 784, 821</p>
<p>--ele driver option, 186, 784, 821</p>
<p>ELF file format</p>
<p>data types, 915</p>
<p>header fields, 916</p>
<p>identification indexes, 919</p>
<p>introduction, 914</p>
<p>object and executable file formats, 914, 928</p>
<p>optional header output, 934</p>
<p>program attribute flags, 936</p>
<p>program section names, 925</p>
<p>program sections, 925</p>
<p>program types, 935</p>
<p>relocation directories, 928</p>
<p>relocation fields, 929</p>
<p>section attribute flags, 924</p>
<p>section header fields, 921</p>
<p>section types, 923</p>
<p>special section indexes, 923</p>
<p>string tables, 933</p>
<p>symbol bindings, 931</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1046</i></p>
<p><i>driver options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>symbol table entries, 930</p>
<p>symbol types, 931</p>
<p>symbol values, 932</p>
<p>ELF files</p>
<p>printing with gdump utility, 409</p>
<p>__ELF__, 791</p>
<p>#elif, 680</p>
<p>%elif preprocessor directive, customization file, 1002</p>
<p>.else assembler directive, 413</p>
<p>%else preprocessor directive, customization file, 1002</p>
<p>.elseif assembler directive, 413</p>
<p>%elseif preprocessor directive, customization file, 1002</p>
<p>%elsif preprocessor directive, customization file, 1002</p>
<p>elxr (see linker)</p>
<p>-elxr_diag_error driver option, 262</p>
<p>-elxr_diag_suppress driver option, 262</p>
<p>-elxr_diag_warning driver option, 262</p>
<p>Embedded C++</p>
<p>features of, 739</p>
<p>predefined macro, 784</p>
<p>embedded development</p>
<p>and memory-mapped I/O, 124</p>
<p>and multiple-section programs, 83</p>
<p>and ROM, 498</p>
<p>symbolic memory-mapped I/O, 124</p>
<p>__EMBEDDED_CXX, 784</p>
<p>__EMBEDDED_CXX_HEADERS, 784</p>
<p>Emulate Behaviors of a Specific Compiler Version Builder</p>
<p>option, 160, 181</p>
<p>Emulated GNU Version Builder option, 309</p>
<p>Enable SIMD instructions (RH850 and later) Builder option,</p>
<p>155</p>
<p>--enable_ctors_dtors driver option, 223</p>
<p>-enable_eagle_log driver option, 177</p>
<p>--enable_noinline driver option, 222, 336</p>
<p>.end assembler directive, 424</p>
<p>End Files Builder option, 244</p>
<p>endaddr linker expression function, 488</p>
<p>-endfile driver option, 244</p>
<p>endianness</p>
<p>portability problems, 885</p>
<p>predefined macros for, 786</p>
<p>specifying, 568, 594</p>
<p>.endif assembler directive, 413</p>
<p>%endif preprocessor directive, customization file, 1002</p>
<p>.endm assembler directive, 418</p>
<p>.endo ident assembler directive, 426</p>
<p>.endr assembler directive, 420</p>
<p>-entry|-e driver option, 237</p>
<p>enum data type, 680, 692</p>
<p>size, 214</p>
<p>.env output file type, 13</p>
<p>__ep global symbol, 108</p>
<p>ep register</p>
<p>for TDA, 108, 109</p>
<p>Epilogues and Prologues via callt Builder option, 40, 151</p>
<p>Epilogues and Prologues via prepare and dispose Builder</p>
<p>option, 40, 152</p>
<p>.equ assembler directive, 402</p>
<p>-errmax driver option, 253</p>
<p>errno(), C implementation, 716</p>
<p>#error, 680</p>
<p>error linker expression function, 488</p>
<p>error messages</p>
<p>in assembler listing, 428</p>
<p>treating warnings as, 254</p>
<p>Error on Duplicate Symbols in an Archive Builder option,</p>
<p>316</p>
<p>%error preprocessor directive, customization file, 1002</p>
<p>-error_basename driver option, 256</p>
<p>escape sequences, in assembler, 400</p>
<p>establishing interrupt vectors</p>
<p>#pragma intvect, 124</p>
<p>evaluation of arguments, 35</p>
<p>evaluation order, 891</p>
<p>Event Logging Builder option, 159</p>
<p>-event_logging driver option, 159</p>
<p>__EXCEPTION_HANDLING, 792</p>
<p>exceptions, 742</p>
<p>predefined macro, 792</p>
<p>__EXCEPTIONS, 792</p>
<p>--exceptions driver option, 186, 736</p>
<p>executable files, 235</p>
<p>ELF format, 914, 928</p>
<p>position independent, 117, 119</p>
<p>Executable Stripping Builder option, 236</p>
<p>exit(), C implementation, 714</p>
<p>.exitm assembler directive, 419</p>
<p>%expand_path(relative_path) .gpj macro function, 969</p>
<p>Explode Jumps Builder option, 292</p>
<p>Export All Symbols From Library Builder option, 247</p>
<p>--export driver option, 230, 736, 753</p>
<p>export-TDA functions, 111, 112, 114, 116</p>
<p>-exportall driver option, 247</p>
<p>expressions</p>
<p>assembler, 402, 407</p>
<p>expressions, assembler, 402, 407</p>
<p>Extend Variable Liveness Builder option, 299</p>
<p>-extend_liveness driver option, 299</p>
<p>extended characters, 697, 700</p>
<p>Extended Embedded C++</p>
<p>predefined macro, 784</p>
<p><i>1047</i></p>
<p><i>Green Hills Software</i></p>
<p><i>ELF file format (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__EXTENDED_EMBEDDED_CXX, 784</p>
<p>__EXTENDED_EMBEDDED_CXX_HEADERS, 784</p>
<p>extern storage class specifier</p>
<p>``C'', 738</p>
<p>``C++'', 738</p>
<p>K &amp; R C, 680</p>
<p>syntax, 758</p>
<p>use of, 759, 880</p>
<p>-external driver option, 170</p>
<p>-external_file driver option, 170</p>
<p>externalDepends Top Project directive, 963</p>
<p>externally_visible GNU attribute, 721</p>
<p>-extra_file=filename driver option, 301</p>
<p>Extract Whole Archive Builder option, 241</p>
<p>-extractall</p>
<p>linker option, 506</p>
<p>-extractall driver option, 246</p>
<p>-extractall linker option, 472</p>
<p>-extractweak linker option, 472</p>
<p>-extractweaklinker option, 506</p>
<p>:extraOutputFile Builder option, 285</p>
<p><b>F</b></p>
<p>Far Calls Builder option, 94, 95, 141</p>
<p>far function calls, 93</p>
<p>Builder option, 94</p>
<p>__farcall, 95</p>
<p>-farcallpatch driver option, 142</p>
<p>-farcalls driver option, 94, 141</p>
<p>--fast driver option, 175</p>
<p>-fast_malloc driver option, 150</p>
<p>fenv.h</p>
<p>functions, 855</p>
<p>-ffunctions driver option, 134</p>
<p>-fgnu89-inline driver option, 309</p>
<p>-fhard driver option, 132</p>
<p>__Field_Is_Signed__, 787</p>
<p>__Field_Is_Unsigned__, 787</p>
<p>.file assembler directive, 426</p>
<p>file extension</p>
<p>.bsp, 972</p>
<p>.int, 972</p>
<p>file extensions, 7</p>
<p>file inclusion directives, 416</p>
<p>file type=file type .gpj conditional control statement, 966</p>
<p>file types</p>
<p>Project Manager, 970</p>
<p>setting manually, 8</p>
<p>__FILE__, 680, 781</p>
<p>FILENAME context sensitive variable, customization file,</p>
<p>998</p>
<p>FILENAMEBASE context sensitive variable, customization</p>
<p>file, 998</p>
<p>FILENAMELIBBASE context sensitive variable,</p>
<p>customization file, 998</p>
<p>Files Listing External Symbols Builder option, 170</p>
<p>Files to Pre-Include Builder option, 305</p>
<p>-filetype.suffix driver option, 8</p>
<p>FILETYPEOPTIONS context sensitive variable,</p>
<p>customization file, 998</p>
<p>FILL linker section attribute, 491</p>
<p>final GNU attribute, 721</p>
<p>final linker expression function, 488</p>
<p>.fixaddr program section, 499, 927</p>
<p>.fixtype program section, 499, 927</p>
<p>float data type</p>
<p>variable arguments, 692</p>
<p>-float_associativity driver option, 134</p>
<p>-float_scanf driver option, 313</p>
<p>&lt;float.h&gt; header file, 885</p>
<p>Floating Point Associativity Builder option, 134</p>
<p>floating-point</p>
<p>I/O, disabling, 136</p>
<p>language-independent library, 861</p>
<p>predefined macros for, 787, 788</p>
<p>range, 890</p>
<p>values, 26</p>
<p>Floating-Point Functions Builder option, 134</p>
<p>Floating-Point Mode Builder option, 132</p>
<p>Floating-Point Precise Signed Zero Builder option, 135</p>
<p>Floating-Point Precise Signed Zero Compare Builder option,</p>
<p>135</p>
<p>Floating-Point SIMD mode (RH850 and later) Builder option,</p>
<p>157</p>
<p>-floatio driver option, 136</p>
<p>floats</p>
<p>in registers, 33</p>
<p>-floatsingle driver option, 133</p>
<p>-fNaN_cmp_unordered driver option, 134</p>
<p>-fno-gnu89-inline driver option, 309</p>
<p>-fno_NaN_cmp_unordered driver option, 134</p>
<p>-fnodouble driver option, 273</p>
<p>-fnofunctions driver option, 135</p>
<p>-fnone driver option, 132</p>
<p>-fnonodouble driver option, 273</p>
<p>Follow Section Builder option, 315</p>
<p>-follow_section driver option, 315</p>
<p>for -cpu option, 33</p>
<p>Force All Symbols From Library Builder option, 246</p>
<p>Force Frame Pointer Builder option, 181, 300</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1048</i></p>
<p><i>__EXTENDED_EMBEDDED_CXX</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Force the save/restore of R4/R5 in ISR prologue/epilogue</p>
<p>Builder option, 155</p>
<p>Force the save/restore of the EIIC register in ISR</p>
<p>prologue/epilogue Builder option, 156</p>
<p>Force Undefined Symbol Builder option, 246</p>
<p>__force_stores() intrinsic function, 813</p>
<p>--force_vtbl driver option, 226</p>
<p>format GNU attribute, 721</p>
<p>format_arg GNU attribute, 722</p>
<p>FPSIMD vector support, 42</p>
<p>-fpu30 assembler option, 396</p>
<p>-fpu=fpu20 driver option, 155</p>
<p>-fpu=fpu30 driver option, 155</p>
<p>frame pointer, 38</p>
<p>register for, 37</p>
<p>free() standard library function</p>
<p>errors related to, 71</p>
<p>frees DoubleCheck property type, 371</p>
<p>friend classes, 737</p>
<p>-fsingle driver option, 133</p>
<p>.fsize assembler directive, 426</p>
<p>-fsoft driver option, 133</p>
<p>Full Breakdots Builder option, 298</p>
<p>-full_breakdots driver option, 298</p>
<p>-full_debug_info driver option, 304</p>
<p>__FULL_DIR__, 791</p>
<p>__FULL_FILE__, 791</p>
<p>__FUNCPTR_BIT, 786</p>
<p>function declaration, far function call, 95</p>
<p>function entry/exit history, 62</p>
<p>Function Entry/Exit Logging Builder option, 176</p>
<p>Function Prologues Builder option, 271, 802</p>
<p>function properties, specifying for DoubleCheck, 369, 370</p>
<p>__FUNCTION__, 791</p>
<p>functions</p>
<p>aligning, 796</p>
<p>calling conventions, 888</p>
<p>compiler generated, 751</p>
<p>deleting unused, 507</p>
<p>inline, 751, 796</p>
<p>interrupt, 802</p>
<p>keeping unused, 507</p>
<p>prototype, C versus. C++, 882</p>
<p>pure virtual, 751</p>
<p>return values, 888</p>
<p>variable argument, 692</p>
<p>Functions Without Prototypes Builder option, 257, 259</p>
<p><b>G</b></p>
<p>-G driver option, 55, 57, 62, 176, 822</p>
<p>-g driver option, 176</p>
<p>--g++ driver option, 185, 743</p>
<p>-ga driver option, 300</p>
<p>gaddr2line utility, 529</p>
<p>gasmlist utility, 530</p>
<p>gbin2c utility, 536</p>
<p>gbincmp utility, 545</p>
<p>gbuild utility, 547</p>
<p>Implicit Dependency Analysis (IDA), 555</p>
<p>using with interprocedural optimizations, 345</p>
<p>gbuildDir Top Project directive, 964</p>
<p>-gcc driver option, 184, 662, 670</p>
<p>gcolor utility, 556</p>
<p>gcompare utility, 561</p>
<p>Gcores Common Link Options Builder option, 266</p>
<p>GCores Cores Import Symbols From Other Cores Builder</p>
<p>option, 266</p>
<p>GCores Cpu Builder option, 267</p>
<p>GCores Disable Error Messages Concerning Overlapping</p>
<p>Sections Builder option, 266</p>
<p>GCores Driver Builder option, 266</p>
<p>Gcores Exported Absolutes Only Builder option, 267</p>
<p>GCores Generate Additional Output Builder option, 268</p>
<p>Gcores Output Filename Builder option, 265</p>
<p>Gcores Shared Modules Import Symbols From Cores Builder</p>
<p>option, 265</p>
<p>gcores utility, 532</p>
<p>gdump utility, 409, 564</p>
<p>.gen assembler directive, 423</p>
<p>-gen_entry_exit_arg_history driver option, 296</p>
<p>-gen_entry_exit_history driver option, 296</p>
<p>Generate a backwards-compatible (MULTI 5.1.x and earlier)</p>
<p>call table in the linker Builder option, 150</p>
<p>Generate Additional Output Builder option, 13, 236</p>
<p>Generate Function Entry/Exit Instrumentation Builder option,</p>
<p>296</p>
<p>Generate Function Entry/Exit Instrumentation with</p>
<p>Arguments Builder option, 296</p>
<p>Generate MULTI and Native Information Builder option,</p>
<p>304</p>
<p>Generate Target-Walkable Stack Builder option, 37, 38, 297</p>
<p>getenv(), C implementation, 704</p>
<p>__GETSR() intrinsic function, 811</p>
<p>gfile utility, 571</p>
<p>gfunsize utility, 572</p>
<p>ghexfile utility (see gsrec utility)</p>
<p>ghide utility, 573</p>
<p>__ghs__, 784</p>
<p>__ghs_alignment, 790</p>
<p>__ghs_asm, 784</p>
<p>__ghs_getdbits() intrinsic function, 814</p>
<p><i>1049</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Force the save/restore of R4/R5 in ISR prologue/epilogue Builder option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__ghs_getfbits() intrinsic function, 814</p>
<p>__GHS_Inline_Memory_Functions, 792</p>
<p>__GHS_Inline_String_Functions, 792</p>
<p>__ghs_max_pack_value, 790</p>
<p>__GHS_NO_ZERO_COMMONS__, 790</p>
<p>__GHS_NOCOMMONS__, 790</p>
<p>ghs_noprofile attribute, 723</p>
<p>__ghs_noprofile_func() intrinsic function, 814</p>
<p>__GHS_Optimize_Inline, 792</p>
<p>__ghs_packing, 791</p>
<p>__ghs_pic, 789</p>
<p>__ghs_pid, 789</p>
<p>__GHS_REVISION_DATE, 784</p>
<p>__GHS_REVISION_VALUE, 784</p>
<p>__ghs_sda, 789</p>
<p>__ghs_sda_threshold, 789</p>
<p>__ghs_setdbits() intrinsic function, 814</p>
<p>__ghs_setfbits() intrinsic function, 814</p>
<p>__ghs_tda, 789</p>
<p>__GHS_VERSION_NUMBER, 784</p>
<p>__ghs_zda, 790</p>
<p>__ghs_zda_threshold, 790</p>
<p>__ghsalwaysimport</p>
<p>Linker Symbols, 506</p>
<p>__ghsautoimport</p>
<p>Linker Symbols, 506</p>
<p>__ghsbegin symbol, 503</p>
<p>__ghsend symbol, 503</p>
<p>.ghsinfo program section, 511</p>
<p>-ghsmc_core_count driver option, 303</p>
<p>-ghsmc_file driver option, 302</p>
<p>.ghsnote assembler directive, 511</p>
<p>__ghssize symbol, 503</p>
<p>__ghstable_tablename, __ghsentry_tablename_entryname</p>
<p>Linker generated tables, 505</p>
<p>--ghstd=2010 driver option, 255</p>
<p>--ghstd=last driver option, 255</p>
<p>--ghstd=none driver option, 255</p>
<p>-glimits driver option, 298</p>
<p>global objects, 759</p>
<p>global pointer</p>
<p>for V850 assembler, 434, 435</p>
<p>Global Registers Builder option, 92, 106, 142</p>
<p>-globalcheck_qualifiers driver option, 252</p>
<p>-globalcheck=full driver option, 251</p>
<p>-globalcheck=none driver option, 252</p>
<p>-globalcheck=normal driver option, 252</p>
<p>-globalreg driver option, 92, 106, 142, 790</p>
<p>__GlobalRegisters, 790</p>
<p>.globl assembler directive, 424</p>
<p>gmemfile</p>
<p>invoking from the driver, 236</p>
<p>gmemfile utility, 574</p>
<p>.gmon output file type, 13</p>
<p>gnm utility, 581, 760</p>
<p>GNU attributes</p>
<p>alias, 719</p>
<p>aligned, 719</p>
<p>always_inline, 719</p>
<p>at, 720</p>
<p>const, 720</p>
<p>deprecated, 720</p>
<p>externally_visible, 721</p>
<p>final, 721</p>
<p>format, 721</p>
<p>format_arg, 722</p>
<p>noinline, 723</p>
<p>nonnull, 723</p>
<p>noreturn, 723</p>
<p>nothrow, 723</p>
<p>overview of, 718</p>
<p>packed, 724</p>
<p>pure, 724</p>
<p>section, 724</p>
<p>sentinel, 724</p>
<p>transparent_union, 730</p>
<p>unused, 730</p>
<p>used, 731</p>
<p>warn_unused_result, 731</p>
<p>weak, 731</p>
<p>GNU C extensions, 670, 673</p>
<p>GNU C++ extensions, 743</p>
<p>GNU Compatibility Optimizations Builder option, 295</p>
<p>GNU compiler</p>
<p>using with MULTI Debugger, 57, 61</p>
<p>GNU Extended Assembly, 910</p>
<p>GNU Options, supported, 952</p>
<p>__gnu_asm, 784</p>
<p>--gnu_asm driver option, 310</p>
<p>--gnu_version=30300 driver option, 309</p>
<p>--gnu_version=40300 driver option, 309</p>
<p>-gnu99 driver option, 184, 662</p>
<p>__GNUC__, 783</p>
<p>__GNUC_GNU_INLINE__, 783</p>
<p>__GNUC_STDC_INLINE__, 783</p>
<p>gpatch utility program, 586</p>
<p>.gpc file extension, 972</p>
<p>.gpj file extension, 970</p>
<p>.gpj syntax, advanced, 969</p>
<p>conditional control statements</p>
<p>command=command_name, 966</p>
<p>comment, 966</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1050</i></p>
<p><i>__ghs_getfbits() intrinsic function</i></p>
<h1 style="page-break-before:always; "></h1>
<p>config, 966</p>
<p>expressions, 967</p>
<p>file type=file type, 966</p>
<p>isdefined, 967</p>
<p>istarget, 967</p>
<p>isundefined, 967</p>
<p>nobuild, 967</p>
<p>optional, 968</p>
<p>overview of, 965</p>
<p>pass=, 968</p>
<p>rebuild, 968</p>
<p>selectone_optional, 968</p>
<p>selectone_required, 968</p>
<p>streq, 967</p>
<p>strprefix, 967</p>
<p>links to other projects, 963</p>
<p>macro functions</p>
<p>%expand_path(relative_path), 969</p>
<p>%option_value(option_name), 969</p>
<p>project build configurations, 962</p>
<p>Top Project directives</p>
<p>customization, 965</p>
<p>defaultBuildOptions, 961</p>
<p>defineConfig, 962</p>
<p>externalDepends, 963</p>
<p>gbuildDir, 964</p>
<p>import, 964</p>
<p>macro, 964</p>
<p>overview, 961</p>
<p>primaryTarget, 965</p>
<p>Top Project headers, 958</p>
<p>.graph output file type, 14</p>
<p>Green Hills Standard Mode Builder option, 255</p>
<p>grouping program variables, 83</p>
<p>-gs driver option, 176</p>
<p>-gsize driver option, 250</p>
<p>gsize utility, 592</p>
<p>gsrec utility</p>
<p>examples, 599, 600</p>
<p>invoking from the driver, 236</p>
<p>options, 594</p>
<p>overview, 594</p>
<p>gstack</p>
<p>annotating recursion for, 610</p>
<p>caveats, 619</p>
<p>introduction, 600</p>
<p>options, 615</p>
<p>preparing your program for, 601</p>
<p>recursive clusters, 605</p>
<p>report format, 613</p>
<p>specifying functions with non-unique names, 617</p>
<p>specifying interrupts for, 612</p>
<p>gstrip utility, 620</p>
<p>-gtws driver option, 37, 38, 297</p>
<p>Guidelines For the Use Of The C Language In Critical</p>
<p>Systems, Motor Industry Software Reliability</p>
<p>Association, October 2004, 771</p>
<p>Guidelines For the Use Of The C Language In Vehicle Based</p>
<p>Software, Motor Industry Software Reliability</p>
<p>Association, April 1998, 768</p>
<p>Guiding Declarations of Template Functions Builder option,</p>
<p>227</p>
<p>--guiding_decls driver option, 227</p>
<p>gversion utility, 621</p>
<p>gwhat utility, 623</p>
<p><b>H</b></p>
<p>-H driver option, 22, 183</p>
<p>.h file extension, 971</p>
<p>.H file extension, 971</p>
<p>-h HTML compiler option, 321</p>
<p>header file directories</p>
<p>ansi, 819</p>
<p>C, 819</p>
<p>C++, 819</p>
<p>ecxx, 819</p>
<p>eecxx, 819</p>
<p>include/v800, 819</p>
<p>scxx, 819</p>
<p>header files, 880</p>
<p>modifying searches, 77</p>
<p>printing included, 22</p>
<p>headers, deprecated, 766</p>
<p>.heap program section, 500, 928</p>
<p>-help assembler option, 397</p>
<p>-help command line option, 586</p>
<p>-help driver option, 15</p>
<p>-help linker option, 472</p>
<p>-Help linker option, 472</p>
<p>-hex driver option, 236</p>
<p>HEX386 format (see Intel hexadecimal formats)</p>
<p>HEX86 format (see Intel hexadecimal formats)</p>
<p>.hh file extension, 971</p>
<p>Host and Target Character Encoding Builder option, 219, </p>
<p>700, 761</p>
<p>-host64 driver option, 289</p>
<p>hosts, different building and debugging, 58</p>
<p>HTML compiler options</p>
<p>-c, 320</p>
<p>-C, 320</p>
<p>-h, 321</p>
<p><i>1051</i></p>
<p><i>Green Hills Software</i></p>
<p><i>.gpj syntax, advanced (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-o, 320</p>
<p>-p, 320</p>
<p>HTML File Compression Builder option, 320</p>
<p>.hword assembler directive, 414</p>
<p>--hybrid_one_instantiation_per_object driver option, 229</p>
<p><b>I</b></p>
<p>-I assembler option, 397</p>
<p>-I driver option, 76, 161</p>
<p>.i file extension, 8</p>
<p>.i files, 697</p>
<p>-I- driver option, 77</p>
<p>I/O</p>
<p>mixing languages, 880</p>
<p>I/O, memory-mapped, 124</p>
<p>#ident, 680</p>
<p>.ident assembler directive, 428</p>
<p>-ident driver option, 311</p>
<p>Identifier Blacklist Builder option, 318</p>
<p>Identifier Definition Builder option, 311</p>
<p>Identifier Support Builder option, 311</p>
<p>-identifier_blacklist_file driver option, 318</p>
<p>identifiers, 398</p>
<p>in assembler, 398</p>
<p>-identoutput driver option, 311</p>
<p>.idep output file type, 14</p>
<p>__IeeeFloat__, 787</p>
<p>.if assembler directive, 413</p>
<p>%if preprocessor directive, customization file, 1002</p>
<p>%ifdef preprocessor directive, customization file, 1002</p>
<p>-ignore_callt_state_in_interrupts driver option, 40, 151</p>
<p>-ignore_debug_references driver option, 244</p>
<p>.ii files, 747</p>
<p>.ii output file type, 14</p>
<p>illegal assumptions</p>
<p>implied register usage, 892</p>
<p>memory allocation, 893</p>
<p>images for linking, converting</p>
<p>customization files, 991</p>
<p>Implicit Dependency Analysis (IDA)</p>
<p>gbuild utility, 555</p>
<p>Implicit Int Return Type Builder option, 258</p>
<p>Implicit Source File Inclusion Builder option, 228, 230, 736, </p>
<p>752, 753</p>
<p>Implicit Use of 'std'</p>
<p>Namespace Builder option, 220</p>
<p>--implicit_extern_c_type_conversion driver option, 312</p>
<p>--implicit_include driver option, 228, 752</p>
<p>--implicit_typename driver option, 228</p>
<p>Import libraries into shared module Builder option, 267</p>
<p>Import Symbols Builder option, 247</p>
<p>import Top Project directive, 964</p>
<p>.include assembler directive, 416</p>
<p>#include directive, 161</p>
<p>Include Directories Builder option, 76, 77, 161</p>
<p>-include driver option, 305</p>
<p>include files</p>
<p>directive for, 416</p>
<p>directory for assembler, 397</p>
<p>list of directories searched for, 161</p>
<p>%include preprocessor directive, customization file, 1002</p>
<p>include/v800 header file directory, 819</p>
<p>Incorrect Pragma Directives Builder option, 258, 795</p>
<p>--incorrect_pragma_errors driver option, 258, 795</p>
<p>--incorrect_pragma_silent driver option, 258, 795</p>
<p>--incorrect_pragma_warnings driver option, 258</p>
<p>ind_bcnt.c run-time code, 870</p>
<p>ind_call.800 run-time code, 869</p>
<p>ind_crt0.c startup code, 867</p>
<p>ind_crt1.c run-time code, 869</p>
<p>ind_dots.800 run-time code, 869</p>
<p>ind_errn.c run-time code, 869</p>
<p>ind_exit.c run-time code, 872</p>
<p>ind_gcnt.800 run-time code, 870</p>
<p>ind_gpid.c run-time code, 870</p>
<p>ind_gprf.c run-time code, 870</p>
<p>ind_heap.c run-time code, 871</p>
<p>ind_initmem.800 startup code, 868</p>
<p>ind_io.c run-time code, 871</p>
<p>ind_iob.c run-time code, 872</p>
<p>ind_lock.c run-time code, 870</p>
<p>ind_manprf.c run-time code, 870</p>
<p>ind_mcnt.800 run-time code, 870</p>
<p>ind_mcpy.800 startup code, 868</p>
<p>ind_mprf.c run-time code, 870</p>
<p>ind_mset.800 startup code, 868</p>
<p>ind_reset.800 run-time code, 869</p>
<p>ind_reset.800 startup code, 868</p>
<p>ind_stackcheck.c run-time code, 870</p>
<p>ind_thrd.c run-time code, 870</p>
<p>Individual Function Sections for Default Text Section Builder</p>
<p>option, 148</p>
<p>Individual Function Sections for Renamed Text Sections</p>
<p>Builder option, 148</p>
<p>Individual Function Sections for User-Defined Text Sections</p>
<p>Builder option, 149</p>
<p>Individual Variable Sections for Default Data Sections</p>
<p>Builder option, 146</p>
<p>Individual Variable Sections for Renamed Data Sections</p>
<p>Builder option, 146</p>
<p>Individual Variable Sections for User-Defined Data Sections</p>
<p>Builder option, 147</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1052</i></p>
<p><i>HTML compiler options (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-individual_attribute_data_sections driver option, 147</p>
<p>-individual_attribute_function_sections driver option, 149</p>
<p>-individual_data_sections driver option, 146</p>
<p>-individual_function_sections driver option, 148</p>
<p>-individual_pragma_data_sections driver option, 147</p>
<p>-individual_pragma_function_sections driver option, 149</p>
<p>.inf output file type, 14</p>
<p>%info preprocessor directive, customization file, 1002</p>
<p>-init_ram_at_startup driver option, 271</p>
<p>Initialize RAM at Startup Builder option, 271</p>
<p>initialized data, in ROM, 498</p>
<p>Inline C Memory Functions Builder option, 290, 333</p>
<p>Inline C String Functions Builder option, 291</p>
<p>Inline Constant Math Functions Builder option, 290, 337</p>
<p>inline functions., 39</p>
<p>Inline Larger Functions Builder option, 169, 331, 332</p>
<p>Inline Specific Functions Builder option, 175, 329, 331, 332</p>
<p>Inline Tiny Functions Builder option, 290</p>
<p>-inline_prologue driver option, 272</p>
<p>--inline_tiny_functions driver option, 290</p>
<p>inlining</p>
<p>advantages of, 332</p>
<p>automatic two-pass, 329</p>
<p>C memory functions, 333</p>
<p>C string functions, 333</p>
<p>C++, 335</p>
<p>description, 324</p>
<p>limitations of, 333</p>
<p>manual, 325</p>
<p>__noinline, 336</p>
<p>single-pass, 328</p>
<p>specific functions, 329</p>
<p>template function, 336</p>
<p>two-pass, 328</p>
<p>--inlining driver option, 308</p>
<p>inlining optimizations, 324</p>
<p>inlining small functions</p>
<p>interprocedural optimizations, 339</p>
<p>--inlining_unless_debug driver option, 308</p>
<p>Input Languages Builder option, 276</p>
<p>INPUTDIR context sensitive variable, customization file,</p>
<p>998</p>
<p>INPUTFILE context sensitive variable, customization file,</p>
<p>998</p>
<p>.inspect assembler directive, 424</p>
<p>-install_patch command line option, 586</p>
<p>installing</p>
<p>patches, 586</p>
<p>Instantiate Extern Inline Builder option, 222, 736</p>
<p>--instantiate_extern_inline driver option, 222</p>
<p>--instantiation_dir driver option, 229</p>
<p>Instrument loads with software trace instructions Builder</p>
<p>option, 153</p>
<p>.int</p>
<p>file extension, 972</p>
<p>int data type</p>
<p>size, 786, 793</p>
<p>__INT_BIT, 786</p>
<p>__Int_Is_32, 793</p>
<p>__Int_Is_64, 793</p>
<p>Intel hexadecimal formats</p>
<p>generating, 236, 594</p>
<p>Interleaved Source and Assembly Builder option, 233</p>
<p>Intermediate Output Directory Relative to This File Builder</p>
<p>option, 277</p>
<p>Intermediate Output Directory Relative to Top-Level Project</p>
<p>Builder option, 164</p>
<p>Intermodule Inlining Builder option, 167, 329, 330, 331, 332</p>
<p>interprocedural optimizations, 338</p>
<p>alias analysis, 338</p>
<p>constant returns, propagation of, 339</p>
<p>inlining small functions, 339</p>
<p>read-based alias analysis, 338</p>
<p>using gbuild, 345</p>
<p>whole program optimizations, 341</p>
<p>write-based alias analysis, 338</p>
<p>Interprocedural Optimizations Builder option, 168, 338, 341, </p>
<p>344, 345, 346</p>
<p>interrupt</p>
<p>functions, 122, 802</p>
<p>processing, 122</p>
<p>routine and optimizations, 687</p>
<p>__interrupt keyword, 123</p>
<p>intrinsic functions</p>
<p>__ADD_SAT(), 812</p>
<p>__builtin_constant_p(), 813</p>
<p>__builtin_return_address(), 810</p>
<p>__DI(), 811</p>
<p>__DIR(), 811</p>
<p>__EI(), 811</p>
<p>__EIR(), 811</p>
<p>__force_stores(), 813</p>
<p>__GETSR(), 811</p>
<p>__ghs_getdbits(), 814</p>
<p>__ghs_getfbits(), 814</p>
<p>__ghs_noprofile_func(), 814</p>
<p>__ghs_setdbits(), 814</p>
<p>__ghs_setfbits(), 814</p>
<p>__memory_changed(), 813</p>
<p>__MULSH(), 812</p>
<p>__MULUH(), 812</p>
<p>__RIR(), 811</p>
<p><i>1053</i></p>
<p><i>Green Hills Software</i></p>
<p><i>-individual_attribute_data_sections driver option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__schedule_barrier(), 813</p>
<p>__SETSR(), 811</p>
<p>__SUB_SAT(), 812</p>
<p>intrinsics, 810</p>
<p>__CAXI(), 811</p>
<p>__LDSR(), 810</p>
<p>__SCH0L(), 812</p>
<p>__SCH0R(), 812</p>
<p>__SCH1L(), 812</p>
<p>__SCH1R(), 812</p>
<p>__STSR(), 810</p>
<p>IP Alias Lib Functions Builder option, 174, 339</p>
<p>IP Alias Reads Builder option, 174, 338</p>
<p>IP Alias Writes Builder option, 174, 339</p>
<p>IP Constant Globals Builder option, 172, 343</p>
<p>IP Constant Propagation Builder option, 172, 342</p>
<p>IP Constant Returns Builder option, 173, 339</p>
<p>IP Delete Functions Builder option, 171, 344</p>
<p>IP Delete Globals Builder option, 171, 344</p>
<p>IP Limit Inlining Builder option, 173</p>
<p>IP Localize Globals Builder option, 172, 344</p>
<p>IP One-Site Inlining Builder option, 171, 342</p>
<p>IP Remove Parameters Builder option, 173, 343</p>
<p>IP Remove Returns Builder option, 173, 343</p>
<p>IP Small Inlining Builder option, 172, 339</p>
<p>.ipf output file type, 14</p>
<p>.irc file extension, 971</p>
<p>isalnum(), C implementation, 715</p>
<p>isalpha(), C implementation, 715</p>
<p>iscntrl(), C implementation, 715</p>
<p>isdefined .gpj conditional control statement, 967</p>
<p>isdefined linker expression function, 489</p>
<p>islower(), C implementation, 715</p>
<p>ISO/IEC 14882:2003, 736</p>
<p>isprint(), C implementation, 715</p>
<p>istarget .gpj conditional control statement, 967</p>
<p>isundefined .gpj conditional control statement, 967</p>
<p>isupper(), C implementation, 715</p>
<p>isweak linker expression function, 489</p>
<p>ITEMID context sensitive variable, customization file, 998</p>
<p><b>J</b></p>
<p>Japanese Automotive C, 684</p>
<p>builder and driver options for, 684, 685</p>
<p>-japanese_automotive_c driver option, 185, 684, 685</p>
<p>__Japanese_Automotive_C__, 783</p>
<p>jbr instruction, macro expansion for, 456</p>
<p><b>K</b></p>
<p>K &amp; R C</p>
<p>asm statements, 680</p>
<p>const keyword, 680</p>
<p>#defined(id), 680</p>
<p>#elif, 680</p>
<p>#error, 680</p>
<p>extensions, 680</p>
<p>extern storage class specifier, 680</p>
<p>#ident, 680</p>
<p>signed keyword, 680</p>
<p>struct data type, 680</p>
<p>union data type, 680</p>
<p>variable arguments, 692</p>
<p>volatile keyword, 680</p>
<p>-k+r driver option, 184, 662, 679</p>
<p>Kanji, 700</p>
<p>-kanji driver option, 220</p>
<p>Keep GCores Temporary Files Builder option, 267</p>
<p>-keep linker option, 472</p>
<p>--keep_static_symbols driver option, 218</p>
<p>-keepasmfiles driver option, 276</p>
<p>-keepcppfiles driver option, 276</p>
<p>-keepmap driver option, 248</p>
<p>KEEPOBJECTS context sensitive variable, customization</p>
<p>file, 998</p>
<p>-keeptempfiles driver option, 275</p>
<p>-key command line option, 587</p>
<p>Koenig lookup (see argument-dependent lookup)</p>
<p><b>L</b></p>
<p>-L driver option, 79, 162</p>
<p>-l driver option, 79, 162</p>
<p>labels</p>
<p>assembly, 400, 408</p>
<p>-language driver option, 8, 276, 820</p>
<p>__LANGUAGE_ASM__, 783</p>
<p>__LANGUAGE_C__, 783</p>
<p>__LANGUAGE_CXX__, 783, 784</p>
<p>language-independent library, 861</p>
<p>-large_archive driver option, 316</p>
<p>-large_archive librarian option, 521</p>
<p>-large_sda driver option, 138</p>
<p>--large_vtbl_offsets driver option, 226</p>
<p>-large_zda driver option, 139</p>
<p>-layout=ram</p>
<p>locating program sections in ROM and RAM, 90</p>
<p>-layout=romcopy</p>
<p>locating program sections in ROM and RAM, 91, 867</p>
<p>-layout=romrun</p>
<p>locating program sections in ROM and RAM, 90</p>
<p>.lcomm assembler directive, 424</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1054</i></p>
<p><i>intrinsic functions (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.lcp output file type, 14</p>
<p>.ld file extension, 8, 971</p>
<p>(see also linker directives files (.ld))</p>
<p>ld instruction, macro expansion for, 449</p>
<p>__LDSR() intrinsic, 810</p>
<p>less buffered I/O, 823</p>
<p>lib8bit library, 821</p>
<p>libansi library, 821</p>
<p>libarch library, 822</p>
<p>libdbmem library, 821</p>
<p>libece library, 821</p>
<p>libecnoe library, 821</p>
<p>libedge library, 821</p>
<p>libedgnoe library, 821</p>
<p>libeece library, 820</p>
<p>libeecnoe library, 820</p>
<p>libfastmalloc library, 821</p>
<p>libind library, 822</p>
<p>libind.a</p>
<p>functions, 861</p>
<p>language-independent library, 861</p>
<p>libmath library, 822</p>
<p>libmath.a</p>
<p>functions, 848, 855, 859, 860</p>
<p>libmulti library, 822</p>
<p>libmulti.a file, 62</p>
<p>libnoflt library, 821</p>
<p>librarian</p>
<p>command modifiers</p>
<p>c, 519</p>
<p>C, 519</p>
<p>e, 519</p>
<p>m, 519</p>
<p>M, 519</p>
<p>n, 519</p>
<p>o, 519</p>
<p>s, 519</p>
<p>S, 519</p>
<p>u, 519</p>
<p>v, 520</p>
<p>commands</p>
<p>-d, 518</p>
<p>-p, 518</p>
<p>-r, 518</p>
<p>-t, 518</p>
<p>-x, 518</p>
<p>examples, 521</p>
<p>introduction to, xxxi</p>
<p>options</p>
<p>-display_toc, 521</p>
<p>-pecoff, 521</p>
<p>-stderr=errfile, 521</p>
<p>-tmp=dir, 521</p>
<p>overview, 516</p>
<p>syntax, 517</p>
<p>table of contents, creating and updating, 522</p>
<p>librarian options</p>
<p>-auto_large_archive, 521</p>
<p>-large_archive, 521</p>
<p>-no_large_archive, 521</p>
<p>-quiet_auto_large_archive, 521</p>
<p>libraries</p>
<p>creating, 516</p>
<p>creating and using, examples, 521</p>
<p>deleting files from, 518</p>
<p>EC++, 784</p>
<p>incorporating changes, 863</p>
<p>initialization, 879</p>
<p>lib8bit, 821</p>
<p>libansi, 821</p>
<p>libarch, 822</p>
<p>libdbmem, 821</p>
<p>libece, 821</p>
<p>libecnoe, 821</p>
<p>libedge, 821</p>
<p>libedgnoe, 821</p>
<p>libeece, 820</p>
<p>libeecnoe, 820</p>
<p>libfastmalloc, 821</p>
<p>libind, 822</p>
<p>libind.a, 800</p>
<p>libmath, 822</p>
<p>libmulti, 822</p>
<p>libnoflt, 821</p>
<p>libsce, 820</p>
<p>libscnoe, 820</p>
<p>libsedge, 821</p>
<p>libsedgnoe, 821</p>
<p>libstartup, 822</p>
<p>libsys, 822</p>
<p>libutf8, 821</p>
<p>libwc, 821</p>
<p>libwchar, 821</p>
<p>merging, 516</p>
<p>searching, 162</p>
<p>Libraries Builder option, 79, 162</p>
<p>library directories, 820</p>
<p>Library Directories Builder option, 79, 162</p>
<p>library function</p>
<p>alias analysis, 339</p>
<p>libsce library, 820</p>
<p>libscnoe library, 820</p>
<p><i>1055</i></p>
<p><i>Green Hills Software</i></p>
<p><i>.lcp output file type</i></p>
<h1 style="page-break-before:always; "></h1>
<p>libsedge library, 821</p>
<p>libsedgnoe library, 821</p>
<p>libstartup library, 822</p>
<p>libstartup.a library, 499, 867</p>
<p>libstartup.a</p>
<p>functions, 861</p>
<p>libsys library, 822</p>
<p>libsys.a library, 499, 868</p>
<p>libsys.a</p>
<p>system calls, 846</p>
<p>libutf8 library, 821</p>
<p>libwc library, 821</p>
<p>libwchar library, 821</p>
<p>limitations</p>
<p>alignment and size, 886</p>
<p>C compiler, 701</p>
<p>memory optimization, 893</p>
<p>&lt;limits.h&gt; header file, 884</p>
<p>line terminators</p>
<p>in assembler source statements, 401</p>
<p>Line Wrap Messages Builder option, 256</p>
<p>__LINE__, 680, 781</p>
<p>.linfix program section, 926</p>
<p>Link in Minimum Libraries Builder option, 314</p>
<p>Link in Standard Libraries Builder option, 314</p>
<p>Link Mode Builder option, 314</p>
<p>link pointer, 38</p>
<p>for V850 assembler, 434</p>
<p>-link_allow_duplicate_ghs_syms driver option, 242</p>
<p>-link_allow_duplicate_linkonce_syms driver option, 242</p>
<p>--link_filter driver option, 311</p>
<p>Link-Once Template Instantiation Builder option, 227, 746, </p>
<p>749</p>
<p>--link_once_templates driver option, 227, 749</p>
<p>--link_output_mode_linksafe driver option, 315</p>
<p>--link_output_mode_reuse driver option, 314</p>
<p>--link_output_mode_safe driver option, 315</p>
<p>--link_output_mode_unlink driver option, 315</p>
<p>-link_reject_duplicate_lib_syms driver option, 242</p>
<p>Link-Time Global Variable Type Checking Builder option,</p>
<p>251</p>
<p>Link-Time Global Variable Type Qualifiers Builder option,</p>
<p>252</p>
<p>Link-Time Ignore Debug References Builder option, 244</p>
<p>linkage, 758</p>
<p>linker</p>
<p>advanced features, 509</p>
<p>compressed ROM, 492, 495</p>
<p>ELF optional header output, 934</p>
<p>introduction to, xxxii</p>
<p>invoking with the driver, 80</p>
<p>memory maps, 479</p>
<p>(see also linker directives files (.ld))</p>
<p>overview, 470</p>
<p>SDA overflow errors, 104</p>
<p>section maps, 481</p>
<p>ZDA overflow errors, 104</p>
<p>Linker Command File Builder option, 241</p>
<p>Linker Directive Files with Non-standard Extensions Builder</p>
<p>option, 238</p>
<p>Linker Directives Directory Builder option, 313</p>
<p>linker directives files, 80</p>
<p>linker directives files (.ld)</p>
<p>associating with a Project Manager project, 81</p>
<p>Builder and driver options for, 239, 240, 241, 313</p>
<p>customizing run-time sections, 499</p>
<p>defaults</p>
<p>standalone_pic.ld, 91</p>
<p>standalone_picpid.ld, 91</p>
<p>standalone_pid.ld, 91</p>
<p>standalone_ram.ld, 90</p>
<p>standalone_romcopy.ld, 91</p>
<p>standalone_romrun.ld, 90</p>
<p>DEFAULTS directive, 477</p>
<p>directory, specifying, 313</p>
<p>locating program sections in ROM and RAM, 90</p>
<p>maximizing speed, 498</p>
<p>MEMORY directive, 479</p>
<p>memory maps, 479</p>
<p>minimizing RAM usage, 498</p>
<p>OPTION directive, 476</p>
<p>overview, 475</p>
<p>ROM and CROM, 495</p>
<p>SDA and, 101</p>
<p>section attributes, 490</p>
<p>section maps, 481</p>
<p>SECTIONS directive, 481</p>
<p>sections, including and renaming, 484</p>
<p>sections, reserved memory area, 480</p>
<p>specifying options after, 239, 240</p>
<p>specifying options before, 241</p>
<p>using, 9</p>
<p>linker errors</p>
<p>for multiple TDA optimization, 116</p>
<p>for TDA optimization, 109</p>
<p>linker expression functions</p>
<p>absolute, 488</p>
<p>addr, 488</p>
<p>align, 488</p>
<p>alignof, 488</p>
<p>endaddr, 488</p>
<p>error, 488</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1056</i></p>
<p><i>libsedge library</i></p>
<h1 style="page-break-before:always; "></h1>
<p>final, 488</p>
<p>isdefined, 489</p>
<p>isweak, 489</p>
<p>max, 489</p>
<p>memaddr, 489</p>
<p>min, 489</p>
<p>pack_or_align, 489</p>
<p>provide, 489</p>
<p>sizeof, 489</p>
<p>Linker generated tables</p>
<p>__ghstable_tablename, __ghsentry_tablename_entryname,</p>
<p>505</p>
<p>linker</p>
<p>program entry point, 475</p>
<p>Linker Optimizations Builder option, 167, 243</p>
<p>linker options</p>
<p>-allabsolute, 471</p>
<p>-allow_bad_relocations, 471</p>
<p>-any_p_align, 472</p>
<p>-append, 472</p>
<p>-earlyabsolute, 472</p>
<p>-extractall, 472, 506</p>
<p>-extractweak, 472, 506</p>
<p>-help, 472</p>
<p>-Help, 472</p>
<p>-keep, 472</p>
<p>-mapfile_type, 472</p>
<p>-max_p_align=n, 472</p>
<p>-no_append, 473</p>
<p>-no_crom, 473, 496</p>
<p>-no_map_renaming, 473</p>
<p>-no_p_align, 472</p>
<p>-no_uncompressed_copy, 473</p>
<p>-no_xda_modifications, 473</p>
<p>-nosegments_always_executable, 473</p>
<p>-prog2, 473</p>
<p>-retainlocals, 473</p>
<p>-T, 474</p>
<p>-unalign_debug_sections, 474</p>
<p>-underscore, 474</p>
<p>-v, 474</p>
<p>-V, 474</p>
<p>-vimport, 474</p>
<p>-w, 474</p>
<p>-wrapsym, 474</p>
<p>linker raw files, 971</p>
<p>linker section attributes</p>
<p>ABS, 490</p>
<p>ALIGN, 490</p>
<p>AT, 490</p>
<p>CLEAR, 491</p>
<p>CROM, 492, 495</p>
<p>FILL, 491</p>
<p>LOAD, 490</p>
<p>MAX_ENDADDRESS, 491</p>
<p>MAX_SIZE, 491</p>
<p>MIN_ENDADDRESS, 491</p>
<p>MIN_SIZE, 491</p>
<p>NOCHECKSUM, 491</p>
<p>NOCLEAR, 491</p>
<p>NOLOAD, 491</p>
<p>PAD, 492</p>
<p>ROM, 492, 495</p>
<p>ROM_NOCOPY, 492</p>
<p>SHFLAGS, 492</p>
<p>Linker Symbols</p>
<p>__ghsalwaysimport, 506</p>
<p>__ghsautoimport, 506</p>
<p>Linker Warnings Builder option, 237</p>
<p>Linker-Based Far Call Patching Builder option, 94, 142</p>
<p>Linker-Based Move Shortening Builder option, 140</p>
<p>Linker-Based SDA23/ZDA23 Shortening (V850E2V3 and</p>
<p>later) Builder option, 105, 139</p>
<p>--linker_link driver option, 312</p>
<p>-linker_warnings driver option, 237</p>
<p>linking projects, 963</p>
<p>Linking Sections with Different Types Builder option, 315</p>
<p>__linkonce keyword, 668</p>
<p>linkonce keyword, 668</p>
<p>.list assembler directive, 423</p>
<p>-list assembler option, 397</p>
<p>-list command line option, 587</p>
<p>-list driver option, 79, 232</p>
<p>-list_dir driver option, 232</p>
<p>listing format directives, 423</p>
<p>little endian format</p>
<p>V850 and RH850, 26</p>
<p>__LITTLE_ENDIAN__, 786</p>
<p>__littleendian keyword, 687</p>
<p>__LL_BIT, 793</p>
<p>__LL_Is_64, 794</p>
<p>__LLONG_BIT, 786</p>
<p>-lmulti driver option, 62</p>
<p>-lnk driver option, 240</p>
<p>.lnk file extension, 971</p>
<p>-lnk0 driver option, 239</p>
<p>-lnkcmd driver option, 241</p>
<p>LOAD linker section attribute, 490</p>
<p>local scalar variables, 362</p>
<p>-locals_unchanged_by_longjmp driver option, 310</p>
<p>-locatedprogram driver option, 235</p>
<p>long data type</p>
<p><i>1057</i></p>
<p><i>Green Hills Software</i></p>
<p><i>linker expression functions (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>size, 786, 794</p>
<p>long long data type, 214</p>
<p>size, 786, 793, 794</p>
<p>Long Long Support Builder option, 214</p>
<p>__LONG_BIT, 786</p>
<p>__Long_Is_32, 794</p>
<p>__Long_Is_64, 794</p>
<p>--long_long driver option, 214</p>
<p>longjmp() Does Not Restore Local Vars Builder option, 310</p>
<p>loop invariant analysis optimization, 348</p>
<p>loop optimizations, 347</p>
<p>Loop Optimize Specific Functions Builder option, 175, 347, </p>
<p>348, 350</p>
<p>loop rotation optimization, 364</p>
<p>Loop Unrolling Builder option, 292, 347, 351</p>
<p>loop unrolling optimization, 350</p>
<p>.lsbss assembler directive, 424</p>
<p>.lst output file type, 14</p>
<p>..lxtda special symbol, 113</p>
<p><b>M</b></p>
<p>-Ma driver option, 249</p>
<p>machine-specific arithmetic, 891</p>
<p>macro</p>
<p>definition directives, 417</p>
<p>macro assembler, 394</p>
<p>.macro assembler directive, 419</p>
<p>macro expansions</p>
<p>for V850 assembler, 449</p>
<p>macro functions, for .gpj files, 969</p>
<p>macro Top Project directive, 964</p>
<p>macros</p>
<p>defining, 417</p>
<p>_main(), 879, 881, 882</p>
<p>main()</p>
<p>mixing languages, 879</p>
<p>MAKE_DEPEND_OPTIONS context sensitive variable,</p>
<p>customization file, 999</p>
<p>makefiles</p>
<p>and custom run-time environments, 864</p>
<p>dependency information, 22</p>
<p>generating, 591</p>
<p>incremental builds with, 17</p>
<p>individual compiler passes, 19</p>
<p>interprocedural optimizations with, 19</p>
<p>macros for, 17</p>
<p>multiple languages and, 18</p>
<p>using, 17</p>
<p>malloc()</p>
<p>errors related to, 71</p>
<p>memory allocation, 825</p>
<p>malloc(), C implementation, 714</p>
<p>malloc_size DoubleCheck property type, 371</p>
<p>malloced DoubleCheck property type, 371</p>
<p>manual inlining, 325</p>
<p>-Man|-Mna driver option, 249</p>
<p>-map driver option, 248</p>
<p>Map File Cross-Referencing Builder option, 249</p>
<p>Map File Generation Builder option, 248</p>
<p>Map File Page Length Builder option, 248</p>
<p>Map File Retention Builder option, 248</p>
<p>Map File Sorting Builder option, 249</p>
<p>.map output file type, 14</p>
<p>-map_eofn_symbols driver option, 250</p>
<p>-mapfile_type linker option, 472</p>
<p>-maplines driver option, 248</p>
<p>mapping host paths, 58</p>
<p>math.h</p>
<p>functions, 848</p>
<p>max linker expression function, 489</p>
<p>MAX_ENDADDRESS linker section attribute, 491</p>
<p>--max_inlining driver option, 308</p>
<p>--max_inlining_unless_debug driver option, 308</p>
<p>-max_p_align=n linker option, 472</p>
<p>MAX_SIZE linker section attribute, 491</p>
<p>Maximize Optimizations Builder option, 169</p>
<p>Maximum Number of Errors to Display Builder option, 253</p>
<p>.maxinstances assembler directive, 426</p>
<p>.maxstack assembler directive, 426</p>
<p>.mbs file extension, 971</p>
<p>-MD driver option, 23</p>
<p>.mem output file type, 14</p>
<p>memaddr linker expression function, 489</p>
<p>memory</p>
<p>alignment, 688</p>
<p>defining, 479</p>
<p>leaks, finding, 71</p>
<p>optimization</p>
<p>restrictions, 893</p>
<p>problems with size, 895</p>
<p>memory allocation</p>
<p>debugging, 71</p>
<p>disabling, 73</p>
<p>enabling, 73</p>
<p>error checking, 71, 72, 73</p>
<p>malloc(), 825</p>
<p>Memory Allocations window</p>
<p>enabling error-checking from, 73</p>
<p>-memory driver option, 236</p>
<p>MEMORY linker directive, 479</p>
<p>memory maps, 479</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1058</i></p>
<p><i>long data type (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>(see also linker directives files (.ld))</p>
<p>memory optimization, 359</p>
<p>Memory Optimization Builder option, 294, 359, 360, 687, </p>
<p>893, 894</p>
<p>__memory_changed() intrinsic function, 813</p>
<p>memory-mapped I/O, 124</p>
<p>-merge_archive driver option, 12, 516</p>
<p>mevundump utility, 626</p>
<p>-MF driver option, 23</p>
<p>min linker expression function, 489</p>
<p>MIN_ENDADDRESS linker section attribute, 491</p>
<p>MIN_SIZE linker section attribute, 491</p>
<p>-minlib driver option, 314</p>
<p>-misalign_pack driver option, 216</p>
<p>misaligned loads and stores, handling, 32</p>
<p>Misaligned Memory Access Builder option, 216</p>
<p>MISRA C, 684</p>
<p>builder and driver options for, 204, 205, 206, 207, 208, </p>
<p>209, 210, 211, 212, 213</p>
<p>#pragma directives, 806</p>
<p>predefined macros for, 788</p>
<p>MISRA C - Advisory Rules Level Builder option, 203</p>
<p>MISRA C - Required Rules Level Builder option, 203</p>
<p>MISRA C - Run-Time Checks Builder option, 204</p>
<p>MISRA C 1998, 768</p>
<p>builder and driver options for, 204</p>
<p>introduction to, 204</p>
<p>MISRA C 1998 Rules - Character Set Builder option, 205</p>
<p>MISRA C 1998 Rules - Comments Builder option, 205</p>
<p>MISRA C 1998 Rules - Constants Builder option, 206</p>
<p>MISRA C 1998 Rules - Control Flow Builder option, 209</p>
<p>MISRA C 1998 Rules - Conversions Builder option, 208</p>
<p>MISRA C 1998 Rules - Declarations and Definitions Builder</p>
<p>option, 207</p>
<p>MISRA C 1998 Rules - Environment Builder option, 204</p>
<p>MISRA C 1998 Rules - Expressions Builder option, 208</p>
<p>MISRA C 1998 Rules - Functions Builder option, 209</p>
<p>MISRA C 1998 Rules - Identifiers Builder option, 206</p>
<p>MISRA C 1998 Rules - Initialization Builder option, 207</p>
<p>MISRA C 1998 Rules - Operators Builder option, 207</p>
<p>MISRA C 1998 Rules - Pointers and Arrays Builder option,</p>
<p>211</p>
<p>MISRA C 1998 Rules - Preprocessor Builder option, 210</p>
<p>MISRA C 1998 Rules - Standard Library Builder option,</p>
<p>212</p>
<p>MISRA C 1998 Rules - Structs and Unions Builder option,</p>
<p>212</p>
<p>MISRA C 1998 Rules - Types Builder option, 206</p>
<p>MISRA C 2004</p>
<p>builder and driver options for, 771</p>
<p>introduction to, 771</p>
<p>switch statements, 773</p>
<p>MISRA C 2004 Rules - 1 Environment Builder option, 187</p>
<p>MISRA C 2004 Rules - 10 Arithmetic Type Conversions</p>
<p>Builder option, 193</p>
<p>MISRA C 2004 Rules - 11 Pointer Type Conversions Builder</p>
<p>option, 193</p>
<p>MISRA C 2004 Rules - 12 Expressions Builder option, 194</p>
<p>MISRA C 2004 Rules - 13 Control Statement Expressions</p>
<p>Builder option, 195</p>
<p>MISRA C 2004 Rules - 14 Control Flow Builder option, 196</p>
<p>MISRA C 2004 Rules - 15 Switch Statements Builder option,</p>
<p>197</p>
<p>MISRA C 2004 Rules - 16 Functions Builder option, 198</p>
<p>MISRA C 2004 Rules - 17 Pointers and Arrays Builder</p>
<p>option, 199</p>
<p>MISRA C 2004 Rules - 18 Structs and Unions Builder option,</p>
<p>199</p>
<p>MISRA C 2004 Rules - 19 Preprocessing Directives Builder</p>
<p>option, 200</p>
<p>MISRA C 2004 Rules - 2 Language Extensions Builder</p>
<p>option, 188</p>
<p>MISRA C 2004 Rules - 20 Standard Libraries Builder option,</p>
<p>202</p>
<p>MISRA C 2004 Rules - 21 Run-time Failures Builder option,</p>
<p>203</p>
<p>MISRA C 2004 Rules - 3 Documentation Builder option,</p>
<p>188</p>
<p>MISRA C 2004 Rules - 4 Character Sets Builder option, 189</p>
<p>MISRA C 2004 Rules - 5 Identifiers Builder option, 189</p>
<p>MISRA C 2004 Rules - 6 Types Builder option, 190</p>
<p>MISRA C 2004 Rules - 7 Constants Builder option, 191</p>
<p>MISRA C 2004 Rules - 8 Declarations and Definitions</p>
<p>Builder option, 191</p>
<p>MISRA C 2004 Rules - 9 Initialization Builder option, 192</p>
<p>--misra_2004=1.1 driver option, 187</p>
<p>--misra_2004=1.2 driver option, 188</p>
<p>--misra_2004=1.3 driver option, 188</p>
<p>--misra_2004=1.4 driver option, 188</p>
<p>--misra_2004=1.5 driver option, 188</p>
<p>--misra_2004=10.1 driver option, 193</p>
<p>--misra_2004=10.2 driver option, 193</p>
<p>--misra_2004=10.3 driver option, 193</p>
<p>--misra_2004=10.4 driver option, 193</p>
<p>--misra_2004=10.5 driver option, 193</p>
<p>--misra_2004=10.6 driver option, 193</p>
<p>--misra_2004=11.1 driver option, 193</p>
<p>--misra_2004=11.2 driver option, 194</p>
<p>--misra_2004=11.3 driver option, 194</p>
<p>--misra_2004=11.4 driver option, 194</p>
<p>--misra_2004=11.5 driver option, 194</p>
<p>--misra_2004=12.1 driver option, 194</p>
<p><i>1059</i></p>
<p><i>Green Hills Software</i></p>
<p><i>memory optimization</i></p>
<h1 style="page-break-before:always; "></h1>
<p>--misra_2004=12.10 driver option, 195</p>
<p>--misra_2004=12.11 driver option, 195</p>
<p>--misra_2004=12.12 driver option, 195</p>
<p>--misra_2004=12.13 driver option, 195</p>
<p>--misra_2004=12.2 driver option, 194</p>
<p>--misra_2004=12.3 driver option, 194</p>
<p>--misra_2004=12.4 driver option, 194</p>
<p>--misra_2004=12.5 driver option, 194</p>
<p>--misra_2004=12.6 driver option, 194</p>
<p>--misra_2004=12.7 driver option, 195</p>
<p>--misra_2004=12.8 driver option, 195</p>
<p>--misra_2004=12.9 driver option, 195</p>
<p>--misra_2004=13.1 driver option, 195</p>
<p>--misra_2004=13.2 driver option, 196</p>
<p>--misra_2004=13.3 driver option, 196</p>
<p>--misra_2004=13.4 driver option, 196</p>
<p>--misra_2004=13.5 driver option, 196</p>
<p>--misra_2004=13.6 driver option, 196</p>
<p>--misra_2004=13.7 driver option, 196</p>
<p>--misra_2004=14.1 driver option, 196</p>
<p>--misra_2004=14.10 driver option, 197</p>
<p>--misra_2004=14.2 driver option, 196</p>
<p>--misra_2004=14.3 driver option, 196</p>
<p>--misra_2004=14.4 driver option, 196</p>
<p>--misra_2004=14.5 driver option, 197</p>
<p>--misra_2004=14.6 driver option, 197</p>
<p>--misra_2004=14.7 driver option, 197</p>
<p>--misra_2004=14.8 driver option, 197</p>
<p>--misra_2004=14.9 driver option, 197</p>
<p>--misra_2004=15.1 driver option, 197</p>
<p>--misra_2004=15.2 driver option, 197</p>
<p>--misra_2004=15.3 driver option, 197</p>
<p>--misra_2004=15.4 driver option, 198</p>
<p>--misra_2004=15.5 driver option, 198</p>
<p>--misra_2004=16.1 driver option, 198</p>
<p>--misra_2004=16.10 driver option, 199</p>
<p>--misra_2004=16.2 driver option, 198</p>
<p>--misra_2004=16.3 driver option, 198</p>
<p>--misra_2004=16.4 driver option, 198</p>
<p>--misra_2004=16.5 driver option, 198</p>
<p>--misra_2004=16.6 driver option, 198</p>
<p>--misra_2004=16.7 driver option, 198</p>
<p>--misra_2004=16.8 driver option, 199</p>
<p>--misra_2004=16.9 driver option, 199</p>
<p>--misra_2004=17.1 driver option, 199</p>
<p>--misra_2004=17.2 driver option, 199</p>
<p>--misra_2004=17.3 driver option, 199</p>
<p>--misra_2004=17.4 driver option, 199</p>
<p>--misra_2004=17.5 driver option, 199</p>
<p>--misra_2004=17.6 driver option, 199</p>
<p>--misra_2004=18.1 driver option, 199</p>
<p>--misra_2004=18.2 driver option, 200</p>
<p>--misra_2004=18.3 driver option, 200</p>
<p>--misra_2004=18.4 driver option, 200</p>
<p>--misra_2004=19.1 driver option, 200</p>
<p>--misra_2004=19.10 driver option, 201</p>
<p>--misra_2004=19.11 driver option, 201</p>
<p>--misra_2004=19.12 driver option, 201</p>
<p>--misra_2004=19.13 driver option, 201</p>
<p>--misra_2004=19.14 driver option, 201</p>
<p>--misra_2004=19.15 driver option, 201</p>
<p>--misra_2004=19.16 driver option, 201</p>
<p>--misra_2004=19.17 driver option, 202</p>
<p>--misra_2004=19.2 driver option, 200</p>
<p>--misra_2004=19.3 driver option, 200</p>
<p>--misra_2004=19.4 driver option, 200</p>
<p>--misra_2004=19.5 driver option, 200</p>
<p>--misra_2004=19.6 driver option, 200</p>
<p>--misra_2004=19.7 driver option, 200</p>
<p>--misra_2004=19.8 driver option, 201</p>
<p>--misra_2004=19.9 driver option, 201</p>
<p>--misra_2004=2.1 driver option, 188</p>
<p>--misra_2004=2.2 driver option, 188</p>
<p>--misra_2004=2.3 driver option, 188</p>
<p>--misra_2004=2.4 driver option, 188</p>
<p>--misra_2004=20.1 driver option, 202</p>
<p>--misra_2004=20.10 driver option, 202</p>
<p>--misra_2004=20.11 driver option, 203</p>
<p>--misra_2004=20.12 driver option, 203</p>
<p>--misra_2004=20.2 driver option, 202</p>
<p>--misra_2004=20.3 driver option, 202</p>
<p>--misra_2004=20.4 driver option, 202</p>
<p>--misra_2004=20.5 driver option, 202</p>
<p>--misra_2004=20.6 driver option, 202</p>
<p>--misra_2004=20.7 driver option, 202</p>
<p>--misra_2004=20.8 driver option, 202</p>
<p>--misra_2004=20.9 driver option, 202</p>
<p>--misra_2004=21.1 driver option, 203</p>
<p>--misra_2004=3.1 driver option, 188</p>
<p>--misra_2004=3.2 driver option, 189</p>
<p>--misra_2004=3.3 driver option, 189</p>
<p>--misra_2004=3.4 driver option, 189</p>
<p>--misra_2004=3.5 driver option, 189</p>
<p>--misra_2004=3.6 driver option, 189</p>
<p>--misra_2004=4.1 driver option, 189</p>
<p>--misra_2004=4.2 driver option, 189</p>
<p>--misra_2004=5.1 driver option, 189</p>
<p>--misra_2004=5.2 driver option, 189</p>
<p>--misra_2004=5.3 driver option, 190</p>
<p>--misra_2004=5.4 driver option, 190</p>
<p>--misra_2004=5.5 driver option, 190</p>
<p>--misra_2004=5.6 driver option, 190</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1060</i></p>
<p><i>--misra_2004=12.10 driver option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>--misra_2004=5.7 driver option, 190</p>
<p>--misra_2004=6.1 driver option, 190</p>
<p>--misra_2004=6.2 driver option, 190</p>
<p>--misra_2004=6.3 driver option, 190</p>
<p>--misra_2004=6.4 driver option, 190</p>
<p>--misra_2004=6.5 driver option, 191</p>
<p>--misra_2004=7.1 driver option, 191</p>
<p>--misra_2004=8.1 driver option, 191</p>
<p>--misra_2004=8.10 driver option, 192</p>
<p>--misra_2004=8.11 driver option, 192</p>
<p>--misra_2004=8.12 driver option, 192</p>
<p>--misra_2004=8.2 driver option, 191</p>
<p>--misra_2004=8.3 driver option, 191</p>
<p>--misra_2004=8.4 driver option, 191</p>
<p>--misra_2004=8.5 driver option, 191</p>
<p>--misra_2004=8.6 driver option, 191</p>
<p>--misra_2004=8.7 driver option, 192</p>
<p>--misra_2004=8.8 driver option, 192</p>
<p>--misra_2004=8.9 driver option, 192</p>
<p>--misra_2004=9.1 driver option, 192</p>
<p>--misra_2004=9.2 driver option, 192</p>
<p>--misra_2004=9.3 driver option, 192</p>
<p>--misra_adv=error driver option, 203</p>
<p>--misra_adv=silent driver option, 203</p>
<p>--misra_adv=warn driver option, 203</p>
<p>__MISRA_i, 788</p>
<p>--misra_req=error driver option, 203</p>
<p>--misra_req=silent driver option, 203</p>
<p>--misra_req=warn driver option, 203</p>
<p>--misra_runtime driver option, 204</p>
<p>mixed language executable, 878</p>
<p>-Ml driver option, 250</p>
<p>-MMD driver option, 23</p>
<p>-Mn driver option, 249</p>
<p>.mon output file type, 13</p>
<p>Motor Industry Software Reliability Association C Rules</p>
<p>(see MISRA C)</p>
<p>mov instruction, macro expansion for, 450</p>
<p>movea instruction, macro expansion for, 454</p>
<p>__msw, 793</p>
<p>-mtda driver option, 110, 138</p>
<p>-Mu driver option, 249</p>
<p>__MULSH() intrinsic function, 812</p>
<p>MULTI</p>
<p>document set, xxvi</p>
<p>MULTI Debugging Level, 62</p>
<p>MULTI for Eclipse</p>
<p>building projects, 1014</p>
<p>compiler options, changing, 1013</p>
<p>connecting with setup scripts, 1016</p>
<p>creating projects in, 1009</p>
<p>debugging projects, 1016</p>
<p>installing, 1008</p>
<p>INTEGRITY projects in, 1010</p>
<p>overview, 1006</p>
<p>prerequisites for installing, 1007</p>
<p>running projects, 1014</p>
<p>source files, adding to project, 1013</p>
<p>multi-byte characters, 698</p>
<p>Multicore Configuration File Builder option, 302</p>
<p>Multicore Core Count Builder option, 303</p>
<p>-multiple driver option, 245</p>
<p>multiple TDA optimization, 110</p>
<p>and assembly language programming, 116</p>
<p>export-TDA functions, 111, 112, 114</p>
<p>linker errors for, 116</p>
<p>named-TDA functions, 111, 112, 113, 114</p>
<p>no-TDA functions, 111, 112, 114, 115</p>
<p>#pragma directive and, 110, 112</p>
<p>special symbols for, 113</p>
<p>multiple-section programs, 83</p>
<p>Multiply-Defined Symbols Builder option, 245</p>
<p>__MULUH() intrinsic function, 812</p>
<p>--munch driver option, 312</p>
<p>-mute_eagle_signal driver option, 297</p>
<p>-mute_entry_exit_history driver option, 176</p>
<p>-Mx driver option, 249</p>
<p><b>N</b></p>
<p>name lookup</p>
<p>template instantiation, 756</p>
<p>name mangling, 759, 760</p>
<p>named labels, 408</p>
<p>named-TDA functions, 111, 112, 113, 114, 116</p>
<p>namespace support</p>
<p>argument dependent lookup, 758</p>
<p>dependent name lookup, 756</p>
<p>lookup using the reference context, 757</p>
<p>Namespace Support Builder option, 220, 756</p>
<p>namespaces, 756</p>
<p>predefined macro for, 792</p>
<p>std, 792</p>
<p>template instantiation, and, 756</p>
<p>__NAMESPACES, 792</p>
<p>--namespaces driver option, 220</p>
<p>NaN Compares as Unordered Builder option, 134</p>
<p>near and far function calls, 93</p>
<p>near function calls, 93</p>
<p>__nearcall, 95</p>
<p>.need assembler directive, 428</p>
<p>needs_null_check DoubleCheck property type, 370</p>
<p><i>1061</i></p>
<p><i>Green Hills Software</i></p>
<p><i>--misra_2004=5.7 driver option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>new</p>
<p>array, predefined macro, 792</p>
<p>-new_assembler driver option, 319</p>
<p>--new_inside_of_constructor driver option, 224</p>
<p>--new_outside_of_constructor driver option, 224</p>
<p>New-Style Cast Support Builder option, 223</p>
<p>--new_style_casts driver option, 223</p>
<p>nm utility, 760</p>
<p>-no_64bit_load_store driver option, 157</p>
<p>--no_additional_output driver option, 236</p>
<p>-no_additional_sda_common driver option, 271</p>
<p>-no_alloc_shared_mem driver option, 267</p>
<p>-no_allocate_ep driver option, 152</p>
<p>-no_allow_1bit_volatile_any_basetype driver option, 153</p>
<p>-no_allow_cxx_duplicates driver option, 317</p>
<p>--no_allow_different_section_types driver option, 315</p>
<p>-no_allow_linkonce_duplicates driver option, 317</p>
<p>-no_allow_overlap driver option, 266</p>
<p>--no_alternative_tokens driver option, 218</p>
<p>-no_ansi_alias driver option, 187</p>
<p>--no_any_output_suffix driver option, 277</p>
<p>-no_append linker option, 473</p>
<p>--no_assembler_warnings driver option, 313</p>
<p>--no_auto_type driver option, 223</p>
<p>--no_bool driver option, 221</p>
<p>--no_brief_diagnostics driver option, 256</p>
<p>--no_c_and_cpp_functions_are_distinct driver option, 312</p>
<p>-no_callt driver option, 40, 151</p>
<p>-no_check_rh850_abi_flags driver option, 158</p>
<p>-no_codefactor driver option, 244</p>
<p>--no_comments driver option, 307</p>
<p>--no_commons driver option, 82, 87, 89, 217</p>
<p>--no_coverage_analysis driver option, 302</p>
<p>-no_crom linker option, 473, 496</p>
<p>--no_debug driver option, 176</p>
<p>--no_defer_parse_function_templates driver option, 231</p>
<p>-no_delete driver option, 243</p>
<p>--no_dep_name driver option, 230</p>
<p>-no_discard_zero_initializers driver option, 142</p>
<p>--no_display_error_number driver option, 261</p>
<p>-no_divq driver option, 154</p>
<p>-no_dual_debug driver option, 304</p>
<p>-no_dwarf2dbo driver option, 305</p>
<p>-no_error_basename driver option, 256</p>
<p>-no_event_logging driver option, 159</p>
<p>--no_exceptions driver option, 186</p>
<p>--no_export driver option, 230</p>
<p>-no_extend_liveness driver option, 299</p>
<p>-no_fast_malloc driver option, 150</p>
<p>-no_float_associativity driver option, 134</p>
<p>-no_float_scanf driver option, 313</p>
<p>-no_full_breakdots driver option, 298</p>
<p>-no_full_debug_info driver option, 304</p>
<p>-no_gen_entry_exit_arg_history driver option, 296</p>
<p>-no_gen_entry_exit_history driver option, 296</p>
<p>-no_globalcheck_qualifiers driver option, 252</p>
<p>-no_gsize driver option, 250</p>
<p>--no_guiding_decls driver option, 227</p>
<p>-no_host64 driver option, 289</p>
<p>-no_ignore_callt_state_in_interrupts driver option, 151</p>
<p>-no_ignore_debug_references driver option, 244</p>
<p>--no_implicit_extern_c_type_conversion driver option, 312</p>
<p>--no_implicit_include driver option, 228, 753</p>
<p>--no_implicit_typename driver option, 228</p>
<p>-no_individual_attribute_data_sections driver option, 147</p>
<p>-no_individual_attribute_function_sections driver option,</p>
<p>149</p>
<p>-no_individual_data_sections driver option, 146</p>
<p>-no_individual_function_sections driver option, 148</p>
<p>-no_individual_pragma_data_sections driver option, 147</p>
<p>-no_individual_pragma_function_sections driver option, 149</p>
<p>-no_init_ram_at_startup driver option, 271</p>
<p>-no_inline_prologue driver option, 272</p>
<p>--no_inline_tiny_functions driver option, 290</p>
<p>--no_inlining driver option, 308</p>
<p>--no_instantiate_extern_inline driver option, 223</p>
<p>-no_japanese_automotive_c driver option, 185</p>
<p>--no_keep_static_symbols driver option, 218</p>
<p>-no_large_archive driver option, 316</p>
<p>-no_large_archive librarian option, 521</p>
<p>-no_large_sda driver option, 139</p>
<p>--no_large_vtbl_offsets driver option, 226</p>
<p>-no_large_zda driver option, 139</p>
<p>-no_link_allow_duplicate_ghs_syms driver option, 242</p>
<p>-no_link_allow_duplicate_linkonce_syms driver option, 242</p>
<p>--no_link_filter driver option, 311</p>
<p>--no_link_once_templates driver option, 227, 746</p>
<p>-no_link_reject_duplicate_lib_syms driver option, 242</p>
<p>-no_linker_warnings driver option, 237</p>
<p>-no_list driver option, 232</p>
<p>-no_locals_unchanged_by_longjmp driver option, 310</p>
<p>--no_long_long driver option, 214</p>
<p>-no_map_eofn_symbols driver option, 250</p>
<p>-no_map_renaming linker option, 473</p>
<p>-no_misalign_pack driver option, 216</p>
<p>--no_misra_runtime driver option, 204</p>
<p>-no_multiple driver option, 245</p>
<p>--no_namespaces driver option, 220, 756</p>
<p>--no_new_style_casts driver option, 223</p>
<p>--no_old_specializations driver option, 228</p>
<p>--no_one_instantiation_per_object driver option, 229</p>
<p>-no_p_align linker option, 472</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1062</i></p>
<p><i>new</i></p>
<h1 style="page-break-before:always; "></h1>
<p>--no_parse_templates driver option, 230</p>
<p>-no_precise_signed_zero driver option, 135</p>
<p>-no_precise_signed_zero_compare driver option, 135</p>
<p>-no_prepare_dispose driver option, 152</p>
<p>-no_preprocess_assembly_files driver option, 232</p>
<p>--no_preprocess_linker_directive driver option, 237</p>
<p>-no_preprocess_special_assembly_files driver option, 233</p>
<p>-no_push_pop driver option, 152</p>
<p>--no_quit_after_warnings driver option, 254</p>
<p>--no_range_based_for driver option, 221</p>
<p>--no_readonly_typeinfo driver option, 225</p>
<p>--no_readonly_virtual_tables driver option, 226</p>
<p>-no_recipf driver option, 154</p>
<p>-no_reject_duplicates driver option, 317</p>
<p>--no_remarks driver option, 253</p>
<p>--no_restrict driver option, 222</p>
<p>no_return DoubleCheck property type, 372</p>
<p>no_return_when_non_zero DoubleCheck property type, 372</p>
<p>no_return_when_zero DoubleCheck property type, 372</p>
<p>-no_rh850_1bit driver option, 154</p>
<p>-no_rh850_4bytewordoffset driver option, 156</p>
<p>-no_rh850_eint_erratum driver option, 156</p>
<p>-no_rh850_simd driver option, 155</p>
<p>-no_rh850_trace_loads driver option, 153</p>
<p>-no_rosda driver option, 130</p>
<p>-no_rosda_is_zda driver option, 140</p>
<p>--no_rtti driver option, 225</p>
<p>--no_scan_source driver option, 300</p>
<p>-no_search_for_dba driver option, 300</p>
<p>-no_shared_libs driver option, 267</p>
<p>--no_short_enum driver option, 214, 684</p>
<p>-no_shorten_loads driver option, 139</p>
<p>-no_shorten_moves driver option, 140</p>
<p>--no_slash_comment driver option, 186</p>
<p>-no_smaller_bitops driver option, 153</p>
<p>-no_split_data_sections_by_alignment driver option, 145</p>
<p>-no_stabs2dbo driver option, 305</p>
<p>-no_stack_check driver option, 143</p>
<p>-no_stack_protector driver option, 143</p>
<p>--no_switch_table driver option, 272</p>
<p>no-TDA functions, 111, 112, 114, 115, 116</p>
<p>-no_timer_profile driver option, 178</p>
<p>--no_trace_includes driver option, 183</p>
<p>-no_uncompressed_copy linker option, 473</p>
<p>-no_undefined driver option, 245</p>
<p>--no_unique_strings driver option, 217</p>
<p>--no_unsafe_predefines driver option, 306</p>
<p>--no_using_std driver option, 220</p>
<p>-no_v800_old_callt driver option, 151</p>
<p>-no_v850_isr_save_eiic driver option, 156</p>
<p>-no_v850_isr_save_r4r5 driver option, 155</p>
<p>--no_version driver option, 254</p>
<p>-no_version_info driver option, 254</p>
<p>--no_vla driver option, 218</p>
<p>--no-whole-archive driver option, 241</p>
<p>--no_wrap_diagnostics driver option, 256</p>
<p>-no_xda_modifications linker option, 473</p>
<p>-no_zero_commons driver option, 140</p>
<p>-noasm3g driver option, 234</p>
<p>-noautoregister driver option, 293, 363</p>
<p>-nobigswitch driver option, 272</p>
<p>nobuild .gpj conditional control statement, 967</p>
<p>-nochecksum driver option, 251</p>
<p>NOCHECKSUM linker section attribute, 491</p>
<p>NOCLEAR</p>
<p>linker section attribute, 491</p>
<p>-noconsistentcode driver option, 298</p>
<p>--nocpp driver option, 312</p>
<p>.nodebug assembler directive, 426</p>
<p>:nodepends Builder option, 279</p>
<p>-noentry driver option, 237</p>
<p>-noexpandbranch assembler option, 396</p>
<p>-nofarcallpatch driver option, 94, 142</p>
<p>-nofarcalls driver option, 141</p>
<p>__NoFloat__, 788</p>
<p>-nofloatio driver option, 136</p>
<p>-nofloatsingle driver option, 133</p>
<p>-nofpu assembler option, 396</p>
<p>-nofpu_double assembler option, 396</p>
<p>-nofpu30 assembler option, 396</p>
<p>-noga driver option, 300</p>
<p>.nogen assembler directive, 423</p>
<p>-noglimits driver option, 298</p>
<p>-nogtws driver option, 297</p>
<p>-noidentoutput driver option, 311</p>
<p>__noinline, 336</p>
<p>noinline GNU attribute, 723</p>
<p>-nokeepasmfiles driver option, 276</p>
<p>-nokeepcppfiles driver option, 276</p>
<p>-nokeepmap driver option, 248</p>
<p>-nokeeptempfiles driver option, 275</p>
<p>.nolist assembler directive, 423</p>
<p>NOLOAD linker section attribute, 491</p>
<p>-nomacro assembler option, 396</p>
<p>-nomap driver option, 248</p>
<p>-nominlib driver option, 314</p>
<p>non-local static objects, 759</p>
<p>non-portable features, 883</p>
<p>Non-Standard Output Suffix Builder option, 277</p>
<p>nonnull GNU attribute, 723</p>
<p>-noobj driver option, 274</p>
<p>-nooverlap driver option, 251</p>
<p><i>1063</i></p>
<p><i>Green Hills Software</i></p>
<p><i>--no_parse_templates driver option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-nooverload driver option, 292, 362</p>
<p>-nopasssource driver option, 233</p>
<p>-nopic driver option, 141</p>
<p>-nopid driver option, 141</p>
<p>-nor20has255 driver option, 130</p>
<p>-nor21has65535 driver option, 131</p>
<p>-noreserve_r2 driver option, 129</p>
<p>-noreserve_r5 driver option, 129</p>
<p>noreturn GNU attribute, 723</p>
<p>-norh850_simd assembler option, 396</p>
<p>-nosegments_always_executable linker option, 473</p>
<p>:noSelfdepend Builder option, 279</p>
<p>-noshortbranches assembler option, 396</p>
<p>-nostartfiles driver option, 244</p>
<p>-nostddef driver option, 306</p>
<p>-nostdinc driver option, 307</p>
<p>-nostdlib driver option, 314, 822</p>
<p>-nostrip driver option, 236</p>
<p>not instruction, macro expansion for, 452</p>
<p>-notda driver option, 138, 152</p>
<p>.note assembler directive, 421</p>
<p>-nothreshold driver option, 137</p>
<p>nothrow GNU attribute, 723</p>
<p>-nouninstall command line option, 587</p>
<p>.nowarning assembler directive, 423</p>
<p>NULL pointer</p>
<p>size of, 889</p>
<p>numeric constants, 399</p>
<p><b>O</b></p>
<p>-o assembler option, 397</p>
<p>-o driver option, 11, 122, 163, 265</p>
<p>-O driver option, 166</p>
<p>.o file extension, 8, 971</p>
<p>-o HTML compiler option, 320</p>
<p>-OB driver option, 169, 331</p>
<p>-obj driver option, 274</p>
<p>Object File Output Directory Builder option, 160, 229</p>
<p>object files</p>
<p>ELF format, 914, 928</p>
<p>-object_dir driver option, 160</p>
<p>OBJECTBASE context sensitive variable, customization</p>
<p>file, 999</p>
<p>OBJECTS context sensitive variable, customization file, 999</p>
<p>OBJECTSUFFIX context sensitive variable, customization</p>
<p>file, 999</p>
<p>obtaining profiling information</p>
<p>debugging information, 63</p>
<p>-Oconstprop driver option, 293, 358</p>
<p>-Ocse driver option, 293, 356</p>
<p>-Odebug driver option, 165, 352</p>
<p>-Oexplodejumps driver option, 292</p>
<p>.offset assembler directive, 414</p>
<p>-Ogeneral driver option, 166, 352</p>
<p>-OI driver option, 167, 175, 329</p>
<p>-Oinline_constant_math driver option, 290, 337</p>
<p>-Ointerproc driver option, 168, 338, 346</p>
<p>-Oip_analysis_only driver option, 168</p>
<p>-Oipaliaslibfuncs driver option, 174</p>
<p>-Oipaliasreads driver option, 174</p>
<p>-Oipaliaswrites driver option, 174</p>
<p>-Oipconstantreturns driver option, 173</p>
<p>-Oipconstglobals driver option, 172</p>
<p>-Oipconstprop driver option, 172</p>
<p>-Oipdeletefunctions driver option, 171</p>
<p>-Oipdeleteglobals driver option, 171</p>
<p>-Oiplimitinlining driver option, 173</p>
<p>-Oiplocalizeglobals driver option, 172</p>
<p>-Oiponesiteinlining driver option, 171, 342</p>
<p>-Oipremoveparams driver option, 173</p>
<p>-Oipremovereturns driver option, 173</p>
<p>-Oipsmallinlining driver option, 172</p>
<p>-OL driver option, 175, 294, 347, 894</p>
<p>-old_assembler driver option, 319</p>
<p>--old_specializations driver option, 228</p>
<p>-Olimit driver option, 352, 353</p>
<p>-Olimit=peephole driver option, 169</p>
<p>-Olimit=pipeline driver option, 169</p>
<p>-Olink driver option, 167</p>
<p>-OM driver option, 294, 359, 687, 893, 894</p>
<p>-Omax driver option, 169</p>
<p>-Omaxdebug driver option, 165</p>
<p>-Omemclr driver option, 291</p>
<p>-Omemfuncs driver option, 290, 333</p>
<p>-Ominmax driver option, 294, 359</p>
<p>-Omoredebug driver option, 165, 352</p>
<p>one instantiation per object, 748</p>
<p>One Instantiation Per Object Builder option, 228, 229, 749</p>
<p>--one_instantiation_per_object driver option, 749</p>
<p>__ONLY_STANDARD_KEYWORDS_IN_C, 788</p>
<p>-Ono_inline_constant_math driver option, 290, 337</p>
<p>-Onobig driver option, 169</p>
<p>-Onoconstprop driver option, 293, 358</p>
<p>-Onocse driver option, 293, 356</p>
<p>-Onoexplodejumps driver option, 292</p>
<p>-Onoinline driver option, 167, 329</p>
<p>-Onoipa driver option, 168, 345</p>
<p>-Onoipaliaslibfuncs driver option, 174, 339</p>
<p>-Onoipaliasreads driver option, 174, 338</p>
<p>-Onoipaliaswrites driver option, 174, 339</p>
<p>-Onoipconstantreturns driver option, 173, 339</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1064</i></p>
<p><i>-nooverload driver option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>-Onoipconstglobals driver option, 172, 343</p>
<p>-Onoipconstprop driver option, 172, 342</p>
<p>-Onoipdeletefunctions driver option, 171, 344</p>
<p>-Onoipdeleteglobals driver option, 171, 344</p>
<p>-Onoiplimitinlining driver option, 173</p>
<p>-Onoiplocalizeglobals driver option, 172, 344</p>
<p>-Onoiponesiteinlining driver option, 171, 342</p>
<p>-Onoipremoveparams driver option, 173, 343</p>
<p>-Onoipremovereturns driver option, 173, 343</p>
<p>-Onoipsmallinlining driver option, 172, 339</p>
<p>-Onolink driver option, 167</p>
<p>-Onoloop driver option, 294, 347</p>
<p>-Onomax driver option, 169</p>
<p>-Onomemclr driver option, 291</p>
<p>-Onomemfuncs driver option, 290, 333</p>
<p>-Onomemory driver option, 294, 359, 894</p>
<p>-Onominmax driver option, 294, 359</p>
<p>-Onone driver option, 166</p>
<p>-Onopeephole driver option, 295, 352</p>
<p>-Onopipeline driver option, 295, 353</p>
<p>-Onoprintfuncs driver option, 291</p>
<p>-Onostrfuncs driver option, 291</p>
<p>-Onotailrecursion driver option, 293, 357</p>
<p>-Onounroll driver option, 292, 347, 351</p>
<p>-Onounrollbig driver option, 169</p>
<p>-Opeep driver option, 295, 352</p>
<p>operating system dependencies, 890</p>
<p>operator field, 401</p>
<p>operator</p>
<p>delete[], 792</p>
<p>new[], 792</p>
<p>operators</p>
<p>integral expression, 402</p>
<p>precedence, 403</p>
<p>type combinations and, 407</p>
<p>-Opipeline driver option, 295, 353</p>
<p>-Oprintfuncs driver option, 291</p>
<p>optgroup=option_group .gpj conditional control statement,</p>
<p>968</p>
<p>optimization</p>
<p>multiple TDA, 110</p>
<p>TDA, 107</p>
<p>Optimization Strategy Builder option, 165, 170, 175, 289, </p>
<p>290, 324, 336, 347, 352, 353, 356, 357, 358, 359, 360, </p>
<p>361, 362, 687, 808, 894</p>
<p>optimizations</p>
<p>automatic inlining, 325</p>
<p>automatic register allocation, 363</p>
<p>automatic two-pass inlining, 329</p>
<p>Builder and driver options for, 167, 169, 170, 175</p>
<p>C/C++ minimum/maximum, 359</p>
<p>code factoring, 509</p>
<p>common subexpression elimination, 356</p>
<p>constant folding, 364</p>
<p>constant propagation, 358</p>
<p>dead code elimination, 360</p>
<p>default, 362</p>
<p>general, 324, 352</p>
<p>inlining, 324</p>
<p>inlining advantages, 332</p>
<p>inlining C memory functions, 333</p>
<p>inlining C string functions, 333</p>
<p>inlining constant math functions, 336</p>
<p>inlining specific functions, 329</p>
<p>loop, 347</p>
<p>loop invariant analysis, 348</p>
<p>loop rotation, 364</p>
<p>loop unrolling, 350</p>
<p>manual inlining, 325</p>
<p>memory, 359</p>
<p>partial redundancy elimination optimization, 356</p>
<p>peephole, 352</p>
<p>pipeline instruction scheduling, 353</p>
<p>portability and, 892</p>
<p>register allocation by coloring, 362</p>
<p>register coalescing, 363</p>
<p>single-pass inlining, 328</p>
<p>small data area, 96</p>
<p>static address elimination, 361</p>
<p>strength reduction, 348</p>
<p>tail calls, 357</p>
<p>two-pass inlining, 328</p>
<p>varying inlining thresholds, 331</p>
<p>zero data area, 97</p>
<p>Optimize Accesses to Adjacent Bitfields Builder option, 153</p>
<p>Optimize All Appropriate Loops Builder option, 294, 347, </p>
<p>348, 350, 894</p>
<p>Optimize Specific Functions for Size Builder option, 175</p>
<p>Optimize Specific Functions for Speed Builder option, 174</p>
<p>optimizing compilers, xxx</p>
<p>--option driver option, 319</p>
<p>OPTION linker directive, 476</p>
<p>%option_value(option_name) .gpj macro function, 969</p>
<p>optional .gpj conditional control statement, 968</p>
<p>options (see driver options)</p>
<p>OPTIONS context sensitive variable, customization file, 999</p>
<p>Options to Apply to Project Builder option, 287</p>
<p>:optionsFile driver option, 288</p>
<p>or instruction, macro expansion for, 452</p>
<p>order of evaluation, 891</p>
<p>.org assembler directive, 421</p>
<p>ori instruction, macro expansion for, 453</p>
<p><i>1065</i></p>
<p><i>Green Hills Software</i></p>
<p><i>-Onoipconstglobals driver option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>OS Directory Builder option, 159</p>
<p>-os_dir driver option, 159</p>
<p>-Osize driver option, 166, 336, 352</p>
<p>-Ospeed driver option, 166, 352</p>
<p>-Ostrfuncs driver option, 291</p>
<p>-Otailrecursion driver option, 293, 357</p>
<p>-Ounroll driver option, 292</p>
<p>-Ounrollbig driver option, 169, 351</p>
<p>Output Archives in 64-Bit Format Builder option, 316</p>
<p>Output File Size Analysis Builder option, 250</p>
<p>Output File Type Builder option, 235</p>
<p>output file types, 13</p>
<p>.ael, 13</p>
<p>.bmon.out, 13</p>
<p>.d, 13, 23</p>
<p>.dba, 13</p>
<p>.dbo, 13</p>
<p>.dep, 13, 23</p>
<p>.dla, 13</p>
<p>.dlo, 13</p>
<p>.dnm, 13</p>
<p>.env, 13</p>
<p>.gmon.out, 13</p>
<p>.graph, 14</p>
<p>.idep, 14</p>
<p>.ii, 14</p>
<p>.inf, 14</p>
<p>.ipf, 14</p>
<p>.lcp, 14</p>
<p>.lst, 14</p>
<p>.map, 14</p>
<p>.mem, 14</p>
<p>.mon.out, 13</p>
<p>.run, 14</p>
<p>.ti, 14</p>
<p>.time, 14</p>
<p>Output Filename Builder option, 122, 163</p>
<p>Output Filename for Generic Types Builder option, 279</p>
<p>:outputDir Builder option, 164</p>
<p>OUTPUTDIR context sensitive variable, customization file,</p>
<p>999</p>
<p>:outputDirRelative Builder option, 277</p>
<p>OUTPUTFILE context sensitive variable, customization file,</p>
<p>999</p>
<p>:outputName Builder option, 279</p>
<p>OUTPUTNAMEBASE context sensitive variable,</p>
<p>customization file, 999</p>
<p>-overlap driver option, 251</p>
<p>-overlap_warn driver option, 251</p>
<p>-overload driver option, 292</p>
<p>-Owholeprogram driver option, 168, 341, 344, 346</p>
<p><b>P</b></p>
<p>-P driver option, 12, 697</p>
<p>-p driver option, 66, 302</p>
<p>-p HTML compiler option, 320</p>
<p>-p librarian command, 518</p>
<p>p_align ELF program header field, 935</p>
<p>p_filesz ELF program header field, 934</p>
<p>p_flags ELF program header field, 934, 936</p>
<p>p_memsz ELF program header field, 934</p>
<p>p_offset ELF program header field, 934</p>
<p>p_paddr ELF program header field, 934</p>
<p>p_type ELF program header field, 934</p>
<p>p_vaddr ELF program header field, 934</p>
<p>-pack driver option, 215</p>
<p>pack_or_align linker expression function, 489</p>
<p>-pack=n, 791</p>
<p>__packed keyword, 28, 32, 687</p>
<p>packing, 28 (see structure packing)</p>
<p>Packing (Maximum Structure Alignment) Builder option,</p>
<p>30, 31, 215, 807</p>
<p>PAD linker section attribute, 492</p>
<p>-paddr_offset driver option, 315</p>
<p>parameter registers, 36</p>
<p>for V850 assembler, 435</p>
<p>parameters, on the stack, 38</p>
<p>PARENTID context sensitive variable, customization file,</p>
<p>999</p>
<p>Parse Templates in Generic Form Builder option, 230</p>
<p>--parse_templates driver option, 230</p>
<p>partial redundancy elimination optimization, 356</p>
<p>Pass Through Arguments Builder option, 286</p>
<p>pass= .gpj conditional control statement, 968</p>
<p>-passsource driver option, 233</p>
<p>:passThrough Builder option, 286</p>
<p>patches, installing, 586</p>
<p>Pattern of Files to Pull Into Project Builder option, 287</p>
<p>PCC (Portable C Compiler), 679</p>
<p>.pdf file extension, 972</p>
<p>-pecoff librarian option, 521</p>
<p>peephole optimization, 352</p>
<p>Peephole Optimization Builder option, 294, 352</p>
<p>Perform a syncp before branching in interrupt vectors created</p>
<p>with #pragma intvect Builder option, 156</p>
<p>permanent registers, 37, 39</p>
<p>in interrupt processing, 122</p>
<p>-pg driver option, 66, 302</p>
<p>Physical Address Offset From Virtual Address Builder</p>
<p>option, 315</p>
<p>-pic driver option, 117, 141</p>
<p>-pid driver option, 106, 119, 141</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1066</i></p>
<p><i>OS Directory Builder option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Pipeline and Peephole Scope Builder option, 168, 352, 353</p>
<p>Pipeline Instruction Scheduling Builder option, 295, 353</p>
<p>pipeline instruction scheduling optimization, 353</p>
<p>Place all read-only SDA items in ZDA instead Builder option,</p>
<p>140</p>
<p>Placement of Class Constructor Call to New Builder option,</p>
<p>224</p>
<p>Placement of Zero-Initialized Data Builder option, 142</p>
<p>plug-in, Eclipse (see MULTI for Eclipse)</p>
<p>-pnone driver option, 302</p>
<p>pointer</p>
<p>information, 787</p>
<p>pointer arithmetic, 889</p>
<p>pointer type</p>
<p>size, 794</p>
<p>position independent code</p>
<p>ABS linker section attribute and, 490</p>
<p>builder and driver options for, 117, 119, 141</p>
<p>combining with non-PIC modules, 118</p>
<p>debugger and, 118</p>
<p>.fixaddr program section and, 927</p>
<p>ind_crt0.c and, 867</p>
<p>introduction to, 117</p>
<p>linker directives file for, 91</p>
<p>predefined macros for, 789</p>
<p>simulator and, 118</p>
<p>Position Independent Code Builder option, 117, 141</p>
<p>position independent data</p>
<p>ABS linker section attribute and, 490</p>
<p>builder and driver options for, 141</p>
<p>combining with non-PID modules, 120</p>
<p>debugger and, 120</p>
<p>.fixaddr program section and, 927</p>
<p>ind_crt0.c and, 867</p>
<p>initializing the base register, 120</p>
<p>introduction to, 119</p>
<p>linker directives file for, 91</p>
<p>predefined macros for, 789</p>
<p>simulator and, 119</p>
<p>Position Independent Data Builder option, 106, 119, 141</p>
<p>post processing, 759</p>
<p>:postexec Builder option, 283</p>
<p>:postexecSafe Builder option, 284</p>
<p>:postexecShell Builder option, 284</p>
<p>:postexecShellSafe Builder option, 285</p>
<p>#pragma __printf_args, 797</p>
<p>#pragma __scanf_args, 797</p>
<p>_Pragma, 667, 808</p>
<p>#pragma alignfunc (n), 796</p>
<p>#pragma alignvar (n), 796</p>
<p>#pragma asm, 796</p>
<p>#pragma can_instantiate fn, 750, 796</p>
<p>#pragma directive</p>
<p>for multiple TDA optimization, 110, 112</p>
<p>for TDA optimization, 107</p>
<p>#pragma directives</p>
<p>function call, 95</p>
<p>#pragma ghs section, 84</p>
<p>#pragma do_not_instantiate fn, 750, 796</p>
<p>#pragma endasm, 796</p>
<p>#pragma ghs alias newsym oldsym, 799</p>
<p>#pragma ghs callmode=callt, 95</p>
<p>#pragma ghs callmode=default, 95</p>
<p>#pragma ghs callmode=far, 95</p>
<p>#pragma ghs callmode=near, 95</p>
<p>#pragma ghs callmode=near|far|default, 799</p>
<p>#pragma ghs check=(check-list), 800</p>
<p>#pragma ghs end_externally_visible, 806</p>
<p>#pragma ghs enddata-type, 805</p>
<p>#pragma ghs endnocoverage, 806</p>
<p>#pragma ghs endnoinline, 335, 806</p>
<p>#pragma ghs endnomisra, 806</p>
<p>#pragma ghs endnostrongfptr, 807</p>
<p>#pragma ghs endnowarning, 803</p>
<p>#pragma ghs endsda, 99</p>
<p>#pragma ghs endzda, 99</p>
<p>#pragma ghs extra_stack, 801</p>
<p>#pragma ghs far, 95, 799</p>
<p>#pragma ghs function, 802</p>
<p>#pragma ghs function [exporttda] tdata=``section-name'',</p>
<p>802</p>
<p>#pragma ghs function tda=default, 802</p>
<p>#pragma ghs inlineprologue, 802</p>
<p>#pragma ghs interrupt, 802</p>
<p>#pragma ghs io identifier addr, 802</p>
<p>#pragma ghs max_instances, 803</p>
<p>#pragma ghs max_stack, 803</p>
<p>#pragma ghs near, 95, 799</p>
<p>#pragma ghs nofloat interrupt, 803</p>
<p>#pragma ghs noinlineprologue, 802</p>
<p>#pragma ghs noprologue, 803</p>
<p>#pragma ghs nowarning, 803</p>
<p>#pragma ghs optasm, 805</p>
<p>#pragma ghs Ostring, 804</p>
<p>#pragma ghs reference sym, 804</p>
<p>#pragma ghs revertoptions, 804</p>
<p>#pragma ghs safeasm, 805</p>
<p>#pragma ghs section, 805</p>
<p>#pragma ghs start_externally_visible, 806</p>
<p>#pragma ghs startdata, 805</p>
<p>#pragma ghs startdata-type, 805</p>
<p>#pragma ghs startnocoverage, 806</p>
<p><i>1067</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Pipeline and Peephole Scope Builder option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>#pragma ghs startnoinline, 335, 806</p>
<p>#pragma ghs startnomisra, 806</p>
<p>#pragma ghs startnostrongfptr, 807</p>
<p>#pragma ghs startsda, 99, 805</p>
<p>#pragma ghs starttda, 805</p>
<p>#pragma ghs startzda, 99, 805</p>
<p>#pragma ghs static_call, 807</p>
<p>#pragma ghs struct_min_alignment(), 807</p>
<p>#pragma ghs struct_min_alignment(n), 807</p>
<p>#pragma ghs ZO, 804</p>
<p>#pragma ident ``string'', 796</p>
<p>#pragma inline function-list, 796</p>
<p>#pragma instantiate fn, 750, 796</p>
<p>#pragma intvect intfunc integer_constant, 796</p>
<p>#pragma once, 797</p>
<p>#pragma pack (), 797</p>
<p>#pragma pack (n), 28, 30, 797</p>
<p>#pragma pack (pop {, name} {, n}), 797</p>
<p>#pragma pack (push {, name} {, n}), 797</p>
<p>#pragma unknown_control_flow (function-list), 797</p>
<p>#pragma weak foo, 798</p>
<p>#pragma weak foo = bar, 798</p>
<p>#pragma ghs endtda, 107</p>
<p>#pragma ghs starttda, 107</p>
<p>.prc file extension, 971</p>
<p>-precise_signed_zero driver option, 135</p>
<p>-precise_signed_zero_compare driver option, 136</p>
<p>predefined macro names</p>
<p>__ARRAY_OPERATORS, 792</p>
<p>__BASE__, 791</p>
<p>__BIG_ENDIAN__, 786</p>
<p>_BOOL, 792</p>
<p>__c_plusplus, 783</p>
<p>__CHAR_BIT, 786</p>
<p>__Char_Is_Signed__, 787, 793</p>
<p>__Char_Is_Unsigned__, 787, 793</p>
<p>__CHAR_UNSIGNED__, 787</p>
<p>__COFF__, 791</p>
<p>__COUNTER__, 793</p>
<p>__cplusplus, 781</p>
<p>__DATE__, 680, 781</p>
<p>__DOUBLE_HL__, 787</p>
<p>__EDG__, 784</p>
<p>__EDG_IMPLICIT_USING_STD, 792</p>
<p>__EDG_RUNTIME_USES_NAMESPACES, 792</p>
<p>__ELF__, 791</p>
<p>__EMBEDDED_CXX, 784</p>
<p>__EMBEDDED_CXX_HEADERS, 784</p>
<p>__EXCEPTION_HANDLING, 792</p>
<p>__EXCEPTIONS, 792</p>
<p>__EXTENDED_EMBEDDED_CXX, 784</p>
<p>__EXTENDED_EMBEDDED_CXX_HEADERS, 784</p>
<p>__Field_Is_Signed__, 787</p>
<p>__Field_Is_Unsigned__, 787</p>
<p>__FILE__, 680, 781</p>
<p>___FULL_DIR__, 791</p>
<p>___FULL_FILE__, 791</p>
<p>__FUNCPTR_BIT, 786</p>
<p>__FUNCTION__, 791</p>
<p>__ghs__, 784</p>
<p>__ghs_alignment, 790</p>
<p>__ghs_asm, 784</p>
<p>__GHS_Inline_Memory_Functions, 792</p>
<p>__GHS_Inline_String_Functions, 792</p>
<p>__ghs_max_pack_value, 790</p>
<p>__GHS_NO_ZERO_COMMONS__, 790</p>
<p>__GHS_NOCOMMONS__, 790</p>
<p>__GHS_Optimize_Inline, 792</p>
<p>__ghs_packing, 791</p>
<p>__ghs_pic, 789</p>
<p>__ghs_pid, 789</p>
<p>__GHS_REVISION_DATE, 784</p>
<p>__GHS_REVISION_VALUE, 784</p>
<p>__ghs_sda, 789</p>
<p>__ghs_sda_threshold, 789</p>
<p>__ghs_tda, 789</p>
<p>__GHS_VERSION_NUMBER, 784</p>
<p>__ghs_zda, 790</p>
<p>__ghs_zda_threshold, 790</p>
<p>__GlobalRegisters, 790</p>
<p>__gnu_asm, 784</p>
<p>__GNUC__, 783</p>
<p>__GNUC_GNU_INLINE__, 783</p>
<p>__GNUC_STDC_INLINE__, 783</p>
<p>__IeeeFloat__, 787</p>
<p>__INT_BIT, 786</p>
<p>__Int_Is_32, 793</p>
<p>__Int_Is_64, 793</p>
<p>introduction to, 780</p>
<p>__Japanese_Automotive_C__, 783</p>
<p>__LANGUAGE_ASM__, 783</p>
<p>__LANGUAGE_C__, 783</p>
<p>__LANGUAGE_CXX__, 783, 784</p>
<p>__LINE__, 680, 781</p>
<p>__LITTLE_ENDIAN__, 786</p>
<p>__LL_BIT, 793</p>
<p>__LL_Is_64, 794</p>
<p>__LLONG_BIT, 786</p>
<p>__LONG_BIT, 786</p>
<p>__Long_Is_32, 794</p>
<p>__Long_Is_64, 794</p>
<p>__MISRA_i, 788</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1068</i></p>
<p><i>#pragma ghs startnoinline</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__msw, 793</p>
<p>__NAMESPACES, 792</p>
<p>__NoFloat__, 788</p>
<p>__ONLY_STANDARD_KEYWORDS_IN_C, 788</p>
<p>__PRETTY_FUNCTION__, 791</p>
<p>__PROTOTYPES__, 783</p>
<p>__PTR_BIT, 786</p>
<p>__Ptr_Is_32, 794</p>
<p>__Ptr_Is_64, 794</p>
<p>__Ptr_Is_Signed__, 787</p>
<p>__Ptr_Is_Unsigned__, 787</p>
<p>__REG_BIT, 786</p>
<p>__Reg_Is_32, 794</p>
<p>__Reg_Is_64, 794</p>
<p>__RTTI, 792</p>
<p>__SHRT_BIT, 787</p>
<p>__SIGNED_CHARS__, 787</p>
<p>__SoftwareDouble__, 788</p>
<p>__SoftwareFloat__, 788</p>
<p>__STANDARD_CXX, 784</p>
<p>__STANDARD_CXX_HEADERS, 784</p>
<p>__STDC__, 781</p>
<p>__STDC_HOSTED__, 781</p>
<p>__STDC_VERSION__, 781</p>
<p>__STRICT_ANSI__, 783</p>
<p>__THREADX, 793</p>
<p>__TIME__, 680, 782</p>
<p>TX_ENABLE_EVENT_LOGGING, 793</p>
<p>__unix_asm, 785</p>
<p>__V800__, 785</p>
<p>__V800_ignore_callt_state_in_interrupts__, 785</p>
<p>__V800_no_callt__, 785</p>
<p>__V800_r20has255__, 785</p>
<p>__V800_r21has65535__, 785</p>
<p>__V800_registermode__=n, 785</p>
<p>__V800_reserve_r2__, 785</p>
<p>__WCHAR_BIT, 787</p>
<p>__WChar_Is_Int__, 794</p>
<p>__WChar_Is_Long__, 794</p>
<p>__WChar_Is_Short__, 794</p>
<p>__WChar_Is_Signed__, 787</p>
<p>__WChar_Is_Unsigned__, 787</p>
<p>_WCHAR_T, 792</p>
<p>predefined macro names</p>
<p>__v850, 785</p>
<p>__v850__, 785</p>
<p>__v850e__, 785</p>
<p>__v851__, 785</p>
<p>:preexec Builder option, 281</p>
<p>:preexecSafe Builder option, 281</p>
<p>:preexecShell Builder option, 282</p>
<p>:preexecShellSafe Builder option, 282</p>
<p>--preinclude_asm driver option, 306</p>
<p>Prelink File to Create Template Instances Builder option,</p>
<p>230</p>
<p>-prelink_against driver option, 231</p>
<p>prelinker instantiation</p>
<p>templates, 746</p>
<p>-prepare_dispose driver option, 40, 152</p>
<p>Prepend String to Every Section Name Builder option, 309</p>
<p>Preprocess Assembly Files Builder option, 232, 394</p>
<p>Preprocess Linker Directives Files Builder option, 237</p>
<p>Preprocess Special Assembly Files Builder option, 233</p>
<p>-preprocess_assembly_files driver option, 232, 394</p>
<p>--preprocess_linker_directive driver option, 237</p>
<p>--preprocess_linker_directive_full driver option, 237</p>
<p>-preprocess_special_assembly_files driver option, 233</p>
<p>preprocessor</p>
<p>Builder and driver options for, 182, 183</p>
<p>overview, 697</p>
<p>saving output from, 697</p>
<p>__PRETTY_FUNCTION__, 791</p>
<p>.previous assembler directive, 421</p>
<p>primaryTarget Top Project directive, 965</p>
<p>printf and scanf Argument Type Checking Builder option,</p>
<p>258</p>
<p>printf function, 825</p>
<p>C++ I/O streams, buffering, 824</p>
<p>printf() function</p>
<p>less buffered I/O, 823</p>
<p>processing input files, using scripts</p>
<p>customization files, 989</p>
<p>profiles, coding standard (see coding standard profiles)</p>
<p>profiling</p>
<p>Builder and driver options for, 178, 302</p>
<p>call count, 302</p>
<p>coverage, 302</p>
<p>with protrans, 655</p>
<p>timing, 178</p>
<p>Profiling - Block Coverage Builder option, 177</p>
<p>Profiling - Call Count Builder option, 66, 301</p>
<p>Profiling - Legacy Coverage Builder option, 302</p>
<p>Profiling - Target-Based Timing Builder option, 70, 178</p>
<p>-prog2 linker option, 473</p>
<p>program data, position-independent, 119</p>
<p>program entry point, 475</p>
<p>program headers, 934</p>
<p>program sections, 97</p>
<p>begin, end, and size symbols for, 503</p>
<p>.bss, 82, 925</p>
<p>.data, 82, 925</p>
<p>ELF indexes, 923</p>
<p><i>1069</i></p>
<p><i>Green Hills Software</i></p>
<p><i>predefined macro names (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>ELF program types, 935</p>
<p>ELF section attribute flags, 924</p>
<p>ELF section types, 923</p>
<p>.fixaddr, 499, 927</p>
<p>.fixtype, 499, 927</p>
<p>header conditions, 921</p>
<p>.heap, 500, 928</p>
<p>.linfix, 926</p>
<p>names, 925</p>
<p>.rel, 926</p>
<p>.rela, 926</p>
<p>.rodata, 82, 501, 926</p>
<p>.ROM, 501</p>
<p>.rosdata, 83, 498</p>
<p>.rozdata, 83, 499</p>
<p>.sbss, 83, 928</p>
<p>.sdabase, 501, 927</p>
<p>.sdata, 83, 928</p>
<p>.secinfo, 502, 927</p>
<p>.shstrtab, 926</p>
<p>.stack, 503, 928</p>
<p>.strtab, 926</p>
<p>.symtab, 926</p>
<p>.syscall, 503, 869, 927</p>
<p>.tdata, 499</p>
<p>.text, 82, 498, 927</p>
<p>.zbss, 83, 928</p>
<p>.zdata, 83, 928</p>
<p>program variables, grouping, 83</p>
<p>project build configurations, 962</p>
<p>project files</p>
<p>types of, 970</p>
<p>Project Manager</p>
<p>file types, 970</p>
<p>--prototype_errors driver option, 257</p>
<p>--prototype_silent driver option, 257</p>
<p>--prototype_warnings driver option, 257</p>
<p>__PROTOTYPES__, 783</p>
<p>protrans utility, 655</p>
<p>provide linker expression function, 489</p>
<p>PT_DYNAMIC ELF program type, 935</p>
<p>PT_HIPROC ELF program type, 936</p>
<p>PT_INTERP ELF program type, 935</p>
<p>PT_LOAD ELF program type, 935</p>
<p>PT_LOPROC ELF program type, 936</p>
<p>PT_NOTE ELF program type, 935</p>
<p>PT_NULL ELF program type, 935</p>
<p>PT_PHDR ELF program type, 936</p>
<p>PT_SHLIB ELF program type, 935</p>
<p>__PTR_BIT, 786</p>
<p>__Ptr_Is_32, 794</p>
<p>__Ptr_Is_64, 794</p>
<p>__Ptr_Is_Signed__, 787</p>
<p>__Ptr_Is_Unsigned__, 787</p>
<p>pure</p>
<p>GNU attribute, 724</p>
<p>pure GNU attribute, 724</p>
<p>-push_pop driver option, 152</p>
<p>putenv(), 845</p>
<p><b>Q</b></p>
<p>-Q driver option, 12</p>
<p>-Qfinal driver option, 22</p>
<p>-Qn driver option, 237</p>
<p>-Qnormalize driver option, 21</p>
<p>-quiet_auto_large_archive driver option, 316</p>
<p>-quiet_auto_large_archive librarian option, 521</p>
<p>Quit Building if Warnings are Generated Builder option, 254</p>
<p>--quit_after_warnings driver option, 254</p>
<p>quoted string assembler expression, 407</p>
<p>-Qy driver option, 237</p>
<p><b>R</b></p>
<p>-r librarian command, 518</p>
<p>r_addend ELF relocation field, 929</p>
<p>r_info ELF relocation field, 929</p>
<p>r_offset ELF relocation field, 929</p>
<p>r0 register</p>
<p>using for ZDA, 97</p>
<p>-r20has255 driver option, 130</p>
<p>-r21has65535 driver option, 131</p>
<p>r30 register</p>
<p>for TDA, 108, 109</p>
<p>RAM Initialization Value Builder option, 271</p>
<p>RAM, placing variables in, 83</p>
<p>-ram_init_val driver option, 271</p>
<p>Range-Based For Loop Support Builder option, 221</p>
<p>--range_based_for driver option, 221</p>
<p>Raw Import Files Builder option, 238</p>
<p>-rawimport driver option, 238</p>
<p>.rc file extension, 971</p>
<p>--readonly_typeinfo driver option, 225</p>
<p>--readonly_virtual_tables driver option, 226</p>
<p>rebuild .gpj conditional control statement, 968</p>
<p>rebuilding</p>
<p>Green Hills libraries, 863</p>
<p>-recipf driver option, 154</p>
<p>Recognition of Exported Templates Builder option, 230, </p>
<p>736, 753</p>
<p>-record_eagle_signal driver option, 296</p>
<p>-record_entry_exit_history driver option, 176</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1070</i></p>
<p><i>program sections (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>Redirect Error Output to File Builder option, 254</p>
<p>Redirect Error Output to Overwriting File Builder option,</p>
<p>317</p>
<p>reentrant functions, in C run-time libraries, 826</p>
<p>Reference Builder option, 286</p>
<p>:reference driver option, 286</p>
<p>__REG_BIT, 786</p>
<p>__Reg_Is_32, 794</p>
<p>__Reg_Is_64, 794</p>
<p>Register Allocation by Coloring Builder option, 292, 362</p>
<p>register allocation by coloring optimization, 362</p>
<p>register coalescing optimization, 363</p>
<p>Register Description File Builder option, 129</p>
<p>Register Mode Builder option, 33, 106, 130</p>
<p>Register r2 Builder option, 34, 129</p>
<p>Register r5 Builder option, 129</p>
<p>--register_definition_file driver option, 129</p>
<p>-registermode driver option, 33</p>
<p>-registermode=22 driver option, 106, 130</p>
<p>-registermode=26 driver option, 106, 130</p>
<p>-registermode=32 driver option, 130</p>
<p>registers</p>
<p>allocator, 350</p>
<p>arguments in, 36</p>
<p>I/O, 125</p>
<p>implied usage of, 892</p>
<p>modes for V850, 33</p>
<p>modes for V850E, 33</p>
<p>modes for V850E2, 33</p>
<p>size of, 794</p>
<p>storing global variables, 92</p>
<p>usage of, 33</p>
<p>-reject_duplicates driver option, 317</p>
<p>.rel program section, 926</p>
<p>.rela program section, 926</p>
<p>relative position of data objects, 886</p>
<p>-relobj driver option, 235</p>
<p>relocatable assembler expression, 407</p>
<p>relocatable object files</p>
<p>creating, 235</p>
<p>debug information for, 235, 299</p>
<p>format, 914</p>
<p>relocation types, 928</p>
<p>relocation directories</p>
<p>for ELF object files, 928</p>
<p>relocation types, 928</p>
<p>-relprog driver option, 235</p>
<p>--remap option, 58</p>
<p>remapping host paths, 58</p>
<p>Remarks Builder option, 253</p>
<p>--remarks driver option, 253</p>
<p>Rename Section Builder option, 145</p>
<p>repeat block directives, 420</p>
<p>Report an Error When Multiple Libraries on a Link Line</p>
<p>Contain a Definition of the Same Symbol Builder</p>
<p>option, 242</p>
<p>report viewer</p>
<p>gsar Options, 374</p>
<p>launching from MULTI Project Manager, 373</p>
<p>launching from the command prompt, 374</p>
<p>.rept assembler directive, 420</p>
<p>Require 4-byte alignment on offsets of word-sized load/store</p>
<p>instructions Builder option, 156</p>
<p>-reserve_r2 driver option, 34, 129</p>
<p>-reserve_r5 driver option, 129</p>
<p>reserved symbols, 398</p>
<p>for V850 assembler, 434</p>
<p>--restrict driver option, 221</p>
<p>restrict keyword, 738</p>
<p>restrict Keyword Support Builder option, 221</p>
<p>restrictions</p>
<p>memory optimization, 893</p>
<p>Retain Comments During Preprocessing Builder option, 306</p>
<p>Retain Symbols for Unused Statics Builder option, 218</p>
<p>-retainlocals linker option, 473</p>
<p>reti instruction, 123</p>
<p>revision tracking, 426</p>
<p>-rh850_1bit driver option, 154</p>
<p>-rh850_4bytewordoffset driver option, 156</p>
<p>-rh850_eint_erratum driver option, 156</p>
<p>.rh850_flags assembler directive, 429</p>
<p>-rh850_fpsimd=full assembler option, 397</p>
<p>-rh850_fpsimd=full driver option, 157</p>
<p>-rh850_fpsimd=half assembler option, 397</p>
<p>-rh850_fpsimd=half driver option, 157</p>
<p>-rh850_fpsimd=none assembler option, 397</p>
<p>-rh850_fpsimd=none driver option, 157</p>
<p>-rh850_simd assembler option, 396</p>
<p>-rh850_simd driver option, 40, 155</p>
<p>-rh850_trace_loads driver option, 153</p>
<p>__RIR() intrinsic function, 811</p>
<p>.rodata data section, 498</p>
<p>.rodata directive, 501</p>
<p>.rodata program section, 82, 501, 926</p>
<p>ROM</p>
<p>putting data in, 498</p>
<p>ROM linker section attribute, 492, 495</p>
<p>.ROM program section, 501</p>
<p>ROM SDA Builder option, 130</p>
<p>ROM_NOCOPY linker section attribute, 492</p>
<p>-rosda driver option, 130</p>
<p>-rosda_is_zda driver option, 140</p>
<p><i>1071</i></p>
<p><i>Green Hills Software</i></p>
<p><i>Redirect Error Output to File Builder option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>.rosdata program section, 83, 97, 498</p>
<p>.rozdata program section, 83, 97, 499</p>
<p>RTTI, 225</p>
<p>__RTTI, 792</p>
<p>--rtti driver option, 225</p>
<p>.run output file type, 14</p>
<p>run-time</p>
<p>copy and clear sections, 511</p>
<p>environment, 121</p>
<p>error checking, 180, 800</p>
<p>libraries, 818</p>
<p>memory checking, 181</p>
<p>RAM initialization, 512</p>
<p>type information</p>
<p>predefined macro, 792</p>
<p>run-time code</p>
<p>customizing, 499</p>
<p>default, features that depend on, 874</p>
<p>ind_bcnt.c, 870</p>
<p>ind_call.800, 869</p>
<p>ind_crt1.c, 869</p>
<p>ind_dots.800, 869</p>
<p>ind_errn.c, 869</p>
<p>ind_exit.c, 872</p>
<p>ind_gcnt.800, 870</p>
<p>ind_gpid.c, 870</p>
<p>ind_gprf.c, 870</p>
<p>ind_heap.c, 871</p>
<p>ind_io.c, 871</p>
<p>ind_iob.c, 872</p>
<p>ind_lock.c, 870</p>
<p>ind_manprf.c, 870</p>
<p>ind_mcnt.800, 870</p>
<p>ind_mprf.c, 870</p>
<p>ind_reset.800, 869</p>
<p>ind_stackcheck.c, 870</p>
<p>ind_thrd.c, 870</p>
<p>libsys.a, 499, 868</p>
<p>special program sections, 499</p>
<p>run-time error checking</p>
<p>Builder and driver options for, 180</p>
<p>enabling and disabling, 73</p>
<p>#pragma, 800</p>
<p>Run-Time Error Checks Builder option, 70, 178, 800</p>
<p>run-time memory checking</p>
<p>Builder and driver options for, 181</p>
<p>#pragma, 800</p>
<p>Run-Time Memory Checks Builder option, 72, 74, 180, 300</p>
<p>run-time type information (see RTTI)</p>
<p>Run-Time Type Information Support Builder option, 225</p>
<p>RUNDIR context sensitive variable, customization file, 999</p>
<p><b>S</b></p>
<p>-S driver option, 10, 12, 395</p>
<p>.s file extension, 8, 971</p>
<p>S-Record format</p>
<p>generating, 236, 594</p>
<p>Safe Commands to Execute After Associated Command (via</p>
<p>Shell) Builder option, 285</p>
<p>Safe Commands to Execute After Associated Command</p>
<p>Builder option, 284</p>
<p>Safe Commands to Execute Before Associated Command</p>
<p>(via Shell) Builder option, 282</p>
<p>Safe Commands to Execute Before Associated Command</p>
<p>Builder option, 281</p>
<p>--saferc driver option, 205, 206, 207, 208, 209, 210, 211, </p>
<p>212, 213</p>
<p>Save CTPSW and CTPC registers in Interrupt Routines</p>
<p>Builder option, 40, 151</p>
<p>sbf instructions, macro expansions for, 456</p>
<p>.sbss assembler directive, 425</p>
<p>.sbss program section, 83, 97, 928</p>
<p>.sbttl assembler directive, 423</p>
<p>scalar variables, 362</p>
<p>.scall assembler directive, 427</p>
<p>Scan source files to augment native debug info Builder</p>
<p>option, 300</p>
<p>--scan_source driver option, 300</p>
<p>__SCH0L() intrinsic, 812</p>
<p>__SCH0R() intrinsic, 812</p>
<p>__SCH1L() intrinsic, 812</p>
<p>__SCH1R() intrinsic, 812</p>
<p>__schedule_barrier() intrinsic function, 813</p>
<p>scxx header file directory, 819</p>
<p>SDA (see small data area optimization)</p>
<p>-sda driver option, 98, 136</p>
<p>-sda_file driver option, 99, 137</p>
<p>.sdabase program section, 501, 927</p>
<p>.sdata program section, 83, 97, 928</p>
<p>Search for DBA Builder option, 299</p>
<p>Search Path for .dbo Files Builder option, 299</p>
<p>-search_for_dba driver option, 300</p>
<p>.secinfo program section, 502, 927</p>
<p>SECOND_PASS_OPTION context sensitive variable,</p>
<p>customization file, 999</p>
<p>.section assembler directive, 422</p>
<p>-section driver option, 145</p>
<p>section GNU attribute, 724</p>
<p>section maps, 481</p>
<p>(see also linker directives files (.ld))</p>
<p>Section Overlap Checking Builder option, 251</p>
<p>--section_prefix driver option, 309</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1072</i></p>
<p><i>.rosdata program section</i></p>
<h1 style="page-break-before:always; "></h1>
<p>--section_suffix driver option, 309</p>
<p>sections</p>
<p>control directives, 421</p>
<p>defining, 481</p>
<p>#pragma directive, 84</p>
<p>SECTIONS linker directive, 481</p>
<p>:select Builder option, 285</p>
<p>selectone_optional .gpj conditional control statement, 968</p>
<p>selectone_required .gpj conditional control statement, 968</p>
<p>Self-Dependency Builder option, 279</p>
<p>sentinel GNU attribute, 724</p>
<p>sequence related undefined behavior checking, 685</p>
<p>.set assembler directive, 402, 425</p>
<p>Set Assembler Message to Error Builder option, 261</p>
<p>Set Assembler Message to Silent Builder option, 261</p>
<p>Set Assembler Message to Warning Builder option, 261</p>
<p>Set Linker Message to Error Builder option, 262</p>
<p>Set Linker Message to Silent Builder option, 262</p>
<p>Set Linker Message to Warning Builder option, 262</p>
<p>Set Maximum DBO Not Found Warnings Builder option,</p>
<p>301</p>
<p>Set Message to Error Builder option, 260</p>
<p>Set Message to Remark Builder option, 260</p>
<p>Set Message to Silent Builder option, 260</p>
<p>Set Message to Warning Builder option, 260</p>
<p>Set Register r20 to the Value 255 Builder option, 130</p>
<p>Set Register r21 to the Value 65535 Builder option, 131</p>
<p>set1 instruction, macro expansion for, 449</p>
<p>setenv(), 845</p>
<p>setf instructions, macro expansions for, 456</p>
<p>setjmp.h</p>
<p>functions, 859</p>
<p>__SETSR() intrinsic function, 811</p>
<p>sh_addr ELF section header field, 922</p>
<p>sh_addralign ELF section header field, 922</p>
<p>sh_entsize ELF section header field, 922</p>
<p>sh_flags ELF section header field, 922, 924</p>
<p>sh_info ELF section header field, 922, 925, 929</p>
<p>sh_link ELF section header field, 922, 925, 929</p>
<p>sh_name ELF section header field, 922, 933</p>
<p>sh_offset ELF section header field, 922</p>
<p>sh_size ELF section header field, 922, 933</p>
<p>sh_type ELF section header field, 922, 925</p>
<p>Shadow Declarations Builder option, 259</p>
<p>-shared_libs driver option, 267</p>
<p>SHF_ALLOC ELF section attribute flag, 924</p>
<p>SHF_EXECINSTR ELF section attribute flag, 924</p>
<p>SHF_GHS_ABS ELF section attribute flag, 924</p>
<p>SHF_WRITE ELF section attribute flag, 924</p>
<p>SHFLAGS linker section attribute, 492</p>
<p>shift operators, 892</p>
<p>SHN_ABS ELF section index, 923</p>
<p>SHN_COMMON ELF section index, 923</p>
<p>SHN_GHS_SMALLCOMMON ELF section index, 923</p>
<p>SHN_GHS_TINYCOMMON ELF section index, 923</p>
<p>SHN_GHS_ZERO_COMMON ELF section index, 923</p>
<p>SHN_UNDEF ELF section index, 923, 925</p>
<p>short data type</p>
<p>size of, 787</p>
<p>variable arguments, 692</p>
<p>--short_enum driver option, 28, 214, 692</p>
<p>-shorten_loads driver option, 139</p>
<p>-shorten_moves driver option, 140</p>
<p>__SHRT_BIT, 787</p>
<p>.shstrtab program section, 926</p>
<p>SHT_NOTE ELF section type, 924</p>
<p>SHT_NULL ELF section type, 923</p>
<p>SHT_PROGBITS ELF section type, 923</p>
<p>SHT_REL ELF section type, 924, 925</p>
<p>SHT_RELA ELF section type, 924, 925</p>
<p>SHT_STRTAB ELF section type, 924</p>
<p>SHT_SYMTAB ELF section type, 924, 925</p>
<p>.si files, 697</p>
<p>SIBLINGS context sensitive variable, customization file,</p>
<p>999</p>
<p>SIBLINGS[type] context sensitive variable, customization</p>
<p>file, 1000</p>
<p>signed keyword, 680</p>
<p>--signed_chars driver option, 213</p>
<p>__SIGNED_CHARS__, 787</p>
<p>--signed_fields driver option, 213, 689</p>
<p>--signed_pointer driver option, 214</p>
<p>Signedness of Bitfields Builder option, 213, 684, 689, 763</p>
<p>Signedness of Char Type Builder option, 213, 684, 762</p>
<p>Signedness of Pointers Builder option, 214</p>
<p>SIMD vector support, 40</p>
<p>Simplify C Print Functions Builder option, 291</p>
<p>simulator</p>
<p>PIC and, 118</p>
<p>PID and, 119</p>
<p>.single assembler directive, 414</p>
<p>single floating point values</p>
<p>in registers, 33</p>
<p>single-pass inlining, 328</p>
<p>-single_tda driver option, 138</p>
<p>.size assembler directive, 427</p>
<p>Size of time_t Builder option, 215</p>
<p>sizeof linker expression function, 489</p>
<p>--slash_comment driver option, 186</p>
<p>small data area</p>
<p>base register, 105</p>
<p>program sections for, 105</p>
<p><i>1073</i></p>
<p><i>Green Hills Software</i></p>
<p><i>--section_suffix driver option</i></p>
<h1 style="page-break-before:always; "></h1>
<p>size, 105</p>
<p>user-defined sections, 105</p>
<p>Small Data Area File Builder option, 99, 137</p>
<p>small data area optimization</p>
<p>assembler directives, 100</p>
<p>base register, 96</p>
<p>builder and driver options for, 98, 99, 106, 137, 270</p>
<p>excluding data from, 100</p>
<p>introduction to, 96</p>
<p>linker directives file for, 101</p>
<p>linker errors, 104</p>
<p>linking modules, 103</p>
<p>#pragma directives, 99, 805</p>
<p>predefined macros, 789</p>
<p>program sections for, 83, 97, 927, 928</p>
<p>RAM SDA, 96</p>
<p>ROM SDA, 96</p>
<p>setting a threshold value for, 97, 137, 789</p>
<p>specifying a file of symbol names for, 99, 137</p>
<p>specifying additional registers for, 106, 270</p>
<p>--small driver option, 175</p>
<p>-smaller_bitops driver option, 153</p>
<p>Software trace logging support, 45</p>
<p>__SoftwareDouble__, 788</p>
<p>__SoftwareFloat__, 788</p>
<p>-source assembler option, 397</p>
<p>source code</p>
<p>interleaving with assembly code, 233</p>
<p>Source Directories Relative to This File Builder option, 163</p>
<p>Source Directories Relative to Top-Level Project Builder</p>
<p>option, 277</p>
<p>source files for customization, 121</p>
<p>source level debugging</p>
<p>problems, 894</p>
<p>source listing, 397</p>
<p>Source Listing Generation Builder option, 79, 232, 233</p>
<p>Source Listing Generation Output Directory Builder option,</p>
<p>232</p>
<p>Source Root Builder option, 161</p>
<p>source scanning, 59</p>
<p>:sourceDir Builder option, 163</p>
<p>:sourceDirNonRelative Builder option, 277</p>
<p>sourceroot command, 58</p>
<p>.space assembler directive, 414</p>
<p>Special Data Area Builder option, 98, 136, 805</p>
<p>special inline functions</p>
<p>for V850 and RH850, 39</p>
<p>specials symbols</p>
<p>for multiple TDA optimization, 113</p>
<p>specifying individual functions to inline, 329</p>
<p>spl instruction, 899</p>
<p>-split_data_sections_by_alignment driver option, 86, 145</p>
<p>%SPOFF, 905</p>
<p>SRAM, and V850, 107</p>
<p>-srec driver option, 159, 236</p>
<p>st instruction, macro expansion for, 449</p>
<p>st_info ELF symbol table entry, 930</p>
<p>st_name ELF symbol table entry, 930</p>
<p>st_other ELF symbol table entry, 930</p>
<p>st_shndx ELF symbol table entry, 931, 932</p>
<p>st_size ELF symbol table entry, 930</p>
<p>st_value ELF symbol table entry, 930, 932</p>
<p>Stabs debugging information</p>
<p>converting automatically, 57</p>
<p>converting manually, 58</p>
<p>limitations to, 61</p>
<p>-stabs2dbo driver option, 305</p>
<p>stabs2dbo executable, 57, 58, 59</p>
<p>stack</p>
<p>alignment of, 27</p>
<p>byte boundary for, 35</p>
<p>for V850 assembler, 457</p>
<p>generating frame to support traces, 297</p>
<p>structure of, 37</p>
<p>Stack Limit Checking Builder option, 143</p>
<p>stack offsets, 36</p>
<p>stack pointer</p>
<p>for V850 assembler, 434, 435, 457</p>
<p>.stack program section, 503, 928</p>
<p>-stack_check driver option, 143</p>
<p>-stack_protector driver option, 143</p>
<p>stackcheck attribute, 725</p>
<p>Standard C++, xxx, 736 (see C++ language)</p>
<p>standard I/O package, 823</p>
<p>Standard Include Directories Builder option, 307</p>
<p>__STANDARD_CXX, 784</p>
<p>__STANDARD_CXX_HEADERS, 784</p>
<p>--standard_vtbl driver option, 226</p>
<p>Start Address Symbol Builder option, 122, 236, 475</p>
<p>Start File Directory Builder option, 245</p>
<p>Start Files Builder option, 244</p>
<p>start-up module</p>
<p>rebuilding, 863</p>
<p>-startfile_dir driver option, 245</p>
<p>-startfiles driver option, 244</p>
<p>startup code</p>
<p>crt0.o, 499, 865</p>
<p>default, features that depend on, 874</p>
<p>ind_crt0.c, 867</p>
<p>ind_initmem.800, 868</p>
<p>ind_mcpy.800, 868</p>
<p>ind_mset.800, 868</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1074</i></p>
<p><i>small data area (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>ind_reset.800, 868</p>
<p>libstartup.a, 499, 867</p>
<p>static</p>
<p>constructors and destructors, 759, 879, 882</p>
<p>static address elimination optimization, 361</p>
<p>static analysis (see DoubleCheck)</p>
<p>static assertions, 814</p>
<p>STB_GLOBAL ELF symbol binding, 931</p>
<p>STB_HIPROC ELF symbol binding, 931</p>
<p>STB_LOCAL ELF symbol binding, 931</p>
<p>STB_LOPROC ELF symbol binding, 931</p>
<p>STB_WEAK ELF symbol binding, 931</p>
<p>--STD driver option, 185, 736</p>
<p>--std driver option, 185, 736</p>
<p>std namespace, 792</p>
<p>-std_cxx_include_directory driver option, 307</p>
<p>&lt;stdarg.h&gt;, 692, 694, 888</p>
<p>__STDC__, 781</p>
<p>__STDC_HOSTED__, 781</p>
<p>__STDC_VERSION__, 781</p>
<p>-stderr driver option, 254</p>
<p>stderr, 880</p>
<p>-stderr_overwrite driver option, 317</p>
<p>-stderr=errfile librarian option, 521</p>
<p>stdin, 880</p>
<p>-stdinc driver option, 307</p>
<p>stdio, 823</p>
<p>--stdl driver option, 186, 784</p>
<p>--stdle driver option, 186, 784, 820</p>
<p>-stdlib driver option, 314</p>
<p>stdlib.h</p>
<p>functions, 859</p>
<p>stdout, 880</p>
<p>sterror(), C implementation, 716</p>
<p>.str assembler directive, 414</p>
<p>strength reduction optimization, 348</p>
<p>streq .gpj conditional control statement, 967</p>
<p>strftime(), C implementation, 717</p>
<p>__STRICT_ANSI__, 783</p>
<p>-strict_overlap_check driver option, 251</p>
<p>string constants, 399</p>
<p>string literals, 738</p>
<p>string tables, 933</p>
<p>strings not referenced, 933</p>
<p>-strip driver option, 236</p>
<p>-strip_eagle_log driver option, 177</p>
<p>-strip_eagle_signal driver option, 297</p>
<p>-strip_entry_exit_history driver option, 176</p>
<p>strong_fptr attribute, 725</p>
<p>strprefix .gpj conditional control statement, 967</p>
<p>.strtab program section, 926</p>
<p>struct data type, 680, 688, 737</p>
<p>packing, 791</p>
<p>portability, 887</p>
<p>structure packing, 28</p>
<p>packing all structures, 31</p>
<p>packing one structure type, 30</p>
<p>pointing to packed structures, 32</p>
<p>portability, 32</p>
<p>warnings, 32</p>
<p>.strz assembler directive, 414</p>
<p>__STSR() intrinsic, 810</p>
<p>STT_FILE ELF symbol type, 931</p>
<p>STT_FUNC ELF symbol type, 931</p>
<p>STT_HIPROC ELF symbol type, 932</p>
<p>STT_LOPROC ELF symbol type, 932</p>
<p>STT_NOTYPE ELF symbol type, 931</p>
<p>STT_OBJECT ELF symbol type, 931</p>
<p>STT_SECTION ELF symbol type, 931</p>
<p>sub instruction, macro expansion for, 452</p>
<p>__SUB_SAT() intrinsic function, 812</p>
<p>.subtitle assembler directive, 423</p>
<p>Support __noinline Keyword for Templates Builder option,</p>
<p>222, 336</p>
<p>Support floating point types in scanf Builder option, 313</p>
<p>Support for C Type Information in Assembly Builder option,</p>
<p>234</p>
<p>Support for Constructors/Destructors Builder option, 223</p>
<p>Support for Implicit Extern C Type Conversion Builder</p>
<p>option, 312</p>
<p>Support for Implicit Typenames Builder option, 228</p>
<p>Support for Old-Style Specializations Builder option, 227, </p>
<p>228</p>
<p>Support for Very Large Switch Statements Builder option,</p>
<p>272</p>
<p>Support Variable Length Arrays Builder option, 218</p>
<p>Suppress Dependencies Builder option, 279</p>
<p>--suppress_vtbl driver option, 226</p>
<p>switch statements</p>
<p>MISRA C 2004, 773</p>
<p>Switch Tables Builder option, 272</p>
<p>--switch_table driver option, 272</p>
<p>Symbol Blacklist Builder option, 318</p>
<p>symbol tables, 930</p>
<p>-symbol_blacklist_file driver option, 318</p>
<p>symbolic</p>
<p>debugging directives, 426</p>
<p>memory-mapped I/O, 124</p>
<p>symbols</p>
<p>bindings, 931</p>
<p>definition directives, 424</p>
<p>definition of, 503</p>
<p><i>1075</i></p>
<p><i>Green Hills Software</i></p>
<p><i>startup code (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>reserved, for V850 assembler, 434</p>
<p>types, 931</p>
<p>values, 932</p>
<p>Symbols Referenced Externally Builder option, 170</p>
<p>.symtab program section, 926</p>
<p>-syntax driver option, 13</p>
<p>-sys_include_directory driver option, 308</p>
<p>.syscall program section, 503, 869, 927</p>
<p>-syslib driver option, 158</p>
<p>System Include Directories Builder option, 307</p>
<p><b>T</b></p>
<p>-T driver option, 239</p>
<p>-t librarian command, 518</p>
<p>-T linker option, 474</p>
<p>tail call optimization, 357</p>
<p>Tail Calls Builder option, 293, 357</p>
<p>target environment, 26</p>
<p>.target file extension, 971</p>
<p>Target Processor Builder option, 270</p>
<p>target-based timing profiling</p>
<p>debugging information, 69</p>
<p>-target_dir command line option, 587</p>
<p>TDA</p>
<p>base register for, 108</p>
<p>controlling variables in, 107</p>
<p>overflowing, 109</p>
<p>size of, 107</p>
<p>TDA modules</p>
<p>and non-TDA modules, 109</p>
<p>TDA optimization, 107, 110</p>
<p>linker errors for, 109</p>
<p>#pragma directive and, 107</p>
<p>.tdata data section, 107, 108</p>
<p>.tdata program section, 499</p>
<p>Tektronix hexadecimal format</p>
<p>generating, 236, 594</p>
<p>Template Instantiation Output Directory Builder option, 229</p>
<p>templates</p>
<p>builder and driver options for, 227, 228, 229, 230</p>
<p>class, 746</p>
<p>dependent name processing, 230</p>
<p>entity, 746</p>
<p>exported templates, 230, 753</p>
<p>function, 746</p>
<p>function inlining, 336</p>
<p>guiding declarations, 227</p>
<p>implicit inclusion of, 228, 751</p>
<p>instantiation and namespaces, 756</p>
<p>instantiation directory, 229</p>
<p>instantiation of, 746</p>
<p>link-once instantiation of, 749</p>
<p>#pragma directives, 750</p>
<p>prelinker, 747</p>
<p>prelinker instantiation, 746</p>
<p>specialization, 748</p>
<p>Temporary Assembly Output Builder option, 276</p>
<p>Temporary Output Builder option, 275</p>
<p>Temporary Output Directory Builder option, 275</p>
<p>Temporary Preprocessor Output Builder option, 276</p>
<p>temporary registers, 38</p>
<p>for V850 assembler, 435</p>
<p>.text assembler directive, 422</p>
<p>-text option, 118</p>
<p>.text program section, 82, 498, 927</p>
<p>third-party tools</p>
<p>compilers, 57, 61</p>
<p>limitations when using, 60</p>
<p>MULTI for Eclipse, 1006</p>
<p>thread-safety</p>
<p>customizing libraries, 831</p>
<p>thread-safety library functions</p>
<p>library functions, 826</p>
<p>__THREADX, 793</p>
<p>.ti file, 746</p>
<p>.ti output file type, 14</p>
<p>.time output file type, 14</p>
<p>__TIME__, 680, 782</p>
<p>time.h</p>
<p>functions, 860</p>
<p>-time32 driver option, 215</p>
<p>-time64 driver option, 215</p>
<p>-timer_profile driver option, 70, 178</p>
<p>Tiny Data Area, 107</p>
<p>tiny data area optimization</p>
<p>#pragma directives, 805</p>
<p>predefined macros, 789</p>
<p>.title assembler directive, 423</p>
<p>-tmp driver option, 275</p>
<p>-tmp=dir librarian option, 521</p>
<p>tmpfile(), C implementation, 714</p>
<p>Top Project directives, for .gpj files, 961</p>
<p>Top Project headers, .gpj files, 958</p>
<p>TOPPROJECT context sensitive variable, customization file,</p>
<p>999</p>
<p>Toyota Motor Corporation, 684</p>
<p>Transition C</p>
<p>variable arguments, 692</p>
<p>translating</p>
<p>debugging information, 57</p>
<p>automatically, 57</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1076</i></p>
<p><i>symbols (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>limitations to, 60</p>
<p>manually, 58</p>
<p>source scanning feature, 59</p>
<p>transparent_union GNU attribute, 730</p>
<p>Treat Doubles as Singles Builder option, 133</p>
<p>Treatment of RTTI as const Builder option, 225</p>
<p>Treatment of Virtual Tables as 'const'</p>
<p>Builder option, 226</p>
<p>Trigraphs Builder option, 259</p>
<p>tst1 instruction, macro expansion for, 449</p>
<p>two-pass inlining, 328</p>
<p>TX_ENABLE_EVENT_LOGGING, 793</p>
<p>.txt file extension, 972</p>
<p>.type assembler directive, 427</p>
<p>type combinations, 407</p>
<p>type qualifiers, 686</p>
<p>treatment in GNU C, 673</p>
<p>typographical conventions, xxvii</p>
<p><b>U</b></p>
<p>-U driver option, 182</p>
<p>-u driver option, 246</p>
<p>-unalign_debug_sections linker option, 474</p>
<p>unaligned loads and stores, handling, 32</p>
<p>unary, 402</p>
<p>Undefine Preprocessor Symbol Builder option, 182</p>
<p>undefined assembler expression, 407</p>
<p>undefined behavior, 702</p>
<p>-undefined driver option, 245</p>
<p>Undefined Preprocessor Symbols Builder option, 259</p>
<p>Undefined Symbols Builder option, 245</p>
<p>-underscore linker option, 474</p>
<p>uninit DoubleCheck property type, 373</p>
<p>union data type, 680, 688, 737</p>
<p>portability, 887</p>
<p>--unique_strings driver option, 217</p>
<p>Uniquely Allocate All Strings Builder option, 217, 762</p>
<p>__unix_asm, 785</p>
<p>Unknown Pragma Directives Builder option, 257, 795</p>
<p>--unknown_pragma_errors driver option, 257, 795</p>
<p>--unknown_pragma_silent driver option, 258, 795</p>
<p>--unknown_pragma_warnings driver option, 258</p>
<p>Unroll Larger Loops Builder option, 169, 351</p>
<p>--unsafe_predefines driver option, 306, 780</p>
<p>unsaved DoubleCheck property type, 372</p>
<p>--unsigned_chars driver option, 213, 684</p>
<p>--unsigned_fields driver option, 214, 684, 689</p>
<p>--unsigned_pointer driver option, 214</p>
<p>unspecified behavior, 702</p>
<p>unused GNU attribute, 730</p>
<p>Use 64-bit Load/Store instructions (RH850 and later) Builder</p>
<p>option, 156</p>
<p>Use 64-bit Toolchain Components Builder option, 289</p>
<p>Use divq Instruction for Divide (V850E2R and later) Builder</p>
<p>option, 154</p>
<p>Use Floating-Point in stdio Routines Builder option, 136</p>
<p>Use FPU 3.0 instructions (RH850 and later) Builder option,</p>
<p>155</p>
<p>Use pushsp and popsp instructions Builder option, 152</p>
<p>Use recipf.s/recipf.d for 1/x Builder option, 154</p>
<p>Use Small Block Malloc Builder option, 150</p>
<p>Use Smallest Type Possible for Enum Builder option, 28, </p>
<p>214, 684, 692, 763</p>
<p>used GNU attribute, 731</p>
<p>--using_std driver option, 220, 792</p>
<p>utility programs, 527</p>
<p>ccorti, 644</p>
<p>gaddr2line, 529</p>
<p>gasmlist, 530</p>
<p>gbin2c, 536</p>
<p>gbincmp, 545</p>
<p>gbuild, 547</p>
<p>gcolor, 556</p>
<p>gcompare, 561</p>
<p>gcores, 532</p>
<p>gdump, 564</p>
<p>gfile, 571</p>
<p>gfunsize, 572</p>
<p>ghexfile (see utility programs, gsrec)</p>
<p>ghide, 573</p>
<p>gmemfile, 574</p>
<p>gnm, 581</p>
<p>gsize, 592</p>
<p>gsrec, 594</p>
<p>gstrip, 620</p>
<p>gversion, 621</p>
<p>gwhat, 623</p>
<p>mevundump, 626</p>
<p>protrans, 655</p>
<p><b>V</b></p>
<p>-V assembler option, 397</p>
<p>-v driver option, 15</p>
<p>-V driver option, 254</p>
<p>-v linker option, 474</p>
<p>-V linker option, 474</p>
<p>__V800__, 785</p>
<p>__V800_ignore_callt_state_in_interrupts__, 785</p>
<p>__V800_no_callt__, 785</p>
<p>-v800_old_callt driver option, 151</p>
<p><i>1077</i></p>
<p><i>Green Hills Software</i></p>
<p><i>translating (continued)</i></p>
<h1 style="page-break-before:always; "></h1>
<p>__V800_r20has255__, 785</p>
<p>__V800_r21has65535__, 785</p>
<p>__V800_registermode__=n, 785</p>
<p>__V800_reserve_r2__, 785</p>
<p>V850</p>
<p>assembler for, 434</p>
<p>assembly language guidelines, 457</p>
<p>byte boundary for stack, 35</p>
<p>register modes for, 33</p>
<p>routine calls on, 36</p>
<p>SRAM for, 107</p>
<p>stack offsets for, 36</p>
<p>__v850, 785</p>
<p>V850 and RH850</p>
<p>EABI, 26</p>
<p>special inline functions, 39</p>
<p>V850 and RH850 CPU processors, 26</p>
<p>V850 Tiny Data Area Builder option, 110, 138, 152, 805</p>
<p>__v850__, 785</p>
<p>-v850_isr_save_eiic driver option, 156</p>
<p>-v850_isr_save_r4r5 driver option, 155</p>
<p>V850E</p>
<p>byte boundary for stack, 35</p>
<p>register modes for, 33</p>
<p>routine calls on, 36</p>
<p>stack offsets for, 36</p>
<p>__v850e__, 785</p>
<p>V850E2</p>
<p>byte boundary for stack, 35</p>
<p>register modes for, 33</p>
<p>routine calls on, 36</p>
<p>stack offsets for, 36</p>
<p>V850E3, 54</p>
<p>__v851, 785</p>
<p>values</p>
<p>representable range, 884</p>
<p>&lt;varargs.h&gt;, 692, 693</p>
<p>variable</p>
<p>alignment, 796</p>
<p>variable arguments, 692</p>
<p>variables</p>
<p>allocation, 894</p>
<p>local, automatic allocation, 363</p>
<p>placement of for embedded development, 83</p>
<p>version number</p>
<p>generating from assembler, 397</p>
<p>generating from compiler driver, 254</p>
<p>-version_info driver option, 254</p>
<p>viewing reports</p>
<p>DoubleCheck, 373</p>
<p>-vimport linker option, 474</p>
<p>Virtual Function Definition Builder option, 225</p>
<p>Virtual Function Table Offset Size Builder option, 226</p>
<p>--vla driver option, 218</p>
<p>void data type, 680</p>
<p>volatile keyword, 360, 680, 687, 894</p>
<p><b>W</b></p>
<p>-w assembler option,</p>
<p>-w driver option, 253, 704</p>
<p>-w linker option, 474</p>
<p>Wait for Debug Translation Before Exiting Builder option,</p>
<p>301</p>
<p>-wait_for_dblink driver option, 301</p>
<p>Warn for all floating point types Builder option, 273</p>
<p>Warn for types double or long double Builder option, 273</p>
<p>-warn_dbo_not_found_max driver option, 301</p>
<p>warn_unused_result GNU attribute, 731</p>
<p>.warning assembler directive, 423</p>
<p>%warning preprocessor directive, customization file, 1002</p>
<p>Warnings Builder option, 253, 704</p>
<p>--warnings driver option, 253</p>
<p>WChar Size Builder option, 309</p>
<p>__WCHAR_BIT, 787</p>
<p>__WChar_Is_Int__, 794</p>
<p>__WChar_Is_Long__, 794</p>
<p>__WChar_Is_Short__, 794</p>
<p>__WChar_Is_Signed__, 787</p>
<p>__WChar_Is_Unsigned__, 787</p>
<p>-wchar_s32 driver option, 310</p>
<p>_WCHAR_T, 792</p>
<p>wchar_t type</p>
<p>predefined macro, 792</p>
<p>predefined macros, 787</p>
<p>size, 787</p>
<p>-wchar_u16 driver option, 310</p>
<p>wchar.h</p>
<p>functions, 859</p>
<p>-Wdouble driver option, 273</p>
<p>.weak assembler directive, 425</p>
<p>weak GNU attribute, 731</p>
<p>weak symbols</p>
<p>defining, 425, 798</p>
<p>ELF symbol binding, 931</p>
<p>resolving from libraries, 472, 506</p>
<p>testing for in linker directives, 489</p>
<p>-Wfloat driver option, 273</p>
<p>-Wformat driver option, 258</p>
<p>When Rejecting Duplicate Symbols in An Archive, Certain</p>
<p>Symbols Generated by the C++ Front End in</p>
<p>COMMON Sections Are Ignored Builder option, 317</p>
<p><i>MULTI: Building Applications for Embedded V850 and RH850</i></p>
<p><i>1078</i></p>
<p><i>__V800_r20has255__</i></p>
<h1 style="page-break-before:always; "></h1>
<p>When Rejecting Duplicate Symbols in An Archive, Symbols</p>
<p>in .ghs.linkonce Sections Are Ignored Builder option,</p>
<p>317</p>
<p>When Rejecting Duplicate Symbols, Allow Certain Symbols</p>
<p>Added by the compiler Builder option, 242</p>
<p>When Rejecting Duplicate Symbols, Allow Symbols in</p>
<p>.ghs.linkonce sections Builder option, 242</p>
<p>whitespace, 401</p>
<p>whole program optimizations</p>
<p>constant-value global variables, deletion of, 344</p>
<p>constant-value global variables, propagation of, 343</p>
<p>global variables, localization of, 344</p>
<p>--whole-archive driver option, 241</p>
<p>wholeprogram optimizations</p>
<p>constant function returns, deletion of, 343</p>
<p>constant parameters, deletion of, 343</p>
<p>function parameters, constant propagation of, 342</p>
<p>one-site inlining, 342</p>
<p>unreachable functions, deletion of, 343</p>
<p>wide character functions, 847</p>
<p>-Wimplicit-int driver option, 258</p>
<p>-Wl, driver option, 241</p>
<p>-Wno-format driver option, 258</p>
<p>-Wno-implicit-int driver option, 258</p>
<p>-Wno-shadow driver option, 259</p>
<p>-Wno-trigraphs driver option, 259</p>
<p>-Wno-undef driver option, 259</p>
<p>-Wnodouble driver option, 273</p>
<p>-Wnofloat driver option, 273</p>
<p>.word assembler directive, 415</p>
<p>word size, 884</p>
<p>-wrap sym linker option, 474</p>
<p>--wrap_diagnostics driver option, 256</p>
<p>Write Version Info To .comment section Builder option, 254</p>
<p>-Wshadow driver option, 259</p>
<p>-Wtrigraphs driver option, 259</p>
<p>-Wundef driver option, 259</p>
<p><b>X</b></p>
<p>-X driver option, 319</p>
<p>-x librarian command, 518</p>
<p>X-Switches Builder option, 319</p>
<p>xor instruction, macro expansion for, 452</p>
<p>xori instruction, macro expansion for, 453</p>
<p>--xref=declare driver option, 304</p>
<p>--xref=full driver option, 304</p>
<p>--xref=global driver option, 304</p>
<p>--xref=none driver option, 304</p>
<p><b>Y</b></p>
<p>-Y0, driver option, 288</p>
<p>-Ya, driver option, 289</p>
<p>-YL, driver option, 288</p>
<p>-Yl, driver option, 289</p>
<p><b>Z</b></p>
<p>.zbss assembler directive, 425</p>
<p>.zbss program section, 83, 97, 928</p>
<p>ZDA (see zero data area optimization)</p>
<p>-zda driver option, 98, 137</p>
<p>-zda_file driver option, 99, 138</p>
<p>.zdata program section, 83, 97, 928</p>
<p>zero data area</p>
<p>size, 105</p>
<p>Zero Data Area File Builder option, 99, 137</p>
<p>zero data area optimization, 97</p>
<p>builder and driver options for, 98, 99, 137, 138, 140</p>
<p>linker directives file for, 102</p>
<p>linker errors, 104</p>
<p>linking modules, 103</p>
<p>#pragma directives, 805</p>
<p>predefined macros, 790</p>
<p>program sections for, 83, 97, 928</p>
<p>setting a threshold value for, 137, 790</p>
<p>size of, 97</p>
<p>specifying a file of symbol names for, 99, 138</p>
<p>-zero_commons driver option, 140</p>
<p><i>1079</i></p>
<p><i>Green Hills Software</i></p>
<p><i>When Rejecting Duplicate Symbols in An Archive, Symbols in .ghs.linkonce Sections Are Ignored</i></p>
<p><i>Builder option</i></p>
<h1 style="page-break-before:always; "></h1>
</body>
</html>
{% endraw %}