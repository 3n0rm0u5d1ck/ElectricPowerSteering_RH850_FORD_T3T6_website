---
layout: default
title: TechnicalReference_Dcm
nav_order: 2
parent: Diagnostic Communication Manager
---
{% raw %}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
     "http://www.w3.org/TR/html4/transitional.dtd">
<html>
<head>

  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title></title>
  <meta name="generator" content="LibreOffice 24.2.7.2 (Linux)"/>
  <meta name="created" content="00:00:00"/>
  <meta name="changed" content="00:00:00"/>
</head>
<body>
<h1></h1>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p><b>MICROSAR DCM </b></p>
<p>Technical Reference </p>
<p> </p>
<p>Ford </p>
<p>Version 7.1 </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>Authors </p>
<p>Mishel </p>
<p>Shishmanyan, </p>
<p>Patrick </p>
<p>Rieder, </p>
<p>Vitalij </p>
<p>Krieger, </p>
<p>Thomas Dedler, Alexander Ditte, Savas Ates </p>
<p>Status </p>
<p>Released </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>2 </p>
<p>based on template version 5.0.0 </p>
<p><b>Document Information </b></p>
<p><b>History </b></p>
<p><b>Author </b></p>
<p><b>Date </b></p>
<p><b>Version </b></p>
<p><b>Remarks </b></p>
<p>Thomas Dedler, </p>
<p>Mishel Shishmanyan </p>
<p>2012-08-15 </p>
<p>1.00.00 </p>
<p>Initial version </p>
<p>Mishel Shishmanyan </p>
<p>2012-09-21 </p>
<p>1.01.00 </p>
<p><b>Added: </b></p>
<p><i>5.19 ReadDataByPeriodicIdentifier ($2A) </i></p>
<p><i>5.22 InputOutputControlByIdentifier ($2F) </i></p>
<p><i>6.5.2.7 ReturnControlToECU() </i></p>
<p><i>6.5.2.8 ResetToDefault() </i></p>
<p><i>6.5.2.9 FreezeCurrentState() </i></p>
<p><i>6.5.2.10 ShortTermAdjustment() </i></p>
<p><i>9.8 How to Jump into the FBL from Service </i></p>
<p><i>DiagnosticSessionControl ($10) </i></p>
<p><i>9.10 How to Put DCM in a Non-Default Session at </i></p>
<p><i>ECU Power-On </i></p>
<p> </p>
<p><b>Modified: </b></p>
<p><i>Table 6-80   DataServices_&lt;DataName&gt; </i></p>
<p><i>Table 3-4  DET Service IDs </i></p>
<p>Mishel Shishmanyan </p>
<p>2012-12-12 </p>
<p>1.02.00 </p>
<p><b>Added: </b></p>
<p><i>5.15 ReadMemoryByAddress ($23) </i></p>
<p><i>5.20 DynamicallyDefineDataIdentifier ($2C)<b> </b></i></p>
<p><i>5.24 WriteMemoryByAddress ($3D) </i></p>
<p><i>Table 6-43   Dcm_ReadMemory() </i></p>
<p><i>Table 6-44   Dcm_WriteMemory() </i></p>
<p><i><b> </b></i></p>
<p><b>Modified: </b></p>
<p><i>Table 6-50   ConditionCheckRead()<b>, </b></i></p>
<p><i>Table 6-53   ReadDataLength()<b>, </b></i></p>
<p><i>Table 6-54   WriteData() (dynamic length)<b>, </b></i></p>
<p><i>Table 6-55   WriteData() (static length)<b>, </b></i></p>
<p><i>Table 6-56   ReturnControlToECU()<b>, </b></i></p>
<p><i>Table 6-57   ResetToDefault()<b>, </b></i></p>
<p><i>Table 6-58   FreezeCurrentState()<b>, </b></i></p>
<p><i>Table 6-59   ShortTermAdjustment()</i> -“OpStatus”- </p>
<p>parameter availability limitation </p>
<p><i>Table 6-38   &lt;Module&gt;_&lt;DiagnosticService&gt;()<b> </b></i></p>
<p><i>Table 6-39 </i></p>
<p><i> </i></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;_&lt;SubService&gt;()<b> </b></i></p>
<p><b> </b></p>
<p><i> </i></p>
<p>Mishel Shishmanyan </p>
<p>2013-04-17 </p>
<p>1.03.00 </p>
<p>No changes </p>
<p>Mishel Shishmanyan </p>
<p>2013-06-28 </p>
<p>1.04.00 </p>
<p><b>Added:  </b></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>3 </p>
<p>based on template version 5.0.0 </p>
<p>Chapters for OBD service 0x01- 0x0A. </p>
<p><i>6.6.1.2.6 DtrServices</i> </p>
<p><i>6.6.1.2.7 RequestControlServices_&lt;TIDName&gt; </i></p>
<p><i>6.6.1.2.8 InfotypeServices_&lt;VEHINFODATA&gt; </i></p>
<p><i>9.11 How to Support Calibrateable Configuration </i></p>
<p><i>Parameters </i></p>
<p> </p>
<p><b>Modified: </b></p>
<p><i>Table 3-2  Not supported AUTOSAR standard </i></p>
<p><i>conform features</i>  </p>
<p>– </p>
<p>Removed not supported OBD. </p>
<p><i> </i></p>
<p><i>Table 8-3  Limitations to AUTOSAR</i>  </p>
<p>– </p>
<p>Removed not supported OBD. </p>
<p>Mishel Shishmanyan </p>
<p>2013-08-20 </p>
<p>1.05.00 </p>
<p><b>Added:  </b></p>
<p><i>6.6.1.2.9 CallbackDCMRequestServices_&lt;SWC&gt; </i></p>
<p><i> </i></p>
<p><i>9.12 How and When to Configure Multiple Protocols </i></p>
<p><i> </i></p>
<p><i>8.1 Deviations </i></p>
<p>– </p>
<p>Added deviation to </p>
<p><i>CallbackDCMRequestServices_&lt;SWC&gt; </i></p>
<p>service port. </p>
<p><i> </i></p>
<p><i>Table 8-3  Limitations to AUTOSAR</i>  </p>
<p>– </p>
<p>Added maximum number of supported </p>
<p>protocols. </p>
<p>– </p>
<p>Added maximum number of concurrent client </p>
<p>diagnostic connections. </p>
<p><b>Modified: </b></p>
<p><i>5.14 ReadDataByIdentifier ($22) </i></p>
<p><i>5.22 InputOutputControlByIdentifier ($2F)</i> </p>
<p>– </p>
<p>Modified configuration and implementation </p>
<p>aspects. </p>
<p><i> </i></p>
<p><i>Table 6-85   DtrServices_&lt;MIDName&gt;_&lt;TIDName&gt; </i></p>
<p><i>Table 6-86   RequestControlServices_&lt;TIDName&gt;</i> </p>
<p>– </p>
<p>Changed port names according to AR DCM </p>
<p>SWS. </p>
<p><i> </i></p>
<p><i>Table 6-87   InfotypeServices_&lt;VEHINFODATA&gt; </i></p>
<p>– </p>
<p>Editorial change.  </p>
<p><i> </i></p>
<p><i>Table 8-3  Limitations to AUTOSAR</i>  </p>
<p>– </p>
<p>Removed not supported multi-protocol. </p>
<p>– </p>
<p>Removed not supported multiple buffers. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>4 </p>
<p>based on template version 5.0.0 </p>
<p>Thomas Dedler, </p>
<p>Mishel Shishmanyan </p>
<p>2013-09-17 </p>
<p>2.00.00 </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Modified: </b></p>
<p><i>8.1 Deviations </i></p>
<p>– </p>
<p>Removed deviations for DID and RID </p>
<p>signals. </p>
<p><i>3.1 Features </i></p>
<p>– </p>
<p>Removed not supported multi-protocol. </p>
<p>– </p>
<p>Removed not supported multiple buffers. </p>
<p><i>6.5.2.12 Start(), 6.5.2.13 Stop(), 6.5.2.14 </i></p>
<p><i>RequestResults()</i> </p>
<p>– </p>
<p>Changed function signatures and </p>
<p>descriptions </p>
<p><i>5.22 InputOutputControlByIdentifier ($2F)  </i></p>
<p>– </p>
<p>More details on how optional CEM is </p>
<p>supported by DCM. </p>
<p><i>6.5.2.10 ShortTermAdjustment()  </i></p>
<p>– </p>
<p>Removed statement that CEM is included in </p>
<p>the controlOptionRecord. </p>
<p>Mishel Shishmanyan </p>
<p>2014-01-14 </p>
<p>2.01.00 </p>
<p><b>Added: </b></p>
<p><i>9.13 How to Select DEM-DCM Interface Version </i></p>
<p><i>9.14 How to Support OBD and UDS over a Single </i></p>
<p><i>Client Connection </i></p>
<p><i>9.15 How to Use a User Configuration File </i></p>
<p><i>9.16 How to Know When the Security Access Level </i></p>
<p><i>Changes </i></p>
<p><b> </b></p>
<p><b>Modified: </b></p>
<p><i>3.4.1 Split Task Functions  </i></p>
<p>– </p>
<p>Added configuration aspects. </p>
<p><i>Table 4-3  Compiler abstraction and memory </i></p>
<p><i>mapping </i></p>
<p>– </p>
<p>Added calibration parameter memory </p>
<p>sections. </p>
<p><i>5.11 EcuReset ($11) </i></p>
<p>– </p>
<p>Added clarification for request rejection while </p>
<p>waiting for reset execution. </p>
<p><i>5.13 ReadDiagnosticInformation ($19) </i></p>
<p>– </p>
<p>Added support of new sub-functions 0x17-</p>
<p>0x19. </p>
<p><i>5.19 ReadDataByPeriodicIdentifier ($2A) </i></p>
<p>– </p>
<p>Added feature stop periodic reading on </p>
<p>changed state. </p>
<p><i>5.20 DynamicallyDefineDataIdentifier ($2C) </i></p>
<p>– </p>
<p>Added feature clear DDID on changed state. </p>
<p> </p>
<p>Mishel Shishmanyan, </p>
<p>2014-04-14 </p>
<p>2.02.00 </p>
<p><b>Added: </b></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>5 </p>
<p>based on template version 5.0.0 </p>
<p>Patrick Rieder </p>
<p><i>9.17 How to Deal with the PduR AR version </i></p>
<p><b> </b></p>
<p><b>Modified: </b></p>
<p><i>Figure 2-2<b> </b>Interfaces to adjacent modules of the </i></p>
<p><i>DCM<b> </b></i></p>
<p>– </p>
<p>NvM added to figure </p>
<p><i>3.4.1 Split Task Functions </i></p>
<p>– </p>
<p>Reworked chapter  </p>
<p>– </p>
<p>Added support by configuration tool  </p>
<p><i>5.14.4 Configuration Aspects </i></p>
<p>– </p>
<p>Added information about NvRam signal </p>
<p>configuration </p>
<p><i>5.21.4 Configuration Aspects </i></p>
<p>– </p>
<p>Added information about NvRam signal </p>
<p>configuration </p>
<p><i>6.3 Services used by DCM </i></p>
<p>– </p>
<p>Added NvM services used by the DCM </p>
<p><i>6.4.3.2.1 Dcm_StartOfReception(), 6.4.3.2.3 </i></p>
<p><i>Dcm_TpRxIndication(), 6.4.3.2.5 </i></p>
<p><i>Dcm_TpTxConfirmation() </i></p>
<p>– </p>
<p>New version of the APIs for AR 4.1.2 PduR </p>
<p>added </p>
<p><i>8.3 Limitations </i></p>
<p>– </p>
<p>Shared signals between DIDs not supported </p>
<p>Mishel Shishmanyan </p>
<p>2014-10-08 </p>
<p>3.00.00 </p>
<p><b>Added:  </b></p>
<p><i>5.16 ReadScalingDataByIdentifier ($24) </i></p>
<p><i>6.5.2.11 GetScalingInformation() </i></p>
<p><i>6.6.2 Managed Mode Declaration Groups </i></p>
<p><i>9.18 Post-build Support </i></p>
<p><i>10 Troubleshooting </i></p>
<p><i> </i></p>
<p><b>Modified: </b></p>
<p><i>4.1.2 Dynamic Files </i></p>
<p>– </p>
<p>Added post-build data files </p>
<p>– </p>
<p>Added SWC template file </p>
<p><i>Table 4-3  Compiler abstraction and memory </i></p>
<p><i>mapping </i></p>
<p>– </p>
<p>Added post-build data memory mapping </p>
<p><i>Figure 4-1 </i></p>
<p><i>Include structure </i></p>
<p>– </p>
<p>Added post-build configuration and other </p>
<p>BSW headers files </p>
<p><i>5.11 EcuReset ($11) </i></p>
<p>– </p>
<p>Sub-functions are now allowed to be user </p>
<p>defined. </p>
<p><i>5.13 ReadDiagnosticInformation ($19) </i></p>
<p>– </p>
<p>Added new implementation aspect. </p>
<p><i>6.6.1.2.1 DataServices_&lt;DataName&gt; </i></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>6 </p>
<p>based on template version 5.0.0 </p>
<p>– </p>
<p>Added new port operation </p>
<p><i>GetScalingInformation()</i> </p>
<p><i>8.3 Limitations  </i></p>
<p>– </p>
<p>Added limitation for support of DIDranges  </p>
<p><i>6.2.1.1 Dcm_Init() </i></p>
<p><i>7.1 Configuration Variants </i></p>
<p>– </p>
<p>Added new post-build variants </p>
<p><i>9.16 How to Know When the Security Access Level </i></p>
<p><i>Changes </i></p>
<p>– </p>
<p>Added link to the corresponding mode </p>
<p>declaration group. </p>
<p>Mishel Shishmanyan, </p>
<p>Vitalij Krieger, </p>
<p>Thomas Dedler </p>
<p>2015-01-13 </p>
<p>3.01.00 </p>
<p><b>Added:  </b></p>
<p><i> </i></p>
<p><i>6.5.2.24 IsDidAvailable() </i></p>
<p><i>6.5.2.25 ReadDidData()  </i></p>
<p><i>6.5.2.26 WriteDidData() </i></p>
<p><i>9.19 Handling with DID Ranges </i></p>
<p><i>9.20 How to Support DID 0xF186 </i></p>
<p><i> </i></p>
<p><b>Modified: </b></p>
<p><i>5.14.4, 5.23 </i></p>
<p>– </p>
<p>Removed WWH-OBD only DIDs/RIDs from </p>
<p>examples. </p>
<p><i>6.3 Services used by DCM </i></p>
<p>– </p>
<p>AR3 support added </p>
<p><i>6.4.2 ComM, 6.4.3 PduR </i></p>
<p>– </p>
<p>AR3 support added </p>
<p><i>8.3 Limitations </i></p>
<p>– </p>
<p>Removed limitation for not supported DID </p>
<p>ranges. </p>
<p>– </p>
<p>Added limitation for DidRanges. </p>
<p><i>9.17 How to Deal with the PduR AR version </i></p>
<p>– </p>
<p>Added AR 3.x compliance aspect </p>
<p><i>Table 8-2  Additions/ Extensions to AUTOSAR </i></p>
<p>– </p>
<p>Added AR 3.x integration  </p>
<p>Vitalij Krieger, </p>
<p>Mishel Shishmanyan </p>
<p>2015-02-06 </p>
<p>4.00.00 </p>
<p><b>Added: </b></p>
<p><i>6.2.1.6 Dcm_InitMemory() </i></p>
<p><i>6.2.3.1 Dcm_GetTesterSourceAddress() </i></p>
<p><i>6.4.4 CanTp<b> </b></i></p>
<p><i>6.5.1.8&lt;Diagnostic Session Change Notification </i></p>
<p><i>Callback&gt; </i></p>
<p><i>6.5.1.9&lt;Security Access Change Notification </i></p>
<p><i>Callback&gt; </i></p>
<p><i>9.21 How to Suppress Responses to Functional </i></p>
<p><i>Addressed Requests<b> </b></i></p>
<p><i>9.22 How to Support Interruption on Requests with </i></p>
<p><i>Foreign N_TA </i></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>7 </p>
<p>based on template version 5.0.0 </p>
<p><i>9.23 How to Know When the Diagnostic Session </i></p>
<p><i>Changes </i></p>
<p><b> </b></p>
<p><b>Modified: </b></p>
<p>Minor editorial changes </p>
<p><i>Table 4-3  Compiler abstraction and memory </i></p>
<p><i>mapping<b> </b></i></p>
<p>– </p>
<p>Added DCM_VAR_INIT memory section. </p>
<p><i>9.17 How to Deal with the PduR AR version </i></p>
<p>– </p>
<p>PduR 4.0.1 added </p>
<p><i>6.2.1.5 Dcm_GetVersionInfo() </i></p>
<p>– </p>
<p>Specified the digit format of the module’s </p>
<p>version information. </p>
<p><i>Figure 4-1 </i></p>
<p><i>Include structure </i></p>
<p>– </p>
<p>New include structure </p>
<p><i>4.1.1 Static Files </i></p>
<p>– </p>
<p>New files introduced </p>
<p><i>4.2 Include Structure </i></p>
<p>– </p>
<p>New include structure </p>
<p><i>5.17.4 Configuration Aspects </i></p>
<p>– </p>
<p>Added support for single/multiple instace </p>
<p>attempt counter, delay timer. </p>
<p><i>9.16 How to Know When the Security Access Level </i></p>
<p><i>Changes </i></p>
<p>– </p>
<p>Added new notification type </p>
<p>Alexander Ditte, </p>
<p>Mishel Shishmanyan </p>
<p>2015-05-04 </p>
<p>4.01.00 </p>
<p><b>Added: </b></p>
<p><i>6.2.2.5 Dcm_GetSecurityLevelFixedBytes()  </i></p>
<p><i>6.4.3.1.1 Dcm_TriggerTransmit() </i></p>
<p><i>6.4.3.2.6 Dcm_TxConfirmation() </i></p>
<p><i>6.5.2.27 GetSecurityAttemptCounter() </i></p>
<p><i>6.5.2.28 SetSecurityAttemptCounter() </i></p>
<p><i>9.24 How to Save RAM using Paged-Buffer for </i></p>
<p><i>Large DIDs<b> </b></i></p>
<p><i>9.25 How to Get Security-Access Level Specific </i></p>
<p><i>Fixed Byte </i>Values<i> </i></p>
<p><i>9.26 How to Extend the Diag Keep Alive Time </i></p>
<p><i>during Diagnostics </i></p>
<p><i>9.27 How to Recover DCM State Context on ECU </i></p>
<p><i>Reset/ Power On </i></p>
<p><b> </b></p>
<p><b>Modified: </b></p>
<p>Global minor editorial changes </p>
<p><i>Table 5-26   Service $19: Supported subservices<b></i> </b></p>
<p>– </p>
<p>Added sub-function 0x42 </p>
<p><i>5.10.4 Configuration Aspects </i></p>
<p>– </p>
<p>Added session specific timings aspect </p>
<p><i>5.11 EcuReset ($11) </i></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>8 </p>
<p>based on template version 5.0.0 </p>
<p>– </p>
<p>Added note for resetting to default session if </p>
<p>needed. </p>
<p><i>5.17 SecurityAccess ($27)  </i></p>
<p>– </p>
<p>Additions for the new features listed related </p>
<p>to this service </p>
<p><i>5.18.4 Configuration Aspects; </i></p>
<p><i>5.13.4 Configuration Aspects </i></p>
<p>– </p>
<p>Added a hint for external sub-function </p>
<p>implementation. </p>
<p><i>5.22.4 Configuration Aspects </i></p>
<p>– </p>
<p>Removed limitation to static length IO DID </p>
<p>for service 0x2F. </p>
<p><i>5.26.4 Configuration Aspects </i></p>
<p>– </p>
<p>Added missing related configuration </p>
<p>parameters </p>
<p><i>Table 6-79   DCMServices </i></p>
<p>– </p>
<p>Added new operation </p>
<p><i>Table 3-4  DET Service IDs </i></p>
<p>– </p>
<p>Completed API list  </p>
<p>– </p>
<p>Names converted to hyperlinks for </p>
<p>convenience </p>
<p>Mishel Shishmanyan </p>
<p>2015-11-12 </p>
<p>5.00.00 </p>
<p><b>Added: </b></p>
<p><i>6.2.3.2 Dcm_ProcessVirtualRequest() </i></p>
<p><i>6.2.3.3 Dcm_SetSecurityLevel() </i></p>
<p><i>6.2.2.6 Dcm_SetActiveDiagnostic() </i></p>
<p><i>6.5.1.11 Dcm_FilterDidLookUpResult </i></p>
<p><i>6.5.1.12 Dcm_FilterRidLookUpResult </i></p>
<p><i>9.28 How to Define a Diagnostic Connection without </i></p>
<p><i>USDT </i>Responses<i> </i></p>
<p><i>9.29 How to Handle Multiple Diagnostic Service </i></p>
<p><i>Variants </i></p>
<p><i> </i></p>
<p><b>Modified: </b></p>
<p>Minor editorial changes </p>
<p><i>5 Diagnostic Service Implementation </i></p>
<p>– </p>
<p>Modified introduction on how to read each </p>
<p>diagnostic service sub-chapter. </p>
<p>– </p>
<p>Added information for the supported types of </p>
<p>diagnostic service processor </p>
<p>implementations for all services. </p>
<p><i>5.17 SecurityAccess ($27) </i></p>
<p>– </p>
<p>Added external service implementation </p>
<p>aspect. </p>
<p><i>9.11.1 OBD Calibration </i></p>
<p>– </p>
<p>Added information about feature </p>
<p>configuration.  </p>
<p><i>5.22 </i>InputOutputControlByIdentifier ($2F) </p>
<p>– </p>
<p>More events monitored for automatic IO DID </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>9 </p>
<p>based on template version 5.0.0 </p>
<p>resetting. </p>
<p><i>Table 3-4  DET Service IDs </i></p>
<p>– </p>
<p>Added missing DET SIDs </p>
<p><i>6.5.2.24 IsDidAvailable()</i> </p>
<p>– </p>
<p>Removed limitation of synchronous usage. </p>
<p><i>Table 4-3  Compiler abstraction and memory </i></p>
<p><i>mapping<b> </b></i></p>
<p>– </p>
<p>Added DCM_VAR_INIT memory section for </p>
<p>32bit data. </p>
<p>Mishel Shishmanyan </p>
<p>2016-03-01 </p>
<p>5.01.00 </p>
<p><b>Added: </b></p>
<p><i>6.2.2.7 Dcm_GetRequestKind() </i></p>
<p> </p>
<p><b>Modified: </b></p>
<p>Minor editorial changes. </p>
<p><i>Table 9-10  </i></p>
<p>– </p>
<p>Added details for “RID operation”. </p>
<p><i>Table 6-79   DCMServices </i></p>
<p>– </p>
<p>Corrected supported return error codes </p>
<p>– </p>
<p>Added new operations </p>
<p><i>5.22 InputOutputControlByIdentifier ($2F) </i></p>
<p><i>6.5.2.7 ReturnControlToECU()  </i></p>
<p><i>6.5.2.8 ResetToDefault()  </i></p>
<p><i>6.5.2.9 FreezeCurrentState()  </i></p>
<p><i>6.5.2.10 ShortTermAdjustment() </i></p>
<p><i>– </i></p>
<p>Reworked for support of bitmapped IO DIDs. </p>
<p><i>Table 3-4  DET Service IDs </i></p>
<p>– </p>
<p>Added new services </p>
<p><i>8.2 Additions/ Extensions </i></p>
<p>– </p>
<p>Added multi byte external CEMR handling </p>
<p><i>8.3 Limitations </i></p>
<p>– </p>
<p>Removed limitation for API <i>IsDidAvailable()</i> </p>
<p>Mishel Shishmanyan </p>
<p>2016-04-29 </p>
<p>5.02.00 </p>
<p> </p>
<p><b>Modified: </b></p>
<p>Minor editorial changes. </p>
<p>Mishel Shishmanyan </p>
<p>2016-07-05 </p>
<p>7.00.00 </p>
<p><b>Added: </b></p>
<p><i>9.30 How to Switch Between OBD DTR Support by </i></p>
<p><i>DCM and DEM </i></p>
<p><i>9.31 How to Enable Support of OBD VIDs with </i></p>
<p><i>Dynamic Length </i></p>
<p><i>10.2 Code Generation Time Messages </i></p>
<p> </p>
<p><b>Modified: </b></p>
<p>Minor editorial changes. </p>
<p><i>5.8.4 Configuration Aspects </i></p>
<p>– </p>
<p>Reordered FAQ and added variable data </p>
<p>size specific hints. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>10 </p>
<p>based on template version 5.0.0 </p>
<p><i>Table 6-20   Services used by the DCM </i></p>
<p>– </p>
<p>Updated used DEM API. </p>
<p><i>5.14.4 Configuration Aspects </i></p>
<p>– </p>
<p><i>Added configuration aspects for OBD MID </i></p>
<p><i>DIDs. </i></p>
<p><i>5.18.4 Configuration Aspects </i></p>
<p>– </p>
<p>Added FAQ for “AllNetworks” parameter. </p>
<p><i>6.5.2.22 GetInfotypeValueData() </i></p>
<p>– </p>
<p>Added AR4.2.2 compatibility. </p>
<p><i>9.18.1.2 Diagnostic Services Part<b> </b></i></p>
<p>– </p>
<p>Enabled PBS for diagnostic service. </p>
<p><i>Table 10-1   Compile time error messages</i> </p>
<p>– </p>
<p>Added new messages. </p>
<p><i>Table 8-1  Deviations to AUTOSAR </i></p>
<p>– </p>
<p>Removed deviation to AR for suppression of </p>
<p>NRC 0x7E and 0x7F, since AR 4.2.2 now </p>
<p>does require this behavior. </p>
<p>Mishel Shishmanyan </p>
<p>2016-09-22 </p>
<p>7.01.00 </p>
<p><b>Added: </b></p>
<p><i>9.32 How to setup DCM for Sender-Receiver </i></p>
<p><i>Communication </i></p>
<p><i>9.33 How to Support Routine Info Byte with UDS  </i></p>
<p> </p>
<p><b>Modified: </b></p>
<p>Replaced all used DCM_E_OK / DCM_E_NOT_OK </p>
<p>to E_OK resp. E_NOT_OK as per <i>[1]</i>.  </p>
<p>- </p>
<p>Note: This is not an API change, since the </p>
<p>DCM_E_* symbols have identical values </p>
<p>with the standard E_*. You can still use the </p>
<p>DCM_E_* ones in your application, if </p>
<p>preffered. </p>
<p><i>9.1 How to Reduce RAM Usage </i></p>
<p>– </p>
<p>Added information regarding DCM buffer </p>
<p>size recommendations integrated in the </p>
<p>Configuration 5 tool. </p>
<p><i>6.5.2.22 GetInfotypeValueData() </i></p>
<p>– </p>
<p>Corrected OpStatus parameter description. </p>
<p><i>11.2 Abbreviations </i></p>
<p>– </p>
<p>Added “C/S” and “S/R”. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>11 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b>Reference Documents </b></p>
<p><b>No. </b></p>
<p><b>Source </b></p>
<p><b>Title </b></p>
<p><b>Version </b></p>
<p>[1] </p>
<p> AUTOSAR </p>
<p>AUTOSAR_SWS_DiagnosticCommunicationManager.pdf </p>
<p>V4.2.2 </p>
<p>[2] </p>
<p> AUTOSAR </p>
<p>AUTOSAR_SWS_DevelopmentErrorTracer.pdf </p>
<p>V3.2.0 </p>
<p>[3] </p>
<p> AUTOSAR </p>
<p>AUTOSAR_SWS_DiagnosticEventManager.pdf </p>
<p>V4.2.0 </p>
<p>[4] </p>
<p> AUTOSAR </p>
<p>AUTOSAR_BasicSoftwareModules.pdf </p>
<p>V1.0.0 </p>
<p>[5] </p>
<p> ISO </p>
<p>ISO 14229-1 UDS </p>
<p>2013 </p>
<p>[6] </p>
<p> ISO </p>
<p>ISO 15031-5 OBD </p>
<p>2004 </p>
<p>[7] </p>
<p> ISO </p>
<p>ISO 27145-2 WWH-OBD CDD Emissions </p>
<p>2009 </p>
<p>[8] </p>
<p> ISO </p>
<p>ISO 27145-3 WWH-OBD CMD </p>
<p>2009 </p>
<p>[9] </p>
<p>V </p>
<p>Vector </p>
<p>TechnicalReference_PostBuildSelectable.pdf </p>
<p>See delivery </p>
<p>[10]  Vector </p>
<p>TechnicalReference_IdentityManager.pdf </p>
<p>See delivery </p>
<p>[11]  Vector </p>
<p>TechnicalReference_Dem.pdf </p>
<p>See delivery </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>We have configured the programs in accordance with your specifications in the </p>
<p>questionnaire. Whereas the programs do support other configurations than the one </p>
<p>specified in your questionnaire, Vector´s release of the programs delivered to your </p>
<p>company is expressly restricted to the configuration you have specified in the </p>
<p>questionnaire. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>This symbol calls your attention to warnings. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>12 </p>
<p>based on template version 5.0.0 </p>
<p><b>Contents </b></p>
<p><b>1</b></p>
<p> </p>
<p><b>Component History .................................................................................................... 26</b></p>
<p> </p>
<p><b>2</b></p>
<p> </p>
<p><b>Introduction................................................................................................................. 28</b></p>
<p> </p>
<p>2.1</p>
<p> </p>
<p>How to Read This Document ........................................................................... 28</p>
<p> </p>
<p>2.1.1</p>
<p> </p>
<p>DCM Integration and Basic Operation .............................................. 28</p>
<p> </p>
<p>2.1.2</p>
<p> </p>
<p>Diagnostic Service Documentation ................................................... 28</p>
<p> </p>
<p>2.1.3</p>
<p> </p>
<p>API Definitions ................................................................................. 29</p>
<p> </p>
<p>2.1.4</p>
<p> </p>
<p>DCM Configuration Parameter Descriptions ..................................... 29</p>
<p> </p>
<p>2.2</p>
<p> </p>
<p>Architecture Overview ...................................................................................... 30</p>
<p> </p>
<p><b>3</b></p>
<p> </p>
<p><b>Functional Description ............................................................................................... 32</b></p>
<p> </p>
<p>3.1</p>
<p> </p>
<p>Features .......................................................................................................... 32</p>
<p> </p>
<p>3.2</p>
<p> </p>
<p>Initialization ...................................................................................................... 33</p>
<p> </p>
<p>3.3</p>
<p> </p>
<p>States .............................................................................................................. 33</p>
<p> </p>
<p>3.4</p>
<p> </p>
<p>Main Functions ................................................................................................ 33</p>
<p> </p>
<p>3.4.1</p>
<p> </p>
<p>Split Task Functions ......................................................................... 33</p>
<p> </p>
<p>3.4.1.1</p>
<p> </p>
<p>Functionality .................................................................. 33</p>
<p> </p>
<p>3.4.1.2</p>
<p> </p>
<p>Configuration Aspects .................................................... 34</p>
<p> </p>
<p>3.4.1.3</p>
<p> </p>
<p>Integration Aspects ........................................................ 34</p>
<p> </p>
<p>3.5</p>
<p> </p>
<p>Error Handling .................................................................................................. 34</p>
<p> </p>
<p>3.5.1</p>
<p> </p>
<p>Development Error Reporting ........................................................... 34</p>
<p> </p>
<p>3.5.2</p>
<p> </p>
<p>Production Code Error Reporting ..................................................... 36</p>
<p> </p>
<p><b>4</b></p>
<p> </p>
<p><b>Integration ................................................................................................................... 37</b></p>
<p> </p>
<p>4.1</p>
<p> </p>
<p>Scope of Delivery ............................................................................................. 37</p>
<p> </p>
<p>4.1.1</p>
<p> </p>
<p>Static Files ....................................................................................... 37</p>
<p> </p>
<p>4.1.2</p>
<p> </p>
<p>Dynamic Files .................................................................................. 38</p>
<p> </p>
<p>4.2</p>
<p> </p>
<p>Include Structure .............................................................................................. 39</p>
<p> </p>
<p>4.3</p>
<p> </p>
<p>Compiler Abstraction and Memory Mapping ..................................................... 39</p>
<p> </p>
<p>4.4</p>
<p> </p>
<p>Critical Sections ............................................................................................... 41</p>
<p> </p>
<p>4.5</p>
<p> </p>
<p>Considerations Using Request- and ResponseData Pointers in a Call-back .... 41</p>
<p> </p>
<p><b>5</b></p>
<p> </p>
<p><b>Diagnostic Service Implementation........................................................................... 42</b></p>
<p> </p>
<p>5.1</p>
<p> </p>
<p>RequestCurrentPowertrainDiagnosticData ($01).............................................. 43</p>
<p> </p>
<p>5.1.1</p>
<p> </p>
<p>Functionality ..................................................................................... 43</p>
<p> </p>
<p>5.1.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 43</p>
<p> </p>
<p>5.1.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 43</p>
<p> </p>
<p>5.1.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 43</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>13 </p>
<p>based on template version 5.0.0 </p>
<p>5.2</p>
<p> </p>
<p>RequestPowertrainFreezeFrameData ($02) ..................................................... 45</p>
<p> </p>
<p>5.2.1</p>
<p> </p>
<p>Functionality ..................................................................................... 45</p>
<p> </p>
<p>5.2.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 45</p>
<p> </p>
<p>5.2.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 45</p>
<p> </p>
<p>5.2.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 45</p>
<p> </p>
<p>5.3</p>
<p> </p>
<p>RequestEmissionRelatedDTC ($03) ................................................................ 47</p>
<p> </p>
<p>5.3.1</p>
<p> </p>
<p>Functionality ..................................................................................... 47</p>
<p> </p>
<p>5.3.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 47</p>
<p> </p>
<p>5.3.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 47</p>
<p> </p>
<p>5.3.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 47</p>
<p> </p>
<p>5.4</p>
<p> </p>
<p>ClearEmissionRelatedDTC ($04) ..................................................................... 48</p>
<p> </p>
<p>5.4.1</p>
<p> </p>
<p>Functionality ..................................................................................... 48</p>
<p> </p>
<p>5.4.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 48</p>
<p> </p>
<p>5.4.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 48</p>
<p> </p>
<p>5.4.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 48</p>
<p> </p>
<p>5.5</p>
<p> </p>
<p>RequestOnBoardMonitorTestResults ($06) ...................................................... 49</p>
<p> </p>
<p>5.5.1</p>
<p> </p>
<p>Functionality ..................................................................................... 49</p>
<p> </p>
<p>5.5.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 49</p>
<p> </p>
<p>5.5.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 49</p>
<p> </p>
<p>5.5.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 50</p>
<p> </p>
<p>5.6</p>
<p> </p>
<p>RequestEmissionRelatedDTCsDetectedDuringCurrentOrLastDrivingCycle </p>
<p>($07) ................................................................................................................ 51</p>
<p> </p>
<p>5.6.1</p>
<p> </p>
<p>Functionality ..................................................................................... 51</p>
<p> </p>
<p>5.6.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 51</p>
<p> </p>
<p>5.6.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 51</p>
<p> </p>
<p>5.6.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 51</p>
<p> </p>
<p>5.7</p>
<p> </p>
<p>RequestControlOfOnBoardSystemTestOrComponent ($08) ............................ 52</p>
<p> </p>
<p>5.7.1</p>
<p> </p>
<p>Functionality ..................................................................................... 52</p>
<p> </p>
<p>5.7.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 52</p>
<p> </p>
<p>5.7.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 52</p>
<p> </p>
<p>5.7.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 52</p>
<p> </p>
<p>5.8</p>
<p> </p>
<p>RequestVehicleInformation ($09) ..................................................................... 54</p>
<p> </p>
<p>5.8.1</p>
<p> </p>
<p>Functionality ..................................................................................... 54</p>
<p> </p>
<p>5.8.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 54</p>
<p> </p>
<p>5.8.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 54</p>
<p> </p>
<p>5.8.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 54</p>
<p> </p>
<p>5.9</p>
<p> </p>
<p>RequestEmissionRelatedDTCsWithPermanentStatus ($0A) ............................ 56</p>
<p> </p>
<p>5.9.1</p>
<p> </p>
<p>Functionality ..................................................................................... 56</p>
<p> </p>
<p>5.9.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 56</p>
<p> </p>
<p>5.9.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 56</p>
<p> </p>
<p>5.9.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 56</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>14 </p>
<p>based on template version 5.0.0 </p>
<p>5.10</p>
<p> </p>
<p>DiagnosticSessionControl ($10) ....................................................................... 57</p>
<p> </p>
<p>5.10.1</p>
<p> </p>
<p>Functionality ..................................................................................... 57</p>
<p> </p>
<p>5.10.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 57</p>
<p> </p>
<p>5.10.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 57</p>
<p> </p>
<p>5.10.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 57</p>
<p> </p>
<p>5.11</p>
<p> </p>
<p>EcuReset ($11) ................................................................................................ 59</p>
<p> </p>
<p>5.11.1</p>
<p> </p>
<p>Functionality ..................................................................................... 59</p>
<p> </p>
<p>5.11.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 59</p>
<p> </p>
<p>5.11.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 59</p>
<p> </p>
<p>5.11.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 60</p>
<p> </p>
<p>5.12</p>
<p> </p>
<p>ClearDiagnosticInformation ($14) ..................................................................... 61</p>
<p> </p>
<p>5.12.1</p>
<p> </p>
<p>Functionality ..................................................................................... 61</p>
<p> </p>
<p>5.12.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 61</p>
<p> </p>
<p>5.12.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 61</p>
<p> </p>
<p>5.12.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 61</p>
<p> </p>
<p>5.13</p>
<p> </p>
<p>ReadDiagnosticInformation ($19) ..................................................................... 62</p>
<p> </p>
<p>5.13.1</p>
<p> </p>
<p>Functionality ..................................................................................... 62</p>
<p> </p>
<p>5.13.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 62</p>
<p> </p>
<p>5.13.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 62</p>
<p> </p>
<p>5.13.3.1</p>
<p> </p>
<p>Reporting Stored DTC Environment Data ...................... 63</p>
<p> </p>
<p>5.13.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 63</p>
<p> </p>
<p>5.14</p>
<p> </p>
<p>ReadDataByIdentifier ($22) .............................................................................. 65</p>
<p> </p>
<p>5.14.1</p>
<p> </p>
<p>Functionality ..................................................................................... 65</p>
<p> </p>
<p>5.14.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 65</p>
<p> </p>
<p>5.14.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 65</p>
<p> </p>
<p>5.14.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 66</p>
<p> </p>
<p>5.15</p>
<p> </p>
<p>ReadMemoryByAddress ($23) ......................................................................... 68</p>
<p> </p>
<p>5.15.1</p>
<p> </p>
<p>Functionality ..................................................................................... 68</p>
<p> </p>
<p>5.15.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 68</p>
<p> </p>
<p>5.15.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 68</p>
<p> </p>
<p>5.15.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 69</p>
<p> </p>
<p>5.16</p>
<p> </p>
<p>ReadScalingDataByIdentifier ($24) .................................................................. 69</p>
<p> </p>
<p>5.16.1</p>
<p> </p>
<p>Functionality ..................................................................................... 69</p>
<p> </p>
<p>5.16.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 69</p>
<p> </p>
<p>5.16.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 69</p>
<p> </p>
<p>5.16.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 70</p>
<p> </p>
<p>5.17</p>
<p> </p>
<p>SecurityAccess ($27) ....................................................................................... 71</p>
<p> </p>
<p>5.17.1</p>
<p> </p>
<p>Functionality ..................................................................................... 71</p>
<p> </p>
<p>5.17.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 71</p>
<p> </p>
<p>5.17.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 71</p>
<p> </p>
<p>5.17.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 72</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>15 </p>
<p>based on template version 5.0.0 </p>
<p>5.18</p>
<p> </p>
<p>CommunicationControl ($28) ........................................................................... 74</p>
<p> </p>
<p>5.18.1</p>
<p> </p>
<p>Functionality ..................................................................................... 74</p>
<p> </p>
<p>5.18.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 74</p>
<p> </p>
<p>5.18.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 74</p>
<p> </p>
<p>5.18.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 75</p>
<p> </p>
<p>5.19</p>
<p> </p>
<p>ReadDataByPeriodicIdentifier ($2A)................................................................. 76</p>
<p> </p>
<p>5.19.1</p>
<p> </p>
<p>Functionality ..................................................................................... 76</p>
<p> </p>
<p>5.19.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 76</p>
<p> </p>
<p>5.19.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 76</p>
<p> </p>
<p>5.19.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 77</p>
<p> </p>
<p>5.20</p>
<p> </p>
<p>DynamicallyDefineDataIdentifier ($2C) ............................................................ 79</p>
<p> </p>
<p>5.20.1</p>
<p> </p>
<p>Functionality ..................................................................................... 79</p>
<p> </p>
<p>5.20.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 79</p>
<p> </p>
<p>5.20.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 79</p>
<p> </p>
<p>5.20.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 80</p>
<p> </p>
<p>5.21</p>
<p> </p>
<p>WriteDataByIdentifier ($2E).............................................................................. 82</p>
<p> </p>
<p>5.21.1</p>
<p> </p>
<p>Functionality ..................................................................................... 82</p>
<p> </p>
<p>5.21.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 82</p>
<p> </p>
<p>5.21.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 82</p>
<p> </p>
<p>5.21.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 83</p>
<p> </p>
<p>5.22</p>
<p> </p>
<p>InputOutputControlByIdentifier ($2F)................................................................ 84</p>
<p> </p>
<p>5.22.1</p>
<p> </p>
<p>Functionality ..................................................................................... 84</p>
<p> </p>
<p>5.22.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 84</p>
<p> </p>
<p>5.22.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 84</p>
<p> </p>
<p>5.22.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 86</p>
<p> </p>
<p>5.23</p>
<p> </p>
<p>RoutineControl ($31) ........................................................................................ 88</p>
<p> </p>
<p>5.23.1</p>
<p> </p>
<p>Functionality ..................................................................................... 88</p>
<p> </p>
<p>5.23.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 88</p>
<p> </p>
<p>5.23.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 88</p>
<p> </p>
<p>5.23.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 88</p>
<p> </p>
<p>5.24</p>
<p> </p>
<p>WriteMemoryByAddress ($3D) ......................................................................... 90</p>
<p> </p>
<p>5.24.1</p>
<p> </p>
<p>Functionality ..................................................................................... 90</p>
<p> </p>
<p>5.24.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 90</p>
<p> </p>
<p>5.24.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 90</p>
<p> </p>
<p>5.24.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 91</p>
<p> </p>
<p>5.25</p>
<p> </p>
<p>TesterPresent ($3E) ......................................................................................... 92</p>
<p> </p>
<p>5.25.1</p>
<p> </p>
<p>Functionality ..................................................................................... 92</p>
<p> </p>
<p>5.25.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 92</p>
<p> </p>
<p>5.25.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 92</p>
<p> </p>
<p>5.25.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 93</p>
<p> </p>
<p>5.26</p>
<p> </p>
<p>ControlDTCSetting ($85) .................................................................................. 94</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>16 </p>
<p>based on template version 5.0.0 </p>
<p>5.26.1</p>
<p> </p>
<p>Functionality ..................................................................................... 94</p>
<p> </p>
<p>5.26.2</p>
<p> </p>
<p>Required Interfaces .......................................................................... 94</p>
<p> </p>
<p>5.26.3</p>
<p> </p>
<p>Implementation Aspects ................................................................... 94</p>
<p> </p>
<p>5.26.4</p>
<p> </p>
<p>Configuration Aspects ...................................................................... 94</p>
<p> </p>
<p><b>6</b></p>
<p> </p>
<p><b>API Description ........................................................................................................... 96</b></p>
<p> </p>
<p>6.1</p>
<p> </p>
<p>Type Definitions ............................................................................................... 96</p>
<p> </p>
<p>6.1.1</p>
<p> </p>
<p>Dcm_ProtocolType ........................................................................... 96</p>
<p> </p>
<p>6.1.2</p>
<p> </p>
<p>Dcm_RecoveryInfoType ................................................................... 96</p>
<p> </p>
<p>6.2</p>
<p> </p>
<p>Services provided by DCM ............................................................................... 98</p>
<p> </p>
<p>6.2.1</p>
<p> </p>
<p>Administrative .................................................................................. 98</p>
<p> </p>
<p>6.2.1.1</p>
<p> </p>
<p>Dcm_Init() ...................................................................... 98</p>
<p> </p>
<p>6.2.1.2</p>
<p> </p>
<p>Dcm_MainFunction() ...................................................... 98</p>
<p> </p>
<p>6.2.1.3</p>
<p> </p>
<p>Dcm_MainFunctionTimer() ............................................. 99</p>
<p> </p>
<p>6.2.1.4</p>
<p> </p>
<p>Dcm_MainFunctionWorker() ........................................ 100</p>
<p> </p>
<p>6.2.1.5</p>
<p> </p>
<p>Dcm_GetVersionInfo() ................................................. 100</p>
<p> </p>
<p>6.2.1.6</p>
<p> </p>
<p>Dcm_InitMemory() ....................................................... 101</p>
<p> </p>
<p>6.2.1.7</p>
<p> </p>
<p>Dcm_ProvideRecoveryStates() .................................... 102</p>
<p> </p>
<p>6.2.2</p>
<p> </p>
<p>SWC .............................................................................................. 102</p>
<p> </p>
<p>6.2.2.1</p>
<p> </p>
<p>Dcm_GetActiveProtocol() ............................................ 102</p>
<p> </p>
<p>6.2.2.2</p>
<p> </p>
<p>Dcm_GetSecurityLevel() .............................................. 103</p>
<p> </p>
<p>6.2.2.3</p>
<p> </p>
<p>Dcm_GetSesCtrlType() ................................................ 104</p>
<p> </p>
<p>6.2.2.4</p>
<p> </p>
<p>Dcm_ResetToDefaultSession() .................................... 104</p>
<p> </p>
<p>6.2.2.5</p>
<p> </p>
<p>Dcm_GetSecurityLevelFixedBytes() ............................ 105</p>
<p> </p>
<p>6.2.2.6</p>
<p> </p>
<p>Dcm_SetActiveDiagnostic() ......................................... 106</p>
<p> </p>
<p>6.2.2.7</p>
<p> </p>
<p>Dcm_GetRequestKind() ............................................... 107</p>
<p> </p>
<p>6.2.3</p>
<p> </p>
<p>General Purpose ............................................................................ 108</p>
<p> </p>
<p>6.2.3.1</p>
<p> </p>
<p>Dcm_GetTesterSourceAddress() ................................. 108</p>
<p> </p>
<p>6.2.3.2</p>
<p> </p>
<p>Dcm_ProcessVirtualRequest() ..................................... 109</p>
<p> </p>
<p>6.2.3.3</p>
<p> </p>
<p>Dcm_SetSecurityLevel() .............................................. 110</p>
<p> </p>
<p>6.3</p>
<p> </p>
<p>Services used by DCM.................................................................................... 111</p>
<p> </p>
<p>6.4</p>
<p> </p>
<p>Callback Functions ......................................................................................... 112</p>
<p> </p>
<p>6.4.1</p>
<p> </p>
<p>&lt;Module&gt; ....................................................................................... 112</p>
<p> </p>
<p>6.4.1.1</p>
<p> </p>
<p>Dcm_ExternalProcessingDone() .................................. 112</p>
<p> </p>
<p>6.4.1.2</p>
<p> </p>
<p>Dcm_ExternalSetNegResponse() ................................ 113</p>
<p> </p>
<p>6.4.2</p>
<p> </p>
<p>ComM ............................................................................................ 113</p>
<p> </p>
<p>6.4.2.1</p>
<p> </p>
<p>Dcm_ComM_NoComModeEntered() ........................... 113</p>
<p> </p>
<p>6.4.2.2</p>
<p> </p>
<p>Dcm_ComM_SilentComModeEntered() ....................... 114</p>
<p> </p>
<p>6.4.2.3</p>
<p> </p>
<p>Dcm_ComM_FullComModeEntered() .......................... 114</p>
<p> </p>
<p>6.4.3</p>
<p> </p>
<p>PduR .............................................................................................. 115</p>
<p> </p>
<p>6.4.3.1</p>
<p> </p>
<p>All AUTOSAR Versions ................................................ 115</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>17 </p>
<p>based on template version 5.0.0 </p>
<p>6.4.3.1.1</p>
<p> </p>
<p>Dcm_TriggerTransmit() ............................ 115</p>
<p> </p>
<p>6.4.3.2</p>
<p> </p>
<p>AUTOSAR 4 ................................................................ 116</p>
<p> </p>
<p>6.4.3.2.1</p>
<p> </p>
<p>Dcm_StartOfReception() .......................... 116</p>
<p> </p>
<p>6.4.3.2.2</p>
<p> </p>
<p>Dcm_CopyRxData() ................................. 116</p>
<p> </p>
<p>6.4.3.2.3</p>
<p> </p>
<p>Dcm_TpRxIndication() ............................. 118</p>
<p> </p>
<p>6.4.3.2.4</p>
<p> </p>
<p>Dcm_CopyTxData() ................................. 119</p>
<p> </p>
<p>6.4.3.2.5</p>
<p> </p>
<p>Dcm_TpTxConfirmation() ......................... 120</p>
<p> </p>
<p>6.4.3.2.6</p>
<p> </p>
<p>Dcm_TxConfirmation() ............................. 121</p>
<p> </p>
<p>6.4.3.3</p>
<p> </p>
<p>AUTOSAR 3 ................................................................ 122</p>
<p> </p>
<p>6.4.3.3.1</p>
<p> </p>
<p>Dcm_ProvideRxBuffer() ........................... 122</p>
<p> </p>
<p>6.4.3.3.2</p>
<p> </p>
<p>Dcm_RxIndication() ................................. 123</p>
<p> </p>
<p>6.4.3.3.3</p>
<p> </p>
<p>Dcm_ProvideTxBuffer() ............................ 124</p>
<p> </p>
<p>6.4.3.3.4</p>
<p> </p>
<p>Dcm_TxConfirmation() ............................. 125</p>
<p> </p>
<p>6.4.4</p>
<p> </p>
<p>CanTp ............................................................................................ 126</p>
<p> </p>
<p>6.4.4.1</p>
<p> </p>
<p>Dcm_OnRequestDetection() ........................................ 126</p>
<p> </p>
<p>6.5</p>
<p> </p>
<p>Configurable Interfaces .................................................................................. 126</p>
<p> </p>
<p>6.5.1</p>
<p> </p>
<p>Callout Functions ........................................................................... 126</p>
<p> </p>
<p>6.5.1.1</p>
<p> </p>
<p>&lt;Module&gt;_&lt;DiagnosticService&gt;() ................................ 127</p>
<p> </p>
<p>6.5.1.2</p>
<p> </p>
<p>&lt;Module&gt;_&lt;DiagnosticService&gt;_&lt;SubService&gt;() ........ 128</p>
<p> </p>
<p>6.5.1.3</p>
<p> </p>
<p>Dcm_SetProgConditions() ........................................... 129</p>
<p> </p>
<p>6.5.1.4</p>
<p> </p>
<p>Dcm_GetProgConditions() ........................................... 130</p>
<p> </p>
<p>6.5.1.5</p>
<p> </p>
<p>Dcm_Confirmation() ..................................................... 131</p>
<p> </p>
<p>6.5.1.6</p>
<p> </p>
<p>Dcm_ReadMemory() .................................................... 132</p>
<p> </p>
<p>6.5.1.7</p>
<p> </p>
<p>Dcm_WriteMemory() .................................................... 133</p>
<p> </p>
<p>6.5.1.8</p>
<p> </p>
<p>&lt;Diagnostic Session Change Notification Callback&gt; .... 134</p>
<p> </p>
<p>6.5.1.9</p>
<p> </p>
<p>&lt;Security Access Change Notification Callback&gt; ......... 135</p>
<p> </p>
<p>6.5.1.10</p>
<p> </p>
<p>Dcm_GetRecoveryStates() .......................................... 136</p>
<p> </p>
<p>6.5.1.11</p>
<p> </p>
<p>Dcm_FilterDidLookUpResult ........................................ 137</p>
<p> </p>
<p>6.5.1.12</p>
<p> </p>
<p>Dcm_FilterRidLookUpResult ........................................ 138</p>
<p> </p>
<p>6.5.2</p>
<p> </p>
<p>Required Port Operation Functions ................................................ 139</p>
<p> </p>
<p>6.5.2.1</p>
<p> </p>
<p>ConditionCheckRead() ................................................. 139</p>
<p> </p>
<p>6.5.2.2</p>
<p> </p>
<p>ReadData() (asynchronous) ......................................... 140</p>
<p> </p>
<p>6.5.2.3</p>
<p> </p>
<p>ReadData() (synchronous) ........................................... 140</p>
<p> </p>
<p>6.5.2.4</p>
<p> </p>
<p>ReadDataLength() ....................................................... 141</p>
<p> </p>
<p>6.5.2.5</p>
<p> </p>
<p>WriteData() (dynamic length) ....................................... 142</p>
<p> </p>
<p>6.5.2.6</p>
<p> </p>
<p>WriteData() (static length) ............................................ 143</p>
<p> </p>
<p>6.5.2.7</p>
<p> </p>
<p>ReturnControlToECU() ................................................. 144</p>
<p> </p>
<p>6.5.2.8</p>
<p> </p>
<p>ResetToDefault() .......................................................... 145</p>
<p> </p>
<p>6.5.2.9</p>
<p> </p>
<p>FreezeCurrentState() ................................................... 146</p>
<p> </p>
<p>6.5.2.10</p>
<p> </p>
<p>ShortTermAdjustment() ................................................ 147</p>
<p> </p>
<p>6.5.2.11</p>
<p> </p>
<p>GetScalingInformation() ............................................... 148</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>18 </p>
<p>based on template version 5.0.0 </p>
<p>6.5.2.12</p>
<p> </p>
<p>Start() .......................................................................... 149</p>
<p> </p>
<p>6.5.2.13</p>
<p> </p>
<p>Stop() ........................................................................... 150</p>
<p> </p>
<p>6.5.2.14</p>
<p> </p>
<p>RequestResults() ......................................................... 151</p>
<p> </p>
<p>6.5.2.15</p>
<p> </p>
<p>GetSeed() (with SADR) ................................................ 152</p>
<p> </p>
<p>6.5.2.16</p>
<p> </p>
<p>GetSeed() (without SADR) ........................................... 153</p>
<p> </p>
<p>6.5.2.17</p>
<p> </p>
<p>CompareKey() ............................................................. 154</p>
<p> </p>
<p>6.5.2.18</p>
<p> </p>
<p>Indication() ................................................................... 155</p>
<p> </p>
<p>6.5.2.19</p>
<p> </p>
<p>Confirmation() .............................................................. 156</p>
<p> </p>
<p>6.5.2.20</p>
<p> </p>
<p>GetDTRValue() ............................................................ 157</p>
<p> </p>
<p>6.5.2.21</p>
<p> </p>
<p>RequestControl() ......................................................... 158</p>
<p> </p>
<p>6.5.2.22</p>
<p> </p>
<p>GetInfotypeValueData()................................................ 159</p>
<p> </p>
<p>6.5.2.23</p>
<p> </p>
<p>StartProtocol() .............................................................. 160</p>
<p> </p>
<p>6.5.2.24</p>
<p> </p>
<p>IsDidAvailable() ............................................................ 161</p>
<p> </p>
<p>6.5.2.25</p>
<p> </p>
<p>ReadDidData() ............................................................. 162</p>
<p> </p>
<p>6.5.2.26</p>
<p> </p>
<p>WriteDidData() ............................................................. 163</p>
<p> </p>
<p>6.5.2.27</p>
<p> </p>
<p>GetSecurityAttemptCounter() ....................................... 164</p>
<p> </p>
<p>6.5.2.28</p>
<p> </p>
<p>SetSecurityAttemptCounter() ....................................... 165</p>
<p> </p>
<p>6.5.2.29</p>
<p> </p>
<p>ReadData() (paged-data-reading) ................................ 166</p>
<p> </p>
<p>6.6</p>
<p> </p>
<p>Service Ports ................................................................................................. 166</p>
<p> </p>
<p>6.6.1</p>
<p> </p>
<p>Client-Server Interface ................................................................... 166</p>
<p> </p>
<p>6.6.1.1</p>
<p> </p>
<p>Provide Ports on DCM Side ......................................... 166</p>
<p> </p>
<p>6.6.1.1.1</p>
<p> </p>
<p>DCMServices ........................................... 167</p>
<p> </p>
<p>6.6.1.2</p>
<p> </p>
<p>Require Ports on DCM Side ......................................... 167</p>
<p> </p>
<p>6.6.1.2.1</p>
<p> </p>
<p>DataServices_&lt;DataName&gt; .................... 168</p>
<p> </p>
<p>6.6.1.2.2</p>
<p> </p>
<p>RoutineServices_&lt;RoutineName&gt; ........... 168</p>
<p> </p>
<p>6.6.1.2.3</p>
<p> </p>
<p>SecurityAccess_&lt;SecurityLevelName&gt; .... 168</p>
<p> </p>
<p>6.6.1.2.4</p>
<p>ServiceRequestManufacturerNotification_&lt;SWC&gt; 169</p>
<p> </p>
<p>6.6.1.2.5</p>
<p> . </p>
<p>ServiceRequestSupplierNotification_&lt;SWC&gt; 169</p>
<p> </p>
<p>6.6.1.2.6</p>
<p> </p>
<p>DtrServices_&lt;MIDName&gt;_&lt;TIDName&gt; ... 169</p>
<p> </p>
<p>6.6.1.2.7</p>
<p> </p>
<p>RequestControlServices_&lt;TIDName&gt; ..... 169</p>
<p> </p>
<p>6.6.1.2.8</p>
<p> </p>
<p>InfotypeServices_&lt;VEHINFODATA&gt; ........ 169</p>
<p> </p>
<p>6.6.1.2.9</p>
<p> </p>
<p>CallbackDCMRequestServices_&lt;SWC&gt; .. 169</p>
<p> </p>
<p>6.6.1.2.10</p>
<p> ...... </p>
<p>DataServices_DIDRange_&lt;RangeName&gt; 170</p>
<p> </p>
<p>6.6.2</p>
<p> </p>
<p>Managed Mode Declaration Groups ............................................... 170</p>
<p> </p>
<p>6.6.2.1</p>
<p> </p>
<p>DcmDiagnosticSessionControl ..................................... 170</p>
<p> </p>
<p>6.6.2.2</p>
<p> </p>
<p>DcmCommunicationControl_&lt;ComM_CHANNEL_SNV&gt;171</p>
<p> </p>
<p>6.6.2.3</p>
<p> </p>
<p>DcmEcuReset .............................................................. 172</p>
<p> </p>
<p>6.6.2.4</p>
<p> </p>
<p>DcmModeRapidPowerShutDown ................................. 173</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>19 </p>
<p>based on template version 5.0.0 </p>
<p>6.6.2.5</p>
<p> </p>
<p>DcmControlDTCSetting ............................................... 173</p>
<p> </p>
<p>6.6.2.6</p>
<p> </p>
<p>DcmSecurityAccess ..................................................... 174</p>
<p> </p>
<p><b>7</b></p>
<p> </p>
<p><b>Configuration ............................................................................................................ 175</b></p>
<p> </p>
<p>7.1</p>
<p> </p>
<p>Configuration Variants .................................................................................... 175</p>
<p> </p>
<p>7.2</p>
<p> </p>
<p>Configurable Attributes ................................................................................... 175</p>
<p> </p>
<p><b>8</b></p>
<p> </p>
<p><b>AUTOSAR Standard Compliance............................................................................. 176</b></p>
<p> </p>
<p>8.1</p>
<p> </p>
<p>Deviations ...................................................................................................... 176</p>
<p> </p>
<p>8.2</p>
<p> </p>
<p>Additions/ Extensions ..................................................................................... 177</p>
<p> </p>
<p>8.3</p>
<p> </p>
<p>Limitations...................................................................................................... 178</p>
<p> </p>
<p><b>9</b></p>
<p> </p>
<p><b>Using the DCM .......................................................................................................... 179</b></p>
<p> </p>
<p>9.1</p>
<p> </p>
<p>How to Reduce RAM Usage .......................................................................... 179</p>
<p> </p>
<p>9.2</p>
<p> </p>
<p>How to Reduce DCM Main-Function Run Time Usage ................................... 181</p>
<p> </p>
<p>9.3</p>
<p> </p>
<p>How to Force DCM to not Respond on Requests with Response SIDs .......... 182</p>
<p> </p>
<p>9.4</p>
<p> </p>
<p>How to Handle Multiple Diagnostic Clients Simultaneously ............................ 183</p>
<p> </p>
<p>9.5</p>
<p> </p>
<p>How to Restrict a Diagnostic Service Execution by a Condition ..................... 183</p>
<p> </p>
<p>9.6</p>
<p> </p>
<p>How to Get Notified on a Diagnostic Service Execution Start and End ........... 184</p>
<p> </p>
<p>9.7</p>
<p> </p>
<p>How to Limit the Diagnostic Service Processing Time .................................... 184</p>
<p> </p>
<p>9.8</p>
<p> </p>
<p>How to Jump into the FBL from Service DiagnosticSessionControl ($10) ....... 185</p>
<p> </p>
<p>9.9</p>
<p> </p>
<p>The HIS Compliant Jump into FBL ................................................................. 185</p>
<p> </p>
<p>9.9.1</p>
<p> </p>
<p>The HIS Alternative Jump into FBL ................................................ 185</p>
<p> </p>
<p>9.10</p>
<p> </p>
<p>How to Put DCM in a Non-Default Session at ECU Power-On ....................... 185</p>
<p> </p>
<p>9.11</p>
<p> </p>
<p>How to Support Calibrateable Configuration Parameters ............................... 186</p>
<p> </p>
<p>9.11.1</p>
<p> </p>
<p>OBD Calibration ............................................................................. 187</p>
<p> </p>
<p>9.11.1.1</p>
<p> </p>
<p>Calibration of Supported OBD Services ....................... 187</p>
<p> </p>
<p>9.11.1.2</p>
<p> </p>
<p>Calibration of Supported OBD Parameter Identifier ...... 188</p>
<p> </p>
<p>9.12</p>
<p> </p>
<p>How and When to Configure Multiple Protocols ............................................. 191</p>
<p> </p>
<p>9.12.1</p>
<p> </p>
<p>Diagnostic Client(s) Processing Prioritization ................................. 191</p>
<p> </p>
<p>9.12.2</p>
<p> </p>
<p>Client Specific Diagnostic Application Timings ................................ 195</p>
<p> </p>
<p>9.12.3</p>
<p> </p>
<p>Diagnostic Service Firewall ............................................................ 195</p>
<p> </p>
<p>9.13</p>
<p> </p>
<p>How to Select DEM-DCM Interface Version ................................................... 196</p>
<p> </p>
<p>9.14</p>
<p> </p>
<p>How to Support OBD and UDS over a Single Client Connection .................... 196</p>
<p> </p>
<p>9.15</p>
<p> </p>
<p>How to Use a User Configuration File ............................................................ 197</p>
<p> </p>
<p>9.16</p>
<p> </p>
<p>How to Know When the Security Access Level Changes ............................... 197</p>
<p> </p>
<p>9.16.1</p>
<p> </p>
<p>Invoking a Mode Switch ................................................................. 198</p>
<p> </p>
<p>9.16.2</p>
<p> </p>
<p>Calling a Function Implemented Within a CDD Module .................. 198</p>
<p> </p>
<p>9.17</p>
<p> </p>
<p>How to Deal with the PduR AR version .......................................................... 199</p>
<p> </p>
<p>9.17.1</p>
<p> </p>
<p>AUTOSAR 3 Environment .............................................................. 199</p>
<p> </p>
<p>9.17.2</p>
<p> </p>
<p>AUTOSAR 4 Environment .............................................................. 199</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>20 </p>
<p>based on template version 5.0.0 </p>
<p>9.18</p>
<p> </p>
<p>Post-build Support ......................................................................................... 199</p>
<p> </p>
<p>9.18.1</p>
<p> </p>
<p>Post-build Variance Level ............................................................... 199</p>
<p> </p>
<p>9.18.1.1</p>
<p> </p>
<p>Communication Part .................................................... 200</p>
<p> </p>
<p>9.18.1.2</p>
<p> </p>
<p>Diagnostic Services Part .............................................. 200</p>
<p> </p>
<p>9.18.1.2.1</p>
<p> </p>
<p>Handling of State Execution </p>
<p>Preconditions of Variant Diagnostic </p>
<p>Entities ..................................................... 203</p>
<p> </p>
<p>9.18.2</p>
<p> </p>
<p>Initialization .................................................................................... 205</p>
<p> </p>
<p>9.18.2.1</p>
<p> </p>
<p>Error Detection and Handling ....................................... 205</p>
<p> </p>
<p>9.18.3</p>
<p> </p>
<p>Post-build Variants ......................................................................... 206</p>
<p> </p>
<p>9.18.3.1</p>
<p> </p>
<p>Post-build selectable .................................................... 206</p>
<p> </p>
<p>9.18.3.2</p>
<p> </p>
<p>Post-build loadable ...................................................... 206</p>
<p> </p>
<p>9.18.3.3</p>
<p> </p>
<p>Post-build loadable selectable ..................................... 206</p>
<p> </p>
<p>9.18.3.4</p>
<p> </p>
<p>Post-build deleteable ................................................... 207</p>
<p> </p>
<p>9.19</p>
<p> </p>
<p>Handling with DID Ranges ............................................................................. 207</p>
<p> </p>
<p>9.19.1</p>
<p> </p>
<p>Introduction .................................................................................... 207</p>
<p> </p>
<p>9.19.2</p>
<p> </p>
<p>Implementation Limitations............................................................. 207</p>
<p> </p>
<p>9.19.3</p>
<p> </p>
<p>Configuration Aspects .................................................................... 208</p>
<p> </p>
<p>9.20</p>
<p> </p>
<p>How to Support DID 0xF186 .......................................................................... 208</p>
<p> </p>
<p>9.21</p>
<p> </p>
<p>How to Suppress Responses to Functional Addressed Requests .................. 209</p>
<p> </p>
<p>9.22</p>
<p> </p>
<p>How to Support Interruption on Requests with Foreign N_TA ......................... 209</p>
<p> </p>
<p>9.23</p>
<p> </p>
<p>How to Know When the Diagnostic Session Changes ................................... 210</p>
<p> </p>
<p>9.24</p>
<p> </p>
<p>How to Save RAM using Paged-Buffer for Large DIDs................................... 210</p>
<p> </p>
<p>9.24.1</p>
<p> </p>
<p>Introduction .................................................................................... 210</p>
<p> </p>
<p>9.24.2</p>
<p> </p>
<p>Functionality ................................................................................... 211</p>
<p> </p>
<p>9.24.3</p>
<p> </p>
<p>Implementation Limitations............................................................. 212</p>
<p> </p>
<p>9.24.4</p>
<p> </p>
<p>Usage ............................................................................................ 212</p>
<p> </p>
<p>9.24.4.1</p>
<p> </p>
<p>Straightforward DID Paged-Data Reading ................... 213</p>
<p> </p>
<p>9.24.4.2</p>
<p> </p>
<p>Error Handling During DID Paged-Data Reading ......... 213</p>
<p> </p>
<p>9.24.5</p>
<p> </p>
<p>Configuration Aspects .................................................................... 217</p>
<p> </p>
<p>9.25</p>
<p> </p>
<p>How to Get Security-Access Level Specific Fixed Byte Values ....................... 218</p>
<p> </p>
<p>9.25.1</p>
<p> </p>
<p>Introduction .................................................................................... 218</p>
<p> </p>
<p>9.25.2</p>
<p> </p>
<p>Usage ............................................................................................ 219</p>
<p> </p>
<p>9.25.3</p>
<p> </p>
<p>Configuration Aspects .................................................................... 219</p>
<p> </p>
<p>9.26</p>
<p> </p>
<p>How to Extend the Diag Keep Alive Time during Diagnostics ......................... 219</p>
<p> </p>
<p>9.26.1</p>
<p> </p>
<p>Problem Description ....................................................................... 219</p>
<p> </p>
<p>9.26.2</p>
<p> </p>
<p>Configuration Aspects .................................................................... 220</p>
<p> </p>
<p>9.27</p>
<p> </p>
<p>How to Recover DCM State Context on ECU Reset/ Power On ..................... 220</p>
<p> </p>
<p>9.27.1</p>
<p> </p>
<p>Introduction .................................................................................... 220</p>
<p> </p>
<p>9.27.2</p>
<p> </p>
<p>Functionality ................................................................................... 220</p>
<p> </p>
<p>9.27.3</p>
<p> </p>
<p>Configuration Aspect ...................................................................... 221</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>21 </p>
<p>based on template version 5.0.0 </p>
<p>9.28</p>
<p> </p>
<p>How to Define a Diagnostic Connection without USDT Responses ................ 221</p>
<p> </p>
<p>9.29</p>
<p> </p>
<p>How to Handle Multiple Diagnostic Service Variants ...................................... 221</p>
<p> </p>
<p>9.29.1</p>
<p> </p>
<p>Introduction .................................................................................... 221</p>
<p> </p>
<p>9.29.2</p>
<p> </p>
<p>Filtering Level Availability and the Corresponding Filtering Tools .... 222</p>
<p> </p>
<p>9.29.3</p>
<p> </p>
<p>Filtering OBD Objects .................................................................... 223</p>
<p> </p>
<p>9.29.3.1</p>
<p> </p>
<p>Suggested Preparation Methodology for Filtering </p>
<p>Process of OBD Objects .............................................. 224</p>
<p> </p>
<p>9.30</p>
<p> </p>
<p>How to Switch Between OBD DTR Support by DCM and DEM ...................... 224</p>
<p> </p>
<p>9.30.1</p>
<p> </p>
<p>Implementation Particularities and Limitations................................ 224</p>
<p> </p>
<p>9.30.2</p>
<p> </p>
<p>Configuration Aspect ...................................................................... 225</p>
<p> </p>
<p>9.31</p>
<p> </p>
<p>How to Enable Support of OBD VIDs with Dynamic Length ........................... 225</p>
<p> </p>
<p>9.31.1</p>
<p> </p>
<p>Implementation Limitations............................................................. 225</p>
<p> </p>
<p>9.32</p>
<p> </p>
<p>How to setup DCM for Sender-Receiver Communication ............................... 226</p>
<p> </p>
<p>9.32.1</p>
<p> </p>
<p>Implementation Limitations............................................................. 226</p>
<p> </p>
<p>9.32.2</p>
<p> </p>
<p>Application usage Scenario ............................................................ 227</p>
<p> </p>
<p>9.32.3</p>
<p> </p>
<p>Configuration Aspects .................................................................... 228</p>
<p> </p>
<p>9.33</p>
<p> </p>
<p>How to Support Routine Info Byte with UDS RIDs.......................................... 229</p>
<p> </p>
<p>9.33.1</p>
<p> </p>
<p>Introduction .................................................................................... 229</p>
<p> </p>
<p>9.33.2</p>
<p> </p>
<p>Configuration Aspects .................................................................... 229</p>
<p> </p>
<p><b>10</b></p>
<p> </p>
<p><b>Troubleshooting ....................................................................................................... 230</b></p>
<p> </p>
<p>10.1</p>
<p> </p>
<p>Compile Error Messages ................................................................................ 230</p>
<p> </p>
<p>10.2</p>
<p> </p>
<p>Code Generation Time Messages .................................................................. 231</p>
<p> </p>
<p><b>11</b></p>
<p> </p>
<p><b>Glossary and Abbreviations .................................................................................... 234</b></p>
<p> </p>
<p>11.1</p>
<p> </p>
<p>Glossary ........................................................................................................ 234</p>
<p> </p>
<p>11.2</p>
<p> </p>
<p>Abbreviations ................................................................................................. 234</p>
<p> </p>
<p><b>12</b></p>
<p> </p>
<p><b>Contact ...................................................................................................................... 236</b></p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>22 </p>
<p>based on template version 5.0.0 </p>
<p><b>Illustrations </b></p>
<p>Figure 2-1</p>
<p> </p>
<p>AUTOSAR 4.2 Architecture Overview ....................................................... 30</p>
<p> </p>
<p>Figure 2-2</p>
<p> </p>
<p>Interfaces to adjacent modules of the DCM .............................................. 31</p>
<p> </p>
<p>Figure 4-1</p>
<p> </p>
<p>Include structure ....................................................................................... 39</p>
<p> </p>
<p>Figure 9-1</p>
<p> </p>
<p>Straightforward DID paged-data reading ................................................. 213</p>
<p> </p>
<p>Figure 9-2</p>
<p> </p>
<p>DID paged-data reading cancelled due to TP layer transmission abortion215</p>
<p> </p>
<p>Figure 9-3</p>
<p> </p>
<p>Protocol preemption during DID paged-data access ............................... 216</p>
<p> </p>
<p>Figure 9-4</p>
<p> </p>
<p>RCR-RP limit reached during DID paged-data access ............................ 217</p>
<p> </p>
<p><b> </b></p>
<p><b>Tables </b></p>
<p>Table 1-1 </p>
<p> </p>
<p>Component history.................................................................................... 27</p>
<p> </p>
<p>Table 3-1 </p>
<p> </p>
<p>Supported AUTOSAR standard conform features ..................................... 32</p>
<p> </p>
<p>Table 3-2 </p>
<p> </p>
<p>Not supported AUTOSAR standard conform features ............................... 32</p>
<p> </p>
<p>Table 3-3 </p>
<p> </p>
<p>Features provided beyond the AUTOSAR standard .................................. 33</p>
<p> </p>
<p>Table 3-4 </p>
<p> </p>
<p>DET Service IDs ....................................................................................... 36</p>
<p> </p>
<p>Table 3-5 </p>
<p> </p>
<p>Errors reported to DET ............................................................................. 36</p>
<p> </p>
<p>Table 4-1 </p>
<p> </p>
<p>Static files ................................................................................................. 37</p>
<p> </p>
<p>Table 4-2 </p>
<p> </p>
<p>Generated files ......................................................................................... 38</p>
<p> </p>
<p>Table 4-3 </p>
<p> </p>
<p>Compiler abstraction and memory mapping .............................................. 40</p>
<p> </p>
<p>Table 5-1 </p>
<p> </p>
<p>Service $01: Implementation types ........................................................... 43</p>
<p> </p>
<p>Table 5-2 </p>
<p> </p>
<p>Service $01: Supported subservices ......................................................... 43</p>
<p> </p>
<p>Table 5-3 </p>
<p> </p>
<p>Service $02: Implementation types ........................................................... 45</p>
<p> </p>
<p>Table 5-4 </p>
<p> </p>
<p>Service $02: Supported subservices ......................................................... 45</p>
<p> </p>
<p>Table 5-5 </p>
<p> </p>
<p>Service $03: Implementation types ........................................................... 47</p>
<p> </p>
<p>Table 5-6 </p>
<p> </p>
<p>Service $03: Supported subservices ......................................................... 47</p>
<p> </p>
<p>Table 5-7 </p>
<p> </p>
<p>Service $04: Implementation types ........................................................... 48</p>
<p> </p>
<p>Table 5-8 </p>
<p> </p>
<p>Service $04: Supported subservices ......................................................... 48</p>
<p> </p>
<p>Table 5-9 </p>
<p> </p>
<p>Service $06: Implementation types ........................................................... 49</p>
<p> </p>
<p>Table 5-10 </p>
<p> </p>
<p>Service $06: Supported subservices ......................................................... 49</p>
<p> </p>
<p>Table 5-11 </p>
<p> </p>
<p>Service $07: Implementation types ........................................................... 51</p>
<p> </p>
<p>Table 5-12 </p>
<p> </p>
<p>Service $07: Supported subservices ......................................................... 51</p>
<p> </p>
<p>Table 5-13 </p>
<p> </p>
<p>Service $08: Implementation types ........................................................... 52</p>
<p> </p>
<p>Table 5-14 </p>
<p> </p>
<p>Service $08: Supported subservices ......................................................... 52</p>
<p> </p>
<p>Table 5-15 </p>
<p> </p>
<p>Service $09: Implementation types ........................................................... 54</p>
<p> </p>
<p>Table 5-16 </p>
<p> </p>
<p>Service $09: Supported subservices ......................................................... 54</p>
<p> </p>
<p>Table 5-17 </p>
<p> </p>
<p>Service $0A: Implementation types ........................................................... 56</p>
<p> </p>
<p>Table 5-18 </p>
<p> </p>
<p>Service $0A: Supported subservices ........................................................ 56</p>
<p> </p>
<p>Table 5-19 </p>
<p> </p>
<p>Service $10: Implementation types ........................................................... 57</p>
<p> </p>
<p>Table 5-20 </p>
<p> </p>
<p>Service $10: Supported subservices ......................................................... 57</p>
<p> </p>
<p>Table 5-21 </p>
<p> </p>
<p>Service $11: Implementation types ........................................................... 59</p>
<p> </p>
<p>Table 5-22 </p>
<p> </p>
<p>Service $11: Supported subservices ......................................................... 60</p>
<p> </p>
<p>Table 5-23 </p>
<p> </p>
<p>Service $14: Implementation types ........................................................... 61</p>
<p> </p>
<p>Table 5-24 </p>
<p> </p>
<p>Service $14: Supported subservices ......................................................... 61</p>
<p> </p>
<p>Table 5-25 </p>
<p> </p>
<p>Service $19: Implementation types ........................................................... 62</p>
<p> </p>
<p>Table 5-26 </p>
<p> </p>
<p>Service $19: Supported subservices ......................................................... 62</p>
<p> </p>
<p>Table 5-27 </p>
<p> </p>
<p>Service $22: Implementation types ........................................................... 65</p>
<p> </p>
<p>Table 5-28 </p>
<p> </p>
<p>Service $22: Supported subservices ......................................................... 65</p>
<p> </p>
<p>Table 5-29 </p>
<p> </p>
<p>Service $23: Implementation types ........................................................... 68</p>
<p> </p>
<p>Table 5-30 </p>
<p> </p>
<p>Service $23: Supported subservices ......................................................... 68</p>
<p> </p>
<p>Table 5-31 </p>
<p> </p>
<p>Service $24: Implementation types ........................................................... 69</p>
<p> </p>
<p>Table 5-32 </p>
<p> </p>
<p>Service $24: Supported subservices ......................................................... 69</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>23 </p>
<p>based on template version 5.0.0 </p>
<p>Table 5-33 </p>
<p> </p>
<p>Service $27: Implementation types ........................................................... 71</p>
<p> </p>
<p>Table 5-34 </p>
<p> </p>
<p>Service $27: Supported subservices ......................................................... 71</p>
<p> </p>
<p>Table 5-35 </p>
<p> </p>
<p>Service $28: Implementation types ........................................................... 74</p>
<p> </p>
<p>Table 5-36 </p>
<p> </p>
<p>Service $28: Supported subservices ......................................................... 74</p>
<p> </p>
<p>Table 5-37 </p>
<p> </p>
<p>Service $2A: Implementation types ........................................................... 76</p>
<p> </p>
<p>Table 5-38 </p>
<p> </p>
<p>Service $2A: Supported subservices ........................................................ 76</p>
<p> </p>
<p>Table 5-39 </p>
<p> </p>
<p>Service $2C: Implementation types .......................................................... 79</p>
<p> </p>
<p>Table 5-40 </p>
<p> </p>
<p>Service $2C: Supported subservices ........................................................ 79</p>
<p> </p>
<p>Table 5-41 </p>
<p> </p>
<p>Service $2E: Implementation types ........................................................... 82</p>
<p> </p>
<p>Table 5-42 </p>
<p> </p>
<p>Service $2E: Supported subservices ........................................................ 82</p>
<p> </p>
<p>Table 5-43 </p>
<p> </p>
<p>Service $2F: Implementation types ........................................................... 84</p>
<p> </p>
<p>Table 5-44 </p>
<p> </p>
<p>Service $2F: Supported subservices ........................................................ 84</p>
<p> </p>
<p>Table 5-45 </p>
<p> </p>
<p>Service $31: Implementation types ........................................................... 88</p>
<p> </p>
<p>Table 5-46 </p>
<p> </p>
<p>Service $31: Supported subservices ......................................................... 88</p>
<p> </p>
<p>Table 5-47 </p>
<p> </p>
<p>Service $3D: Implementation types .......................................................... 90</p>
<p> </p>
<p>Table 5-48 </p>
<p> </p>
<p>Service $3D: Supported subservices ........................................................ 90</p>
<p> </p>
<p>Table 5-49 </p>
<p> </p>
<p>Service $3E: Implementation types ........................................................... 92</p>
<p> </p>
<p>Table 5-50 </p>
<p> </p>
<p>Service $3E: Supported subservices ........................................................ 92</p>
<p> </p>
<p>Table 5-51 </p>
<p> </p>
<p>Service $85: Implementation types ........................................................... 94</p>
<p> </p>
<p>Table 5-52 </p>
<p> </p>
<p>Service $85: Supported subservices ......................................................... 94</p>
<p> </p>
<p>Table 6-1 </p>
<p> </p>
<p>Dcm_ProtocolType ................................................................................... 96</p>
<p> </p>
<p>Table 6-2 </p>
<p> </p>
<p>Dcm_RecoveryInfoType ........................................................................... 97</p>
<p> </p>
<p>Table 6-3 </p>
<p> </p>
<p>Dcm_Init() ................................................................................................. 98</p>
<p> </p>
<p>Table 6-4 </p>
<p> </p>
<p>Dcm_MainFunction() ................................................................................ 99</p>
<p> </p>
<p>Table 6-5 </p>
<p> </p>
<p>Dcm_MainFunctionTimer() ....................................................................... 99</p>
<p> </p>
<p>Table 6-6 </p>
<p> </p>
<p>Dcm_MainFunctionWorker() ................................................................... 100</p>
<p> </p>
<p>Table 6-7 </p>
<p> </p>
<p>Dcm_GetVersionInfo() ............................................................................ 100</p>
<p> </p>
<p>Table 6-8 </p>
<p> </p>
<p>Dcm_InitMemory() .................................................................................. 101</p>
<p> </p>
<p>Table 6-9 </p>
<p> </p>
<p>Dcm_ProvideRecoveryStates() ............................................................... 102</p>
<p> </p>
<p>Table 6-10 </p>
<p> </p>
<p>Dcm_GetActiveProtocol() ....................................................................... 103</p>
<p> </p>
<p>Table 6-11 </p>
<p> </p>
<p>Dcm_GetSecurityLevel() ......................................................................... 103</p>
<p> </p>
<p>Table 6-12 </p>
<p> </p>
<p>Dcm_GetSesCtrlType() ........................................................................... 104</p>
<p> </p>
<p>Table 6-13 </p>
<p> </p>
<p>Dcm_ResetToDefaultSession() ............................................................... 104</p>
<p> </p>
<p>Table 6-14 </p>
<p> </p>
<p>Dcm_GetSecurityLevelFixedBytes() ....................................................... 105</p>
<p> </p>
<p>Table 6-15 </p>
<p> </p>
<p>Dcm_SetActiveDiagnostic() .................................................................... 106</p>
<p> </p>
<p>Table 6-16 </p>
<p> </p>
<p>Dcm_GetRequestKind() .......................................................................... 107</p>
<p> </p>
<p>Table 6-17 </p>
<p> </p>
<p>Dcm_GetTesterSourceAddress() ............................................................ 108</p>
<p> </p>
<p>Table 6-18 </p>
<p> </p>
<p>Dcm_ProcessVirtualRequest() ................................................................ 109</p>
<p> </p>
<p>Table 6-19 </p>
<p> </p>
<p>Dcm_SetSecurityLevel() ......................................................................... 110</p>
<p> </p>
<p>Table 6-20 </p>
<p> </p>
<p>Services used by the DCM ..................................................................... 112</p>
<p> </p>
<p>Table 6-21 </p>
<p> </p>
<p>Dcm_ExternalProcessingDone() ............................................................. 113</p>
<p> </p>
<p>Table 6-22 </p>
<p> </p>
<p>Dcm_ExternalSetNegResponse() ........................................................... 113</p>
<p> </p>
<p>Table 6-23 </p>
<p> </p>
<p>Dcm_ComM_NoComModeEntered() ...................................................... 114</p>
<p> </p>
<p>Table 6-24 </p>
<p> </p>
<p>Dcm_ComM_SilentComModeEntered() .................................................. 114</p>
<p> </p>
<p>Table 6-25 </p>
<p> </p>
<p>Dcm_ComM_FullComModeEntered() ..................................................... 115</p>
<p> </p>
<p>Table 6-26 </p>
<p> </p>
<p>Dcm_TriggerTransmit () .......................................................................... 116</p>
<p> </p>
<p>Table 6-27 </p>
<p> </p>
<p>Dcm_StartOfReception() ........................................................................ 116</p>
<p> </p>
<p>Table 6-28 </p>
<p> </p>
<p>Dcm_CopyRxData() ................................................................................ 117</p>
<p> </p>
<p>Table 6-29 </p>
<p> </p>
<p>Dcm_TpRxIndication() ............................................................................ 118</p>
<p> </p>
<p>Table 6-30 </p>
<p> </p>
<p>Dcm_CopyTxData() ................................................................................ 119</p>
<p> </p>
<p>Table 6-31 </p>
<p> </p>
<p>Dcm_TpTxConfirmation()........................................................................ 120</p>
<p> </p>
<p>Table 6-32 </p>
<p> </p>
<p>Dcm_TxConfirmation() ............................................................................ 121</p>
<p> </p>
<p>Table 6-33 </p>
<p> </p>
<p>Dcm_ProvideRxBuffer () ......................................................................... 122</p>
<p> </p>
<p>Table 6-34 </p>
<p> </p>
<p>Dcm_RxIndication() ................................................................................ 123</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>24 </p>
<p>based on template version 5.0.0 </p>
<p>Table 6-35 </p>
<p> </p>
<p>Dcm_ProvideTxBuffer () ......................................................................... 124</p>
<p> </p>
<p>Table 6-36 </p>
<p> </p>
<p>Dcm_TxConfirmation() ............................................................................ 125</p>
<p> </p>
<p>Table 6-37 </p>
<p> </p>
<p>Dcm_ OnRequestDetection() .................................................................. 126</p>
<p> </p>
<p>Table 6-38 </p>
<p> </p>
<p>&lt;Module&gt;_&lt;DiagnosticService&gt;() ........................................................... 127</p>
<p> </p>
<p>Table 6-39 </p>
<p> </p>
<p>&lt;Module&gt;_&lt;DiagnosticService&gt;_&lt;SubService&gt;() ................................... 128</p>
<p> </p>
<p>Table 6-40 </p>
<p> </p>
<p>Dcm_SetProgConditions() ...................................................................... 129</p>
<p> </p>
<p>Table 6-41 </p>
<p> </p>
<p>Dcm_GetProgConditions() ...................................................................... 130</p>
<p> </p>
<p>Table 6-42 </p>
<p> </p>
<p>Dcm_Confirmation() ................................................................................ 131</p>
<p> </p>
<p>Table 6-43 </p>
<p> </p>
<p>Dcm_ReadMemory() .............................................................................. 132</p>
<p> </p>
<p>Table 6-44 </p>
<p> </p>
<p>Dcm_WriteMemory() ............................................................................... 133</p>
<p> </p>
<p>Table 6-45 </p>
<p> </p>
<p>&lt; Diagnostic Session Change Notification Callback &gt; ............................. 134</p>
<p> </p>
<p>Table 6-46 </p>
<p> </p>
<p>&lt;Security Access Change Notification Callback&gt; .................................... 135</p>
<p> </p>
<p>Table 6-47 </p>
<p> </p>
<p>Dcm_GetRecoveryStates() ..................................................................... 136</p>
<p> </p>
<p>Table 6-48 </p>
<p> </p>
<p>Dcm_FilterDidLookUpResult ................................................................... 137</p>
<p> </p>
<p>Table 6-49 </p>
<p> </p>
<p>Dcm_FilterRidLookUpResult ................................................................... 138</p>
<p> </p>
<p>Table 6-50 </p>
<p> </p>
<p>ConditionCheckRead() ........................................................................... 139</p>
<p> </p>
<p>Table 6-51 </p>
<p> </p>
<p>ReadData() (asynchronous) .................................................................... 140</p>
<p> </p>
<p>Table 6-52 </p>
<p> </p>
<p>ReadData() (synchronous) ...................................................................... 140</p>
<p> </p>
<p>Table 6-53 </p>
<p> </p>
<p>ReadDataLength() .................................................................................. 141</p>
<p> </p>
<p>Table 6-54 </p>
<p> </p>
<p>WriteData() (dynamic length) .................................................................. 142</p>
<p> </p>
<p>Table 6-55 </p>
<p> </p>
<p>WriteData() (static length) ....................................................................... 143</p>
<p> </p>
<p>Table 6-56 </p>
<p> </p>
<p>ReturnControlToECU() ............................................................................ 144</p>
<p> </p>
<p>Table 6-57 </p>
<p> </p>
<p>ResetToDefault() ..................................................................................... 145</p>
<p> </p>
<p>Table 6-58 </p>
<p> </p>
<p>FreezeCurrentState() .............................................................................. 146</p>
<p> </p>
<p>Table 6-59 </p>
<p> </p>
<p>ShortTermAdjustment() ........................................................................... 147</p>
<p> </p>
<p>Table 6-60 </p>
<p> </p>
<p>GetScalingInformation() .......................................................................... 148</p>
<p> </p>
<p>Table 6-61 </p>
<p> </p>
<p>Start() ..................................................................................................... 149</p>
<p> </p>
<p>Table 6-62 </p>
<p> </p>
<p>Stop() ..................................................................................................... 151</p>
<p> </p>
<p>Table 6-63 </p>
<p> </p>
<p>RequestResults() .................................................................................... 152</p>
<p> </p>
<p>Table 6-64 </p>
<p> </p>
<p>GetSeed() (with SADR) .......................................................................... 152</p>
<p> </p>
<p>Table 6-65 </p>
<p> </p>
<p>GetSeed() (without SADR) ...................................................................... 153</p>
<p> </p>
<p>Table 6-66 </p>
<p> </p>
<p>CompareKey() ........................................................................................ 154</p>
<p> </p>
<p>Table 6-67 </p>
<p> </p>
<p>Indication() .............................................................................................. 155</p>
<p> </p>
<p>Table 6-68 </p>
<p> </p>
<p>Confirmation() ......................................................................................... 156</p>
<p> </p>
<p>Table 6-69 </p>
<p> </p>
<p>GetDTRValue() ....................................................................................... 157</p>
<p> </p>
<p>Table 6-70 </p>
<p> </p>
<p>RequestControl() .................................................................................... 158</p>
<p> </p>
<p>Table 6-71 </p>
<p> </p>
<p>GetInfotypeValueData() .......................................................................... 159</p>
<p> </p>
<p>Table 6-72 </p>
<p> </p>
<p>StartProtocol() ........................................................................................ 160</p>
<p> </p>
<p>Table 6-73 </p>
<p> </p>
<p>IsDidAvailable () ..................................................................................... 161</p>
<p> </p>
<p>Table 6-74 </p>
<p> </p>
<p>ReadDidData() ........................................................................................ 162</p>
<p> </p>
<p>Table 6-75 </p>
<p> </p>
<p>WriteDidData() ........................................................................................ 163</p>
<p> </p>
<p>Table 6-76 </p>
<p> </p>
<p>GetSecurityAttemptCounter () ................................................................. 164</p>
<p> </p>
<p>Table 6-77 </p>
<p> </p>
<p>SetSecurityAttemptCounter () ................................................................. 165</p>
<p> </p>
<p>Table 6-78 </p>
<p> </p>
<p>ReadData() (paged-data-reading) ........................................................... 166</p>
<p> </p>
<p>Table 6-79 </p>
<p> </p>
<p>DCMServices .......................................................................................... 167</p>
<p> </p>
<p>Table 6-80 </p>
<p> </p>
<p>DataServices_&lt;DataName&gt; ................................................................... 168</p>
<p> </p>
<p>Table 6-81 </p>
<p> </p>
<p>RoutineServices_&lt;RoutineName&gt; .......................................................... 168</p>
<p> </p>
<p>Table 6-82 </p>
<p> </p>
<p>SecurityAccess_&lt;SecurityLevelName&gt; .................................................. 168</p>
<p> </p>
<p>Table 6-83 </p>
<p> </p>
<p>ServiceRequestManufacturerNotification_&lt;SWC&gt; .................................. 169</p>
<p> </p>
<p>Table 6-84 </p>
<p> </p>
<p>ServiceRequestSupplierNotification_&lt;SWC&gt; .......................................... 169</p>
<p> </p>
<p>Table 6-85 </p>
<p> </p>
<p>DtrServices_&lt;MIDName&gt;_&lt;TIDName&gt; .................................................. 169</p>
<p> </p>
<p>Table 6-86 </p>
<p> </p>
<p>RequestControlServices_&lt;TIDName&gt; .................................................... 169</p>
<p> </p>
<p>Table 6-87 </p>
<p> </p>
<p>InfotypeServices_&lt;VEHINFODATA&gt; ...................................................... 169</p>
<p> </p>
<p>Table 6-88 </p>
<p> </p>
<p>CallbackDCMRequestServices_&lt;SWC &gt; ................................................ 170</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>25 </p>
<p>based on template version 5.0.0 </p>
<p>Table 6-89 </p>
<p> </p>
<p>DataServices_DIDRange_&lt;RangeName&gt; .............................................. 170</p>
<p> </p>
<p>Table 6-90 </p>
<p> </p>
<p>ModeDeclarationGroups managed by DCM ........................................... 170</p>
<p> </p>
<p>Table 6-91 </p>
<p> </p>
<p>DcmDiagnosticSessionControl callouts................................................... 170</p>
<p> </p>
<p>Table 6-92 </p>
<p> </p>
<p>DcmDiagnosticSessionControl modes .................................................... 171</p>
<p> </p>
<p>Table 6-93 </p>
<p> </p>
<p>DcmCommunicationControl _&lt;ComM_CHANNEL_SNV&gt; callouts .......... 171</p>
<p> </p>
<p>Table 6-94 </p>
<p> </p>
<p>DcmCommunicationControl_&lt;ComM_CHANNEL_SNV&gt; modes ............ 172</p>
<p> </p>
<p>Table 6-95 </p>
<p> </p>
<p>DcmEcuReset callouts ............................................................................ 172</p>
<p> </p>
<p>Table 6-96 </p>
<p> </p>
<p>DcmEcuReset modes ............................................................................. 172</p>
<p> </p>
<p>Table 6-97 </p>
<p> </p>
<p>DcmModeRapidPowerShutDown callouts ............................................... 173</p>
<p> </p>
<p>Table 6-98 </p>
<p> </p>
<p>DcmModeRapidPowerShutDown modes ................................................ 173</p>
<p> </p>
<p>Table 6-99 </p>
<p> </p>
<p>DcmControlDTCSetting callouts ............................................................. 173</p>
<p> </p>
<p>Table 6-100 </p>
<p> </p>
<p>DcmControlDTCSetting modes ............................................................... 173</p>
<p> </p>
<p>Table 6-101 </p>
<p> </p>
<p>DcmSecurityAccess callouts ................................................................... 174</p>
<p> </p>
<p>Table 6-102 </p>
<p> </p>
<p>DcmSecurityAccess modes .................................................................... 174</p>
<p> </p>
<p>Table 8-1 </p>
<p> </p>
<p>Deviations to AUTOSAR ......................................................................... 176</p>
<p> </p>
<p>Table 8-2 </p>
<p> </p>
<p>Additions/ Extensions to AUTOSAR ........................................................ 177</p>
<p> </p>
<p>Table 8-3 </p>
<p> </p>
<p>Limitations to AUTOSAR ......................................................................... 178</p>
<p> </p>
<p>Table 9-1 </p>
<p> </p>
<p>Diagnostic services with non-trivial DCM Buffer size estimation </p>
<p>calculation method .................................................................................. 180</p>
<p> </p>
<p>Table 9-2 </p>
<p> </p>
<p>Initialization of the Dcm_ProgConditionsType for non-default session </p>
<p>activation at ECU power-on .................................................................... 186</p>
<p> </p>
<p>Table 9-3 </p>
<p> </p>
<p>Calibrateable OBD “availability parameter identifier” values .................... 189</p>
<p> </p>
<p>Table 9-4 </p>
<p> </p>
<p>Color legend to the protocol prioritization matrixes ................................. 192</p>
<p> </p>
<p>Table 9-5 </p>
<p> </p>
<p>Protocol prioritization during default session ........................................... 193</p>
<p> </p>
<p>Table 9-6 </p>
<p> </p>
<p>Protocol prioritization during non-default session .................................... 194</p>
<p> </p>
<p>Table 9-7 </p>
<p> </p>
<p>Post-build configuration rules on invariant DCM parameters ................... 203</p>
<p> </p>
<p>Table 9-8 </p>
<p> </p>
<p>Error Codes possible during Post-Build initialization failure ..................... 205</p>
<p> </p>
<p>Table 9-9 </p>
<p> </p>
<p>Filtering level availability ......................................................................... 222</p>
<p> </p>
<p>Table 9-10 </p>
<p> </p>
<p>Filter diagnostic objects and the corresponding filtering APIs / Callbacks 223</p>
<p> </p>
<p>Table 10-1 </p>
<p> </p>
<p>Compile time error messages ................................................................. 231</p>
<p> </p>
<p>Table 10-2 </p>
<p> </p>
<p>Code Generation Time Messages ........................................................... 233</p>
<p> </p>
<p>Table 11-1 </p>
<p> </p>
<p>Glossary ................................................................................................. 234</p>
<p> </p>
<p>Table 11-2 </p>
<p> </p>
<p>Abbreviations .......................................................................................... 235</p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>26 </p>
<p>based on template version 5.0.0 </p>
<p><b>1 </b></p>
<p><b>Component History </b></p>
<p>The </p>
<p>component </p>
<p>history </p>
<p>gives </p>
<p>an </p>
<p>overview </p>
<p>over </p>
<p>the </p>
<p>important </p>
<p>milestones </p>
<p>that </p>
<p>are </p>
<p>supported in the different versions of the component.  </p>
<p><b>Component Version </b></p>
<p><b>New Features </b></p>
<p>1.0.0 </p>
<p>Initial Version  </p>
<p>1.1.0 </p>
<p>Added support for diagnostic services:  </p>
<p><i>ReadDataByPeriodicIdentifier ($2A) </i></p>
<p><i>InputOutputControlByIdentifier ($2F)</i> </p>
<p>1.2.0 </p>
<p>Added support for diagnostic service: </p>
<p><i>DynamicallyDefineDataIdentifier ($2C) </i></p>
<p>Changed <i>DataServices_&lt;DataName&gt;</i> to have either all synchronous or </p>
<p>asynchronous operations. </p>
<p>1.3.0 </p>
<p>Minor improvements </p>
<p>1.4.0 </p>
<p>Support for OBD2 protocol diagnostic services </p>
<p>1.5.0 </p>
<p>Support for multi-protocol use cases and protocol prioritization </p>
<p>Support resetting of IO control operation at session change/protocol </p>
<p>preemption. </p>
<p>Support for IO control actual data reporting in the positive response of </p>
<p>SID 0x2F. </p>
<p>Support for optional <i>ConditionCheckRead() </i>DataServices operation </p>
<p>2.0.0 </p>
<p>Support for signal interfaces (C/S) for DIDs and RIDs. </p>
<p>Extended run time limitation (<i>How to Reduce DCM Main-Function Run </i></p>
<p><i>Time Usage</i>). </p>
<p>2.1.0 </p>
<p>Support for DEM AR 4.1.2 API </p>
<p>Automatic clear of DDID definition on DCM session/security level change </p>
<p>Automatic stop of PDID reading on DCM session/security level change </p>
<p>Optional SWC notification on security access level change </p>
<p>2.2.0 </p>
<p>Support NvRam signal access for DIDs </p>
<p>Support for PduR AR4.1.2 API </p>
<p>3.0.0 </p>
<p>Support for diagnostic service <i>ReadScalingDataByIdentifier ($24) </i></p>
<p>Support for post-build selectable, loadable, selectable-loadable, deletable </p>
<p>for the communication part of DCM. </p>
<p>3.1.0 </p>
<p>Support of DID ranges </p>
<p>Support for AR3 interfaces (PduR, ComM etc.) </p>
<p>4.0.0 </p>
<p>Support of response suppression on functional addressed requests </p>
<p>Support of interruption by service request with foreign N_TA </p>
<p>New include structure and module refactoring </p>
<p>Additional notification on diagnostic session and security access level </p>
<p>state transitions. </p>
<p>4.1.0 </p>
<p>Support of session specific P2/P2Star timings (<i>5.10.4 Configuration </i></p>
<p><i>Aspects</i>). </p>
<p>Non-volatile storage of security access failed attempts (<i>SecurityAccess </i></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>27 </p>
<p>based on template version 5.0.0 </p>
<p><b>Component Version </b></p>
<p><b>New Features </b></p>
<p><i>($27)</i>). </p>
<p>Configurable security level specific fixed bytes to support application </p>
<p>seed/key calculation (see <i>9.25 How to Get Security-Access Level Specific </i></p>
<p><i>Fixed Byte </i>Values). </p>
<p>Support for paged-buffer reading of DIDs over service </p>
<p><i>ReadDataByIdentifier ($22)</i>. </p>
<p>Selectable C/S or direct function-calls for service 0x27 application </p>
<p>callbacks. </p>
<p>Extensible Keep-Alive time period (see <i>9.26 How to Extend the Diag </i></p>
<p><i>Keep Alive Time during Diagnostics</i>) </p>
<p>DCM state recovery on reset /power on (<i>9.27 How to Recover DCM State </i></p>
<p><i>Context on ECU Reset/ Power</i>) </p>
<p>5.0.0 </p>
<p>Service <i>InputOutputControlByIdentifier ($2F)</i> has now improved auto-</p>
<p>resetting functionality on any diagnostic state change. </p>
<p>Service <i>TesterPresent ($3E)</i> can be handled within the application. Refer </p>
<p>to its chapter to get information on any limitations. </p>
<p>Support of diagnostic connections without response (see <i>9.28 How to </i></p>
<p><i>Define a Diagnostic Connection without USDT Responses</i>) </p>
<p><i>Support of diagnostic service variant-handling using application help (see </i></p>
<p><i>9.29 How to Handle Multiple Diagnostic Service Variants</i>) </p>
<p>5.1.0 </p>
<p>The request status/kind of a DCM diagnostic client can be acquired at any </p>
<p>time, using new provided service API <i>Dcm_GetRequestKind()</i>. </p>
<p>Support for bitmapped IO DIDs with CEMR in service </p>
<p><i>InputOutputControlByIdentifier ($2F)</i>. </p>
<p>5.2.0 </p>
<p>Minor improvements. </p>
<p><i> </i></p>
<p>7.0.0 </p>
<p>Variant handling for the DCM <i>Diagnostic Services Part. </i></p>
<p>Improved AR 4.2.2 compatibility regarding: </p>
<p>- </p>
<p><i>How to Switch Between OBD DTR Support by DCM and DEM </i></p>
<p>- </p>
<p><i>How to Enable Support of OBD VIDs with Dynamic Length</i> </p>
<p>- </p>
<p>API <i>Dcm_ReadMemory()</i> resp. <i>Dcm_WriteMemory()</i>. </p>
<p>7.1.0 </p>
<p>Automatic reporting of RoutineInfoByte parameter in UDS RIDs (see <i>9.33 </i></p>
<p><i>How to Support Routine Info Byte with UDS RIDs</i>) </p>
<p>TBD </p>
<p>Table 1-1  </p>
<p>Component history </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>28 </p>
<p>based on template version 5.0.0 </p>
<p><b>2 </b></p>
<p><b>Introduction </b></p>
<p>This document describes the functionality, API and configuration of the AUTOSAR BSW </p>
<p>module DCM as specified in [1].  </p>
<p> </p>
<p><b>Supported AUTOSAR Release*: </b></p>
<p>4 </p>
<p><b>Supported Configuration Variants: </b></p>
<p>pre-compile, post-build loadable, post-build selectable </p>
<p><b>Vendor ID: </b></p>
<p>DCM_VENDOR_ID </p>
<p>30 decimal </p>
<p>(= Vector-Informatik, </p>
<p>according to HIS) </p>
<p><b>Module ID: </b></p>
<p>DCM_MODULE_ID   </p>
<p>53 decimal </p>
<p>(according to ref. [4]) </p>
<p>* For the precise AUTOSAR Release 4.x please see the release specific documentation.  </p>
<p> </p>
<p> </p>
<p>The Autosar DCM is a software component that </p>
<p>- </p>
<p>handles the diagnostic communication between the tester and the ECUs </p>
<p>application; </p>
<p>- </p>
<p>analyzes and interprets the diagnostic communication protocol UDS based on ISO </p>
<p>14229 ([5]); </p>
<p>- </p>
<p>implements the handling of all UDS services, providing abstract interface to the </p>
<p>application by hiding all protocol specifics; </p>
<p>- </p>
<p>provides a built in handling of the fault memory manager (DEM) data acquisition; </p>
<p>- </p>
<p>provides service execution precondition validation and state management such as  </p>
<p>o</p>
<p> </p>
<p>diagnostic sessions and security access verification; </p>
<p>o</p>
<p> </p>
<p>custom ECU mode condition verification (e.g. vehicle speed, etc.) </p>
<p> </p>
<p><b>2.1 </b></p>
<p><b>How to Read This Document </b></p>
<p>Here are defined some general rules on how to read this document. </p>
<p><b>2.1.1 </b></p>
<p><b>DCM Integration and Basic Operation </b></p>
<p>We recommend  starting  with  the  chapter <i> 4  Integration</i>.  It  will  help  you  to bind  the  DCM </p>
<p>component into your project and to learn about its integration specific requirements. Once </p>
<p>the code binding is finished in your project, please go on with the <i>Functional Description </i></p>
<p>chapter to learn about how to operate the DCM. </p>
<p> </p>
<p><b>2.1.2 </b></p>
<p><b>Diagnostic Service Documentation </b></p>
<p>Once the DCM is integrated into your project, you will need to know how each diagnostic </p>
<p>service, your ECU has to support, is to be configured, implemented and handled by DCM </p>
<p>and  your  application.  For  learning  that,  please  refer  to  chapter <i> 5  Diagnostic  Service </i></p>
<p><i>Implementation</i>. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>29 </p>
<p>based on template version 5.0.0 </p>
<p><b>2.1.3 </b></p>
<p><b>API Definitions </b></p>
<p>You can any time directly refer to a DCM provided/required service or callout description </p>
<p>once you have started the DCM application implementation, by searching for the function </p>
<p>name in this document. But the usual way is to start with the usage context of the concrete </p>
<p>function you are looking for:  </p>
<p><b>&gt; </b></p>
<p>the diagnostic service it is bound to (look into the corresponding <i>Diagnostic Service </i></p>
<p><i>Implementation </i>sub-chapter<i>)</i>. </p>
<p><b>&gt; </b></p>
<p>a special feature it serves (look into the corresponding <i>Using the DCM </i>“how to…” sub-</p>
<p>chapter) </p>
<p><b>2.1.4 </b></p>
<p><b>DCM Configuration Parameter Descriptions </b></p>
<p>This document contains many references to DCM configuration parameters. The goal of </p>
<p>this  document </p>
<p>is  not  to  describe  the  parameters  in  detail, </p>
<p>but </p>
<p>to  show  you  which </p>
<p>parameters  are  bound  to  which  diagnostic  services  or  features.  All  those  parameter </p>
<p>references  are  given  as  full  path  links  within  the  DCM  Configurator  5  GCE  for  faster </p>
<p>location of the concrete parameter. Once you have followed such a link in the Configurator </p>
<p>5  tool,  please  read  the  description  information  bound  to  the  parameter.  Follow  any </p>
<p>dependency  links  from  this  description  to  learn  more  about  what  additionally  shall  be </p>
<p>configured in order to get a fully functioning configuration. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>30 </p>
<p>based on template version 5.0.0 </p>
<p><b>2.2 </b></p>
<p><b>Architecture Overview </b></p>
<p>The following figure shows where the DCM is located in the AUTOSAR architecture. </p>
<p> </p>
<p>Figure 2-1 </p>
<p>AUTOSAR 4.2 Architecture Overview  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>31 </p>
<p>based on template version 5.0.0 </p>
<p>The next figure shows the interfaces to adjacent modules of the  DCM. These interfaces </p>
<p>are described in chapter 5.  </p>
<p> </p>
<p>Figure 2-2 </p>
<p>Interfaces to adjacent modules of the DCM </p>
<p>Applications do not access the services of the BSW modules directly. They use the service </p>
<p>ports provided by the BSW modules via the RTE. The service ports provided by the DCM </p>
<p>are listed in chapter 6.5.2.1 based on their definition in [1]. In some cases where the DCM </p>
<p>requires a call out extension, the DCM calls a CDD module directly through the Dcm_Cdd </p>
<p>interface. </p>
<p><b> cmp Architecture</b></p>
<p><b>Dem</b></p>
<p><b>Dcm</b></p>
<p><b>Det</b></p>
<p><b>PduR</b></p>
<p><b>ComM</b></p>
<p><b>Rte</b></p>
<p><b>BswM</b></p>
<p><b>SchM</b></p>
<p><b>Nv M</b></p>
<p><b>EcuM</b></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>32 </p>
<p>based on template version 5.0.0 </p>
<p><b>3 </b></p>
<p><b>Functional Description </b></p>
<p><b>3.1 </b></p>
<p><b>Features </b></p>
<p>The features listed in the following tables cover the complete functionality specified for the </p>
<p>DCM. </p>
<p>The AUTOSAR  standard  functionality  is  specified  in <i> [1</i>],  the  corresponding  features  are </p>
<p>listed in the tables </p>
<p><b></b></p>
<p><b> </b></p>
<p><i>Table 3-1   Supported AUTOSAR standard conform features  </i></p>
<p><b></b></p>
<p><b> </b></p>
<p><i>Table 3-2   Not supported AUTOSAR standard conform features </i></p>
<p>For further information of not supported features see also chapter 8. </p>
<p>Vector Informatik provides further DCM functionality beyond the AUTOSAR standard. The </p>
<p>corresponding features are listed in the table </p>
<p><b></b></p>
<p><b> </b></p>
<p><i>Table 3-3   Features provided beyond the AUTOSAR standard </i></p>
<p> </p>
<p>The following features specified in <i>[1] </i>are supported: </p>
<p><b>Supported AUTOSAR Standard Conform Features </b></p>
<p>MICROSAR Identity Manager using Post-Build Selectable </p>
<p>All features not listed in <i>Table 3-2  Not supported AUTOSAR standard conform features </i>are to be </p>
<p>considered as supported. </p>
<p>Table 3-1  </p>
<p>Supported AUTOSAR standard conform features </p>
<p>The following features specified in <i>[1] </i>are not supported: </p>
<p><b>Not Supported AUTOSAR Standard Conform Features </b></p>
<p>No link time configuration support. </p>
<p>No post-build support on diagnostic services (only communication). Though an alternative </p>
<p>solution is provided (see <i>9.29</i>) </p>
<p>Table 3-2  </p>
<p>Not supported AUTOSAR standard conform features </p>
<p>The following features are provided beyond the AUTOSAR standard: </p>
<p><b>Features Provided Beyond The AUTOSAR Standard </b></p>
<p>Possibility to avoid high CPU load peaks:  </p>
<p><i>How to Reduce DCM Main-Function Run Time Usage </i></p>
<p>Optimized multi-client communication support:  </p>
<p><i>How to Handle Multiple Diagnostic Clients Simultaneously  </i></p>
<p>Run time optimized DCM DEM interface for low CPU load. </p>
<p>Native AR 4.0.3 and AR 4.1.2 DEM API version support. </p>
<p>Support for sub-functions 0x17, 0x18 and 0x19 of service <i>ReadDiagnosticInformation ($19) </i></p>
<p>according to <i>[5]</i>. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>33 </p>
<p>based on template version 5.0.0 </p>
<p><b>Features Provided Beyond The AUTOSAR Standard </b></p>
<p>Optional notification on security access level change </p>
<p>Extensible keep-alive time period: <i>How to Extend the Diag Keep Alive Time during Diagnostics </i></p>
<p>Recovery of DCM states over reset /power down: <i>How to Recover DCM State Context on ECU </i></p>
<p><i>Reset/ Power </i></p>
<p>Table 3-3  </p>
<p>Features provided beyond the AUTOSAR standard </p>
<p> </p>
<p><b>3.2 </b></p>
<p><b>Initialization </b></p>
<p>At ECU power-on boot (or any reset situation) DCM must be initialized by calling the API </p>
<p><i>Dcm_Init()</i>.  </p>
<p><b>3.3 </b></p>
<p><b>States </b></p>
<p>DCM manages currently the following state machines: </p>
<p>- </p>
<p>Diagnostic session states (managed by service <i>DiagnosticSessionControl ($10)</i>) </p>
<p>- </p>
<p>Security access states (managed by service <i>SecurityAccess ($27)</i>) </p>
<p>- </p>
<p>ECU Communication activity (managed by the ComM) </p>
<p>- </p>
<p>DTC setting allowance (managed by the Dem) </p>
<p> </p>
<p><b>3.4 </b></p>
<p><b>Main Functions </b></p>
<p>In  order  to  function  properly,  the <i> Dcm_MainFunction() </i> must  be  called  periodically  in  the </p>
<p>configured time period.   </p>
<p>To specify the DCM task cycle time, set up the configuration parameter:  </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmTaskTime </p>
<p> </p>
<p><b>3.4.1 </b></p>
<p><b>Split Task Functions </b></p>
<p><b>3.4.1.1 </b></p>
<p><b>Functionality </b></p>
<p><i>Dcm_MainFunction() </i></p>
<p>is </p>
<p>only </p>
<p>a </p>
<p>container </p>
<p>function </p>
<p>that </p>
<p>calls </p>
<p>the </p>
<p>two </p>
<p>functions </p>
<p><i>Dcm_MainFunctionTimer() </i></p>
<p>and </p>
<p><i>Dcm_MainFunctionWorker(). </i></p>
<p>Of </p>
<p>these </p>
<p>two, </p>
<p>only </p>
<p>the </p>
<p><i>Dcm_MainFunctionTimer() </i>depends on a stable cycle time. If you find it difficult to run the </p>
<p><i>Dcm_MainFunction() </i> on  a  high  priority  task  to  ensure  the  timing  behavior,  you  can </p>
<p>optionally call these two functions instead of <i>Dcm_MainFunction()</i>. </p>
<p>This allows you to run the <i>Dcm_MainFunctionTimer() </i>on a higher priority task to guarantee </p>
<p>the </p>
<p>UDS </p>
<p>timing </p>
<p>requirements </p>
<p>e.g. </p>
<p>sending </p>
<p>of </p>
<p>NRC </p>
<p>‘RequestCorrectlyRecieved-</p>
<p>ResponsePending’. </p>
<p>Please  note,  both  the <i> Dcm_MainFunctionWorker() </i> and <i> Dcm_MainFunctionTimer() </i> are </p>
<p>optimized for short run time, so this option is usually not necessary. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>34 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p><b>3.4.1.2 </b></p>
<p><b>Configuration Aspects </b></p>
<p>Per default DCM has only one <i>Dcm_MainFunction() </i>i.e. has no split tasks as specified in </p>
<p><i>[1]</i>.  In  order  to  enable  split  task  usage  in  DCM,  you  have  to  set  up  DCM  in  the </p>
<p>configuration tool as follows:  </p>
<p><b>&gt; </b></p>
<p>Activate main-function task splitting via parameter: </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmSplitTasksEnabled </p>
<p><b>&gt; </b></p>
<p>Both <i>Dcm_MainFunctionTimer() </i>and <i>Dcm_MainFunctionWorker() </i>will be scheduled for </p>
<p>the time period specified by: /Dcm/DcmConfigSet/DcmGeneral/DcmTaskTime </p>
<p><b>&gt; </b></p>
<p>Optionally you can specify different scheduling time for the </p>
<p><i>Dcm_MainFunctionWorker() </i>using parameter: </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmMainFunctionWorkerTaskTime </p>
<p> </p>
<p><b>3.4.1.3 </b></p>
<p><b>Integration Aspects </b></p>
<p>Both  main-functions  are  automatically  registered  for  scheduling  in  SchM  component  via </p>
<p>SWC-template, </p>
<p>but </p>
<p>still </p>
<p>they </p>
<p>have </p>
<p>no </p>
<p>assigned </p>
<p>task </p>
<p>priority </p>
<p>relation. </p>
<p>As </p>
<p>the </p>
<p><i>Dcm_MainFunctionTimer() </i>handles the real-time aspect of the DCM component, it must be </p>
<p>running under high OS task priority. The <i>Dcm_MainFunctionWorker() </i>shall be assigned to </p>
<p>an OS task that has a lower or equal priority compared to the <i>Dcm_MainFunctionTimer()</i>’s </p>
<p>task.  </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p><b>&gt; </b></p>
<p>Do <b>not </b>assign the <i>Dcm_MainFunctionWorker() </i>on a higher priority task than the </p>
<p><i>Dcm_MainFunctionTimer()</i>, especially not if your OS supports task preemption.  </p>
<p><b>&gt; </b></p>
<p>You need <b>both <i></b>Dcm_MainFunctionWorker() </i>and <i>Dcm_MainFunctionTimer() </i>(unless </p>
<p>you use the <i>Dcm_MainFunction()</i>). </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>3.5 </b></p>
<p><b>Error Handling </b></p>
<p><b>3.5.1 </b></p>
<p><b>Development Error Reporting </b></p>
<p>By </p>
<p>default, </p>
<p>development </p>
<p>errors </p>
<p>are </p>
<p>reported </p>
<p>to </p>
<p>the </p>
<p>DET </p>
<p>using </p>
<p>the </p>
<p>service </p>
<p>Det_ReportError()</p>
<p>  as  specified  in  [2],  if development  error reporting  is  enabled  (i.e. </p>
<p>pre-compile parameter </p>
<p>DCM_DEV_ERROR_DETECT==STD_ON</p>
<p>). </p>
<p>If  another  module  is  used  for  development  error  reporting,  the  function  prototype  for </p>
<p>reporting the error can be configured by the integrator, but must have the same signature </p>
<p>as the service </p>
<p>Det_ReportError()</p>
<p>. </p>
<p>The reported DCM ID is 53. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>35 </p>
<p>based on template version 5.0.0 </p>
<p>The  reported  service  IDs  identify  the  services  which  are  described  in  6.2. The following </p>
<p>table presents the service IDs and the related services: </p>
<p><b>Service ID </b></p>
<p><b>Service </b></p>
<p>0x00 </p>
<p><i>Dcm_StartOfReception() </i></p>
<p>0x01 </p>
<p><i>Dcm_Init() </i></p>
<p>0x02 </p>
<p><i>Dcm_CopyRxData() (</i>AR4) / <i>Dcm_ProvideRxBuffer() </i>(AR3) </p>
<p>0x03 </p>
<p><i>Dcm_TpRxIndication() </i>(AR4) / <i>Dcm_RxIndication() </i>(AR3) </p>
<p>0x04 </p>
<p><i>Dcm_CopyTxData() </i>(AR4) / <i>Dcm_ProvideTxBuffer() </i>(AR3) </p>
<p>0x05 </p>
<p><i>Dcm_TpTxConfirmation() </i>(AR4) / <i>Dcm_TxConfirmation() </i>(AR3) </p>
<p>0x06 </p>
<p><i>Dcm_GetSesCtrlType() </i></p>
<p>0x0D </p>
<p><i>Dcm_GetSecurityLevel() </i></p>
<p>0x0F </p>
<p><i>Dcm_GetActiveProtocol() </i></p>
<p>0x21 </p>
<p><i>Dcm_ComM_NoComModeEntered() </i></p>
<p>0x22 </p>
<p><i>Dcm_ComM_SilentComModeEntered() </i></p>
<p>0x23 </p>
<p><i>Dcm_ComM_FullComModeEntered() </i></p>
<p>0x24 </p>
<p><i>Dcm_GetVersionInfo() </i></p>
<p>0x25 </p>
<p><i>Dcm_MainFunction() </i></p>
<p>0x2A </p>
<p><i>Dcm_ResetToDefaultSession() </i></p>
<p>0x30 </p>
<p><i>Dcm_ExternalSetNegResponse() </i></p>
<p>0x31 </p>
<p><i>Dcm_ExternalProcessingDone() </i></p>
<p>0x32 </p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p>0x34 </p>
<p><i>ReadData() (synchronous) </i></p>
<p>0x3B </p>
<p><i>ReadData() (asynchronous) </i></p>
<p>0x3F </p>
<p><i>IsDidAvailable() </i></p>
<p>0x40 </p>
<p><i>ReadDidData() </i></p>
<p>0x41 </p>
<p><i>WriteDidData() </i></p>
<p>0x44 </p>
<p><i>GetSeed() (with SADR) </i></p>
<p>0x45 </p>
<p><i>GetSeed() (without SADR) </i></p>
<p>0x47 </p>
<p><i>CompareKey() </i></p>
<p>0x56 </p>
<p><i>Dcm_SetActiveDiagnostic() </i></p>
<p>0x59 </p>
<p><i>GetSecurityAttemptCounter() </i></p>
<p>0x5A </p>
<p><i>SetSecurityAttemptCounter() </i></p>
<p>0x60 </p>
<p><i>GetInfotypeValueData() </i></p>
<p>0xA0 </p>
<p><b>Depricated from DCM 5.00.00 and mapped to “<i>DCM internal function</i>”. </b></p>
<p>DCM internal diagnostic service processor </p>
<p>0xA1 </p>
<p><i>Dcm_TxConfirmation() </i></p>
<p>0xA2 </p>
<p><i>Dcm_TriggerTransmit() </i></p>
<p>0xA3 </p>
<p><i>Dcm_ProvideRecoveryStates() </i></p>
<p>0xA4 </p>
<p><i>Dcm_OnRequestDetection() </i></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>36 </p>
<p>based on template version 5.0.0 </p>
<p><b>Service ID </b></p>
<p><b>Service </b></p>
<p>0xA6 </p>
<p><i>Dcm_GetTesterSourceAddress() </i></p>
<p>0xA7 </p>
<p><i>Dcm_GetSecurityLevelFixedBytes() </i></p>
<p>0xA8 </p>
<p><i>Dcm_ProcessVirtualRequest() </i></p>
<p>0xA9 </p>
<p><i>Dcm_SetSecurityLevel() </i></p>
<p>0xAA </p>
<p><i>ReadData() (paged-data-reading) </i></p>
<p>0xAB </p>
<p><i>Dcm_GetRequestKind() </i></p>
<p>0xF0 </p>
<p>DCM internal function </p>
<p>Table 3-4  </p>
<p>DET Service IDs </p>
<p> </p>
<p>The errors reported to DET are described in the following table: </p>
<p><b>Error Code </b></p>
<p><b>Description </b></p>
<p>0x01 </p>
<p>DCM_E_INTERFACE_TIMEOUT </p>
<p>Timeout during interaction with other module </p>
<p>0x02 </p>
<p>DCM_E_INTERFACE_RETURN_VALUE </p>
<p>Return value of called API is out of range </p>
<p>0x03 </p>
<p>DCM_E_INTERFACE_BUFFER_OVERFLOW </p>
<p>Boundary check of provided buffers fails </p>
<p>0x05 </p>
<p>DCM_E_UNINIT </p>
<p>Executing program code before the DCM is </p>
<p>initialized </p>
<p>0x06 </p>
<p>DCM_E_PARAM </p>
<p>API call with invalid parameter value </p>
<p>0x07 </p>
<p>DCM_E_PARAM_POINTER </p>
<p>API call with invalid/null pointer parameter </p>
<p>0x40 </p>
<p>DCM_E_ILLEGAL_STATE </p>
<p>Internal DCM error, reaching an unexpected </p>
<p>state </p>
<p>0x41 </p>
<p>DCM_E_INVALID_CONFIG </p>
<p>Inconsistent configuration </p>
<p>Table 3-5  </p>
<p>Errors reported to DET </p>
<p> </p>
<p><b>3.5.2 </b></p>
<p><b>Production Code Error Reporting </b></p>
<p>Production code related errors are not supported by DCM. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>37 </p>
<p>based on template version 5.0.0 </p>
<p><b>4 </b></p>
<p><b>Integration </b></p>
<p>This chapter gives necessary information for the integration of the MICROSAR DCM into </p>
<p>an application environment of an ECU. </p>
<p><b>4.1 </b></p>
<p><b>Scope of Delivery </b></p>
<p>The delivery of the DCM contains the files which are described in the chapters 4.1.1 and </p>
<p>4.1.2:  </p>
<p><b>4.1.1 </b></p>
<p><b>Static Files  </b></p>
<p><b>File Name </b></p>
<p><b>Source </b></p>
<p><b>Code </b></p>
<p><b>Delivery </b></p>
<p><b>Object </b></p>
<p><b>Code </b></p>
<p><b>Delivery </b></p>
<p><b>Description </b></p>
<p>Dcm.c </p>
<p></p>
<p> </p>
<p> </p>
<p>This is the implementation source file of the DCM </p>
<p>(delivered only for the “pre-compile” variant).</p>
<p> </p>
<p>Dcm_Ext.c </p>
<p></p>
<p> </p>
<p> </p>
<p>This is the implementation source file of the DCM </p>
<p>with Autosar extensions (delivered only for the “pre-</p>
<p>compile” variant).</p>
<p> </p>
<p>Dcm.h </p>
<p></p>
<p> </p>
<p> </p>
<p>This is the header file containing the APIs of DCM. </p>
<p><b>This is the only file that has to be included by </b></p>
<p><b>the application if an interaction with DCM is </b></p>
<p><b>needed. </b></p>
<p>Dcm_Int.h </p>
<p></p>
<p> </p>
<p> </p>
<p>This is the header file containing internal APIs of </p>
<p>DCM between the core- and extension parts. </p>
<p><b>This file must not be included by any other </b></p>
<p><b>source file except of the DCM own ones. </b></p>
<p>Dcm_Cbk.h </p>
<p></p>
<p> </p>
<p> </p>
<p>This file contains all function prototypes of APIs </p>
<p>called by other BSW-C (i.e. Pdu-R, ComM, etc.).</p>
<p> </p>
<p>Dcm_Types.h </p>
<p></p>
<p> </p>
<p> </p>
<p>This file contains all data types that shall be visible </p>
<p>to the other components interacting with DCM.</p>
<p> </p>
<p>Dcm_Core.h </p>
<p>Dcm_CoreInt.h </p>
<p>Dcm_CoreCbk.h </p>
<p>Dcm_CoreTypes.h </p>
<p></p>
<p> </p>
<p> </p>
<p>All these files belong to the DCM core part. </p>
<p><b>None of these files must be included by an </b></p>
<p><b>external source code. </b></p>
<p>Dcm_Ext.h </p>
<p>Dcm_ExtInt.h </p>
<p>Dcm_ExtCbk.h </p>
<p>Dcm_ExtTypes.h </p>
<p></p>
<p> </p>
<p> </p>
<p>All these files belong to the DCM extension part. </p>
<p><b>None of these files must be included by an </b></p>
<p><b>external source code. </b></p>
<p>Dcm_bswmd.arxml </p>
<p></p>
<p> </p>
<p> </p>
<p>This file contains all DCM configuration parameters’ </p>
<p>definitions. </p>
<p>Table 4-1  </p>
<p>Static files </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>38 </p>
<p>based on template version 5.0.0 </p>
<p><b>4.1.2 </b></p>
<p><b>Dynamic Files </b></p>
<p>The dynamic files are generated by the Configurator 5 generation tool. </p>
<p><b>File Name </b></p>
<p><b>Description </b></p>
<p>Dcm_Cfg.h </p>
<p>This file contains all pre-compile configuration settings of DCM (e.g. </p>
<p>switches, constants, etc.). </p>
<p>Dcm_Lcfg.c </p>
<p>This file contains the link-time parameterization of DCM. </p>
<p>Dcm_Lcfg.h </p>
<p>This file contains all link-time parameters declarations and type definitions. </p>
<p>Dcm_PBcfg.c </p>
<p>This file contains all post-build loadable parameterization of DCM. </p>
<p>Dcm_PBcfg.h </p>
<p>This file contains all post-build loadable parameters declarations and type </p>
<p>definitions. </p>
<p>Rte_Dcm.h </p>
<p>This file will be generated by the RTE. </p>
<p>Rte_Dcm_Type.h </p>
<p>This file will be generated by the RTE. </p>
<p>Dcm_swc.arxml </p>
<p>This AUTOSAR xml file is used for the configuration of the Rte. It contains </p>
<p>the information to get prototypes of callback functions offered by other </p>
<p>components. </p>
<p>Table 4-2  </p>
<p>Generated files </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>39 </p>
<p>based on template version 5.0.0 </p>
<p><b>4.2 </b></p>
<p><b>Include Structure </b></p>
<p> </p>
<p>Figure 4-1 </p>
<p>Include structure </p>
<p><b>4.3 </b></p>
<p><b>Compiler Abstraction and Memory Mapping  </b></p>
<p>The  objects  (e.g.  variables,  functions,  constants,  calibrate-able  memory  section)  are </p>
<p>declared by compiler independent definitions – the compiler abstraction definitions. Each </p>
<p>compiler abstraction definition is assigned to a memory section. </p>
<p>The  following  table  contains  the  memory  section  names  and  the  compiler  abstraction </p>
<p>definitions of the DCM and illustrates their assignment among each other. </p>
<p><b>Compiler Abstraction </b></p>
<p><b>Definitions </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Memory Mapping </b></p>
<p><b>Sections </b></p>
<p>DCM_CONST </p>
<p>DCM_CAL_PRM </p>
<p>DCM_CODE </p>
<p>DCM_VAR_NOINIT </p>
<p>DCM_VAR_INIT </p>
<p>DCM_APPL_CODE </p>
<p>DCM_APPL_DATA </p>
<p>DCM_CALLOUT_CODE </p>
<p>DCM_APPL_CONST </p>
<p>DCM_VAR_PBCFG </p>
<p>DCM_PBCFG </p>
<p>DCM_START_SEC_CONST_8 </p>
<p>DCM_STOP_SEC_CONST_8 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p><b> class Include Structure</b></p>
<p>Dcm.c</p>
<p>Dcm_Ext.c</p>
<p>Dcm.h</p>
<p>Dcm_Ext.h</p>
<p>Dcm_Core.h</p>
<p>Dcm_Types.h</p>
<p>Dcm_Cbk.h</p>
<p>Dcm_ExtTypes.h</p>
<p>Dcm_ExtCbk.h</p>
<p>Dcm_CoreCbk.h</p>
<p>Dcm_CoreTypes.h</p>
<p>Dcm_Extension</p>
<p>AR Dcm Facade</p>
<p>Dcm_Core</p>
<p>Dcm_LCfg.h</p>
<p>Dcm_PBCfg.h</p>
<p>Dcm_LCfg.c</p>
<p>Dcm_PBCfg.c</p>
<p>ComStack_Types.h</p>
<p>Dcm_ExtInt.h</p>
<p>Dcm_CoreInt.h</p>
<p>AR BSW</p>
<p>Environment</p>
<p>AR BSW</p>
<p>Environment</p>
<p>AR BSW Environment</p>
<p>&lt;AR_BSW_MIP&gt;.h</p>
<p>Rte_Dcm_Type.h</p>
<p>Dcm_Cfg.h</p>
<p>Dcm Configuration</p>
<p>Dcm_Int</p>
<p>5</p>
<p>«include»</p>
<p>2</p>
<p>«include»</p>
<p>«include»</p>
<p>1</p>
<p>«include»</p>
<p>2</p>
<p>«include»</p>
<p>0..1</p>
<p>«include»</p>
<p>5</p>
<p>«include»</p>
<p>1</p>
<p>«include»</p>
<p>4</p>
<p>«include»</p>
<p>2</p>
<p>«include»</p>
<p>1</p>
<p>«include»</p>
<p>4</p>
<p>«include»</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>«include»</p>
<p>2</p>
<p>«include»</p>
<p>3</p>
<p>«include»</p>
<p>1</p>
<p>«include»</p>
<p>2</p>
<p>«include»</p>
<p>3</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>2</p>
<p>«include»</p>
<p>3</p>
<p>«include»</p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>40 </p>
<p>based on template version 5.0.0 </p>
<p>DCM_START_SEC_CONST_16 </p>
<p>DCM_STOP_SEC_CONST_16 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CONST_32 </p>
<p>DCM_STOP_SEC_CONST_32 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CONST_UNSPECIFIED </p>
<p>DCM_STOP_SEC_CONST_UNSPECIFIED </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CALIB_8 </p>
<p>DCM_STOP_SEC_CALIB_8 </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CALIB_16 </p>
<p>DCM_STOP_SEC_CALIB_16 </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CALIB_32 </p>
<p>DCM_STOP_SEC_CALIB_32 </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CALIB_UNSPECIFIED </p>
<p>DCM_STOP_SEC_CALIB_UNSPECIFIED </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_VAR_INIT_8 </p>
<p>DCM_STOP_SEC_VAR_INIT_8 </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_VAR_NOINIT_8 </p>
<p>DCM_STOP_SEC_VAR_NOINIT_8 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_VAR_NOINIT_16 </p>
<p>DCM_STOP_SEC_VAR_NOINIT_16 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_VAR_INIT_32 </p>
<p>DCM_STOP_SEC_VAR_INIT_32 </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_VAR_NOINIT_32 </p>
<p>DCM_STOP_SEC_VAR_NOINIT_32 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_VAR_NOINIT_UNSPECIFIED </p>
<p>DCM_STOP_SEC_VAR_NOINIT_UNSPECIFIED </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CODE </p>
<p>DCM_STOP_SEC_CODE </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CALLOUT_CODE </p>
<p>DCM_STOP_SEC_CALLOUT_CODE </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_APPL_CODE </p>
<p>DCM_STOP_SEC_APPL_CODE </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_VAR_PBCFG </p>
<p>DCM_STOP_SEC_VAR_PBCFG </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_PBCFG </p>
<p>DCM_STOP_SEC_PBCFG </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>Table 4-3  </p>
<p>Compiler abstraction and memory mapping </p>
<p>The compiler abstraction definitions of DCM_APPL_DATA and DCM_APPL_CONST refer </p>
<p>to any RAM resp. ROM section defined by any external to DCM software module. This can </p>
<p>be either BSW component or application data storage. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>41 </p>
<p>based on template version 5.0.0 </p>
<p>The DCM_APPL_CODE and DCM_CALLOUT_CODE definitions also refer to an external </p>
<p>code section relative to DCM. These are memory locations, where the application code is </p>
<p>placed. </p>
<p>The </p>
<p>difference </p>
<p>between </p>
<p>these </p>
<p>two </p>
<p>sections </p>
<p>is </p>
<p>that </p>
<p>an </p>
<p>application </p>
<p>code </p>
<p>in </p>
<p>CALLOUT section is a DCM functionality extension (e.g. a complex device driver) and not </p>
<p>a component in the matter of providing server application specific data or functionality (i.e. </p>
<p>via RTE). </p>
<p> </p>
<p><b>4.4 </b></p>
<p><b>Critical Sections </b></p>
<p>To protect internal data structures against modifications that will lead to data corruption, </p>
<p>the  DCM  uses  “Critical  Sections”  for  blocking  concurrent  access,  such  as  from  lower </p>
<p>transport layer and from the <i>Dcm_MainFunction()</i>.  </p>
<p> </p>
<p>The only method that DCM uses to handle the critical sections is: </p>
<p><b></b></p>
<p><b> </b></p>
<p>AUTOSAR Schedule Manager (SchM_Dcm.h is included) </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>You must take special care that the SchM implementing the critical section is already </p>
<p>started before the DCM is run. </p>
<p><b> </b></p>
<p><b> </b></p>
<p>You  have  to map the DCM  critical  sections  to  the  appropriate  resource  locking  method. </p>
<p>DCM  supports  only  the </p>
<p><b>DCM_EXCLUSIVE_AREA_0</b></p>
<p>  and  it  shall  be  always  mapped  to </p>
<p><b>global interrupt disabling</b>, since DCM has always very short time critical sections. The </p>
<p>real  critical  section  duration  depends  on  the  performance  of  the  controller  used  in  your </p>
<p>system, </p>
<p>but </p>
<p>the </p>
<p>DCM </p>
<p>critical </p>
<p>section </p>
<p>design </p>
<p>restricts </p>
<p>the </p>
<p>code </p>
<p>within </p>
<p>to </p>
<p>very </p>
<p>few </p>
<p>instructions and in very rear cases contains (internal) function calls, which usually are in-</p>
<p>lined. </p>
<p> </p>
<p><b>4.5 </b></p>
<p><b>Considerations Using Request- and ResponseData Pointers in a Call-back </b></p>
<p>DCM is a half-duplex communication module and for memory usage optimization a single </p>
<p>buffer  is  used  for  both  request  and  response  data.  Therefore  if  a  call-back  function </p>
<p>contains  both  “ResponseData”  and  “RequestData”  pointers,  they  may  point  to  different </p>
<p>addresses, but these are still memory locations within the same diagnostic buffer. So if you </p>
<p>start writing the response data, you probably will overwrite the request data. If the request </p>
<p>data is still needed, while writing the response data, you will have to store it into temporary </p>
<p>RAM location in your application software, before starting the write process. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>42 </p>
<p>based on template version 5.0.0 </p>
<p><b>5 </b></p>
<p><b>Diagnostic Service Implementation </b></p>
<p>The main goal of the DCM is to handle the diagnostic protocol services, defined by [5]. The </p>
<p>only  task  the  application  has  is  to  provide  the  required  data,  to  write  new  data  into  its </p>
<p>memory, access IO ports, etc. All these application tasks are ECU specific and have no </p>
<p>dependency to the used diagnostic protocol.  </p>
<p>The following chapters describe each diagnostic service that the DCM handles, including </p>
<p>implementation and configuration aspects. </p>
<p>Each chapter provides tables that give an overview over the following information: </p>
<p><b></b></p>
<p><b> </b></p>
<p>Which implementation types of that diagnostic service are supported; </p>
<p><b></b></p>
<p><b> </b></p>
<p>If the service is internally handled, which subservices are supported and how they are </p>
<p>or can be implemented. </p>
<p>For each of the about classifications the following implementation types are used: </p>
<p><b>&gt; </b></p>
<p><b>internal only </b>= by DCM; </p>
<p><b>&gt; </b></p>
<p><b>external only </b>= by application; </p>
<p><b>&gt; </b></p>
<p><b>internal or external </b>= implemented by DCM, but can be overridden by application; </p>
<p><b>&gt; </b></p>
<p><b>not allowed </b>= cannot be configured at all. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>If you miss a diagnostic service in the following chapter, it does only mean that the </p>
<p>DCM does not provide any predefined implementation for it, but you can define it in </p>
<p>Configurator 5 and handle it within your application. If you try to specify an invalid </p>
<p>service identifier, the Configurator 5 will notify you about that and will deny the service </p>
<p>definition. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>If not other stated every service that can be overridden by an application service </p>
<p>handler may not have configured sub-services, but actually the application </p>
<p>implementation of these services still can handle any by itself. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>43 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.1 </b></p>
<p><b>RequestCurrentPowertrainDiagnosticData ($01) </b></p>
<p><b>5.1.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers some current values of ECU parameters. </p>
<p><b>5.1.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>DataServices_&lt;DataName&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.1.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-1  </p>
<p>Service $01: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-2  </p>
<p>Service $01: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b>5.1.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>All to be supported PIDs shall be defined within the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspPid </p>
<p><b>&gt; </b></p>
<p>For each PID to be supported by this service, the following parameter has to be set to </p>
<p>either SERVICE_01 or SERVICE 01_02: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspPid/DcmDspPidService </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>44 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>The data content of a PID shall be defined in the container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspPid/DcmDspPidData </p>
<p><b>&gt; </b></p>
<p>The access type to the data content of a PID can be defined in the container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspPid/DcmDspPidData/DcmDspPidService01 </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>There shall be no “availability ID” (i.e. 0x00, 0x20, 0x40 …, 0xE0) explicitly defined in </p>
<p>the DCM configuration! All these IDs will be automatically calculated during the code </p>
<p>generation process and supported by the DCM code. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>If any of the service’s PIDs shall be also readable by the corresponding UDS service </p>
<p>(i.e. <i>ReadDataByIdentifier ($22) </i>DIDs 0xF400 – 0xF4FF), the corresponding DIDs, </p>
<p><b>including the “availability DIDs” </b>shall be explicitly defined within the DCM </p>
<p>configuration. This is required in order to support the optional read access condition </p>
<p>checks on a DID operation.  </p>
<p>Refer to <i>ReadDataByIdentifier ($22) </i>for more details about OBD DID configuration </p>
<p>particularities. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>For all PIDs implemented by the DEM, the according DEM APIs (e.g. </p>
<p>Dem_DcmReadDataOfPID01) must be entered for the configuration parameter </p>
<p>Dcm/DcmConfigSet/DcmDsp/DcmDspPid/DcmDspPidData/DcmDspPidService</p>
<p>01/DcmDspPidDataReadFnc<b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>45 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.2 </b></p>
<p><b>RequestPowertrainFreezeFrameData ($02) </b></p>
<p><b>5.2.1 </b></p>
<p><b>Functionality </b></p>
<p>This  is  a  legislated  OBD  service  that  delivers  the  contents  of  the  OBD  Freeze  Frame, </p>
<p>which consists of ECU parameter values stored by the fault memory module. </p>
<p><b>5.2.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>Refer to chapter <i>6.3 Services used by DCM </i>for the DEM component. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.2.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-3  </p>
<p>Service $02: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-4  </p>
<p>Service $02: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b>5.2.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>All to be supported PIDs shall be defined within the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspPid </p>
<p><b>&gt; </b></p>
<p>For each PID to be supported by this service, the following parameter has to be set to </p>
<p>either SERVICE_02 or SERVICE 01_02: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspPid/DcmDspPidService </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>46 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>There shall be no “availability ID” (i.e. 0x00, 0x20, 0x40 …, 0xE0) explicitly defined in </p>
<p>the DCM configuration! All these IDs will be automatically calculated during the code </p>
<p>generation process and supported by the DCM code. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>47 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.3 </b></p>
<p><b>RequestEmissionRelatedDTC ($03) </b></p>
<p><b>5.3.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers all DTCs with status “confirmed”. </p>
<p><b>5.3.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>Refer to chapter <i>6.3 Services used by DCM </i>for the DEM component. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.3.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-5  </p>
<p>Service $03: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-6  </p>
<p>Service $03: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b>5.3.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>48 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.4 </b></p>
<p><b>ClearEmissionRelatedDTC ($04) </b></p>
<p><b>5.4.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that clears all emission related DTCs. </p>
<p><b>5.4.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>Refer to chapter <i>6.3 Services used by DCM </i>for the DEM component. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.4.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-7  </p>
<p>Service $04: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-8  </p>
<p>Service $04: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b>5.4.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>49 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.5 </b></p>
<p><b>RequestOnBoardMonitorTestResults ($06) </b></p>
<p><b>5.5.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers monitor specific test results. </p>
<p><b>5.5.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>DtrServices </i>(if no OBD DTR support by DEM) </p>
<p><b>&gt; </b></p>
<p>Refer to chapter <i>6.3 Services used by DCM </i>for the DEM component (if OBD DTR is </p>
<p>supported by DEM). </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.5.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-9  </p>
<p>Service $06: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-10  </p>
<p>Service $06: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>Depending on the DEM SWS AR version and setup, the OBDMID configuration and </p>
<p>data handling is either implemented by DCM or DEM.  </p>
<p>Please refer to the configuration aspects in the following chapters for more details: </p>
<p><b>&gt; </b></p>
<p><i>5.5.4 Configuration Aspects </i></p>
<p><b>&gt; </b></p>
<p><i>9.30 How to Switch Between OBD DTR Support by DCM and DEM </i></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>50 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p> </p>
<p><b>5.5.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>If the OBDMID configuration and data handling is to be supported by DEM, the </p>
<p>following parameters will not be required, resp. will be ignored during the DCM </p>
<p>configuration code generation. </p>
<p><b>&gt; </b></p>
<p>All to be supported MIDs shall be defined within the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspTestResultByObdmid/DcmDspTestResultObd</p>
<p>midTid </p>
<p><b>&gt; </b></p>
<p>For each MID to be supported by this service, the corresponding TIDs shall be </p>
<p>associated: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspTestResultByObdmid/DcmDspTestResultObd</p>
<p>midTid/DcmDspTestResultObdmidTids </p>
<p><b>&gt; </b></p>
<p>The access type to the data content of a MIDTID can be defined in the container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspTestResultByObdmid/DcmDspTestResultObd</p>
<p>midTid/DcmDspTestResultObdmidTids/DcmDspTestResultObdmidTidUsePort </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>There shall be no “availability ID” (i.e. 0x00, 0x20, 0x40 …, 0xE0) explicitly defined in </p>
<p>the DCM configuration! All these IDs will be automatically calculated during the code </p>
<p>generation process and supported by the DCM code. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>If any of the service’s MIDs shall be also readable by the corresponding UDS service </p>
<p>(i.e. <i>ReadDataByIdentifier ($22) </i>DIDs 0xF600 – 0xF6FF), the corresponding DIDs, </p>
<p><b>including the “availability DIDs” </b>shall be explicitly defined within the DCM </p>
<p>configuration. This is required in order to support the optional read access condition </p>
<p>checks on a DID operation.  </p>
<p>Refer to <i>ReadDataByIdentifier ($22) </i>for more details about OBD DID configuration </p>
<p>particularities. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>51 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.6 </b></p>
<p><b>RequestEmissionRelatedDTCsDetectedDuringCurrentOrLastDrivingCycle </b></p>
<p><b>($07) </b></p>
<p><b>5.6.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers all DTCs with status “pending”. </p>
<p><b>5.6.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>Refer to chapter <i>6.3 Services used by DCM </i>for the DEM component. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.6.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-11  </p>
<p>Service $07: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-12  </p>
<p>Service $07: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b>5.6.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>52 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.7 </b></p>
<p><b>RequestControlOfOnBoardSystemTestOrComponent ($08) </b></p>
<p><b>5.7.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that starts a routine within the ECU. </p>
<p><b>5.7.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>RequestControlServices_&lt;TIDName&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.7.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-13  </p>
<p>Service $08: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-14  </p>
<p>Service $08: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b>5.7.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>Each to be supported TIDs shall be defined in a container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspRequestControl </p>
<p><b>&gt; </b></p>
<p>The request data content size of a TID shall be defined in the container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspRequestControl/DcmDspRequestControlInBuff</p>
<p>erSize </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>53 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>The response data content size of a TID shall be defined in the container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspRequestControl/DcmDspRequestControlOutBuf</p>
<p>ferSize </p>
<p><b>&gt; </b></p>
<p>The access type to the data content of a PID can be defined in the container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspRequestControl/DcmDspRequestControlUsePo</p>
<p>rt </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>There shall be no “availability ID” (i.e. 0x00, 0x20, 0x40 …, 0xE0) explicitly defined in </p>
<p>the DCM configuration! All these IDs will be automatically calculated during the code </p>
<p>generation process and supported by the DCM code. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>If any of the service’s PIDs shall be also readable by the corresponding UDS service </p>
<p>(i.e. <i>RoutineControl ($31) </i>DIDs 0xE000 – 0xE0FF), the corresponding RIDs, <b>including </b></p>
<p><b>the “availability RIDs” </b>shall be explicitly defined within the DCM configuration. This is </p>
<p>required in order to support the optional control access condition checks on a RID.  </p>
<p>Refer to <i>RoutineControl ($31) </i>for more details about OBD RID configuration </p>
<p>particularities. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>54 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.8 </b></p>
<p><b>RequestVehicleInformation ($09) </b></p>
<p><b>5.8.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers some vehicle identification information. </p>
<p><b>5.8.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>InfotypeServices_&lt;VEHINFODATA&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.8.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-15  </p>
<p>Service $09: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-16  </p>
<p>Service $09: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b>5.8.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>Each to be supported VID shall be defined in a container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspVehInfo </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>55 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>There shall be no “availability ID” (i.e. 0x00, 0x20, 0x40 …, 0xE0) explicitly defined in </p>
<p>the DCM configuration! All these IDs will be automatically calculated during the code </p>
<p>generation process and supported by the DCM code. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>If any of the service’s MIDs shall be also readable by the corresponding UDS service </p>
<p>(i.e. <i>ReadDataByIdentifier ($22) </i>DIDs 0xF800 – 0xF8FF), the corresponding DIDs, </p>
<p><b>including the “availability DIDs” </b>shall be explicitly defined within the DCM </p>
<p>configuration. This is required in order to support the optional read access condition </p>
<p>checks on a DID operation.  </p>
<p>Refer to <i>ReadDataByIdentifier ($22) </i>for more details about OBD DID configuration </p>
<p>particularities. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>&gt; </b></p>
<p>The data content of a VID shall be defined in the container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspVehInfo/DcmDspVehInfoData </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>In case the OBD VID data length shall be variable, the configuration parameter </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspVehInfo/DcmDspVehInfoData/DcmDspVehInfoD</p>
<p>ataSize will specify the maximum data size of the VID. This value will be passed as an </p>
<p>input to the API <i>GetInfotypeValueData()</i>.  </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>&gt; </b></p>
<p>The access type to the data content of a VID can be defined in the container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspVehInfo/DcmDspVehInfoData/DcmDspVehInfo</p>
<p>DataUsePort </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>56 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.9 </b></p>
<p><b>RequestEmissionRelatedDTCsWithPermanentStatus ($0A) </b></p>
<p><b>5.9.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers all DTCs with status “permanent”. </p>
<p><b>5.9.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>Refer to chapter <i>6.3 Services used by DCM </i>for the DEM component. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.9.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-17  </p>
<p>Service $0A: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-18  </p>
<p>Service $0A: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b>5.9.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>57 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.10 </b></p>
<p><b>DiagnosticSessionControl ($10) </b></p>
<p><b>5.10.1 </b></p>
<p><b>Functionality </b></p>
<p>This service manages the diagnostic session state in the ECU. </p>
<p> </p>
<p><b>5.10.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b>&gt; </b></p>
<p><i>DcmDiagnosticSessionControl </i></p>
<p> </p>
<p><b>5.10.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>Table 5-19  </p>
<p>Service $10: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>0x00 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>0x01 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>0x02 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>0x03 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>0x04 … 0x7E </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>0x7F … 0xFF </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-20  </p>
<p>Service $10: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b>5.10.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>58 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>This service is mandatory and therefore may not be missing in the configuration and </p>
<p>cannot be overridden by an application implementation. </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>&gt; </b></p>
<p>All to be supported sub-functions shall be defined within the above defined service </p>
<p>container as sub-service containers: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService/DcmDsdSubSer</p>
<p>vice </p>
<p><b>&gt; </b></p>
<p>For each defined sub-function there shall be a corresponding session level defined: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSession </p>
<p>For each session, there must be also defined the P2/P2Start timings: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSession/DcmDspSessionRow/DcmDspSession</p>
<p>P2ServerMax and </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSession/DcmDspSessionRow/DcmDspSession</p>
<p>P2StarServerMax </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>The P2/P2Start timings above will be reported to the diagnostic client within the </p>
<p>positive response of this service. These timings will apply as long as the DCM is in the </p>
<p>corresponding session. DCM is designed to send the RCR-RP not later than the </p>
<p>configured P2/P2Star time. Depending on the project integration specifics and main-</p>
<p>functions scheduling of the communication stack (interfaces, transport layers, etc.) it </p>
<p>may lead to a delayed RCR-RP responses and failing compliance tests. Still, you have </p>
<p>to opportunity to adjust the DCM internal timer values by specifying a diagnostic </p>
<p>protocol specific (i.e. UDS and OBD may have different adjustments) timing </p>
<p>corrections. Please refer to the following parameters in the DCM configuration: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmTimStrP2Serv</p>
<p>erAdjust and </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmTimStrP2Star</p>
<p>ServerAdjust </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>59 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.11 </b></p>
<p><b>EcuReset ($11) </b></p>
<p><b>5.11.1 </b></p>
<p><b>Functionality </b></p>
<p>This service implementation provides the reset functionality within the ECU. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>Once one of the following reset modes: HardReset, SoftReset and KeyOnOffReset is </p>
<p>being requested, after sending the positive response resp. finishing service processing </p>
<p>without positive response, DCM will not accept any further diagnostic request until the </p>
<p>ECU is reset or <i>Dcm_ResetToDefaultSession() </i>is called. The communication reaction </p>
<p>(reject or ignore new request) is dependent on the DCM configuration (see below). </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>In some cases it is required not to perform a real reset of the ECU, but only to switch </p>
<p>into the default session and reset all active diagnostic jobs. If this kind of reset </p>
<p>implementation is required, then the application shall just call the </p>
<p><i>Dcm_ResetToDefaultSession() </i>provided port operation once the Mode_Switch </p>
<p>operation for the <i>DcmEcuReset </i>mode declaration group is triggered. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>5.11.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>DcmEcuReset </i></p>
<p><b>&gt; </b></p>
<p><i>DcmModeRapidPowerShutDown </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.11.3 </b></p>
<p><b>Implementation Aspects  </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>Table 5-21  </p>
<p>Service $11: Implementation types </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>60 </p>
<p>based on template version 5.0.0 </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>0x00 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>0x01 </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>0x02 </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>0x03 </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>0x04 </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>0x05 </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>0x06 … 0x7E </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>0x7F … 0xFF </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-22  </p>
<p>Service $11: Supported subservices </p>
<p>All in <i>Table 5-22  Service  $11:  Supported  subservices </i> sub-functions  marked  as  internally </p>
<p>handled by DCM are fully implemented and no application interaction is necessary.  </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>If any of the service’s sub-functions 0x01-0x05 are implemented externally (user </p>
<p>defined implementation), the corresponding mode switches (if required) shall be </p>
<p>triggered by the user implementation. </p>
<p>The mode declaration groups (<i>DcmEcuReset </i>and <i>DcmModeRapidPowerShutDown</i>) </p>
<p>will exist only if at least one of the corresponding sub-functions is still handled by DCM.  </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>5.11.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>All to be supported sub-functions shall be defined within the above defined service </p>
<p>container as sub-service containers: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService/DcmDsdSubSer</p>
<p>vice </p>
<p><b>&gt; </b></p>
<p>If sub-function 0x04 is to be supported, additionally the following parameter shall be </p>
<p>configured: /Dcm/DcmConfigSet/DcmDsp/DcmDspPowerDownTime </p>
<p><b>&gt; </b></p>
<p>If one of the following sub-functions: 0x01-0x03 is to be supported, the DCM will either </p>
<p>reject by NRC 0x21 or ignore any request received while waiting for the reset </p>
<p>execution accomplishment. The concrete reaction depends on the setting: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslDiagResp/DcmDslDiagRespOnSecondDeclined</p>
<p>Request (refer also to <i>9.4 How to Handle Multiple Diagnostic Clients Simultaneously</i>). </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>61 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.12 </b></p>
<p><b>ClearDiagnosticInformation ($14) </b></p>
<p><b>5.12.1 </b></p>
<p><b>Functionality </b></p>
<p>This service clears the stored fault memory content. </p>
<p> </p>
<p><b>5.12.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>Refer to chapter <i>6.3 Services used by DCM </i>for the DEM component. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.12.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-23  </p>
<p>Service $14: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-24  </p>
<p>Service $14: Supported subservices </p>
<p>This service is fully implemented by DCM. </p>
<p> </p>
<p><b>5.12.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>62 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.13 </b></p>
<p><b>ReadDiagnosticInformation ($19) </b></p>
<p><b>5.13.1 </b></p>
<p><b>Functionality </b></p>
<p>This service reads the stored fault memory information using the DEM data access API. </p>
<p> </p>
<p><b>5.13.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>Refer to chapter <i>6.3 Services used by DCM </i>for the DEM component. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.13.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>Table 5-25  </p>
<p>Service $19: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>0x00 </p>
<p>  </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>0x01 … 0x15 </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>0x16 </p>
<p>  </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>0x17 … 0x19 </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>0x1A … 0x41 </p>
<p>  </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>0x42 </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>0x43 … 0x7E </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>0x7F … 0xFF </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-26  </p>
<p>Service $19: Supported subservices </p>
<p>All above sub-functions marked as internally handled by DCM are fully implemented and </p>
<p>no application interaction is necessary.  </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>63 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>All WWH-OBD only related sub-functions (e.g. 0x42) will be internally handled in DCM </p>
<p>only with a valid WWH-OBD license. Otherwise must be implemented within an </p>
<p>external CDD module. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>5.13.3.1 </b></p>
<p><b>Reporting Stored DTC Environment Data </b></p>
<p>For all snapshot and extended data record sub-functions, DCM module requires additional </p>
<p>input from the ECU configuration. In order to be able to report properly all related record </p>
<p>numbers  when  the  records  masks  0xFF  or  0xFE  are  requested,  the  DCM  configuration </p>
<p>has been extended by a new parameter hierarchy:  </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspFaultMemory/DcmDspFaultMemoryRecords.  </p>
<p>These new parameters allow DEM configuration independent parameterization of DCM. </p>
<p>More details about them follow in next chapter and in the online help of each parameter </p>
<p>under this container. </p>
<p> </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>If you use this DCM module together with the MICROSAR DEM, it is not necessary to </p>
<p>use or change this configuration. DCM will automatically take the DEM settings </p>
<p>regarding the supported record numbers. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>5.13.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>All to be supported sub-functions shall be defined within the above defined service </p>
<p>container as sub-service containers: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService/DcmDsdSubSer</p>
<p>vice </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>For all user defined sub-functions (marked as “external only” in <i>Table 5-26  Service </i></p>
<p><i>$19: Supported subservices</i>) the sub-function specific request length check shall be </p>
<p>performed by the corresponding sub-function processor implementation. This may lead </p>
<p>to a deviation of the defined in <i>[5] </i>NRC prioritization on a double error (i.e. wrong </p>
<p>security access level and invalid sub-function length). Currently this is unavoidable </p>
<p>since <i>[1] </i>does not provide a request length configuration option on sub-service level. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>64 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>If one of the sub-functions 0x17-0x19 shall be supported, a MemoryIdentifier is </p>
<p>optionally possible to be specified: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspFaultMemory/DcmDspFaultMemoryUserMemor</p>
<p>yIdInfo/DcmDspFaultMemoryUserMemoryId. For more details please refer to the </p>
<p>parameter’s online help within the configuration tool.  </p>
<p><b>&gt; </b></p>
<p>If a non-MICROSAR DEM is used together with DCM and one of the stored DTC </p>
<p>environment data reporting sub-functions of this diagnostic service is to be supported, </p>
<p>all related record ranges shall be specified in the ECUC under the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspFaultMemory/DcmDspFaultMemoryRecords </p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>65 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.14 </b></p>
<p><b>ReadDataByIdentifier ($22) </b></p>
<p><b>5.14.1 </b></p>
<p><b>Functionality </b></p>
<p>This  service  provides  read  access  to  data  structures  within  the  ECU,  marked  by  an </p>
<p>identifier (DID).  </p>
<p>The  tester may  simultaneously  access  multiple  DIDs  in  a  single  request. The maximum </p>
<p>allowed  DID  list  length  is  configurable  (refer  to <i> 5.14.4  Configuration  Aspects </i> for  more </p>
<p>details). </p>
<p> </p>
<p><b>5.14.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>DataServices_&lt;DataName&gt; </i></p>
<p><b>&gt; </b></p>
<p><i>DataServices_DIDRange_&lt;RangeName&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.14.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-27  </p>
<p>Service $22: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-28  </p>
<p>Service $22: Supported subservices </p>
<p>The protocol handling of this service is fully implemented by DCM. The data  reported by </p>
<p>each DID will be provided by the application via service calls or call outs. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>66 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>If you intend using DID ranges, please read carefully chapter <i>9.19 Handling with DID </i></p>
<p><i>Ranges </i>to learn important particularities. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>In case very large DID data has to be carried out from the application an optimized </p>
<p>data reading process can be used to save RAM. For details please refer to <i>9.24 How to </i></p>
<p><i>Save RAM using Paged-Buffer for Large DIDs<b>. </b></i></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>5.14.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>All to be supported readable DIDs shall be defined within the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid </p>
<p><b>&gt; </b></p>
<p>The read operation over a DID is defined by: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidAccess/DcmDspDidRead </p>
<p><b>&gt; </b></p>
<p>The maximum number of simultaneously requested DIDs shall be defined by: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspMaxDidToRead </p>
<p><b>&gt; </b></p>
<p>For each DID data signal the corresponding container shall be configured </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData. </p>
<p><b>&gt; </b></p>
<p>The check condition read operation is optional and if not used can be deactivated via: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataConditionCheckReadFncUs</p>
<p>ed </p>
<p><b>&gt; </b></p>
<p>For NvRam signal access select the value USE_BLOCK_ID in the container </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataUsePort </p>
<p><b>&gt; </b></p>
<p>A NvRam block Id has to be referenced:</p>
<p> </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataBlockIdRef </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>67 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>Particularities for OBD DIDs (i.e. all within [0xF400-0xF8FF]): </p>
<p>- </p>
<p>If DEM handles DTR values, please consider also chapter <i>9.30 How to Switch </i></p>
<p><i>Between OBD DTR Support by DCM and DEM </i>for information on the DIDs. </p>
<p>- </p>
<p>Any OBD availability DID (e.g. 0xF400, 0xF420, 0xF600, 0xF620, 0xF880, </p>
<p>0xF8E0, etc.) will always be implemented by DCM. They will return the </p>
<p>corresponding DID availability mask value as described in <i>[6]</i>. </p>
<p>- </p>
<p>Every DID in the OBD range that covers a corresponding OBD PID, MID or VID, </p>
<p>shall not contain any data definition. The concrete data will be read out by DCM </p>
<p>directly using the corresponding OBD service data access method. For such </p>
<p>DIDs, there also will be no RTE DataServices port or callback generated. </p>
<p>- </p>
<p>Any OBD DID, that neither is an availability DID, nor covers any existing OBD </p>
<p>PID, MID or VID, will be handled as a generic DID and shall be configured </p>
<p>regularly. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>68 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.15 </b></p>
<p><b>ReadMemoryByAddress ($23) </b></p>
<p><b>5.15.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides direct read access to the physical memory of the ECU. All readable </p>
<p>memory  areas  and  their  access  preconditions  are  to  be  configured  as  documented  in </p>
<p><i>5.15.4 Configuration Aspects</i>. </p>
<p> </p>
<p><b>5.15.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>Dcm_ReadMemory() </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.15.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-29  </p>
<p>Service $23: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-30  </p>
<p>Service $23: Supported subservices </p>
<p>The protocol handling of this service is fully implemented by DCM. This includes: </p>
<p><b>&gt; </b></p>
<p>Validating and evaluating the ALFID byte; </p>
<p><b>&gt; </b></p>
<p>Parsing the requested memory address and size parameters; </p>
<p><b>&gt; </b></p>
<p>Validating the requested memory block against the DCM memory configuration: </p>
<p><b>&gt; </b></p>
<p>Supported requested memory area by the ECU; </p>
<p><b>&gt; </b></p>
<p>Memory area access preconditions (e.g. security access, mode rules). </p>
<p>The memory access will then be provided by the application via a call out. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>69 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>All readable memory ranges will be considered during the definition of a DDID with </p>
<p><i>DynamicallyDefineDataIdentifier ($2C)</i>. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>5.15.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>All to be supported readable memory ranges shall be defined within the following </p>
<p>container: /Dcm/DcmConfigSet/DcmDsp/DcmDspMemory </p>
<p><b>5.16 </b></p>
<p><b>ReadScalingDataByIdentifier ($24) </b></p>
<p><b>5.16.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides read access to scaling information of each data within a DID.  </p>
<p> </p>
<p><b>5.16.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>DataServices_&lt;DataName&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.16.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-31  </p>
<p>Service $24: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-32  </p>
<p>Service $24: Supported subservices </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>70 </p>
<p>based on template version 5.0.0 </p>
<p>The protocol handling of this service is fully implemented by DCM. The data reported by </p>
<p>each DID will be provided by the application via service calls or call outs. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>AUTOSAR does not provide a means for specifying session, security or mode rule </p>
<p>restrictions on scaling information operation per DID. Thus the only way to limit the </p>
<p>access to the scaling data is by limiting the access to the whole service $24 under the </p>
<p>corresponding parameter (e.g. DcmDsdSidTabSecurityLevelRef) in </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>5.16.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>All to be supported scaling DIDs shall be defined within the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid </p>
<p><b>&gt; </b></p>
<p>For each DID data signal the corresponding container shall be configured </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData. </p>
<p><b>&gt; </b></p>
<p>For each DID data signal the corresponding container shall be configured in its scaling </p>
<p>size: /Dcm/DcmConfigSet/DcmDsp/DcmDspDataInfo/DcmDspDataScalingInfoSize </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>71 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.17 </b></p>
<p><b>SecurityAccess ($27) </b></p>
<p><b>5.17.1 </b></p>
<p><b>Functionality </b></p>
<p>This  service  manages  the  security  level  of  the  ECU  used  to  constrain  the  diagnostic </p>
<p>access to critical services like writing data in restricted areas. </p>
<p> </p>
<p><b>5.17.2 </b></p>
<p><b>Required Interfaces </b></p>
<p>The following interfaces must be available when service $27 is used: </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>SecurityAccess_&lt;SecurityLevelName&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p><b>&gt; </b></p>
<p><i>Dcm_SetSecurityLevel()  </i></p>
<p> </p>
<p><b>5.17.3 </b></p>
<p><b>Implementation Aspects  </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p>  </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>Table 5-33  </p>
<p>Service $27: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>0x00 </p>
<p>  </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>0x01 … 0x7D </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>0x7E … 0xFF </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-34  </p>
<p>Service $27: Supported subservices </p>
<p>By default this service is fully implemented by DCM. If the internal implementation is used, </p>
<p>the following specifics have to be considered: </p>
<p>If  the  ECU  shall  support  “failed  attempt  monitoring”,  it  can  be  chosen  between  two </p>
<p>strategies on how to avoid brute-force-attack bypass via ECU reset. </p>
<p><b>&gt; </b></p>
<p>Dynamic power-on delay time management:  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>72 </p>
<p>based on template version 5.0.0 </p>
<p>The attempt counter shall be stored by the application (e.g. into a NvM block), so at </p>
<p>next ECU power on/reset event its value can be recovered. </p>
<p><b>&gt; </b></p>
<p>Static power-on delay management: </p>
<p>The attempt counter will not be stored into the NvM (by the application), but instead </p>
<p>DCM will use the “delay time on boot” setting to insert a penalty time at each power </p>
<p>on cycle, regardless of the last attempt counter state. This means that even if during </p>
<p>the last power-on cycle there was no failed attempt, the ECU will  not accept any </p>
<p>request for service 0x27 for that level, having set up “delay time on power on”. </p>
<p>Please,  refer  the  configuration  related  chapter  below  to  find  the  corresponding  DCM </p>
<p>settings that affect the brute-force-attack bypass strategy. </p>
<p> </p>
<p>MICROSAR DCM provides an optional extension of the security access level configuration </p>
<p>if some fixed bytes for the seed/key value calculation are needed. For details, please refer </p>
<p>to chapter <i>9.25 How to Get Security-Access Level Specific Fixed Byte </i>Values. </p>
<p> </p>
<p><b>5.17.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>All to be supported sub-functions shall be defined within the above defined service </p>
<p>container as sub-service containers: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService/DcmDsdSubSer</p>
<p>vice </p>
<p><b>&gt; </b></p>
<p>There shall always be a pair of sub-functions per security level (e.g. 0x01 for “get </p>
<p>seed” and 0x02 for the corresponding “send key” sub-function). </p>
<p><b>&gt; </b></p>
<p>For each pair there shall always be a corresponding security level defined: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecurityRow </p>
<p><b>&gt; </b></p>
<p>If a notification on a security access level state change is required, the option </p>
<p>described in <i>9.16 How to Know When the Security Access Level Changes </i>shall be </p>
<p>enabled.  </p>
<p><b>&gt; </b></p>
<p>Specify whether a single (shared among all security levels) or multiple (per security </p>
<p>level) instances of the attempt counter shall be supported: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecuritySingleInstanceAttemp</p>
<p>tMonitor </p>
<p><b>&gt; </b></p>
<p>Specify whether a single (shared among all security levels) or multiple (per security </p>
<p>level) instances of the delay timer shall be supported: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecuritySingleInstanceDelayT</p>
<p>imer </p>
<p><b>&gt; </b></p>
<p>Specify whether a non-volatile storage of the attempt counter is required for a certain </p>
<p>level: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecurityRow/DcmDspSecurity</p>
<p>AttemptCounterEnabled </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>73 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>Specify whether an unconditional delay timer start is required for a certain level: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecurityRow/DcmDspSecurity</p>
<p>DelayTimeOnBoot </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>You can only choose to have either DcmDspSecurityAttemptCounterEnabled or </p>
<p>DcmDspSecurityDelayTimeOnBoot. Both settings cannot be combined. </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>&gt; </b></p>
<p>The access type to the security level specific operations can be defined using the </p>
<p>following parameter: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecurityRow/DcmDspSecurity</p>
<p>UsePort </p>
<p><b>&gt; </b></p>
<p>Specify the attempt counter/timer recovery replacement strategy, in case the last </p>
<p>stored attempt counter value is no more readable: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecurityRow/DcmDspSecurity</p>
<p>DelayTimeOnFailedGetAttemptCounter </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>74 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.18 </b></p>
<p><b>CommunicationControl ($28) </b></p>
<p><b>5.18.1 </b></p>
<p><b>Functionality </b></p>
<p>This service manages the communication state of both reception and transmission path of </p>
<p>the ECU. </p>
<p> </p>
<p><b>5.18.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>Refer to chapter <i>6.3 Services used by DCM </i>for the BswM component. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.18.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>Table 5-35  </p>
<p>Service $28: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>0x00 … 0x03 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>0x04 … 0x05 </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>0x06 … 0x3F </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>0x40 … 0x7E </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>0x7F … 0xFF </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-36  </p>
<p>Service $28: Supported subservices </p>
<p>This service is fully implemented by DCM with the following limitations: </p>
<p>For </p>
<p>the </p>
<p>sub-network </p>
<p>id </p>
<p>parameter </p>
<p>only </p>
<p>the </p>
<p>values </p>
<p>“CurrentSubNetwork” </p>
<p>and </p>
<p>“AllSubNetworks”  are  supported.  The  third  type:  “SpecificSubNetworkId”  is  currently  not </p>
<p>supported. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>75 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.18.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>All to be supported sub-functions shall be defined within the above defined service </p>
<p>container as sub-service containers: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService/DcmDsdSubSer</p>
<p>vice </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>For all user defined sub-functions (marked as “external only” in <i>Table 5-36  Service </i></p>
<p><i>$28: Supported subservices</i>) the sub-function specific request length check shall be </p>
<p>performed by the corresponding sub-function processor implementation. This may lead </p>
<p>to a deviation of the defined in <i>[5] </i>NRC prioritization on a double error (i.e. wrong </p>
<p>security access level and invalid sub-function length). Currently this is unavoidable </p>
<p>since <i>[1] </i>does not provide a request length configuration option on sub-service level. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>&gt; </b></p>
<p>All other for this service relevant properties shall be configured under: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspComControl </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>It is important that if UDS parameter “CommunicationType” 0x0X (AllNetworks) shall be </p>
<p>supported by DCM, that the corresponding channels are configured appropriately </p>
<p>under the following configuration containers: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspComControl/DcmDspComControlAllChannel </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>&gt; </b></p>
<p>In case DCM shall monitor any critical condition under which this service shall no </p>
<p>longer be active, put a reference to that condition using parameter: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspComControl/DcmDspComControlSetting/DcmD</p>
<p>spComControlCommunicationReEnableModeRuleRef </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>76 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.19 </b></p>
<p><b>ReadDataByPeriodicIdentifier ($2A) </b></p>
<p><b>5.19.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides read access to data structures within the ECU, marked by a periodic </p>
<p>identifier (PDID). These are all DIDs in range [$F200 – $F2FF]. </p>
<p>The tester may schedule multiple PDIDs in a single request. The maximum allowed PDID </p>
<p>list length is configurable (refer to <i>5.19.4 Configuration Aspects</i>). </p>
<p>Optionally, DCM is able to stop automatically the periodic transmission of any scheduled </p>
<p>PDID that cannot be accessed any more, after a diagnostic session/security access level </p>
<p>changes. Refer to <i>5.19.4 Configuration Aspects </i>for details about this setting. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>Only periodic responses of type 2 (UUDT) are supported, as the latest versions of [5] </p>
<p>require. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>5.19.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>DataServices_&lt;DataName&gt; </i></p>
<p><b>&gt; </b></p>
<p><i>DataServices_DIDRange_&lt;RangeName&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.19.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-37  </p>
<p>Service $2A: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-38  </p>
<p>Service $2A: Supported subservices </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>77 </p>
<p>based on template version 5.0.0 </p>
<p>The </p>
<p>protocol </p>
<p>handling </p>
<p>and </p>
<p>the </p>
<p>PDID </p>
<p>read </p>
<p>job </p>
<p>scheduling </p>
<p>of </p>
<p>this </p>
<p>service </p>
<p>is </p>
<p>fully </p>
<p>implemented by DCM. The data reported by each DID will be provided by the application </p>
<p>via service calls or call outs. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>If you intend using DID ranges, please read carefully chapter <i>9.19 Handling with DID </i></p>
<p><i>Ranges </i>to learn important particularities. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>5.19.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container. The </p>
<p>scheduling rates to be supported are specified by the corresponding rate time </p>
<p>configuration parameter. Example for “SlowRate”: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspPeriodicTransmission/DcmDspPeriodicTransmi</p>
<p>ssionSlowRate </p>
<p><b>&gt; </b></p>
<p>All to be supported readable PDIDs shall be defined within the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid. The only allowed DID numbers are within </p>
<p>the range [$F200-$F2FF]. </p>
<p><b>&gt; </b></p>
<p>The read operation over a PDID is defined by: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidAccess/DcmDspDidRead </p>
<p><b>&gt; </b></p>
<p>The maximum number of simultaneously requested PDIDs shall be defined by: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspMaxDidToRead </p>
<p><b>&gt; </b></p>
<p>The maximum number of simultaneously schedulable PDIDs shall be defined by: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspPeriodicDidTransmission/DcmDspMaxPeriodic</p>
<p>DidScheduler </p>
<p><b>&gt; </b></p>
<p>There shall be at least one DCM periodic connection (at least once client supports </p>
<p>periodic responses), referred by a corresponding tester main connection. For that </p>
<p>purpose configure: </p>
<p><b>&gt; </b></p>
<p>Define the clients periodic connection with one or multiple PDUs of the UUDT </p>
<p>messages to be sent within the protocol container: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmDslConnecti</p>
<p>on/DcmDslPeriodicTransmission </p>
<p><b>&gt; </b></p>
<p>Refer the above created connection from the clients main connection located in the </p>
<p>same protocol container: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmDslConnecti</p>
<p>on/DcmDslMainConnection/DcmDslPeriodicTranmissionConRef </p>
<p><b>&gt; </b></p>
<p>If it is required that DCM shall stop automatically any PDID which is no more  </p>
<p>supported in the active diagnostic session/security level the following parameter shall </p>
<p>be enabled:  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>78 </p>
<p>based on template version 5.0.0 </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspPeriodicDidTransmission/DcmDspPeriodicDid</p>
<p>StopOnStateChange </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>79 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.20 </b></p>
<p><b>DynamicallyDefineDataIdentifier ($2C) </b></p>
<p><b>5.20.1 </b></p>
<p><b>Functionality </b></p>
<p>This  service  is  used  to  define  new  abstract  data  structures  (DIDs)  that  refer  to  other </p>
<p>statically  configured  DIDs  or  memory  areas.  The  newly  defined  data  structures  are </p>
<p>accessible for reading only through their assigned DDID (DynamicDID). </p>
<p>Optionally,  DCM  is  able  to  clear automatically  any  already  defined  DDID  that  cannot  be </p>
<p>accessed  any  more,  after  a  diagnostic  session/security  access  level  changes. This  also </p>
<p>implies </p>
<p>that </p>
<p>a </p>
<p>periodic </p>
<p>DDID </p>
<p>will </p>
<p>be </p>
<p>also </p>
<p>removed </p>
<p>from </p>
<p>the </p>
<p>periodic </p>
<p>scheduler </p>
<p>(<i>ReadDataByPeriodicIdentifier  ($2A)</i>).  Refer  to <i> 5.20.4  Configuration  Aspects </i> for  details </p>
<p>about this setting. </p>
<p> </p>
<p><b>5.20.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>No additional interfaces are required for this service, since it is completely handled </p>
<p>within the DCM. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.20.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>Table 5-39  </p>
<p>Service $2C: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>0x01 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>0x02 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>0x03 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>0x04 … 0xFF </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-40  </p>
<p>Service $2C: Supported subservices </p>
<p>This service is fully implemented by DCM corresponding to the <i>[5]</i>. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>80 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>If you intend using DID ranges, please read carefully chapter <i>9.19 Handling with DID </i></p>
<p><i>Ranges </i>to learn important particularities. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>5.20.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>All to be supported sub-functions shall be defined within the above defined service </p>
<p>container as sub-service containers: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService/DcmDsdSubSer</p>
<p>vice </p>
<p><b>&gt; </b></p>
<p>If this service is to be used, there shall be at least one DID in the DCM configuration, </p>
<p>determined as a DDID by the parameter: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidDynamicallyDefined </p>
<p><b>&gt; </b></p>
<p>If the objects (DIDs or memory areas) referenced by a DDID shall be validated against </p>
<p>session, security and mode-rule preconditions each time the DDID is to be read: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidDynamicallyDefined </p>
<p><b>&gt; </b></p>
<p>DCM verifies always the session, security and mode-rule preconditions of a DDID </p>
<p>when it is requested by a diagnostic client. You can configure DCM additionally to </p>
<p>check also the objects (DIDs or memory areas) referenced by a DDID against their </p>
<p>preconditions by parameter: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDDDidCheckPerSourceDid </p>
<p><b>&gt; </b></p>
<p>You can configure DCM to execute all in a DDID contained DID’s </p>
<p><i>ConditionCheckRead() </i>operations when the DDID is requested by diagnostic client: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDDDidCheckConditionReadPerSourceDid </p>
<p><b>&gt; </b></p>
<p>If it is required DCM to clear automatically any no more supported in the active </p>
<p>diagnostic session/security level DDID (and stop it from periodic reading), the </p>
<p>parameter shall be enabled:  </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDDDidClearOnStateChange </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>81 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>Enabling DcmDspDDDidClearOnStateChange  does imply that any DDID access </p>
<p>precondition evaluation for reading it once (<i>ReadDataByIdentifier ($22)</i>) or periodically </p>
<p>(<i>ReadDataByPeriodicIdentifier ($2A)</i>) will not be performed. The reason is that once </p>
<p>there is a change of the current diagnostic session/security access level, the DDID will </p>
<p>no more exist and the ECU will reject any read request for it by NRC 0x31 </p>
<p>(RequestOutOfRange). Combining this feature together with </p>
<p>DcmDspDDDidCheckPerSourceDid increases the overall run time usage but also the </p>
<p>access precondition dependent level safety. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>82 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.21 </b></p>
<p><b>WriteDataByIdentifier ($2E) </b></p>
<p><b>5.21.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides write access to predefined and marked by identifier data structures </p>
<p>within the ECU. </p>
<p> </p>
<p><b>5.21.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>DataServices_&lt;DataName&gt; </i></p>
<p><b>&gt; </b></p>
<p><i>DataServices_DIDRange_&lt;RangeName&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.21.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-41  </p>
<p>Service $2E: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-42  </p>
<p>Service $2E: Supported subservices </p>
<p>The  protocol handling  of  this  service  is fully  implemented  by  DCM. The  functionality  for </p>
<p>writing  the  data  of  each  DID  will  be  provided  by  the  application  via  service  calls  or  call </p>
<p>outs. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>If you intend using DID ranges, please read carefully chapter <i>9.19 Handling with DID </i></p>
<p><i>Ranges </i>to learn important particularities. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>83 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.21.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>All to be supported writeable DIDs shall be defined within the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid </p>
<p><b>&gt; </b></p>
<p>The write operation over a DID is defined by: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidAccess/DcmDspDidWrite </p>
<p><b>&gt; </b></p>
<p>For each DID data signal the corresponding container shall be configured </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData. </p>
<p><b>&gt; </b></p>
<p>For NvRam signal access select the value USE_BLOCK_ID in the container </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataUsePort </p>
<p><b>&gt; </b></p>
<p>A NvRam block Id has to be referenced:</p>
<p> </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataBlockIdRef </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>84 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.22 </b></p>
<p><b>InputOutputControlByIdentifier ($2F) </b></p>
<p><b>5.22.1 </b></p>
<p><b>Functionality </b></p>
<p>This  service </p>
<p>provides  IO  control </p>
<p>access  to  predefined  and  marked  by  identifier  IO </p>
<p>structures (ports) within the ECU. </p>
<p> </p>
<p><b>5.22.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>DataServices_&lt;DataName&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.22.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-43  </p>
<p>Service $2F: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-44  </p>
<p>Service $2F: Supported subservices </p>
<p>The protocol handling of this service is fully implemented by DCM. The control functionality </p>
<p>over the corresponding IO port will be performed by the application via service calls or call </p>
<p>outs. </p>
<p>DCM monitors all IO DIDs put under control, once a requested IO control operation other </p>
<p>than <i>ReturnControlToECU() </i>was successfully executed. This allows DCM to automatically </p>
<p>reset the IO DID operations, calling their the <i>ReturnControlToECU() </i>operations once one </p>
<p>of the following events occurs: </p>
<p><b>&gt; </b></p>
<p>A state transition to the Default diagnostic session; </p>
<p><b>&gt; </b></p>
<p>A state transition to any diagnostic session, where the monitored IO DID is not </p>
<p>supported; </p>
<p><b>&gt; </b></p>
<p>A state transition to any security level, where the monitored IO DID is not supported; </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>85 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>If an IO DID is configured not to support operation <i>ReturnControlToECU()</i>, the </p>
<p>automatic resetting of this IO DID is not supported. The application shall catch the </p>
<p>mode switch for <i>DcmDiagnosticSessionControl  </i>and reset this IO DID by itself. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>Although it is allowed to have an asynchronous IO DID “<i>DataServices_&lt;DataName&gt;</i>” </p>
<p>service port, it is not allowed to implement the “<i>ReturnControlToECU()</i>” operation of </p>
<p>this port as asynchronous. This is because the transition to the default session is a </p>
<p>synchronous operation and cannot be delayed. </p>
<p>If the DET support in DCM is enabled and you have implemented the </p>
<p>“<i>ReturnControlToECU()</i>” operation to return DCM_E_PENDING, then this will cause a </p>
<p>DET report. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>IO DID Data Handling in DCM and Application </b></p>
<p>According to <i>[5] </i>there are two types of IO DIDs: packeted and bitmapped. The difference is </p>
<p>the size of the IO signals addressed by an IO DID:  </p>
<p><b>&gt; </b></p>
<p>Packeted: Each data element within the IO DID can be of any size. </p>
<p><b>&gt; </b></p>
<p>Bitmapped: Each data element within the IO DID has a size of a single bit. </p>
<p>For C/S DID data access, DCM is able to address only at least a whole byte element. So </p>
<p>there are two scenarios in using IO DIDs in DCM also regarding the CEMR: </p>
<p><b>&gt; </b></p>
<p>Packeted IO DID with all signals which have a size of a multiple of eight bits </p>
<p><b>&gt; </b></p>
<p>Bitmapped IO DID or IO DID where the signal size is not a multiple of eight bits </p>
<p>These two scenarios are described in details in the next paragraphs. </p>
<p><b>Packeted IO DID with all signals which have a size of a multiple of eight bits </b></p>
<p>If the IO DID has multiple data signals, the DCM can automatically derive an appropriate </p>
<p>CEMR for this DID as specified in <i>[5]</i>. Then at run time during processing a valid request of </p>
<p>this service, the DCM will call only the service ports of the IO DID that are enabled in the </p>
<p>requested  CEMR.  To  learn  about  how  the  automatic  CEMR  derivation  can  be  enabled </p>
<p>resp.  disabled,  please  refer  to <i> 5.22.4  Configuration Aspects </i> and  the  detailed  parameter </p>
<p>description in the configuration tool. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>86 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>The CEM has only effect on the requested IO control operation. The returned data in </p>
<p>the positive response will contain all IO DID data independently of the CEM value. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Bitmapped IO DID or IO DID where the signal size is not a multiple of eight bits </b></p>
<p>If the IO DID shall contain only single bit information or in general any data element of size </p>
<p>not filling a complete byte, word etc., then such an IO DID must be represented by a single </p>
<p>data object, which combines all the IO signals, including any reserved gaps in between or </p>
<p>at the end of the DID. </p>
<p>If this DID shall support in addition also the CEMR, then it shall be specified to support the </p>
<p>CEMR as a one handled by the application. To learn about how  to specify an externally </p>
<p>handled CEMR, please refer to <i>5.22.4 Configuration Aspects </i>and the detailed parameter </p>
<p>description in the configuration tool. </p>
<p> </p>
<p><b>5.22.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>All to be supported writeable DIDs shall be defined within the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid </p>
<p><b>&gt; </b></p>
<p>Which IO operation is supported by the IO DID is defined within the container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidAccess/DcmDspDidControl</p>
<p>. There you have to create the operation corresponding sub-containers like: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidAccess/DcmDspDidControl</p>
<p>/DcmDspDidShortTermAdjustment  </p>
<p><b>&gt; </b></p>
<p>For each DID data signal the corresponding container shall be configured </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData. </p>
<p><b>&gt; </b></p>
<p>Whether the IO DID shall support CEMR and which kind of CEMR (internal/external) </p>
<p>handling is required, can be specified using parameter: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidAccess/DcmDspDidControl</p>
<p>/DcmDspDidControlMask </p>
<p><b>&gt; </b></p>
<p>If a CEMR handled by the application shall be supported, its size shall be specified by </p>
<p>the parameter: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidIoEnableMaskSize. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>87 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>Particularities of an IO DID configuration: </p>
<p><b>&gt; </b></p>
<p>If the IO DID has read operation (i.e. accessible via <i>ReadDataByIdentifier ($22)</i>) the </p>
<p>positive response to this service will return the actual IO data immediately after the </p>
<p>request IO control operation was successfully applied. Otherwise no response data </p>
<p>will be returned. </p>
<p><b>&gt; </b></p>
<p>An IO DID with read operation shall never has “<i>ConditionCheckRead()” </i>operation. </p>
<p>For details, please refer to <i>5.14.4 Configuration Aspects </i>of service </p>
<p><i>ReadDataByIdentifier ($22)</i>. The reason for that requirement is that the read </p>
<p>operation is executed always after the IO control operation is applied. Once it is </p>
<p>applied, the read operation must succeed and return the actual data. Otherwise the </p>
<p>IO control operation has to be undone and the response will be a negative one, </p>
<p>which contradicts the IO control definition. </p>
<p><b>&gt; </b></p>
<p>If an IO DID has more than one data signal, DCM will automatically enable the </p>
<p>“enable mask record” support for this DID (AR 4.0.3 requirement). But if you have </p>
<p>configured only one signal for an IO DID and that signal actually represents all IO </p>
<p>signals that the concrete IO DID indeed represents (e.g. for optimization purposes </p>
<p>combined into one byte stream), then you have to use the </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidAccess/DcmDspDidContr</p>
<p>ol/DcmDspDidControlMask and </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidIoEnableMaskSize </p>
<p>parameter in order to configured appropriate enable mask records size. </p>
<p><b>&gt; </b></p>
<p>An externally handled CEMR is passed to the application (refer to the corresponding </p>
<p>operations of <i>DataServices_&lt;DataName&gt; </i>C/S interface<i>)  </i>in exactly the same form </p>
<p>as it was located in the request message: always aligned with the MSB of the </p>
<p>function argument:  </p>
<p><b>&gt; </b></p>
<p>For 8, 16 and 32bit CEMRs, the corresponding uint8/16/32 data type will be used </p>
<p>as </p>
<p>&lt;ControlMaskType&gt;</p>
<p> to transfer the value to the application. It represents </p>
<p>directly the CEMR from the request, starting with the MSB for the very first data </p>
<p>element in the IO DID.  </p>
<p><b>&gt; </b></p>
<p>For a 24bit CEMR, DCM transfers the CEMR to the application using the uint32 </p>
<p>data type for the </p>
<p>&lt;ControlMaskType&gt;</p>
<p>. In this case, in order to keep the bit </p>
<p>scanning algorithm in the application consistent (i.e. shift left and extract bit) once </p>
<p>again the MSB (and not bit 23 of the function argument value represents the very </p>
<p>first data element).  </p>
<p><b>&gt; </b></p>
<p>For CEMRs with more than 32bits, the ControlMask function argument points to </p>
<p>the first byte (MSB) of the requested CEMR using a uint8 data pointer (uint8*) as </p>
<p>&lt;ControlMaskType&gt;</p>
<p>. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>88 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.23 </b></p>
<p><b>RoutineControl ($31) </b></p>
<p><b>5.23.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides direct access to routines within the ECUs (e.g. self-test, control of </p>
<p>peripheries, etc.). </p>
<p> </p>
<p><b>5.23.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>RoutineServices_&lt;RoutineName&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.23.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-45  </p>
<p>Service $31: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p>  </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-46  </p>
<p>Service $31: Supported subservices </p>
<p>The protocol handling of this service is fully implemented by DCM, except the sub-function </p>
<p>execution sequence validation (e.g. prior executing “stop” or “request results” there shall </p>
<p>be send a “start” command).  </p>
<p>Those sequence rules may not apply to all routines. Instead the application can implement </p>
<p>an own state machine to model the running state of each routine. If the service execution </p>
<p>order  is  not  correct,  the  appropriate  NRC  (i.e.  0x24)  can  be  returned  back  from  the </p>
<p>corresponding service port, implemented by the application. </p>
<p> </p>
<p><b>5.23.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p>The following configuration parameter shall be considered for the proper DCM function on </p>
<p>this service. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>89 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined under the service container; </p>
<p><b>&gt; </b></p>
<p>All to be supported RIDs shall be defined within the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspRoutine </p>
<p><b>&gt; </b></p>
<p>The sub-function to be supported by a RID is to be specified within the concrete RID </p>
<p>container (sub-function “start” is always available): </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspRoutine </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>Particularities for OBD RIDs (i.e. all within [0xE000-0xE1FF]): </p>
<p>- </p>
<p>Any OBD availability RID (e.g. 0xE000, 0xE020, 0xE100, 0xE1A0, etc.) will </p>
<p>always be implemented by DCM. They will return the corresponding RID </p>
<p>availability mask value as described in <i>[6]</i>. </p>
<p>- </p>
<p>Every RID in the OBD range that covers a corresponding OBD TID, shall not </p>
<p>contain any data definition. The concrete data will be processed out by DCM </p>
<p>directly using the corresponding OBD TID service data access method. For </p>
<p>such RIDs, there also will be no RTE RoutineServices port or callback </p>
<p>generated. </p>
<p>- </p>
<p>Only “StartRoutine” operation is to be used on OBD RIDs, since <i>[6] </i>does not </p>
<p>define any other operation over a RID. </p>
<p>- </p>
<p>Any OBD RID, that neither is an availability RID, nor covers any existing OBD </p>
<p>TID, will be handled as a generic RID and shall be configured regularly. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>90 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.24 </b></p>
<p><b>WriteMemoryByAddress ($3D) </b></p>
<p><b>5.24.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides direct write access to the physical memory of the ECU. All writeable </p>
<p>memory  areas  and  their  access  preconditions  are  to  be  configured  as  documented  in </p>
<p><i>5.15.4 Configuration Aspects</i>. </p>
<p> </p>
<p><b>5.24.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p><i>Dcm_WriteMemory() </i></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.24.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-47  </p>
<p>Service $3D: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>all </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-48  </p>
<p>Service $3D: Supported subservices </p>
<p>The protocol handling of this service is fully implemented by DCM. This includes: </p>
<p><b>&gt; </b></p>
<p>Validating and evaluating the ALFID byte; </p>
<p><b>&gt; </b></p>
<p>Parsing the requested memory address and size parameters; </p>
<p><b>&gt; </b></p>
<p>Validating the requested memory block against the DCM memory configuration: </p>
<p><b>&gt; </b></p>
<p>Supported requested memory area by the ECU; </p>
<p><b>&gt; </b></p>
<p>Memory area access preconditions (e.g. security access, mode rules). </p>
<p>The memory access will then be provided by the application via a call out. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>91 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.24.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>No sub-functions shall be defined within the above defined service container; </p>
<p><b>&gt; </b></p>
<p>All to be supported writeable memory ranges shall be defined within the following </p>
<p>container: /Dcm/DcmConfigSet/DcmDsp/DcmDspMemory </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>92 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.25 </b></p>
<p><b>TesterPresent ($3E) </b></p>
<p><b>5.25.1 </b></p>
<p><b>Functionality </b></p>
<p>This  service  is  only  used  for  keeping  the  current  diagnostic  state  in  the  ECU  active. </p>
<p>Otherwise on lack of diagnostic communication, the ECU will reset all temporary activated </p>
<p>states and functionalities (e.g. diagnostic session, security access, routine execution, etc.) </p>
<p> </p>
<p><b>5.25.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>No interfaces required for this services. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.25.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>Table 5-49  </p>
<p>Service $3E: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>0x00 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>0x01 … 0xFF </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-50  </p>
<p>Service $3E: Supported subservices </p>
<p>This service is fully implemented by DCM, but can be also handled by the application. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>If you intend to handle this service within your application, please be aware that the </p>
<p>application callback will be called for any request for this service except the </p>
<p>“<b>functionally requested 0x3E 0x80</b>”! The latter is always handled within DCM. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>93 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p><b>5.25.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p>The following configuration parameter shall be considered for the proper DCM function on </p>
<p>this service. </p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<p><b>&gt; </b></p>
<p>All to be supported sub-functions shall be defined within the above defined service </p>
<p>container as sub-service containers: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService/DcmDsdSubSer</p>
<p>vice </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>This service is mandatory and therefore may not be missing in the configuration and </p>
<p>cannot be overridden by an application implementation. </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>94 </p>
<p>based on template version 5.0.0 </p>
<p><b>5.26 </b></p>
<p><b>ControlDTCSetting ($85) </b></p>
<p><b>5.26.1 </b></p>
<p><b>Functionality </b></p>
<p>This  service  manipulates  the  setting  of  the  DTC  in  the  ECU  to  avoid  unnecessary  fault </p>
<p>memory entries (i.e. while the communication is disabled). </p>
<p> </p>
<p><b>5.26.2 </b></p>
<p><b>Required Interfaces </b></p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by DCM: </p>
<p><b>&gt; </b></p>
<p>Refer to chapter <i>6.3 Services used by DCM </i>for the DEM component. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If service handled by the application: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p> </p>
<p><b>5.26.3 </b></p>
<p><b>Implementation Aspects </b></p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Protocol Level </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>ServiceID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>SubServiceID </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>Table 5-51  </p>
<p>Service $85: Implementation types </p>
<p><b>Implementation </b></p>
<p> </p>
<p> </p>
<p><b>Subservice ID </b></p>
<p>internal only </p>
<p>internal or </p>
<p>external </p>
<p>external only </p>
<p>not allowed </p>
<p>0x00 </p>
<p>  </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>0x01 … 0x02 </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>0x03 … 0xFF </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 5-52  </p>
<p>Service $85: Supported subservices </p>
<p>This service is completely implemented by DCM. </p>
<p> </p>
<p><b>5.26.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p>The following configuration parameter shall be considered for the proper DCM function on </p>
<p>this service. </p>
<p><b>&gt; </b></p>
<p>This service shall be defined in the configuration tool: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>95 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>All to be supported sub-functions shall be defined within the above defined service </p>
<p>container as sub-service containers: </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService/DcmDsdSubSer</p>
<p>vice </p>
<p><b>&gt; </b></p>
<p>If DCM shall accept also a DTC group as a request parameter for this service, please </p>
<p>enable the following option: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspControlDTCSetting/DcmSupportDTCSettingCo</p>
<p>ntrolOptionRecord </p>
<p><b>&gt; </b></p>
<p>In case DCM shall monitor any critical condition under which this service shall no </p>
<p>longer be active, put a reference to that condition using parameter: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspControlDTCSetting/DcmDspControlDTCSetting</p>
<p>ReEnableModeRuleRef </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>96 </p>
<p>based on template version 5.0.0 </p>
<p><b>6 </b></p>
<p><b>API Description </b></p>
<p>For an interfaces overview please see Figure 2-2. </p>
<p><b>6.1 </b></p>
<p><b>Type Definitions </b></p>
<p>All types not described here are defined by the DCM as described in <i>[1]</i>. </p>
<p> </p>
<p><b>6.1.1 </b></p>
<p><b>Dcm_ProtocolType </b></p>
<p><b>Type Name </b></p>
<p><b>C-Type </b></p>
<p><b>Description </b></p>
<p><b>Value Range </b></p>
<p>Dcm_ProtocolType </p>
<p>c-type </p>
<p>Specifies the currently </p>
<p>active protocol in </p>
<p>DCM. </p>
<p>[0x00-0x0B]U[0xF0-0xFE] </p>
<p>These values are defined in <i>[1]. </i></p>
<p>DCM_NO_ACTIVE_PROTOCOL (0x0C) </p>
<p>No protocol has been activated yet. </p>
<p>Table 6-1  </p>
<p>Dcm_ProtocolType </p>
<p><b>6.1.2 </b></p>
<p><b>Dcm_RecoveryInfoType </b></p>
<p><b>Struct Element Name </b></p>
<p><b>C-Type </b></p>
<p><b>Description </b></p>
<p><b>Value Range </b></p>
<p>CommControlState </p>
<p>uint8 [M] </p>
<p>(typically) </p>
<p>List of all DCM ComControl </p>
<p>related (internal handle, no </p>
<p>ComM SNV representation) </p>
<p>channels with value equal to </p>
<p>the corresponding </p>
<p>enumeration type.  </p>
<p> </p>
<p>Exist-Condition: </p>
<p><i>CommunicationControl ($28) </i></p>
<p>is supported in DCM. </p>
<p>DCM_ENABLE_RX_TX_NORM_NM </p>
<p> - </p>
<p>DCM will not perform any </p>
<p>CommunicationControl </p>
<p>operation.</p>
<p> </p>
<p>Any other- </p>
<p>DCM will </p>
<p>perform the corresponding </p>
<p>CommunicationControl </p>
<p>operation on the </p>
<p>corresponding channel.</p>
<p> </p>
<p>ComMChannelState </p>
<p>Boolean </p>
<p>[N] </p>
<p>List of all DCM related </p>
<p>(internal handle, no ComM </p>
<p>SNV representation) </p>
<p>channels. </p>
<p>If a non-default session shall </p>
<p>be started, this list has to </p>
<p>exist in order to start up all </p>
<p>affected ComM channels. </p>
<p>[X] = FALSE – </p>
<p>DCM will </p>
<p>leave the ComM channel in </p>
<p>its default state.</p>
<p><b> </b></p>
<p>[X] = TRUE – </p>
<p>DCM will </p>
<p>activate the ComM on that </p>
<p>channel. </p>
<p>ControlDTCSettingDT</p>
<p>CGroup </p>
<p>uint32 </p>
<p>Optional parameter in case </p>
<p>service <i>ControlDTCSetting </i></p>
<p><i>($85) </i>is enabled in DCM and </p>
<p>supports DTC group </p>
<p>parameter. </p>
<p>&lt;DTCgroup&gt; - </p>
<p>The DTC </p>
<p>group that shall be used for </p>
<p>the ControlDTCSetting API in </p>
<p>DEM. </p>
<p>ControlDTCSettingDis</p>
<p>abled </p>
<p>boolean </p>
<p>The new ControlDTCSetting </p>
<p>state. </p>
<p> </p>
<p>Exist-Condition: </p>
<p>FALSE – </p>
<p>DCM will not call </p>
<p>the ControlDTCSetting DEM </p>
<p>API.</p>
<p> </p>
<p>TRUE -  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>97 </p>
<p>based on template version 5.0.0 </p>
<p><b>Struct Element Name </b></p>
<p><b>C-Type </b></p>
<p><b>Description </b></p>
<p><b>Value Range </b></p>
<p><i>ControlDTCSetting ($85) </i>is </p>
<p>enabled in DCM </p>
<p>DCM will perform a </p>
<p>ControlDTCSetting operation </p>
<p>for “disabling DTC” as for an </p>
<p>external diagnostic request </p>
<p>for <i>ControlDTCSetting ($85)</i>.</p>
<p> </p>
<p>SessionLevel </p>
<p>uint8 </p>
<p>(typically) </p>
<p>New diagnostic session. </p>
<p> </p>
<p>Note: This is not the session </p>
<p>level as defined by AR. It is </p>
<p>DCM internal value. </p>
<p>0 – </p>
<p>DCM will stay in the </p>
<p>default</p>
<p> </p>
<p>session.</p>
<p> </p>
<p>Any other valid value </p>
<p>DCM will perform a session </p>
<p>transition as if the </p>
<p>corresponding request has </p>
<p>been received.</p>
<p> </p>
<p>SecurityLevel </p>
<p>uint8 </p>
<p>(typically) </p>
<p>New security level.  </p>
<p> </p>
<p>Note: This is not the security </p>
<p>level as defined by AR. It is </p>
<p>DCM internal value. </p>
<p> </p>
<p>Exist-Condition: </p>
<p>If <i>SecurityAccess ($27) </i>is </p>
<p>supported in DCM. </p>
<p>0 – </p>
<p>DCM will stay in the </p>
<p>locked</p>
<p> </p>
<p>state.</p>
<p> </p>
<p>Any other valid value </p>
<p>DCM will perform a security </p>
<p>level transition as if the </p>
<p>corresponding request has </p>
<p>been received.</p>
<p> </p>
<p>SessionConnection </p>
<p>uint8 </p>
<p>(typically) </p>
<p>Transfers the client </p>
<p>connection ID (internal DCM </p>
<p>value) that has started the </p>
<p>non-default session. </p>
<p> </p>
<p>Exist-Condition:  </p>
<p>Only if non-default session </p>
<p>protection against other </p>
<p>clients is required. </p>
<p>Any value –</p>
<p> Proper </p>
<p>connection ID on the last </p>
<p>client started the non-default </p>
<p>session.  </p>
<p>Signature </p>
<p>uint32 </p>
<p>Magic number for data </p>
<p>consistency check between </p>
<p>stored and to be recovered </p>
<p>data block. </p>
<p>A configuration dependent </p>
<p>value.</p>
<p> </p>
<p>Table 6-2  </p>
<p>Dcm_RecoveryInfoType </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>98 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.2 </b></p>
<p><b>Services provided by DCM </b></p>
<p><b>6.2.1 </b></p>
<p><b>Administrative </b></p>
<p><b>6.2.1.1 </b></p>
<p><b>Dcm_Init() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_Init</b></p>
<p> </p>
<p>( Dcm_ConfigType * ConfigPtr )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>ConfigPtr </p>
<p>The parameter specifies the configuration root the DCM shall use for this </p>
<p>power on cycle.  </p>
<p> </p>
<p>In case of pre-compile configuration – this parameter shall be NULL_PTR. If </p>
<p>any other address is used, it will have no effect. </p>
<p>In case of post-build selectable: </p>
<p>- </p>
<p>more than one variant is configured – the pointer shall be the address </p>
<p>of one of the generated variant structures in Dcm_Lcfg.c </p>
<p>- </p>
<p>only one variant is available – DCM is technically put into pre-compile </p>
<p>mode (see above) </p>
<p>In case of post-build loadable always a valid pointer to the root DCM structure </p>
<p>shall be passed.  </p>
<p>In case of post-build selectable loadable always a valid pointer to the variant </p>
<p>root structure shall be passed. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>Service for basic initialization of DCM module. </p>
<p> </p>
<p>In all cases where this API does expect a non-null pointer argument, a validation of the passed argument is </p>
<p>performed. For details on that topic, please refere to <i>9.18.2.1 Error Detection and Handling </i></p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x01 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-3  </p>
<p>Dcm_Init() </p>
<p> </p>
<p><b>6.2.1.2 </b></p>
<p><b>Dcm_MainFunction() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_MainFunction</b></p>
<p> </p>
<p>( void )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>N/A </p>
<p>N/A </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>99 </p>
<p>based on template version 5.0.0 </p>
<p><b>Functional Description </b></p>
<p>This service is used for processing the tasks of the main loop. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 37 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-4  </p>
<p>Dcm_MainFunction() </p>
<p> </p>
<p><b>6.2.1.3 </b></p>
<p><b>Dcm_MainFunctionTimer() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_MainFunctionTimer</b></p>
<p> </p>
<p>( void )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>N/A </p>
<p>N/A </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This service is used for time critical tasks (high priority task). </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 37 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-5  </p>
<p>Dcm_MainFunctionTimer() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>100 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.2.1.4 </b></p>
<p><b>Dcm_MainFunctionWorker() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_MainFunctionWorker</b></p>
<p> </p>
<p>( void )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>N/A </p>
<p>N/A </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This service is used for diagnostic service processing (low priority task). </p>
<p> </p>
<p>Note: All application call outs the DCM executes are performed only from within this task. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 37 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-6  </p>
<p>Dcm_MainFunctionWorker() </p>
<p> </p>
<p><b>6.2.1.5 </b></p>
<p><b>Dcm_GetVersionInfo() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_GetVersionInfo</b></p>
<p> </p>
<p>( Std_VersionInfoType* versionInfo )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>versionInfo </p>
<p>Pointer to where to store the version information of this module. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>Returns the version information of the used DCM implementation. </p>
<p><b>Note:  </b></p>
<p><b>Starting with DCM 4.00.00, the version information is decimal coded.  </b></p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x24 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-7  </p>
<p>Dcm_GetVersionInfo() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>101 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.2.1.6 </b></p>
<p><b>Dcm_InitMemory() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_InitMemory</b></p>
<p> </p>
<p>( void )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>- </p>
<p>- </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>Service to initialize module global variables at power up. This function initializes the variables in </p>
<p>DCM_VAR_INIT_* (refer to <i>4.3 Compiler Abstraction and Memory Mapping</i>)  </p>
<p>sections and shall be used in case they are not initialized by the startup code. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>This function must be called prior to <i>Dcm_Init()</i>. </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-8  </p>
<p>Dcm_InitMemory() </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>102 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.2.1.7 </b></p>
<p><b>Dcm_ProvideRecoveryStates() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType Dcm_ProvideRecoveryStates (<i>Dcm_RecoveryInfoType</i>* RecoveryInfo)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>RecoveryInfo </p>
<p>Contains all the information that has to be stored for later recovery. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: Recovery info could be retrieved and now can be stored. </p>
<p>E_NOT_OK: Some error occurred during state retrieval. Provided data is </p>
<p>invalid and shall not be stored. </p>
<p><b>Functional Description </b></p>
<p>This API shall be called by the DCM application right before performing the reset operation.  </p>
<p>For details on the usage of this API, please refer chapter <i>9.27 How to Recover DCM State Context on ECU </i></p>
<p><i>Reset/ Power On</i>. </p>
<p> </p>
<p>Note: </p>
<p>- </p>
<p>Once this API is called, the states may change due to external events (e.g. session timeout). </p>
<p>Therefore always perform this call right before executing the reset or within the context of a </p>
<p>diagnostic service processing (i.e. before the final response is sent). </p>
<p>For details on the recovered information, please refer the data type definition: <i>Dcm_RecoveryInfoType</i>. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xA3 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-9  </p>
<p>Dcm_ProvideRecoveryStates() </p>
<p> </p>
<p><b>6.2.2 </b></p>
<p><b>SWC </b></p>
<p><b>6.2.2.1 </b></p>
<p><b>Dcm_GetActiveProtocol() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_GetActiveProtocol</b></p>
<p> </p>
<p>( <i>Dcm_ProtocolType</i>* ActiveProtocol )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>ActiveProtocol </p>
<p>Currently active protocol type </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: this value is always returned. </p>
<p><b>Functional Description </b></p>
<p>This function returns the active protocol Id. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>103 </p>
<p>based on template version 5.0.0 </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x0F </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-10  </p>
<p>Dcm_GetActiveProtocol() </p>
<p> </p>
<p><b>6.2.2.2 </b></p>
<p><b>Dcm_GetSecurityLevel() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_GetSecurityLevel</b></p>
<p> </p>
<p>( Dcm_SecLevelType* SecLevel )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>SecLevel </p>
<p>Active Security Level (see definition of Dcm_SecLevelType for values). </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: this value is always returned. </p>
<p><b>Functional Description </b></p>
<p>This function provides the active security level value. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x0D </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-11  </p>
<p>Dcm_GetSecurityLevel() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>104 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.2.2.3 </b></p>
<p><b>Dcm_GetSesCtrlType() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_GetSesCtrlType</b></p>
<p> </p>
<p>( Dcm_SesCtrlType* SesCtrlType )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>SesCtrlType </p>
<p>Active Session Control Type (see definition of Dcm_SesCtrlType for values). </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: this value is always returned. </p>
<p><b>Functional Description </b></p>
<p>This function provides the active session control type value. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x06 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-12  </p>
<p>Dcm_GetSesCtrlType() </p>
<p> </p>
<p><b>6.2.2.4 </b></p>
<p><b>Dcm_ResetToDefaultSession() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_ResetToDefaultSession</b></p>
<p> </p>
<p>( void )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>N/A </p>
<p>N/A </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: this value is always returned. </p>
<p><b>Functional Description </b></p>
<p>The call to this function allows the application to reset the current session to Default session. </p>
<p>Example: Automatic termination of an extended diagnostic session upon exceeding of a speed limit. </p>
<p> </p>
<p>Note: The time between the function call and the termination of the session depends on the current DCM </p>
<p>state. The minimum time to be expected is one DCM task cycle. If this service is called while the DCM is </p>
<p>processing a diagnostic request, the session termination will be postponed till the end of this service </p>
<p>processing, to avoid unpredictable behavior. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x2A </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-13  </p>
<p>Dcm_ResetToDefaultSession() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>105 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p> </p>
<p><b>6.2.2.5 </b></p>
<p><b>Dcm_GetSecurityLevelFixedBytes() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_GetSecurityLevelFixedBytes</b></p>
<p> </p>
<p>(Dcm_SecLevelType secLevel, uint8* </p>
<p>fixedBytes, uint8* bufferSize)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>secLevel </p>
<p>The security parameter, which fixed bytes are requested. </p>
<p>fixedBytes </p>
<p>Pointer to the buffer where the fixed bytes will be copied to. </p>
<p>bufferSize </p>
<p>IN: specifies the available size of the provided buffer </p>
<p>OUT: returns the number of copied fixed bytes, resp. number of required bytes </p>
<p>in order to copy the complete set (in case of returned </p>
<p>DCM_E_BUFFERTOOLOW) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: If the fixed bytes of the requested security level have been copied. For </p>
<p>levels without fixed bytes, nothing will be copied, and the </p>
<p>bufferSize</p>
<p> </p>
<p>parameter will be 0. </p>
<p>DCM_E_BUFFERTOOLOW: If the level has fixed bytes, but the provided </p>
<p>buffer is too small to fit them. The </p>
<p>bufferSize</p>
<p> will return the required buffer </p>
<p>size. </p>
<p>E_NOT_OK: If an invalid/unsupported security level or the “locked” level is </p>
<p>passed to this API. </p>
<p><b>Functional Description </b></p>
<p>By calling this API the application gets access to the fixed bytes set associated with the security-access </p>
<p>level (i.e. any generated by the RTE DCM_SEC_LEV_XXX value) passed as selector.  </p>
<p> </p>
<p>This API can be called at any time, but the most applicable situation is from within any of the <i>GetSeed() </i></p>
<p>or/and <i>CompareKey() </i>C/S callbacks. </p>
<p>The implementation of the above callbacks shall be aware of passing the correct security-access level </p>
<p>value that corresponds to its C/S port prototype. Otherwise the wrong values will be reported back. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xA7 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>Available only if at least one security level was configured provide fixed bytes information. </p>
<p>Table 6-14  </p>
<p>Dcm_GetSecurityLevelFixedBytes() </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>106 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.2.2.6 </b></p>
<p><b>Dcm_SetActiveDiagnostic() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_SetActiveDiagnostic</b>(boolean active)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>active </p>
<p>Represents the type of DCM interaction with ComM: </p>
<p>- </p>
<p>TRUE: DCM shall call the <i>ComM_DCM_ActiveDiagnostic </i></p>
<p>as required by see <i>[1]</i>. </p>
<p>- </p>
<p>FALSE: DCM shall not call the <i>ComM_DCM_ActiveDiagnostic </i></p>
<p>anymore. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: This code is always returned even if the action could not be executed </p>
<p>due to: </p>
<p>- invalid value of </p>
<p>active</p>
<p>; </p>
<p>- not initialized DCM. </p>
<p><b>Functional Description </b></p>
<p>This API shall be called by the application in cases where the sleep-prevention managed by DCM is no </p>
<p>more desirable.  </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x56 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-15  </p>
<p>Dcm_SetActiveDiagnostic() </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>107 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.2.2.7 </b></p>
<p><b>Dcm_GetRequestKind() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_GetRequestKind</b>(uint16 TesterSourceAddress,                      </p>
<p>                                 Dcm_RequestKindType* RequestKind)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>TesterSourceAddress </p>
<p>The source address of the tester which request kind status will be reported. </p>
<p>RequestKind </p>
<p>Returns the current request kind of the given diagnostic client: </p>
<p>- </p>
<p>DCM_REQ_KIND_NONE: currently no request is in processing for </p>
<p>this client </p>
<p>- </p>
<p>DCM_REQ_KIND_EXTERNAL: an externally sent request for this </p>
<p>client is in progress (i.e. reception/processing/transmission) </p>
<p>- </p>
<p>DCM_REQ_KIND_ROE: it is a STRT of RoE is in progress for this </p>
<p>client </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: the </p>
<p>TesterSourceAddress </p>
<p>has a valid value  </p>
<p>E_NOT_OK: an error occurred or the </p>
<p>TesterSourceAddress </p>
<p>has no valid </p>
<p>value </p>
<p><b>Functional Description </b></p>
<p>This API can be called by the application at any time and from any context if information is required </p>
<p>regarding the processing status of a certain diagnostic client.  </p>
<p> </p>
<p>Typically this API can be used from within a <i>ServiceRequestManufacturerNotification_&lt;SWC&gt; </i>or </p>
<p><i>ServiceRequestSupplierNotification_&lt;SWC&gt;</i>, where the tester source address is passed as an argument, </p>
<p>to get not only the request type (functional or physical) but also the kind of the request (internal/external). </p>
<p> </p>
<p>Additionally using the provided API <i>Dcm_GetTesterSourceAddress()</i>, the application may get the client </p>
<p>request kind also from a known valid DcmRxPduId. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xAB </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-16  </p>
<p>Dcm_GetRequestKind() </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>108 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.2.3 </b></p>
<p><b>General Purpose </b></p>
<p><b>6.2.3.1 </b></p>
<p><b>Dcm_GetTesterSourceAddress() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_GetTesterSourceAddress</b></p>
<p> </p>
<p>(PduIdType DcmRxPduId </p>
<p>                                         ,uint16* TesterSourceAddress)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmRxPduId </p>
<p>Specifies the DCM RxPduId for which the tester source address shall be read </p>
<p>out. </p>
<p>TesterSourceAddress </p>
<p>Will contain the configured tester source address of the DCM RxPduId. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: the </p>
<p>TesterSourceAddress </p>
<p>has a valid value </p>
<p>E_NOT_OK: an error occurred, the </p>
<p>TesterSourceAddress </p>
<p>has no valid </p>
<p>value </p>
<p><b>Functional Description </b></p>
<p>This API can be used to access the configured tester source address parameter to a specific DCM main-</p>
<p>connection, identified by the DCM RxPduId.  </p>
<p>Usually this API is used in a project specific switch between software contexts (i.e. application and boot </p>
<p>loader) where the request is received in one context (e.g. application) and the response is sent from the </p>
<p>other context (e.g. boot loader) or vice versa.  </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xA6 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-17  </p>
<p>Dcm_GetTesterSourceAddress() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>109 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.2.3.2 </b></p>
<p><b>Dcm_ProcessVirtualRequest() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_ProcessVirtualRequest</b></p>
<p> </p>
<p>(PduIdType     RxPduId </p>
<p>                                        ,Dcm_MsgType   Data </p>
<p>                                        ,PduLengthType Length)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>RxPduId </p>
<p>The DcmPduId (physical or functional) of the diagnostic client this virtual </p>
<p>request represents. The response of this request will later be forwarded to this </p>
<p>client. </p>
<p>Data </p>
<p>Pointer to the buffer where the complete diagnostic request incl. SID is </p>
<p>located. </p>
<p>Length </p>
<p>The length of the diagnostic request located in the </p>
<p>Data</p>
<p> buffer. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The request has been accepted. </p>
<p>E_NOT_OK: The request was not accepted. Possible reasons: </p>
<p>- </p>
<p>DCM is already busy with another client, resp. the RxPduId is from a </p>
<p>low priority client. </p>
<p>- </p>
<p>Invalid RxPduId, too long request or NULL_PTR for Data location </p>
<p>passed to the API. </p>
<p><b>Functional Description </b></p>
<p>This is a generic API that can be used by the application (CDD) to send a virtual request to the ECU which </p>
<p>response will be sent to a concrete diagnostic client.  </p>
<p>Typical use-case of this API is an application implementation for service 0x86 (ResponseOnEvent). </p>
<p> </p>
<p>This API can be called from any context (ISR, TASK, etc.). Just when called from an ISR and the request </p>
<p>contains lots of data, the interrupt latency can be significantly affected. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xA8 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-18  </p>
<p>Dcm_ProcessVirtualRequest() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>110 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.2.3.3 </b></p>
<p><b>Dcm_SetSecurityLevel() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_SetSecurityLevel</b></p>
<p> </p>
<p>(Dcm_SecLevelType SecLevel)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>SecLevel </p>
<p>Active Security Level (see definition of Dcm_SecLevelType for values). </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: State change has been performed. </p>
<p>E_NOT_OK: State change failed. Possible reasons: </p>
<p>- wrong/invalid security level; </p>
<p>- called while DCM is busy with a diagnostic request; </p>
<p>- called from wrong task context (not from Dcm_MainFunctionWorker); </p>
<p><b>Functional Description </b></p>
<p>This API shall be called by the application when service <i>SecurityAccess ($27) </i>is supported in the ECU but </p>
<p>not handled in DCM. In this case DCM will be able to switch only to the LOCKED security level when </p>
<p>performing a diagnostic session transition. In order to unlock the ECU in any other security level the </p>
<p>application shall trigger the security access state transitions by calling this API with the appropriate value.  </p>
<p> </p>
<p>Within this API call, DCM will perform the same RTE interaction as if the security state handling was done </p>
<p>by itself. For that reason this API <b>must </b>be called only from within the Dcm_MainFunction(Worker) context.  </p>
<p>The best place for this call is either the callback function for <i>SecurityAccess ($27) </i>or a <i>Confirmation() </i>if </p>
<p>configured. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xA9 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>Available only if service <i>SecurityAccess ($27) </i>is supported in the ECU but handled within the DCM </p>
<p>application. </p>
<p>Table 6-19  </p>
<p>Dcm_SetSecurityLevel() </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>111 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.3 </b></p>
<p><b>Services used by DCM </b></p>
<p>In the following table services provided by other components, which are used by the DCM, </p>
<p>are listed. For details about prototype and functionality refer to the documentation of the </p>
<p>providing component. </p>
<p><b>Component </b></p>
<p><b>API </b></p>
<p>Dem </p>
<p>Dem_DcmCancelOperation </p>
<p>Dem_[Dcm]EnableDTCRecordUpdate </p>
<p>Dem_[Dcm]DisableDTCRecordUpdate </p>
<p>Dem_[Dcm]SetFreezeFrameRecordFilter </p>
<p>Dem_GetFreezeFrameDataByRecord / Dem_DcmGetOBDFreezeFrameData </p>
<p>Dem_[Dcm]GetDTCStatusAvailabilityMask </p>
<p>Dem_[Dcm]SetDTCFilter </p>
<p>Dem_[Dcm]GetNextFilteredRecord </p>
<p>Dem_[Dcm]GetNextFilteredDTCAndSeverity </p>
<p>Dem_[Dcm]GetNextFilteredDTCAndFDC </p>
<p>Dem_[Dcm]GetNextFilteredDTC </p>
<p>Dem_[Dcm]GetExtendedDataRecordByDTC </p>
<p>Dem_[Dcm]GetFreezeFrameDataByDTC </p>
<p>Dem_[Dcm]GetNumberOfFilteredDTC </p>
<p>Dem_[Dcm]GetSeverityOfDTC </p>
<p>Dem_[Dcm]GetFunctionalUnitOfDTC </p>
<p>Dem_[Dcm]GetStatusOfDTC </p>
<p>Dem_[Dcm]GetSizeOfExtendedDataRecordByDTC </p>
<p>Dem_[Dcm]GetSizeOfFreezeFrameByDTC </p>
<p>Dem_[Dcm]GetTranslationType </p>
<p>Dem_[Dcm]GetDTCByOccurrenceTime </p>
<p>Dem_[Dcm]DisableDTCSetting </p>
<p>Dem_[Dcm]EnableDTCSetting </p>
<p>Dem_[Dcm]GetDTCOfOBDFreezeFrame </p>
<p>Dem_[Dcm]ReadDataOfOBDFreezeFrame </p>
<p> </p>
<p>Dem_DcmGetAvailableOBDMIDs </p>
<p>Dem_DcmGetNumTIDsOfOBDMID </p>
<p>Dem_DcmGetDTRData </p>
<p>BswM </p>
<p><b>For AUTOSAR 4.x Environment </b></p>
<p>BswM_Dcm_CommunicationMode_CurrentState </p>
<p>BswM_Dcm_ApplicationUpdated </p>
<p> </p>
<p><b>For AUTOSAR 3.x Environment </b></p>
<p>BswM_Dcm_RequestCommunicationMode </p>
<p>Det </p>
<p>Det_ReportError </p>
<p>ComM </p>
<p>ComM_DCM_ActiveDiagnostic </p>
<p>ComM_DCM_InactiveDiagnostic </p>
<p>PduR </p>
<p>PduR_DcmTransmit </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>112 </p>
<p>based on template version 5.0.0 </p>
<p><b>Component </b></p>
<p><b>API </b></p>
<p>SchM </p>
<p><b>For AUTOSAR 4.x Environment </b></p>
<p>SchM_Enter_Dcm_DCM_EXCLUSIVE_AREA_0 </p>
<p>SchM_Exit_Dcm_DCM_EXCLUSIVE_AREA_0 </p>
<p> </p>
<p><b>For AUTOSAR 3.x Environment </b></p>
<p>SchM_Enter_Dcm </p>
<p>SchM_Exit_Dcm </p>
<p>NvM </p>
<p>NvM_ReadBlock </p>
<p>NvM_WriteBlock </p>
<p>NvM_CancelJobs </p>
<p>NvM_SetBlockLockStatus </p>
<p>NvM_GetErrorStatus </p>
<p>NvM_GetDcmBlockId </p>
<p>EcuM </p>
<p>EcuM_BswErrorHook </p>
<p>Table 6-20  </p>
<p>Services used by the DCM </p>
<p><b>6.4 </b></p>
<p><b>Callback Functions </b></p>
<p>This chapter describes the callback functions that are implemented by the DCM and can </p>
<p>be invoked by other modules. The prototypes of the callback functions are provided in the </p>
<p>header file </p>
<p>Dcm_Cbk.h</p>
<p> by the DCM. </p>
<p><b>6.4.1 </b></p>
<p><b>&lt;Module&gt; </b></p>
<p>The following callbacks are to be used from the module that implements the callouts: </p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;() </i></p>
<p><b>&gt; </b></p>
<p><i>&lt;Module&gt;_&lt;DiagnosticService&gt;_&lt;SubService&gt;() </i></p>
<p> </p>
<p><b>6.4.1.1 </b></p>
<p><b>Dcm_ExternalProcessingDone() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_ExternalProcessingDone</b></p>
<p> </p>
<p>( Dcm_MsgContextType* pMsgContext )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>pMsgContext </p>
<p>Message-related information for one diagnostic protocol identifier. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>Used by service interpreter outside of DCM to indicate that the current diagnostic service processing is </p>
<p>finished and (if required) a final response can be sent. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>113 </p>
<p>based on template version 5.0.0 </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x31 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-21  </p>
<p>Dcm_ExternalProcessingDone() </p>
<p> </p>
<p><b>6.4.1.2 </b></p>
<p><b>Dcm_ExternalSetNegResponse() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_ExternalSetNegResponse</b></p>
<p> </p>
<p>( Dcm_MsgContextType* pMsgContext, </p>
<p>Dcm_NegativeResponseCodeType ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p><b> </b></p>
<p>pMsgContext </p>
<p>Message-related information for one diagnostic protocol identifier. </p>
<p>ErrorCode </p>
<p>Contains the NRC to be returned to the diagnostic client. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>Used by service interpreter outside of DCM to indicate that a the final response shall be a negative one. </p>
<p>Dcm_ExternalSetNegResponse will not finalize the response processing. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x30 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-22  </p>
<p>Dcm_ExternalSetNegResponse() </p>
<p> </p>
<p><b>6.4.2 </b></p>
<p><b>ComM </b></p>
<p>The  DCM  supports  the  ComM  interface  according  to AR3  and AR4.  By  default, AR4  is </p>
<p>used. AR3 is only available in deliveries which are preconfigured accordingly.  </p>
<p><b>6.4.2.1 </b></p>
<p><b>Dcm_ComM_NoComModeEntered() </b></p>
<p><b>Prototype </b></p>
<p>ComM AR 4.x.x </p>
<p>void</p>
<p> </p>
<p><b>Dcm_ComM_NoComModeEntered</b></p>
<p> </p>
<p>( uint8 NetworkId )</p>
<p> </p>
<p>ComM AR 3.x.x </p>
<p>void</p>
<p> </p>
<p><b>Dcm_ComM_NoComModeEntered</b></p>
<p> </p>
<p>( void )</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>114 </p>
<p>based on template version 5.0.0 </p>
<p><b>Parameter </b></p>
<p>NetworkId </p>
<p>Identifier of the network concerned by the mode change. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This call informs the DCM module about a ComM mode change to COMM_NO_COMMUNICATION. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x21 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-23  </p>
<p>Dcm_ComM_NoComModeEntered() </p>
<p><b>6.4.2.2 </b></p>
<p><b>Dcm_ComM_SilentComModeEntered() </b></p>
<p><b>Prototype </b></p>
<p>ComM AR 4.x.x </p>
<p>void</p>
<p> </p>
<p><b>Dcm_ComM_SilentComModeEntered</b></p>
<p> </p>
<p>( uint8 NetworkId )</p>
<p> </p>
<p>ComM AR 3.x.x </p>
<p>void</p>
<p> </p>
<p><b>Dcm_ComM_SilentComModeEntered</b></p>
<p> </p>
<p>( void )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>NetworkId </p>
<p>Identifier of the network concerned by the mode change. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This call informs the DCM module about a ComM mode change to COMM_SILENT_COMMUNICATION. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x22 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-24  </p>
<p>Dcm_ComM_SilentComModeEntered() </p>
<p> </p>
<p><b>6.4.2.3 </b></p>
<p><b>Dcm_ComM_FullComModeEntered() </b></p>
<p><b>Prototype </b></p>
<p>ComM AR 4.x.x </p>
<p>void</p>
<p> </p>
<p><b>Dcm_ComM_FullComModeEntered</b></p>
<p> </p>
<p>( uint8 NetworkId )</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>115 </p>
<p>based on template version 5.0.0 </p>
<p>ComM AR 3.x.x </p>
<p>void</p>
<p> </p>
<p><b>Dcm_ComM_FullComModeEntered</b></p>
<p> </p>
<p>( void )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>NetworkId </p>
<p>Identifier of the network concerned by the mode change. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This call informs the DCM module about a ComM mode change to COMM_FULL_COMMUNICATION. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x23 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-25  </p>
<p>Dcm_ComM_FullComModeEntered() </p>
<p><b>6.4.3 </b></p>
<p><b>PduR </b></p>
<p>The  DCM  supports  different  versions  of  the  PduR  interface.  For  details  regarding  the </p>
<p>configuration, please refer to chapter <i>9.17 How to Deal with the PduR AR version</i>. </p>
<p> </p>
<p><b>6.4.3.1 </b></p>
<p><b>All AUTOSAR Versions </b></p>
<p><b>6.4.3.1.1 </b></p>
<p><b>Dcm_TriggerTransmit() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_TriggerTransmit</b></p>
<p> </p>
<p>( PduIdType DcmTxPduId, PduInfoType* Info )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmTxPduId </p>
<p>ID of DCM I-PDU that has been transmitted. </p>
<p>Range: 0..(maximum number of I-PDU IDs transmitted by DCM) - 1 </p>
<p>Info </p>
<p>Pointer to the data buffer where to be transmitted data shall be copied to. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: If data has been copied. </p>
<p> </p>
<p>E_NOT_OK: In case of any error detected within this API. </p>
<p><b>Functional Description </b></p>
<p>This is called by the PduR to get any data to be transmitted to a lower layer with timed triggered </p>
<p>transmission (i.e. FlexRay). </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xA2 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>116 </p>
<p>based on template version 5.0.0 </p>
<p>Table 6-26  </p>
<p>Dcm_TriggerTransmit () </p>
<p> </p>
<p><b>6.4.3.2 </b></p>
<p><b>AUTOSAR 4 </b></p>
<p><b>6.4.3.2.1 </b></p>
<p><b>Dcm_StartOfReception() </b></p>
<p><b>Prototype </b></p>
<p>PduR AR 4.0.3 (DCM Version &gt;= 1.00.00) </p>
<p>BufReq_ReturnType</p>
<p> </p>
<p><b>Dcm_StartOfReception</b></p>
<p> </p>
<p>( PduIdType DcmRxPduId, PduLengthType </p>
<p>TpSduLength, PduLengthType* RxBufferSizePtr )</p>
<p> </p>
<p>PduR AR 4.1.2 (DCM Version &gt;= 2.02.00) </p>
<p>BufReq_ReturnType</p>
<p> </p>
<p><b>Dcm_StartOfReception</b></p>
<p> </p>
<p>( PduIdType DcmRxPduId, PduInfoType* </p>
<p>info, PduLengthType TpSduLength, PduLengthType* RxBufferSizePtr )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmRxPduId </p>
<p>Identifies the DCM data to be received. This information is used within the </p>
<p>DCM to distinguish two or more receptions at the same time. </p>
<p>info </p>
<p>Pointer to a structure containing content and length of the first frame or single </p>
<p>frame including MetaData. </p>
<p>TpSduLength </p>
<p>This length identifies the overall number of bytes to be received.  </p>
<p>RxBufferSizePtr </p>
<p>Length of the available buffer. </p>
<p><b>Return code </b></p>
<p>BufReq_ReturnType </p>
<p>BUFREQ_OK: The diagnostic request will be accepted. </p>
<p>BUFREQ_E_NOT_OK: The diagnostic request will not be accepted at all (i.e. </p>
<p>no free buffer or processing context). </p>
<p>BUFREQ_E_OVFL: The diagnostic request could be accepted, but it will not fit </p>
<p>the configured buffer and therefore is rejected. </p>
<p><b>Functional Description </b></p>
<p>Called once to initialize the reception of a diagnostic request. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x00 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The prototype of the API depends on the AR version of the PduR (please refer to chapter <i>9.17 How to </i></p>
<p><i>Deal with the PduR AR version</i>). </p>
<p>Table 6-27  </p>
<p>Dcm_StartOfReception() </p>
<p><b>6.4.3.2.2 </b></p>
<p><b>Dcm_CopyRxData() </b></p>
<p><b>Prototype </b></p>
<p>BufReq_ReturnType</p>
<p> </p>
<p><b>Dcm_CopyRxData</b></p>
<p> </p>
<p>( PduIdType DcmRxPduId, PduInfoType* </p>
<p>PduInfoPtr, PduLengthType* RxBufferSizePtr )</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>117 </p>
<p>based on template version 5.0.0 </p>
<p><b>Parameter </b></p>
<p>DcmRxPduId </p>
<p>Identifies the DCM data to be received. This information is used within the </p>
<p>DCM to distinguish two or more receptions at the same time. </p>
<p>PduInfoPtr </p>
<p>Pointer to a PduInfoType which indicates the number of bytes to be copied </p>
<p>(SduLength) and the location of the source data (SduDataPtr). </p>
<p>An SduLength of 0 is possible in order to poll the available receive buffer size. </p>
<p>In this case no data are to be copied and PduInfoPtr might be invalid. </p>
<p>RxBufferSizePtr </p>
<p>Remaining free place in receive buffer after completion of this call. </p>
<p><b>Return code </b></p>
<p>BufReq_ReturnType </p>
<p>BUFREQ_OK: Data has been copied to the receive buffer completely as </p>
<p>requested. </p>
<p>BUFREQ_E_NOT_OK: Data has not been copied. Request failed. </p>
<p><b>Functional Description </b></p>
<p>Called once upon reception of each segment. Within this call, the received data is copied from the receive </p>
<p>TP buffer to the DCM receive buffer. </p>
<p>The API might only be called with an SduLength greater 0 if the RxBufferSizePtr returned by the previous </p>
<p>API call indicates sufficient receive buffer (SduLength &lt;= RxBufferSizePtr). </p>
<p>The function must only be called if the connection has been accepted by an initial call to </p>
<p>Dcm_StartOfReception. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x02 </p>
<p>&gt; </p>
<p>Reentrant for different PduIds. Non reentrant for the same PduId. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-28  </p>
<p>Dcm_CopyRxData() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>118 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.4.3.2.3 </b></p>
<p><b>Dcm_TpRxIndication() </b></p>
<p><b>Prototype </b></p>
<p>PduR AR 4.0.3 (DCM Version &gt;= 1.00.00) </p>
<p>void</p>
<p> </p>
<p><b>Dcm_TpRxIndication</b></p>
<p> </p>
<p>( PduIdType DcmRxPduId, NotifResultType Result )</p>
<p> </p>
<p>PduR AR 4.1.2 (DCM Version &gt;= 2.02.00) </p>
<p>void</p>
<p> </p>
<p><b>Dcm_TpRxIndication</b></p>
<p> </p>
<p>( PduIdType DcmRxPduId, Std_ReturnType Result )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmRxPduId </p>
<p>ID of DCM I-PDU that has been received. Identifies the data that has been </p>
<p>received. </p>
<p>Range: 0..(maximum number of I-PDU IDs received by DCM) – 1 </p>
<p>Result </p>
<p>PduR AR 4.0.3: </p>
<p>NTFRSLT_OK:  The complete N-PDU has been received and is stored in the </p>
<p>receive buffer. </p>
<p>any other value: The N_PDU has not been received; the receive buffer can be </p>
<p>unlocked by the DCM. </p>
<p> </p>
<p>PduR AR 4.1.2: </p>
<p>E_OK: the complete N-PDU has been received and is stored in the  </p>
<p>receive buffer  </p>
<p>E_NOT_OK: the N_PDU has not been received properly, DCM  </p>
<p>should prepare for a new reception. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This is called by the PduR to indicate the completion of a reception. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x03 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The prototype of the API depends on the AR version of the PduR (please refer to chapter <i>9.17 How to </i></p>
<p><i>Deal with the PduR AR version</i>). </p>
<p>Table 6-29  </p>
<p>Dcm_TpRxIndication() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>119 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.4.3.2.4 </b></p>
<p><b>Dcm_CopyTxData() </b></p>
<p><b>Prototype </b></p>
<p>BufReq_ReturnType</p>
<p> </p>
<p><b>Dcm_CopyTxData</b></p>
<p> </p>
<p>( PduIdType DcmTxPduId, PduInfoType* </p>
<p>PduInfoPtr, RetryInfoType* RetryInfoPtr, PduLengthType* TxDataCntPtr )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmTxPduId </p>
<p>Identifies the DCM data to be sent. This information is used to derive the PCI </p>
<p>information within the transport protocol. The value has to be same as in the </p>
<p>according service call PduR_DcmTransmit(). </p>
<p>PduInfoPtr </p>
<p>Pointer to a PduInfoType, which indicates the number of bytes to be copied </p>
<p>(SduLength) and the location where the data have to be copied to </p>
<p>(SduDataPtr). </p>
<p>An SduLength of 0 is possible in order to poll the available transmit data </p>
<p>count. In this case no data are to be copied and SduDataPtr might be invalid. </p>
<p>RetryInfoPtr </p>
<p>If the transmitted TP I-PDU does not support the retry feature a NULL_PTR </p>
<p>can be provided. This indicates that the copied transmit data can be removed </p>
<p>from the buffer after it has been copied. </p>
<p>TxDataCntPtr </p>
<p>Remaining Tx data after completion of this call. </p>
<p><b>Return code </b></p>
<p>BufReq_ReturnType </p>
<p>BUFREQ_OK: Data has been copied to the transmit buffer completely as </p>
<p>requested. </p>
<p>BUFREQ_E_NOT_OK: Data has not been copied. Request failed, in case the </p>
<p>corresponding I-PDU was stopped. </p>
<p>BUFREQ_E_BUSY: There is temporarily not enough data to be transmitted. </p>
<p>Retry later. </p>
<p><b>Functional Description </b></p>
<p>At invocation of Dcm_CopyTxData the DCM module copies the requested transmit data with ID PduId from </p>
<p>its internal transmit buffer to the location specified by the PduInfoPtr. The function Dcm_CopyTxData also </p>
<p>calculates and sets the TxDataCntPtr to the amount of remaining bytes for the transmission of this data. </p>
<p>If RetryInfoPtr is NULL_PTR or if TpDataState is equal to TP_DATACONF, the DCM shall always copy the </p>
<p>next fragment of data to the SduDataPtr. </p>
<p>No TpDataState other than TP_DATACONF is supported by the current DCM implementation. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x04 </p>
<p>&gt; </p>
<p>Reentrant for different PduIds. Non reentrant for the same PduId. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-30  </p>
<p>Dcm_CopyTxData() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>120 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.4.3.2.5 </b></p>
<p><b>Dcm_TpTxConfirmation() </b></p>
<p><b>Prototype </b></p>
<p>PduR AR 4.0.3 (DCM Version &gt;= 1.00.00) </p>
<p>void</p>
<p> </p>
<p><b>Dcm_TpTxConfirmation</b></p>
<p> </p>
<p>( PduIdType DcmTxPduId, NotifResultType Result )</p>
<p> </p>
<p>PduR AR 4.1.2 (DCM Version &gt;= 2.02.00) </p>
<p>void</p>
<p> </p>
<p><b>Dcm_TpTxConfirmation</b></p>
<p> </p>
<p>( PduIdType DcmTxPduId, Std_ReturnType Result )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmTxPduId </p>
<p>ID of DCM I-PDU that has been transmitted. </p>
<p>Range: 0..(maximum number of I-PDU IDs transmitted by DCM) – 1 </p>
<p>Result </p>
<p>PduR AR 4.0.3: </p>
<p>NTFRSLT_OK if the complete N-PDU has been transmitted.  </p>
<p>any other value: an error occurred during transmission, the DCM can unlock </p>
<p>the transmit buffer. </p>
<p> </p>
<p>PduR AR 4.1.2: </p>
<p>E_OK: the complete N-PDU has been transmitted.  </p>
<p>E_NOT_OK: an error occurred during transmission, the DCM can  </p>
<p>unlock the transmit buffer </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This is called by the PduR to confirm an end of transport protocol (e.g. CanTp) transmission. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x05 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The prototype of the API depends on the AR version of the PduR (please refer to chapter <i>9.17 How to </i></p>
<p><i>Deal with the PduR AR version</i>). </p>
<p>Table 6-31  </p>
<p>Dcm_TpTxConfirmation() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>121 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.4.3.2.6 </b></p>
<p><b>Dcm_TxConfirmation() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_TxConfirmation</b></p>
<p> </p>
<p>( PduIdType DcmTxPduId )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmTxPduId </p>
<p>ID of DCM I-PDU that has been transmitted. </p>
<p>Range: 0..(maximum number of I-PDU IDs transmitted by DCM) – 1 </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This is called by the PduR to confirm an end of interface (e.g. CanIf) transmission. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xA1 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-32  </p>
<p>Dcm_TxConfirmation() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>122 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.4.3.3 </b></p>
<p><b>AUTOSAR 3 </b></p>
<p><b>6.4.3.3.1 </b></p>
<p><b>Dcm_ProvideRxBuffer() </b></p>
<p><b>Prototype </b></p>
<p>BufReq_ReturnType</p>
<p> </p>
<p><b>Dcm_ProvideRxBuffer</b></p>
<p> </p>
<p>( PduIdType DcmRxPduId, PduLengthType  </p>
<p>TpSduLength, PduInfoType** PduInfoPtr )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmRxPduId </p>
<p>Identifies the DCM data to be received. This information is used within the </p>
<p>DCM to distinguish two or more receptions at the same time. </p>
<p>TpSduLength </p>
<p>The overall length of the message being received. </p>
<p>PduInfoPtr </p>
<p>Pointer to pointer to PduInfoType containing data pointer and length of a </p>
<p>receive buffer, which is provided by the DCM.  </p>
<p>Note that certain TP's will put an initial value inside the length buffer, which is </p>
<p>the minimal size of the RxBuffer. This value is ignored by the DCM. </p>
<p><b>Return code </b></p>
<p>BufReq_ReturnType </p>
<p>BUFREQ_OK: buffer has been successfully provided. </p>
<p>BUFREQ_E_OVFL: no buffer provided, available buffer is too small. </p>
<p>BUFREQ_E_NOT_OK: no buffer provided, request failed. </p>
<p><b>Functional Description </b></p>
<p>Called at least once upon reception by a lower layer TP to request a buffer, where the received data will be </p>
<p>stored. </p>
<p>When called multiple times, the DCM expects that the previously provided buffer has been filled up </p>
<p>completely. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x02 </p>
<p>&gt; </p>
<p>Reentrant for different PduIds. Non reentrant for the same PduId. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-33  </p>
<p>Dcm_ProvideRxBuffer () </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>123 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.4.3.3.2 </b></p>
<p><b>Dcm_RxIndication() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_RxIndication</b></p>
<p> </p>
<p>( PduIdType DcmRxPduId, NotifResultType Result )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmRxPduId </p>
<p>ID of DCM I-PDU that has been received. Identifies the data that has been </p>
<p>received. </p>
<p>Range: 0..(maximum number of I-PDU IDs received by DCM) – 1 </p>
<p>Result </p>
<p>NTFRSLT_OK:  The complete I-PDU has been received and is stored in the </p>
<p>receive buffer. </p>
<p>any other value: The I-PDU has not been received; the receive buffer can be </p>
<p>unlocked by the DCM. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This is called by the PduR to indicate the completion of a reception. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x03 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-34  </p>
<p>Dcm_RxIndication() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>124 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.4.3.3.3 </b></p>
<p><b>Dcm_ProvideTxBuffer() </b></p>
<p><b>Prototype </b></p>
<p>BufReq_ReturnType</p>
<p> </p>
<p><b>Dcm_ProvideTxBuffer</b></p>
<p> </p>
<p>( PduIdType DcmTxPduId, PduInfoType** </p>
<p>PduInfoPtr, PduLengthType Length )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmTxPduId </p>
<p>Identifies the DCM data to be sent. This information is used to derive the PCI </p>
<p>information within the transport protocol. The value has to be same as in the </p>
<p>according service call PduR_DcmTransmit(). </p>
<p>PduInfoPtr </p>
<p>Pointer to pointer to PduInfoStructure containing data pointer and length of a </p>
<p>transmit buffer which is provided by the DCM. </p>
<p>Length </p>
<p>Minimum buffer size requested by the lower layer. </p>
<p>A length of zero indicates that the length of the buffer can be of arbitrary size </p>
<p>(larger than zero). The Length parameter is expected by DCM to be always </p>
<p>zero. </p>
<p><b>Return code </b></p>
<p>BufReq_ReturnType </p>
<p>BUFREQ_OK: buffer has been successfully provided. </p>
<p>BUFREQ_E_NOT_OK: no buffer provided, request failed. </p>
<p>BUFREQ_E_BUSY: There is temporarily not enough data to be transmitted. </p>
<p>Retry later. </p>
<p><b>Functional Description </b></p>
<p>Called by a lower layer TP to request a buffer with data to be transmitted. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x04 </p>
<p>&gt; </p>
<p>Reentrant for different PduIds. Non reentrant for the same PduId. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-35  </p>
<p>Dcm_ProvideTxBuffer () </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>125 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.4.3.3.4 </b></p>
<p><b>Dcm_TxConfirmation() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_TxConfirmation</b></p>
<p> </p>
<p>( PduIdType DcmTxPduId, NotifResultType Result )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DcmTxPduId </p>
<p>ID of DCM I-PDU that has been transmitted. </p>
<p>Range: 0..(maximum number of I-PDU IDs transmitted by DCM) – 1 </p>
<p>Result </p>
<p>NTFRSLT_OK if the complete I-PDU has been transmitted.  </p>
<p>any other value: an error occurred during transmission, the DCM can unlock </p>
<p>the transmit buffer. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This is called by the PduR to confirm an end of transmission. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x05 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-36  </p>
<p>Dcm_TxConfirmation() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>126 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.4.4 </b></p>
<p><b>CanTp </b></p>
<p><b>6.4.4.1 </b></p>
<p><b>Dcm_OnRequestDetection() </b></p>
<p><b>Prototype </b></p>
<p>void <b>Dcm_OnRequestDetection </b>( PduIdType canTpRxPduId, uint8 tpAddrExtension )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>canTpRxPduId </p>
<p>Represents the CanIf to CanTp RxPduId of the request. </p>
<p>tpAddrExtension </p>
<p>Defines the address extension byte value of the message. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This API will be called by the CanTp each time a new TP CAN frame of type first-frame or single-frame is </p>
<p>received. The DCM will check whether this CAN message applies to any DCM connection (i.e. the CAN </p>
<p>message is one of the DCM clients’ physical requests). If so, any ongoing diagnostic (request/response) </p>
<p>transmission over this client connection will be terminated. Additionally if there is service processing in </p>
<p>progress, it will be terminated too. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xA4 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>This function is only available if DCM shall support Mixed11 addressing CanTp connections. </p>
<p>Table 6-37  </p>
<p>Dcm_ OnRequestDetection() </p>
<p> </p>
<p><b>6.5 </b></p>
<p><b>Configurable Interfaces </b></p>
<p><b>6.5.1 </b></p>
<p><b>Callout Functions  </b></p>
<p>At  its  configurable  interfaces  the  DCM  defines  callout functions. The  declarations of  the </p>
<p>callout functions are provided by the BSW module, i.e. the DCM. It is the integrator's task </p>
<p>to  provide  the  corresponding  function  definitions.  The  definitions  of  the  callouts  can  be </p>
<p>adjusted to  the  system's needs. The  DCM  callout function  declarations  are  described  in </p>
<p>the following tables: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>127 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.1 </b></p>
<p><b>&lt;Module&gt;_&lt;DiagnosticService&gt;() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>&lt;Module&gt;_&lt;DiagnosticService&gt;</b></p>
<p> </p>
<p>( Dcm_OpStatusType OpStatus, </p>
<p>Dcm_MsgContextType* pMsgContext )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>DCM_INITIAL: All In-parameters are valid. </p>
<p>DCM_PENDING: All parameters are still valid. This is the subsequent function </p>
<p>calls after DCM_E_PENDING has been returned. </p>
<p>DCM_CANCEL: All In-parameters are still valid, but since this call is a final </p>
<p>one it must be used to finalize any pending activities only. </p>
<p>DCM_FORCE_RCRRP_OK: (Vendor extension) The enforced RCR-RP </p>
<p>transmission has finished with success. </p>
<p>DCM_FORCE_RCRRP_NOT_OK: (Vendor extension) The enforced RCR-RP </p>
<p>transmission has failed </p>
<p>pMsgContext </p>
<p>Message-related information for one diagnostic protocol identifier. The </p>
<p>pointers in pMsgContext points behind the SID. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: Request was successful. </p>
<p>DCM_E_PENDING: Request is not yet finished. </p>
<p>DCM_E_FORCE_RCRRP: (Vendor extension) Forces a RCR-RP response. </p>
<p>The call out will called again once the response is sent. The OpStatus </p>
<p>parameter will contain the transmission result. </p>
<p>DCM_E_PROCESSINGDONE: (Vendor extension): Can be returned instead </p>
<p>of calling Dcm_ProcessingDone for the current pMsgContext. Saves </p>
<p>application code and stack usage. </p>
<p><b>Functional Description </b></p>
<p>DCM calls a function of this kind as soon as a supported diagnostic service, configured to be handled by a </p>
<p>CDD, is received. All of the relevant diagnostic request parameter information is forwarded by DCM through </p>
<p>the pMsgContext function parameter. </p>
<p> </p>
<p>The concrete name of the callout is defined by the configuration parameter </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService/DcmDsdSidTabFnc. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x32 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is asynchronous. </p>
<p>Table 6-38  </p>
<p>&lt;Module&gt;_&lt;DiagnosticService&gt;() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>128 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.2 </b></p>
<p><b>&lt;Module&gt;_&lt;DiagnosticService&gt;_&lt;SubService&gt;() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>&lt;Module&gt;_&lt;DiagnosticService&gt;_&lt;SubService&gt;</b></p>
<p> </p>
<p>( Dcm_OpStatusType </p>
<p>OpStatus, Dcm_MsgContextType* pMsgContext )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>DCM_INITIAL: All In-parameters are valid. </p>
<p>DCM_PENDING: All parameters are still valid. This is the subsequent function </p>
<p>calls after DCM_E_PENDING has been returned. </p>
<p>DCM_CANCEL: All In-parameters are still valid, but since this call is a final </p>
<p>one it must be used to finalize any pending activities only. </p>
<p>DCM_FORCE_RCRRP_OK: (Vendor extension) The enforced RCR-RP </p>
<p>transmission has finished with success. </p>
<p>DCM_FORCE_RCRRP_NOT_OK: (Vendor extension) The enforced RCR-RP </p>
<p>transmission has failed. </p>
<p>pMsgContext </p>
<p>Message-related information for one diagnostic protocol sub-function identifier. </p>
<p>The pointer in pMsgContext points behind the sub-function. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: Request was successful. </p>
<p>DCM_E_PENDING: Request is not yet finished. </p>
<p>DCM_E_FORCE_RCRRP: (Vendor extension) Forces a RCR-RP response. </p>
<p>The call out will called again once the response is sent. The OpStatus </p>
<p>parameter will contain the transmission result. </p>
<p>DCM_E_PROCESSINGDONE: (Vendor extension): Can be returned instead </p>
<p>of calling Dcm_ProcessingDone for the current pMsgContext. Saves </p>
<p>application code and stack usage. </p>
<p><b>Functional Description </b></p>
<p>DCM calls a function of this kind as soon as a supported diagnostic sub-service, configured to be handled </p>
<p>by a CDD, is received. All of the relevant diagnostic request parameter information is forwarded by DCM </p>
<p>through the pMsgContext function parameter. </p>
<p> </p>
<p>The concrete name of the callout is defined by the configuration parameter </p>
<p>/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable/DcmDsdService/DcmDsdSubService/DcmDsdSubSer</p>
<p>viceFnc. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x33 </p>
<p>&gt; </p>
<p>This function is reentrant. </p>
<p>&gt; </p>
<p>This function is asynchronous. </p>
<p>Table 6-39  </p>
<p>&lt;Module&gt;_&lt;DiagnosticService&gt;_&lt;SubService&gt;() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>129 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.3 </b></p>
<p><b>Dcm_SetProgConditions() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Dcm_SetProgConditions</b></p>
<p> </p>
<p>( Dcm_ProgConditionsType * ProgConditions )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>ProgConditions </p>
<p>Conditions on which the jump to bootloader has been requested. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: Conditions have correctly been set. </p>
<p>E_NOT_OK: Conditions cannot be set. </p>
<p>DCM_E_PENDING: Conditions set is in progress, a further call to this API is </p>
<p>needed to end the setting. </p>
<p><b>Functional Description </b></p>
<p>The Dcm_SetProgConditions callout allows the integrator to store relevant information prior jumping to </p>
<p>bootloader. The context parameters are defined in Dcm_ProgConditionsType. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = N/A </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is asynchronous. </p>
<p>Table 6-40  </p>
<p>Dcm_SetProgConditions() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>130 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.4 </b></p>
<p><b>Dcm_GetProgConditions() </b></p>
<p><b>Prototype </b></p>
<p>Dcm_EcuStartModeType</p>
<p> </p>
<p><b>Dcm_GetProgConditions</b></p>
<p> </p>
<p>( Dcm_ProgConditionsType * </p>
<p>ProgConditions )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>ProgConditions </p>
<p>Conditions on which the jump from the bootloader has been requested. </p>
<p><b>Return code </b></p>
<p>Dcm_EcuStartModeType </p>
<p>DCM_COLD_START: The ECU starts normally. </p>
<p>DCM_WARM_START: The ECU starts from a bootloader jump. The function </p>
<p>parameter values will be evaluated for further processing. </p>
<p><b>Functional Description </b></p>
<p>The Dcm_GetProgConditions callout is called upon DCM initialization and allows determining if a response </p>
<p>($50 or $51) has to be sent depending on request within the bootloader. The context parameters are </p>
<p>defined in Dcm_ProgConditionsType. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = N/A </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-41  </p>
<p>Dcm_GetProgConditions() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>131 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.5 </b></p>
<p><b>Dcm_Confirmation() </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>Dcm_Confirmation</b></p>
<p> </p>
<p>( Dcm_IdContextType idContext, PduIdType dcmRxPduId, </p>
<p>Dcm_ConfirmationStatusType status )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>idContext </p>
<p>Current context identifier which can be used to retrieve the relation between </p>
<p>request and confirmation. </p>
<p>Within the confirmation, the Dcm_MsgContext is no more available, so the </p>
<p>idContext can be used to represent this relation. </p>
<p>The idContext is also part of the Dcm_MsgContext </p>
<p> </p>
<p>dcmRxPduId </p>
<p>DcmRxPduId on which the request was received. The source of the request </p>
<p>can have consequences for message processing. </p>
<p>status </p>
<p>Status indication about confirmation (differentiate failure indication and normal </p>
<p>confirmation) / The parameter &quot;Result&quot; of &quot;Dcm_TxConfirmation&quot; shall be </p>
<p>forwarded to status depending if a positive or negative responses was sent </p>
<p>before. </p>
<p><b>Return code </b></p>
<p>void </p>
<p>N/A </p>
<p><b>Functional Description </b></p>
<p>This function confirms the successful transmission or a transmission error of a diagnostic service. The </p>
<p>idContext and the dcmRxPduId are required to identify the message which was processed. If there was no </p>
<p>response for this request, this call out is invoked at service processing finish. </p>
<p> </p>
<p>Note: This call out is invoked only then when a DCM internal or external &lt;Module&gt;_&lt;DiagnosticService&gt; </p>
<p>service handler has been executed. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 41 </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-42  </p>
<p>Dcm_Confirmation() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>132 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.6 </b></p>
<p><b>Dcm_ReadMemory() </b></p>
<p><b>Prototype </b></p>
<p>Dcm_ReturnReadMemoryType</p>
<p> </p>
<p><b>Dcm_ReadMemory</b></p>
<p> </p>
<p>( Dcm_OpStatusType OpStatus, uint8 </p>
<p>MemoryIdentifier, uint32 MemoryAddress, uint32 MemorySize, uint8* MemoryData [, </p>
<p>Dcm_NegativeResponseCodeType* ErrorCode] )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>DCM_INITIAL: All In-parameters are valid. </p>
<p>DCM_PENDING: All parameters are still valid. This is the subsequent function </p>
<p>calls after DCM_E_PENDING has been returned. </p>
<p>DCM_CANCEL: All In-parameters are still valid, but since this call is a final </p>
<p>one it must be used to finalize any pending activities only. </p>
<p>DCM_FORCE_RCRRP_OK: (Vendor extension) The enforced RCR-RP </p>
<p>transmission has finished with success. </p>
<p>DCM_FORCE_RCRRP_NOT_OK: (Vendor extension) The enforced RCR-RP </p>
<p>transmission has failed. </p>
<p>MemoryIdentifier </p>
<p>MemoryIdentifier  Identifier of the Memory Block (e.g. used if memory section </p>
<p>distinguishing is needed) </p>
<p>Note: If it's not used this parameter shall be set to 0. </p>
<p> </p>
<p>MemoryAddress </p>
<p>Starting address of server memory from which data is to be retrieved. </p>
<p>MemorySize </p>
<p>Number of bytes in the MemoryData </p>
<p>MemoryData </p>
<p>Data read (Points to the diagnostic buffer in DCM). </p>
<p>ErrorCode </p>
<p><b>Optional parameter. </b>Exists only in AR 4.2.2 or later enabled DCMs. </p>
<p>If written by the application, a specific NRC will be sent back. This NRC is </p>
<p>evaluated only in case DCM_READ_FAILED is returned. </p>
<p><b>Return code </b></p>
<p>Dcm_ReturnReadMemory</p>
<p>Type </p>
<p>DCM_READ_OK: read was successful </p>
<p>DCM_READ_FAILED: read was not successful </p>
<p>DCM_READ_PENDING: read is not yet finished </p>
<p>DCM_READ_FORCE_RCRRP: enforce RCR-RP transmission (vendor </p>
<p>extension) </p>
<p><b>Functional Description </b></p>
<p>The Dcm_ReadMemory callout is used to request memory data identified by the parameter </p>
<p>memoryAddress and memorySize from the UDS request message. This service is needed for the </p>
<p>implementation of UDS services:  </p>
<p>- </p>
<p><i>ReadMemoryByAddress ($23) </i></p>
<p>- </p>
<p><i>ReadDataByIdentifier ($22) </i>(in case of Dynamical DID defined by memory address) </p>
<p>- </p>
<p><i>ReadDataByPeriodicIdentifier ($2A) </i>(in case of Dynamical DID defined by memory address) </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x26 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is asynchronous. </p>
<p>Table 6-43  </p>
<p>Dcm_ReadMemory() </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>133 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p><b>6.5.1.7 </b></p>
<p><b>Dcm_WriteMemory() </b></p>
<p><b>Prototype </b></p>
<p>Dcm_ReturnWriteMemoryType</p>
<p> </p>
<p><b>Dcm_WriteMemory</b></p>
<p> </p>
<p>( Dcm_OpStatusType OpStatus, uint8 </p>
<p>MemoryIdentifier, uint32 MemoryAddress, uint32 MemorySize, uint8* MemoryData[, </p>
<p>Dcm_NegativeResponseCodeType* ErrorCode] )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>DCM_INITIAL: All In-parameters are valid. </p>
<p>DCM_PENDING: All parameters are still valid. This is the subsequent function </p>
<p>calls after DCM_E_PENDING has been returned. </p>
<p>DCM_CANCEL: All In-parameters are still valid, but since this call is a final </p>
<p>one it must be used to finalize any pending activities only. </p>
<p>DCM_FORCE_RCRRP_OK: (Vendor extension) The enforced RCR-RP </p>
<p>transmission has finished with success. </p>
<p>DCM_FORCE_RCRRP_NOT_OK: (Vendor extension) The enforced RCR-RP </p>
<p>transmission has failed. </p>
<p>MemoryIdentifier </p>
<p>MemoryIdentifier  Identifier of the Memory Block (e.g. used if memory section </p>
<p>distinguishing is needed) </p>
<p>Note: If it's not used this parameter shall be set to 0. </p>
<p> </p>
<p>MemoryAddress </p>
<p>Starting address of server memory where the data is to be written. </p>
<p>MemorySize </p>
<p>Number of bytes in the MemoryData </p>
<p>MemoryData </p>
<p>Data to be written (Points to the diagnostic buffer in DCM). </p>
<p>ErrorCode </p>
<p><b>Optional parameter. </b>Exists only in AR 4.2.2 or later enabled DCMs. </p>
<p>If written by the application, a specific NRC will be sent back. This NRC is </p>
<p>evaluated only in case DCM_WRITE_FAILED is returned. </p>
<p><b>Return code </b></p>
<p>Dcm_ReturnWriteMemor</p>
<p>yType </p>
<p>DCM_WRITE_OK: write was successful </p>
<p>DCM_WRITE_FAILED: write was not successful </p>
<p>DCM_WRITE_PENDING: write is not yet finished </p>
<p>DCM_WRITE_FORCE_RCRRP: enforce RCR-RP transmission (vendor </p>
<p>extension) </p>
<p><b>Functional Description </b></p>
<p>The Dcm_WriteMemory callout is used to write memory data identified by the parameter memoryAddress </p>
<p>and memorySize. This service is needed for the implementation of UDS services : </p>
<p>- </p>
<p><i>WriteMemoryByAddress ($3D) </i></p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x27 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is asynchronous. </p>
<p>Table 6-44  </p>
<p>Dcm_WriteMemory() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>134 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.8 </b></p>
<p><b>&lt;Diagnostic Session Change Notification Callback&gt; </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>&lt;Diagnostic Session Change Callback&gt;</b></p>
<p> </p>
<p>(Dcm_SesCtrlType formerSesCtrlId, </p>
<p>Dcm_SesCtrlType newSesCtrlId)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>formerSesCtrlId </p>
<p>Specifies the former diagnostic session ID (transition’s source state) </p>
<p>newSesCtrlId </p>
<p>Specifies the new diagnostic session ID (transition’s target state) </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Functional Description </b></p>
<p>Any configured function of this kind will be called at a diagnostic session state transition. </p>
<p><b>Note:  </b></p>
<p>The function argument values have the same definition as the ones returned by the API </p>
<p><i>Dcm_GetSesCtrlType()</i>. </p>
<p> </p>
<p>Please refer also to <i>9.23 How to Know When the Diagnostic Session Changes </i>for more details on how to </p>
<p>configure such a callback and when it will be called. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-45  </p>
<p>&lt; Diagnostic Session Change Notification Callback &gt; </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>135 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.9 </b></p>
<p><b>&lt;Security Access Change Notification Callback&gt; </b></p>
<p><b>Prototype </b></p>
<p>void</p>
<p> </p>
<p><b>&lt;Security Access Change Callback&gt;</b></p>
<p> </p>
<p>(Dcm_SecLevelType formerSecLevelId, </p>
<p>Dcm_SecLevelType newSecLevelId)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>formerSecLevelId </p>
<p>Specifies the former security access level ID (transition’s source state) </p>
<p>newSecLevelId </p>
<p>Specifies the new security access level ID (transition’s target state) </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Functional Description </b></p>
<p>Any configured function of this kind will be called at a security access level state transition. </p>
<p><b>Note:  </b></p>
<p>The function argument values have the same definition as the ones returned by the API </p>
<p><i>Dcm_GetSecurityLevel()</i>. </p>
<p> </p>
<p>Please refer also to <i>9.16.2 Calling a Function Implemented Within a CDD Module </i>for more details on how </p>
<p>to configure such a callback and when it will be called. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-46  </p>
<p>&lt;Security Access Change Notification Callback&gt; </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>136 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.10 </b></p>
<p><b>Dcm_GetRecoveryStates() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType Dcm_GetRecoveryStates (<i>Dcm_RecoveryInfoType</i>* RecoveryInfo)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>RecoveryInfo </p>
<p>Contains all the information that has to be recovered. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: Recovery info is available and valid, process it. </p>
<p>DCM_E_PENDING: Recovery info not yet available, call again. </p>
<p>E_NOT_OK: No information to be recovered or result reading failed. DCM will </p>
<p>continue with the default initialized states. </p>
<p><b>Functional Description </b></p>
<p>This API will be called by DCM within the first <i>Dcm_MainFunction() </i>call right after the call of <i>Dcm_Init()</i>. </p>
<p>For details on the usage of this API, please refer chapter <i>9.27 How to Recover DCM State Context on ECU </i></p>
<p><i>Reset/ Power On</i>. </p>
<p> </p>
<p>Note:  </p>
<p>- </p>
<p>If no recovery of any state is needed (default startup of DCM), then the return value shall always be </p>
<p>E_NOT_OK. </p>
<p>- </p>
<p>Before this API is called, DCM will lock any external connections until the result is processed. This </p>
<p>is required in order to be able to switch into a consistent state without any influence from outside. </p>
<p>- </p>
<p>For details on the recovered information, please refer the data type definition: </p>
<p><i>Dcm_RecoveryInfoType</i>. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xA5 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is asynchronous. </p>
<p>Table 6-47  </p>
<p>Dcm_GetRecoveryStates() </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>It is not intended to use <i>Dcm_GetRecoveryStates() </i>as a standalone API. The data it </p>
<p>transfers depends on the DCM implementation version. For optimization reasons, the </p>
<p>data structure uses internal data representation and not any official DCM AR APIs (e.g. </p>
<p>macros for session and security access, or communication channel SNVs). Thus, it </p>
<p>shall be used only if the information provider (<i>Dcm_ProvideRecoveryStates()</i>) has been </p>
<p>used. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>137 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.11 </b></p>
<p><b>Dcm_FilterDidLookUpResult </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>Dcm_FilterDidLookUpResult</b>(Dcm_OpStatusType OpStatus, uint16 Did, </p>
<p>Dcm_DidOpType DidOperation) </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>Did </p>
<p>Data Identifier to be filtered. </p>
<p>DidOperation </p>
<p>DCM_DID_OP_READ: Available for services 0x22, 0x2A. </p>
<p>DCM_DID_OP_WRITE: Available for service 0x2E. </p>
<p>DCM_DID_OP_IO: Available for service 0x2F. </p>
<p>DCM_DID_OP_SCALINGINFO: Available for service 0x24. </p>
<p>DCM_DID_OP_DEFINE: Available for service 0x2C. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The DID is (still) active. </p>
<p>DCM_E_PENDING: The DID validation needs more time. Call this API again.  </p>
<p>E_NOT_OK: The DID is not active.  </p>
<p><b>Functional Description </b></p>
<p>This API will be called by DCM to check whether a particular combination of a DID and a DID operation is </p>
<p>still supported. The return of that API is E_OK if that DID is active for the provided DID operation. This API </p>
<p>is used in the filtering feature described in <i>9.29 How to Handle Multiple Diagnostic Service Variants</i>. </p>
<p><b>Particularities and Limitations </b></p>
<p><b>&gt; </b></p>
<p>This function is not reentrant. </p>
<p><b>&gt; </b></p>
<p>This function is asynchronous. </p>
<p>Table 6-48  </p>
<p>Dcm_FilterDidLookUpResult  </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>138 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.1.12 </b></p>
<p><b>Dcm_FilterRidLookUpResult </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>Dcm_FilterRidLookUpResult</b>(Dcm_OpStatusType OpStatus, uint16 Rid) </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>Rid </p>
<p>Routine Identifier to be filtered. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The RID is (still) active. </p>
<p>DCM_E_PENDING: The RID validation needs more time. Call this API again.  </p>
<p>E_NOT_OK: The RID is not active. </p>
<p><b>Functional Description </b></p>
<p>This API will be called by DCM to check whether a particular RID is still supported. The return of that API is </p>
<p>E_OK if that RID is active. This API is used in the filtering feature illustrated in <i>9.29 How to Handle Multiple </i></p>
<p><i>Diagnostic Service Variants</i>. </p>
<p><b>Particularities and Limitations </b></p>
<p><b>&gt; </b></p>
<p>This function is not reentrant. </p>
<p><b>&gt; </b></p>
<p>This function is asynchronous. </p>
<p>Table 6-49  </p>
<p>Dcm_FilterRidLookUpResult </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>139 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2 </b></p>
<p><b>Required Port Operation Functions </b></p>
<p><b>6.5.2.1 </b></p>
<p><b>ConditionCheckRead() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>ConditionCheckRead</b></p>
<p> </p>
<p>( Dcm_OpStatusType OpStatus, </p>
<p>Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application, if the conditions to read a data element are </p>
<p>correct. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x37 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The “OpStatus” parameter is only available if DcmDspDataUsePort is set to </p>
<p>USE_DATA_ASYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p>Table 6-50  </p>
<p>ConditionCheckRead() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>140 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.2 </b></p>
<p><b>ReadData() (asynchronous) </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>ReadData</b></p>
<p> </p>
<p>( Dcm_OpStatusType OpStatus, uint8* Data )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>Data </p>
<p>Buffer where the read data shall be copied. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. The DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to get a data value of a DID/PID if </p>
<p>DcmDspDataUsePort is set to USE_DATA_ASYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x3B </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-51  </p>
<p>ReadData() (asynchronous) </p>
<p> </p>
<p><b>6.5.2.3 </b></p>
<p><b>ReadData() (synchronous) </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>ReadData</b></p>
<p> </p>
<p>( uint8* Data )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>Data </p>
<p>Buffer where the read data shall be copied. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>E_NOT_OK: The operation has failed. The DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to get a data value of a DID/PID if </p>
<p>DcmDspDataUsePort is set to USE_DATA_SYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x34 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-52  </p>
<p>ReadData() (synchronous) </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>141 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p><b>6.5.2.4 </b></p>
<p><b>ReadDataLength() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>ReadDataLength</b></p>
<p> </p>
<p>(Dcm_OpStatusType OpStatus, uint16* DataLength )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>DataLength </p>
<p>Length of the data to be read. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>E_NOT_OK: The operation has failed. The DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to return the data length of a data element. </p>
<p> </p>
<p>Note: This callout type is available only if the DID has dynamic length. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x36 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The “OpStatus” parameter is only available if DcmDspDataUsePort is set to </p>
<p>USE_DATA_ASYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p>Table 6-53  </p>
<p>ReadDataLength() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>142 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.5 </b></p>
<p><b>WriteData() (dynamic length) </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>WriteData</b></p>
<p> </p>
<p>( uint8* Data, uint16 DataLength, Dcm_OpStatusType </p>
<p>OpStatus, Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>Data </p>
<p>Buffer containing the data to be written. </p>
<p>DataLength </p>
<p>Length of the data to be written. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to set the data value of a DID. </p>
<p> </p>
<p>Note: This callout type is available only if the DID has dynamic length. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x3E </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The “OpStatus” parameter is only available if DcmDspDataUsePort is set to </p>
<p>USE_DATA_ASYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p>Table 6-54  </p>
<p>WriteData() (dynamic length) </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>143 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.6 </b></p>
<p><b>WriteData() (static length) </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>WriteData</b></p>
<p> </p>
<p>( uint8* Data, Dcm_OpStatusType OpStatus, </p>
<p>Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>Data </p>
<p>Buffer containing the data to be written. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to set the data value of a DID. </p>
<p> </p>
<p>Note: This callout type is available only if the DID has constant length. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x35 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The “OpStatus” parameter is only available if DcmDspDataUsePort is set to </p>
<p>USE_DATA_ASYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p>Table 6-55  </p>
<p>WriteData() (static length) </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>144 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.7 </b></p>
<p><b>ReturnControlToECU() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>ReturnControlToECU</b></p>
<p> </p>
<p>( Dcm_OpStatusType OpStatus, &lt;ControlMaskType&gt; </p>
<p>ControlMask, Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ControlMask </p>
<p>Contains/points to the CEMR from request or equals 0xF..F (all signals) on </p>
<p>lost session/security permissions. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK). </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: <b>This return value is not allowed to be used! </b></p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to return control of an IOControl back to the </p>
<p>ECU. </p>
<p>For details about the usage of the ControlMask parameter and the possible ControlMaskTypes, please </p>
<p>refer to chapter <i>5.22.3 Implementation Aspects </i>of <i>InputOutputControlByIdentifier ($2F).</i></p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x39 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The “OpStatus” parameter is only available if DcmDspDataUsePort is set to </p>
<p>USE_DATA_ASYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p>&gt; </p>
<p>The DCM_E_PENDING return value is not allowed to be used due to the fact that this operation shall </p>
<p>always be executed synchronously. Refer to <i>5.22.3 Implementation Aspects </i>of </p>
<p><i>InputOutputControlByIdentifier ($2F) </i>for details. </p>
<p>&gt; </p>
<p>The “ControlMask” parameter is only available if DcmDspDidControlMask is set to </p>
<p>“DCM_CONTROLMASK_EXTERNAL”. </p>
<p>Table 6-56  </p>
<p>ReturnControlToECU() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>145 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.8 </b></p>
<p><b>ResetToDefault() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>ResetToDefault</b></p>
<p> </p>
<p>( Dcm_OpStatusType OpStatus, &lt;ControlMaskType&gt; </p>
<p>ControlMask, Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ControlMask </p>
<p>Contains/points to the CEMR from request. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to reset an IOControl to default value. </p>
<p>For details about the usage of the ControlMask parameter and the possible ControlMaskTypes, please </p>
<p>refer to chapter <i>5.22.3 Implementation Aspects </i>of <i>InputOutputControlByIdentifier ($2F). </i></p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x3C </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The “OpStatus” parameter is only available if DcmDspDataUsePort is set to </p>
<p>USE_DATA_ASYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p>&gt; </p>
<p>The “ControlMask” parameter is only available if DcmDspDidControlMask is set to </p>
<p>“DCM_CONTROLMASK_EXTERNAL”. </p>
<p>Table 6-57  </p>
<p>ResetToDefault() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>146 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.9 </b></p>
<p><b>FreezeCurrentState() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>FreezeCurrentState</b></p>
<p> </p>
<p>( Dcm_OpStatusType OpStatus, &lt;ControlMaskType&gt; </p>
<p>ControlMask, Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ControlMask </p>
<p>Contains/points to the CEMR from request. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to freeze the current state of an IOControl. </p>
<p>For details about the usage of the ControlMask parameter and the possible ControlMaskTypes, please </p>
<p>refer to chapter <i>5.22.3 Implementation Aspects </i>of <i>InputOutputControlByIdentifier ($2F). </i></p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x3A </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The “OpStatus” parameter is only available if DcmDspDataUsePort is set to </p>
<p>USE_DATA_ASYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p>&gt; </p>
<p>The “ControlMask” parameter is only available if DcmDspDidControlMask is set to </p>
<p>“DCM_CONTROLMASK_EXTERNAL”. </p>
<p>Table 6-58  </p>
<p>FreezeCurrentState() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>147 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.10 </b></p>
<p><b>ShortTermAdjustment() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>ShortTermAdjustment</b></p>
<p> </p>
<p>( uint8* ControlOptionRecord, </p>
<p>Dcm_OpStatusType OpStatus, &lt;ControlMaskType&gt; ControlMask, </p>
<p>Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>ControlOptionRecord </p>
<p>Control option parameter for the adjustment request. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ControlMask </p>
<p>Contains/points to the CEMR from request. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to adjust the IO signal. </p>
<p>For details about the usage of the ControlMask parameter and the possible ControlMaskTypes, please </p>
<p>refer to chapter <i>5.22.3 Implementation Aspects </i>of <i>InputOutputControlByIdentifier ($2F). </i></p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x3D </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The “OpStatus” parameter is only available if DcmDspDataUsePort is set to </p>
<p>USE_DATA_ASYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p>&gt; </p>
<p>The “ControlMask” parameter is only available if DcmDspDidControlMask is set to </p>
<p>“DCM_CONTROLMASK_EXTERNAL”. </p>
<p>Table 6-59  </p>
<p>ShortTermAdjustment() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>148 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.11 </b></p>
<p><b>GetScalingInformation() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>GetScalingInformation</b>(Dcm_OpStatusType OpStatus, uint8* </p>
<p>ScalingInfo, Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ScalingInfo </p>
<p>Buffer where the read scaling info data shall be copied. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to read the scaling information of the </p>
<p>corresponding data signal. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x38 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>&gt; </p>
<p>The “OpStatus” parameter is only available if DcmDspDataUsePort is set to </p>
<p>USE_DATA_ASYNCH_CLIENT_SERVER/ USE_DATA_ASYNCH_FNC. </p>
<p>Table 6-60  </p>
<p>GetScalingInformation() </p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>149 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.12 </b></p>
<p><b>Start() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Start</b></p>
<p> </p>
<p>( [&lt;DataType&gt; &lt;ReqSignalName&gt;,] Dcm_OpStatusType OpStatus, </p>
<p>                      [&lt;DataType&gt; &lt;ResSignalName&gt;,] [uint16(*) DataLength,]  </p>
<p>                      Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>&lt;ReqSignalName&gt; </p>
<p><b>Optional list of parameters. </b></p>
<p>Exists only if at least one request signal is defined in the configuration for this </p>
<p>RID operation. </p>
<p>For each signal there will be a dedicated function parameter of the data type </p>
<p>derived from the configuration. The parameter name is the same as the ECUC </p>
<p>data container name. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>&lt;ResSignalName&gt; </p>
<p><b>Optional list of parameters. </b></p>
<p>Exists only if at least one response signal is defined in the configuration for </p>
<p>this RID operation. </p>
<p>For each signal there will be a dedicated function parameter of the data type </p>
<p>derived from the configuration. The parameter name is the same as the ECUC </p>
<p>data container name. </p>
<p>DataLength </p>
<p><b>Optional parameter. </b>Exists only if either the last request or response signal </p>
<p>has dynamic length. </p>
<p>As IN parameter contains the current request length (for dynamic length RID </p>
<p>requests). </p>
<p>As OUT parameter shall return the actual response length (for dynamic length </p>
<p>RID responses). </p>
<p>The DCM will ignore the returned value on RIDs with static response length. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>DCM_E_FORCE_RCRRP: Forces a RCR-RP response. The service port will </p>
<p>be called again once the RCR-RP response is sent. The OpStatus parameter </p>
<p>will contain the transmission result. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to start a RID execution. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = N/A </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-61  </p>
<p>Start() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>150 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.13 </b></p>
<p><b>Stop() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Stop</b></p>
<p> </p>
<p>( [&lt;DataType&gt; &lt;ReqSignalName&gt;,] Dcm_OpStatusType OpStatus, </p>
<p>                     [&lt;DataType&gt; &lt;ResSignalName&gt;,] [uint16(*) DataLength,]  </p>
<p>                     Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>&lt;ReqSignalName&gt; </p>
<p><b>Optional list of parameters. </b></p>
<p>Exists only if at least one request signal is defined in the configuration for this </p>
<p>RID operation. </p>
<p>For each signal there will be a dedicated function parameter of the data type </p>
<p>derived from the configuration. The parameter name is the same as the ECUC </p>
<p>data container name. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>&lt;ResSignalName&gt; </p>
<p><b>Optional list of parameters. </b></p>
<p>Exists only if at least one response signal is defined in the configuration for </p>
<p>this RID operation. </p>
<p>For each signal there will be a dedicated function parameter of the data type </p>
<p>derived from the configuration. The parameter name is the same as the ECUC </p>
<p>data container name. </p>
<p>DataLength </p>
<p><b>Optional parameter. </b>Exists only if either the last request or response signal </p>
<p>has dynamic length. </p>
<p>As IN parameter contains the current request length (for dynamic length RID </p>
<p>requests). </p>
<p>As OUT parameter shall return the actual response length (for dynamic length </p>
<p>RID responses). </p>
<p>The DCM will ignore the returned value on RIDs with static response length. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>DCM_E_FORCE_RCRRP: Forces a RCR-RP response. The service port will </p>
<p>be called again once the RCR-RP response is sent. The OpStatus parameter </p>
<p>will contain the transmission result. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to stop an already started RID execution. </p>
<p>Note: The DCM will call this function even if the concrete RID was not started yet. The application shall take </p>
<p>care about correct sequence execution. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = N/A </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>151 </p>
<p>based on template version 5.0.0 </p>
<p>Table 6-62  </p>
<p>Stop() </p>
<p><b>6.5.2.14 </b></p>
<p><b>RequestResults() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>RequestResults</b></p>
<p> </p>
<p>(  </p>
<p>                      [&lt;DataType&gt; &lt;ReqSignalName&gt;,] Dcm_OpStatusType OpStatus, </p>
<p>                      [&lt;DataType&gt; &lt;ResSignalName&gt;,] [uint16(*) DataLength,]  </p>
<p>                      Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>&lt;ReqSignalName&gt; </p>
<p><b>Optional list of parameters. </b></p>
<p>Exists only if at least one request signal is defined in the configuration for this </p>
<p>RID operation. </p>
<p>For each signal there will be a dedicated function parameter of the data type </p>
<p>derived from the configuration. The parameter name is the same as the ECUC </p>
<p>data container name. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>&lt;ResSignalName&gt; </p>
<p><b>Optional list of parameters. </b></p>
<p>Exists only if at least one response signal is defined in the configuration for </p>
<p>this RID operation. </p>
<p>For each signal there will be a dedicated function parameter of the data type </p>
<p>derived from the configuration. The parameter name is the same as the ECUC </p>
<p>data container name. </p>
<p>DataLength </p>
<p><b>Optional parameter. </b>Exists only if either the last request or response signal </p>
<p>has dynamic length. </p>
<p>As IN parameter contains the current request length (for dynamic length RID </p>
<p>requests). </p>
<p>As OUT parameter shall return the actual response length (for dynamic length </p>
<p>RID responses). </p>
<p>The DCM will ignore the returned value on RIDs with static response length. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>DCM_E_FORCE_RCRRP: Forces a RCR-RP response. The service port will </p>
<p>be called again once the RCR-RP response is sent. The OpStatus parameter </p>
<p>will contain the transmission result. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to read the routine result of a stopped RID </p>
<p>execution. </p>
<p><b>Particularities and Limitations </b></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>152 </p>
<p>based on template version 5.0.0 </p>
<p>&gt; </p>
<p>ServiceID = N/A </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-63  </p>
<p>RequestResults() </p>
<p> </p>
<p><b>6.5.2.15 </b></p>
<p><b>GetSeed() (with SADR) </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>GetSeed</b></p>
<p> </p>
<p>(uint8* SecurityAccessDataRecord, Dcm_OpStatusType </p>
<p>OpStatus, uint8* Seed, Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>Seed </p>
<p>Points to the response seed data. </p>
<p>SecurityAccessDataRe</p>
<p>cord </p>
<p>Points to the request data. If the current security access level does not have </p>
<p>any request data, the pointer is still valid (points behind the sub-function byte). </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to provide a security level specific seed. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x44 </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-64  </p>
<p>GetSeed() (with SADR) </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>153 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.16 </b></p>
<p><b>GetSeed() (without SADR) </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>GetSeed</b></p>
<p> </p>
<p>(Dcm_OpStatusType OpStatus, uint8* Seed, </p>
<p>Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>Seed </p>
<p>Points to the response seed data. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to provide a security level specific seed. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x45 </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-65  </p>
<p>GetSeed() (without SADR) </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>154 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.17 </b></p>
<p><b>CompareKey() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>CompareKey</b></p>
<p> </p>
<p>( uint8* Key, Dcm_OpStatusType OpStatus [, </p>
<p>Dcm_NegativeResponseCodeType* ErrorCode])</p>
<p> </p>
<p><b>Parameter </b></p>
<p>Key </p>
<p>Points to the requested key. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>ErrorCode </p>
<p><b>Optional parameter. </b>Exists only in AR 4.2.1 or later enabled DCMs </p>
<p>If written by the application, a specific NRC will be sent back. This NRC is </p>
<p>evaluated only in case E_NOT_OK is returned. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>DCM_E_COMPARE_KEY_FAILED: The received key is not a valid one. NRC </p>
<p>0x35/0x36 will be send accordingly. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set. Otherwise </p>
<p>the DCM sends NRC 0x35/0x36 as for return value </p>
<p>DCM_E_COMPARE_KEY_FAILED </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to verify the requested security access level </p>
<p>specific key. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x47 </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-66  </p>
<p>CompareKey() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>155 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.18 </b></p>
<p><b>Indication() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Indication</b></p>
<p> </p>
<p>( uint8 SID, uint8* RequestData, uint16 DataSize, </p>
<p>uint8 ReqType, uint16 SourceAddress, Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>SID </p>
<p>Contains the diagnostic service Id. </p>
<p>RequestData </p>
<p>Points to the request data. Points behind the service Id byte. </p>
<p>DataSize </p>
<p>Specifies the requested data length (without the SID byte). </p>
<p>ReqType </p>
<p>Specifies the diagnostic request type: 0 - physical request, 1 - functional </p>
<p>request. </p>
<p>SourceAddress </p>
<p>Contains the diagnostic client source address. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_REQUEST_NOT_ACCEPTED: The diagnostic service shall not be </p>
<p>processed. No response will be sent. </p>
<p>E_NOT_OK: The operation has failed. A concrete NRC shall be set, otherwise </p>
<p>the DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to validate the received diagnostic service, </p>
<p>additionally to the DCM internal validation. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = N/A </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-67  </p>
<p>Indication() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>156 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.19 </b></p>
<p><b>Confirmation() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>Confirmation</b></p>
<p> </p>
<p>( uint8 SID, uint8 ReqType, uint16 SourceAddress, </p>
<p>Dcm_ConfirmationStatusType ConfirmationStatus )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>SID </p>
<p>Contains the diagnostic service Id. </p>
<p>ReqType </p>
<p>Specifies the diagnostic request type: 0 - physical request, 1 - functional </p>
<p>request. </p>
<p>SourceAddress </p>
<p>Contains the diagnostic client source address. </p>
<p>ConfirmationStatus </p>
<p>Contains the response transmission resp. diagnostic response type. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished. </p>
<p>E_NOT_OK: The operation has failed. Has no effect on DCM. </p>
<p><b>Functional Description </b></p>
<p>This function is a notification from the DCM to the application that a diagnostic service processing is </p>
<p>finished. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = N/A </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-68  </p>
<p>Confirmation() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>157 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.20 </b></p>
<p><b>GetDTRValue() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>GetDTRValue (</b>Dcm_OpStatusType OpStatus, uint16* Testval, uint16* </p>
<p>MinLimit, uint16* MaxLimit, DTRStatusType * Status)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. Since the operation is synchronous, only </p>
<p>possible value is DCM_INITIAL. </p>
<p>Testval </p>
<p>Returns the current test value. </p>
<p>MinLimit </p>
<p>Returns the minimum limit. </p>
<p>MaxLimit </p>
<p>Returns the maximum limit. </p>
<p>Status </p>
<p>Returns the TID status:  </p>
<p>- </p>
<p>DCM_DTRSTATUS_VISIBLE: all returned values are valid. </p>
<p>- </p>
<p>DCM_DTRSTATUS_INVISIBLE: all returned values are invalid. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>E_NOT_OK: The operation has failed, DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to report the corresponding MID test data. If the </p>
<p>data is currently not available the Status parameter shall be set to INVISIBLE. DCM will send to the tester </p>
<p>zero values. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = N/A </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-69  </p>
<p>GetDTRValue() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>158 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.21 </b></p>
<p><b>RequestControl() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>RequestControl ( </b>uint8* OutBuffer, uint8* InBuffer)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OutBuffer </p>
<p>Points to the response routine control data. If the current TID does not have </p>
<p>any data, the pointer is still valid (points behind the TID parameter). </p>
<p>InBuffer </p>
<p>Points to the request routine control data. If the current TID does not have any </p>
<p>data, the pointer is still valid (points behind the TID parameter). </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>E_NOT_OK: The operation has failed, DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to start a TID execution. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = N/A </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-70  </p>
<p>RequestControl() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>159 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.22 </b></p>
<p><b>GetInfotypeValueData() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>GetInfotypeValueData (</b>Dcm_OpStatusType OpStatus, uint8* </p>
<p>DataValueBuffer [, uint8* DataValueBufferSize])</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>DataValueBuffer </p>
<p>Points to the response of the VID data. </p>
<p>DataValueBufferSize </p>
<p><b>Optional parameter. </b>Exists only in AR 4.2.2 or later enabled DCMs. </p>
<p>The input value is the total/maximum size of the VID data (incl. NODI) in </p>
<p>bytes, configured in DCMs ECUC file (refer to <i>5.8.4</i>). </p>
<p>The output value is the current size of the VID data (incl. NODI) in bytes, </p>
<p>returned by the application.  </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed, DCM sends NRC 0x22. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to read the corresponding vehicle information. As </p>
<p>long as the data is temporarily not available, the DCM_E_PENDING code shall be returned. Once the data </p>
<p>is available, the E_OK shall be used to acknowledge that. </p>
<p> </p>
<p>The returned data size (via </p>
<p>DataValueBufferSize</p>
<p>) shall always be less or equal to the value passed by </p>
<p>DCM as input. </p>
<p> </p>
<p>Refer to chapter <i>9.31 How to Enable Support of OBD VIDs with Dynamic Length </i>for details. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x60 (introduced first with AR 4.3.0 DCM SWS) </p>
<p>&gt; </p>
<p>This function is asynchronous. </p>
<p>Table 6-71  </p>
<p>GetInfotypeValueData() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>160 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.23 </b></p>
<p><b>StartProtocol() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>StartProtocol (<i></b>Dcm_ProtocolType </i>ProtocolID)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>ProtocolID </p>
<p>Specifies the protocol ID of the new protocol to be started. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The protocol switch is allowed. </p>
<p>DCM_E_PROTOCOL_NOT_ALLOWED: The old protocol shall not be stopped </p>
<p>and the new one is not accepted, DCM sends NRC 0x22 to the new request. </p>
<p>E_NOT_OK: Same as DCM_E_PROTOCOL_NOT_ALLOWED. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to get permission for switching to a new protocol. </p>
<p>It is called each time a request from a diagnostic client belonging to a protocol other than the currently </p>
<p>active one is received or for the very first diagnostic request (i.e. switches from no active protocol to any </p>
<p>other supported one).  </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = N/A </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-72  </p>
<p>StartProtocol() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>161 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.24 </b></p>
<p><b>IsDidAvailable()  </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>IsDidAvailable </b>( uint16 DID, Dcm_OpStatusType OpStatus, </p>
<p>Dcm_DidSupportedType* supported)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DID </p>
<p>The DID to be checked for active in the current range. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>supported </p>
<p>Returns the information whether the DID is a supported one: </p>
<p>DCM_DID_SUPPORTED: requested DID is a valid one; </p>
<p>DCM_DID_NOT_SUPPORTED: requested DID is not a valid one; </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. The DCM will treat the DID as </p>
<p>unsupported one. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to get information whether the requested DID, </p>
<p>from a supported DID range is really a valid one or not.  </p>
<p>Note: This operation is only available if the corresponding DID range has been specified to have gaps (i.e. </p>
<p>not all DIDs within the range are valid ones). </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x3F </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is asynchronous. </p>
<p>Table 6-73  </p>
<p>IsDidAvailable () </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>162 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.25 </b></p>
<p><b>ReadDidData()  </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>ReadDidData</b></p>
<p> </p>
<p>( uint16 DID, uint8* Data, Dcm_OpStatusType OpStatus, </p>
<p>uint16* DataLength, Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DID </p>
<p>The DID which data will be read. </p>
<p>Data </p>
<p>Buffer where the read data shall be copied. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>DataLength </p>
<p>Actual length of the read data. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. The DCM sends NRC 0x22, if </p>
<p>ErrorCode is not set. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to get the data of a concrete DID within a DID </p>
<p>range.  </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x40 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-74  </p>
<p>ReadDidData() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>163 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.26 </b></p>
<p><b>WriteDidData()  </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>WriteDidData</b></p>
<p> </p>
<p>( uint16 DID, uint8* Data, Dcm_OpStatusType </p>
<p>OpStatus, uint16* DataLength, Dcm_NegativeResponseCodeType* ErrorCode )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>DID </p>
<p>The DID which data will be written. </p>
<p>Data </p>
<p>Buffer where the requested data shall be copied from. </p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>DataLength </p>
<p>Actual length of the data to be written. </p>
<p>ErrorCode </p>
<p>NRC to be sent in the negative response in case of failure (E_NOT_OK) </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. The DCM sends NRC 0x22, if </p>
<p>ErrorCode is not set. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to write the requested data of a concrete DID </p>
<p>within a DID range.  </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x41 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-75  </p>
<p>WriteDidData() </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>164 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.27 </b></p>
<p><b>GetSecurityAttemptCounter() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>GetSecurityAttemptCounter</b>(Dcm_OpStatusType OpStatus, uint8* </p>
<p>AttemptCounter)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>AttemptCounter </p>
<p>Contains the stored attempt-counter value. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed. The counter value will be assumed to </p>
<p>be zero. Note: The delay-timer could be started, depending on the </p>
<p>configuration (see below). </p>
<p><b>Functional Description </b></p>
<p>Once DCM is initialized, DCM requests this function per security level to get the stored attempt-counter </p>
<p>value prior last power-down/reset event. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x59 </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is asynchronous. </p>
<p>&gt; </p>
<p>Exists for a certain security level only if the security row „DcmDspSecurityAttemptCounterEnabled” </p>
<p>specific parameter is enabled and the security level supports brute-force-attack prevention (i.e. delay </p>
<p>counter/timer). </p>
<p>Table 6-76  </p>
<p>GetSecurityAttemptCounter () </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>165 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.28 </b></p>
<p><b>SetSecurityAttemptCounter() </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>SetSecurityAttemptCounter</b>(Dcm_OpStatusType OpStatus, uint8 </p>
<p>AttemptCounter)</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>AttemptCounter </p>
<p>Contains the current attempt-counter value. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished </p>
<p>DCM_E_PENDING: The operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed.  </p>
<p><b>Functional Description </b></p>
<p>Each time the corresponding security level counter value is changes, DCM will first notify the application </p>
<p>calling this API to store the new value prior giving any result to the diagnostic client. </p>
<p> </p>
<p>Note:  </p>
<p>DCM cannot provide any failed-write counter behavior replacement. It is up to the application to provide at </p>
<p>next <i>GetSecurityAttemptCounter() </i>call an appropriate counter value, resp. just E_NOT_OK. If this API fails </p>
<p>to store the current counter value, the NRC sent back is still one of the appropriate ones 0x35 or 0x36. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0x5A </p>
<p>&gt; </p>
<p>Not Reentrant </p>
<p>&gt; </p>
<p>This function is asynchronous. </p>
<p>&gt; </p>
<p>Exists for a certain security level only if the security row „DcmDspSecurityAttemptCounterEnabled” </p>
<p>specific parameter is enabled and the security level supports brute-force-attack prevention (i.e. delay </p>
<p>counter/timer). </p>
<p>Table 6-77  </p>
<p>SetSecurityAttemptCounter () </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>166 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.5.2.29 </b></p>
<p><b>ReadData() (paged-data-reading) </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType</p>
<p> </p>
<p><b>ReadData</b></p>
<p> </p>
<p>( Dcm_OpStatusType OpStatus, uint8* Data, uint16* </p>
<p>DataLength )</p>
<p> </p>
<p><b>Parameter </b></p>
<p>OpStatus </p>
<p>Status of the current operation. </p>
<p>Data </p>
<p>Buffer where the read data shall be copied. </p>
<p>DataLength </p>
<p>As IN parameter contains the currently available buffer size. </p>
<p>As OUT parameter shall return the actual data chunk length. </p>
<p><b>Return code </b></p>
<p>Std_ReturnType </p>
<p>E_OK: The operation is finished, all data chunks are copied </p>
<p>DCM_E_PENDING: Current data chunk read operation is not yet finished. </p>
<p>E_NOT_OK: The operation has failed.  </p>
<p>DCM_E_BUFFERTOOLOW: There was more data to be copied, but the </p>
<p>provided buffer was not big enough to fit all of them. The </p>
<p>DataLength </p>
<p>parameter contains the amount of currently copied data. </p>
<p><b>Functional Description </b></p>
<p>This function is a request from the DCM to the application to get a data value of a DID if </p>
<p>DcmDspDataUsePort is set to USE_PAGED_DATA_ASYNCH_CLIENT_SERVER/ </p>
<p>USE_PAGED_DATA_ASYNCH_FNC. </p>
<p>For details on this API usage, please refer to chapter <i>9.24 How to Save RAM using Paged-Buffer for Large </i></p>
<p><i>DIDs</i>. </p>
<p><b>Particularities and Limitations </b></p>
<p>&gt; </p>
<p>ServiceID = 0xA3 </p>
<p>&gt; </p>
<p>This function is not reentrant. </p>
<p>&gt; </p>
<p>This function is synchronous. </p>
<p>Table 6-78  </p>
<p>ReadData() (paged-data-reading) </p>
<p> </p>
<p><b>6.6 </b></p>
<p><b>Service Ports  </b></p>
<p><b>6.6.1 </b></p>
<p><b>Client-Server Interface </b></p>
<p>A client server interface is related to a Provide Port at the server side and a Require Port </p>
<p>at client side.  </p>
<p><b>6.6.1.1 </b></p>
<p><b>Provide Ports on DCM Side </b></p>
<p>At  the  Provide  Ports  of  the  DCM  the  API  functions  described  in  6.2  are  available  as </p>
<p>Runnable Entities. The Runnable Entities are invoked via Operations. The mapping from a </p>
<p>SWC client call to an Operation is performed by the RTE. In this mapping the RTE adds </p>
<p>Port Defined Argument Values to the client call of the SWC, if configured. </p>
<p>The  following  sub-chapters  present  the  Provide  Ports  defined  for  the  DCM  and  the </p>
<p>Operations defined for the Provide Ports, the API functions related to the Operations and </p>
<p>the Port Defined Argument Values to be added by the RTE. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>167 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p><b>6.6.1.1.1 </b></p>
<p><b>DCMServices </b></p>
<p><b>Operation </b></p>
<p><b>API Function </b></p>
<p><b>Arguments </b></p>
<p>GetActiveProtocol </p>
<p><i>Dcm_GetActiveProtocol() </i></p>
<p>OUT Dcm_ProtocolType </p>
<p>ActiveProtocol, ERR{E_OK} </p>
<p>GetSesCtrlType </p>
<p><i>Dcm_GetSesCtrlType() </i></p>
<p>OUT Dcm_SesCtrlType SesCtrlType, </p>
<p>ERR{E_OK} </p>
<p>GetSecurityLevel </p>
<p><i>Dcm_GetSecurityLevel() </i></p>
<p>OUT Dcm_SecLevelType SecLevel, </p>
<p>ERR{E_OK} </p>
<p>ResetToDefaultSession </p>
<p><i>Dcm_ResetToDefaultSession() </i></p>
<p>ERR{E_OK} </p>
<p>GetSecurityLevelFixedBytes </p>
<p><i>Dcm_GetSecurityLevelFixedBytes() </i></p>
<p>IN Dcm_SecLevelType secLevel,  </p>
<p>OUT uint8 fixedBytes,  </p>
<p>INOUT uint8 bufferSize </p>
<p>ERR{E_NOT_OK, </p>
<p>DCM_E_BUFFERTOOLOW} </p>
<p>SetActiveDiagnostic </p>
<p><i>Dcm_SetActiveDiagnostic() </i></p>
<p>boolean Active, </p>
<p>ERR{E_OK} </p>
<p>GetRequestKind </p>
<p><i>Dcm_GetRequestKind() </i></p>
<p>IN uint16 TesterSourceAddress, </p>
<p>OUT Dcm_RequestKindType </p>
<p>RequestKind, </p>
<p>ERR{E_NOT_OK} </p>
<p>Table 6-79  </p>
<p>DCMServices </p>
<p><b>6.6.1.2 </b></p>
<p><b>Require Ports on DCM Side </b></p>
<p>At its Require Ports the DCM calls Operations. These Operations have to be provided by </p>
<p>the  SWCs  by  means  of  Runnable  Entities.  These  Runnable  Entities  implement  the </p>
<p>callback functions expected by the DCM. </p>
<p>The following sub-chapters present the Require Ports defined for the DCM, the Operations </p>
<p>that are called from the DCM and the related Notifications, which are described in chapter </p>
<p><i>6.4.4</i>. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>168 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.6.1.2.1 </b></p>
<p><b>DataServices_&lt;DataName&gt; </b></p>
<p><b>Operation </b></p>
<p><b>Callout </b></p>
<p><i>ConditionCheckRead() </i></p>
<p>Rte_Call_DataServices_&lt;DataName&gt;_&lt;Operation&gt; </p>
<p> </p>
<p><i>ReadData() (synchronous) / </i></p>
<p><i>ReadData() (asynchronous) / </i></p>
<p><i>ReadData() (paged-data-reading) </i></p>
<p><i>ReadDataLength() </i></p>
<p><i>WriteData() (static length) / </i></p>
<p><i>WriteData() (dynamic length) </i></p>
<p><i>ReturnControlToECU() </i></p>
<p><i>ResetToDefault() </i></p>
<p><i>FreezeCurrentState() </i></p>
<p><i>ShortTermAdjustment() </i></p>
<p><i>GetScalingInformation() </i></p>
<p>Table 6-80  </p>
<p>DataServices_&lt;DataName&gt; </p>
<p> </p>
<p><b>6.6.1.2.2 </b></p>
<p><b>RoutineServices_&lt;RoutineName&gt; </b></p>
<p><b>Operation </b></p>
<p><b>Callout </b></p>
<p><i>Start() </i></p>
<p>Rte_Call_RoutineServices_&lt;RoutineName&gt;_&lt;Operation&gt; </p>
<p> </p>
<p><i>Stop() </i></p>
<p><i>RequestResults() </i></p>
<p>Table 6-81  </p>
<p>RoutineServices_&lt;RoutineName&gt; </p>
<p> </p>
<p> </p>
<p><b>6.6.1.2.3 </b></p>
<p><b>SecurityAccess_&lt;SecurityLevelName&gt; </b></p>
<p><b>Operation </b></p>
<p><b>Callout </b></p>
<p><i>GetSeed() (with SADR) </i>/ </p>
<p><i>GetSeed() (without SADR) </i></p>
<p>Rte_Call_SecurityAccess_&lt;SecurityLevelName&gt;_&lt;Operation&gt; </p>
<p> </p>
<p><i>CompareKey() </i></p>
<p><i>GetSecurityAttemptCounter() </i></p>
<p><i>SetSecurityAttemptCounter() </i></p>
<p>Table 6-82  </p>
<p>SecurityAccess_&lt;SecurityLevelName&gt; </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>169 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.6.1.2.4 </b></p>
<p><b>ServiceRequestManufacturerNotification_&lt;SWC&gt; </b></p>
<p><b>Operation </b></p>
<p><b>Callout </b></p>
<p><i>Indication() </i></p>
<p>Rte_Call_ServiceRequestManufacturerNotification_&lt;SWC&gt;_&lt;Operation&gt; </p>
<p><i>Confirmation() </i></p>
<p>Table 6-83  </p>
<p>ServiceRequestManufacturerNotification_&lt;SWC&gt; </p>
<p> </p>
<p><b>6.6.1.2.5 </b></p>
<p><b>ServiceRequestSupplierNotification_&lt;SWC&gt; </b></p>
<p><b>Operation </b></p>
<p><b>Callout </b></p>
<p><i>Indication() </i></p>
<p>Rte_Call_ServiceRequestSupplierNotification_&lt;SWC&gt;_&lt;Operation&gt; </p>
<p><i>Confirmation() </i></p>
<p>Table 6-84  </p>
<p>ServiceRequestSupplierNotification_&lt;SWC&gt; </p>
<p> </p>
<p><b>6.6.1.2.6 </b></p>
<p><b>DtrServices_&lt;MIDName&gt;_&lt;TIDName&gt; </b></p>
<p><b>Operation </b></p>
<p><b>Callout </b></p>
<p><i>GetDTRValue() </i></p>
<p>Rte_Call_DtrServices_&lt;MIDName&gt;_&lt;TIDName&gt;_&lt;Operation&gt; </p>
<p>Table 6-85  </p>
<p>DtrServices_&lt;MIDName&gt;_&lt;TIDName&gt; </p>
<p> </p>
<p><b>6.6.1.2.7 </b></p>
<p><b>RequestControlServices_&lt;TIDName&gt; </b></p>
<p><b>Operation </b></p>
<p><b>Callout </b></p>
<p><i>RequestControl() </i></p>
<p>Rte_Call_RequestControlServices_&lt;TIDName&gt;_&lt;Operation&gt; </p>
<p>Table 6-86  </p>
<p>RequestControlServices_&lt;TIDName&gt; </p>
<p> </p>
<p><b>6.6.1.2.8 </b></p>
<p><b>InfotypeServices_&lt;VEHINFODATA&gt; </b></p>
<p><b>Operation </b></p>
<p><b>Callout </b></p>
<p><i>GetInfotypeValueData() </i></p>
<p>Rte_Call_InfotypeServices_&lt;VEHINFODATA&gt;_&lt;Operation&gt; </p>
<p>Table 6-87  </p>
<p>InfotypeServices_&lt;VEHINFODATA&gt; </p>
<p> </p>
<p><b>6.6.1.2.9 </b></p>
<p><b>CallbackDCMRequestServices_&lt;SWC&gt; </b></p>
<p><b>Operation </b></p>
<p><b>Callout </b></p>
<p><i>StartProtocol() </i></p>
<p>Rte_Call_CallbackDCMRequestServices_&lt;SWC&gt;_&lt;Operation&gt; </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>170 </p>
<p>based on template version 5.0.0 </p>
<p>Table 6-88  </p>
<p>CallbackDCMRequestServices_&lt;SWC &gt; </p>
<p> </p>
<p><b>6.6.1.2.10 </b></p>
<p><b>DataServices_DIDRange_&lt;RangeName&gt; </b></p>
<p><b>Operation </b></p>
<p><b>Callout </b></p>
<p><i>IsDidAvailable() </i></p>
<p>Rte_Call_DataServices_DIDRange_&lt;RangeName&gt;_&lt;Operation&gt; </p>
<p><i>ReadDidData() </i></p>
<p><i>WriteDidData() </i></p>
<p>Table 6-89  </p>
<p>DataServices_DIDRange_&lt;RangeName&gt; </p>
<p> </p>
<p><b>6.6.2 </b></p>
<p><b>Managed Mode Declaration Groups </b></p>
<p>DCM is a mode manager of the following modes. </p>
<p><b>ModeDeclarationGroup </b></p>
<p><b>Description </b></p>
<p><i>DcmDiagnosticSessionControl </i></p>
<p>Represents the diagnostic sessions from the </p>
<p>DCM configuration. </p>
<p><i>DcmCommunicationControl_&lt;ComM_CHANNEL</i></p>
<p><i>_SNV&gt; </i></p>
<p>For each ComM channel, there is a mode </p>
<p>declaration group that represents the </p>
<p>communication state of the channel.  </p>
<p><i>DcmEcuReset </i></p>
<p>Represents the normal ECU reset modes. </p>
<p><i>DcmModeRapidPowerShutDown </i></p>
<p>Represents the extended ECU reset modes. </p>
<p><i>DcmControlDTCSetting </i></p>
<p>Represents the DTC setting state. </p>
<p><i>DcmSecurityAccess </i></p>
<p>Represents the security access level from the </p>
<p>DCM configuration. </p>
<p>Table 6-90  </p>
<p>ModeDeclarationGroups managed by DCM </p>
<p> </p>
<p><b>6.6.2.1 </b></p>
<p><b>DcmDiagnosticSessionControl </b></p>
<p><b>Callout </b></p>
<p><b>Description </b></p>
<p>Rte_Switch_Dcm_DcmDiagnosticSessionControl_</p>
<p>DcmDiagnosticSessionControl </p>
<p>Called each time a session change occurs. This </p>
<p>call is only a notification and has no effect on any </p>
<p>DCM diagnostic service processing. </p>
<p>Invoked by <i>DiagnosticSessionControl ($10) </i>or S3 </p>
<p>timeout. </p>
<p>Table 6-91  </p>
<p>DcmDiagnosticSessionControl callouts </p>
<p><b>Mode </b></p>
<p><b>Description </b></p>
<p>DefaultSession </p>
<p>Represents the UDS Default session (initial </p>
<p>state). </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>171 </p>
<p>based on template version 5.0.0 </p>
<p><b>Mode </b></p>
<p><b>Description </b></p>
<p>ProgrammingSession </p>
<p>Represents the UDS Programming session. </p>
<p>ExtendedSession </p>
<p>Represents the UDS Extended session. </p>
<p>&lt;/Dcm/DcmConfigSet/DcmDsp/DcmDspSession/</p>
<p>DcmDspSessionRow&gt; container‘s short-name </p>
<p>Any user defined session. </p>
<p>Table 6-92  </p>
<p>DcmDiagnosticSessionControl modes </p>
<p> </p>
<p><b>6.6.2.2 </b></p>
<p><b>DcmCommunicationControl_&lt;ComM_CHANNEL_SNV&gt; </b></p>
<p><b>Callout </b></p>
<p><b>Description </b></p>
<p>Rte_Switch_Dcm_DcmCommunicationControl_&lt;C</p>
<p>omMChannelSNV&gt;_ </p>
<p>Dcm_DcmCommunicationControl_&lt;ComMChannel</p>
<p>SNV&gt; </p>
<p>Called each time a communication state change </p>
<p>on the corresponding channel occurs. This call is </p>
<p>only a notification and has no effect on any DCM </p>
<p>diagnostic service processing. </p>
<p>Invoked by service <i>CommunicationControl ($28) </i></p>
<p>or <i>DiagnosticSessionControl ($10) </i>or S3 timeout. </p>
<p>Table 6-93  </p>
<p>DcmCommunicationControl _&lt;ComM_CHANNEL_SNV&gt; callouts </p>
<p><b>Mode </b></p>
<p><b>Description </b></p>
<p>DCM_ENABLE_RX_TX_NORM </p>
<p>Reception and transmission of application </p>
<p>messages is enabled (initial state). </p>
<p>DCM_ENABLE_RX_DISABLE_TX_NORM </p>
<p>Reception of application messages is enabled </p>
<p>but their transmission is disabled. </p>
<p>DCM_DISABLE_RX_ENABLE_TX_NORM </p>
<p>Reception of application messages is disabled </p>
<p>but their transmission is enabled. </p>
<p>DCM_DISABLE_RX_TX_NORMAL </p>
<p>Reception and transmission of application </p>
<p>messages is disabled. </p>
<p>DCM_ENABLE_RX_TX_NM </p>
<p>Reception and transmission of network </p>
<p>management messages is enabled. </p>
<p>DCM_ENABLE_RX_DISABLE_TX_NM </p>
<p>Reception of network management messages </p>
<p>is enabled but their transmission is disabled. </p>
<p>DCM_DISABLE_RX_ENABLE_TX_NM </p>
<p>Reception of network management messages </p>
<p>is disabled but their transmission is enabled. </p>
<p>DCM_DISABLE_RX_TX_NM </p>
<p>Reception and transmission of network </p>
<p>management messages is disabled. </p>
<p>DCM_ENABLE_RX_TX_NORM_NM </p>
<p>Reception and transmission of application and </p>
<p>network management messages is enabled. </p>
<p>DCM_ENABLE_RX_DISABLE_TX_NORM_NM </p>
<p>Reception of application and network </p>
<p>management messages is enabled but their </p>
<p>transmission is disabled. </p>
<p>DCM_DISABLE_RX_ENABLE_TX_NORM_NM </p>
<p>Reception of application and network </p>
<p>management messages is disabled but their </p>
<p>transmission is enabled. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>172 </p>
<p>based on template version 5.0.0 </p>
<p><b>Mode </b></p>
<p><b>Description </b></p>
<p>DCM_DISABLE_RX_TX_NORM_NM </p>
<p>Reception and transmission of application and </p>
<p>network management messages is disabled. </p>
<p>Table 6-94  </p>
<p>DcmCommunicationControl_&lt;ComM_CHANNEL_SNV&gt; modes </p>
<p><b>6.6.2.3 </b></p>
<p><b>DcmEcuReset </b></p>
<p><b>Callout </b></p>
<p><b>Description </b></p>
<p>Rte_Switch_Dcm_DcmEcuReset_DcmEcuReset </p>
<p>Called each time a power down state change </p>
<p>occurs. This call is a notification but has effect </p>
<p>on the DCM diagnostic service <i>EcuReset ($11) </i></p>
<p><i>EcuReset ($11) </i>or <i>DiagnosticSessionControl </i></p>
<p><i>($10) </i>processing. </p>
<p>Invoked by <i>EcuReset ($11) </i>or </p>
<p><i>DiagnosticSessionControl ($10) </i>for bootloader </p>
<p>related sessions. </p>
<p>Rte_SwitchAck_Dcm_DcmEcuReset_DcmEcuReset </p>
<p>Called after the Switch API is called to get the </p>
<p>mode transition acknowledged prior continuing </p>
<p>with the EXECUTE mode switch. </p>
<p>Invoked by <i>EcuReset ($11) </i>or </p>
<p><i>DiagnosticSessionControl ($10) </i>for bootloader </p>
<p>related sessions </p>
<p>Table 6-95  </p>
<p>DcmEcuReset callouts </p>
<p><b>Mode </b></p>
<p><b>Description </b></p>
<p>NONE </p>
<p>No reset (initial state) </p>
<p>HARD </p>
<p>Hard reset target request (service 0x11 0x01) </p>
<p>KEYONOFF </p>
<p>KeyOnOff reset target request (service 0x11 </p>
<p>0x02) </p>
<p>SOFT </p>
<p>Soft reset target request (service 0x11 0x03) </p>
<p>JUMPTOBOOTLOADER </p>
<p>Jump to bootloader reset target request </p>
<p>(service 0x10 0x02 or any session with jump </p>
<p>boot support) </p>
<p>JUMPTOSYSSUPPLIERBOOTLOADER </p>
<p>Jump to system supplier bootloader reset </p>
<p>target request (service 0x10 0x02 or any </p>
<p>session with jump boot support) </p>
<p>EXECUTE </p>
<p>Commits an already made reset target </p>
<p>request. </p>
<p>Table 6-96  </p>
<p>DcmEcuReset modes </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>173 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.6.2.4 </b></p>
<p><b>DcmModeRapidPowerShutDown </b></p>
<p><b>Callout </b></p>
<p><b>Description </b></p>
<p>Rte_Switch_DcmModeRapidPowerShutDown_Dcm</p>
<p>ModeRapidPowerShutDown </p>
<p>Called each time a power down state change </p>
<p>occurs. This call is a notification but has effect </p>
<p>on the DCM diagnostic service <i>EcuReset ($11) </i></p>
<p>processing. </p>
<p>Invoked by <i>EcuReset ($11) </i></p>
<p>Rte_SwitchAck_DcmModeRapidPowerShutDown_D</p>
<p>cmModeRapidPowerShutDown </p>
<p>Called after the Switch API is called to get the </p>
<p>mode transition acknowledged prior continuing </p>
<p>with the EXECUTE mode switch. </p>
<p>Invoked by <i>EcuReset ($11) </i></p>
<p>Table 6-97  </p>
<p>DcmModeRapidPowerShutDown callouts </p>
<p><b>Mode </b></p>
<p><b>Description </b></p>
<p>ENABLE_RAPIDPOWERSHUTDOWN </p>
<p>Rapid shutdown is enabled (initial state) or </p>
<p>Rapid shutdown is disabled (Service 0x11 </p>
<p>0x04) </p>
<p>DISABLE_RAPIDPOWERSHUTDOWN </p>
<p>Rapid shutdown is disabled (Service 0x11 </p>
<p>0x05) </p>
<p>Table 6-98  </p>
<p>DcmModeRapidPowerShutDown modes </p>
<p> </p>
<p><b>6.6.2.5 </b></p>
<p><b>DcmControlDTCSetting </b></p>
<p><b>Callout </b></p>
<p><b>Description </b></p>
<p>Rte_Switch_Dcm_DcmControlDtcSetting_DcmCon</p>
<p>trolDtcSetting </p>
<p>Called each time a DTC setting state change </p>
<p>occurs. This call is only a notification and has no </p>
<p>effect on any DCM diagnostic service processing. </p>
<p>Invoked by <i>ControlDTCSetting ($85), </i></p>
<p><i>DiagnosticSessionControl ($10) </i>or S3 timeout. </p>
<p>Table 6-99  </p>
<p>DcmControlDTCSetting callouts </p>
<p><b>Mode </b></p>
<p><b>Description </b></p>
<p>ENABLEDTCSETTING </p>
<p>DTC setting is enabled (initial state service </p>
<p>0x85 0x01 or <i>DiagnosticSessionControl ($10) </i></p>
<p>or S3 timeout) </p>
<p>DISABLEDTCSETTING </p>
<p>DTC setting is disabled (service 0x85 0x02) </p>
<p>Table 6-100  DcmControlDTCSetting modes </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>174 </p>
<p>based on template version 5.0.0 </p>
<p><b>6.6.2.6 </b></p>
<p><b>DcmSecurityAccess </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>This mode declaration group is vendor specific one and only available under certain </p>
<p>circumstances. Please refer to chapter <i>9.16 How to Know When the Security Access </i></p>
<p><i>Level Changes </i>for more details. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Callout </b></p>
<p><b>Description </b></p>
<p>Rte_Switch_Dcm_DcmSecurityAccess_DcmSecuri</p>
<p>tyAccess </p>
<p>Called each time a security access level change </p>
<p>occurs. This call is only a notification and has no </p>
<p>effect on any DCM diagnostic service processing. </p>
<p>Invoked by <i>SecurityAccess ($27) </i>or </p>
<p><i>DiagnosticSessionControl ($10) </i>or S3 timeout. </p>
<p>Table 6-101  DcmSecurityAccess callouts </p>
<p><b>Mode </b></p>
<p><b>Description </b></p>
<p>LockedLevel </p>
<p>Represents the UDS locked level (initial </p>
<p>state). </p>
<p>&lt;/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/ </p>
<p>DcmDspSecurityRow &gt; container‘s short-name </p>
<p>Any user defined security access level. </p>
<p>Table 6-102  DcmSecurityAccess modes </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>175 </p>
<p>based on template version 5.0.0 </p>
<p><b>7 </b></p>
<p><b>Configuration </b></p>
<p><b>7.1 </b></p>
<p><b>Configuration Variants </b></p>
<p>The DCM supports the configuration variants </p>
<p><b></b></p>
<p><b> </b></p>
<p>VARIANT-PRE-COMPILE </p>
<p><b></b></p>
<p><b> </b></p>
<p>VARIANT-POST-BUILD-SELECTABLE </p>
<p><b></b></p>
<p><b> </b></p>
<p>VARIANT-POST-BUILD-LOADABLE </p>
<p><b></b></p>
<p><b> </b></p>
<p>VARIANT-POST-BUILD-LOADABLE-SELECTABLE </p>
<p>The configuration classes of the DCM parameters depend on the supported configuration </p>
<p>variants. For their definitions please see the <i>Dcm_bswmd.arxml </i>file. </p>
<p><b>7.2 </b></p>
<p><b>Configurable Attributes </b></p>
<p>The  description  of  each  configurable  option  is  described  within  its  online  help  in  the </p>
<p>Configurator 5 tool. </p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>176 </p>
<p>based on template version 5.0.0 </p>
<p><b>8 </b></p>
<p><b>AUTOSAR Standard Compliance </b></p>
<p><b>8.1 </b></p>
<p><b>Deviations </b></p>
<p><b>Deviation </b></p>
<p><b>Statement </b></p>
<p><i>CallbackDCMRequestServices_&lt;SWC&gt; </i></p>
<p>Operation StopProtocol not supported since </p>
<p>not fully specified in AR 4.0.3 SWS DCM what </p>
<p>a protocol stop really does. Instead a single </p>
<p>protocol switch point is realized by </p>
<p><i>StartProtocol()</i>.  </p>
<p>Table 8-1  </p>
<p>Deviations to AUTOSAR </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>177 </p>
<p>based on template version 5.0.0 </p>
<p><b>8.2 </b></p>
<p><b>Additions/ Extensions </b></p>
<p><b>Additions/Extensions </b></p>
<p><b>Statement </b></p>
<p>DCM CPU peak load reduction support. </p>
<p>See <i>9.2 </i></p>
<p>RAM and run time optimization parameters for </p>
<p>multi-client support </p>
<p>See <i>9.4 </i></p>
<p>Optimized DCM DEM iterator </p>
<p>DCM internal design. </p>
<p>Calibrateable configuration parameters </p>
<p>See <i>9.11 </i></p>
<p>Used definition for no active protocol (DCM SWS </p>
<p>AR 4.1.1): DCM_NO_ACTIVE_PROTOCOL </p>
<p>Required since before the very first diagnostic </p>
<p>request is received, there is no active protocol </p>
<p>assigned in DCM. But at the same time the </p>
<p><i>Dcm_GetActiveProtocol() </i>shall return a valid </p>
<p>value. </p>
<p>Support for DEM AR 4.1.2 API </p>
<p>See <i>9.13 </i></p>
<p>Combined OBD and UDS protocols over a single </p>
<p>client connection </p>
<p>See <i>9.14 </i></p>
<p>Support for sub-functions 0x17, 0x18 and 0x19 </p>
<p>of service Id 0x19. </p>
<p>See <i>ReadDiagnosticInformation ($19) </i></p>
<p>Notification on security access level state </p>
<p>change </p>
<p>See <i>9.16 </i></p>
<p>Integration within an AR 3.x environment  </p>
<p>DCM will be delivered in a preconfigured state </p>
<p>for interaction with BSWs implemented on the </p>
<p>basis of the corresponding AR3 SWS. </p>
<p>Suppression on functional addressed requests </p>
<p>See <i>9.21 </i></p>
<p>Support of paged-buffer data access on DID </p>
<p>signals </p>
<p><i>See 9.24 </i></p>
<p>Configurable Security-Access level specific fixed </p>
<p>bytes </p>
<p><i>See 9.25 </i></p>
<p>Extensible keep-alive time period </p>
<p><i>See 9.26 </i></p>
<p>DCM state recovery on reset /power on </p>
<p><i>See 9.27 </i></p>
<p>Alternative solution for diagnostic service variant </p>
<p>handling </p>
<p><i>See 9.29 </i></p>
<p>Support for externally handled CEMR with more </p>
<p>than four byte control mask. </p>
<p>According to see <i>[1]</i>, a CEMR can be only up </p>
<p>to four bytes in size. MICROSAR DCM </p>
<p>extends the SWS by allowing also any size of </p>
<p>CEMR. Refer to </p>
<p><i>InputOutputControlByIdentifier ($2F)</i> for </p>
<p>details. </p>
<p>Table 8-2  </p>
<p>Additions/ Extensions to AUTOSAR </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>178 </p>
<p>based on template version 5.0.0 </p>
<p><b>8.3 </b></p>
<p><b>Limitations </b></p>
<p><b>Limitation </b></p>
<p><b>Statement </b></p>
<p>OEM specific RoE support. </p>
<p>Due to insufficient specification in the DCM </p>
<p>SWS, the RoE support can only be </p>
<p>implemented for specific OEM requirements. </p>
<p>Support of up to 32 protocols </p>
<p>Required due to optimized implementation of </p>
<p>service to protocol mapping. </p>
<p>Support of up to 32 concurrent client </p>
<p>connections </p>
<p>Required due to optimized implementation of </p>
<p>concurrent request processing. </p>
<p>Sharing of signals between DIDs not supported </p>
<p>Required due to the inability to differentiate </p>
<p>between the callers of a signal (e.g. service </p>
<p>0x22 and 0x2A). </p>
<p>Table 8-3  </p>
<p>Limitations to AUTOSAR </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>179 </p>
<p>based on template version 5.0.0 </p>
<p><b>9 </b></p>
<p><b>Using the DCM </b></p>
<p>This chapter shall give some examples and hints, how to handle common use cases of the </p>
<p>DCM. </p>
<p><b>9.1 </b></p>
<p><b>How to Reduce RAM Usage </b></p>
<p>All diagnostic services in DCM have a constant length so the DCM integrator person can </p>
<p>perform a static buffer pre-calculation for finding the optimal buffer size.  </p>
<p>Starting with DCM 7.01.00, Configurator 5 provides a means to estimate each DCM buffer </p>
<p>size,  depending  on  the  configured  diagnostic  services,  accessible  via  this  buffer.  The </p>
<p>buffer-to-service relation is determined by the DCM protocol configuration entity that refers </p>
<p>to a certain diagnostic service table. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>Depending on the DCM configuration the calculated buffer sizes are either <b>precise </b>or </p>
<p>just <b>estimated </b>values. The calculation algorithm has the goal to assure the minimum </p>
<p>value required so that each service, related to the validated buffer, can be requested </p>
<p>and processed in its simplest form (e.g. on multiple DID reading, that at least one DID </p>
<p>can be read). The worst case could also be calculated, but it will require too much RAM </p>
<p>to be reserved unnecessarily (e.g. it is not considered to be possible to read N-times </p>
<p>the largest DID with a single diagnostic request).  </p>
<p>There are two calculation steps:  </p>
<p><b>&gt; </b></p>
<p>The first one verifies that the validated buffer must be set at least to the proposed </p>
<p>value (Error Message). Otherwise runtime errors may occur. </p>
<p><b>&gt; </b></p>
<p>The second one verifies whether with the currently set buffer size the DCM will be </p>
<p>able to execute the diagnostic service or will ignore the request resp. send negative </p>
<p>responses due to a lack of enough buffer space (Warning Message). </p>
<p> </p>
<p>The buffer size calculation considers only diagnostic (sub-)services, that are internally </p>
<p>handled by DCM. Once a diagnostic (sub-)service is redirected to an application </p>
<p>handler, it will be excluded from the buffer size calculation. This is always the case </p>
<p>regardless of the fact if the given diagnostic service was/is completely configured in the </p>
<p>ECUC file (e.g. all related DIDs are available). </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>In <i>Table 9-1  </i></p>
<p><i>Diagnostic  services  with  non-trivial  DCM  Buffer  size  estimation  calculation </i></p>
<p><i>method </i>you can find information about the exactness of the buffer size calculation for each </p>
<p>diagnostic  services  DCM  can  handle.    From  this  table  there  are  excluded  all  diagnostic </p>
<p>services  that  have  a  trivial  calculation  formula  (e.g. <i> DiagnosticSessionControl  ($10)</i>)  or </p>
<p>could  only  be  implemented  by  the  application  (i.e.  non-UDS  user-defined  diagnostic </p>
<p>services or UDS services for which the DCM does not have any configuration details in </p>
<p>order to make a meaningfull estimation).  </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>180 </p>
<p>based on template version 5.0.0 </p>
<p><b>Diagnostic Service </b></p>
<p><b>Buffer Size Calculation Type </b></p>
<p> </p>
<p>Request </p>
<p>Response </p>
<p><i>RequestCurrentPowertrainDiagnosticData ($01) </i></p>
<p>Precise </p>
<p>Precise</p>
<p>1</p>
<p> </p>
<p><i>RequestPowertrainFreezeFrameData ($02) </i></p>
<p>Precise </p>
<p>Precise</p>
<p>2</p>
<p> </p>
<p><i>RequestEmissionRelatedDTC ($03)  </i></p>
<p>Precise </p>
<p>Not estimated</p>
<p>3</p>
<p> </p>
<p><i>RequestOnBoardMonitorTestResults ($06) </i></p>
<p>Precise </p>
<p>Precise</p>
<p>4</p>
<p> </p>
<p><i>RequestEmissionRelatedDTCsDetectedDuringCurrentOrLa</i></p>
<p><i>stDrivingCycle ($07) </i></p>
<p>Precise </p>
<p>Not estimated</p>
<p>3</p>
<p> </p>
<p><i>RequestControlOfOnBoardSystemTestOrComponent ($08) </i></p>
<p>Precise </p>
<p>Precise </p>
<p><i>RequestVehicleInformation ($09) </i></p>
<p>Precise </p>
<p>Precise </p>
<p><i>RequestEmissionRelatedDTCsWithPermanentStatus ($0A) </i></p>
<p>Precise </p>
<p>Not estimated</p>
<p>3</p>
<p> </p>
<p><i>ReadDiagnosticInformation ($19) </i></p>
<p>Precise </p>
<p>Precise</p>
<p>5</p>
<p> </p>
<p>Not estimated</p>
<p>3</p>
<p> </p>
<p><i>ReadDataByIdentifier ($22) </i></p>
<p>Precise</p>
<p>6</p>
<p> </p>
<p>Minimum estimation</p>
<p>7</p>
<p>  </p>
<p><i>ReadMemoryByAddress ($23) </i></p>
<p>Precise</p>
<p>8</p>
<p> </p>
<p>Minimum estimation</p>
<p>9</p>
<p> </p>
<p><i>ReadScalingDataByIdentifier ($24) </i></p>
<p>Precise </p>
<p>Precise </p>
<p><i>SecurityAccess ($27) </i></p>
<p>Precise </p>
<p>Precise </p>
<p><i>ReadDataByPeriodicIdentifier ($2A) </i></p>
<p>Precise</p>
<p>6</p>
<p> </p>
<p>Precise</p>
<p>10</p>
<p> </p>
<p><i>DynamicallyDefineDataIdentifier ($2C) </i></p>
<p>Minimum estimation</p>
<p>11</p>
<p> </p>
<p>Precise </p>
<p><i>WriteDataByIdentifier ($2E) </i></p>
<p>Precise </p>
<p>Precise </p>
<p><i>InputOutputControlByIdentifier ($2F) </i></p>
<p>Precise </p>
<p>Precise </p>
<p><i>RoutineControl ($31) </i></p>
<p>Precise </p>
<p>Precise </p>
<p><i>WriteMemoryByAddress ($3D) </i></p>
<p>Minimum estimation</p>
<p>9</p>
<p> </p>
<p>Precise</p>
<p>8</p>
<p> </p>
<p><i>ControlDTCSetting ($85) </i></p>
<p>Precise </p>
<p>Precise </p>
<p>Table 9-1  </p>
<p>Diagnostic services with non-trivial DCM Buffer size estimation calculation method </p>
<p>                                            </p>
<p>1</p>
<p> Based on worst case: “response for six times the largest PID”.  </p>
<p>2</p>
<p> Only if all PIDs accessible via this service have configured PID data size (usually not set, since the DEM </p>
<p>implements the PID data retrieval). </p>
<p>3</p>
<p> Usually the paged-buffer response will be used, so the final response length is not that much relevant. </p>
<p>4</p>
<p> Only if DCM knows the OBDMID configuration (refer to <i>9.30 How to Switch Between OBD DTR Support by </i></p>
<p><i>DCM and DEM</i>). Otherwise only the worst case for “SupportedID” OBD MID will be considered. </p>
<p>5</p>
<p> For all sub-functions with constant length (i.e. 0x01, 0x07, 0x09, 0x0B-0x0E, 0x11 and 0x12). </p>
<p>6</p>
<p> It is considered that multiple-DIDs can be requested as per ECUC configuration. Refer to the service </p>
<p>configuration chapter for details on the maximum number of DID that can be requested simultaneously in a </p>
<p>single message. </p>
<p>7</p>
<p> It is guaranteed that the largest configured not dynamically definable DID with no paged-buffer response </p>
<p>can be read at least in a single DID request. Note: The (WWH-)OBD DIDs are not considered as in „</p>
<p>1</p>
<p>“. </p>
<p>8</p>
<p> The configured ALFIDs are taken into account for this estimation. If no specifc ALFID(s) specified, the worst </p>
<p>case (0x44 or 0x45 in case of MID usage) will be considered. </p>
<p>9</p>
<p> It is guaranteed that at least one memory byte can be transfered. </p>
<p>10</p>
<p> UUDT buffer size is not considered here. Only the USDT request/response messages. </p>
<p>11</p>
<p> It is guaranteed that at least one source item (DID or memory block) can be requested for the </p>
<p>corresponding definition function. Subfunction „clear“ is of course precisly calculated. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>181 </p>
<p>based on template version 5.0.0 </p>
<p>In some special cases like: </p>
<p><b>&gt; </b></p>
<p>Reading fault memory data: </p>
<p><b>&gt; </b></p>
<p><i>ReadDiagnosticInformation ($19) </i></p>
<p><b>&gt; </b></p>
<p><i>RequestEmissionRelatedDTC ($03) </i></p>
<p><b>&gt; </b></p>
<p><i>RequestEmissionRelatedDTCsDetectedDuringCurrentOrLastDrivingCycle ($07) </i></p>
<p><b>&gt; </b></p>
<p><i>RequestEmissionRelatedDTCsWithPermanentStatus ($0A) </i></p>
<p><b>&gt; </b></p>
<p>Reading multiple DIDs in a single request: </p>
<p><b>&gt; </b></p>
<p><i>ReadDataByIdentifier ($22) </i></p>
<p>the required buffer size cannot be estimated or a pessimistic prediction will be applied in </p>
<p>order to guarantee the ECU will always respond. </p>
<p>For  the  first  case  (<i>Reading  fault  memory  data</i>),  the  DCM  offers  the  option  to  enable </p>
<p>response  paged  buffer  handling,  that  may  reduce  the  overall  required  buffer  by  DCM. </p>
<p>Enabling this option will lead to an increased code ROM usage in DCM due to the added </p>
<p>functionality.  </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>It is recommended always to keep the paged buffer option in DCM enabled to avoid </p>
<p>situations where the tester would not be able to get a positive response when reading </p>
<p>the fault memory content. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>To enable the paged buffer handling in DCM for “<i>Reading fault memory data</i>”, just set the </p>
<p>configuration parameter to TRUE: </p>
<p>/Dcm/DcmConfigSet/DcmPageBufferCfg/DcmPagedBufferEnabled </p>
<p> </p>
<p>The situation is different for the “<i>Reading multiple DIDs in a single request</i>” case with </p>
<p>standard AUTOSAR approach. In case the tester requests reading more data as the </p>
<p>response buffer can handle, the DCM will respond with NRC 0x14 (ResponseTooLong) to </p>
<p>avoid buffer overflow. The tester shall then use single-DID requests to get the data.  </p>
<p> </p>
<p>Using  the  MSR  DCM,  you  have  still  an  option  that  will  allow  you  to  save  RAM  also  for </p>
<p>multiple- or single-DID reading when the DIDs are too large even for a single-DID request. </p>
<p>Please refer to <i>9.24 How to Save RAM using Paged-Buffer for Large DIDs </i>for details on </p>
<p>this usage. </p>
<p><b>9.2 </b></p>
<p><b>How to Reduce DCM Main-Function Run Time Usage </b></p>
<p>The DCM is designed and optimized for best possible response performance. This means </p>
<p>the DCM main function will perform as much as possible operations per single activation in </p>
<p>order to keep the P2 timings requirements. Additional the DCM internal code is optimized </p>
<p>for short run time in order to lower the CPU burden during the many operations performed </p>
<p>within a single DCM main function activation. But in cases where other BSWs are intensely </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>182 </p>
<p>based on template version 5.0.0 </p>
<p>involved  in  the  service  processing,  such  as  the  DEM  during  reading  the  fault  memory </p>
<p>information, the DCM can no more guarantee for total short run time execution. Therefore, </p>
<p>the DCM offers a configuration option that may reduce the CPU peak load by limiting the </p>
<p>number of iterations of an external BSW API.  </p>
<p>After introducing the signal level access on DID data, the CPU peak load can be </p>
<p>significantly affected also by services other than <i>ReadDiagnosticInformation ($19)</i>. Such </p>
<p>services are: </p>
<p><b>&gt; </b></p>
<p><i>ReadDataByIdentifier ($22) </i></p>
<p><b>&gt; </b></p>
<p><i>ReadDataByPeriodicIdentifier ($2A) </i></p>
<p><b>&gt; </b></p>
<p><i>DynamicallyDefineDataIdentifier ($2C) </i></p>
<p>Any of these allows multiple DIDs in a single request, that, depending on the total number </p>
<p>of DIDs in a request and the corresponding number of signals in a single DID, can lead to </p>
<p>really long execution times of the <i>Dcm_MainFunction()</i>.  </p>
<p> </p>
<p>To enable the run time limitation in DCM set up the configuration parameter: </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmMaxNumberIterationsPerTask </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>There is no recommended default value for this parameter. It shall be measured during </p>
<p>the integration by testing the worst case of the above mentioned diagnostic services.  </p>
<p> </p>
<p>Please note that a too low value of this parameter will lower the CPU usage to a </p>
<p>minimum, but will lead to long processing times of a diagnostic request. RCR-RP </p>
<p>responses will be always sent, since the P2 times expire after a few </p>
<p><i>Dcm_MainFunction() </i>iterations<i>. </i>A compromise between performance and CPU usage </p>
<p>can be found using the <i>Split Task Functions </i>concept. Using this approach, the worker </p>
<p>task will be called more often than the timer task. This will help to achieve less CPU </p>
<p>load per task activation and at the same time more work done per unit of a real time. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>9.3 </b></p>
<p><b>How to Force DCM to not Respond on Requests with Response SIDs </b></p>
<p>Generally the DCM will replay to any physical addressed not supported service identifier </p>
<p>with a negative response: NRC 0x11 (ServiceNotSupported). This includes also all service </p>
<p>identifier from the diagnostic response Id range [0x40, 0x7F]U[0xC0, 0xFF]. In some cases </p>
<p>it is not allowed to reply to any request service Id from this range.  </p>
<p>To  specify  whether  DCM  shall  reply  to  any  diagnostic  response  Id  or  not,  set  up  the </p>
<p>configuration parameter: /Dcm/DcmConfigSet/DcmGeneral/DcmRespondAllRequest. </p>
<p>  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>183 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.4 </b></p>
<p><b>How to Handle Multiple Diagnostic Clients Simultaneously </b></p>
<p>The DCM is a single instance component. This means that once a diagnostic client has </p>
<p>sent a request, the server (DCM) is busy until the processing of that request is finished. </p>
<p>While busy, the DCM cannot handle in parallel other clients’ requests. In such a situation </p>
<p>the second client will not get a response. </p>
<p>If it is required to send always a response to a parallel client request, the DCM offers an </p>
<p>option to send NRC 0x21 (BusyRepeatRequest) to any additional request to the main one. </p>
<p>To  specify  the  DCM  behavior  on  a  multiple  client  environment,  set  up  the  configuration </p>
<p>parameter: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslDiagResp/DcmDslDiagRespOnSecondDeclinedReq</p>
<p>uest </p>
<p>Since there will be reserved RAM for each client the DCM shall be able to communicate </p>
<p>with, the DCM RAM usage may increase drastically for large number of configured DCM </p>
<p>connections..  Also </p>
<p>the  DCM  main  function  run  time,  needed  to  process  all  parallel </p>
<p>connections, may increase significantly. In the practice, even if the DCM is configured to </p>
<p>communicate with many clients, it is not necessary that all of them will send request to the </p>
<p>same server at the same time. To optimize the RAM and run time resource usage of DCM, </p>
<p>there </p>
<p>is </p>
<p>configuration </p>
<p>option  provided </p>
<p>that </p>
<p>limits </p>
<p>the </p>
<p>amount </p>
<p>of </p>
<p>in </p>
<p>parallel </p>
<p>handled </p>
<p>diagnostic </p>
<p>clients: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslDiagResp/DcmDslDiagRespMaxNumOfDeclinedReq</p>
<p>uests </p>
<p> </p>
<p><b>9.5 </b></p>
<p><b>How to Restrict a Diagnostic Service Execution by a Condition </b></p>
<p>On  a  reception  of  a  validly  formatted  diagnostic  request  DCM  evaluates  also  with  it </p>
<p>associated diagnostic session and security access restrictions, defined in Configurator 5. </p>
<p>In case of not matching required states, the DCM automatically rejects the request with the </p>
<p>appropriate NRC. </p>
<p>Additionally,  DCM  can  be  configured  to  consider  any  ECU  specific  states,  related  to  a </p>
<p>concrete  diagnostic execution. These  states are  the  so  called modes  that  can  either be </p>
<p>managed by any BSW, including DCM or a SWC. You can simply define a condition made </p>
<p>of  such  a  mode  and  create  a  rule  that  will  be  later  used  by  a  diagnostic  service,  sub-</p>
<p>service, DID, RID, etc. as a processing restriction. </p>
<p> </p>
<p>An example of a use case using mode rules is service <i>DiagnosticSessionControl ($10)</i>. If </p>
<p>you  need  to  restrict  session  activation  by  an  ECU  condition,  you  have  to  model  this </p>
<p>condition in your SWC and make a reference between the diagnostic session sub-service </p>
<p>you want to restrict and a mode rule that uses this mode in a logical expression. </p>
<p> </p>
<p>To  configure  any  processing  conditions  and  rule,  refer  to  the  configuration  container  in </p>
<p>Configurator 5: /Dcm/DcmConfigSet/DcmProcessingConditions </p>
<p>Later, you can reference these rules from the corresponding diagnostic processing object </p>
<p>as an additional restriction to the diagnostic session and security access conditions. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>184 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.6 </b></p>
<p><b>How to Get Notified on a Diagnostic Service Execution Start and End </b></p>
<p>Usually the DCM validates the requested services without involving the application, only </p>
<p>using the configuration parameters. In some cases the DCM application may need to know </p>
<p>about  a  diagnostic  services  execution  start  and  when  it  is  finished.  Additionally  the </p>
<p>application  may  need  to  restrict  globally  the  processing  of  all  or  just  some  diagnostic </p>
<p>services.  </p>
<p>For all the above mentioned use cases, the DCM offers two kinds of application notification </p>
<p>groups: </p>
<p><b>&gt; </b></p>
<p>Manufacturer diagnostic service notification </p>
<p><b>&gt; </b></p>
<p>System supplier diagnostic service notification </p>
<p>Each of them supports a list of one or more request indication and response confirmation </p>
<p>notification function pairs that will be called on request reception resp. service processing </p>
<p>finishing time. </p>
<p>The  differences  between  these  two  kinds  of  notifications  are  described  in  within  the </p>
<p>corresponding API documentation:  </p>
<p><b></b></p>
<p><b> </b></p>
<p><i>ServiceRequestManufacturerNotification_&lt;SWC&gt; </i></p>
<p><b></b></p>
<p><b> </b></p>
<p><i>ServiceRequestSupplierNotification_&lt;SWC&gt; </i></p>
<p>To set up a manufacturer diagnostic service notification, add a configuration container in </p>
<p>the Configurator 5:  </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslServiceRequestManufacturerNotification </p>
<p>To set up a system supplier diagnostic service notification, add a configuration container in </p>
<p>the Configurator 5:  </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslServiceRequestSupplierNotification </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>If you have already specified long lists of notifications and want just temporary to </p>
<p>disable the usage of a certain kind of notifications (e.g. disable all manufacturer </p>
<p>notifications), you don’t need to delete the lists. Just disable the usage of the </p>
<p>notification kind by setting up the corresponding DCM configuration parameter: </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmRequestManufacturerNotificationEnabled </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/ DcmRequestSupplierNotificationEnabled </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>9.7 </b></p>
<p><b>How to Limit the Diagnostic Service Processing Time </b></p>
<p>In  general  there  is  no  limitation  of  a  diagnostic  service  processing  time.  If  the  DCM </p>
<p>application needs longer time before it can return the final request result i.e. waiting for a </p>
<p>response from an external ECU or during heavy NvM usage from other components, the </p>
<p>DCM monitors the diagnostic P2 times and keeps the diagnostic client notified about the </p>
<p>final response delay. This behavior fully complies with the ISO UDS specification.  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>185 </p>
<p>based on template version 5.0.0 </p>
<p>In some cases, usually required by the car manufacturer, the DCM shall not wait endlessly </p>
<p>for  the  final  operation  result,  but  instead  it  will  have  a  configured  service  processing </p>
<p>deadline.  If  such  time  monitoring  is  required,  the  time  limit  shall be  set high  enough,  to </p>
<p>avoid abortion of a long service execution. In such a situation the DCM will decouple the </p>
<p>application, take over the service processing and finalize it with a specific NRC (usually </p>
<p>0x10 (GeneralReject)). In that way the diagnostic client will be notified about this critical </p>
<p>situation  and  it  will  be  given  the  opportunity  to  send  a  reset  command  to  the  server  to </p>
<p>reinitialize the ECU, since obviously the software is no more in a reliable state. </p>
<p>To  enable  the  application  reaction  deadline  monitoring,  set  up  the  DCM  configuration </p>
<p>parameter: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslDiagResp/DcmDslDiagRespMaxNumRespPend </p>
<p> </p>
<p><b>9.8 </b></p>
<p><b>How to Jump into the FBL from Service DiagnosticSessionControl ($10)  </b></p>
<p>The DCM provides means for transitions into the FBL from the ECU’s application software. </p>
<p>You  can  specify  in  the  DCM  configuration  on  which  diagnostic  session  request  this </p>
<p>transition shall occur by the following parameter type: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSession/DcmDspSessionRow/DcmDspSessionFor</p>
<p>Boot </p>
<p><b>9.9 </b></p>
<p><b>The HIS Compliant Jump into FBL </b></p>
<p>By default if a diagnostic request for SID $10 with a session Id configured for boot loader </p>
<p>activation is received by the ECU, the DCM stores all necessary information for the FBL </p>
<p>(via </p>
<p>callout </p>
<p><i>Dcm_SetProgConditions()</i>)and </p>
<p>resets </p>
<p>the </p>
<p>ECU </p>
<p>without </p>
<p>sending </p>
<p>the </p>
<p>final </p>
<p>positive response to the request. This will be done by the FBL after the reset. Additionally, </p>
<p>to avoid P2 time violation during the transition (reset) phase, the DCM can be configured </p>
<p>to </p>
<p>send </p>
<p>a </p>
<p>RCR-RP </p>
<p>response </p>
<p>prior </p>
<p>resetting </p>
<p>the </p>
<p>ECU. </p>
<p>For </p>
<p>that </p>
<p>purpose </p>
<p>the </p>
<p>DCM </p>
<p>configuration parameter shall be set accordingly: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmSendRespPendO</p>
<p>nTransToBoot </p>
<p> </p>
<p><b>9.9.1 </b></p>
<p><b>The HIS Alternative Jump into FBL </b></p>
<p>In some cases and depending on the FBL used in the ECU it may not be possible to send </p>
<p>a final response from the FBL. In that case the DCM within the ECUs application software </p>
<p>shall first send the final positive response to the diagnostic client and then jump into the </p>
<p>FBL. To achieve this behavior, you have to set the following DCM configuration parameter </p>
<p>to TRUE:  </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmResetToFblAfterSessionFinalResposeEnabled </p>
<p> </p>
<p><b>9.10 </b></p>
<p><b>How to Put DCM in a Non-Default Session at ECU Power-On </b></p>
<p>The  DCM  supports  also  the  HIS  compliant  transition  from  FBL  into  the  application </p>
<p>software, where the positive response is to be sent after the transition is accomplished. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>186 </p>
<p>based on template version 5.0.0 </p>
<p>These usually are responses for diagnostic services that cause a reset in the FBL during </p>
<p>the reprogramming process: $10 $01 and $11 $01.  </p>
<p>This  mechanism  can  be  used  to  instruct  DCM  to  enter  in  a  non-default  session,  using </p>
<p>appropriate </p>
<p>combination </p>
<p>of </p>
<p>the </p>
<p>parameter </p>
<p>values </p>
<p>returned </p>
<p>by </p>
<p>the </p>
<p><i>Dcm_GetProgConditions()</i>.  The  callout  shall  return  the  value  DCM_WARM_START  to </p>
<p>notify DCM that the out-parameters are valid and shall be evaluated. The correct values </p>
<p>during this operation are defined below: </p>
<p> </p>
<p><b>Member of the Dcm_ProgConditionsType </b></p>
<p><b>parameter </b></p>
<p><b>Value </b></p>
<p>TesterSourceAddr </p>
<p>Contains the Id of a tester that communications </p>
<p>with the ECU over the communication bus shall be </p>
<p>kept awaken while the non-default session is </p>
<p>active. The tester Ids are assigned to each DCM </p>
<p>connection in Configurator 5: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/Dc</p>
<p>mDslProtocolRow/DcmDslConnection/DcmDslMai</p>
<p>nConnection/DcmDslProtocolRxTesterSourceAddr </p>
<p>ProtocolId </p>
<p>Not evaluated. </p>
<p>Sid </p>
<p>$10 </p>
<p>SubFuncId </p>
<p>The Id of the session to be activated [$02 -$7E]. </p>
<p>Must be a supported session within the DCM </p>
<p>configuration (refer to </p>
<p><i>5.10DiagnosticSessionControl ($10) </i>for details).  </p>
<p>ReprogrammingRequest </p>
<p>FALSE (Not evaluated.) </p>
<p>ApplUpdated </p>
<p>FALSE </p>
<p>ResponseRequired </p>
<p>FALSE </p>
<p>Table 9-2  </p>
<p>Initialization of the Dcm_ProgConditionsType for non-default session activation at ECU power-on </p>
<p> </p>
<p><b>9.11 </b></p>
<p><b>How to Support Calibrateable Configuration Parameters </b></p>
<p>Vector  DCM  provides  a  limited  functionality  for  configuration  calibration.  The  following </p>
<p>chapters </p>
<p>describe </p>
<p>which </p>
<p>DCM </p>
<p>objects </p>
<p>are </p>
<p>possible </p>
<p>to </p>
<p>be </p>
<p>calibrated </p>
<p>after </p>
<p>ECU </p>
<p>programming. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>187 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.11.1 </b></p>
<p><b>OBD Calibration </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>This feature is first supported in DCM 1.04.00. </p>
<p> </p>
<p>In order to activate it, please use the following DCM ECUC parameter: </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmCalibrationOfObdIdsEnabled </p>
<p><b> </b></p>
<p><b> </b></p>
<p>DCM  implementation  is  prepared  for  post-programming  calibration  regarding  the  OBD </p>
<p>supported services and their sub-service parameters. With these calibration abilities you </p>
<p>can  only  disable  or  re-enable  an  already  configured  and  supported  OBD  service  and/or </p>
<p>any of its sub-service parameters. The following calibration levels are supported in DCM: </p>
<p><b>&gt; </b></p>
<p>Deactivate/Re-activate an OBD diagnostic service or complete disabling of OBD </p>
<p>support;  </p>
<p><b>&gt; </b></p>
<p>Deactivate/Re-activate specific OBD related parameter identifiers </p>
<p><b>&gt; </b></p>
<p>For <i>[6]</i>: PIDs/MIDs/TIDs/VIDs </p>
<p><b>&gt; </b></p>
<p>For OBD in UDS resp. <i>[7] </i>and <i>[8]</i>:  </p>
<p><b>&gt; </b></p>
<p>DIDs in range 0xF400-0xF8FF </p>
<p><b>&gt; </b></p>
<p>RIDs in range 0xE000-0xE1FF </p>
<p> </p>
<p><b>9.11.1.1 </b></p>
<p><b>Calibration of Supported OBD Services </b></p>
<p>DCM supports this level of calibration only in connection with the <i>How to Get Notified on a </i></p>
<p><i>Diagnostic  Service  Execution  Start  and  End </i> feature.  It  is  recommended  to  use  the </p>
<p><i>ServiceRequestManufacturerNotification_&lt;SWC&gt; </i>notification in order to block as early as </p>
<p>possible any not supported OBD service identifiers. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>Do not block any UDS OBD services: 0x22 and 0x31. These services are shared </p>
<p>between OBD and the UDS protocol. In case OBD or/and the UDS OBD parameters </p>
<p>shall be disabled, please refer to the chapter <i>9.11.1.2 Calibration of Supported OBD </i></p>
<p><i>Parameter Identifier </i>to disable only the affected sub-service parameters.  </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>The </p>
<p>diagnostic </p>
<p>service </p>
<p>level </p>
<p>filtering </p>
<p>is </p>
<p>completely </p>
<p>handled </p>
<p>by </p>
<p>the </p>
<p>application </p>
<p>implementation. This can be achieved by a calibrateable filter object that will be evaluated </p>
<p>within </p>
<p>the </p>
<p>diagnostic </p>
<p>request </p>
<p>indication </p>
<p>function. </p>
<p>This </p>
<p>application </p>
<p>call </p>
<p>shall </p>
<p>behave </p>
<p>depending on the filter state as follows: </p>
<p><b>&gt; </b></p>
<p>Any OBD service(s) is (are) <b>disabled</b>: set the ErrorPtr function parameter to <b>NRC </b></p>
<p><b>0x11 </b>(SNS) and return the value <b>DCM_E_NOT </b>to DCM. On functional requests there </p>
<p>will be no response sent back. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>188 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>Any OBD service(s) shall be <b>re-enabled</b>: just return the value <b>E_OK </b>to DCM. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>Filtering the OBD services on SID level within the </p>
<p><i>ServiceRequestManufacturerNotification_&lt;SWC&gt; </i>will avoid the diagnostic session </p>
<p>transition into the default session, required on an OBD request. This is especially </p>
<p>useful when the OBD support shall be completely disabled, and the ECU shall behave </p>
<p>as if it is a general UDS ECU. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>9.11.1.2 </b></p>
<p><b>Calibration of Supported OBD Parameter Identifier </b></p>
<p>Due to the OBD protocol specifics, the filtering of single OBD related parameter identifier is </p>
<p>completely  handled  within  the  DCM.  The  application  shall  implement  only  the  write </p>
<p>operation </p>
<p>onto </p>
<p>the </p>
<p>calibrateable </p>
<p>DCM </p>
<p>configuration </p>
<p>objects </p>
<p>described </p>
<p>in </p>
<p><i>Table </i></p>
<p><i>9-3 </i></p>
<p><i> </i></p>
<p><i>Calibrateable OBD “availability parameter identifier” values</i>. </p>
<p>There are two types of OBD parameter identifiers: </p>
<p><b>&gt; </b></p>
<p>Availability Parameter Identifier (APID):  </p>
<p><b>&gt; </b></p>
<p>For <i>[6]</i>: 0x00, 0x20, 0x40, … 0xE0 </p>
<p><b>&gt; </b></p>
<p>For OBD in UDS resp. <i>[7] </i>and <i>[8]</i>: 0xZZ00, 0xZZ20, 0xZZ40, … 0xZZE0, where ZZ </p>
<p>stays for: </p>
<p><b>&gt; </b></p>
<p>DIDs: any value in range 0xF4-0xF8 </p>
<p><b>&gt; </b></p>
<p>RIDs: any value in range 0xE0-0xE1. </p>
<p><b>&gt; </b></p>
<p>Data Parameter Identifier (DPID): any other parameter identifiers </p>
<p>The  first  type  reports  to  the  requester  a  bit  map  of  the  corresponding  “data  parameter </p>
<p>identifiers” supported by the ECU. These bitmap values always have to be consistent with </p>
<p>the  real  ECU  “data  parameter  identifier”  availability  configuration.  To  guarantee  this </p>
<p>consistency and simplify the calibration process, DCM uses calibrateable bitmaps for each </p>
<p>“availability parameter identifier” that shall be supported.  </p>
<p> </p>
<p>The </p>
<p>following </p>
<p>table </p>
<p>shows </p>
<p>the </p>
<p>overview </p>
<p>of </p>
<p>all </p>
<p>OBD </p>
<p>diagnostic </p>
<p>service </p>
<p>dependent </p>
<p>calibrateable symbols: </p>
<p><b>Diagnostic </b></p>
<p><b>Service ID </b></p>
<p><b>Table Name </b></p>
<p><b>Availability Condition </b></p>
<p>0x01 </p>
<p>dcmCfg_Svc01SupportedIdMask[n] </p>
<p>1) </p>
<p>If SID 0x01 is to be supported. </p>
<p>0x02 </p>
<p>dcmCfg_Svc02SupportedIdMask[8] </p>
<p>2)</p>
<p> </p>
<p>If SID 0x02 is to be supported </p>
<p>0x06 </p>
<p>dcmCfg_Svc06SupportedIdMask[n] </p>
<p>1)</p>
<p> </p>
<p>If SID 0x06 is to be supported. </p>
<p>0x08 </p>
<p>dcmCfg_Svc08SupportedIdMask[n] </p>
<p>1)</p>
<p> </p>
<p>If SID 0x08 is to be supported. </p>
<p>0x09 </p>
<p>dcmCfg_Svc09SupportedIdMask[n] </p>
<p>1)</p>
<p> </p>
<p>If SID 0x09 is to be supported. </p>
<p>0x22 </p>
<p>dcmCfg_Svc22SupportedIdMask[n] </p>
<p>3)</p>
<p> </p>
<p>If SID 0x22 with any OBD DIDs is </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>189 </p>
<p>based on template version 5.0.0 </p>
<p><b>Diagnostic </b></p>
<p><b>Service ID </b></p>
<p><b>Table Name </b></p>
<p><b>Availability Condition </b></p>
<p>to be supported. </p>
<p>0x31 </p>
<p>dcmCfg_Svc31SupportedIdMask[n] </p>
<p>4)</p>
<p> </p>
<p>If SID 0x31 with any OBD RIDs is </p>
<p>to be supported. </p>
<p>Table 9-3  </p>
<p>Calibrateable OBD “availability parameter identifier” values </p>
<p> </p>
<p>1)</p>
<p> n = total number of APIDs for this service. </p>
<p>2)</p>
<p> always contains all possible APIDs. </p>
<p>3)</p>
<p> n = total number of APIDs for the whole range of OBD DIDs [0xF400-0xF8FF]. </p>
<p>4)</p>
<p> n = total number of APIDs for the whole range of OBD RIDs [0xE000-0xE1FF]. </p>
<p> </p>
<p>All the above table symbols have a 32bit value according to <i>[6] </i>that represents the bitmap </p>
<p>for the corresponding parameter identifier range, defined by the APID. The only identifier </p>
<p>not available in these bitmaps is the APID 0x00, since this one shall be always supported if </p>
<p>the corresponding OBD diagnostic service is to be supported. For example if SID 0x02 is </p>
<p>to be supported, then PID 0x00 must exist in order SID 0x02 to be able to report the </p>
<p>complete parameter identifier support list. Due to the differences between the two byte </p>
<p>UDS OBD DIDs/RIDs and their single byte OBD equivalence, the following shall be </p>
<p>considered for their calibration: </p>
<p><b>&gt; </b></p>
<p>If an OBD parameter identifier is to be <b>disabled</b>, its corresponding APID bit value in </p>
<p>the bitmap shall be reset. For the two types of parameter identifiers this means: </p>
<p><b>&gt; </b></p>
<p> For an APID: </p>
<p><b>&gt; </b></p>
<p>All bits in the corresponding service table shall be reset as follows: </p>
<p> </p>
<p>All APIDs below the one to be disabled shall reset bit 0. </p>
<p> </p>
<p>The APID to be disabled and the greater ones shall have zero mask value. </p>
<p> </p>
<p>Example: for SID 0x<b>02 </b>APID 0x40 shall be disabled: </p>
<p>dcmCfg_Svc02SupportedIdMask [4] = </p>
<p>{ </p>
<p>   XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXX0b  /* APID 0x00*/ </p>
<p>   XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXX0b  /* APID 0x20*/ </p>
<p>   0000 0000 0000 0000 0000 0000 0000 0000b  /* APID 0x40*/ </p>
<p>   0000 0000 0000 0000 0000 0000 0000 0000b  /* APID 0x60*/ </p>
<p>}; </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>190 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>Disabling APID 0x00 would mean that the corresponding OBD diagnostic service is not </p>
<p>available. Therefore actually the SID level filtering described in <i>9.11.1.1 Calibration of </i></p>
<p><i>Supported OBD Services </i>shall apply. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>&gt; </b></p>
<p>For a DPID: The corresponding APID table entry (table index = DPID / 32) bitmap </p>
<p>value shall be changed (reset bit number [DPID % 32]).  </p>
<p>Example: If PID 0x<b>51 </b>of SID 0x<b>02 </b>shall be disabled, then the value shall be: </p>
<p>dcmCfg_Svc02SupportedIdMask [4] = </p>
<p>{ </p>
<p>   XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXX1b  /* APID 0x00*/ </p>
<p>   XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXX1b  /* APID 0x20*/ </p>
<p>   XXXX XXXX XXXX XXX0 XXXX XXXX XXXX XXX1b  /* APID 0x40*/ </p>
<p>   XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXX0b  /* APID 0x60*/ </p>
<p>}; </p>
<p> </p>
<p><b>&gt; </b></p>
<p>If a UDS OBD parameter identifier is to be <b>disabled</b>, its corresponding APID bit value </p>
<p>in the bitmap shall be reset. Here are the same rules as for the single byte OBD APIDs </p>
<p>to apply, but only within a concrete OBD DID type (i.e. 0xF4<b>XX</b>, 0xF6<b>XX</b>, etc.). </p>
<p>Example: If PID 0x<b>F600 </b>for SID 0x<b>22 </b>shall be disabled, then the value shall be:  </p>
<p> </p>
<p>dcmCfg_Svc22SupportedIdMask[x] = </p>
<p>{ </p>
<p>    XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXX1b  /* APID 0xF400*/ </p>
<p>    XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXX0b  /* APID 0xF420*/ </p>
<p>    0000 0000 0000 0000 0000 0000 0000 0000b  /* APID 0xF600*/ </p>
<p>    0000 0000 0000 0000 0000 0000 0000 0000b  /* APID 0xF620*/ </p>
<p>    XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXX0b  /* APID 0xF800*/ </p>
<p>}; </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>191 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>DCM will react just as proper as the calibrated values are. This means that the </p>
<p>generator of the calibration values is responsible for the correctness of the DCM </p>
<p>configuration. Therefore the following points have to be considered during the new </p>
<p>bitmap values’ generation: </p>
<p><b>&gt; </b></p>
<p>The APID concatenation has to be taken into account - see examples above how bit </p>
<p>0 of the corresponding APID masks changes. </p>
<p><b>&gt; </b></p>
<p>It is not possible to enable any APID or DPID that didn’t exist in the initial DCM </p>
<p>configuration. If the newly generated calibration value sets a bit in a bitmap, which </p>
<p>was not set in the initial configuration, DCM will report the calibrated APID value. But </p>
<p>once the tester tries to read the DPID, corresponding to the wrongly set bit in the </p>
<p>APID, DCM will react according to its initial configuration state – the DPID is not </p>
<p>supported.  </p>
<p><b>&gt; </b></p>
<p>If the OBD functionality shall be completely disabled, then: </p>
<p><b>&gt; </b></p>
<p>The OBD services have to be filtered as described in <i>9.11.1.1 Calibration of </i></p>
<p><i>Supported OBD Services.  </i></p>
<p><b>&gt; </b></p>
<p>The UDS OBD DIDs/RIDs shall be disabled by resetting <b>all </b>APID specific bitmap </p>
<p>values. </p>
<p>Any faulty calibration will <b>not </b>cause any damage to the ECU or its software, but will </p>
<p><b>lead to OBD diagnostic protocol violations</b>. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>9.12 </b></p>
<p><b>How and When to Configure Multiple Protocols </b></p>
<p>DCM  provides  means  for  supporting  multiple  diagnostic  protocols  in  one  configuration. </p>
<p>There are several use cases, where multiple protocols shall be used in need of: </p>
<p><b>&gt; </b></p>
<p><i>Diagnostic Client(s) Processing Prioritization </i></p>
<p><b>&gt; </b></p>
<p><i>Client Specific Diagnostic Application Timings </i></p>
<p><b>&gt; </b></p>
<p><i>Diagnostic Service Firewall </i></p>
<p>Please refer to the corresponding use case chapter below for details. Please note that all </p>
<p>these use cases can also be combined. </p>
<p> </p>
<p><b>9.12.1 </b></p>
<p><b>Diagnostic Client(s) Processing Prioritization </b></p>
<p>If one or more diagnostic clients shall have privileged access over other clients (e.g. OBD2 </p>
<p>client  is  more  important  than  an  OEM  service  tool),  then  all  clients  shall  be  grouped </p>
<p>according  to  their  priority. These  groups  are  called  in  the  DCM  configuration  “protocols” </p>
<p>(/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow). </p>
<p>Each </p>
<p>protocol </p>
<p>possesses </p>
<p>a </p>
<p>priority </p>
<p>property </p>
<p>(DcmDslProtocolPriority) </p>
<p>that </p>
<p>determines </p>
<p>the </p>
<p>group </p>
<p>importance. Please refer to the online help of this setting for more details about it. </p>
<p>Once all clients that will communicate with the ECU were classified upon their importance, </p>
<p>their connections </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>192 </p>
<p>based on template version 5.0.0 </p>
<p>(/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmDslConnection/D</p>
<p>cmDslMainConnection) have to be assigned to the corresponding protocol.  </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>It is important to know, that in case of <b>protocol prioritization needed</b>, each protocol </p>
<p>available in the DCM configuration shall refer to a <b>dedicated diagnostic buffer</b>. If two </p>
<p>or more protocols do share the same buffer, no concurrent reception of diagnostic </p>
<p>requests will be possible for clients assigned to these protocols. Only in case a non-</p>
<p>default session is already started and the ECU is currently not processing any request, </p>
<p>will give a client with higher priority the opportunity to get access over the ECU (please </p>
<p>refer to <i>Table 9-6  Protocol prioritization during non-default session</i>). </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>Having  specified  the  diagnostic  protocols  with  their  tester  connections,  corresponding </p>
<p>buffers and priority, your ECU is ready to handle privileged requests.  </p>
<p>Under the assumption that for all requests the activation of the new protocol is accepted </p>
<p>(<i>StartProtocol() </i>returns E_OK), the handling of higher priority clients to lower priority ones </p>
<p>(and vice versa) in DCM in different diagnostic sessions is shown in the matrixes below. </p>
<p>The most important situations that can occur between two concurrent clients are focused </p>
<p>by dedicated colors. Please, refer to <i>Table 9-4  </i></p>
<p><i>Color  legend  to  the  protocol  prioritization </i></p>
<p><i>matrixes </i>for detailed explanation. </p>
<p> </p>
<p><b>Color </b></p>
<p><b>Meaning </b></p>
<p>Blue </p>
<p>Focuses on the different behavior for a lower or equal priority client when the ECU is </p>
<p>in the default or in a non-default session. </p>
<p>Green </p>
<p>Focuses on the situations where a lower or equal priority client will get a NRC 0x21. </p>
<p>Orange </p>
<p>Focuses on the situations where an active job of a client will be interrupted by a </p>
<p>higher priority client. </p>
<p>Grey </p>
<p>A situation that can never occur due to reactions in the preceded cases. </p>
<p>Table 9-4  </p>
<p>Color legend to the protocol prioritization matrixes </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>193 </p>
<p>based on template version 5.0.0 </p>
<p><b>Hi-Prio </b></p>
<p><b>Client (A) </b></p>
<p><b>Idle </b></p>
<p><b>Rx Ongoing </b></p>
<p><b>Rx End </b></p>
<p><b>Service  </b></p>
<p><b>Processing </b></p>
<p><b>Tx Ongoing </b></p>
<p><b>Tx End </b></p>
<p><b>(Post-</b></p>
<p><b>Processing) </b></p>
<p><b>Lo-Prio </b></p>
<p><b>Client (B) </b></p>
<p><b>Idle </b></p>
<p> </p>
<p>Receive </p>
<p>request (A). </p>
<p>Start service </p>
<p>processing </p>
<p>(A). </p>
<p>Continue </p>
<p>service </p>
<p>processing (A). </p>
<p>Continue </p>
<p>response </p>
<p>transmission </p>
<p>(A). </p>
<p>Do post-</p>
<p>processing </p>
<p>(A). </p>
<p><b>Rx Ongoing </b></p>
<p>Receive request </p>
<p>(B). </p>
<p>Receive both </p>
<p>requests. </p>
<p>Start service </p>
<p>processing </p>
<p>(A), continue </p>
<p>reception (B). </p>
<p>Continue </p>
<p>service </p>
<p>processing (A), </p>
<p>continue </p>
<p>reception (B). </p>
<p>Continue </p>
<p>response </p>
<p>transmission </p>
<p>(A), continue </p>
<p>reception (B). </p>
<p>Do post-</p>
<p>processing </p>
<p>(A), continue </p>
<p>reception (B). </p>
<p><b>Rx End </b></p>
<p>Start service </p>
<p>processing (B). </p>
<p>Continue </p>
<p>reception (A), </p>
<p>start service </p>
<p>processing </p>
<p>(B). </p>
<p>Start service </p>
<p>processing </p>
<p>(A), send NRC </p>
<p>0x21</p>
<p>3)</p>
<p> (B). </p>
<p>Continue </p>
<p>service </p>
<p>processing (A), </p>
<p>send NRC </p>
<p>0x21</p>
<p>3)</p>
<p> (B). </p>
<p>Continue </p>
<p>response </p>
<p>transmission </p>
<p>(A), send </p>
<p>NRC 0x21</p>
<p>3)</p>
<p> </p>
<p>(B). </p>
<p>Do post-</p>
<p>processing </p>
<p>(A), start </p>
<p>service </p>
<p>processing </p>
<p>(B). </p>
<p><b>Service  </b></p>
<p><b>Processing </b></p>
<p>Continue </p>
<p>service </p>
<p>processing (B). </p>
<p>Continue </p>
<p>reception (A), </p>
<p>continue </p>
<p>service </p>
<p>processing </p>
<p>(B). </p>
<p>Interrupt </p>
<p>service </p>
<p>processing </p>
<p>1)</p>
<p> </p>
<p>(B), do post </p>
<p>processing </p>
<p>2) </p>
<p>(B), start </p>
<p>service </p>
<p>processing </p>
<p>(A). </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p><b>Tx Ongoing </b></p>
<p>Continue </p>
<p>response </p>
<p>transmission </p>
<p>(B). </p>
<p>Continue </p>
<p>reception (A), </p>
<p>continue </p>
<p>response </p>
<p>transmission </p>
<p>(B). </p>
<p>Interrupt </p>
<p>response </p>
<p>transmission </p>
<p>(B),  </p>
<p>do post </p>
<p>processing </p>
<p>2) </p>
<p>(B), </p>
<p>start service </p>
<p>processing </p>
<p>(A). </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p><b>Tx End </b></p>
<p><b>(Post-</b></p>
<p><b>Processing) </b></p>
<p>Do post-</p>
<p>processing (B). </p>
<p>Do post-</p>
<p>processing </p>
<p>(B), continue </p>
<p>reception (A). </p>
<p>Do post-</p>
<p>processing </p>
<p>(B), start </p>
<p>service </p>
<p>processing </p>
<p>(A). </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>Table 9-5  </p>
<p>Protocol prioritization during default session </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>194 </p>
<p>based on template version 5.0.0 </p>
<p><b>Hi-Prio </b></p>
<p><b>Client (A) </b></p>
<p><b>Idle </b></p>
<p><b>Rx Ongoing </b></p>
<p><b>Rx End </b></p>
<p><b>Service  </b></p>
<p><b>Processing </b></p>
<p><b>Tx Ongoing </b></p>
<p><b>Tx End </b></p>
<p><b>(Post-</b></p>
<p><b>Processing) </b></p>
<p><b>Lo-Prio </b></p>
<p><b>Client (B) </b></p>
<p><b>Idle </b></p>
<p> </p>
<p>Receive </p>
<p>request (A). </p>
<p>Start service </p>
<p>processing </p>
<p>(A). </p>
<p>Continue </p>
<p>service </p>
<p>processing (A). </p>
<p>Continue </p>
<p>response </p>
<p>transmission </p>
<p>(A). </p>
<p>Do post-</p>
<p>processing </p>
<p>(A). </p>
<p><b>Rx Ongoing </b></p>
<p>Receive request </p>
<p>(B)</p>
<p> 4)</p>
<p>. </p>
<p>Receive both </p>
<p>requests. </p>
<p>Start service </p>
<p>processing </p>
<p>(A), continue </p>
<p>reception (B). </p>
<p>Continue </p>
<p>service </p>
<p>processing (A), </p>
<p>continue </p>
<p>reception (B). </p>
<p>Continue </p>
<p>response </p>
<p>transmission </p>
<p>(A), continue </p>
<p>reception (B). </p>
<p>Do post-</p>
<p>processing </p>
<p>(A), continue </p>
<p>reception (B). </p>
<p><b>Rx End </b></p>
<p>Send NRC </p>
<p>0x21</p>
<p>3)</p>
<p> (B). </p>
<p>Continue </p>
<p>reception (A), </p>
<p>start service </p>
<p>processing </p>
<p>(B). </p>
<p>Start service </p>
<p>processing </p>
<p>(A), send NRC </p>
<p>0x21</p>
<p>3)</p>
<p> (B). </p>
<p>Continue </p>
<p>service </p>
<p>processing (A), </p>
<p>send NRC </p>
<p>0x21</p>
<p>3)</p>
<p> (B). </p>
<p>Continue </p>
<p>response </p>
<p>transmission </p>
<p>(A), send </p>
<p>NRC 0x21</p>
<p>3)</p>
<p> </p>
<p>(B). </p>
<p>Do post-</p>
<p>processing </p>
<p>(A), start </p>
<p>service </p>
<p>processing </p>
<p>(B). </p>
<p><b>Service  </b></p>
<p><b>Processing </b></p>
<p>N/A </p>
<p>Continue </p>
<p>reception (A), </p>
<p>continue </p>
<p>service </p>
<p>processing </p>
<p>(B). </p>
<p>Interrupt </p>
<p>service </p>
<p>processing </p>
<p>1) </p>
<p>(B), do post </p>
<p>processing </p>
<p>2) </p>
<p>(B), start </p>
<p>service </p>
<p>processing </p>
<p>(A). </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p><b>Tx Ongoing </b></p>
<p>N/A </p>
<p>Continue </p>
<p>reception (A), </p>
<p>continue </p>
<p>response </p>
<p>transmission </p>
<p>(B). </p>
<p>Interrupt </p>
<p>response </p>
<p>transmission </p>
<p>(B),  </p>
<p>do post </p>
<p>processing </p>
<p>2) </p>
<p>(B), </p>
<p>start service </p>
<p>processing </p>
<p>(A). </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p><b>Tx End </b></p>
<p><b>(Post-</b></p>
<p><b>Processing) </b></p>
<p>N/A </p>
<p>Do post-</p>
<p>processing </p>
<p>(B), continue </p>
<p>reception (A). </p>
<p>Do post-</p>
<p>processing </p>
<p>(B), start </p>
<p>service </p>
<p>processing </p>
<p>(A). </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>Table 9-6  </p>
<p>Protocol prioritization during non-default session </p>
<p>1)  If an operation is ongoing (i.e. any callout with an OpStatus parameter that already </p>
<p>has been called with OpStatus == DCM_INITIAL), then this operation is called for a </p>
<p>last time with OpStatus == DCM_CANCEL to stop any further job execution. </p>
<p>2)  In </p>
<p>case </p>
<p>of </p>
<p>interruption </p>
<p>all </p>
<p>configured </p>
<p>confirmation </p>
<p>functions </p>
<p>(i.e. </p>
<p><i>ServiceRequestManufacturerNotification_&lt;SWC&gt;</i>, </p>
<p><i>ServiceRequestSupplierNotification_&lt;SWC&gt;</i>) will be called to finalize the jobs e.g. </p>
<p>releasing semaphores, resources, etc. The confirmation status will be negative. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>195 </p>
<p>based on template version 5.0.0 </p>
<p>3)  NRC  0x21  will  be  sent  only  if  configured  (refer  to <i> 9.4  How  to  Handle  Multiple </i></p>
<p><i>Diagnostic Clients Simultaneously</i>). Otherwise there will be no response at all. </p>
<p>4)  The low priority request reception will be granted only if there shall be NRC 0x21 to </p>
<p>be  sent  back  (see </p>
<p>3)</p>
<p>).  Otherwise  there  will be  no  response  at all  on  single frame </p>
<p>request, or FC.OVFW in case of a multi-frame request. </p>
<p> </p>
<p><b>9.12.2 </b></p>
<p><b>Client Specific Diagnostic Application Timings </b></p>
<p>If the ECU shall be able to communicate with clients that have the same importance, but </p>
<p>some of the clients are connected to it via bus systems that cannot guarantee the default </p>
<p>P2 timings, then these clients can be assigned to a dedicated protocol. The new protocol </p>
<p>shall fulfill the following requirements: </p>
<p><b>&gt; </b></p>
<p>share the same diagnostic service table (same services are accessible); </p>
<p><b>&gt; </b></p>
<p>have the same priority in order to avoid any protocol preemption; </p>
<p><b>&gt; </b></p>
<p>share the same buffer </p>
<p> </p>
<p>Only the protocol specific P2 and P2Star specific parameters: </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmTimStrP2Serv</p>
<p>erAdjust </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmTimStrP2Star</p>
<p>ServerAdjust </p>
<p>shall be specified so that the RCR-RP messages can be sent in time to the corresponding </p>
<p>clients. </p>
<p> </p>
<p><b>9.12.3 </b></p>
<p><b>Diagnostic Service Firewall </b></p>
<p>If the ECU shall allow only limited diagnostic service access to certain diagnostic clients, </p>
<p>then the multi-protocol feature can be used to specify that.  </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>Diagnostic service firewalling support is limited to service identifier level. This means, </p>
<p>that you can specify whether a service is visible to a client or not, but cannot hide </p>
<p>specific sub-functions, DIDs, RIDs, etc. of a service. This also implies <b>that if a </b></p>
<p><b>diagnostic service with a given SID is available in more than one diagnostic </b></p>
<p><b>service table; all of its corresponding properties must be identical in all </b></p>
<p><b>instances of this service</b>. For example: it is not possible to specify different session </p>
<p>and security access execution precondition for the same SID in different tables. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>Each protocol refers to a specific diagnostic service table  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>196 </p>
<p>based on template version 5.0.0 </p>
<p>(/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmDslProtocolSIDT</p>
<p>able) that contains all services visible to this protocol. So in case an OBD2 tester shall only </p>
<p>be able to access the OBD2 services (SID 0x01-0x0A), and the service tester shall be able </p>
<p>to  access  all  UDS  services  and  additionally <i> ClearEmissionRelatedDTC  ($04)</i>,  then  the </p>
<p>DCM configuration shall look like as follows: </p>
<p> </p>
<p><b></b></p>
<p><b> </b></p>
<p>There shall be two diagnostic service tables </p>
<p>(/Dcm/DcmConfigSet/DcmDsd/DcmDsdServiceTable):  </p>
<p><b>&gt; </b></p>
<p>One for the UDS services and the SID 0x04; </p>
<p><b>&gt; </b></p>
<p>One for all OBD2 services (incl. SID 0x04); </p>
<p><b></b></p>
<p><b> </b></p>
<p>There shall be two diagnostic protocols such as: </p>
<p><b>&gt; </b></p>
<p>The “service tool“ one: </p>
<p><b>&gt; </b></p>
<p>shall refer to the UDS service table;  </p>
<p><b>&gt; </b></p>
<p>shall contain only the service tester connection </p>
<p><b>&gt; </b></p>
<p>The OBD2 one: </p>
<p><b>&gt; </b></p>
<p>shall refer to the OBD2 service table; </p>
<p><b>&gt; </b></p>
<p>shall contain only the OBD2 tester connection </p>
<p> </p>
<p>In such a configuration the UDS tester will always get NRC 0x11 (ServiceNotSupported) if </p>
<p>any OBD2 request other than 0x04 is addressed physically. The OBD2 tester will never get </p>
<p>access to the UDS services – will get either NRC 0x11 (peer-to-peer communication) or no </p>
<p>response (on functionally addressed requests). </p>
<p><b>9.13 </b></p>
<p><b>How to Select DEM-DCM Interface Version </b></p>
<p>DCM is now (since version 2.01.00) capable of supporting both native DEM AR 4.0.3 and </p>
<p>newer AR 4.1.2 API. The API version selection is not performed automatically, since there </p>
<p>is not always a DEM available in the ECU configuration, but indeed there is one used in </p>
<p>the  software.  Therefore  a  vendor  specific  configuration  parameter  for  DEM API  version </p>
<p>selection  is  introduced:/Dcm/DcmConfigSet/DcmGeneral/DcmDemApiVersion.  For  more </p>
<p>details, please refer to the online help of this parameter. </p>
<p> </p>
<p><b>9.14 </b></p>
<p><b>How to Support OBD and UDS over a Single Client Connection </b></p>
<p>Usually  if  an  ECU  shall  support  OBD  communication  capabilities  (i.e.  OBD2  diagnostic </p>
<p>protocol), </p>
<p>it </p>
<p>shall </p>
<p>have </p>
<p>a </p>
<p>dedicated </p>
<p>connection </p>
<p>to </p>
<p>an </p>
<p>OBD </p>
<p>tester. </p>
<p>This </p>
<p>allows </p>
<p>protocol/diagnostic client prioritization (refer to <i>9.12 How and When to Configure Multiple </i></p>
<p><i>Protocols</i>)  and  guaranteed  OBD  task  handling.  Nevertheless  there  are  requirements  on </p>
<p>supporting both UDS and OBD over a shared diagnostic connection. In this case, no client </p>
<p>prioritization can take place, but still the ECU shall reset any short term changes caused </p>
<p>by  an  UDS  tester  right  before.  This  task  is  automatically  performed  by  DCM.  Once  a </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>197 </p>
<p>based on template version 5.0.0 </p>
<p><b>functionally requested OBD service </b>is received (regardless of whether it is supported or </p>
<p>not by the current ECU configuration), the ECU will enter the default session, just before </p>
<p>the OBD request evaluation and execution starts. This automatic switch is only possible if </p>
<p>all conditions below are fulfilled: </p>
<p>- </p>
<p>There  is  at  least  one  OBD  service  (i.e.  SID  in  range  [0x00-0x0F])  configured  for </p>
<p>DCM (as an internal or external service processor implementation). </p>
<p>- </p>
<p>There is exactly one diagnostic connection configured in DCM. If there are two or </p>
<p>more  connections,  please  use  the  multi-protocol  prioritization  mechanism  with </p>
<p>shared  diagnostic  buffers  instead  (refer  to <i> 9.12  How  and  When  to  Configure </i></p>
<p><i>Multiple Protocols</i>)<i>. </i></p>
<p> </p>
<p><b>9.15 </b></p>
<p><b>How to Use a User Configuration File </b></p>
<p>DCM has an advanced code configuration and code generation tool that completely sets </p>
<p>up  the  module.  However,  in  exceptional  cases  there  is  a  need  to  complete  or  override </p>
<p>some of the generated parameters. Most common such cases are workarounds for issues </p>
<p>found after product’s release. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>User configuration file content must either be described in this manual or agreed by the </p>
<p>Vector Informatik company prior using it in production code. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>A user configuration file has no specific name. It can be any text file form e.g. Dcm.cfg. In </p>
<p>order  to  use  already  created  user  configuration  file  within  the  DCM’s  code  generation </p>
<p>process, you have to specify the full path to this file here:  </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmUserConfigFile </p>
<p> </p>
<p><b>9.16 </b></p>
<p><b>How to Know When the Security Access Level Changes </b></p>
<p>There are situations where the ECU shall cancel all by the tester activated functions, when </p>
<p>they  were  secured  and  the  security  level  changes.  In  some  cases  the  DCM  is  able  to </p>
<p>handle this internally:  </p>
<p><b>&gt; </b></p>
<p><i>ReadDataByPeriodicIdentifier ($2A) </i></p>
<p><b>&gt; </b></p>
<p><i>DynamicallyDefineDataIdentifier ($2C) </i></p>
<p> </p>
<p>For other diagnostic services, such as  </p>
<p><b>&gt; </b></p>
<p><i>InputOutputControlByIdentifier ($2F) </i>(will be automatically reset by DCM only on  </p>
<p>(re-)entering default session) </p>
<p><b>&gt; </b></p>
<p><i>RoutineControl ($31) </i></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>198 </p>
<p>based on template version 5.0.0 </p>
<p>this task has to be performed by the application. For that purpose, the DCM can notify the </p>
<p>application </p>
<p>in </p>
<p>several </p>
<p>ways </p>
<p>each </p>
<p>time </p>
<p>the </p>
<p>security </p>
<p>level </p>
<p>performs </p>
<p>a </p>
<p>non-self-state-</p>
<p>transition.  An  example  for  such  a  transition  is  “Level  1  -&gt;  Locked”,  but  not  “Locked-</p>
<p>&gt;Locked”. The latter occurs when the default session has been re-activated. </p>
<p>The possible notifications are: </p>
<p><b>&gt; </b></p>
<p><i>Invoking a Mode Switch </i></p>
<p><b>&gt; </b></p>
<p><i>Calling a Function Implemented Within a CDD Module </i></p>
<p>Using these indications the application may stop any running background routines that are </p>
<p>secured. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>A security access level change can be triggered by any of the following events: </p>
<p>- </p>
<p>Any diagnostic session change caused by: </p>
<p>- </p>
<p>Service <i>DiagnosticSessionControl ($10); </i></p>
<p>- </p>
<p>TesterPresent Timeout; </p>
<p>- </p>
<p>Protocol Preemption; </p>
<p>- </p>
<p>A successfully processed security unlocking sequence with service </p>
<p><i>SecurityAccess ($27) </i></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>9.16.1 </b></p>
<p><b>Invoking a Mode Switch </b></p>
<p>Whether the DCM shall notify about security access change using a mode switch, you can </p>
<p>specify by configuration parameter:  </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmSecurityLevelChangeNotificationEnabled </p>
<p> </p>
<p>In case of state change, the DCM will invoke a mode switch for the mode declaration </p>
<p>group <i>DcmSecurityAccess. </i></p>
<p><i> </i></p>
<p><b>9.16.2 </b></p>
<p><b>Calling a Function Implemented Within a CDD Module </b></p>
<p>Whether the DCM shall notify about security access changes using simple function calls, </p>
<p>you can specify by using configuration containers:  </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecurityCallback </p>
<p>For each callback you need, a dedicated container of the above type shall be configured </p>
<p>for DCM. The parameter </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecurityCallback/DcmDspSecurit</p>
<p>yCallbackFnc will specify the function you want to be called by DCM. All these functions </p>
<p>will have the prototype defined in chapter <i>6.5.1.9 &lt;Security Access Change Notification </i></p>
<p><i>Callback&gt;. </i></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>199 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.17 </b></p>
<p><b>How to Deal with the PduR AR version </b></p>
<p>The DCM supports the interface to the PduR according to AR 3.x, AR 4.0.1, AR 4.0.3 and </p>
<p>AR 4.1.2. Depending on the AR major version there are different configuration strategies. </p>
<p><b>9.17.1 </b></p>
<p><b>AUTOSAR 3 Environment </b></p>
<p>If  DCM  shall  interact  with  a  PduR  from  an AR3  stack,  then  the  delivery  containing  this </p>
<p>DCM is already properly pre-configured. You cannot switch to any other PduR AR version. </p>
<p> </p>
<p><b>9.17.2 </b></p>
<p><b>AUTOSAR 4 Environment </b></p>
<p>For PduRs from AR 4.x stack, the concrete AR version is automatically derived from the </p>
<p>PduR BSWMD file. </p>
<p>However, it is possible to enforce a specific AR version during integration by defining  </p>
<p>MSR_PDUR_API_AR_VERSION in the file Compiler_Cfg.h. </p>
<p>Example: The PduR AR version is set to 4.0.3: </p>
<p>#define MSR_PDUR_API_AR_VERSION 0x403 </p>
<p>For a detailed description of the PduR APIs, please refer to chapter <i>6.4.3 PduR. </i></p>
<p><b>9.18 </b></p>
<p><b>Post-build Support </b></p>
<p>The DCM is optionally capable of flexible configuration selection at run time. The following </p>
<p>post-build variants are supported: </p>
<p><b>&gt; </b></p>
<p>variant switching at run-time - <i>Post-build selectable </i></p>
<p><b>&gt; </b></p>
<p>variant calibration - <i>Post-build loadable </i></p>
<p><b>&gt; </b></p>
<p>combination of both - <i>Post-build loadable selectable </i></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>Please refer to the basic software module description (<i>Dcm_bswmd.arxml</i>) file </p>
<p>accompanying your delivery to find which parameters support post-build </p>
<p>parametrization. </p>
<p>This information is also displayed in the DaVinci Configurator 5 tool. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>9.18.1 </b></p>
<p><b>Post-build Variance Level </b></p>
<p>For all of the above mentioned supported variants, there is certain variance level that is </p>
<p>covered by the module. Since the DCM can be logically divided into two main parts: </p>
<p><b>&gt; </b></p>
<p><i>Communication Part </i></p>
<p><b>&gt; </b></p>
<p><i>Diagnostic Services Part </i></p>
<p>we will define the level of variance for each of them separately. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>200 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.18.1.1 </b></p>
<p><b>Communication Part </b></p>
<p>DCM’s  communication  part  includes  every  parameter  located  under  the  configuration </p>
<p>container  with  path  /Dcm/Dsl.  The  few  non-post-build  capable  parameters  are  defined </p>
<p>within the <i>Dcm_bswmd.arxml </i>file. </p>
<p>In general the communication part of DCM handles configurations with: </p>
<p><b>&gt; </b></p>
<p>different amount of protocols or/and different protocol properties such as: </p>
<p><b>&gt; </b></p>
<p>P2/P2 timing adjustments, priorities, buffer assignment, protocol ID, service table </p>
<p>references, etc.; </p>
<p><b>&gt; </b></p>
<p>different number of connections or/and different connection parameters such as: </p>
<p><b>&gt; </b></p>
<p>changed diagnostic message identifiers (e.g. multi-ECU use case using the same </p>
<p>ECU for both left and right doors); </p>
<p><b>&gt; </b></p>
<p>with or without periodic transmission (e.g. when periodic reading is not allowed </p>
<p>within a variant (note: this will be possible once the diagnostic part of DCM </p>
<p>becomes capable of variant switching). </p>
<p>What you cannot change is the number of diagnostic buffers and their size. Since the size </p>
<p>is </p>
<p>used </p>
<p>for </p>
<p>the </p>
<p>RTE </p>
<p>ports </p>
<p>(<i>ServiceRequestManufacturerNotification_&lt;SWC&gt; </i></p>
<p>and </p>
<p><i>ServiceRequestSupplierNotification_&lt;SWC&gt;</i>)  it  cannot  change  after  compile  time  since </p>
<p>RTE is not post-build capable. </p>
<p> </p>
<p><b>9.18.1.2 </b></p>
<p><b>Diagnostic Services Part </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>  If you have used the only PBS like option on diagnostic service level, provided in </p>
<p>DCM 5.00.00 and later versions, as an alternative way to handle multiple diagnostic </p>
<p>service variants (described in details in chapter “<i>9.29 How to Handle Multiple </i></p>
<p><i>Diagnostic Service Variants</i>”) you may now want to switch to the fully operational PBS </p>
<p>support by DCM described here. </p>
<p> Since PBL variant handling on diagnostic service is not yet supported, OBD calibration </p>
<p>is still the only way to change variants by calibrating data only operation. </p>
<p><b> </b></p>
<p><b> </b></p>
<p>DCM’s  diagnostic  service  part  includes  every  parameter located under the  configuration </p>
<p>containers with path /Dcm/Dsd and /Dcm/Dsp.  </p>
<p>In  general,  the  PBS  support  in  DCM  is  limited  only  to  the  selection  of  the  following </p>
<p>diagnostic entities per ECU variant: </p>
<p><b>&gt; </b></p>
<p>Diagnostic Services </p>
<p><b>&gt; </b></p>
<p>Diagnostic Sub-Services </p>
<p><b>&gt; </b></p>
<p>DIDs (and their operations)  </p>
<p><b>&gt; </b></p>
<p>RIDs </p>
<p><b>&gt; </b></p>
<p>Memory Ranges </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>201 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>OBD PIDs </p>
<p><b>&gt; </b></p>
<p>OBD MIDs </p>
<p><b>&gt; </b></p>
<p>OBD TIDs </p>
<p><b>&gt; </b></p>
<p>OBD VIDs </p>
<p>So, you can only decide whether a certain diagnostic entity is available or not in a certain </p>
<p>ECU variant. This implies that if an entity is available in more than one variant depending </p>
<p>on its type it is not possible to: </p>
<p><b>&gt; </b></p>
<p>Vary its execution preconditions (i.e. Session and SecurityAccess state references); </p>
<p><b>&gt; </b></p>
<p>Specify different DID/RID etc. data layout and content; </p>
<p><b>&gt; </b></p>
<p>Specify variant dependent periodic rates; </p>
<p><b>&gt; </b></p>
<p>Specify variant dependent scheduler capacity; </p>
<p><b>&gt; </b></p>
<p>Specify variant RoE events; </p>
<p><b>&gt; </b></p>
<p>Specify RID specific sub-functions (i.e. disable only the Stop operation for a RID); </p>
<p><b>&gt; </b></p>
<p>Specify IO DID specific operation (i.e. disable only FreezeCurrentState for an IODID); </p>
<p><b>&gt; </b></p>
<p>Etc. </p>
<p>Although the <i>Dcm_bswmd.arxml </i>file already limits those ECUC configuration containers </p>
<p>and parameters that are not meant to be variable, there are still some of them that for </p>
<p>specific reasons had to be defined as variant. Here is an abstract list of the </p>
<p>parameter/container kinds that are specified as post-build related, because they can be </p>
<p>absent in a variant, even if they shall not vary in their values: </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>202 </p>
<p>based on template version 5.0.0 </p>
<p><b>Rules </b></p>
<p><b>Description </b></p>
<p>All the diagnostic entities, listed above as </p>
<p>variant-capable (e.g. DIDs, RIDs, diagnostic </p>
<p>services etc.) that have the same identifier in </p>
<p>the variants they occur shall always have the </p>
<p>same short name. </p>
<p>This is required in order to guarantee that the </p>
<p>corresponding diagnostic entity properties that </p>
<p>are not variable will remain constant in all </p>
<p>variants. </p>
<p> </p>
<p>For example, all corresponding containers that </p>
<p>represent a concrete DID must have the same </p>
<p>short name in all variants the DID is available. In </p>
<p>this way, the DID will have the same data layout </p>
<p>in all variants. </p>
<p>Invariant Boolean parameters will be merged </p>
<p>over all variants. </p>
<p>There are some Boolean parameters (e.g. </p>
<p>DcmDspRoeInitOnDSC) that may be missing in a </p>
<p>certain variant (e.g. RoE not supported) thus their </p>
<p>multiplicity or the container they belong to is </p>
<p>specified as post-build capable. The parameter </p>
<p>itself but shall not change its value over all the </p>
<p>variants it applies to.  </p>
<p>Depending on the parameter semantic, the final </p>
<p>value for all variants will either be TRUE or </p>
<p>FALSE or last is best. </p>
<p>Invariant Integer parameters will be calculated </p>
<p>over all variants. </p>
<p>There are some Integer parameters (e.g. </p>
<p>DcmDspMaxPeriodicDidToRead) that may be </p>
<p>missing in a certain variant (e.g. where service </p>
<p><i>ReadDataByIdentifier ($22) </i>is not supported) thus </p>
<p>their multiplicity or the container they belong to is </p>
<p>specified as post-build capable. The parameter </p>
<p>value shall not change its value over all the </p>
<p>variants it applies to.  </p>
<p>Depending on the parameter semantic, the final </p>
<p>value for all variants will either be the minimum, </p>
<p>maximum (DcmDspMaxPeriodicDidToRead) or </p>
<p>last is best (DcmDspPowerDownTime). </p>
<p>All configuration entities with execution </p>
<p>preconditions (i.e. </p>
<p>Session/Security/ModeRules) that have the </p>
<p>same identifier in the variants shall have the </p>
<p>same precondition. </p>
<p>For example a diagnostic service shall not vary </p>
<p>its session state dependencies in different </p>
<p>variants.  </p>
<p> </p>
<p>For details on what shall be considered in case of </p>
<p>execution precondition mismatches, please refer </p>
<p>to chapter <i>9.18.1.2.1</i>. </p>
<p>OBD related UDS entities are always linked to </p>
<p>their corresponding OBD entities, when such </p>
<p>are available. </p>
<p>MSR DCM always applies UDS-to-OBD </p>
<p>automatic linking for those UDS DIDs and RIDs </p>
<p>that have corresponding OBD PID/MID/TID or </p>
<p>VID.  </p>
<p>In the context of multiple variants, there can be </p>
<p>configurations that for example do have only </p>
<p>OBD2 entities (e.g. PIDs) in one variant and OBD </p>
<p>related UDS entities (e.g. DIDs) in another </p>
<p>variant. In this case DCM will still link those </p>
<p>matching UDS and OBD entities as it does in a </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>203 </p>
<p>based on template version 5.0.0 </p>
<p>single variant configuration. The advantage is – </p>
<p>the application has to implement only one data </p>
<p>provider for the overlapping UDS and OBD </p>
<p>entities. </p>
<p>Table 9-7  </p>
<p>Post-build configuration rules on invariant DCM parameters </p>
<p><b>9.18.1.2.1 </b></p>
<p><b>Handling of State Execution Preconditions of Variant Diagnostic Entities </b></p>
<p>The execution preconditions of diagnostic entities are meant to be invariant. Still, there are </p>
<p>some special scenarios that have to be taken into account. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>The configuration tool will detect inconsistencies regarding execution preconditions on </p>
<p>related diagnostic entities and warn you with an appropriate message. The message </p>
<p>IDs (DCM05010 - DCM05025) you may get and their explanations are listed in <i>10.2 </i></p>
<p><i>Code Generation Time Messages</i>. </p>
<p> </p>
<p>Only one kind of diagnostic entity will not be validated upon execution precondition </p>
<p>mismatch: <b>memory ranges</b>. </p>
<p>DCM always calculates an optimized equivalent memory layout, based on the </p>
<p>configured memory ranges and their access type (read/write) related preconditions. If </p>
<p>there are overlapping memory areas with different preconditions, they will be merged </p>
<p>into a corresponding single memory area with new preconditions that allow access to it </p>
<p>under a certain state only if at least one variant resp. overlapping instance within the </p>
<p>same variant allows the access in the given state.<i> </i></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>&gt; </b></p>
<p>A diagnostic entity has execution precondition that refers to states not existing in some </p>
<p>variants. </p>
<p><b>&gt; </b></p>
<p>A special case: The state group (e.g. SecurityAccess) is not available in all variants, </p>
<p>since service <i>SecurityAccess ($27) </i>is not available at all in those variants. </p>
<p>In the described case the affected diagnostic entity will be configured with an empty </p>
<p>list of precondition related states. A list with no state references is always interpreted </p>
<p>as “no execution precondition restrictions”. This of course mismatches the original </p>
<p>semantic of the precondition: “diagnostic entity accessible _<i><b>only_ </b></i>in the referenced </p>
<p>state(s)”. </p>
<p><b>Solution: </b></p>
<p>Having a diagnostic entity available in a variant where it shall not be executed in any </p>
<p>(remaining) state of a state group sounds implausible. Actually such a diagnostic entity </p>
<p>(e.g. diagnostic service, DID etc.) will never be able to send a positive response and </p>
<p>thus shall not even exist in the affected variant(s). </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>204 </p>
<p>based on template version 5.0.0 </p>
<p><b>Example: </b></p>
<p>Diagnostic service shall be supported only in the programming session. This service is </p>
<p>configured to be available in a variant, where the programming session is not available </p>
<p>at all. As a result the given service shall not exist in the variant too. </p>
<p><b>What happens if the affected diagnostic entity is not removed from the variant? </b></p>
<p>DCM will interpret the precondition as “there is no precondition” and will merge these </p>
<p>states over all the variants, allowing the diagnostic entity to be always accessible.   </p>
<p><b>&gt; </b></p>
<p>The execution precondition depends on the preconditions of other related diagnostic </p>
<p>entities. </p>
<p>In order to have a UDS compliant NRC prioritization, the execution preconditions on </p>
<p>diagnostic service level are derived from their sub-service parameters (i.e. sub-</p>
<p>function or parameter identifiers such as DIDs). In other words a diagnostic service </p>
<p>shall be allowed in a specific state if at least one of its sub-service parameters is </p>
<p>allowed in this state.  </p>
<p><b>Example: </b></p>
<p>For service <i>ReadDataByIdentifier ($22) </i>it is true, that it shall be allowed in the default </p>
<p>session if at least one of the readable DIDs shall be readable in the default session. </p>
<p>Otherwise, the DID specific operation “read” will have a precondition that allows to be </p>
<p>accessed, but any attempt to read the DID will fail, since it will be rejected on higher </p>
<p>processing (diagnostic service) level. </p>
<p><b>Problem: </b></p>
<p>The problem the multi-variant handling faces is that if the only DID that has required </p>
<p>service <i>ReadDataByIdentifier ($22) </i>to be accessible in the default session does not </p>
<p>exist in a new variant where other readable DIDs are still available, meaning service </p>
<p><i>ReadDataByIdentifier ($22)  </i>is still required to be available too. This automatically </p>
<p>means that the diagnostic service shall lose its permission to be accessible in the </p>
<p>default session within that variant. Due to the invariance of the diagnostic entity </p>
<p>preconditions (i.e. once allowed and no not allowed), such configurations will cause </p>
<p>warnings to be issued in the configuration tool.  </p>
<p><b>Solution: </b></p>
<p>There is no real solution for such situations, since the affected service cannot be </p>
<p>removed from the variant. But … </p>
<p><b>… what would happen in such a configuration? </b></p>
<p>The ECU will still reject any unsupported in the given state diagnostic entity (in our </p>
<p>example the concrete DID). The only difference will be the NRC sent back by the ECU </p>
<p>when the variant without the readable in the default session DID is active (i.e. instead </p>
<p>of expected NRC 0x7F, 0x31 will be sent). The advantage is that the ECU will have a </p>
<p>constant behavior independent of the active variant and will send the same NRC as in </p>
<p>the variant with the DID readable in the default session.  </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>205 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.18.2 </b></p>
<p><b>Initialization </b></p>
<p>All post-build variants have in common that DCM must be first correctly initialized with the </p>
<p>concrete variant. Thus, the variant switching is only possible at run time during the module </p>
<p>initialization  phase.  For  that  purpose  the  DCM API <i> Dcm_Init() </i> has  to  be  called  with  the </p>
<p>appropriate configuration root pointer. Please refer to the API description for more details. </p>
<p> </p>
<p>The  configuration  pointer  is  passed  by  the  MICROSAR  EcuM  based  on  the  post-build </p>
<p>configuration.  If  no  MICROSAR  EcuM  is  used,  the  procedure  of  how  to  find  the  proper </p>
<p>initialization pointers is out of scope of this document. </p>
<p> </p>
<p><b>9.18.2.1 </b></p>
<p><b>Error Detection and Handling </b></p>
<p>The DCM will verify the configuration data before accepting it to initialize the module. If this </p>
<p>verification fails, an EcuM error hook (<i>EcuM_BswErrorHook</i>) is called with an error code </p>
<p>according to <i>Table 9-8. </i></p>
<p><b>Error Code </b></p>
<p><b>Reason </b></p>
<p>ECUM_BSWERROR_NULLPTR </p>
<p>Initialization with a null pointer. </p>
<p>ECUM_BSWERROR_MAGICNUMBER </p>
<p>Magic pattern check failed. This pattern is </p>
<p>appended at the end of the initialization root </p>
<p>structure. An error here is a strong indication of </p>
<p>random data, or a major incompatibility </p>
<p>between the code and the configuration data. </p>
<p>ECUM_BSWERROR_COMPATIBILITYVERSION </p>
<p>The configuration data was created by an </p>
<p>incompatible generator. This is also tested by </p>
<p>verification of a ‘magic’ pattern, so initialization </p>
<p>with random data can also cause this error </p>
<p>code.  </p>
<p>Table 9-8  </p>
<p>Error Codes possible during Post-Build initialization failure </p>
<p>If no MICROSAR EcuM is used, this error hooks and the error code constants have to be </p>
<p>provided by the environment. The DCM performs the following verification steps: </p>
<p>1. </p>
<p>If the pointer equals NULL_PTR, initialization is rejected. </p>
<p>2. </p>
<p>If the initialization structure does not end with the correct magic number it is rejected. </p>
<p>3. </p>
<p>If the initialization structure was created by an incompatible generator version it is </p>
<p>rejected (starting magic number check) </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>The verification steps performed during initialization are neither intended nor sufficient </p>
<p>to detect corrupted configuration data. They are intended only to detect initialization </p>
<p>with a random pointer, and to reject data created by an incompatible generator version. </p>
<p><b> </b></p>
<p><b> </b></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>206 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.18.3 </b></p>
<p><b>Post-build Variants </b></p>
<p><b>9.18.3.1 </b></p>
<p><b>Post-build selectable </b></p>
<p>The MICROSAR Identity Manager (refer to <i>[10]</i>) is an implementation of the AUTOSAR 4 </p>
<p>post-build  selectable  concept.  It  allows  the  ECU  manufacturer  to  include  several  DCM </p>
<p>configurations  within  one  ECU.  With  post-build  selectable  and  the  Identity  Manager  the </p>
<p>ECU  variants  are  downloaded  within  the ECUs  non-volatile  memory  (e.g.  flash) at  ECU </p>
<p>build  time.  Post-build  selectable  does  not  allow  modification  of  DCM  aspects  after ECU </p>
<p>build time. At the same time, this limitation allows some of the optimization strategies still </p>
<p>to  be  effective  –  DCM  static  code  part  will  be  optimized  for  the  variant  with  maximum </p>
<p>configuration size. </p>
<p> </p>
<p>The variant selection is performed at run time by passing the corresponding configuration </p>
<p>root during the module initialization (refer to chapter <i>9.18.2 Initialization</i>).  </p>
<p> </p>
<p><b>9.18.3.2 </b></p>
<p><b>Post-build loadable </b></p>
<p>All DCM configuration parameters, that are classified to be post-build selectable, also do </p>
<p>support post-build loadable variant. The differences to the post-build-selectable case are </p>
<p>listed upon their qualification: </p>
<p><b>&gt; </b></p>
<p>advantages:  </p>
<p><b>&gt; </b></p>
<p>The module’s configuration can be updated after the module’s compile time without </p>
<p>reprogramming the whole ECU software. </p>
<p><b>&gt; </b></p>
<p>disadvantages: </p>
<p><b>&gt; </b></p>
<p>Since all of the affected configuration parameters may change after module’s compile </p>
<p>time, the optimization level of the source code is very low.  </p>
<p><b>&gt; </b></p>
<p>Since no maximum configuration size can be pre-calculated, some scalable RAM </p>
<p>blocks are referred not by a direct linker symbol, but through a pointer. </p>
<p><b>&gt; </b></p>
<p>Only one configuration variant is supported at a time (no variant selection at run time </p>
<p>possible). This disadvantage is avoided if the post-build loadable selectable variant is </p>
<p>chosen instead (refer to chapter <i>9.18.3.3</i>). </p>
<p><b>&gt; </b></p>
<p>Greater risks of passing an invalid pointer during module initialization time. </p>
<p>For details about the post-build loadable feature, please refer to <i>[9]</i>. </p>
<p> </p>
<p><b>9.18.3.3 </b></p>
<p><b>Post-build loadable selectable  </b></p>
<p>This variant actually combines both post-build selectable and loadable variants, allowing a </p>
<p>variant selection at run time and at the same time post-build calibration of parameters. </p>
<p>For  details  on  the  two  mentioned  variants,  please  refer  correspondingly  to  chapters </p>
<p><i>9.18.3.1 </i>and <i>9.18.3.2</i>. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>207 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.18.3.4 </b></p>
<p><b>Post-build deleteable </b></p>
<p>This variant is actually a specific sub-variant of the post-build loadable variants. It allows </p>
<p>deleting of containers that were created at link time, by guaranteeing at the same time the </p>
<p>preservation of other post-build capable parameters’ values. For details about this feature, </p>
<p>refer to the <i>[9]</i>. </p>
<p> </p>
<p><b>9.19 </b></p>
<p><b>Handling with DID Ranges </b></p>
<p><b>9.19.1 </b></p>
<p><b>Introduction </b></p>
<p>The  DIDs  in  DCM  are  usually  configured  in  detail:  for  a  concrete  DID  number,  it  is </p>
<p>specified the data access type (read, write, etc.), number of data signals the DID contains, </p>
<p>etc. For each data signal it is exactly configured the maximum/concrete length and type of </p>
<p>data acquisition (i.e. RTE C/S port, function call, direct NvM interaction, etc.).  </p>
<p>Additionally DCM is able to support a more generic DID access method, using DID ranges. </p>
<p>This method has its advantages and disadvantages: </p>
<p>Advantages: </p>
<p><b></b></p>
<p><b> </b></p>
<p>You can implement only one service port/function that covers a large group of DIDs </p>
<p>with a similar data access method. </p>
<p>Disadvantages: </p>
<p><b></b></p>
<p><b> </b></p>
<p>Only read and write operations are allowed when using DID ranges. No IO-control or </p>
<p>scaling information reading is possible. </p>
<p> </p>
<p><b>9.19.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>Current AR DCM SWS (<i>[1]</i>) defines DID range interaction with the application in such a </p>
<p>way that some restrictions must be considered when configuring a DID range. </p>
<p><b></b></p>
<p><b> </b></p>
<p>DID ranges may not be defined for DIDs 0xF300-0xF3FF (dynamically defined DIDs). </p>
<p><b></b></p>
<p><b> </b></p>
<p>DID ranges may not be defined for DIDs 0xF400-0xF8FF (OBD/ WWH-OBD DIDs), </p>
<p>when DCM shall handle these on its own. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If a DID from a DID range shall be included in a dynamically defined DID, the </p>
<p>requested <i>DynamicallyDefineDataIdentifier ($2C) </i>service will validate the source </p>
<p>position and size parameters only upon the configured DID range maximum possible </p>
<p>length (<i>9.19.3 Configuration Aspects</i>). Hence, when the actual length of the DID from </p>
<p>this range is smaller than the maximum length and the stored source position and size </p>
<p>do not match the actual length, the reported data will be fully or partially invalid. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If a DID from a DID range is used in a multi DID request for service </p>
<p><i>ReadDataByIdentifier ($22)</i>, in order to protect the ECU from out of boundary access </p>
<p>during reading each, DCM will consider at first its maximum length for the total </p>
<p>response length. Later, the application will return the concrete length during reading </p>
<p>DID-Range data, so the positive response will always have the correct length. The only </p>
<p>negative effect is that DCM may reject requests with multiple DIDs that would actually </p>
<p>fit the configured buffer. So choosing values for the maximum DID range length, nearly </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>208 </p>
<p>based on template version 5.0.0 </p>
<p>equal the size of the diagnostic buffer will mostly fail a multi DID request with a DID </p>
<p>range DID. To avoid such situations, please consider the following guideline: </p>
<p><b></b></p>
<p><b> </b></p>
<p>Use DID ranges for DIDs that have nearly the same size, which is represented by the </p>
<p>maximum length parameter. </p>
<p><b></b></p>
<p><b> </b></p>
<p>If not possible to group the DID in the way shown above, try splitting large ranges into </p>
<p>smaller ones in order to have less differences between the shortest and longest DID </p>
<p>of a range. </p>
<p><b></b></p>
<p><b> </b></p>
<p>Try grouping short DIDs within ranges. If the maximum length of a DID range is far </p>
<p>smaller than the diagnostic buffer, then the multiple DID request limitation will no </p>
<p>longer persist. The best proportion is:  </p>
<p> </p>
<p>DCMBufferSize &gt;= DcmDspMaxDidToRead * DcmDspDidRangeMaxDataLength </p>
<p><b></b></p>
<p><b> </b></p>
<p>The DID range response length calculation limits also the usage of the paged DIDs </p>
<p>(<i>9.24 How to Save RAM using Paged-Buffer for Large DIDs</i>). </p>
<p><b></b></p>
<p><b> </b></p>
<p>Since DID ranges support read operation, they may be used for periodic reading, but </p>
<p>then the maximum length may not exceed 7 bytes (CAN UUDT reference length). </p>
<p> </p>
<p><b>9.19.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>If a DID ranges is readable or/and writeable the corresponding UDS services shall be </p>
<p>defined in the configuration tool. Refer to <i>ReadDataByIdentifier ($22) </i>and </p>
<p><i>WriteDataByIdentifier ($2E) </i>for more information about their configuration aspects. </p>
<p><b>&gt; </b></p>
<p>Whether a DID range has read or/and write operation, is to be determined via a </p>
<p>corresponding /Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo container (referenced by </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidRange/DcmDspDidRangeInfoRef  </p>
<p>Refer to the concrete DID range configuration parameter online help in the configuration </p>
<p>tool for more details about the effect of the parameter value, dependencies to other </p>
<p>configuration parameters or any specific restrictions. </p>
<p><b>9.20 </b></p>
<p><b>How to Support DID 0xF186 </b></p>
<p>The ActiveDiagnosticSessionDataIdentifier (0xF186) is used to report the active diagnostic </p>
<p>session within the DCM. If you want DCM to implement the read access to its data, please </p>
<p>follow the configuration steps below: </p>
<p> </p>
<p><b>&gt; </b></p>
<p>A DID shall be defined within the following container: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid </p>
<p><b>&gt; </b></p>
<p>Set the identifier of  that DID to 0xF186: </p>
<p>/DcmConfigSet/DcmDsp/DcmDspDid/DcmDspDidIdentifier </p>
<p><b>&gt; </b></p>
<p>Define a read operation for that DID: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidAccess/DcmDspDidRead </p>
<p><b>&gt; </b></p>
<p>The read function should have the name “Dcm_DidMgr_F186_ReadData”: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataReadFnc </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>209 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>Select the value USE_DATA_SYNCH_FNC for the following container: </p>
<p>/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataUsePort </p>
<p><b>&gt; </b></p>
<p>Because only one data byte has to be read the data size should be configured to 8 bit: </p>
<p>/DcmDsp/DcmDspData/DcmDspDataSize </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>Since this is just a regular DID, that can be used in arbitrary manner, the following has </p>
<p>to be considered if other options related to this DID are set: </p>
<p><b>&gt; </b></p>
<p>The DID may have also other data signals. If one of them fulfills to the above </p>
<p>conditions, you can still use the DCM’s internal implementation for reporting current </p>
<p>session ID. </p>
<p><b>&gt; </b></p>
<p>If the DID shall support any other operation than only read (e.g. write), then for the </p>
<p>data signal, that will use the DCM’s internal implementation, the write operation </p>
<p>must be implemented by the application.  </p>
<p><b>&gt; </b></p>
<p>An example for a write functionality: Since DCM does not provide an API for </p>
<p>entering a non-Default session, the only effect such a write function may have is </p>
<p>to put DCM into the default session (refer to <i>Dcm_ResetToDefaultSession()</i>) </p>
<p>when the requested value is 0x01. All other values shall be rejected by NRC </p>
<p>0x31. </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>9.21 </b></p>
<p><b>How to Suppress Responses to Functional Addressed Requests </b></p>
<p>Sometimes it may be necessary on a specific connection to suppress all kind of responses </p>
<p>(positive  or  negative)  on  functional  addressed  service  requests.  This  feature  will  be </p>
<p>automatically activated when Mixed11 addressing (applies to CanTP only) is configured for </p>
<p>that  connection.  To  achieve  this,  the  following  addressing  type  parameter  has  to  be </p>
<p>configured to “DCM_NET_ADDR_MIXED_11”: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmDslConnection/Dc</p>
<p>mDslMainConnection/DcmDslAddressingType </p>
<p> </p>
<p><b>9.22 </b></p>
<p><b>How to Support Interruption on Requests with Foreign N_TA </b></p>
<p>The DCM supports service processing interruption when a request from the same client to </p>
<p>another ECU is detected. This feature is only available for Mixed11 addressing CanTp and </p>
<p>is automatically activated when Mixed11 addressing is configured for that connection. </p>
<p>The addressing type parameter of a connection can be configured here: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmDslConnection/Dc</p>
<p>mDslMainConnection/DcmDslAddressingType </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>210 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.23 </b></p>
<p><b>How to Know When the Diagnostic Session Changes </b></p>
<p>There are situations where the ECU shall cancel all by the tester activated functions, when </p>
<p>the diagnostic session changes. In some cases the DCM is able to handle this internally:  </p>
<p><b>&gt; </b></p>
<p><i>ReadDataByPeriodicIdentifier ($2A) </i></p>
<p><b>&gt; </b></p>
<p><i>DynamicallyDefineDataIdentifier ($2C) </i></p>
<p><b>&gt; </b></p>
<p><i>CommunicationControl ($28) </i></p>
<p><b>&gt; </b></p>
<p><i>ControlDTCSetting ($85) </i></p>
<p> </p>
<p>For other diagnostic services, such as  </p>
<p><b>&gt; </b></p>
<p><i>InputOutputControlByIdentifier ($2F) </i>(will be automatically reset by DCM only on  </p>
<p>(re-)entering default session) </p>
<p><b>&gt; </b></p>
<p><i>RoutineControl ($31) </i></p>
<p>this task has to be performed by the application. For that purpose, DCM already notifies </p>
<p>the </p>
<p>application </p>
<p>by </p>
<p>invoking </p>
<p>a </p>
<p>mode </p>
<p>switch </p>
<p>for </p>
<p>the </p>
<p>mode </p>
<p>declaration </p>
<p>group </p>
<p><i>DcmDiagnosticSessionControl</i>. </p>
<p>Additionally for better DCM integration flexibility, there is also another way an application </p>
<p>located in a CDD can be notified – by a simple function call. </p>
<p>Whether  the  DCM  shall  notify  about  diagnostic  session  changes  using  simple  function </p>
<p>calls, you can specify by using configuration containers:  </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSession/DcmDspSessionCallback </p>
<p>For each callback you need, a dedicated container of the above type shall be configured </p>
<p>for DCM. The parameter </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSession/DcmDspSessionCallback/DcmDspSession</p>
<p>CallbackFnc will specify the function you want to be called by DCM. All these functions will </p>
<p>have the prototype defined in chapter <i>6.5.1.8 &lt;Diagnostic Session Change Notification </i></p>
<p><i>Callback&gt;</i>. </p>
<p> </p>
<p><b>9.24 </b></p>
<p><b>How to Save RAM using Paged-Buffer for Large DIDs </b></p>
<p><b>9.24.1 </b></p>
<p><b>Introduction </b></p>
<p>According  to  all up  to  now  released AUTOSAR DCM  SWS documents, the  only  service </p>
<p>that supports paged-data reading is service <i>ReadDiagnosticInformation ($19)</i>. </p>
<p>For  any  other  data  access  services,  i.e.  service  0x22  (ReadDataByIdentifier),  it  is  not </p>
<p>possible to implement paged-buffer reading, without the need of fulfilling a lot of conditions </p>
<p>and accepting implementation drawbacks and unnecessary risks.  </p>
<p> </p>
<p>So if a large amount (measured in hundreds of bytes or even some kilobytes) of data has </p>
<p>to be carried out from the ECU, the DCM shall have at least one buffer that can handle the </p>
<p>entire  DID  data.  To  avoid  this  in  most  cases  unnecessarily  RAM  resource  waste,  the </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>211 </p>
<p>based on template version 5.0.0 </p>
<p>MICROSAR  DCM  offers  a  concept  for  paged-data  reading,  described  in  details  further </p>
<p>below. </p>
<p> </p>
<p><b>9.24.2 </b></p>
<p><b>Functionality </b></p>
<p>In order to provide a user-friendly method for getting data from the application using the </p>
<p>paged-buffer concept, a non-AUTOSAR extension of the already available DataServices </p>
<p>client-server port interface is required: <i>ReadData() (paged-data-reading)</i>. </p>
<p> </p>
<p>The advantage of this concept is the great flexibility it offers: </p>
<p><b>&gt; </b></p>
<p>The application has full control of how many bytes to be transferred and for simple </p>
<p>“memory copy only” implementations will be able to optimally fill up the response </p>
<p>transmission buffer. </p>
<p><b>&gt; </b></p>
<p>Only a single function has to be implemented, that handles the complete data transfer.  </p>
<p><b>&gt; </b></p>
<p>The imported diagnostic description ODX/CDD will not be affected by these changes, </p>
<p>since the ECU project implementer just chooses the kind of the data access, such as it </p>
<p>could be made for direct access to NvM signals. </p>
<p><b>&gt; </b></p>
<p>If the diagnostic description defines a DID with multiple large signals, for example </p>
<p>four signals with 1000Byte each, for all those signals the new access type can be </p>
<p>used and the DCM can still have a small diagnostic buffer. </p>
<p><b>&gt; </b></p>
<p>The concept is not defined by AUTOSAR but fits the AUTOSAR conventions.  </p>
<p><b>&gt; </b></p>
<p>Either RTE C/S port or a callback to a complex device driver can be used. </p>
<p><b>&gt; </b></p>
<p>All DID related ECUC parameters are re-used as long as they are applicable for that </p>
<p>concept. </p>
<p> </p>
<p>There  are  also  some  possible  drawbacks  that  have  to  be  considered  when  paged-DID </p>
<p>reading feature is activated: </p>
<p>Reading data using the paged-buffer access, could lead to some unwanted effects: </p>
<p><b>&gt; </b></p>
<p>Sudden transmission interruptions for multiple DID requests on SID 0x22. </p>
<p><b>&gt; </b></p>
<p>If the application generally has slow data access, then up to now, without the paged-</p>
<p>data access, it had only caused some RCR-RP responses on the bus. With paged-</p>
<p>buffer enabled read data access, a slow data provision could lead to transmission </p>
<p>abortion by the TP if the N_as/N_cs are significantly shorter than the application data </p>
<p>provision rate. </p>
<p><b>&gt; </b></p>
<p>Limiting the maximum number of DIDs per service 0x22 request to one will avoid </p>
<p>such interruptions, but may also lead to a major deviation from the OEM diagnostic </p>
<p>requirements. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>212 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.24.3 </b></p>
<p><b>Implementation Limitations </b></p>
<p>When paged-data access of a DID is intended to be used, there are still some limitations </p>
<p>that have to be considered: </p>
<p> </p>
<p><b>&gt; </b></p>
<p>A DID, whose data shall be read via paged-data access, shall only support read </p>
<p>operation. No paged-data access for writing or I/O control is possible. So only service </p>
<p>0x22 (ReadDataByIdentifier) may use it.  </p>
<p><b>&gt; </b></p>
<p>For DIDs, accessible via service 0x2A (ReadDataByPeriodicIdentifier), paged-data </p>
<p>access shall not be used.  </p>
<p><b>&gt; </b></p>
<p>Since those DIDs (0xF200-0xF2FF) are limited to only 7 bytes of data (on CAN) it </p>
<p>makes also no real sense to apply this concept. </p>
<p><b>&gt; </b></p>
<p>Paged-data access cannot be used for DIDRanges (see <i>9.19 Handling with DID </i></p>
<p><i>Ranges</i>).  </p>
<p><b>&gt; </b></p>
<p>The support of DIDRanges and the paged-data access DIDs lead to contradictory </p>
<p>concepts regarding the design of service 0x22 processor:  </p>
<p><b>&gt; </b></p>
<p>For paged-data access DID, the length of the DID shall be known prior reading the </p>
<p>data and starting the positive response transmission. </p>
<p><b>&gt; </b></p>
<p>For DIDRanges due to a lack of appropriate interfaces, the response data length is </p>
<p>first known to DCM after the data reading has finished. </p>
<p>Thus, it is not possible to have both DIDRanges and paged-data access DID within </p>
<p>the same DCM configuration.  </p>
<p><b>&gt; </b></p>
<p>Service 0x2C (DynamicallyDefineDataIdentifier) shall not be supported in DCM </p>
<p>configurations with paged-data access DID. </p>
<p> </p>
<p><b>9.24.4 </b></p>
<p><b>Usage </b></p>
<p>From application point of view, paged-data reading concept using the new DataServices </p>
<p>port  operation  does  not </p>
<p>differ  very  much  from  the  AUTOSAR </p>
<p>data  reading  via </p>
<p>an </p>
<p>asynchronous port interface.  </p>
<p>Any single return value of the new <i>ReadData() (paged-data-reading) </i>is described in details </p>
<p>within its API description table.  </p>
<p>For simplification reasons the following pictures show the DCM to application flow reading </p>
<p>a single DID, consisting of a single data signal, that provides its content via paged-data </p>
<p>access.  The <i> ReadDataLength() </i> usage  in  the  example  is  only  to  show  that  paged-DID </p>
<p>signals can also have dynamic length. </p>
<p>The following scenarios are covered below: </p>
<p><b></b></p>
<p><b> </b></p>
<p><i>Straightforward DID Paged-Data Reading </i></p>
<p><b></b></p>
<p><b> </b></p>
<p><i>Error Handling During DID Paged-Data Reading </i></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>213 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.24.4.1 </b></p>
<p><b>Straightforward DID Paged-Data Reading </b></p>
<p> </p>
<p>Figure 9-1 </p>
<p>Straightforward DID paged-data reading </p>
<p> </p>
<p><b>9.24.4.2 </b></p>
<p><b>Error Handling During DID Paged-Data Reading </b></p>
<p>There are certain situations where the paged-data reading can be prematurely aborted: </p>
<p><b> sd DID PagedBuffer Normal Flow</b></p>
<p>Dcm</p>
<p>PagedDid_SERVER</p>
<p>PduR</p>
<p><b>loop CopyAv ilableDataChunk to TP</b></p>
<p>[until a buffer underrun occurs]</p>
<p>Example for source </p>
<p>data temporarily not </p>
<p>available.</p>
<p><b>loop paged data currently not av ailable</b></p>
<p>[until other result than DCM_E_PENDING returned]</p>
<p>Example for the last call where all of the data to be transferred are copied to</p>
<p>DCM.</p>
<p>Note: If the data server returns DCM_E_OK, before reaching the </p>
<p>configured/gathered by ReadDataLength operation DID data length, DCM </p>
<p>will invoke DET and cancel the response transmission due to lack on </p>
<p>diagnostic data.</p>
<p><b>loop copy all left data</b></p>
<p>[until all data is transfered to TP]</p>
<p><b>opt gather current data size</b></p>
<p>[only if the DID data has dynamic length]</p>
<p>Example for data </p>
<p>immediately available </p>
<p>and written into the </p>
<p>paged buffer.</p>
<p>Dcm_TpRxIndication(0x22, PAGED_DID)</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadDataLength(DID length) :Std_ReturnType</p>
<p>:DCM_E_OK</p>
<p>ReadData(DCM_INITIAL, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>CopyData()</p>
<p>:DCM_E_BUFFERTOOLOW</p>
<p>PduR_&lt;User:Up&gt;Transmit(Std_ReturnType, PduIdType, PduInfoType*)</p>
<p>:E_OK</p>
<p>Dcm_CopyTxData(BufReq_ReturnType, PduIdType, PduInfoType*, RetryInfoType*, PduLengthType**)</p>
<p>:BUFREQ_OK</p>
<p>Dcm_CopyTxData(BufReq_ReturnType, PduIdType, PduInfoType*, RetryInfoType*, PduLengthType**)</p>
<p>GetNextData()</p>
<p>:BUFREQ_E_BUSY</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadData(DCM_PENDING, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>:DCM_E_PENDING</p>
<p>Dcm_CopyTxData(BufReq_ReturnType, PduIdType, PduInfoType*, RetryInfoType*, PduLengthType**)</p>
<p>:BUFREQ_E_BUSY</p>
<p>ReadData(DCM_PENDING, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>:DCM_E_OK</p>
<p>Dcm_CopyTxData(BufReq_ReturnType, PduIdType, PduInfoType*, RetryInfoType*, PduLengthType**)</p>
<p>:BUFREQ_OK</p>
<p>Dcm_TpTxConfirmation(E_OK)</p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>214 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>On response transmission abortion initiated by the TP layer caused by: </p>
<p><b>&gt; </b></p>
<p>Too slow data provision by the application, which lead to a N_as/N_cs timeout. </p>
<p><b>&gt; </b></p>
<p>Connection interrupted by the diagnostic client (i.e. no flow-control was sent). </p>
<p><b>&gt; </b></p>
<p>Other communication bus error has enforced the TP to abort the transmission. </p>
<p><b>&gt; </b></p>
<p>On protocol preemption via a higher priority client (e.g. OBD vs. UDS); </p>
<p><b>&gt; </b></p>
<p>On hitting RCR-RP limitation (if configured) caused by: </p>
<p><b>&gt; </b></p>
<p>Too slow data provision by the application (over several seconds or even minutes). </p>
<p><b>&gt; </b></p>
<p>Application deadlock that leads to an inability even to initiate the response </p>
<p>transmission. </p>
<p>The figures below depict these situations and how the application is notified about the job </p>
<p>interruption.  </p>
<p>The common part is: the <i>ReadData() (paged-data-reading) </i>will be always called with </p>
<p>OpStatus = DCM_CANCEL to notify the application that: </p>
<p><b>&gt; </b></p>
<p>it can initialize now any internal states (e.g. releasing semaphores), </p>
<p><b>&gt; </b></p>
<p>this is the last call of this data operation for current diagnostic service processing.  </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>215 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p>Figure 9-2 </p>
<p>DID paged-data reading cancelled due to TP layer transmission abortion </p>
<p> </p>
<p><b> sd DID PagedBuffer Appl Too Slow</b></p>
<p>Dcm</p>
<p>PagedDid_SERVER</p>
<p>PduR</p>
<p><b>loop CopyAv ilableDataChunk to TP</b></p>
<p>[until a buffer underrun occurs]</p>
<p>Example for source </p>
<p>data temporarily not </p>
<p>available.</p>
<p><b>loop paged data currently not av ailable</b></p>
<p>[until other result than DCM_E_PENDING returned]</p>
<p><b>opt gather current data size</b></p>
<p>[only if the DID data has dynamic length]</p>
<p>Example for data </p>
<p>immediately available </p>
<p>and written into the </p>
<p>paged buffer.</p>
<p>Example for TP closing the connection due to a N_as/N_cs </p>
<p>timeout detection - the application was not able to provide </p>
<p>sufficient data within the appropriate time.</p>
<p>Dcm_TpRxIndication(0x22, PAGED_DID)</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadDataLength(DID length) :Std_ReturnType</p>
<p>:DCM_E_OK</p>
<p>ReadData(DCM_INITIAL, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>CopyData()</p>
<p>:DCM_E_BUFFERTOOLOW</p>
<p>PduR_&lt;User:Up&gt;Transmit(Std_ReturnType, PduIdType, PduInfoType*)</p>
<p>:E_OK</p>
<p>Dcm_CopyTxData(BufReq_ReturnType, PduIdType, PduInfoType*, RetryInfoType*, PduLengthType**)</p>
<p>:BUFREQ_OK</p>
<p>Dcm_CopyTxData(BufReq_ReturnType, PduIdType, PduInfoType*, RetryInfoType*, PduLengthType**)</p>
<p>GetNextData()</p>
<p>:BUFREQ_E_BUSY</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadData(DCM_PENDING, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>:DCM_E_PENDING</p>
<p>Dcm_CopyTxData(BufReq_ReturnType, PduIdType, PduInfoType*, RetryInfoType*, PduLengthType**)</p>
<p>:BUFREQ_E_BUSY</p>
<p>Dcm_TpTxConfirmation(E_NOT_OK)</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadData(DCM_CANCEL, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>:Don't Care</p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>216 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p>Figure 9-3 </p>
<p>Protocol preemption during DID paged-data access </p>
<p> </p>
<p><b> sd DID PagedBuffer Premature Job Termination (Protocol Preemption)</b></p>
<p>Dcm</p>
<p>PagedDid_SERVER</p>
<p>PduR</p>
<p><b>loop CopyAv ilableDataChunk to TP</b></p>
<p>[until a buffer underrun occurs]</p>
<p>Example for source </p>
<p>data temporarily not </p>
<p>available.</p>
<p><b>loop paged data currently not av ailable</b></p>
<p>[until other result than DCM_E_PENDING returned]</p>
<p><b>opt gather current data size</b></p>
<p>[only if the DID data has dynamic length]</p>
<p>Example for data </p>
<p>immediately available </p>
<p>and written into the </p>
<p>paged buffer.</p>
<p>Example of a protocol </p>
<p>preemption due to a </p>
<p>higher priority </p>
<p>diagnostic client </p>
<p>request reception. </p>
<p><b>alt Protocol Preemption during reading a paged data</b></p>
<p>[no additional data from application yet needed]</p>
<p>[waiting for additional data from application]</p>
<p>Dcm_TpRxIndication(0x22, PAGED_DID)</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadDataLength(DID length) :Std_ReturnType</p>
<p>:DCM_E_OK</p>
<p>ReadData(DCM_INITIAL, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>CopyData()</p>
<p>:DCM_E_BUFFERTOOLOW</p>
<p>PduR_&lt;User:Up&gt;Transmit(Std_ReturnType, PduIdType, PduInfoType*)</p>
<p>:E_OK</p>
<p>Dcm_CopyTxData(BufReq_ReturnType, PduIdType, PduInfoType*, RetryInfoType*, PduLengthType**)</p>
<p>:BUFREQ_OK</p>
<p>Dcm_CopyTxData(BufReq_ReturnType, PduIdType, PduInfoType*, RetryInfoType*, PduLengthType**)</p>
<p>GetNextData()</p>
<p>:BUFREQ_E_BUSY</p>
<p>Dcm_TpRxIndication(OBD scan tool request)</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadData(DCM_CANCEL, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>:Don't Care</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadData(DCM_PENDING, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>:DCM_E_PENDING</p>
<p>Dcm_CopyTxData(BufReq_ReturnType, PduIdType, PduInfoType*, RetryInfoType*, PduLengthType**)</p>
<p>:BUFREQ_E_BUSY</p>
<p>Dcm_TpRxIndication(OBD scan tool request)</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadData(DCM_CANCEL, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>:Don't Care</p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>217 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p>Figure 9-4 </p>
<p>RCR-RP limit reached during DID paged-data access </p>
<p> </p>
<p><b>9.24.5 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>The DCM parameter </p>
<p>/Dcm/DcmConfigSet/DcmPageBufferCfg/DcmPagedBufferEnabled has no effect on the </p>
<p>paged-data access of a DID. It affects only the paged-buffer support on service 0x19. </p>
<p>In this way both services (0x19 and 0x22) can be independently configured for using </p>
<p>paged-buffer data reading. </p>
<p><b> </b></p>
<p><b> </b></p>
<p>To configure a DID signal for paged-data access, the DCM BSWMD file has to be changed </p>
<p>in the following way: </p>
<p><b> sd DID PagedBuffer Premature Job Termination (RCR-RP limit)</b></p>
<p>Dcm</p>
<p>PagedDid_SERVER</p>
<p>PduR</p>
<p><b>opt gather current data size</b></p>
<p>[only if the DID data has dynamic length]</p>
<p>Example for data </p>
<p>temporarily not </p>
<p>available.</p>
<p><b>loop Application still cannot prov ide any data</b></p>
<p>[(result == DCM_E_PENDING) OR ( RCR-RP limit reached)]</p>
<p><b>opt RCR-RP Transmission</b></p>
<p>[P2/P2Star Timeout]</p>
<p><b>alt Waiting for the v ery first application data</b></p>
<p>[RCR-RP limit not reached]</p>
<p>[RCR-RP limit reached]</p>
<p>Dcm_TpRxIndication(0x22, PAGED_DID)</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadDataLength(DID length) :Std_ReturnType</p>
<p>:DCM_E_OK</p>
<p>ReadData(DCM_INITIAL, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>CopyData()</p>
<p>:DCM_E_PENDING</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadData(DCM_PENDING, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>:DCM_E_PENDING</p>
<p>PduR_&lt;User:Up&gt;Transmit([}x7F 0x22 0x78])</p>
<p>Dcm_MainFunctionWorker()</p>
<p>ReadData(DCM_CANCEL, Data, AvailableBufferSize) :Std_ReturnType</p>
<p>:Don't Care</p>
<p>PduR_&lt;User:Up&gt;Transmit([0x7F 0x22 0x10])</p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>218 </p>
<p>based on template version 5.0.0 </p>
<p>Parameter: /Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataUsePort </p>
<p>was extended by two new values: </p>
<p><b>&gt; </b></p>
<p>USE_PAGED_DATA_ASYNCH_CLIENT_SERVER – for SWC implementations </p>
<p><b>&gt; </b></p>
<p>USE_PAGED_DATA_ASYNCH_FNC – for callouts in ComplexDeviceDrivers. </p>
<p>From the parameters and containers already defined by AUTOSAR the following ones are </p>
<p>only allowed to be used in context of a DID with paged-data access: </p>
<p>On DID level: </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid/DcmDspDidIdentifier </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid/DcmDspDidUsed </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid/DcmDspDidInfoRef </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDidInfo/DcmDspDidAccess/DcmDspDidRead </p>
<p>– with all sub-parameters </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid/DcmDspDidSignal – with all sub-</p>
<p>parameters </p>
<p>On DID Data level: </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataUsePort </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataConditionCheckReadFncUs</p>
<p>ed </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataConditionCheckReadFnc </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataReadFnc </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataSize </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataInfoRef </p>
<p><b>&gt; </b> /Dcm/DcmConfigSet/DcmDsp/DcmDspDataInfo/DcmDspDataFixedLength </p>
<p> </p>
<p><b>9.25 </b></p>
<p><b>How to Get Security-Access Level Specific Fixed Byte Values </b></p>
<p><b>9.25.1 </b></p>
<p><b>Introduction </b></p>
<p>In some ECU projects it is desired, that the some or all security-access level calculation </p>
<p>algorithm shall use additional, level specific fixed bytes set to provide better flexibility and </p>
<p>higher  security  protection.  The  latter  is  guaranteed  by  the  split  knowledge  between </p>
<p>provided implementation and project specific concrete values calculation.  </p>
<p>Additionally, the diagnostic clients shall know these fixed bytes values, so in  such cases </p>
<p>these values are located within the diagnostic data exchange document (ODX/CANdela) </p>
<p>imported by the system supplier into the MICROSAR DCM configuration. In that way, both </p>
<p>diagnostic client and server (ECU) have always the correct values. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>219 </p>
<p>based on template version 5.0.0 </p>
<p>To </p>
<p>achieve </p>
<p>this </p>
<p>goal, </p>
<p>MICROSAR </p>
<p>DCM </p>
<p>extends </p>
<p>the </p>
<p>AR </p>
<p>DCM </p>
<p>standard </p>
<p>ECUC </p>
<p>configuration model by a new set of parameters (refer to the <i> Configuration Aspects</i>), as </p>
<p>well as a new provided port operation <i>Dcm_GetSecurityLevelFixedBytes()</i>. </p>
<p> </p>
<p><b>9.25.2 </b></p>
<p><b>Usage </b></p>
<p>Once  the  fixed  bytes  are </p>
<p>specified  for  the  corresponding  security  levels,  the </p>
<p>DCM </p>
<p>application implementer has the opportunity to access them within its  software, by using </p>
<p>the newly introduced provided port operation <i>Dcm_GetSecurityLevelFixedBytes()</i>. </p>
<p> </p>
<p><b>9.25.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p>If  a  security  level  shall  provide  a  fixed  bytes  set  to  the  application,  then  the  following </p>
<p>container shall exist: </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecurityRow/DcmDspSecurity</p>
<p>FixedBytes </p>
<p>For each fixed byte value, belonging to the set, an instance of the parameter below shall </p>
<p>be specified: </p>
<p><b>&gt; </b></p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspSecurity/DcmDspSecurityRow/DcmDspSecurity</p>
<p>FixedBytes/DcmDspSecurityFixedByteValue </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>For the fixed bytes sets definition, the following rules do apply: </p>
<p>- </p>
<p>It is allowed to define fixed byte sets only for some security-access levels; </p>
<p>- </p>
<p>It is allowed to have security-access level specific set size (e.g. one level with 5 </p>
<p>bytes, another with 15); </p>
<p>- </p>
<p>The order of creation of each byte value parameter within a set must be the </p>
<p>same as the expected order of the values to be reported later to the application. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>9.26 </b></p>
<p><b>How to Extend the Diag Keep Alive Time during Diagnostics </b></p>
<p><b>9.26.1 </b></p>
<p><b>Problem Description </b></p>
<p>Per  specification  (<i>see  [1]</i>)  DCM  shall  keep  the  ECU  alive  (awaken)  for  a  diagnostics </p>
<p>reason under following circumstences: </p>
<p><b>&gt; </b></p>
<p>While in the default diagnostic session: as long as there is a diagnostic service in </p>
<p>processing. </p>
<p><b>&gt; </b></p>
<p>While in a non-default session: as long as the DCM has not entered the default </p>
<p>session again. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>220 </p>
<p>based on template version 5.0.0 </p>
<p>In some projects it is required that the ECU shall be kept alive for a certain time period </p>
<p>after the processing of a diagnostic request is finished. This leads to changes in the above </p>
<p>listed situations as follows: </p>
<p>DCM will keep the ECU alive for a diagnostic reason when: </p>
<p><b>&gt; </b></p>
<p>While in the default diagnostic session:  </p>
<p><b>&gt; </b></p>
<p>as long as there is a diagnostic service in processing  </p>
<p><b>&gt; </b></p>
<p><b>OR </b>for the time period after the service processing is accomplished until the </p>
<p>configured keep-alive time elapses. </p>
<p><b>&gt; </b></p>
<p>While in a non-default session:  </p>
<p><b>&gt; </b></p>
<p>as long as the DCM has not entered the default session again </p>
<p><b>&gt; </b></p>
<p><b>OR </b>as long as the running keep-alive timer is active. This condition is of course only </p>
<p>applicable if the keep-alive time is configured to a value greater than the S3 time (set </p>
<p>to 5000ms) since the keep-alive timer and the S3 timer are startet at the same time. </p>
<p> </p>
<p><b>9.26.2 </b></p>
<p><b>Configuration Aspects </b></p>
<p>If such an extended time period for keep ECU alive is required, then please set up DCM in </p>
<p>the configuration tool by specifying the keep-alive time in parameter: </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmKeepAliveTime </p>
<p><b>9.27 </b></p>
<p><b>How to Recover DCM State Context on ECU Reset/ Power On </b></p>
<p><b>9.27.1 </b></p>
<p><b>Introduction </b></p>
<p>There  are  situations,  where  the  ECU  shall  perform  reset/power  shutdown,  but  without </p>
<p>losing some DCM internal states. Such states are for example: </p>
<p><b>&gt; </b></p>
<p>Active diagnostic session; </p>
<p><b>&gt; </b></p>
<p>Active security access level (if applicable); </p>
<p><b>&gt; </b></p>
<p>The already managed communication control states (if applicable); </p>
<p><b>&gt; </b></p>
<p>Active state of control DTC setting (if applicable); </p>
<p><b>&gt; </b></p>
<p>Active state of any managed by DCM communication channel (DiagActive state) </p>
<p>Since this is not a feature supported by the AR standard per definition it was implemented </p>
<p>in DCM for optional use only (refer to the configuration chapter below). </p>
<p> </p>
<p><b>9.27.2 </b></p>
<p><b>Functionality </b></p>
<p>In order to support the state context recovery, DCM has been extended by two new APIs </p>
<p>for providing the data to be recovered on demand (<i>Dcm_ProvideRecoveryStates()) </i>and to </p>
<p>retrieve this data back on each reset /power on phase (<i>Dcm_GetRecoveryStates()</i>).  </p>
<p>The data to be transferred is stored in the structure <i>Dcm_RecoveryInfoType</i>. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>221 </p>
<p>based on template version 5.0.0 </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>Please do always use both API to store and restore the context information. Only </p>
<p>compatible versions of this data shall be used. Since the transferred data primarily </p>
<p>consists of DCM internal data representation, it shall not be passed to DCM except if it </p>
<p>was retrieved via the <i>Dcm_ProvideRecoveryStates() </i>API call. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>On any state change (recovery data with default state does not have any effect), DCM will </p>
<p>execute all notifications and actions related to that state transition. Due to this, DCM </p>
<p>always executes the recovery process in the best applicable order for dependent states. </p>
<p>For example: </p>
<p><b>&gt; </b></p>
<p>If security access and session change have to be switched, then first the session </p>
<p>change will apply then the security access level in order not to reset the security level </p>
<p>during the session transition. </p>
<p><b>&gt; </b></p>
<p>If ControlDTCSetting shall be disabled and CommunicationControl shall apply too, </p>
<p>then first the DTC setting will be disabled, and then the communication channels will </p>
<p>change their states in order to avoid any unnecessary fault memory entries. </p>
<p> </p>
<p><b>9.27.3 </b></p>
<p><b>Configuration Aspect </b></p>
<p>If  the  recovery  state  feature  is  required  for  your  project,  please  change  the  following </p>
<p>parameter as described in its online help: </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmStateRecoveryAfterResetEnabled </p>
<p> </p>
<p><b>9.28 </b></p>
<p><b>How to Define a Diagnostic Connection without USDT Responses  </b></p>
<p>Sometimes it may be necessary on a specific connection to suppress all kind of responses </p>
<p>(positive  or  negative)  in  general.  In  order  to  configure  such  a  connection,  you  have  to </p>
<p>delete the following sub-container of it: </p>
<p>/Dcm/DcmConfigSet/DcmDsl/DcmDslProtocol/DcmDslProtocolRow/DcmDslConnection/Dc</p>
<p>mDslMainConnection/DcmDslProtocolTx </p>
<p> </p>
<p><b>9.29 </b></p>
<p><b>How to Handle Multiple Diagnostic Service Variants </b></p>
<p><b>9.29.1 </b></p>
<p><b>Introduction </b></p>
<p>DCM  provides  a  means  to  execute  filtering  process  on  incoming  requests  at  service, </p>
<p>subservice, DID, RID, and DID operation level. For example, if a specific DID is configured </p>
<p>in ECUC to be available for read and write purposes, the user is capable of using DCM </p>
<p>tools to update the configuration at run-time and to make the DID available only for read </p>
<p>purposes. So when a request comes with writing in that specific DID, the request will be </p>
<p>rejected accordingly. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>222 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.29.2 </b></p>
<p><b>Filtering Level Availability and the Corresponding Filtering Tools </b></p>
<p>In the following two tables, namely, <i>Table 9-9 </i>and <i>Table 9-10</i>, the filtering options available </p>
<p>for each service are illustrated along with the corresponding filtering tools.  </p>
<p> </p>
<p><b>Service </b></p>
<p> </p>
<p> </p>
<p> </p>
<p><b>Filtering Level </b></p>
<p>[All] </p>
<p>[0x22, 0x2A, </p>
<p>0x24, 0x2C, 0x2E, </p>
<p>&amp; 0x2F] </p>
<p>[0x31] </p>
<p>[0x23 &amp; 0x3D] </p>
<p>[0x01 &amp; 0x02] </p>
<p>[0x06] </p>
<p>[0x08] </p>
<p>[0x09] </p>
<p>Service </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>Sub-service (Sub-function) </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DID </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DID Operation </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>RID </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>RID Operation </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>Memory </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>Memory Operation </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>PID </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>MID </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>TID </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>VID </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>Table 9-9  </p>
<p>Filtering level availability </p>
<p>In order to get an advantage of DCM extended filtering tools, the extended filtering feature </p>
<p>has </p>
<p>to </p>
<p>be </p>
<p>activated </p>
<p>in </p>
<p>the </p>
<p>configuration </p>
<p>tools. </p>
<p>Refer </p>
<p>to </p>
<p><i>Table </i></p>
<p><i>9-10 </i></p>
<p>under </p>
<p>column </p>
<p>“Configuration Aspects<i>” </i>for more details. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>223 </p>
<p>based on template version 5.0.0 </p>
<p><b>Filtered Diagnostic </b></p>
<p><b>Object </b></p>
<p><b>Filtering API / Callback </b></p>
<p><b>Configuration Aspects </b></p>
<p>Service,  </p>
<p>Sub-service (Sub-</p>
<p>function) </p>
<p>Refer to: <i>6.6.1.2.4 </i></p>
<p><i>ServiceRequestManufacturerNotific</i></p>
<p><i>ation_&lt;SWC&gt; </i></p>
<p>&lt;Operation&gt; = <i>Indication() </i></p>
<p>Refer to: <i>9.6 How to Get Notified on a </i></p>
<p><i>Diagnostic Service Execution Start </i></p>
<p><i>and End </i></p>
<p>DID, DID Operation </p>
<p>Refer to: </p>
<p><i>Dcm_FilterDidLookUpResult </i></p>
<p><b>/</b>Dcm/DcmConfigSet/DcmDsp/ </p>
<p>DcmDspDidLookUpFilterEnabled </p>
<p>RID </p>
<p>Refer to: </p>
<p><i>Dcm_FilterRidLookUpResult </i></p>
<p>/Dcm/DcmConfigSet/DcmDsp/ </p>
<p>DcmDspRidLookUpFilterEnabled </p>
<p>RID Operation </p>
<p>Refer to: <i>6.6.1.2.4 </i></p>
<p><i>ServiceRequestManufacturerNotific</i></p>
<p><i>ation_&lt;SWC&gt; </i></p>
<p>&lt;Operation&gt; = <i>Indication() </i></p>
<p>Refer to: <i>9.6 How to Get Notified on a </i></p>
<p><i>Diagnostic Service Execution Start </i></p>
<p><i>and End </i></p>
<p>Memory, Memory </p>
<p>Operation </p>
<p>Refer to: <i>6.6.1.2.4 </i></p>
<p><i>ServiceRequestManufacturerNotific</i></p>
<p><i>ation_&lt;SWC&gt; </i></p>
<p>&lt;Operation&gt; = <i>Indication() </i></p>
<p>Refer to: <i>9.6 How to Get Notified on a </i></p>
<p><i>Diagnostic Service Execution Start </i></p>
<p><i>and End </i></p>
<p>PID </p>
<p>Refer to: </p>
<p><i>9.29.3 Filtering OBD Objects </i></p>
<p>Refer to: </p>
<p><i>9.29.3 Filtering OBD Objects </i></p>
<p>MID </p>
<p>TID </p>
<p>VID </p>
<p>Table 9-10  </p>
<p>Filter diagnostic objects and the corresponding filtering APIs / Callbacks </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>The filtering process is executed on already defined objects in the compile-time. The </p>
<p>filtering  process  requires  interference  from  the  application.  It  is  not  possible  that  the </p>
<p>application enables features via the filtering process in the run-time that is disabled in </p>
<p>the first place in the compile-time. In case of OBD2, the application risks upon violation </p>
<p>this rule a wrong reported “AvailabilityID” masks by DCM.  </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>9.29.3 </b></p>
<p><b>Filtering OBD Objects </b></p>
<p>In order to filter OBD objects and at the same time to report the appropriate “AvailabilityID” </p>
<p>values in the most efficient way, the variant handling on OBD related objects is based on </p>
<p>the feature <i>Calibration of Supported OBD Parameter Identifier </i>(refer to chapter <i>9.11.1.2 )</i>. </p>
<p>Since the “calibration” in this case is performed on-board, the calibratable data specified in </p>
<p>the reference chapter shall be located in the <b>volatile memory (RAM)</b>. To change the </p>
<p>calibration data memory location, please use the following parameter:  </p>
<p>/Dcm/DcmConfigSet/DcmGeneral/DcmCalibrationOfObdIdsMemoryType </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>224 </p>
<p>based on template version 5.0.0 </p>
<p>The concept requires that the application initializes the calibration data at every ECU </p>
<p>power-on/reset, prior the call of the <i>Dcm_Init() </i>function. For that purpose it is advisable for </p>
<p>the application to keep prepared sets of the calibration data for each variant in its non-</p>
<p>volatile memory and just copy it into the DCM volatile memory variant.  </p>
<p> </p>
<p><b>9.29.3.1 </b></p>
<p><b>Suggested Preparation Methodology for Filtering Process of OBD Objects  </b></p>
<p>In order to get a consistent content of these tables in the fastest way, we suggest you to </p>
<p>follow the steps below: </p>
<p><b></b></p>
<p><b> </b></p>
<p>Create configurations (ECUC) files with Configurator 5 for each variant you need. You </p>
<p>will need only the configuration part of DCM, and only few mandatory BSWs which </p>
<p>DCM refers to. These references will not be from importance for the purpose of </p>
<p>multiple-variant-handling, so they don’t need to be maintained in future. </p>
<p><b></b></p>
<p><b> </b></p>
<p>Generate DCM configuration (Dcm_Lcfg.c/.h) for each of those variants.  </p>
<p><b></b></p>
<p><b> </b></p>
<p>Copy the generated tables described in <i>Table 9-3  Calibrateable OBD “availability </i></p>
<p><i>parameter identifier” values </i>which exist in Dcm_Lcfg.c to your application. </p>
<p><b></b></p>
<p><b> </b></p>
<p>Rename the above copied tables according to the variant they belong to for better </p>
<p>identification at the use time.  </p>
<p><b></b></p>
<p><b> </b></p>
<p>If one variant includes one of the above mentioned tables to be copied while the other </p>
<p>does not (OBD service is disabled), make sure to add this table to your configuration </p>
<p>anyway with zero entries. </p>
<p> </p>
<p><b>9.30 </b></p>
<p><b>How to Switch Between OBD DTR Support by DCM and DEM </b></p>
<p>Starting with AR version 4.1.1 DCM shall implement OBD MIDTID data retrieval for service </p>
<p><i>RequestOnBoardMonitorTestResults  ($06) </i> not  directly  from  the  application,  but  via  a </p>
<p>dedicated DEM API. Still, DCM provides a backward compatibility mode and if configured </p>
<p>accordingly, it will handle the DTR values as before.  Reading the following chapters you </p>
<p>will learn more about the impacts the new DTR value reporting implementation may have </p>
<p>on  your  project.  Then,  if  any  choice  is  possible,  you  can  decide  which  method  you  will </p>
<p>prefer to use. </p>
<p>  </p>
<p><b>9.30.1 </b></p>
<p><b>Implementation Particularities and Limitations </b></p>
<p>Once  DCM  is  configured  to  provide  DTR  handling  via  DEM,  any  already  available  MID </p>
<p>resp. </p>
<p>MIDTID </p>
<p>and </p>
<p>MID </p>
<p>DID </p>
<p>(0xF6XX) </p>
<p>in </p>
<p>its </p>
<p>configuration </p>
<p>will </p>
<p>be </p>
<p>discarded. </p>
<p>The </p>
<p>configuration tool will inform you via “information” messages for all ignored related OBD </p>
<p>MID parameters. </p>
<p>This does not mean that you will have to delete all these redundant data. Any available </p>
<p>DID in range 0xF600-0xF6FF will be used as information for the DCM code generator that </p>
<p>it is required a UDS MID mirroring of all of the OBD MIDs. Since DCM does no more know </p>
<p>which  are  the  valid  MID  DIDs,  it  catches  the  whole  DID  0xF6XX  range  for  OBD  MID </p>
<p>reporting purpose.  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>225 </p>
<p>based on template version 5.0.0 </p>
<p>This implies that: </p>
<p><b>&gt; </b></p>
<p>The UDS MIDs reported by DCM can only be those defined as MIDs under the DEM </p>
<p>configuration. No application specific DIDs (i.e. some DIDs still to be read via C/S port) </p>
<p>in the above cited range of identifiers is possible to be defined in DCM. </p>
<p><b>&gt; </b></p>
<p>Due to the DCM internal redirection of the MID DID handling to a DID range handler, </p>
<p>the already known <i>Implementation Limitations </i>on <i>Handling with DID Ranges </i>do apply </p>
<p>in this case too. </p>
<p><b> </b></p>
<p><b>9.30.2 </b></p>
<p><b>Configuration Aspect </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>The DCM configuration regarding the OBD MIDTID handling shall always be kept </p>
<p>synchronized with the current DEM configuration. </p>
<p><b>&gt; </b></p>
<p>In case DCM is used together with the MSR DEM, it will notify you for any </p>
<p>configuration mismatch by a corresponding error message, issued by an error </p>
<p>directive at compile time (refer to <i>Table 10-1   Compile time error messages </i>for </p>
<p>details on each message). </p>
<p><b>&gt; </b></p>
<p>In case another DEM vendor implementation is provided to the ECU project, a </p>
<p>mismatching configuration between DCM and the DEM will result either in compile </p>
<p>time errors (i.e. missing required DEM APIs) or may lead to an unexpected run time </p>
<p>behavior as a result of the redundant and incompatible DEM and DCM MIDTID </p>
<p>configurations (i.e. DEM does not support a certain MID, TID but DCM does support </p>
<p>it or the DEM defines a different TID list for the same MID used within DCM etc.). </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>The OBD MIDTID handling is determined by setting the following DCM ECUC parameter </p>
<p>accordingly: /Dcm/DcmConfigSet/DcmGeneral/DcmDtrDataProvisionViaDemEnabled </p>
<p><b>9.31 </b></p>
<p><b>How to Enable Support of OBD VIDs with Dynamic Length </b></p>
<p>Depending on the DCM AR SWS compatibility mode, determined by the project license, </p>
<p>the OBD VIDs will be retrieved from the application resp. DEM using corresponding variant </p>
<p>of the <i>GetInfotypeValueData() </i>API. As you can see, the new API variant unconditionally (a </p>
<p>project license is assumed as a constant property) provides a means for supporting a VID </p>
<p>with variable data size. There is no additional configuration parameter to specify whether a </p>
<p>certain VID shall have a variable length. </p>
<p> </p>
<p><b>9.31.1 </b></p>
<p><b>Implementation Limitations </b></p>
<p>While the VID reading via <i>RequestVehicleInformation ($09) </i>is not really affected by the API </p>
<p>change, <i>ReadDataByIdentifier ($22) </i>does require some limitations to be taken into </p>
<p>account, depending on the API variant. These limitations are of course only applicable if </p>
<p>any OBD DIDs in the VID range (0xF800-0xF8FF) are to be supported by DCM. </p>
<p> The main difference in the usage of both API types is the point in time the DCM will </p>
<p>calculate the final response length. When using API <i>GetInfotypeValueData() </i>in its AR 4.2.2 </p>
<p>or newer variant, the final response length will be known to DCM <i>_<b>after_ </b></i>the VID data is </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>226 </p>
<p>based on template version 5.0.0 </p>
<p>read. This is the same situation as the one already known from chapter <i>9.19 Handling with </i></p>
<p><i>DID Ranges </i>and therefore the <i>Implementation Limitations </i>regarding the DID length </p>
<p>calculation do apply for these OBD VID DIDs too. Please note, that the maximum DID </p>
<p>length of those DIDs is determined by the corresponding VID data size parameter, as </p>
<p>specified in <i>5.8.4 Configuration Aspects</i>.  </p>
<p><b>9.32 </b></p>
<p><b>How to setup DCM for Sender-Receiver Communication </b></p>
<p>Additionally  to  the <i> Client-Server  Interface </i> type  of  communication  with  the  application, </p>
<p>starting  with  DCM  7.00.00  also  the  Sender-Receiver  kind  is  supported  for  the  following </p>
<p>diagnostic services only: </p>
<p><b>&gt; </b></p>
<p>Data Identifier (DID) related: </p>
<p><b>&gt; </b></p>
<p>Read Access: </p>
<p><b>&gt; </b></p>
<p><i>ReadDataByIdentifier ($22)  </i></p>
<p><b>&gt; </b></p>
<p><i>ReadDataByPeriodicIdentifier ($2A) </i></p>
<p><b>&gt; </b></p>
<p>Write Access: </p>
<p><b>&gt; </b></p>
<p><i>WriteDataByIdentifier ($2E) </i></p>
<p><b>&gt; </b></p>
<p>IO Control: </p>
<p><b>&gt; </b></p>
<p><i>InputOutputControlByIdentifier ($2F) </i>(first available in DCM 7.01.00) </p>
<p>The read and write S/R communication can be applied on a single DID data element or for </p>
<p>the  whole  DID  package  as  a  single  unit.  The  latter  is  required  for  the  NvM  SW-C </p>
<p>communication to guarantee that all the data of a single NvM block is written consistently. </p>
<p> </p>
<p><b>9.32.1 </b></p>
<p><b>Implementation Limitations </b></p>
<p>When  using  the  DCM  S/R  communication  some  limitations  and  particularities  shall  be </p>
<p>considered: </p>
<p><b>&gt; </b></p>
<p>The data element or DID shall have constant length. </p>
<p><b>&gt; </b></p>
<p>The data element or DID shall represent data that is synchronously accessible (the IO </p>
<p>Control operation is an exception of this rule). </p>
<p><b>&gt; </b></p>
<p>For the DID related read and write operations, the supported elements’ base data </p>
<p>types are: </p>
<p><b>&gt; </b></p>
<p>Atomics: (u|s)int(8|16|32) </p>
<p><b>&gt; </b></p>
<p>Fields: (u|s)int8 </p>
<p><b>&gt; </b></p>
<p>For the DID related IOControl operations, the supported element data types are: </p>
<p><b>&gt; </b></p>
<p>Atomics: uint(8|16|32) </p>
<p><b>&gt; </b></p>
<p>Fields: uint8 </p>
<p><b>&gt; </b></p>
<p>CEMR: Limited by AR up to 4 bytes </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>227 </p>
<p>based on template version 5.0.0 </p>
<p><b>&gt; </b></p>
<p>If a DID supports any other operation than the above listed (i.e. </p>
<p><i>GetScalingInformation()</i>), those operations will be treated as if the data element was </p>
<p>specified to have access of kind “SYNCH_FNC”. Therefore a callout will be expected </p>
<p>to be implemented by the application for the affected configuration object. </p>
<p><b>9.32.2 </b></p>
<p><b>Application usage Scenario </b></p>
<p>In order to get S/R IOControl operation working with your application, the following design </p>
<p>aspects shall be considered: </p>
<p><b>&gt; </b></p>
<p>On diagnostic request for service <i>InputOutputControlByIdentifier ($2F)  </i></p>
<p>On each valid diagnostic request for an IO DID, DCM either delegates the IOControl job to </p>
<p>the corresponding C/S port or performs multiple S/R port operation as a form of </p>
<p>communication with the application. In the latter case if the requested IOControl operation </p>
<p>is “ReturnControlToECU” DCM executes the same sequence of S/R port operations as for </p>
<p>the diagnostic session transition, described in the next section. The only difference is that </p>
<p>not all IO channels of the IO DID will be reset, but only the ones, marked via the CEMR by </p>
<p>the diagnostic client. For any other IOControl operation DCM will perform the following </p>
<p>steps (per IO DID): </p>
<p><b>&gt; </b></p>
<p>If the operation was “ShortTermAdjustment” the “controlState” data will be updated </p>
<p>with the content of the diagnostic request. </p>
<p><b>&gt; </b></p>
<p>The “controlEnableMask” will be updated with the content of the diagnostic request </p>
<p>CEMR. (Please, read carefully the specifics of the CEMR handling in the </p>
<p>corresponding chapter <i>InputOutputControlByIdentifier ($2F)</i>). </p>
<p><b>&gt; </b></p>
<p>At last the “inputOutputControlParameter” will be set to the requested IOControl </p>
<p>operation (e.g. DCM_SHORT_TERM_ADJUSTMENT), indicating that all related to </p>
<p>this operation parameters are already set and the operation can be executed. </p>
<p><b>&gt; </b></p>
<p>DCM starts waiting for the operation result (IOControlResponse). The wait state </p>
<p>persists as long as the corresponding S/R has not yet been updated by the </p>
<p>application, or DCM reads one of the values DCM_IDLE or </p>
<p>DCM_RESPONSE_PENDING. </p>
<p><b>&gt; </b></p>
<p>Once DCM reads any other from the above mentioned values (i.e. application has </p>
<p>finished validation of the requested operation), the diagnostic service processing </p>
<p>continues with: </p>
<p>If the result in IOControlResponse was DCM_POSITIVE_RESPONSE: </p>
<p><b>&gt; </b></p>
<p>The “underControl” will be updated by adding the requested bits from the CEMR. </p>
<p><b>&gt; </b></p>
<p>The “inputOutputControlParameter” will be set to DCM_IDLE, indicating to the </p>
<p>application that the operation is now accomplished. </p>
<p><b>&gt; </b></p>
<p>DCM will now call the S/R port of the read operation to return to the client the actual </p>
<p>IO DID values within the positive response. </p>
<p>In any other case for IOControlResponse, DCM will take the value as NRC for the initiated </p>
<p>negative response that will follow. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>228 </p>
<p>based on template version 5.0.0 </p>
<p> </p>
<p><b>&gt; </b></p>
<p>On diagnostic session transition to a session  </p>
<p>Once DCM performs a diagnostic session transitions to the default session or to a non- </p>
<p>default </p>
<p>session </p>
<p>where </p>
<p>an </p>
<p>IO </p>
<p>DID </p>
<p>under </p>
<p>control </p>
<p>is </p>
<p>no </p>
<p>longer </p>
<p>supported, </p>
<p>the </p>
<p>“ReturnControlToECU” operation  of the  affected  DID  is executed. For  the  S/R  IOControl </p>
<p>DIDs the following steps will be performed (per IO DID): </p>
<p><b>&gt; </b></p>
<p>The “underControl” data will be updated with all bits set to zero, indicating no IO </p>
<p>channel of this DID is under control. </p>
<p><b>&gt; </b></p>
<p>The “controlEnableMask” will be updated with all bits set, indicating all IO DID </p>
<p>channels will be set back to normal mode. </p>
<p><b>&gt; </b></p>
<p>At last the “inputOutputControlParameter” will be set to 0x00 (i.e. </p>
<p>DCM_RETURN_CONTROL_TO_ECU), indicating that all parameters related to this </p>
<p>operation are already set and the operation can be executed. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>Since the IOControl operation “ReturnControlToECU” is a synchronous one that must </p>
<p>always succeed, DCM will <b>not </b>expect any negative or pending response from the </p>
<p>application via the IOControlResponse_&lt;XX&gt; S/R port. This is also the case, when this </p>
<p>operation is executed upon an explicit diagnostic client request. </p>
<p> </p>
<p><b>This implies that the application shall not expect that for “ReturnControlToECU” </b></p>
<p><b>the “inputOutputControlParameter” will be set to DCM_IDLE by DCM at a later </b></p>
<p><b>point! </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p><b>9.32.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>&gt; </b></p>
<p>In order to enable S/R communication on DIDs, you have to specify the RTE usage on </p>
<p>the corresponding DID data elements to be SENDER_RECEIVER: </p>
<p> </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspData/DcmDspDataUsePort </p>
<p><b>&gt; </b></p>
<p>Additionally, if the S/R communication shall be applied on DID level (i.e. all DID data </p>
<p>elements will be merged into a single data block with the total length of the DID), then </p>
<p>following parameter shall be set accordingly: </p>
<p> </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspDid/DcmDspDidUsePort </p>
<p>For usage details of these particular parameters, please refer to the Configurator5 online </p>
<p>help. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>229 </p>
<p>based on template version 5.0.0 </p>
<p><b>9.33 </b></p>
<p><b>How to Support Routine Info Byte with UDS RIDs  </b></p>
<p><b>9.33.1 </b></p>
<p><b>Introduction </b></p>
<p>The Routine Info Byte is a manufacturer specific value that is assigned to a routine and </p>
<p>that  can  be  reported  to  the  tester  when  the  diagnostic  service <i> RoutineControl  ($31) </i> is </p>
<p>requested. The DCM  provides a means to report this  Routine Info Byte  without need of </p>
<p>application intervention. </p>
<p> </p>
<p><b>9.33.2 </b></p>
<p><b>Configuration Aspects </b></p>
<p>If the DCM shall report the Routine Info Byte of a routine automatically, specify the value of </p>
<p>the Routine Info Byte using following parameter: </p>
<p>/Dcm/DcmConfigSet/DcmDsp/DcmDspRoutine/DcmDspRoutineInfoByte </p>
<p>For every routine where this parameter is not supported, the application has to provide the </p>
<p>Routine Info Byte if needed. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>230 </p>
<p>based on template version 5.0.0 </p>
<p><b>10  Troubleshooting </b></p>
<p><b>10.1 </b></p>
<p><b>Compile Error Messages </b></p>
<p>This chapter describes the error situations the DCM code checks and catches at compile </p>
<p>time. </p>
<p> </p>
<p><b>Error Message </b></p>
<p><b>Reason </b></p>
<p><b>Countermeasure </b></p>
<p>Service 0x2A is enabled, but </p>
<p>no periodic messages have </p>
<p>been configured for Dcm. </p>
<p>Please, refer to the Dcm </p>
<p>TechRef for SID 0x2A </p>
<p>configuration aspect. </p>
<p>You have activated service  </p>
<p><i>ReadDataByPeriodicIdentifier </i></p>
<p><i>($2A) </i>but have no periodic </p>
<p>connection specified. </p>
<p>- Remove the service from the </p>
<p>DCM configuration.  </p>
<p>- Check if any available </p>
<p>periodic messages in the </p>
<p>communication layers used by </p>
<p>DCM. </p>
<p>- Check for periodic </p>
<p>connections not automatically </p>
<p>recognized by the configuration </p>
<p>tool. </p>
<p>Vendor specific version </p>
<p>numbers of Dcm.c and Dcm.h </p>
<p>are inconsistent </p>
<p>The Dcm.c and Dcm.h are not </p>
<p>from the same delivery. </p>
<p>- Check for correct sources </p>
<p>resp. re-update the sources </p>
<p>from the delivered package. </p>
<p>Mismatching OEMs between </p>
<p>static and generated code </p>
<p>- Using the DCM code intended </p>
<p>for another OEM. </p>
<p>- Using wrong configuration </p>
<p>tool output for this project. </p>
<p>- Check for correct sources </p>
<p>resp. re-update the sources </p>
<p>from the delivered package.  </p>
<p>- Check for using correct </p>
<p>configuration tool generation </p>
<p>output (<i>Dynamic Files</i>). </p>
<p>Unsupported PduR version! </p>
<p>Unrecognized/unsupported </p>
<p>PduR version is specified. </p>
<p>Refer to <i>9.17 How to Deal with </i></p>
<p><i>the PduR AR version</i>. </p>
<p>Missing information for the </p>
<p>supported DTC Extended Data </p>
<p>Records! See DCM TechRef! </p>
<p>- The DCM could not retrieve </p>
<p>any extended data record </p>
<p>information from the DEM </p>
<p>module or it is a non-</p>
<p>MICROSAR DEM. </p>
<p>- In a MICROSAR DEM no </p>
<p>extended data records are </p>
<p>defined. </p>
<p>- In a MICROSAR DEM no </p>
<p>DTC refers an extended data </p>
<p>record. </p>
<p>- Refer to <i>5.13.3.1Reporting </i></p>
<p><i>Stored DTC Environment Data </i></p>
<p>for information about this </p>
<p>configuration. </p>
<p>- Correct the MICROSAR DEM </p>
<p>configuration. </p>
<p>- Remove the corresponding </p>
<p>DCM </p>
<p><i>ReadDiagnosticInformation </i></p>
<p><i>($19) </i>sub-function since </p>
<p>obviously not required when </p>
<p>the DEM does not specify any </p>
<p>records. </p>
<p>Missing information for the </p>
<p>supported DTC Freeze Frame </p>
<p>Records! See DCM TechRef! </p>
<p>- The DCM could not retrieve </p>
<p>any snapshot data record </p>
<p>information from the DEM </p>
<p>module or it is a non-</p>
<p>MICROSAR DEM. </p>
<p>- Refer to <i>5.13.3.1Reporting </i></p>
<p><i>Stored DTC Environment Data </i></p>
<p>for information about this </p>
<p>configuration. </p>
<p>- Correct the MICROSAR DEM </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>231 </p>
<p>based on template version 5.0.0 </p>
<p><b>Error Message </b></p>
<p><b>Reason </b></p>
<p><b>Countermeasure </b></p>
<p>- In a MICROSAR DEM no </p>
<p>snapshot records are defined. </p>
<p>- In a MICROSAR DEM no </p>
<p>DTC refers a snapshot record. </p>
<p>- In a MICROSAR DEM all </p>
<p>DTC has been specified to </p>
<p>have up to zero (0) snapshot </p>
<p>records if calculated snapshot </p>
<p>records are chosen. </p>
<p>configuration. </p>
<p>- Remove the corresponding </p>
<p>DCM </p>
<p><i>ReadDiagnosticInformation </i></p>
<p><i>($19) </i>sub-function since </p>
<p>obviously not required when </p>
<p>the DEM does not specify any </p>
<p>records. </p>
<p>Unknown DEM AR API </p>
<p>interface! </p>
<p>Unrecognized/unsupported </p>
<p>DEM API version is specified. </p>
<p>Refer to <i>9.13 How to Select </i></p>
<p><i>DEM-DCM Interface Version</i>. </p>
<p>Too many system timers! </p>
<p>Internal error – DCM design </p>
<p>limits reached. </p>
<p>Try reducing the maximum </p>
<p>number of schedulable DIDs or </p>
<p>number of periodic messages </p>
<p>per connection (refer to </p>
<p><i>ReadDataByPeriodicIdentifier </i></p>
<p><i>($2A)</i>) </p>
<p>DCM configured to handle </p>
<p>OBD DID MIDs via DCM </p>
<p>configuration, but MID handling </p>
<p>is done by DEM. </p>
<p>This message can be issued </p>
<p>only if MSR DEM is used </p>
<p>together with MSR DCM. </p>
<p> </p>
<p>Either the MSR DEM has been </p>
<p>configured to handle OBD </p>
<p>DTRs as per AR 4.2.2, but at </p>
<p>the same time, DCM is </p>
<p>configured to this job too </p>
<p>or vice-versa. </p>
<p>Refer to the <i>9.30 How to </i></p>
<p><i>Switch Between OBD DTR </i></p>
<p><i>Support by DCM and </i>DEM for </p>
<p>details on OBD DTR handling </p>
<p>and the configuration aspects. </p>
<p>DCM configured to handle </p>
<p>OBD DID MIDs via DEM </p>
<p>configuration, but no MID </p>
<p>handling is done by DEM. </p>
<p>DCM configured to handle </p>
<p>OBD MIDs via DCM </p>
<p>configuration, but MID handling </p>
<p>is done by DEM. </p>
<p>DCM configured to handle </p>
<p>OBD MIDs via DEM </p>
<p>configuration, but no MID </p>
<p>handling is done by DEM. </p>
<p>DID ranges are not allowed if </p>
<p>any paged DID is configured! </p>
<p>Incompatible features have </p>
<p>been activated.  </p>
<p>Refer to <i>9.24.3 Implementation </i></p>
<p><i>Limitations  </i>for details on using </p>
<p>paged DIDs. </p>
<p>Paged DIDs are not allowed if </p>
<p>any OBD2 VIDs as per AR4.2.2 </p>
<p>are enabled! </p>
<p>Incompatible features have </p>
<p>been activated. </p>
<p>Refer to <i>9.31.1 Implementation </i></p>
<p><i>Limitations </i>for details on using </p>
<p>OBD2 VIDs with AR 4.2.2 API. </p>
<p>Any other message </p>
<p>Internal inconsistency </p>
<p>detection.  </p>
<p>Contact Vector. </p>
<p>Table 10-1  </p>
<p>Compile time error messages </p>
<p><b>10.2 </b></p>
<p><b>Code Generation Time Messages </b></p>
<p>Here  are  listed  only  some  of  the  specific  error/warning/information  messages  that  may </p>
<p>occur during code generation for MSR DCM. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>232 </p>
<p>based on template version 5.0.0 </p>
<p><b>Message ID </b></p>
<p><b>Reason </b></p>
<p><b>Description </b></p>
<p>DCM05010 </p>
<p>The <b>control </b>operation over a <b>DID </b>has </p>
<p>been defined to have different </p>
<p>execution preconditions for the state </p>
<p>group “<b>session</b>” in multiple variants. </p>
<p>Refer to <i>9.18.1.2.1 Handling of State </i></p>
<p><i>Execution Preconditions of Variant </i></p>
<p><i>Diagnostic Entities </i>to learn more about </p>
<p>multiple variants and execution </p>
<p>preconditions variance. </p>
<p>DCM05011 </p>
<p>The <b>read </b>operation over a <b>DID </b>has </p>
<p>been defined to have different </p>
<p>execution preconditions for the state </p>
<p>group “<b>session</b>” in multiple variants. </p>
<p>DCM05012 </p>
<p>The <b>write </b>operation over a <b>DID </b>has </p>
<p>been defined to have different </p>
<p>execution preconditions for the state </p>
<p>group “<b>session</b>” in multiple variants. </p>
<p>DCM05013 </p>
<p>An <b>RID </b>has been defined to have </p>
<p>different execution preconditions for </p>
<p>the state group “<b>session</b>” in multiple </p>
<p>variants. </p>
<p>DCM05014 </p>
<p>A <b>diagnostic service </b>has been </p>
<p>defined to have different execution </p>
<p>preconditions for the state group </p>
<p>“<b>session</b>” in multiple variants. </p>
<p>DCM05015 </p>
<p>A <b>diagnostic sub-service </b>has been </p>
<p>defined to have different execution </p>
<p>preconditions for the state group </p>
<p>“<b>session</b>” in multiple variants. </p>
<p>DCM05020 </p>
<p>The <b>control </b>operation over a <b>DID </b>has </p>
<p>been defined to have different </p>
<p>execution preconditions for the state </p>
<p>group “<b>security access</b>” in multiple </p>
<p>variants. </p>
<p>DCM05021 </p>
<p>The <b>read </b>operation over a <b>DID </b>has </p>
<p>been defined to have different </p>
<p>execution preconditions for the state </p>
<p>group “<b>security access</b>” in multiple </p>
<p>variants. </p>
<p>DCM05022 </p>
<p>The <b>write </b>operation over a <b>DID </b>has </p>
<p>been defined to have different </p>
<p>execution preconditions for the state </p>
<p>group “<b>security access</b>” in multiple </p>
<p>variants. </p>
<p>DCM05023 </p>
<p>An <b>RID </b>has been defined to have </p>
<p>different execution preconditions for </p>
<p>the state group “<b>security access</b>” in </p>
<p>multiple variants. </p>
<p>DCM05024 </p>
<p>A <b>diagnostic service </b>has been </p>
<p>defined to have different execution </p>
<p>preconditions for the state group </p>
<p>“<b>security access</b>” in multiple variants. </p>
<p>DCM05025 </p>
<p>A <b>diagnostic sub-service </b>has been </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>233 </p>
<p>based on template version 5.0.0 </p>
<p><b>Message ID </b></p>
<p><b>Reason </b></p>
<p><b>Description </b></p>
<p>defined to have different execution </p>
<p>preconditions for the state group </p>
<p>“<b>security access</b>” in multiple variants. </p>
<p>Table 10-2  </p>
<p>Code Generation Time Messages </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>234 </p>
<p>based on template version 5.0.0 </p>
<p><b>11  Glossary and Abbreviations </b></p>
<p><b>11.1 </b></p>
<p><b>Glossary </b></p>
<p><b>Term </b></p>
<p><b>Description </b></p>
<p>Configurator 5 </p>
<p>Configuration and generation tool for MICROSAR components </p>
<p>Table 11-1  </p>
<p>Glossary </p>
<p><b>11.2 </b></p>
<p><b>Abbreviations </b></p>
<p><b>Abbreviation </b></p>
<p><b>Description </b></p>
<p>ALFID </p>
<p>Address and Length Format Identifier </p>
<p>API </p>
<p>Application Programming Interface </p>
<p> </p>
<p>AUTOSAR </p>
<p>Automotive Open System Architecture </p>
<p>BSW </p>
<p>Basis Software </p>
<p>C/S </p>
<p>Client/Server (Port) </p>
<p>CDD </p>
<p>Complex Device Driver </p>
<p>CEM </p>
<p>Control Enable Mask </p>
<p>CEMR </p>
<p>CEM Record </p>
<p>DCM </p>
<p>Diagnostic Communication Manager </p>
<p>DEM </p>
<p>Diagnostic Event Manager </p>
<p>DET </p>
<p>Development Error Tracer </p>
<p>DDID </p>
<p>Dynamic DID </p>
<p>DID </p>
<p>Data Identifier </p>
<p>DTR </p>
<p>Diagnostic Test Result </p>
<p>ECU </p>
<p>Electronic Control Unit </p>
<p>EWT </p>
<p>Event Window Time </p>
<p>FC.OVFW </p>
<p>Flow Control with status Overflow </p>
<p>FBL </p>
<p>Flash Boot Loader </p>
<p>HIS </p>
<p>Hersteller Initiative Software </p>
<p>ISR </p>
<p>Interrupt Service Routine </p>
<p>MICROSAR </p>
<p>Microcontroller Open System Architecture (the Vector AUTOSAR </p>
<p>solution) </p>
<p>MID </p>
<p>Monitor Identifier </p>
<p>NRC </p>
<p>Negative Response Code </p>
<p>N_TA </p>
<p>Node Target Address </p>
<p>OBD2 </p>
<p>On Board Diagnostics 2 </p>
<p>OCY </p>
<p>Operation Cycle </p>
<p>PBS </p>
<p>Post Build Selectable (variant handling) </p>
<p>PBL </p>
<p>Post Build Loadable (variant handling) </p>
<p>PDID </p>
<p>Periodic DID </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>235 </p>
<p>based on template version 5.0.0 </p>
<p>PID </p>
<p>Parameter Identifier </p>
<p>PPort </p>
<p>Provide Port </p>
<p>RID </p>
<p>Routine Identifier </p>
<p>ROE </p>
<p>Response on Event </p>
<p>RPort </p>
<p>Require Port </p>
<p>RTE </p>
<p>Runtime Environment </p>
<p>S/R </p>
<p>Sender/Receiver (Port) </p>
<p>SADR </p>
<p>Security Access Data Record </p>
<p>SNS </p>
<p>Service Not Supported </p>
<p>SNV </p>
<p>Symbolic Name Value </p>
<p>SRS </p>
<p>Software Requirement Specification </p>
<p>STRT </p>
<p>Service To Respond To </p>
<p>SWC </p>
<p>Software Component </p>
<p>SWS </p>
<p>Software Specification </p>
<p>TID </p>
<p>Test Identifier </p>
<p>VID </p>
<p>Vehicle Identification Number </p>
<p>Table 11-2  </p>
<p>Abbreviations </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM </p>
<p>© 2016 Vector Informatik GmbH </p>
<p>Version 7.1 </p>
<p>236 </p>
<p>based on template version 5.0.0 </p>
<p><b>12  Contact </b></p>
<p>Visit our website for more information on </p>
<p> </p>
<p><b></b></p>
<p><b> </b></p>
<p>News </p>
<p><b></b></p>
<p><b> </b></p>
<p>Products </p>
<p><b></b></p>
<p><b> </b></p>
<p>Demo software </p>
<p><b></b></p>
<p><b> </b></p>
<p>Support </p>
<p><b></b></p>
<p><b> </b></p>
<p>Training data </p>
<p><b></b></p>
<p><b> </b></p>
<p>Addresses </p>
<p> </p>
<p>www.vector.com </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
</body>
</html>
{% endraw %}